{"version":3,"file":"clientSdk.js","mappings":"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;AAEA;AACA;AACA,MAAM;AACN;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,kFAAkF;AAClF;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,2CAA2C,SAAS;;AAEpD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;;AAE9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA6F,aAAa;AAC1G;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6EAA6E,eAAe;AAC5F;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,k/BAAk/B;;AAEl/B;AACA,wYAAwY;AACxY;AACA;AACA;;AAEA;AACA,gTAAgT;AAChT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,8BAA8B,EAAE,iBAAiB,EAAE,MAAM;;AAEzD;AACA,6BAA6B,QAAQ;AACrC,sDAAsD;;AAEtD,0CAA0C;;AAE1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,2BAA2B;AACxC,aAAa,UAAU;AACvB,cAAc,oBAAoB;AAClC;AACA;;;AAGA;AACA;AACA;AACA,MAAM;AACN;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,0CAA0C;AAC1C;;AAEA;AACA,0CAA0C;AAC1C;AACA;AACA,kBAAkB,sBAAsB;AACxC,kBAAkB,sBAAsB;AACxC,kBAAkB,SAAS;AAC3B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;AACA,2CAA2C;AAC3C;;AAEA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gDAAgD;AAChD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA,sKAAsK;;AAEtK;AACA;;AAEA,wDAAwD;AACxD,wDAAwD;AACxD,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,sDAAsD;AACtD,sDAAsD;AACtD;AACA,uDAAuD;;AAEvD,uDAAuD;;AAEvD,sEAAsE;;AAEtE,yEAAyE;;AAEzE,4DAA4D;;AAE5D,oDAAoD;;AAEpD,4CAA4C;;AAE5C,8DAA8D;;AAE9D,8DAA8D;;AAE9D,4CAA4C;;AAE5C,iDAAiD;;AAEjD,gEAAgE;;AAEhE,iDAAiD;;AAEjD,wCAAwC;;AAExC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA,kCAAkC;AAClC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA,oDAAoD;AACpD,6CAA6C,yDAAyD;AACtG;AACA;AACA;;AAEA,kDAAkD;AAClD;AACA;AACA;;AAEA,kCAAkC;AAClC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,gBAAgB,SAAS;AACzB,iBAAiB,SAAS;AAC1B;AACA;AACA;;AAEA;AACA,2CAA2C;AAC3C;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;;AAGA;AACA;AACA,UAAU;AACV;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;;;AAGA;AACA;AACA,UAAU;AACV;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;;;AAGA;AACA,QAAQ;;;AAGR;AACA;AACA,QAAQ;AACR;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB;;;AAGA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,MAAM;AACtB;;;AAGA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA;AACA,SAAS;AACT;;AAEA,kCAAkC;;AAElC;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU;AACV;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,UAAU;AAC1B;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,UAAU,WAAW;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,UAAU;AAC1B;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB,gBAAgB,SAAS;AACzB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB,gBAAgB,SAAS;AACzB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,MAAM;AACtB,gBAAgB,QAAQ;AACxB;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,MAAM;AACvB,iBAAiB,SAAS;AAC1B;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB,gBAAgB,SAAS;AACzB;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;;;AAG5C,wFAAwF,+DAA+D;AACvJ;AACA;AACA;AACA;AACA;AACA,uTAAuT;AACvT;AACA;AACA;;AAEA,QAAQ,wCAAwC,sFAAsF,oKAAoK,qHAAqH;AAC/Z;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,sCAAsC;;AAEtC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C;;AAE7C;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,+CAA+C;;;AAG/C;AACA;AACA;;;AAGA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,gBAAgB,kBAAkB;AAClC;;;AAGA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,eAAe,QAAQ;AACvB;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB,gBAAgB,SAAS;AACzB;;;AAGA;AACA;AACA;AACA,uBAAuB;AACvB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,UAAU;AACzB;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,gBAAgB,UAAU;AAC1B;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,CAAC;AACD;;;;;;;;;;;;;AC/qDgF;AAEzE,MAAM,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AACjC,wBAAwB,mBAAO,CAAC,GAAiB;AACjD,SAAS,mBAAO,CAAC,GAAS;AAC1B,SAAS,mBAAO,CAAC,GAAoB;AACrC,SAAS,mBAAO,CAAC,GAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,sBAAsB;AACtB,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,mBAAmB;AACxE;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,eAAe;AACf,6CAA6C;AAC7C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,mCAAmC;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,iDAAiD;AACjD;AACA,SAAS;AACT;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA,iEAAiE;AACjE;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA,uDAAuD,gBAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C,8GAA8G,KAAK;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uGAAuG,sBAAsB;AAC7H;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,0BAA0B,yCAAyC,QAAQ;AAC3I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,gBAAgB,IAAI;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,gEAAgE;AAChE,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,UAAU,OAAO,SAAS,KAAK,OAAO,KAAK,MAAM;AACvG;AACA;AACA,6BAA6B;AAC7B,0DAA0D,mCAAmC;AAC7F;AACA;AACA,6BAA6B;AAC7B,0DAA0D,mBAAmB,cAAc,iBAAiB;AAC5G;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,sBAAsB;AACnE;AACA,4DAA4D,oBAAoB;AAChF;AACA;AACA,2DAA2D,6BAA6B;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA6F,mBAAmB;AAChH;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,QAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,yGAAyG,SAAS;AAClH;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,8BAA8B;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,4BAA4B,KAAK,oBAAoB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,WAAW,EAAE,eAAe;AACtG;AACA;AACA;AACA;AACA;AACA,6BAA6B,QAAQ;AACrC,kCAAkC,4BAA4B;AAC9D,oEAAoE,MAAM,SAAS,QAAQ,UAAU,SAAS,QAAQ,MAAM;AAC5H,wEAAwE,MAAM,SAAS,QAAQ,UAAU,SAAS,QAAQ,MAAM;AAChI;AACA,sDAAsD,QAAQ,+BAA+B,MAAM;AACnG,sDAAsD,QAAQ,8BAA8B,MAAM;AAClG,sDAAsD,QAAQ,+BAA+B,QAAQ,UAAU,OAAO;AACtH,sDAAsD,QAAQ,8BAA8B,KAAK;AACjG,sDAAsD,QAAQ,6BAA6B,KAAK;AAChG,sDAAsD,QAAQ,8BAA8B,OAAO,UAAU,OAAO;AACpH;AACA;AACA;AACA;AACA;AACA,gDAAgD,WAAW,OAAO;AAClE;AACA,0DAA0D,OAAO,SAAS,MAAM,aAAa,iBAAiB,IAAI;AAClH,0DAA0D,OAAO,SAAS,EAAE,gBAAgB,EAAE;AAC9F,0DAA0D,OAAO,aAAa,EAAE,oBAAoB,EAAE;AACtG,0DAA0D,OAAO,aAAa,EAAE,oBAAoB,EAAE;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE;AACA,mCAAmC;AACnC;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA,mDAAmD;AACnD;AACA,iCAAiC;AACjC;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA,2BAA2B;AAC3B;AACA,yBAAyB;AACzB;AACA,gCAAgC;AAChC;AACA,gCAAgC;AAChC;AACA,qBAAqB;AACrB;AACA,mCAAmC;AACnC;AACA;AACA,0BAA0B,0BAA0B,QAAQ;AAC5D;AACA,0BAA0B,0BAA0B,MAAM;AAC1D;AACA,0BAA0B,0BAA0B,MAAM;AAC1D;AACA,2BAA2B,0BAA0B,MAAM;AAC3D;AACA,2BAA2B,0BAA0B,MAAM;AAC3D;AACA,sBAAsB,0BAA0B,MAAM;AACtD;AACA,wBAAwB,0BAA0B,MAAM;AACxD;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;;;;;;ACh2Ca;AACb;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA,gBAAgB,mBAAO,CAAC,GAAS;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,uCAAuC;AACvC,gCAAgC;AAChC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,eAAe,GAAG;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA,uCAAuC;AACvC,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,uBAAuB,OAAO;AACvE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,uBAAuB,OAAO;AACnG,aAAa;AACb,mDAAmD,WAAW,MAAM;AACpE;AACA,uDAAuD;AACvD;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,kBAAkB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,mEAAmE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,uCAAuC;AACvC,gCAAgC;AAChC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD,wBAAwB,sCAAsC;AAC9D,SAAS;AACT,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;;;;;;;ACxrBa;AACb;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,UAAU,EAAE,OAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,uFAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","sources":["webpack:///webpack/universalModuleDefinition","webpack:///./ts/core/common/matrixlib.ts","webpack:///./ts/core/common/matrixlib/MatrixLibInterfaces.ts","webpack:///./ts/core/common/matrixlib/index.ts","webpack:///./ts/core/common/matrixlib/SearchTools.ts","webpack:///./ts/core/globals.ts","webpack:///./ts/core/common/businesslogic/MatrixRequirementsAPI.ts","webpack:///./ts/core/common/matrixlib/ItemTools.ts","webpack:///./ts/core/common/matrixlib/SimpleItemTools.ts","webpack:///./ts/core/common/UI/Parts/RefLinkDefines.ts","webpack:///./ts/core/common/matrixlib/ContextFramesTools.ts","webpack:///./ts/core/common/businesslogic/index.ts","webpack:///./ts/core/common/businesslogic/PluginManager.ts","webpack:///./ts/core/common/businesslogic/PluginManagerDocuments.ts","webpack:///./ts/core/common/businesslogic/RestDB.ts","webpack:///./ts/core/common/businesslogic/DBCache.ts","webpack:///./ts/core/common/UI/Components/index.ts","webpack:///./ts/core/common/UI/Components/ItemForm.ts","webpack:///./ts/core/common/UI/Components/ProjectViewDefines.ts","webpack:///./ts/core/common/UI/Controls/titleToolbar.ts","webpack:///./ts/core/common/UI/Controls/BaseControl.ts","webpack:///./ts/core/common/UI/Controls/markAsTemplate.ts","webpack:///./ts/core/common/UI/Controls/docSign.ts","webpack:///./ts/core/common/UI/Controls/docBase..ts","webpack:///./ts/core/common/businesslogic/FieldDescriptions.ts","webpack:///./ts/core/common/UI/Parts/UserControl.ts","webpack:///./ts/core/common/UI/Parts/EmailValidator.ts","webpack:///./ts/core/common/UI/Parts/PasswordValidator.ts","webpack:///./ts/core/common/UI/Parts/UserNameValidator.ts","webpack:///./ts/core/common/UI/Tools/ItemHistoryView.ts","webpack:///./ts/core/common/UI/MainTree/MainTree.ts","webpack:///./ts/core/common/UI/Components/ProjectView.ts","webpack:///./ts/core/common/UI/Components/ProjectList.ts","webpack:///./ts/core/common/UI/Components/NavigationBar.ts","webpack:///./ts/core/common/UI/Components/ProjectTree.ts","webpack:///./ts/core/common/businesslogic/ComponentImport.ts","webpack:///./ts/core/common/UI/Components/SearchBox.ts","webpack:///./ts/core/common/UI/Parts/LabelSwitches.ts","webpack:///./ts/core/common/matrixlib/LabelTools.ts","webpack:///./ts/core/common/matrixlib/LabelManager.ts","webpack:///./ts/core/common/UI/Components/ViewModeSelector.ts","webpack:///./ts/core/client/plugins/Notifications.ts","webpack:///./ts/core/ProjectSettings.ts","webpack:///./ts/core/common/businesslogic/NotificationsBL.ts","webpack:///./ts/core/common/businesslogic/NotificationsCache.ts","webpack:///./ts/core/common/UI/Parts/RefLink.ts","webpack:///./ts/core/common/UI/Tools/ItemReferenceView.ts","webpack:///./ts/core/common/UI/Tools/ItemCreationView.ts","webpack:///./ts/core/common/UI/Tools/ItemSelectionView.ts","webpack:///./ts/core/client/plugins/beta/Cleanup.ts","webpack:///./ts/core/common/UI/Components/KeyboardShortcuts.ts","webpack:///./ts/core/client/plugins/ReviewContextFrame.ts","webpack:///./ts/core/common/businesslogic/TestManager.ts","webpack:///./ts/core/common/businesslogic/TestManagerConfiguration.ts","webpack:///./ts/core/common/UI/Tools/Layouter.ts","webpack:///./ts/core/printinterface/PrintProcessorInterfaces.ts","webpack:///./ts/core/common/UI/JsonEditor.ts","webpack:///./ts/core/client/plugins/Redlining.ts","webpack:///./ts/core/client/plugins/DocumentSections/Hidden.ts","webpack:///./ts/core/client/plugins/DocumentSections/BaseDHFSection.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/index.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/EmptyFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/RichtextFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/TextlineFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/CheckboxFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/SteplistFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/BaseValidatedTableFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/BaseTableFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/GenericFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/DropdownFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/TestStepsFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/TestStepsResultFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/TestResultFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/UserFieldHandler.ts","webpack:///./ts/core/common/businesslogic/BasicFunctions.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/DateFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/GateFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/HyperlinkFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/CrosslinksFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/ItemSelectionFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/DHFFieldHandler.ts","webpack:///./node_modules/isomorphic-dompurify/browser.js","webpack:///./node_modules/dompurify/dist/purify.js","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/GenericDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/GenericDocAbstractFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/SectionDescriptions.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/index.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/GenericTableDocHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DateDocHandler.ts","webpack:///./ts/core/common/businesslogic/DateTimeBL.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/CustomDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ItemSelectionFromToAbstractDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/ItemSelectionFieldHandlerFromTo.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/RemarksDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DropdownAbstractDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/CheckBoxDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DesignReviewDocFieldHandler.ts","webpack:///./ts/core/common/matrixlib/JQueryExtendReplacement.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ItemIndexDocFieldHander.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ItemListDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ItemSelectionAbstractDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/LinkListDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ItemTableDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/RiskStatsDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ItemRefDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/ListOfFiguresDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/SmartTextDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/TableOfContentDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/testResultsDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DerivedFromDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DocumentOptionsFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/TextLineDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/RichTextDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/TraceMatrixDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/TraceDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DropdownDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/FieldHandlers/Document/DashboardDocFieldHandler.ts","webpack:///./ts/core/common/businesslogic/DHFInterfaces.ts","webpack:///./ts/core/common/businesslogic/PluginManagerFormulas.ts","webpack:///./ts/core/common/businesslogic/Tasks.ts","webpack:///./ts/core/common/businesslogic/TrainingManager.ts","webpack:///./ts/core/common/businesslogic/Branching.ts","webpack:///./ts/core/common/businesslogic/ItemConfiguration.ts","webpack:///./ts/core/common/businesslogic/MatrixReq.ts","webpack:///./ts/core/common/businesslogic/MatrixSession.ts","webpack:///./ts/core/client/ProjectStorage.ts","webpack:///./ts/core/common/businesslogic/PushMessages.ts","webpack:///./ts/core/common/UI/Parts/TokenControl.ts","webpack:///./ts/core/mobile/ProjectStorageMobile.ts","webpack:///./ts/core/common/businesslogic/RestConnector.ts","webpack:///./ts/core/common/matrixlib/FileTools.ts","webpack:///./ts/core/common/matrixlib/HTMLCleaner.ts","webpack:///./ts/core/common/matrixlib/JSONTools.ts","webpack:///./ts/core/common/matrixlib/LoggerTools.ts","webpack:///./ts/core/common/matrixlib/MailTools.ts","webpack:///./ts/core/common/matrixlib/ReportGeneratorTools.ts","webpack:///./ts/core/common/matrixlib/SmartTextTools.ts","webpack:///./ts/core/common/matrixlib/UITools.ts","webpack:///./ts/core/common/UI/Tools/ThemeSelector.ts","webpack:///./ts/core/WidgetDashboard/WidgetPluginsContainer.ts","webpack:///./js/vendor/gridstack_3.2.0/dist/gridstack.js","webpack:///./js/vendor/gridstack_3.2.0/dist/gridstack-engine.js","webpack:///./js/vendor/gridstack_3.2.0/dist/utils.js","webpack:///./js/vendor/gridstack_3.2.0/dist/gridstack-ddi.js","webpack:///./ts/core/common/UI/ILineEditor.ts","webpack:///./ts/core/WidgetDashboard/WidgetPluginManager.ts","webpack:///./ts/core/WidgetDashboard/WidgetSettingsManager.ts","webpack:///./ts/core/common/matrixlib/DateTimeUI.ts","webpack:///./ts/core/common/matrixlib/URLTools.ts","webpack:///./ts/core/common/matrixlib/XPathTools.ts","webpack:///./ts/core/common/UI/Controls/docReview.ts","webpack:///./ts/core/client/plugins/ScheduleReview.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./ts/sdk/clientSdk.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"matrixClientSdk\"] = factory();\n\telse\n\t\troot[\"matrixClientSdk\"] = factory();\n})(this, () => {\nreturn ","\nimport { globalMatrix } from \"../globals\";\nimport { IMatrix, ISearchTools, IItemTools, IContextFramesTools, IJSONTools, IXPathTools, IURLTools, IMailTools, ILoggerTools, ILabelTools, IUIToolsEnum, IFileTools, IReportGeneratorTools, ISmartTextTools, UIToolsConstants } from \"./matrixlib/MatrixLibInterfaces\";\nimport { ContextFramesTools, FileTools, ItemTools, JSONTools, LabelTools, LoggerTools, MailTools, ReportGeneratorTools, SearchTools, SmartTextTools, UIToolsEnum, URLTools, XPathTools } from \"./matrixlib/index\";\n\nexport { ml, LoggerTools, JSONTools };\n\nclass matrix implements IMatrix {\n    public Search: ISearchTools;\n    public Item: IItemTools;\n    public ContextFrames: IContextFramesTools;\n    public JSON: IJSONTools;\n    public XPath: IXPathTools;\n    public URL: IURLTools;\n    public Mail: IMailTools;\n    public Logger: ILoggerTools;\n    public LabelTools: ILabelTools;\n    public UI: IUIToolsEnum;\n    public File: IFileTools;\n    public ReportGenerator: IReportGeneratorTools;\n    public SmartText: ISmartTextTools;\n\n    constructor() {\n        this.Search = new SearchTools();\n        this.Item = new ItemTools();\n        this.ContextFrames = new ContextFramesTools();\n\n        // highlight / search function\n        this.XPath = new XPathTools();\n        this.URL = new URLTools();\n        this.Mail = new MailTools();\n\n        // tooltipsmessage boxes and other ui controls\n        this.UI = new UIToolsEnum();\n        this.File = new FileTools();\n        this.ReportGenerator = new ReportGeneratorTools();\n        this.SmartText = new SmartTextTools();\n\n        // console / error logging\n        this.Logger = new LoggerTools(this.UI.DateTime.renderHumanDate.bind(this.UI.DateTime));\n        this.JSON = new JSONTools(this.Logger);\n\n        // label tools (labels and filters)\n        this.LabelTools = this.CreateNewLabelTools();\n    }\n\n    CreateNewLabelTools(): ILabelTools {\n        return new LabelTools(this.Logger, this.JSON);\n    }\n}\n\nlet ml: IMatrix;\n\nml = new matrix();\n\n// Let's save this on the window.\nglobalThis.ml = ml;\n// TODO(modules): UIToolsEnum was split into two classes because of circular dependencies.\n// UIToolsConstants was the result. Legacy plugins often use those constants, so let's\n// make it easy for them by exposing those in the old name they know. This is a TODO\n// because it reflects that those plugins need to be refactored.\nglobalThis.UIToolsEnum = UIToolsConstants;\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { IItem, IItemIdParts, IReference, IReferenceChange, IItemGet, IItemPut, IRestParam, IGenericMap, IStringMap, IRestResult } from \"../../globals\";\nimport { ILabel, IDesignReview, ILabelGroup, IMailConfigCanned, ICaption, ISmartTextConfigReplacement, IDropdownOption, IDropdownGroup } from \"../../ProjectSettings\";\nimport { XCPostCompareHtml } from \"../../RestCalls\";\nimport {\n    XRCrossProjectLink,\n    XRUserPermissionType,\n    XRGroupPermissionType,\n    XRGroupType,\n    XRCategoryExtendedType,\n    XRGetProject_JobStatus_JobsStatusWithUrl,\n    XRGetProject_Reports_GetReportsAck,\n    XRPostProject_AddFile_AddFileAck,\n    XRPostProject_CompareHtml_HtmlCompareResult,\n    XRPostProject_LaunchReport_CreateReportJobAck,\n    XRPostProject_SignItem_SignItemAck,\n    XRTrimAudit,\n    XRLabelHistory,\n    XRTrimNeedle\n} from \"../../RestResult\";\nimport { IWidgetPluginsContainer } from \"../../WidgetDashboard/WidgetPluginsContainer\";\nimport { DBCache, IDB, IDBParent, IEvent, IFileParam, IFileUploadProgress, IItemWatched, IJcxhr, IReferenceUpdate, IRestoreItemResult, ISearchResult, ISetField, ISimpleTree, ITraceRules, IUpdateCache, IVersionDetails } from \"../businesslogic\";\nimport { IBaseControlOptions } from \"../UI/Controls/BaseControl\";\nimport { IDropdownParams } from \"../UI/Controls/dropdown\";\nimport { ILinkCollectionOptions, ILinkCategories } from \"../UI/Controls/linkCollection\";\nimport { IRichTextParams } from \"../UI/Controls/richText\";\nimport { IThemeSelector } from \"../UI/Tools/ThemeSelector\";\n\n// ContextFrameTools interfaces\nexport type { IContextInformation, IContextFramesTools };\n\n// FileTools interfaces\nexport type { IUploadedFileInfo, IFileDefinition, IFileTools };\n\n// ItemTools interfaces\nexport type { ISimpleItemTools, IItemTools };\n\n// JSONTools interfaces\nexport type { IJSONTools };\n\n// ReportGeneratorTools interfaces\nexport type {\n    IReportTask, IJobList, IReportOptions, IReportTransferField, IReportSetField,\n    IGetReportProgressResult, IGetReportProgressJobFileResult, IPostCreateSignOrDocResult,\n    IReportInput, IReportGeneratorTools\n};\n\n// LabelTools interfaces\nexport type { IChangedLabels, ILabelManager, ILabelTools };\nexport { DOCUMENT_STATUS_LABEL_GROUP_TYPE };\n\n// LoggerTools interfaces\nexport type { ILoggerTools };\n\n// MailTools interfaces\nexport type {\n    IUserDropDown,\n    ITestCanned,\n    IUserLookup, IMailTools\n}\n\n// SearchTools interfaces\nexport type { ISearchTools, ICancelSearchEvent };\n\n// SmartTextTools interfaces\nexport type { ICaptionFormat, ISmartTextTools };\n\n// UITools interfaces\nexport type {\n    IToolTipCache, IDropDownButtonOption, IDialogOptions, ICIColor,\n    ICIColorList, IUIToolsEnum\n};\n\nexport { UIToolsConstants };\n\nexport type { ITimeZoneOption, ITimeZoneSetting };\n\nexport type {\n    IDateTimeUI, IBlockingProgressUITask, IBlockingProgressUI, IProgressUI,\n    ISelectUserOrGroupUI, ILT\n};\n\n// URLTools interfaces\nexport type { IMatrixUrlParts, IURLTools };\n\n// XPathTools interfaces\nexport type { IXPathToolsComp, IXPathTools };\n\n// IMatrix\nexport type { IMatrix };\n\n// ContextFrameTools interfaces\ninterface IContextInformation { project: string, user: string, server: string, version: string, product: string, itemId: string, item: string, fieldList: string }\n\ninterface IContextFramesTools {\n    showContextFrame(tabType: string, makeVisible: boolean);\n    getExpender();\n    visibility(enabled: boolean);\n    hideContextFrames();\n    showContextFrames();\n    renderContextFrames();\n    fillContextFrame(_data: IItem, itemId: string);\n    init();\n}\n\n// FileTools interfaces\ninterface IUploadedFileInfo { fileName: string, fileId?: string, uploaded?: boolean, fileObj?: any }\ninterface IFileDefinition { name: string }\n\ninterface IFileTools {\n    UploadFilesAsync(files: FileList | File[]): JQueryDeferred<IUploadedFileInfo[]>;\n    UploadFileAsync(file: File): JQueryDeferred<IUploadedFileInfo[]>;\n    convertXLSXAsync(file: IFileParam): JQueryDeferred<string>;\n}\n\n// ItemTools interfaces\n\n// For clients in simple environments (no app or matrixSession).\ntype GetTitleFunction = (itemId: string) => string;\ninterface ISimpleItemTools {\n    parseRef(itemRef: string, project: string, matrixBaseUrl: string): IItemIdParts;\n    getCreator(item: IItem): string;\n    getLastEditor(item: IItem): string;\n    refListToDisplayString(inputItems: IReference[] | null,\n        prefix: string, getTitleFunction: GetTitleFunction, shorten?: number): string;\n    renderLink(itemId: string, itemTitle: string, newWindow?: boolean);\n    updateReferences(oldReferences: IReference[], newReferences: IReference[], fromId: string | null, toId: string | null): IReferenceChange[];\n    clone(item: IItemGet, copyLabels: boolean): IItemPut;\n    sort(a: string, b: string, project: string, matrixBaseUrl: string);\n}\n\ninterface IItemTools {\n    parseRef(itemRef: string): IItemIdParts;\n    getCreator(item: IItem): string;\n    getLastEditor(item: IItem): string;\n    refListToDisplayString(inputItems: IReference[] | null, prefix: string, shorten?: number): string;\n    renderLink(itemId: string, itemTitle?: string, newWindow?: boolean);\n    updateReferences(oldReferences: IReference[], newReferences: IReference[], fromId: string | null, toId: string | null): IReferenceChange[];\n    clone(item: IItemGet, copyLabels: boolean): IItemPut;\n    sort(a: string, b: string);\n}\n\n// JSONTools interfaces\ninterface IJSONTools {\n    mergeOptions(defaultOptions: IBaseControlOptions, options: IBaseControlOptions): IBaseControlOptions;\n    setOptions(newOptions: IBaseControlOptions, options: IBaseControlOptions): IBaseControlOptions;\n    isTrue(obj: undefined | null | boolean | string | number): boolean;\n    isFalse(obj: undefined | null | boolean | string | number): boolean;\n    fromString(str: null | string): { status: string, value: {} };\n    clone(src: any): any;\n    escapeJson( code:string ):string;\n    unEscapeJson( code:string ):string;\n}\n\n// ReportGeneratorTools interfaces\ninterface IReportTask { reportId: string, jobId: number, progress: number, postCreateCallback: Function, postFailCallback?: Function, postProgressCallback?: Function, reportOptions?: IReportOptions }\ninterface IJobList { allGood: boolean, tasks: IReportTask[], doneBatch: number }\n\n// param for server post / get\ninterface IReportOptions extends IRestParam {format?:string, inline?:boolean, reason?:string, filter?:string, isSignedReport?:boolean,includeSignatures?:string, newTitle?:string, copyFields?:string, itemList?:string, url?:string, resturl?:string,reportNameOverride?:string}\ninterface IReportTransferField { fromId: string, toId: string }\n\ninterface IReportSetField { toId: string, value: string }\n\n// IReportProgress result from server:\ninterface IGetReportProgressResult { status: string, progress: number, jobFile: IGetReportProgressJobFileResult[], visibleName: string }\n// IJobFile Result from server\ninterface IGetReportProgressJobFileResult { internalPath: string, jobFileId: number, mimeType: string, restUrl: string, visibleName: string }\n\ninterface IPostCreateSignOrDocResult { jobId: number }\n\ninterface IReportInput { to: string }\n\ninterface IReportGeneratorTools {\n    SaveAndCreate(itemId: string, reportOptions: IReportOptions, progressInfo: string, postCreateCallback: Function, postFailCallback?: Function, postProgressCallback?: Function): void;\n    CreateSignedDoc(docId: string, signatures: string[], signedDocumentsControl: JQuery, labelFilter: string, signName: string, transferFields: IReportTransferField[], defaultLabels: string[],\n        docUpdateCb: (createdDocumentId: string) => void): void;\n    createSIGN(target: string, comment: string, docId: string, signatures: string[], signedDocumentsControl: JQuery, labelFilter: string, signName: string, transferFields: IReportTransferField[], defaultLabels: string[],\n        docUpdateCb: (createdDocumentId: string) => void): void;\n    // create and download a DOC\n    CreateDoc(docId: string, format: IReportOptions, labelFilter: string): void;\n    // create and download a report\n    CreateReport(reportId: string, format: IReportOptions, inputItems?: IReportInput[], requiredItems?: IReportInput[]): void;\n    // download a SIGNed doc with signatures\n    DownloadSignedDoc(signedId: string, format: IReportOptions);\n}\n\n\n// LabelTools interfaces\ninterface IChangedLabels {\n    changed: boolean,\n    added: string[],\n    removed: string[],\n    delta: string // a , separated string with +LABEL for added and -LABEL for removed labels\n}\n\nconst DOCUMENT_STATUS_LABEL_GROUP_TYPE = \"_DOCUMENT_STATUS_\";\n\ninterface ILabelManager {\n    // properties\n    ignoreProjectFilter: boolean;\n\n    // methods\n    getFilterColor(): string;\n    getFilter(): string;\n    getDisplayName(labelId: string);\n    getFilterName(labelId: string);\n    getLabelDefinitions(categories: string[]): ILabel[];\n    setFilter(filter: string[]);\n    resetReviewLabels(labelIds: string[], category: string, addXor?: boolean): string[];\n    getDefaultLabels(category: string): string[];\n    hasLabels();\n    setLabels(oldLabelIds: string, labels: string[]): string;\n    setLabel(oldLabelIds: string[], label: string): string[];\n    unsetLabel(oldLabelIds: string[], label: string): string[];\n    compareLabels(before: string[], after: string[]): IChangedLabels;\n    getLabelNames(): string[];\n    getDesignReview(labelId: string): IDesignReview | null;\n    isFiltered(category: string, labels: string): boolean;\n    getLabelsOfLabelGroupsType(labelGroupType: string): string[];\n    getLabelGroups(category?: string): ILabelGroup[];\n\n    /**\n     * In an {@link XRLabelHistory} object returned from the server, find the revision of the item\n     * with the given {itemId} at which {label} was last set. If {beforeRevision} is non-zero, the\n     * search will begin before that revision.\n     *\n     * @param labelHistory\n     * @param itemId\n     * @param label\n     * @param beforeRevision\n     */\n    decipherLastTimeLabelWasSet(labelHistory: XRLabelHistory, itemId: string, label: string, beforeRevision: number): number;\n}\n\ninterface ILabelTools extends ILabelManager {\n    /**\n     * Makes a server call to retrieve history for {itemId}, finds the revision of the item\n     * with the given {itemId} at which {label} was last set. If {beforeRevision} is non-zero, the\n     * search will begin before that revision.\n     *\n     * Returns the revision asynchronously.\n     *\n     * @param itemId\n     * @param label\n     * @param beforeRevision\n     */\n    getLastTimeLabelWasSet(itemId: string, label: string, beforeRevision: number): Promise<number>;\n}\n\n// LoggerTools interfaces\ninterface ILoggerTools {\n    log(id: string, msg: string);\n    debug(message: string): void;\n    info(message: string): void;\n    warning(message: string): void;\n    error(message: string): void;\n    getLog(): string;\n}\n\n// MailTools interfaces\ninterface IUserDropDown { id: string, label: string }\ninterface ITestCanned extends IMailConfigCanned { [key: string]: string | undefined }\ninterface IUserLookup extends XRUserPermissionType { [key: string]: string | number }\n\ninterface IMailTools {\n    /** send mail\n    * @param {type} to comma separated list of user ids\n    * @param {type} cc comma separated  list of user ids\n    * @param {type} bcc comma separated  list of user ids\n    * @param {type} subject default subject\n    * @param {type} body default body\n    * @param {type} systemMail set to 1 to send mail in name of system rather than user\n    *\n    * @returns {undefined} nothing\n    */\n    sendMail(to: string, cc: string, bcc: string, subject: string, body: string, systemMail?: number, noSuccess?: boolean, noReply?: number): JQueryDeferred<{}>;\n\n    /** show send mail dialog and send mail\n    * @param {type} sendTo comma separated list of user ids\n    * @param {type} preSelectedUsers available users or null if to use all project users\n    * @param {type} subject default subject\n    * @param {type} body default body\n    * @param {type} includeSupport whether to send it to matrix support\n    * @param {type} sendCc\n\n    * @returns {undefined} nothing\n    */\n    sendMailDlg(sendTo: string, preSelectedUsers: XRUserPermissionType[], subject: string, body: string, sendCc: string): void;\n\n    // replace a bunch of placeholders\n    replacePlaceholders(template: string, itemId: string, rejectComment: string, reviewers: string[], readers: string[], trainers: string[], trainees: string[]): string;\n\n    /** get default messages, replace a few strings\n     *\n     * @param {type} messageId\n     * @param {type} itemId\n     * @returns {undefined}\n     */\n    getCannedMessage(messageId: string, to: string, itemId: string, custom?: string, body?: string): string;\n\n    // send a bunch of individual mails\n    sendMails(sendTos: string[], subject: string, messages: string[]);\n}\n\n// SearchTools interfaces\ninterface ICancelSearchEvent { };\n\ninterface ISearchTools {\n    OnCancelSearch: IEvent<ICancelSearchEvent, void>\n    getFilter();\n    cancelSearch();\n    searchInDialog();\n    endSearchInDialog();\n    highlight(term: string);\n    hideHighlight();\n    renderHighlight();\n}\n\n// SmartTextTools interfaces\ninterface ICaptionFormat extends ICaption {\n    captionDetails: string,\n    captionClass: string,\n    referenceClassNo: string\n}\n\ninterface ISmartTextTools {\n    createMenu(docMode: boolean, tableMode: boolean): void;\n    deleteTag(what: string): void;\n    insertFigReference(reference: string, editor: any, editable: any);\n    insertTabReference(reference: string, editor: any, editable: any);\n    pasteBuffer(editor: any, editable: any);\n    createCaption(isTable: boolean, editor: Summernote.editor, editable: any);\n    updateCaptionsAndReferences();\n    createEditTag(tagType: number, what: string, data?: ISmartTextConfigReplacement, saveFct?: Function, forceTiny?: boolean): void;\n    selectEditCreateTag(mode: number, tagType: number, tagSelected: Function): void;\n    removeOuterParagraph(edit: string);\n    replaceTextFragments(text: string, showTooltips?: boolean, encoded?: boolean): string;\n    showTooltips(node: JQuery, noContainer?: boolean);\n    prepareForReadReadRender(itemDetails: JQuery);\n}\n\n// UITools interfaces\ninterface IToolTipCache { date: Date, item: IItem }\ninterface IDropDownButtonOption { name: string, class?: string, click: Function }\ninterface IDialogOptions {\n    container: JQuery,\n    title: string,\n    buttons: any[], // DialogButtonOptions\n    // optional\n    content?: JQuery,\n    minMaxWidth?: number,\n    minMaxHeight?: number,\n    scrolling?: UIToolsConstants.Scroll,\n    autoResize?: boolean,\n    maximizeButton?: boolean,\n    noXButton?: boolean\n    onClose?: Function,\n    onOpen?: Function,\n    onResize?: Function,\n    noCloseOnEscape?: boolean,\n}\n\ninterface ICIColor {\n    color: string,\n    alternateColor: string,\n}\n\ninterface ICIColorList {\n    [key: string]: ICIColor;\n}\n/*\nenum CIColors {\n\n\n}\n*/\ninterface IUIToolsEnum {\n    //\n    // Properties\n    //\n    widgetPluginsContainer: IWidgetPluginsContainer;\n    // date time formatting in UI\n    DateTime: IDateTimeUI;\n\n    // full screen (modal) progress\n    BlockingProgress: IBlockingProgressUI;\n\n    SelectUserOrGroup: ISelectUserOrGroupUI;\n\n    lt: ILT;\n\n    // bottom progress bar\n    Progress: IProgressUI;\n\n    ThemeSelector: IThemeSelector;\n\n    //\n    // Methods\n    //\n    fixC3ForCopy(copied: JQuery);\n\n    createDropDownButton(defaultText: string, options: IDropDownButtonOption[], isUp: boolean, buttonId?: string, disableDefaultButtonClick?: boolean): JQuery;\n    getNiceDialogSize(minWidth: number, minHeight: number): { width: number, height: number };\n    showSuccess(messageTitle: string, hideAfter?: number): void;\n    hideSuccess(): void;\n    hideError(): void;\n    showError(messageTitle: string, messageBody: string, showForMS?: number): void;\n    showAck(ackId: number, messageTitle: string, dlgTitle?: string): void;\n    showConfirm(confId: number, messageInfo: { title: string, ok: string, nok?: string, third?: string }, confFunction: Function, noConfFunction: Function, thirdFunction?: Function): void;\n    confirmSpinningWait(message: string);\n    closeConfirmSpinningWait();\n    showTooltip(itemId: string, target: JQuery, event: Event, crossProject?: string): void;\n    showTaskAsTooltip(id: string, title: string, url: string, htmlContent: string, target: JQuery): void;\n    hideTooltip(now?: boolean): void;\n    updateTooltip(): void;\n    spaceMessage(userHasSpaces: boolean, passwordHasSpaces: boolean): string;\n    getSpinningWait(message?: string): JQuery;\n    setEnabled(button: JQuery, enabled: boolean);\n    getDisplayError(jqxhr: IJcxhr, textStatus: string, error: string);\n    showDialog(dlg: JQuery, title: string, content: JQuery, minMaxWidth: number, minMaxHeight: number,\n        buttons: any[], // DialogButtonOptions\n        scrolling: UIToolsConstants.Scroll,\n        autoResize?: boolean,\n        maximizeButton?: boolean,\n        close?: Function,\n        open?: Function,\n        resize?: Function,\n        noCloseOnEscape?: boolean\n    );\n    showDialogDes({\n        // optional parameters with defaults\n        maximizeButton,                               // = false\n        noXButton,                                    // = false\n        autoResize,                                   // = false\n        onClose,                                      // = null\n        onOpen,                                       // = null\n        onResize,                                     // = null\n        noCloseOnEscape,                              // = false\n        minMaxWidth,                                  // = $(document).width() * 0.9\n        minMaxHeight,                                 // = app.itemForm.height() * 0.9\n        scrolling,                                    // = UIToolsConstants.Scroll.None\n        content,                                      // = null\n        // required parameters\n        container,\n        title,\n        buttons\n    }: IDialogOptions\n    );\n    pushDialog(thisDialog: JQuery);\n    popDialog(thisDialog: JQuery);\n    serverHtmlCleanupBlob(content: JQuery): JQueryDeferred<string>;\n    copyBuffer(anchor: JQuery, tooltip: string, content: JQuery, catchKey?: JQuery, onProcessCopy?: Function, btnText?: string, beforeCopy?: Function, afterCopy?: Function);\n    getIconOptions();\n    calculateColorFrom(input: string): ICIColor;\n    getAvatar(info: string, size: number): JQuery;\n    doCopy(content: JQuery, onProcessCopy: Function);\n    addChevronSection(container: JQuery, text: string, help: string, open?: boolean);\n    enableIf(cb: JQuery, state: boolean, ctrls: JQuery[]);\n    addCheckboxD(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, defaultValue: string);\n    addCheckbox(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function);\n    addCheckboxIsTrue(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function);\n    addCheckboxIsFalse(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function);\n    addPassInput(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, onUnFocus?: Function);\n    addTextInput(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, onFocusOut?: Function, isPass?: boolean, help?: string, readonly?: boolean,\n        rows?: number, allowResize?: boolean);\n    addRichTextInput(ui: JQuery, params: IRichTextParams, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, onFocusOut?: Function);\n    addDateSelect(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, help?: string, readonly?: boolean);\n    addIconInput(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, onFocusOut?: Function, isPass?: boolean);\n    addDropdownToArray(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, options: IDropdownOption[], grouping: IDropdownGroup[], maxItems: number, create: boolean, sort: boolean, onChange: Function, placeholder?: string);\n    addDropdownNumber(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, first: number, last: number,\n        onChange: Function, placeholder?: string, paramsBase?: IDropdownParams);\n    addDropdownToValue(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, options: IDropdownOption[],\n        create: boolean, sort: boolean, onChange: Function,\n        placeholder?: string, paramsBase?: IDropdownParams);\n    getPageTitle(title: string, getPanel?: () => JQuery, resize?: () => void): JQuery;\n    createConfigLine(lineId: string, linePrefix: string, lineName: string, lineArray: any[], idProp: string\n        , onChangedOrder: () => void\n        , onEdit: (lineId: string) => void\n        , needsEdit: boolean\n        , onDelete: (lineId: string) => void\n    );\n    fixArrows(ul: JQuery);\n    createConfigAddLine(action: string, onAdd: () => void);\n\n    standardizeColor(fieldValue: string,alpha?:number): string\n\n    toggleFilters(filterOn: boolean): void;\n\n    changeGlobalFilterSelectionEnabled(isEnabled:boolean):void;\n}\n\nclass UIToolsConstants {\n    static CIColors: ICIColorList =\n        {\n            Black: { color: \"#000\", alternateColor: \"#FFF\" },\n            BrownCoffeeRoyal: { color: \"#6C3008\", alternateColor: \"#FFF\" },\n            BlueEastBay: { color: \"#3D5A7F\", alternateColor: \"#FFF\" },\n            BlueLagoon: { color: \"#17125B\", alternateColor: \"#FFF\" },\n            BlueDoger: { color: \"#41B4FF\", alternateColor: \"#FFF\" },\n\n            BlueZiggurat: { color: \"#B3D9DD\", alternateColor: \"#000\" },\n            GreenYellow: { color: \"#B9D771\", alternateColor: \"#000\" },\n            GreenSushi: { color: \"#68C037\", alternateColor: \"#000\" },\n            YellowBrightSun: { color: \"#FFE541\", alternateColor: \"#000\" },\n            OrangeYellow: { color: \"#FBA043\", alternateColor: \"#000\" },\n            //YellowOrange:{bg:\"#FBA043\",fg:\"#000\"},\n\n            RedPersimmon: { color: \"#FF545D\", alternateColor: \"#FFF  \" },\n            VioletElectric: { color: \"#A543FB\", alternateColor: \"#000\" },\n            VioletMauve: { color: \"#DEA3FF\", alternateColor: \"#000\" },\n            PinkHot: { color: \"#FF6FBC\", alternateColor: \"#000\" },\n            BrownTiaMaria: { color: \"#C6490C\", alternateColor: \"#FFF\" },\n\n            BrownDiSerria: { color: \"#E19E72\", alternateColor: \"#FFF\" },\n            PinkBeautyBush: { color: \"#F5CECE\", alternateColor: \"#000\" },\n            GreyDark: { color: \"#838383\", alternateColor: \"#FFF\" },\n            GreyLightAlto: { color: \"#DCDCDC\", alternateColor: \"#000\" },\n            White: { color: \"#FFFFFF\", alternateColor: \"#000\" }\n        }\n\n    static CIColorsGrey: ICIColorList =\n        {\n            G0_VeryDark: { color: \"#1d2227\", alternateColor: \"#FFF\" },\n            G1: { color: \"#32373c\", alternateColor: \"#FFF\" },\n            G2: { color: \"#465055\", alternateColor: \"#FFF\" },\n            G3_GreyDark: { color: \"#838383\", alternateColor: \"#FFF\" },\n            G4: { color: \"#a9b3b8\", alternateColor: \"#FFF\" },\n            G5: { color: \"#cdd2d7\", alternateColor: \"#000\" },\n            G6: { color: \"#dbe0e5\", alternateColor: \"#000\" },\n            G7_GreyLightAlto: { color: \"#DCDCDC\", alternateColor: \"#000\" },\n            G8: { color: \"#f0f0f5\", alternateColor: \"#000\" },\n            G9: { color: \"#f5f5fa\", alternateColor: \"#000\" }\n        }\n\n    static allGrey = [\n        UIToolsConstants.CIColorsGrey.G0_VeryDark.color,\n        UIToolsConstants.CIColorsGrey.G1.color,\n        UIToolsConstants.CIColorsGrey.G2.color,\n        UIToolsConstants.CIColorsGrey.G3_GreyDark.color,\n        UIToolsConstants.CIColorsGrey.G4.color,\n        UIToolsConstants.CIColorsGrey.G5.color,\n        UIToolsConstants.CIColorsGrey.G6.color,\n        UIToolsConstants.CIColorsGrey.G7_GreyLightAlto.color,\n        UIToolsConstants.CIColorsGrey.G8.color,\n        UIToolsConstants.CIColorsGrey.G9.color\n    ]\n    // based on green sushi\n    static CIColorsPrimary: ICIColorList =\n        {\n            P0_LogoGreenYellow: { color: \"#b9d771\", alternateColor: \"#FFF\" },\n            P1: { color: \"#9bcf45\", alternateColor: \"#FFF\" },\n            P2: { color: \"#6dcf45\", alternateColor: \"#FFF\" },\n            P3_GreenSushi: { color: \"#68C037\", alternateColor: \"#FFF\" },\n            P4: { color: \"#75b10f\", alternateColor: \"#FFF\" },\n            P5: { color: \"#7aa608\", alternateColor: \"#FFF\" },\n            P6_LogoDarkGreen: { color: \"#007e8d\", alternateColor: \"#FFF\" },\n        }\n}\n\nmodule UIToolsConstants {\n    export enum Scroll {\n        Auto,\n        Vertical,\n        None\n    }\n}\n\ninterface ITimeZoneOption { val: string, text: string, timeformat?: string, dateformat?: string }\ninterface ITimeZoneSetting { [key: string]: string | ITimeZoneOption[] | undefined, timeZoneOptions: ITimeZoneOption[], settingsSource: string, timeformat?: string, dateformat?: string, timezone?: string }\n\ninterface IDateTimeUI {\n    initDateTimeSettings(update?: boolean): Promise<void>;\n    renderHumanDate(date: Date, dateOnly?: boolean): string;\n    renderCustomerHumanDate(date: Date, dateOnly?: boolean): string;\n    renderHumanMonth(dateObj: Date): string;\n    renderDashFormat(dateObj: Date): string;\n    renderSettingControlsAsync(options: { table: JQuery, user: string, help: string }): Promise<void>;\n    renderSettingDialog(user: string): void;\n    requiresTimeZoneWarning(): boolean;\n    getTimeZoneCTA(): JQuery;\n    getSimpleDateFormat(): string;\n    getSimpleDateFormatMoment();\n    getSimpleDateTimeFormatMoment();\n\n}\n\ninterface IBlockingProgressUITask { name: string, progress?: number }\ninterface IBlockingProgressUI {\n    Init(tasks: IBlockingProgressUITask[], animate?: boolean): void;\n    SetProgress(taskIdx: number, percent: number, newText?: string): void;\n    SetProgressError(taskIdx: number, problem: string): void;\n}\n\ninterface IProgressUI {\n    Init(message: string, warning?: boolean): void;\n    Update(progress: number): void;\n    SuccessHide(message: string, ms: number): void;\n    ErrorHide(message: string, ms: number): void;\n}\n\ninterface ISelectUserOrGroupUI {\n    showMultiUserSelect(container: JQuery, help: string, selected: string[], title: string, selectFrom: string, selectTo: string, showUsers: boolean, showGroups: boolean, onSelect: (selection: string[]) => void, preSelectedUsers?: XRUserPermissionType[]);\n    getUsersInSelection(selection: string[]);\n    getGroupId(group: XRGroupPermissionType | XRGroupType);\n    getGroupDisplayNameFromId(groupOrUserId: string);\n    isGroup(groupOrUserId: string);\n    exists(groupOrUserId: string);\n    showSelectDialog(selected: string[], title: string, selectFrom: string, selectTo: string, showUsers: boolean, showGroups: boolean, onSelect: (selection: string[]) => void, preSelectedUsers?: XRUserPermissionType[]);\n    getUserDropDownOptions(showUsers: boolean, showGroups: boolean,\n        preSelectedUsers?: XRUserPermissionType[], possiblyDeletedUsername?: string): IDropdownOption[];\n    showSingleSelect(control: JQuery, showUsers: boolean, showGroups: boolean, onSelect: (selection: string) => void, preSelectedUsers?: XRUserPermissionType[], possiblyDeletedUsername?: string);\n    getAllUsersAndGroups(): JQueryDeferred<IDropdownOption[]>;\n    showSingleSelectDialog(selected: string, title: string, help: string, showUsers: boolean, showGroups: boolean, onSelect: (selection: string) => void, preSelectedUsers?: XRUserPermissionType[]);\n}\n\ninterface ILT {\n    forDB(code: string, fieldId: number);\n    forUI(code: string, fieldId: number);\n}\n\n// URLTools interfaces\ninterface IMatrixUrlParts {\n    project: string,\n    item: string,\n    params: IStringMap\n}\n\ninterface IURLTools {\n    getParameterByName(url: string, name: string): string | null;\n    parseUrl(url: String): IMatrixUrlParts;\n}\n\n// XPathTools interfaces\ninterface IXPathToolsComp { name?: string, position: number }\ninterface IXPathTools {\n    get(node: JQuery);\n    hardCopy(element: JQuery);\n}\n\n// Overall library interface.\ninterface IMatrix {\n    Search: ISearchTools;\n    Item: IItemTools;\n    ContextFrames: IContextFramesTools;\n\n    // highlight / search function\n\n    JSON: IJSONTools;\n    XPath: IXPathTools;\n    URL: IURLTools;\n    Mail: IMailTools;\n\n    // console / error logging\n    Logger: ILoggerTools;\n\n    // label tools (labels and filters)\n    LabelTools: ILabelTools;\n\n    // tooltipsmessage boxes and other ui controls\n    UI: IUIToolsEnum;\n    File: IFileTools;\n    ReportGenerator: IReportGeneratorTools;\n    SmartText: ISmartTextTools;\n\n    /**\n     * Create a label tools object from the application context.\n     */\n    CreateNewLabelTools(): ILabelTools;\n}\n\nexport interface IApp extends IBaseApp {\n\n    mainApp: boolean;\n    mainTreeLoaded: boolean;\n    setCache(externalCache: DBCache): void;\n    loadProject(project: string, item: string): Promise<void>;\n    loadTree(project: string): JQueryDeferred<{}>;\n    loadTreeAndItem(project: string, item: string): JQueryDeferred<IItem>;\n    updateFavicon(project: string, notification: boolean): void;\n    waitForMainTree(callback: () => void): void;\n    loadTreeWithSearches(item: string): JQueryDeferred<unknown>;\n    getTree(subtreeFilter?: string[]): IDB[];\n    getSubTree(itemId: string): ISimpleTree;\n    getAuditDetailsAsync(auditId?: number, ignoreErrors?: boolean): JQueryDeferred<XRTrimAudit>;\n    getItemAsync(itemId: string, version?: number, ignoreErrors?: boolean, noHistory?: boolean): JQueryDeferred<IItem>;\n    getNeedlesAsync(searchExpr: string, up?: boolean, down?: boolean, fields?: string, labels?: boolean, ignoreFilters?: boolean): JQueryDeferred<IItem[]>;\n    getItemProjectAsync(project: string, itemId: string, ignoreErrors?: boolean): JQueryDeferred<IItem>;\n    getProjectItemAsync(project: string, itemId: string, version?: number, includeHistory?: boolean): JQueryDeferred<IItem>;\n    getProjectCatFields(project: string): JQueryDeferred<XRCategoryExtendedType[]>;\n    getItemFromTree(itemId: string): IDB;\n    getChildrenIds(parentId: string): string[];\n    getChildrenIdsRec(itemId: string): string[];\n    getParentId(itemId: string): string;\n    getCategoryBreadcrumbs(category: string): string[];\n    getBreadcrumbs(itemId: string): string[];\n    setStyle(itemIds: string[], style: string, computeFolder: number): void;\n    getRootOfType(category: string): string;\n    startReportAsync(itemId: string, reportOptions: IReportOptions): JQueryDeferred<{}>;\n    canLaunchReport(): JQueryDeferred<boolean>;\n    startCreateDocumentAsync(itemId: string, reportOptions: IReportOptions): JQueryDeferred<XRPostProject_LaunchReport_CreateReportJobAck>;\n    getReportDetails(jobId: number): JQueryDeferred<XRGetProject_JobStatus_JobsStatusWithUrl>;\n    compareHTML(compareParams: XCPostCompareHtml): JQueryDeferred<XRPostProject_CompareHtml_HtmlCompareResult>;\n    isFolder(itemId: string): boolean;\n    getItemTitle(itemId: string, display?: boolean): string;\n    download(jobId: number, file: number, param?: string[]): void;\n    downloadFromUrl(url: string, param?: IStringMap): void;\n    downloadInMemory(jobId: number, file: string, dataType?: string): JQueryDeferred<string>;\n    downloadInMemoryFromUrl(url: string): JQueryDeferred<string>;\n    searchAsync(term: string, filter?: string, ignoreFilters?: boolean, fieldList?: string, crossProject?: string, labels?: boolean, down?: boolean, up?: boolean, treeOrder?: boolean): JQueryDeferred<ISearchResult[]>;\n    searchAsyncMinimalOutput(term: string, filter?: string, ignoreFilters?: boolean, crossProject?: string): JQueryDeferred<string[]>;\n    updateItemInDBAsync(itemJson: IItemPut, auditAction: string, requireVersion?: number): JQueryDeferred<IItemGet>;\n    getItemFromDBAsync(itemId: string): Promise<IItem>;\n    getFieldFromDBAsync(itemId: string, fieldName: string): Promise<any>;\n    setFieldInDBAsync(itemId: string, fieldName: string, value: string): Promise<any>\n    setFieldsInDBAsync(itemId: string, data: ISetField[]): Promise<any>\n    createItemOfTypeAsync(category: string, itemJson: IItemPut, actions: string, parentId: string, dontFailOnCleanup?: boolean): JQueryDeferred<IDBParent>;\n    restoreItemAsync(itemId: string, title: string, version: number): JQueryDeferred<IRestoreItemResult>;\n    deleteItem(itemId: string): JQueryDeferred<{}>;\n    uploadFileProjectAsync(file: IFileParam, progress: (p:IFileUploadProgress) =>  void): JQueryDeferred<{}>;\n    fetchFileAsync(url: string, progress: (p:IFileUploadProgress) =>  void): JQueryDeferred<XRPostProject_AddFile_AddFileAck>;\n    resizeItem(force?: boolean): void;\n    itemChanged(needsSave: boolean): void;\n    updateItem(newItem: IItem): void;\n    setFieldValue(fieldId: number, newValue: string): void;\n    getFieldValueAsync(fieldId: number): Promise<any>;\n    getCurrentTitle(): Promise<string>;\n    addDownLinkAsync(fromId: string, toId: string): JQueryDeferred<{}>;\n    removeDownLinkAsync(fromId: string, toId: string): JQueryDeferred<{}>;\n    setSettingJSON(key: string, valueJSON: {}):JQueryDeferred<{}>;\n    readSettingJSONAsync(key: string, otherProject?: string, noRetry?: boolean): JQueryDeferred<{}>;\n    setSettingCustomerJSON(key: string, valueJSON: {}): JQueryDeferred<unknown>;\n    readSettingCustomerJSONAsync(key: string): JQueryDeferred<{}>;\n    getMissingUpLinks(item: IItem): string[];\n    isUpLinkMissing(item: IItem): boolean;\n    getMissingDownLinks(item: IItem): string[];\n    getLinkCategories(item: IItem, ctrlParameter: ILinkCollectionOptions): ILinkCategories[];\n    isDownLinkMissing(item: IItem): boolean;\n    isAnyLinkOutdated(item: IItem): boolean;\n    hasLinks(item: IItem): boolean;\n    isHiddenLink(itemId: string): {};\n    setHiddenLink(itemId: string, hidden: number): void;\n    saveAsync(sendUnEdit: boolean): JQueryDeferred<{}>;\n    forceReadonly(itemId: string): void;\n    cancel(): void;\n    someOneElseChanged(): void;\n    someOneIsChangingTheItem(): void;\n    waitForEditRights(): void;\n    someOneElseIsChanging(watcherInfo: IItemWatched): void;\n    someOneElseWasChanging(watcherInfo: IItemWatched): void;\n    someOneElseStoppedEditing(watcherInfo: IItemWatched, previousWatcherInfo: IItemWatched): void;\n    updateItemViewers(watcherInfo: IItemWatched): void;\n    getVersion(): string;\n    getVersionQualifier(): string;\n    getNeedsSave(): boolean;\n    getType(itemId: string): string;\n    getAvailableReportsAsync(): JQueryDeferred<XRGetProject_Reports_GetReportsAck>;\n    getDeletedItemsAsync(insertInList: (item:IVersionDetails)=> void, progress: (p:number)=>void, deleteLog?: IVersionDetails[], startAt?: number): JQueryDeferred<{}>;\n    getActivityAsync(insertInList: (item:IVersionDetails, first?:number, last?:number, referenceChange?:IReferenceUpdate) => void, startAt?: number, count?: number, auditIdMin?: number, auditIdMax?: number): JQueryDeferred<number>;\n    canNavigateAwayAsync(): JQueryDeferred<{}>;\n    treeSelectionChangeAsync(newItemId: string): JQueryDeferred<{}>;\n    moveItemsAsync(itemIds: string, newFolder: string, newPosition?: number, useComment?: string): JQueryDeferred<{}>;\n    updateMaxVersion(itemId: string): JQueryDeferred<{}>;\n    removedFromTree(itemId: string, parentId: string): void;\n    insertInTree(newItem: IDBParent): void;\n    copyFrom(target: string, source: IDB): void;\n    updateCache(newItem: IUpdateCache): void;\n    createItemUrl(itemId?: string, crossProject?: string): string;\n    renderItem(cachedItem?: IItem): void;\n    print(): void;\n    touchAsync(itemOrFolderId: string, depth: number): JQueryDeferred<string>;\n    setLabels(newLabels: IItemGet): JQueryDeferred<{}>;\n    needsSave(): boolean;\n    signItemAsync(itemId: string, password: string, meaning?: string): JQueryDeferred<XRPostProject_SignItem_SignItemAck>;\n    checkPassword(password: string): JQueryDeferred<IRestResult>;\n    convertDocAsync(fileNo: number, targetDocumentFolder?: string, useOriginal?: boolean): JQueryDeferred<string>;\n    pingCurrentItem(): void;\n    getCurrentItemId(): string;\n    commitChangeListAsync(changeList: IReferenceChange[]): JQueryDeferred<{}>;\n    isMedical(strict?: boolean): boolean;\n    commentRequired(): boolean;\n    touchToolAvailable(item: IItem): boolean;\n    auditTrailAvailable(): boolean;\n    mailToolAvailable(): boolean;\n    postLogin(user: string): void;\n    canDeleteItem(item: IItem): boolean;\n    canViewItem(item: IItem): boolean;\n    getImportSource( item:IItemGet ):XRCrossProjectLink;\n    getUsedBy( item:IItemGet ):XRCrossProjectLink[];\n    canEditItem(item: IItem): boolean;\n    canCreateItemType(category: string, folder?: boolean): boolean;\n    canDragDrop(category: string, id: string): boolean;\n    canSeeField(category: string, field: number): boolean;\n    canEditField(category: string, field: number): boolean;\n    evaluateTraceRule(item: IItem, checkDownRule: boolean): ITraceRules;\n    dragEnter?:(dragged:Fancytree.FancytreeNode, target:Fancytree.FancytreeNode) => string[]|boolean;\n}\nexport interface IBaseApp{\n    getParentId(itemId: string): string;\n    itemChanged(needsSave: boolean): void;\n    getVersion(): string;\n    getVersionQualifier(): string;\n    getNeedsSave(): boolean;\n    getCurrentItemId(): string;\n    pingCurrentItem(): void;\n    canDragDrop(nodeType: string, pageId: string): boolean;\n    dragEnter?: (dragged: Fancytree.FancytreeNode, target: Fancytree.FancytreeNode) => string[] | boolean;\n    getTree(subtreeFilter?: string[]): IDB[];\n    pingCurrentItem(): void;\n    itemForm: JQuery;\n    printForm: JQuery;\n    dlgForm: JQuery;\n    postLogin(user: string): void;\n    isConfigApp(): boolean;\n\n}\n","import { SearchTools } from \"./SearchTools\";\nexport * from \"./ItemTools\";\nexport * from \"./ContextFramesTools\";\nexport * from \"./FileTools\";\nexport * from \"./HTMLCleaner\";\nexport * from \"./JSONTools\";\nexport * from \"./LabelTools\";\nexport * from \"./LoggerTools\";\nexport * from \"./MailTools\";\nexport * from \"./ReportGeneratorTools\";\nexport * from \"./SmartTextTools\";\nexport * from \"./UITools\";\nexport * from \"./URLTools\";\nexport * from \"./XPathTools\";\n\nexport { SearchTools };\nexport {DateTimeUI} from \"./DateTimeUI\";\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { app } from \"../../globals\";\nimport { ISearchTools, ICancelSearchEvent } from \"./MatrixLibInterfaces\";\nimport { EventDispatcher } from \"../businesslogic/MatrixRequirementsAPI\";\n\nexport { SearchTools };\n\nclass CancelSearchEvent implements ICancelSearchEvent {\n};\n\nclass SearchTools implements ISearchTools {\n    // global filter is used to remember highligh after changes: a call to\n    private globalFilter:string;\n    \n    // context is used to highlight only in select from tree dialog. by default all is\n    private highlightContext: JQuery = $(\"#highlightContext\");\n    public OnCancelSearch: EventDispatcher<ICancelSearchEvent> = new EventDispatcher<ICancelSearchEvent>();\n\n    getFilter() {\n        return this.globalFilter;\n    }\n    cancelSearch() {\n        // from all search filters, remove the search term and details\n        $(\".treeCtrl input[name=search]\").val(\"\");\n        $(\".treeCtrl :checkbox\").prop(\"checked\", false);\n        // remove any kind of highlighting in main tree\n        this.OnCancelSearch.dispatch(new CancelSearchEvent());\n        this.hideHighlight();\n    }\n    searchInDialog() {\n        this.cancelSearch();\n        // now set search to dialog\n        this.highlightContext = app.dlgForm;\n    };\n    endSearchInDialog() {\n        this.highlightContext = $(\"#highlightContext\");\n        this.globalFilter = \"\";\n    };\n    highlight(term:string) {\n        this.globalFilter = term;\n        this.renderHighlight();\n    };\n    hideHighlight() {\n        this.globalFilter = \"\";\n        this.highlightContext.unhighlight();\n        this.updateTinys();\n    };\n    \n    renderHighlight() {\n        this.highlightContext.unhighlight();\n\n        if (this.globalFilter && this.globalFilter.length > 0) {\n            this.highlightContext.highlight(this.globalFilter);\n        }\n        this.updateTinys();\n    }\n\n    private updateTinys() {\n        let that = this;\n        if (this.globalFilter) {\n            $(\".thisIsTiny\").each( function(idx, tiny) { \n                let editor = tinymce.get( $(tiny).attr(\"id\"));\n                if ( editor) {\n                    $(editor.getBody()).unhighlight().highlight(that.getFilter());\n                }\n            }); \n        } else {\n            $(\".thisIsTiny\").each( function(idx, tiny) { \n                let editor = tinymce.get( $(tiny).attr(\"id\"));\n                if ( editor) {\n                    $(editor.getBody()).unhighlight();\n                }\n            }); \n        }\n    }\n}\n","import { MatrixSession } from \"./common/businesslogic/index\";\nimport { JsonValidator } from \"../jsonvalidation/JsonValidator\";\nimport { ItemConfiguration } from \"./common/businesslogic/index\";\nimport { Application } from \"./common/UI/Application\";\nimport { RestConnector } from \"./common/businesslogic/index\";\nimport { XRCrossProjectLink, XRTrimLink, XRCategoryAndRoot } from \"./RestResult\";\n\nimport { IApp } from \"./common/matrixlib/MatrixLibInterfaces\";\n\nexport type {\n    Admin, MatrixReq, Error, IControlDefinition, IGenericMap, IAnyMap,\n    IStringMap, IItemGetMap, INumberStringMap, IStringNumberMap, IBooleanMap,\n    IStringStringArrayMap, IStringJQueryMap, IJsonSetting, IRestParam,\n    IRestResult\n};\nexport type {\n    IReference, IItemIdParts, IReferenceChange,\n    IEmail, IDevice, ISize, IItem, ILink, IItemGet, IItemPut, IItemHistory,\n    IDataStorage\n};\nexport { ControlState, globalMatrix }\nexport { matrixSession, restConnection, app, matrixApplicationUI };\nexport { setIC, setMatrixSession, setRestConnection, setMatrixApplicationUI, setApp };\nexport { InstallLegacyAdaptor };\n\n// TODO(modules) why are these 2 interfaces here? To solve some type error elsewhere?\ninterface Admin { }\ninterface MatrixReq { }\n\ninterface Error { name: string, message: string }\ninterface IControlDefinition {\n    name?: string,\n    control?: JQuery,\n    fieldId?: number,\n    isDhfType?: boolean,\n\n    /**\n     * fieldType is set if this control supports displaying a particular kind of field.\n     * See FieldDescriptions for a list of many of the field types.\n     */\n    fieldType?: string\n}\n\n// helper to allow things like x={}; x[y] = 1\ninterface IGenericMap {\n    [key: string]: any\n}\ninterface IAnyMap { [key: string]: any }\ninterface IStringMap { [key: string]: string }\ninterface IItemGetMap { [key: string]: IItemGet }\ninterface INumberStringMap { [key: number]: string }\ninterface IStringNumberMap { [key: string]: number }\ninterface IBooleanMap { [key: string]: boolean }\ninterface IStringStringArrayMap { [key: string]: string[] }\ninterface IStringJQueryMap { [key: string]: JQuery }\n\ninterface IJsonSetting { id: string, value: any }\n\ninterface IRestParam extends Object { td?: number, reason?: string, filter?: string, [key: string]: any };\ntype IRestResult = {} | string;\n\nexport class GlobalMatrix {\n    // these should go once everything is converted...\n    verbose: boolean;\n    ItemConfig: ItemConfiguration;\n    PopulateProjects: Function; // exists only in admin client\n\n    mobileApp: {\n        Login: Function,\n        ShowLoginScreen: Function,\n        ShowMobileUI: Function\n    }; // exists only in mobile app\n    jiraPlugin: any; // jira cloud plugin\n\n    // declare var EmbeddedReport:any;\n    Admin: any;\n\n    doc: any; // no idea used in ContextFrames..\n\n    ITEM_DOES_NOT_EXIST: string;\n    matrixRestUrl: string; // delivered by server\n    matrixBaseUrl: string; // delivered by server\n    matrixWfgw: string; // delivered by server\n    matrixExpress: boolean; // delivered by server\n    matrixProduct: string; // delivered by server\n    matrixUniqueSerial: string; // delivered by server\n    mxOauth: string; // delivered by server\n    mxOauthLoginUrl: string; // delivered by server\n\n    serverStorage: IDataStorage; // keeps information in local client storage per server\n\n    projectStorage: IDataStorage; // keeps information in local client storage per project\n\n\n    wfgwConnection: RestConnector; // global plugin rest connection\n\n    globalShiftDown: boolean;\n    globalCtrlDown: boolean;\n\n    jsonValidator: JsonValidator;\n\n    // filter for activity stream / calendar\n    historyFilter;\n    // legacy,js\n    EmbeddedReport: any;\n\n    constructor() {\n        this.ITEM_DOES_NOT_EXIST = \"\";\n        this.globalShiftDown = false;\n        this.globalCtrlDown = false;\n        this.historyFilter = \"merge,delete,undelete,add,edit,execute,reviewed,signature,report,touch,release\";\n        this.mobileApp = undefined;\n    }\n\n    installLegacyAdaptor() {\n        globalThis.ITEM_DOES_NOT_EXIST = this.ITEM_DOES_NOT_EXIST;\n        globalThis.matrixRestUrl = this.matrixRestUrl;\n        globalThis.matrixBaseUrl = this.matrixBaseUrl;\n        globalThis.matrixWfgw = this.matrixWfgw;\n        globalThis.matrixExpress = this.matrixExpress;\n        globalThis.matrixProduct = this.matrixProduct;\n        globalThis.mxOauth = this.mxOauth;\n        globalThis.mxOauthLoginUrl = this.mxOauthLoginUrl;\n\n        globalThis.serverStorage = this.serverStorage;\n        globalThis.projectStorage = this.projectStorage;\n        globalThis.wfgwConnection = this.wfgwConnection;\n\n        globalThis.globalShiftDown = this.globalShiftDown;\n        globalThis.globalCtrlDown = this.globalCtrlDown;\n\n        globalThis.jsonValidator = this.jsonValidator;\n    }\n\n}\n\nvar globalMatrix: GlobalMatrix = new GlobalMatrix();\n\nfunction setIC(newIC: ItemConfiguration) {\n    globalMatrix.ItemConfig = newIC;  // To use in matrixSdk\n    globalThis.IC = newIC; // legacy support\n}\nvar matrixSession: MatrixSession;\nfunction setMatrixSession(session: MatrixSession) {\n    matrixSession = session;\n}\nvar restConnection: RestConnector; // global rest connection\nfunction setRestConnection(rc: RestConnector) {\n    restConnection = rc;\n}\nvar matrixApplicationUI: Application; // the application\nfunction setMatrixApplicationUI(ui: Application) {\n    matrixApplicationUI = ui;\n}\n\n// TODO(modules): app was declared as interface MatrixReq, which is empty, and then usually\n// assigned to a variable of type businesslogic/UI/MatrixReq. We just opt out of typing for\n// this variable and ideally we should fix that with a real interface. I changed the type to\n// any to make the true situation easier to see.\nvar app: IApp; // main application\nfunction setApp(newApp: any) {\n    app = newApp;\n}\n\n// type JQuery = any;\n\n// global interfaces by matrix\ninterface IReference {\n    projectShortLabel?: string,\n    to: string,\n    title: string,\n    modDate?: string,\n    isIndirect?: boolean\n}\ninterface IItemIdParts { id: string, version: number, type: string, isFolder: boolean, url: string, link: string, linkv: string, number: number }\ninterface IReferenceChange { action: string, fromId: string, toId: string }\n\ninterface IEmail { summary: string, description: string, matrixProject: string, matrixItem: string, browser: string, log: string, email?: string };\ninterface IDevice { screen: ISize, viewport: ISize }\ninterface ISize { width: number, height: number }\n\ninterface IItem {\n    upLinks?: IReference[],\n    upLinkList?: XRTrimLink[],\n    downLinks?: IReference[],\n    children?: IItem[],\n    history?: IItemHistory[],\n    modDate?: string,\n    isUnselected?: number,\n    availableFormats?: string[],\n    selectSubTree?: XRCategoryAndRoot[],\n    requireSubTree?: XRCategoryAndRoot[],\n    icon?: string,\n    type?: string,\n    id?: string,\n    title?: string,\n    linksUp?: string,\n    linksDown?: string,\n    isFolder?: boolean,\n    isDeleted?: boolean,\n    maxVersion?: number,\n    docHasPackage?: boolean,\n\n    [key: string]: any\n}\n\n// a link from one item to another item\ninterface ILink { from: string, to: string }\n\ninterface IItemGet extends IItem { labels?: string[], crossLinks?:XRCrossProjectLink[] }\ninterface IItemPut extends IItem { labels?: string, onlyThoseFields?: number, onlyThoseLabels?: number }\n\ninterface IItemHistory {\n    action: string, user: string, dateUserFormat: string, comment: string,\nid:string, version:number, date:string, title:string, deletedate?:string }\n\n\ninterface IDataStorage {\n    setItem: (itemKey:string, itemVal:string, sanitize?:boolean) => void,\n    getItem: (itemKey:string, dontSanitize?:boolean) => string\n    getItemDefault: (itemKey:string,  defaultValue:string) => string\n}\n\n\nenum ControlState {\n    FormEdit= 0, //this is a embedded form which allows the user to modify the content\n    FormView, //this is read only version with (some) read only tools enabled (e.g. history)\n    DialogCreate, //this allows the user to modify the content, usually to create new elements. No tools\n    HistoryView, //is a read only version, e.g. used for the history where smart text and smart link is not resolved\n    Tooltip, // most things will not shown as tooltip...\n    Print, // for printing ...\n    Report, // special to render report into page\n    DialogEdit, // between FormEdit and DialogCreate to edit an item in popup\n    Review // special mode for design reviews\n};\n\n// This is so that old legacy scripts can \"just work\" to a degree.\nfunction InstallLegacyAdaptor() {\n    globalThis.ControlState = ControlState;\n    globalThis.IC = globalMatrix.ItemConfig;\n    globalThis.matrixSession = matrixSession;\n    globalThis.restConnection = restConnection;\n    globalThis.app = app;\n    globalThis.matrixApplicationUI = matrixApplicationUI;\n    globalMatrix.installLegacyAdaptor();\n    globalThis.applyResponsiveView = applyResponsiveView;\n}\n\nexport function applyResponsiveView() {\n    let mobileView = localStorage.getItem( \"mobileLayout\" );\n    let x= $(window).width();\n    if (mobileView) {\n        $('#contextframesizer').css(\"display\", \"none\");\n        $('#dragbar').css(\"display\", \"none\");\n    }\n    if (mobileView==\"0\") { // see item\n        $('#sidebar').css(\"display\", \"none\");\n        $(\"#navLeft\").css(\"display\", \"none\");\n        $('#main').css(\"left\", 0).css(\"display\", \"block\");\n    } else if (mobileView==\"1\") { // see navigation tree\n        $('#sidebar').css(\"width\", x).css(\"display\", \"block\");\n        $('#main').css(\"display\", \"none\");\n        $(\"#navLeft\").css(\"display\", \"\");\n    } else  if (mobileView==\"2\") {  // see both\n        $('#sidebar').css(\"width\", (x/2) + \"px\");\n        $(\"#navLeft\").css(\"display\", \"\");\n        $('#main').css(\"left\",  (x/2) + \"px\").css(\"display\", \"block\");\n    } else { // not mobile\n        $('#dragbar').css(\"display\", \"block\");\n        $('#contextframesizer').css(\"display\", \"block\");\n        $(\"#navLeft\").css(\"display\", \"\");\n        $('#main').css(\"display\", \"block\");\n    }\n\n    app.resizeItem(true);\n\n}\n","import { ItemControl } from \"../UI/Components/index\";\nimport { IItem } from \"./../../globals\";\nimport { IDBParent } from \"./DBCache\";\n\nexport type {\n    IItemViewEvent, IItemChangeEvent, IPreCreateItemEvent, IPreCreateCloseEvent, IGenericItemEvent,\n    IGenericItemIdEvent, INewItemIdEvent, ILabelChangeEvent, ISignatureEvent, IEvent\n};\nexport { EventDispatcher, EventDispatcherAsync, MR1 };\n\ninterface IItemViewEvent { caller: any, item: IItem, view: ItemControl }\n\ninterface IItemChangeEvent { caller: any, view: ItemControl, before: IItem, after: IItem }\n\ninterface IPreCreateItemEvent { caller: any, view: ItemControl, isItem: boolean, category: string }\ninterface IPreCreateCloseEvent { caller: any, ok: boolean }\n\ninterface IGenericItemEvent { caller: any, item: IItem }\ninterface IGenericItemIdEvent { caller: any, itemId: string }\ninterface INewItemIdEvent { caller: any, item: IDBParent }\n\ninterface ILabelChangeEvent { caller: any, item: IItem, set: string[], unset: string[] }\ninterface ISignatureEvent { caller: any, item: IItem, lastuser: boolean }\n\ninterface IEvent<TArgs, TMode> {\n  subscribe(caller:any, fn: (args: TArgs) => TMode): void;\n  unsubscribe(fn: (args: TArgs) => TMode): void;\n  dispatch( args:TArgs):TMode;\n}\n\nclass EventDispatcher<TArgs> implements IEvent<TArgs, void> {\n\n    private _subscriptions: Array < ( args: TArgs) => void > = new Array < ( args: TArgs) => void > ();\n    private _callers: Array < any > = new Array < any > ();\n\n    subscribe(caller:any, fn: ( args: TArgs) => void): void {\n        this._callers.push(caller);\n        this._subscriptions.push(fn);\n    }\n\n    unsubscribe(fn: ( args: TArgs) => void): void {\n        var i = this._subscriptions.indexOf(fn);\n        if (i > -1) {\n            this._subscriptions.splice(i, 1);\n            this._callers.splice(i, 1);\n        }\n    }\n\n    dispatch( args: TArgs): void {\n        for (var i = 0; i < this._subscriptions.length; i++) {\n            var handler = this._subscriptions[i];\n            if (handler != null) {\n                (<{caller:any}><any>args).caller = this._callers[i];\n                handler(  args );\n            }\n        }\n    }\n}\n\nclass EventDispatcherAsync<TArgs> implements IEvent<TArgs, JQueryDeferred<{}>> {\n\n    private _subscriptionsAsync: Array < ( args: TArgs) => JQueryDeferred<{}> > = new Array < ( args: TArgs) =>  JQueryDeferred<{}> > ();\n    private _callersAsync: Array < any > = new Array < any > ();\n\n    // now same for asyncs\n    subscribe(caller:any, fn: ( args: TArgs) =>  JQueryDeferred<{}>): void {\n        this._callersAsync.push(caller);\n        this._subscriptionsAsync.push(fn);\n    }\n    unsubscribe( fn: ( args: TArgs) =>  JQueryDeferred<{}>): void {\n        var i = this._subscriptionsAsync.indexOf(fn);\n        if (i > -1) {\n            this._subscriptionsAsync.splice(i, 1);\n            this._callersAsync.splice(i, 1);\n        }\n    }\n\n    dispatch( args: TArgs):JQueryDeferred<{}> {\n        return this.dispatchAsyncOne(args,0);\n    }\n    private dispatchAsyncOne( args:TArgs, idx:number):JQueryDeferred<{}> {\n        let that = this;\n\n        let res = $.Deferred();\n        if (idx >= this._subscriptionsAsync.length ) {\n            res.resolve();\n            return res;\n        }\n\n        var handler = this._subscriptionsAsync[idx];\n        if (handler != null) {\n            (<{caller:any}><any>args).caller = this._callersAsync[idx];\n            handler( args ).done( function() {\n                that.dispatchAsyncOne(args, idx+1).done( function() {\n                    res.resolve();\n                }).fail( function() {\n                    res.reject();\n                });\n            }).fail( function() {\n                res.reject();\n            });\n        } else {\n            that.dispatchAsyncOne(args, idx+1).done( function() {\n                res.resolve();\n            }).fail( function() {\n                res.reject();\n            });\n        }\n\n        return res;\n    }\n}\n\n\nexport class MR1Impl {\n\n    cbsItemDisplayed: EventDispatcher<IItemViewEvent> = new EventDispatcher<IItemViewEvent>();\n    cbsCreateItemDisplayed: EventDispatcher<IPreCreateItemEvent> = new EventDispatcher<IPreCreateItemEvent>();\n    cbsCreateItemDisplayedClose: EventDispatcher<IPreCreateCloseEvent> = new EventDispatcher<IPreCreateCloseEvent>();\n    cbsBeforeSave: EventDispatcherAsync<IItemChangeEvent> = new EventDispatcherAsync<IItemChangeEvent>();\n    cbsAfterSave: EventDispatcher<IItemChangeEvent> = new EventDispatcher<IItemChangeEvent>();\n    cbsAfterRestore: EventDispatcher<IGenericItemIdEvent> = new EventDispatcher<IGenericItemIdEvent>();\n    cbsAfterDelete: EventDispatcher<IGenericItemEvent> = new EventDispatcher<IGenericItemEvent>();\n    cbsAfterCreate: EventDispatcher<INewItemIdEvent> = new EventDispatcher<INewItemIdEvent>();\n    cbsAfterCreateSign: EventDispatcher<IGenericItemEvent> = new EventDispatcher<IGenericItemEvent>();\n    cbsBeforeDelete: EventDispatcherAsync<IGenericItemEvent> = new EventDispatcherAsync<IGenericItemEvent>();\n    cbsAfterLabelChange: EventDispatcher<ILabelChangeEvent> = new EventDispatcher<ILabelChangeEvent>();\n    cbsAfterSignature: EventDispatcher<ISignatureEvent> = new EventDispatcher<ISignatureEvent>();\n\n    // triggers\n\n    triggerItemCreate(view: ItemControl, isItem: boolean, category: string) { this.cbsCreateItemDisplayed.dispatch(<IPreCreateItemEvent>{ view: view, isItem: isItem, category: category }); }\n    triggerItemCreateClose(ok: boolean) { this.cbsCreateItemDisplayedClose.dispatch(<IPreCreateCloseEvent>{ ok: ok }); }\n    triggerItemDisplayed(item: IItem, view: ItemControl) { this.cbsItemDisplayed.dispatch(<IItemViewEvent>{ item: item, view: view }); }\n    triggerBeforeSaveAsync(view: ItemControl, before: IItem, after: IItem): JQueryDeferred<{}> { return this.cbsBeforeSave.dispatch(<IItemChangeEvent>{ view: view, before, after }); }\n    triggerAfterSave(view: ItemControl, before: IItem, after: IItem) { this.cbsAfterSave.dispatch(<IItemChangeEvent>{ before: before, after: after, view: view }); }\n    triggerAfterRestore(itemId: string) { this.cbsAfterRestore.dispatch(<IGenericItemIdEvent>{ itemId: itemId }); }\n    triggerAfterDelete(item: IItem) { this.cbsAfterDelete.dispatch(<IGenericItemEvent>{ item: item }); }\n    triggerAfterItemCreate(item: IDBParent) { this.cbsAfterCreate.dispatch(<INewItemIdEvent>{ item: item }); }\n    triggerAfterCreateSign(item: IItem) { this.cbsAfterCreateSign.dispatch(<IGenericItemEvent>{ item: item }); }\n    triggerBeforeDeleteAsync(item: IItem): JQueryDeferred<{}> { return this.cbsBeforeDelete.dispatch(<IGenericItemEvent>{ item: item }); }\n    triggerAfterLabelChange(item: IItem, before: string[], after: string[]) { this.cbsAfterLabelChange.dispatch(<ILabelChangeEvent>{ item: item, set: before, unset: after }); }\n    triggerAfterSignature(item: IItem, lastuser: boolean) { this.cbsAfterSignature.dispatch(<ISignatureEvent>{ item: item, lastuser: lastuser }); }\n\n    // notifications\n\n    onItemDisplayed(): IEvent<IItemViewEvent, void> { /* fired after item is rendered */ return this.cbsItemDisplayed; }\n    onItemCreateDlgOpen(): IEvent<IPreCreateItemEvent, void> { /* fired after dialog is opened */ return this.cbsCreateItemDisplayed; }\n    onItemCreateDlgClose(): IEvent<IPreCreateCloseEvent, void> { /* fired after dialog is closed */ return this.cbsCreateItemDisplayedClose; }\n    onAfterSave(): IEvent<IItemChangeEvent, void> {  /* fired after item was saved */ return this.cbsAfterSave; }\n    onAfterRestore(): IEvent<IGenericItemIdEvent, void> {  /* fired after item was restored */ return this.cbsAfterRestore; }\n    onAfterDelete(): IEvent<IGenericItemEvent, void> {/* event after an item (or a folder) has been deleted */ return this.cbsAfterDelete; }\n    onAfterCreate(): IEvent<INewItemIdEvent, void> {/* event after an item (or a folder) has been created */ return this.cbsAfterCreate; }\n    onAfterCreateSign(): IEvent<IGenericItemEvent, void> {/* event after a SIGN item has been created */ return this.cbsAfterCreateSign; }\n    onAfterLabelChange(): IEvent<ILabelChangeEvent, void> { return this.cbsAfterLabelChange; }\n    onAfterSignature(): IEvent<ISignatureEvent, void> { return this.cbsAfterSignature; }\n\n    // allowing to stop execution. need to return promise, reject() to stop resolve() to continue.\n    onBeforeSaveAsync(): IEvent<IItemChangeEvent, JQueryDeferred<{}>> { /* event before  an item will be saved. */return this.cbsBeforeSave; }\n    onBeforeDeleteAsync(): IEvent<IGenericItemEvent, JQueryDeferred<{}>> { /* event before  an item (or a folder) has been deleted. */return this.cbsBeforeDelete; }\n\n}\n\nvar MR1: MR1Impl = new MR1Impl();\nglobalThis.MR1 = MR1;\n/** tests...\n\n// MR1.onAfterLabelChange().subscribe( this, function (event:ILabelChangeEvent) { console.log(\"Label changed for \" + event.item.id + \" set: '\" + event.set.join() + \"' unset: '\" + event.unset.join() + \"'\");} );\n\n\nMR1.onBeforeDeleteAsync().subscribe( this, function (event:IGenericItemEvent) {\n    console.log(\"MR1 >>>Could cancel item delete \" + event.item.id);\n\n    let res = $.Deferred();\n    res.resolve(); // res.reject(); to cancel\n    return res;\n});\n\nMR1.onBeforeSaveAsync().subscribe( this, function (event:IItemChangeEvent) {\n    console.log(\"MR1 >>>Could cancel save of \" + event.before.id);\n\n    let res = $.Deferred();\n    res.resolve(); // res.reject(); to cancel\n    return res;\n});\n\nMR1.onAfterCreate().subscribe( this, function (event:INewItemIdEvent) { console.log(\"MR1 >>>Item created \" + event.item.item.id);} );\nMR1.onAfterCreateSign().subscribe( this, function (event:IGenericItemEvent) { console.log(\"MR1 >>>SIGN created \" + event.item.id);} );\n\nMR1.onAfterSignature().subscribe( this, function (event:ISignatureEvent) { console.log(\"MR1 >>>SIGNED \" + event.item.id + \" by \" + matrixSession.getUser() +  ( event.lastuser?\" as last signature\":\" but not last signature\"));} );\n\nMR1.onAfterSave().subscribe( this, function (event:IItemChangeEvent) { console.log(\"MR1 >>>Item saved \" + event.after.id);} );\nMR1.onAfterRestore().subscribe( this, function (event:IGenericItemIdEvent) { console.log(\"MR1 >>>Item restored \" + event.itemId);} );\n\nMR1.onAfterDelete().subscribe( this, function (event:IGenericItemEvent) { console.log(\"MR1 >>>Item deleted \" + event.item.id);} );\n\nMR1.onItemDisplayed().subscribe( this, function (event:IGenericItemEvent) { console.log(\"MR1 >>>Item displayed \" + event.item.id);} );\n\nMR1.onItemCreateDlgOpen().subscribe( this, function (event:IPreCreateItemEvent) {  console.log(\"MR1 >>>Create item dialog with \" + event.view.getControls().length + \" controls.\");}  );\n\n*/\n\n/** example extract all italic from text and put in title when saving if title is \" \" or \"\"\nMR1.onBeforeSaveAsync().subscribe( this, function (event:IItemChangeEvent) {\n    console.log(\"MR1 >>>Could cancel save of \" + event.before.title);\n\n    if (event.after.title == \" \" || event.after.title == \"\") {\n        let tf = IC.getFieldsOfType(\"richtext\",event.after.type);\n        let italics=\"\";\n        $.each( tf, function(idx, tfd) {\n            let tfc = $(\"<div>\").html(event.after[tfd.field.id]);\n            $(\"span\", tfc).each( function(spanIdx,span) {\n                if ($(span).css(\"font-style\").indexOf(\"italic\")!=-1) {\n                    italics += italics?(\" \"+$(span).text()):$(span).text();\n                }\n            });\n        });\n        event.after.title = italics?italics:\"title required\";\n    }\n\n    let res = $.Deferred();\n    res.resolve();\n    return res;\n});\n\n */\n\n","import {\n    IItemIdParts, IReference, IReferenceChange, IItem, IItemGet,\n    IItemPut, app, matrixSession\n} from \"./../../globals\";\nimport { globalMatrix } from \"./../../globals\";\nimport { IItemTools, ISimpleItemTools } from \"./MatrixLibInterfaces\";\nimport { SimpleItemTools } from \"./SimpleItemTools\";\nexport { ItemTools };\n\nclass ItemTools implements IItemTools {\n\n    private simpleItemTools: ISimpleItemTools;\n\n    constructor() {\n        this.simpleItemTools = new SimpleItemTools();\n    }\n\n    // extract different parts from item ids, like version, category, ...\n    parseRef(itemRef: string): IItemIdParts {\n        return this.simpleItemTools.parseRef(itemRef, matrixSession.getProject(), globalMatrix.matrixBaseUrl);\n    };\n\n    getCreator(item: IItem): string {\n        return this.simpleItemTools.getCreator(item);\n    }\n\n    getLastEditor(item: IItem): string {\n        return this.simpleItemTools.getLastEditor(item);\n    }\n\n    // render a list of item ids, to show up as <b>ID</b> name, <b>ID</b> name, \n    refListToDisplayString(inputItems: IReference[] | null, prefix: string, shorten?: number): string {\n        return this.simpleItemTools.refListToDisplayString(inputItems, prefix, (ref) => app.getItemTitle(ref), shorten);\n    }\n\n    renderLink(itemId: string, itemTitle?: string, newWindow?: boolean) {\n        const realTitle = itemTitle ? itemTitle : app.getItemTitle(itemId);\n        return this.simpleItemTools.renderLink(itemId, realTitle, newWindow);\n    }\n\n    // update and changes to reference lists\n    updateReferences(oldReferences: IReference[], newReferences: IReference[], fromId: string | null, toId: string | null): IReferenceChange[] {\n        return this.simpleItemTools.updateReferences(oldReferences, newReferences, fromId, toId);\n    }\n\n    // clone item from IItemGet to IItemPut\n    clone(item: IItemGet, copyLabels: boolean): IItemPut {\n        return this.simpleItemTools.clone(item, copyLabels);\n    }\n\n    sort(a: string, b: string) {\n        return this.simpleItemTools.sort(a, b, matrixSession.getProject(), globalMatrix.matrixBaseUrl);\n    }\n}\n","import { IItemIdParts, IItem, IReference, IReferenceChange, IItemGet, IItemPut, IGenericMap } from \"../../globals\";\nimport { refLinkStyle, refLinkTooltip } from \"../UI/Parts/RefLinkDefines\";\nimport { ISimpleItemTools } from \"./MatrixLibInterfaces\";\n\nexport { SimpleItemTools };\n\n// Implements ItemTools functionality with minimal dependencies\nclass SimpleItemTools implements ISimpleItemTools {\n    // extract different parts from item ids, like version, category, ...\n    public parseRef(itemRef: string, project: string, matrixBaseUrl: string): IItemIdParts {\n        let ref = itemRef; // e.g. F-REQ-13-v12\n        var result = {\n            id: \"\", // F-REQ-13-v12 -> REQ-13\n            number: 0, // F-REQ-13-v12 -> 13\n            version: 0, // F-REQ-13-v12 -> 12\n            type: \"\", // F-REQ-13-v12 -> REQ\n            isFolder: false, // F-REQ-13-v12 -> true\n            url: \"\", // company.matrixreq.com/project/REQ-13-v12\n            link: \"\", // <a href=url>item</a>\n            linkv: \"\" // <a href=url>url</a>\n        } as IItemIdParts;\n\n        var vp = ref.indexOf(\"-v\");\n        if (vp !== -1) {\n            result.version = parseInt(ref.substr(vp + 2));\n            ref = ref.substr(0, vp);\n        }\n        result.id = ref;\n        if (ref.indexOf(\"F-\") === 0) {\n            result.isFolder = true;\n            ref = ref.substr(2);\n        }\n        var parts = ref.split(\"-\");\n\n        if (parts.length > 1) {\n            result.type = parts[0];\n\n            result.number = Number(parts[1]);\n        }\n        result.url = matrixBaseUrl + \"/\" + project + \"/\" + itemRef;\n        result.link = \"<a style='color:blue !important' href='\" + result.url + \"'>\" + itemRef + \"</a>\";\n        result.linkv = \"<a style='color:blue !important' href='\" + result.url + \"'>\" + result.url + \"</a>\";\n\n        return result;\n    };\n\n    public getCreator(item: IItem): string {\n        return item.history[item.history.length - 1].user;\n    }\n\n    public getLastEditor(item: IItem): string {\n        return item.history.length > 0 ? item.history[0].user : \"\";\n    }\n\n    // render a list of item ids, to show up as <b>ID</b> name, <b>ID</b> name, \n    refListToDisplayString(inputItems: IReference[] | null, prefix: string, getTitleFunction: any, shorten?: number): string {\n\n        function makeLink(itemobj: IReference, shorten: boolean) {\n            if (!itemobj.projectShortLabel) {\n                return \"<b>\" + itemobj.to + \"</b>\" + (shorten ? \"\" : (\" \" + getTitleFunction(itemobj.to)));\n            }\n\n            var label = itemobj.projectShortLabel + \":\" + itemobj.to;\n\n            return \"#\" + itemobj.projectShortLabel + \"/\" + itemobj.to + \"#\";\n\n            //return \"<a class='crossProjectLink' title='\" + itemobj.title + \"' href='\" + matrixBaseUrl + \"/\" + itemobj.projectShortLabel + \"/\" + itemobj.to + \"' target='_blank'>\" + label + \"</a> \";\n        }\n\n        if (inputItems) {\n            // build the list ItemId Title can take a long time, e.g. if there's dozens of search results and the list should be a short list. In that case only show names if there's less than 5 items \n            let refs = inputItems.map(function (inputItem) { return makeLink(inputItem, shorten && inputItems.length > 4 ? true : false); });\n            let list = refs.join(\", \");\n            if (shorten && list.replace(/<b>/g, \"\").replace(/<\\/b>/g, \"\").length > shorten) {\n                refs = inputItems.map(function (inputItem) { return makeLink(inputItem, true); });\n                list = refs.join(\", \");\n            }\n            if (shorten && list.replace(/<b>/g, \"\").replace(/<\\/b>/g, \"\").length > shorten) {\n                list = \"<b>\" + list.replace(/<b>/g, \"\").replace(/<\\/b>/g, \"\").substr(0, shorten - 4) + \" ...</b>\";\n            }\n            if (prefix) {\n                list = prefix + \" \" + list;\n            }\n\n            return list;\n        }\n        else {\n            return \"\";\n        }\n    };\n\n    renderLink(itemId: string, itemTitle: string, newWindow?: boolean) {\n        let dbt = itemTitle;\n\n        return $(\"<div>\").refLink({\n            id: itemId,\n            folder: false,\n            title: dbt ? dbt : \"(deleted)\",\n            style: newWindow ? refLinkStyle.link : refLinkStyle.selectTree,\n            tooltip: refLinkTooltip.html\n        });\n    }\n    // update and changes to reference lists\n    updateReferences(oldReferences: IReference[], newReferences: IReference[], fromId: string | null, toId: string | null): IReferenceChange[] {\n\n        var changeList: IReferenceChange[] = [];\n        // find links to add\n        for (var idx = 0; idx < newReferences.length; idx++) {\n            var found = false;\n            for (var jdx = 0; jdx < oldReferences.length; jdx++) {\n                if (newReferences[idx].to === oldReferences[jdx].to) {\n                    found = true;\n                    continue;\n                }\n            }\n            if (!found) {\n                if (fromId) {\n                    changeList.push({ action: 'addLink', fromId: fromId, toId: newReferences[idx].to });\n                } else if (toId) {\n                    changeList.push({ action: 'addLink', fromId: newReferences[idx].to, toId: toId });\n                }\n            }\n        }\n        // find links to remove\n        for (var jdx = 0; jdx < oldReferences.length; jdx++) {\n            var found = false;\n            for (var idx = 0; idx < newReferences.length; idx++) {\n                if (newReferences[idx].to === oldReferences[jdx].to) {\n                    found = true;\n                    continue;\n                }\n            }\n            if (!found) {\n                if (fromId) {\n                    changeList.push({ action: 'removeLink', fromId: fromId, toId: oldReferences[jdx].to });\n                } else if (toId) {\n                    changeList.push({ action: 'removeLink', fromId: oldReferences[jdx].to, toId: toId });\n                }\n            }\n        }\n        return changeList;\n    };\n\n    // clone item from IItemGet to IItemPut\n    clone(item: IItemGet, copyLabels: boolean): IItemPut {\n        var newItem: IItemPut = {};\n\n        $.each(item, function (idx, val) {\n            if (idx !== \"maxVersion\" && idx !== \"labels\" && idx !== \"labels\" && idx !== \"downLinks\" && idx !== \"upLinks\" && idx !== \"type\" && idx !== \"children\" && idx !== \"hide\" && idx !== \"history\" && idx !== \"isUnselected\" && idx !== \"modDate\" && idx !== \"restricted\" && idx !== \"upLinkList\" && idx !== \"userRights\") {\n                (<IGenericMap>newItem)[idx] = val;\n            }\n        });\n\n        if (copyLabels) {\n            newItem.labels = item.labels.join(\",\");\n        } else {\n            newItem.labels = \"\";\n        }\n\n        return newItem;\n    }\n\n    sort(a: string, b: string, project: string, matrixBaseUrl: string) {\n        let at = this.parseRef(a, project, matrixBaseUrl);\n        let bt = this.parseRef(b, project, matrixBaseUrl);\n        if (at.type == bt.type) {\n            if (at.isFolder && !bt.isFolder) return -1;\n            if (bt.isFolder && !at.isFolder) return 1;\n\n            return at.number - bt.number;\n        }\n        return a < b ? -1 : 1;\n    }\n}","export type { IRefLinkOptions };\nexport { refLinkStyle, refLinkTooltip };\n\nenum refLinkStyle {\n    edit = 1, // user can change title\n    link, // click opens another window\n    show, // read only, can call callback if clicked\n    select, // renders like the link, but select the item in the tree (changes selection)\n    selectTree  // like link, but selects in tree unless ctrl-was clicked\n}\n\nenum refLinkTooltip {\n    none = 1, // no tooltip\n    html // full html tooltip\n}\n\ninterface IRefLinkOptions {\n    style?: refLinkStyle,\n    tooltip?: refLinkTooltip,\n    callback?: Function, // function to be called (if syle is refLinkStyle.show) or after edit\n    id?: string, // id of object\n    title?: string, //  title of object\n    folder?: boolean, //  (true if no id should be rendred)\n    showVersion?: boolean, //  \n    validate?: boolean, //   default is true. valdiation requires non-empty string,\n    isHidden?: boolean, //    default false, whether the item title should indicate that object is not in project filter\n    placeholder?: string,\n    hideTitle?: boolean, // option to hide the title\n    crossProject?: string // if the item id from another project\n    css?: string // possibility to add style information to class\n    includeSourceLink?: string // if set indicate that the reflink is an include, pointing to the source\n}\n","import type { IContextPageConfig, IContextPageConfigTab } from \"../../ProjectSettings\";\n// import { mDHF } from \"../businesslogic/index\";\n// import { mTM } from \"../businesslogic/index\";\nimport {ContextFrameManager, mDHF} from \"../businesslogic/index\";\nimport { ItemControl } from \"../UI/Components/index\";\n\nimport { app, ControlState, globalMatrix, IBooleanMap, IDevice, IEmail, IItem, IStringStringArrayMap, matrixApplicationUI, matrixSession } from \"./../../globals\";\nimport { ml } from \"./../matrixlib\";\nimport { IContextFramesTools, IContextInformation } from \"./MatrixLibInterfaces\";\nimport {FieldDescriptions} from \"../businesslogic/FieldDescriptions\";\n\nexport { ContextFramesTools };\n\nclass ContextFramesTools implements IContextFramesTools {\n\n        static defaultPages:IContextPageConfig = {\n            tabs:[{ title:\"Help\", type:\"help\", hipchat:false},\n            { title:\"Support\", type:\"support\", hipchat:false}]\n        }\n\n        private exists: boolean = false;\n        private visible: boolean  = false;\n        private support: boolean  = false;\n        private context:IContextInformation;\n        private controls:ItemControl[];\n        private resetSmartLinks = true;\n        private maxNumberOfLinks = 20;\n        private shouldBeVisible = false;\n\n\n\n    constructor() {\n            // to be done once\n        let that = this;\n            $('#contextframesizer').mousedown(function (e) {\n                if (e.preventDefault)\n                    e.preventDefault();\n\n                $(document).mousemove(function (e) {\n                    let contextframeWidth = Math.max(0,($(document).width() - e.pageX + 2));\n                    if( contextframeWidth < 150)\n                    {\n                        contextframeWidth = 500;\n                        localStorage.setItem('contextframeWidth', contextframeWidth.toString());\n                        that.hideContextFrames();\n\n                    }\n                    else\n                    {\n                        localStorage.setItem('contextframeWidth', contextframeWidth.toString());\n                       that.showContextFrames();\n                    }\n                    $(document).trigger(\"contextFrameResized\");\n\n                    app.resizeItem(true);\n\n                });\n            });\n\n            // to hide / resize context frame if it would be to small\n            let resizeHandleTimeout:number;\n            $( window ).resize(function() {\n                clearTimeout(resizeHandleTimeout);\n                resizeHandleTimeout = window.setTimeout( function() {\n                    if (that.visible) {\n                        that.showContextFrames();\n                    }\n                }, 300);\n            });\n\n        }\n        protected setToogleIcon(allowClose:boolean)\n        {\n            let faIcon = $(\"#contextFrameButton span.fal\");\n           faIcon.removeClass(\"fa-arrow-to-right\")\n            faIcon.removeClass(\"fa-arrow-from-right\")\n            if( allowClose)\n            {\n                faIcon.addClass(\"fa-arrow-to-right\")\n\n            }\n            else{\n                faIcon.addClass(\"fa-arrow-from-right\")\n            }\n\n        }\n        protected toggleFunction() {\n\n            // toggle status;\n            let contextframeWidth = Number(localStorage.getItem('contextframeWidth'));\n            localStorage.setItem('contextframeWidth', (-contextframeWidth).toString());\n            if ( this.visible ) {\n                this.shouldBeVisible = false;\n                this.hideContextFrames();\n\n            } else {\n                this.shouldBeVisible = true;\n                this.showContextFrames();\n                this.renderContextFrames();\n\n            }\n            this.setToogleIcon(this.shouldBeVisible); // if visible allow close\n            app.resizeItem(true);\n        }\n\n        public showContextFrame(tabType:string, makeVisible:boolean) {\n            let tab =\"\";\n            $.each(this.getTabs(), function(tabIdx,tabDef) {\n                if (tabDef.type == tabType) {\n                    tab = tabDef.tabId;\n                }\n            });\n            if (!tab) return false;\n\n            // toggle status;\n            if ( !this.visible ) {\n                if (!makeVisible) {\n                    return false;\n                }\n                this.showContextFrames();\n                this.renderContextFrames();\n            }\n\n            $('.nav-tabs a[href=\"#' + tab + '\"]').tab('show');\n            return true;\n        }\n\n        getExpender() {\n            let that = this;\n            let direction = this.shouldBeVisible?\"fa-arrow-to-right\":\"fa-arrow-from-right\";\n            let icon =   $('<div class=\"btn-group contextCloseX\" ><button id=\"contextFrameButton\" tabindex=\"-1\" class=\"btn btn-item\" data-original-title=\"Context frame\"><span class=\"fal ' + direction + '\"  ></span></button></div>')\n            let faIcon = $(\".fal\",icon);\n\n            icon.click( function() {\n               that.toggleFunction();\n            });\n            return icon;\n        }\n\n        // get tabs enabled for project\n        private getTabs():IContextPageConfigTab[] {\n\n            let tabs:IContextPageConfigTab[] = [];\n\n            let projectHelp: IContextPageConfig = globalMatrix.ItemConfig && globalMatrix.ItemConfig.getContextPagesConfig();\n            if ( projectHelp && projectHelp.tabs ) {\n                tabs = projectHelp.tabs;\n            } else {\n                tabs = ContextFramesTools.defaultPages.tabs;\n            }\n            return tabs;\n        }\n\n        visibility(enabled:boolean) {\n            if (enabled) {\n                if ( this.shouldBeVisible && !this.visible ) {\n                    this.showContextFrames();\n                }\n            } else if ( this.visible ) {\n                this.hideContextFrames();\n            }\n        }\n\n\n        // hide context frames, remember as hidden\n        hideContextFrames() {\n            $(\".contextCloseX\" ).show();\n\n            $(\"#contextframemenu\").html( \"Show Context Pages\");\n\n            $('#contextframe').addClass('hidden');\n            $('#main').css(\"margin-right\", \"5px\");\n            //$('#contextframesizer').addClass('hidden');\n            $('#contextframesizer').css('right',\"0px\");\n\n            let contextframeWidth:number = Math.abs(Number(localStorage.getItem('contextframeWidth')));\n            localStorage.setItem('contextframeWidth', (-contextframeWidth).toString());\n\n            this.visible = false;\n            this.setToogleIcon(false); // don't allow close it's closed\n\n            $(document).trigger(\"contextFrameResized\");\n        };\n\n        // show context frames, remember as displayed\n        showContextFrames() {\n\n\n            let ww = $(window).width();\n            let sw = $('#sidebar').width() + $('#sidebar').position().left;\n            let cw =  Math.abs(Number(localStorage.getItem('contextframeWidth')));\n\n            if (ww<767) {\n                 // mobile device... hide\n                $('#contextframe').addClass('hidden');\n                $('#main').css(\"width\", \"unset\");\n                $('#contextframesizer').addClass('hidden');\n\n                return;\n            }\n            // adjust context frame width (i.e. if the screen size changed)\n            if ( cw > Math.max( ww-sw,0)/2 ) {\n                cw = (ww-sw) / 2;\n                if (cw<100) {\n                    // hide temporarily... until screen is bigger\n                    $('#main').css(\"width\", \"unset\");\n                    $('#contextframesizer').addClass('hidden');\n\n                    return;\n                }\n            }\n            localStorage.setItem('contextframeWidth', cw.toString());\n\n            $('#contextframe').css(\"width\", (cw-5)+\"px\").removeClass('hidden');\n            $('#main').css(\"width\", (cw)+\"px\");\n            $('#contextframesizer').css(\"right\", cw+\"px\").removeClass('hidden');\n\n            let container = $('#contextframe .contextFrameContainer');\n            let content = $('#contextframe .tab-content');\n            let tabs = $('#contextframe .contextFrameTabs');\n\n            //content.height( container.height() - tabs.height());\n\n            this.visible = true;\n            this.setToogleIcon(true);\n\n            $(document).trigger(\"contextFrameResized\");  $(document).trigger(\"contextFrameResized\");\n        };\n\n        private showSupport(panel: JQuery, tabData: IContextPageConfigTab) {\n            let that = this;\n            if (!this.support) {\n                let formContainer = $(`<div data-cy=\"${tabData.title}\">`);\n                let requireEmail = globalMatrix.matrixBaseUrl.indexOf('demo.matrixreq.com') !== -1 || matrixSession.isSuperAdmin();\n\n                formContainer.append( '<p>You can use the form below to create a ticket with the Matrix help desk:</p>' );\n                formContainer.append( '<form id=\"supportMailForm\" role=\"form\">'\n                    +'  <div class=\"form-group\"><label for=\"sup_summary\">Summary:</label><input autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"sup_summary\" /></div>'\n                    +'  <div class=\"form-group\"><label for=\"sup_description\">Description:</label> <textarea  class=\"form-control\" id=\"sup_description\" ></textarea> </div>'\n                    + (requireEmail?'  <div class=\"form-group sup_email\"><label for=\"sup_email\">E-mail:</label><input type=\"email\" class=\"form-control\" id=\"sup_email\" /></div>':'')\n                    +'  <div class=\"text-center\"><button href=\"#\" class=\"btn btn-large btn-success\" id=\"support_send\" >Create Ticket</button></div>'\n                    +'  <div class=\"text-center\" style=\"padding:12px\"><span id=\"sup_last_ticket\">sending...</span></div>'\n                    +'  <div class=\"form-group sup_metainfo\"><label for=\"sup_project\">Related Project(s):</label><input autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"sup_project\" /></div>'\n                    +'  <div class=\"form-group sup_metainfo\"><label for=\"sup_item\">Related Item(s):</label><input autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"sup_item\" /></div>'\n                    +'  <div class=\"form-group sup_metainfo\"><label for=\"sup_browser\">Browser Info:</label><textarea class=\"form-control\" id=\"sup_browser\" ></textarea></div>'\n                    + '  <div class=\"form-group sup_metainfo\"><label for=\"sup_log\">Application Log:</label><textarea class=\"form-control\" id=\"sup_log\"></textarea>'\n                    +  ' <input type=\"hidden\" id=\"sup_version\" />'\n                    +'</div>');\n\n                panel.html(\"\");\n                panel.append(formContainer);\n\n                $('#supportMailForm').on('keyup keypress', function(e:JQueryKeyEventObject) {\n                    // prevent people hitting return (even multiple times? ...MATRIX-2253)\n                    if ( e.originalEvent && e.originalEvent.target && (<any>e.originalEvent.target).nodeName == \"TEXTAREA\") {\n                        return true;\n                    }\n\n                    let keyCode = e.keyCode || e.which;\n                    if (keyCode === 13  ) {\n                      e.preventDefault();\n                      return false;\n                    }\n                    return true;\n                });\n\n                $(\"#support_send\").prop('disabled', true);\n                $(\"#sup_last_ticket\").hide();\n                $(\"#sup_summary\").on(\"change keyup paste\", function() {\n                   $(\"#support_send\").prop('disabled', $(\"#sup_summary\").val()==\"\" || (requireEmail &&  $(\"#sup_email\").val()==\"\" ) );\n\n                });\n                $(\"#sup_email\").on(\"change keyup paste\", function() {\n                   $(\"#support_send\").prop('disabled', $(\"#sup_summary\").val()==\"\" || (requireEmail &&  $(\"#sup_email\").val()==\"\" ) );\n\n                });\n                $(\"#support_send\").on( \"click\", function(evt) {\n                    $(\"#support_send\").prop('disabled', true);\n                    if (evt.preventDefault) evt.preventDefault();\n                    if (evt.stopPropagation) evt.stopPropagation();\n                    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                    if ( requireEmail && !re.test($(\"#sup_email\").val()) ) {\n                        ml.UI.showError(\"Invalid Email\", \"Please enter a correct email.\");\n                        return;\n                    }\n                    let param:IEmail = {\n                        summary: $(\"#sup_summary\").val()\n                        ,description: $(\"#sup_description\").val()\n                        ,matrixProject: $(\"#sup_project\").val()\n                        ,matrixItem: $(\"#sup_item\").val()\n                        ,browser: $(\"#sup_browser\").val()\n                        ,log: $(\"#sup_log\").val()\n                    }\n                    $(\"#sup_summary\").val(\"\");\n\n                    if (requireEmail) {\n                        param.email =  $(\"#sup_email\").val();\n                    }\n                    $(\"#sup_last_ticket\").show();\n                    let call_param: JQueryAjaxSettings = {\n                        type: \"POST\",\n                        url: globalMatrix.matrixBaseUrl + \"/rest/1/all/servicedesk\",\n                        data: JSON.stringify(param),\n                        contentType: \"application/json; charset=utf-8\",\n                        dataType: \"json\",\n                        success: function(data:any) {\n                            if ( data.key )  {\n                                $(\"#sup_last_ticket\").html(\"Created ticket \" + data.key + \" \" + param.description);\n                            } else {\n                                $(\"#sup_last_ticket\").html(data.message);\n                            }\n                        },\n                        error: function(errMsg) {\n                            $(\"#sup_last_ticket\").html(\"Failed to create ticket: \" + errMsg);\n                        }\n                    }\n                    $.ajax(call_param);\n                });\n                $(\"#sup_url\").val(globalMatrix.matrixBaseUrl);\n\n                this.support = true;\n\n            }\n            let tz_offset =  -(new Date().getTimezoneOffset()) / 60;\n            let device: IDevice = {\n                screen: {\n                  width:  window.screen.width,\n                  height: window.screen.height\n                },\n                viewport:{\n                    width: 0,\n                    height: 0\n                }\n            };\n            let width:number = 0, height:number = 0;\n            try { width = window.innerWidth || globalMatrix.doc.documentElement.clientWidth || globalMatrix.doc.body.clientWidth; } catch (e) { }\n            try { height = window.innerHeight || globalMatrix.doc.documentElement.clientHeight || globalMatrix.doc.body.clientHeight; } catch (e) { }\n            device.viewport = {\n                width: width,\n                height: height\n            };\n\n            $(\"#sup_browser\").val( navigator.userAgent + \"\\nTimezone: \" + tz_offset\n                + \"\\nScreen width: \" + device.screen.width\n                + \"\\nScreen height: \" + device.screen.height\n                + \"\\nScreen viewport width: \" + device.viewport.width\n                + \"\\nScreen viewport height: \" + device.viewport.height\n            );\n            // Get full version for SER ticket creation\n            $(\"#sup_version\").val(app.getVersion());\n\n\n            $(\"#sup_log\").val(ml.Logger.getLog());\n            const user = matrixSession.getUser();\n            let umail = (!globalMatrix.ItemConfig || user == \"demo\") ? \"\" : globalMatrix.ItemConfig.getEmail(user);\n            $(\"#sup_email\").val( umail );\n            $(\"#sup_user\").val(matrixSession ? matrixSession.getUser() : \"\");\n            $(\"#sup_project\").val(matrixSession ? matrixSession.getProject() : \"\");\n            $(\"#sup_item\").val(app ? app.getCurrentItemId() : \"\");\n        }\n\n        private showHelp(panel: JQuery, tabData: IContextPageConfigTab) {\n            panel.html(\"\");\n            let that = this;\n            let help =\"\";\n            if (!this.context || !this.context.itemId || (matrixSession && matrixSession.getProject() !== this.context.project)) {\n                if (matrixSession) {\n                    help += '<p class=\"cathelp_summary\">Welcome to the project ' + matrixSession.getProject() + '</p>';\n                    help += '<p class=\"\">To get started explore the categories on the left.</p>';\n                    help += '<br>';\n                    help += '<br>';\n                    help += '<br>';\n                    help += '<br>';\n                    help += '<br>';\n\n                    panel.append(help);\n                }\n               return;\n            }\n            let item_type = ml.Item.parseRef(this.context.itemId).type;\n            var projectHelp = globalMatrix.ItemConfig.getContextPagesConfig();\n            if (projectHelp && projectHelp.itemHelp && projectHelp.itemHelp[this.context.itemId] ) {\n                panel.append( '<div class=\"cathelp text-left\">' + projectHelp.itemHelp[this.context.itemId] + '</div>');\n\n            } else if (projectHelp && projectHelp.categoryHelp && projectHelp.categoryHelp[item_type] ) {\n                panel.append( '<div class=\"cathelp text-left\">' + projectHelp.categoryHelp[item_type] + '</div>');\n\n            } else {\n                switch (this.context.itemId) {\n                    case \"F-PROJECT\":\n                        help += '<p class=\"cathelp_summary\">Dashboards, reports and documents</p>';\n                        help += '<p class=\"\">In this folder you find <b>dashboards</b>, <b>reports</b>, <b>documents</b> as well as <b>signed / archived documents</b>.</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li>Dashboards are in the folder <b>AUDIT</b>. They can be used to see summaries of activities from the past</li>';\n                        help += '<li>Reports are in the folder <b>REP</b>. Reports help to manage the project by extracting information about the status and the relationship of items in the database.</li>';\n                        help += '<li>Documents are in <b>DOC</b>. Documents allow you to create your own reports with additional document headers and fields such as audit log or signature tables.</li>';\n                        help += '<li>Signed / archived documents are in <b>SIGN</b>. Documents can be archived when a milestone has been reached. Once archived they will not change even if the items in the database changes and they can be signed electronically.</li>';\n                        help += '</ul>';\n                        break;\n                    case \"AUDIT\":\n                        help += '<p class=\"cathelp_summary\">Audit tools show activities in the project</b>.</p>';\n                        help += '<p class=\"\">Depending on your project configuration the following tools are available in this folder:</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li><b>Changes</b> Shows a calendar view with all changes done by day.</li>';\n                        help += '<li><b>Deleted Items</b> Show a list of deleted items, ordered by time.</li>';\n                        help += '<li><b>Tags</b> Show a list tags that have been assigned to some point/version in the past.</li>';\n                        help += '<li><b>Document Changes and Downloads</b> Shows when and by whom DOCs and SIGN items have been created and downloaded.</li>';\n                        help += ' </ul>';\n                        break;\n                    case \"DELETED\":\n                        help += '<p class=\"cathelp_summary\">Deleted Items. Show a list of deleted items, ordered by time.</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li>You can restore deleted items by clicking on <b>restore</b>. This will restore the item into the project tree - in the same folder where it was when it was deleted. The item will be restored with all its history.</li>';\n                        help += '<li>You tag (mark the point in time) when the item was deleted by clicking on <b>tag version</b>.</li>';\n                        help += '</ul>';\n                    break;\n                    case \"SYNC\":\n                        help += '<p class=\"cathelp_summary\">Agile Sync.</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li>The agile sync module allows you to sync data from external tools such as JIRA, Confluence, TFS, Zephyr into Matrix</li>';\n                        help += '<li>This dashboard allows you to sync multiple items quickly</b>.</li>';\n                        help += '</ul>';\n                        break;\n                    case \"MYDOCS\":\n                        help += '<p class=\"cathelp_summary\">Signatures.</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li>Shows documents I need to sign</b>.</li>';\n                        help += '</ul>';\n                        break;\n                    case \"REDLINE\":\n                        help += '<p class=\"cathelp_summary\">Redlining allows to compare project data between two dates</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li>Select a from and to date/time and click on \"compare\" to show differences in items.</b>.</li>';\n                        help += '<li>Select a from and click on \"Timewarp\" to browse the project as it was that day.</b>.</li>';\n                        help += '</ul>';\n                        break;\n                    case \"REVIEWS\":\n                        help += '<p class=\"cathelp_summary\">Review Dashboard</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '<li>My Reviews: show all reviews I need to participate in and how much work I did already.</b></li>';\n                        help += '<li>All Reviews: show all reviews how much work needs to be done.</b></li>';\n                        help += '<li>Reviews Per Item: show all reviews done per item.</b></li>';\n                        help += '</ul>';\n                        break;\n\n                    case \"TAGS\":\n                        help += '<p class=\"cathelp_summary\">Tags. Show a list of tags that have been assigned to some point/version in the past.</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '    <li>Tags mark a point in time when a change occurred.</li>';\n                        help += '    <li>Tags can be set in to changes done in the past (through the CHANGES dashboard).</li>';\n                        help += '    <li>Tags can be used to restore a project until a certain point in the past (branch in the past).</li>';\n                        help += '</ul>';\n                        break;\n                    case \"CHANGES\":\n                        help += '<p class=\"cathelp_summary\">Change Summary. Shows a calendar view with all changes done by day.</p>';\n                        help += '<ul class=\"cathelp_details\">';\n                        help += '    <li>In the calendar view you can select a day or selection of days to see what changed in that period.</li>';\n                        help += '    <li>You can tag version or just see the details of the changes in this stream.</li>';\n                        help += '</ul>';\n                        break;\n                    case \"DOCS\":\n                        help += '<p class=\"cathelp_summary\">Document status and activity</p>';\n                        help += '<p class=\"\">Document Status. Shows when and by whom DOCs and SIGN items have been created, signed and downloaded.</p>';\n                        break;\n                    case \"TAGS\":\n                        break;\n                    default:\n                        if ( this.context.itemId ) {\n                            let itemId = this.context.itemId;\n                            let isFolder = itemId.indexOf(\"F-\")===0;\n                            let isTC = false;  // mTM.isTC(item_type);\n                            let isXTC = false;  // mTM.isXTC(item_type);\n                            let folderName = app.getItemTitle(\"F-\" + item_type + \"-1\");\n                            let isSpecialItem = folderName === app.getItemTitle(\"_NON_EXISTING_CATEGORY__\");\n                            let isXSLTType = item_type === \"DOC\" || item_type === \"SIGN\" || item_type === \"REPORT\";\n                            // For all folders besides reports, docs, sign\n                            if (!isXSLTType && isFolder && itemId.lastIndexOf(\"-1\")+2===itemId.length ) {\n                                help += '<p class=\"cathelp_summary\">This is the root folder of the category <span>' + app.getItemTitle(\"F-\" + item_type + \"-1\") + '</span></p>';\n                                help += '<ul class=\"cathelp_details\">';\n                                help += '    <li>You can create a folder structure to organize the items of this category.</li>';\n                                help += '    <li>You can create items of this type</li>';\n                                help += '</ul>';\n                            } else if (!isXSLTType && isFolder && itemId.lastIndexOf(\"-1\")+2!==itemId.length ) {\n                                help += '<p class=\"cathelp_summary\">This is a folder of the category <span>' + app.getItemTitle(\"F-\" + item_type + \"-1\") + '</span></p>';\n\n                                help += '<p class=\"\">You can</p>';\n                                    help += '<ul class=\"cathelp_details\">';\n                                help += '    <li>create more folders of this category inside this folder.</li>';\n                                if (!isXTC) help += '    <li>create items of the type ' + app.getItemTitle(\"F-\" + item_type + \"-1\") + '.</li>';\n                                if (isXTC) help += '    <li>create test forms based on defined tests and use cases.</li>';\n                                help += '</ul>';\n                            }\n\n                            // for all items besides DOC, SIGN, and REPORT, and special custom pages like JIRA, ZOHO\n                            if (!isFolder && !isXSLTType  && !isSpecialItem ) {\n                                help += '<p class=\"cathelp_summary\">This item is of type <span>'+ folderName +'</span></p>';\n                                help += '<ul class=\"cathelp_details\">';\n                                help += '    <li>You can modify the title or the content and save it (hint: use ctrl-s).</li>';\n                                help += '    <li>You can look at its history (<span class=\"helpGlyph fal fa-history\"></span>).</li>';\n                                help += '    <li>You can look at or modify the up or downlinks (<i class=\"helpGlyph fal fa-sitemap\" aria-hidden=\"true\"></i>).</li>';\n\n                                if (isTC) {\n                                    help += '<li>You can create a test form from this (<span class=\"helpGlyph fal fa-share\">)</span>: <span style=\"font-style:italic\">Prepare for test run</span>.</li>';\n                                }\n\n                                if (isXTC) {\n                                    help += '<li>Execute the test. Hints: <ul><li>use keyboard shortcuts to set <span style=\"font-style:italic\">actual results</span>';\n                                    help += '<li><span style=\"font-style:italic\">tab</span> to navigate between the cells</li>';\n                                    help += '<li><span style=\"font-style:italic\">shift return</span> in the comment cells to open a rich text editor, e.g. to attach images and files</li></ul></li>';\n                                }\n\n                                if (globalMatrix.ItemConfig.getFieldsOfType(\"risk2\", item_type).length > 0) {\n                                    help += '<li>You can enter the parameters according to the configured risk formula.</li>';\n                                }\n\n                                help += '</ul>';\n\n                                help += '<p>Traceability Information:</p>';\n\n                                help += '<ul class=\"cathelp_details\">';\n\n                                $.each( [true,false], function( tfi, required) {\n                                    $.each( [false,true], function( tfi, updown) {\n                                        var cats = globalMatrix.ItemConfig.getLinkTypes(item_type, updown, required);\n                                        var text = (required?'required':'optional')+ ' '  + (updown?'downlinks':'uplinks');\n                                        if ( cats.length===0) {\n                                            help += '    <li>There are no '+ text +' configured.</li>';\n                                        } else {\n                                            help += '    <li>There are '+ text +': ' + cats.join(', ') + '.</li>';\n                                        }\n\n                                    });\n                                });\n\n                                help += '</ul>';\n                            }\n                            // ZOHO JIRA,...\n                            if (isSpecialItem ) {\n                            }\n\n                            // for DOC\n                            if ( item_type === \"DOC\" ) {\n                                if (isFolder) {\n                                    help += '<p class=\"cathelp_summary\">Controlled documents basics</p>';\n                                    help += '<p class=\"\">Controlled documents allow you to extract and analyze data from the database in order to archive and electronically sign it as PDF or Word File.</p>';\n                                    help += '<p class=\"\">You can</p>';\n                                    help += '<ul class=\"cathelp_details\">';\n                                    help += '    <li>define what the documents look like by selecting the sections, such as audit trail, purpose, scope, trace tables, list items, etc.</li>';\n                                    help += '    <li>decide which content goes into the document, e.g. all requirements from one specific folder, or all tests results for a selected set of specifications.</li>';\n                                    help += '    <li>download and review it as word, pdf or html.</li>';\n                                    help += '    <li>archive it (this will make sure the content of document will not change even if the items in the database get updated afterwards)</li>';\n                                    help += '    <li>electronically sign it</li>';\n                                    help += '</ul>';\n                                    help += '<img  class=\"cathelp_img\" src=\"' + globalMatrix.matrixBaseUrl + '/img/help/doc0.png\">';\n                                } else {\n                                help += '<p class=\"cathelp_summary\">Controlled document</p>';\n                                    help += '<p class=\"\">You can</p>';\n                                    help += '<ul class=\"cathelp_details\">';\n                                    help += '    <li>modify the document.</li>';\n                                    help += '    <li>download it as PDF, Word or html.</li>';\n                                    help += '    <li>archive (freeze) it so that the content does not change anymore.</li>';\n                                    help += '</ul>';\n\n                                }\n                                help += '<p class=\"cathelp_summary\">Defining the structure</p>';\n                                help += '<p class=\"\">You can</p>';\n                                help += '<ul class=\"cathelp_details\">';\n                                if (isFolder) help += '    <li>use a wizard to create new documents from scratch, by clicking on \"Create Controlled Documents\" button.</li>';\n                                if (isFolder) help += '    <li>copy and paste an existing document from this or another project using the tool menu: <span class=\"fal fa-share\"></span>.</li>';\n                                // if (!isFolder) help += '    <li>modify an existing document by clicking on the configure section icon next to \"' + mDHF.getArchiveButtonName() + '\": <span class=\"fal fa-list\"></span></li>';\n                                if (!isFolder) help += '    <li>modify an existing document by clicking on the configure section icon next to \"' + mDHF.getArchiveButtonName() + '\": <span class=\"fal fa-list\"></span></li>';\n                                help += '</ul>';\n                                help += '<p class=\"\">There are two types of document sections</p>';\n                                help += '<ul class=\"cathelp_details\">';\n                                help += '    <li>Static sections: you type the content</li>';\n                                help += '    <li>Dynamic sections: the content is taken from the database of entered items</li>';\n                                help += '</ul>';\n                                if (!isFolder) {\n                                    help += '<img  class=\"cathelp_img\" src=\"' + globalMatrix.matrixBaseUrl + '/img/help/doc1.png\">';\n                                    help += '<p class=\"cathelp_summary\">Changing the content and looks of sections</p>';\n                                    help += '<p class=\"\">You can</p>';\n                                    help += '<ul class=\"cathelp_details\">';\n                                    help += '    <li>change the content by clicking on the triangle on the left of the section title</li>';\n                                    help += '    <li>the looks by clicking on the <span class=\"fal fa-cog\"></span> on the right of the section title</span></li>';\n                                    help += '</ul>';\n                                    help += '<img  class=\"cathelp_img\" src=\"' + globalMatrix.matrixBaseUrl + '/img/help/doc2.png\">';\n                                }\n\n                            }\n\n                            // for SIGN\n                            if ( item_type === \"SIGN\" ) {\n                                if (isFolder) {\n                                    help += '<p class=\"cathelp_summary\">Archived documents</p>';\n                                    help += '<p class=\"\">Controlled documents allow you to extract and analyze data from the database in order to archive and electronically sign it as PDF or Word File.</p>';\n                                    help += '<ul class=\"cathelp_details\">';\n                                    help += '   <li>Archived documents are controlled documents that have been archived and therefore will not change anymore.</li>';\n                                    help += '   <li>You can only sign and download archived documents.</li>';\n                                    help += '</ul>';\n                                } else {\n                                    help += '<p class=\"cathelp_summary\">Archived document</p>';\n                                    help += '<p class=\"\">Controlled documents with a signature table can be signed here.</p>';\n\n                                }\n                            }\n\n                            // for REPORTS\n                            if ( item_type === \"REPORT\" ) {\n                                if (isFolder) {\n                                    help += '<p class=\"cathelp_summary\">Reports</p>';\n                                    help += '<p class=\"\">Reports allow you to manage your project by</p>';\n                                    help += '<ul class=\"cathelp_details\">';\n                                    help += '   <li>reviewing items</li>';\n                                    help += '   <li>reviewing traceability</li>';\n                                    help += '   <li>analyzing risks</li>';\n                                    help += '   <li>planning tests</li>';\n                                    help += '   <li>...</li>';\n                                    help += '</ul>';\n                                    help += '<p class=\"\">If you want to create documents for certification, audits or archiving, see Controlled Documents (DOC) on the left side.</p>';\n\n                                } else {\n                                    help += '<p class=\"cathelp_summary\">Report</p>';\n                                    help += '<p class=\"\">This report can be created as html, PDF or word file.</p>';\n                                }\n\n                            }\n                        };\n\n                        break;\n                }\n\n                panel.append( '<div class=\"cathelp text-left\">' + help + '</div>');\n\n                panel.append('<hr>');\n                var moreHelp = 'Questions? Here is the online <span id=\"helpDocu\" class=\"helpLink\">user guide</span>';\n                if (tabData.hipchat) {\n                    moreHelp += ', <a href=\"http://urlshort.matrixreq.com/helpdesk\" target=\"_blank\" class=\"helpLink\" >Contact our service desk</a> with us send us an <span id=\"helpMail\" class=\"helpLink\">e-mail</span>';\n                } else {\n                    moreHelp += ' or send us an <span id=\"helpMail\" class=\"helpLink\">e-mail</span>';\n                }\n\n                panel.append('<p>'+ moreHelp + '.</p>');\n                $(\"#helpDocu\").click( function() {\n                    window.open(\"https://urlshort.matrixreq.com/d23/manual/main\");\n                });\n\n                $(\"#helpMail\").click( function() {\n                    let email = matrixSession.serverConfig.serviceEmail ? matrixSession.serverConfig.serviceEmail : \"support@matrixreq.com\";\n                    window.location.href = \"mailto:\" + email;\n                });\n            }\n        }\n\n        private showSmartLinksTab(panel: JQuery, tabData: IContextPageConfigTab) {\n            $(\"a[href='#\"+tabData.tabId+\"']\").css(\"color\",\"\");\n\n            if (this.context.item && !ml.Item.parseRef(this.context.itemId).isFolder && this.resetSmartLinks) {\n                this.resetSmartLinks = false; // avoid reloading same frame on tab switch\n                panel.html(\"\");\n                var smartlinks =  $(`<div data-cy=\"${tabData.title}\">`);\n                panel.append(smartlinks);\n                panel.append(\"<br>\");\n                var item = JSON.parse(decodeURI(this.context.item));\n\n                // match references (smart links) into project\n                // not (folders) F-REQ-1 not (cross project).../REQ-1\n                var regexstr = '((F-)*(\\/)*(' + globalMatrix.ItemConfig.getCategories(true).join(\"|\") + ')-[1-9]+[0-9]*)'\n                var re = new RegExp(regexstr,'g');\n\n                // parse fields\n                var links:string[] = [];\n                let inSection:IStringStringArrayMap = {}\n                $.each(globalMatrix.ItemConfig.getItemConfiguration(item.type).fieldList, function (idx, field) {\n                    if (field.fieldType === FieldDescriptions.Field_richtext || field.fieldType === FieldDescriptions.Field_steplist\n                    || field.fieldType === FieldDescriptions.Field_test_steps || field.fieldType === FieldDescriptions.Field_test_steps_result\n                        || field.fieldType === FieldDescriptions.Field_dhf ) {\n                        var fieldVal = item[field.id];\n                        var match = fieldVal?fieldVal.match(re):null;\n                        if (match) {\n                            $.each( match, function(midx,m) {\n                                if ( m.indexOf(\"F-\")==0 || m.indexOf(\"/\")==0) return; // folder or cross project are not yet supported\n                                if (links.indexOf(m) ===-1) {\n                                    links.push(m);\n                                }\n                                let sn = ( field.fieldType === FieldDescriptions.Field_dhf )? JSON.parse(fieldVal).name:field.label;\n                                if (!inSection[m]) {\n                                    inSection[m] = [];\n                                }\n                                if (inSection[m].indexOf(sn)==-1) {\n                                    inSection[m].push(sn);\n                                }\n                            });\n                        }\n                    }\n                });\n                if (links.length===0) {\n                    smartlinks.append($(\"<div class='contextFrame-select-item'>\").html(\"there are no smart links\"));\n                } else if (links.length>this.maxNumberOfLinks) {\n                    this.renderIds( tabData, links, smartlinks, 'contextFramePreview contextFramePreviewUp', inSection, \"There are to many smart links to show details.\");\n                } else {\n                    this.renderFromIds( tabData, links, smartlinks, 'contextFramePreview contextFramePreviewUp', inSection);\n                }\n\n            } else if (this.resetSmartLinks) {\n                panel.html(\"\").append($(\"<div class='contextFrame-select-item'>\").html(\"select an item to see smartlinks\"));\n            }\n        }\n\n        private showReferencesTab(panel: JQuery, tabData: IContextPageConfigTab) {\n            if (this.context.item && !ml.Item.parseRef(this.context.itemId).isFolder) {\n                panel.html(\"\");\n                var uplinks = $(\"<div>\");\n                var downlinks = $(\"<div>\");\n                panel.append(uplinks);\n                panel.append(\"<hr>\");\n                panel.append(downlinks);\n                panel.append(\"<br>\");\n                let item:IItem = JSON.parse(decodeURI(this.context.item));\n\n                if (item.upLinks.length===0) {\n                    uplinks.append($(\"<div class='contextFrame-select-item'>\").html(\"there are no uplinks\"));\n                } else if (item.upLinks.length>this.maxNumberOfLinks) {\n                    this.renderIds( tabData, this.getUpLinks(item), uplinks, 'contextFramePreview contextFramePreviewUp', null, \"There are to many up links to show details.\");\n                } else {\n                    this.renderFromIds(tabData, this.getUpLinks(item), uplinks, 'contextFramePreview contextFramePreviewUp');\n                }\n\n                if (item.downLinks.length===0) {\n                    downlinks.append($(\"<div class='contextFrame-select-item'>\").html(\"there are no downlinks\"));\n                } else if (item.downLinks.length>this.maxNumberOfLinks) {\n                    this.renderIds( tabData, this.getDownLinks(item), downlinks, 'contextFramePreview contextFramePreviewUp', null, \"There are to many down links to show details.\");\n                } else {\n                    this.renderFromIds(tabData, this.getDownLinks(item), downlinks, 'contextFramePreview contextFramePreviewDown');\n                }\n\n\n            } else {\n                panel.html(\"\").append($(\"<div class='contextFrame-select-item'>\").html(\"select an item to see up and downlinks\"));\n            }\n        }\n\n        private showItemsInFolderTab(panel: JQuery, tabData: IContextPageConfigTab) {\n            if (this.context.item && ml.Item.parseRef(this.context.itemId).isFolder) {\n                panel.html(\"\");\n                var items = $(\"<div>\");\n                panel.append(items);\n                panel.append(\"<br>\");\n\n                this.renderAllInFolder(this.context.itemId, items);\n\n            } else {\n                panel.html(\"\").append($(\"<div class='contextFrame-select-item'>\").html(\"select a folder to see it's items\"));\n            }\n        }\n\n        private showUpReferences(panel: JQuery, tabData: IContextPageConfigTab) {\n            if (this.context.item && !ml.Item.parseRef(this.context.itemId).isFolder) {\n                var links = $(\"<div>\");\n                panel.append(links);\n                panel.append(\"<br>\");\n\n                this.renderAllUpOrDown(this.context.itemId, false,  links);\n            } else {\n                panel.html(\"\").append($(\"<div class='contextFrame-select-item'>\").html(\"select an item to see the up references\"));\n            }\n\n        }\n\n        private showDownReferences(panel: JQuery, tabData: IContextPageConfigTab) {\n            if (this.context.item && !ml.Item.parseRef(this.context.itemId).isFolder) {\n                var links = $(\"<div>\");\n                panel.append(links);\n                panel.append(\"<br>\");\n                this.renderAllUpOrDown(this.context.itemId, true,  links);\n            } else {\n                panel.html(\"\").append($(\"<div class='contextFrame-select-item'>\").html(\"select an item to see the down references\"));\n            }\n        }\n\n        private getUpLinks(item:IItem):string[] {\n            let toDo:string[] = [];\n            $.each(item.upLinks, function ( lidx, link) {\n                toDo.push(link.to);\n            });\n            return toDo;\n        }\n\n        private getDownLinks(item:IItem):string[] {\n            let toDo:string[] = [];\n            $.each(item.downLinks, function ( lidx, link) {\n                toDo.push(link.to);\n            });\n            return toDo;\n        }\n\n        // get full items for a number of items and render them\n        private renderFromIds(  tabData: IContextPageConfigTab, toDoList:string[],render:JQuery, renderClass:string, inSection?:IStringStringArrayMap) {\n            let that = this;\n            if ( toDoList.length === 0) {\n                return;\n            }\n            let searchExpr = toDoList.map(function(id) {return \"id=\" + id;}).join(\" OR \");\n\n            app.getNeedlesAsync(searchExpr, false, true, \"*\", true, true).done(async function (items: IItem[]) {\n                for (let itemId of toDoList) {\n                    let data = items.filter(function (item) {\n                        return item.id == itemId;\n                    });\n                    if (data.length == 0) {\n                        let linkDoesNotExist = $(\"<div class='contextFramePreview contextFramePreviewError'>\");\n                        render.append(linkDoesNotExist);\n                        matrixApplicationUI.renderErrorControl(linkDoesNotExist, \"\" + itemId + \" does not exist\", \"Please correct the link.\", true);\n                        $(\"a[href='#\" + tabData.tabId + \"']\").css(\"color\", \"red\");\n                    } else if (app.canViewItem(data[0])) {\n                        var preview = $(\"<div class='\" + renderClass + \"'>\");\n                        render.append(preview);\n\n                        var ctrl = new ItemControl({\n                            control: preview,\n                            controlState: ControlState.Tooltip,\n                            item: data[0],\n                            isItem: (typeof data[0].children === 'undefined')\n                        });\n                        await ctrl.load();\n                        that.controls.push(ctrl);\n                    } else {\n                        let noView = $(\"<div class='contextFramePreview contextFramePreviewError'>\");\n                        render.append(noView);\n                        matrixApplicationUI.renderErrorControl(noView, \"You have no rights to view \" + itemId + \"\", \"Talk to the project administrator.\", true);\n                    }\n                    if (inSection && inSection[itemId] && inSection[itemId].length) {\n                        render.append($(\"<div class='TitleSpecial'>\").html(\"used in: \" + inSection[itemId].join(\",\")));\n                    }\n                }\n            });\n        }\n\n        // show item ids as a flat list\n        private renderIds(  tabData: IContextPageConfigTab, toDoList:string[],render:JQuery, renderClass:string, inSection?:IStringStringArrayMap, infotext?:string) {\n            let that = this;\n\n            render.append(infotext);\n            render.append(\"<br>\");\n\n            let ul =$(\"<div>\").appendTo(render);\n\n            $.each(toDoList, function(idx, itemId) {\n                let title = app.getItemTitle(itemId);\n                if (!title) {\n                    let dash = itemId.indexOf(\"-\");\n                    $(\"<li><span style='font-weight:bold;color:red'><span>\" + itemId.substr(0,dash) + \"</span>\" + itemId.substr(dash) + \"</span> does not exist.</li>\").appendTo(ul);\n                    $(\"a[href='#\"+tabData.tabId+\"']\").css(\"color\",\"red\");\n                } else {\n                    $(\"<li>\" + itemId + \"!</li>\").appendTo(ul);\n                }\n            });\n            ul.highlightReferences();\n        }\n\n        private nonBlockingRenderNext:number;\n        private async nonBlockingRender(items: IItem[], index: number, renderClass: string, render: JQuery, hideShow: boolean,categoryFilter?:IBooleanMap) {\n            let that = this;\n\n            if (items.length <= index) return;\n\n            let item = items[index];\n            if (app.canViewItem(item)) {\n                let type = ml.Item.parseRef(item.id).type;\n                let preview = $(\"<div class='\" + renderClass + \" \" + type + \"'>\");\n\n                render.append(preview);\n                // need to hide after adding to DOM\n                if (hideShow && categoryFilter && categoryFilter[type] === false ) preview.hide();\n\n                let ctrl = new ItemControl({\n                    control: preview,\n                    controlState: ControlState.Tooltip,\n                    item: item,\n                    isItem: (typeof item.children === 'undefined')\n                });\n                await ctrl.load();\n                that.controls.push(ctrl);\n                // need to re-hide after adding to rendering\n                if (hideShow && categoryFilter && categoryFilter[type]=== false) preview.hide();\n            } else {\n                let noView = $(\"<div class='contextFramePreview contextFramePreviewUp'>\");\n                render.append(noView);\n                matrixApplicationUI.renderErrorControl(noView, \"You have no rights to view \" + item.id + \"\", \"Talk to the project administrator.\", true);\n            }\n\n            this.nonBlockingRenderNext = window.setTimeout(async function () {\n                await that.nonBlockingRender(items, index + 1, renderClass, render, hideShow);\n            }, 200);\n        }\n\n\n        private renderAllUpOrDown( fromItemId:string, down:boolean, render:JQuery) {\n            let that = this;\n\n            let renderSettings = {\n                recursive:localStorage.getItem(\"recursive\")==\"1\"\n            }\n            let filter = $(\"<div style='display:table'>\").appendTo(render);\n            ml.UI.addCheckbox(filter, \"recursively\", renderSettings, \"recursive\", function () {\n                localStorage.setItem(\"recursive\", renderSettings.recursive?\"1\":\"0\");\n                render.html(\"\");\n                that.renderAllUpOrDown( fromItemId, down, render);\n            }).css(\"display\",\"table-cell\").addClass(\"showall_recursive\");\n\n            let renderClass = down?\"contextFramePreview contextFramePreviewDown\":\"contextFramePreview contextFramePreviewUp\";\n\n            let recurse = renderSettings.recursive?\"m\":\"\";\n            let searchExpr = down?(\"uplink\" + recurse + \"=\"+ fromItemId):(\"category!=XTC and downlink\" + recurse + \"=\" +fromItemId);\n\n            window.clearTimeout(this.nonBlockingRenderNext);\n            app.getNeedlesAsync(searchExpr, false, true, \"*\", true, true).done(function (items: IItem[]) {\n\n                if ( items.length == 0) {\n                    that.showNothingFound(render);\n                    return;\n                }\n\n                // find out which categories are returned and add checkbox to UI to show/hide that category\n                let categories:string[] = [];\n                let categoryFilter:IBooleanMap = {};  // default is show all\n\n                for(let item of items) {\n                    let type = ml.Item.parseRef(item.id).type;\n                    if (categories.indexOf(type)==-1) {\n                        // by default 'show items\"\n                        if (typeof categoryFilter[type] == 'undefined') {\n                            categoryFilter[type] = type!=\"XTC\";\n                        }\n                        ml.UI.addCheckbox(filter, type, categoryFilter, type, function () {\n                            if (categoryFilter[type] === true)\n                                $(\".\" + type, render).show();\n                            else\n                                $(\".\" + type, render).hide();\n                        }).css(\"display\",\"table-cell\").css(\"padding-left\",\"12px\").addClass(\"showall_\" + type);\n                        categories.push(type);\n                    }\n                }\n                // render items\n                that.nonBlockingRenderNext = window.setTimeout( async  () => {\n                    that.nonBlockingRender(items, 0, renderClass, render, true);\n                }, 200);\n            });\n        }\n\n        private renderAllInFolder( folderId:string, render:JQuery) {\n            let that = this;\n\n            let renderSettings = {\n                recursive:localStorage.getItem(\"recursiveFolder\")==\"1\"\n            }\n            ml.UI.addCheckbox(render, \"recursively\", renderSettings, \"recursive\", function () {\n                localStorage.setItem(\"recursiveFolder\", renderSettings.recursive?\"1\":\"0\");\n                render.html(\"\");\n                that.renderAllInFolder( folderId, render);\n            }).addClass(\"showall_recursive\");\n\n            let renderClass = \"contextFramePreview contextFramePreviewUp\";\n\n            let searchExpr = \"folder\" + (renderSettings.recursive?\"m\":\"\") + \"=\" + folderId;\n\n            window.clearTimeout(this.nonBlockingRenderNext);\n            app.getNeedlesAsync(searchExpr, false, true, \"*\", true, true).done(function (items: IItem[]) {\n\n                if ( items.length == 0) {\n                    that.showNothingFound(render);\n                    return;\n                }\n                that.nonBlockingRenderNext = window.setTimeout( async function () {\n                    await that.nonBlockingRender(items, 0, renderClass, render, false);\n                }, 200);\n            });\n        }\n\n        private showNothingFound( render:JQuery) {\n            render.append(\"No items found.\")\n        }\n\n        // write data into frames\n        renderContextFrames() {\n            this.controls = [];\n            if (!this.exists || !this.visible || !this.context) {\n                return;\n\n            }\n            let that = this;\n            $.each( this.getTabs(), function (tabIdx:number, tabData:IContextPageConfigTab) {\n                var panel = $('#contextFrameSettingTab_' + tabIdx );\n                if (tabData.type === \"faq\") {\n                    // this is rendered statically once - keep it\n                } else if (tabData.type === \"support\") {\n                    that.showSupport(panel,tabData);\n                } else  if (tabData.type === \"smartlinks\") {\n                    that.showSmartLinksTab(panel,tabData);\n                } else if (tabData.type === \"help\") {\n                    that.showHelp(panel,tabData);\n                } else if (!panel.hasClass(\"active\")) {\n                    // don't actually render it just now, wait until user shows it\n                    if (!panel.hasClass(\"noRefresh\")) {\n                        panel.html(\"\").append(ml.UI.getSpinningWait(\"retrieving data\"));\n                    }\n                } else if (tabData.type === \"iframeget\") {\n                    let jp: IContextInformation = ml.JSON.clone(that.context);\n                    jp.item = \"\";\n                    jp.fieldList = \"\";\n                    var param = $.param( jp, true);\n                    var page = tabData.baseURL + \"?\" + param;\n                    (<HTMLIFrameElement>$('.contextframeIframeget', panel)[0]).src = page;\n                } else if (tabData.type === \"iframe\") {\n                    var iframePoster = $('<form style=\"display:none\" target=\"contextframeIframe_' + tabIdx+ '\" method=\"post\" action=\"'+tabData.baseURL+'\">');\n                    $(\"body\").append(iframePoster);\n                    $.each(that.context, function(vaIdx,va) {\n                        iframePoster.append('<input type=\"hidden\" name=\"'+vaIdx+'\" value=\"'+va+'\">');\n                    });\n                    iframePoster.submit().remove();\n\n                } else if (ContextFrameManager.implements(tabData.type) ) {\n                    ContextFrameManager.renderTab( panel, tabData.type, tabData, that.context );\n                } else if (tabData.type === \"references\") {\n                    that.showReferencesTab(panel,tabData);\n                } else if (tabData.type === \"foldercontent\") {\n                    that.showItemsInFolderTab(panel,tabData);\n                } else if (tabData.type === \"upreferences\") {\n                    panel.html(\"\");\n                    that.showUpReferences(panel, tabData);\n                } else if (tabData.type === \"downreferences\") {\n                    panel.html(\"\");\n                    that.showDownReferences(panel, tabData);\n                } else  {\n                    panel.html(tabData.type);\n                }\n\n            });\n        };\n\n        fillContextFrame(_data:IItem, itemId:string) {\n            if ( !this.exists) {\n                return;\n            }\n            // save the data\n            this.context = {\n                project: matrixSession.getProject(),\n                user: matrixSession.getUser(),\n                server: globalMatrix.matrixBaseUrl,\n                version: app.getVersion(),\n                product: globalMatrix.matrixProduct,\n                itemId:itemId,\n                item:  _data?encodeURI(JSON.stringify(_data)):\"\",\n                fieldList: _data ? encodeURI(JSON.stringify(globalMatrix.ItemConfig.getItemConfiguration(_data.type).fieldList)) : \"\"\n            };\n\n            // fill the frames\n            this.resetSmartLinks = true;\n            this.renderContextFrames();\n        };\n\n        // show context frames, remember as displayed\n        init() {\n            var contextBar = $(\"#contextframesizer\");\n            var container = $(\"#contextframe\");\n\n            this.support = false; // make sure support tab is initialized\n            this.exists = false;\n            if ($(\"#contextframe\").length===0) {\n                // client has no context frames (e.g. admin, mobile, ...)\n                return;\n            }\n            container.html();\n            if ( this.getTabs().length === 0) {\n                return;\n            }\n            let that = this;\n\n            this.exists = true;\n\n\n\n            // paint the tabs\n            var tabpanel = $('<div role=\"tabpanel\" class=\"tabpanel-container contextFrameContainer\">');\n            container.append(tabpanel);\n\n            var tabpanelul = $('<ul class=\"nav nav-tabs contextFrameTabs\" role=\"tablist\">');\n            tabpanel.append(tabpanelul);\n            var tabpanels = $('<div class=\"tab-content\">');\n            tabpanel.append(tabpanels);\n\n            $.each(this.getTabs(), function(tabIdx:number, tabData: IContextPageConfigTab) {\n                tabData.tabId = \"contextFrameSettingTab_\" + tabIdx;\n                tabpanelul.append('<li data-cy=\"tab '+tabData.title + '\" role=\"presentation\" '+(tabIdx===0?'class=\"active\"':'')+'><a href=\"#contextFrameSettingTab_' + tabIdx+ '\"  role=\"tab\" data-toggle=\"tab\">' + tabData.title +'</a></li>');\n                var panel = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane '+(tabIdx===0?'active':'')+'\" id=\"' +  tabData.tabId  + '\" >');\n                tabpanels.append(panel);\n                if (tabData.type === \"iframe\") {\n                    panel.append(`<iframe data-cy=\"iframe ${tabData.title}\" class=\"contextframeIframe\" name=\"contextframeIframe_${tabIdx}\"></iframe>`);\n                }\n                if (tabData.type === \"iframeget\") {\n                    panel.append(`<iframe data-cy=\"iframe ${tabData.title}\"  class=\"contextframeIframeget\" name=\"contextframeIframe_${tabIdx}\"></iframe>`);\n                }\n                else if (tabData.type === \"faq\") {\n                    panel.append(`<iframe data-cy=\"iframe ${tabData.title}\" class=\"contextframeIframe\" name=\"contextframeIframe_${tabIdx}\" src=\"https://urlshort.matrixreq.com/d23/faq\" allowfullscreen=\"allowfullscreen\"></iframe>`);\n                } else if (tabData.type === \"support\") {\n                    that.showSupport(panel,tabData);\n                } else if (tabData.type === \"help\") {\n\n                    that.showHelp(panel,tabData);\n                }\n            });\n\n            $('a[data-toggle=\"tab\"]', tabpanel).on('shown.bs.tab', function (e) {\n                var target = $(e.target).attr(\"href\") // activated tab\n                that.renderContextFrames();\n              });\n\n            // prepare initial size\n            if (!localStorage.getItem('contextframeWidth')) {\n                // it has never been shown, calculate default size amd\n                let contextframeWidth:number = $(document).width() - 722 - $(\"#main\").position().left;\n                if (contextframeWidth < 400) {\n                    contextframeWidth = 400;\n                }\n                localStorage.setItem('contextframeWidth', contextframeWidth.toString());\n            }\n\n            // show frames if they should be visible\n            var contextframeWidth = Number(localStorage.getItem('contextframeWidth'));\n            if ( Number(contextframeWidth) > 0) {\n                this.shouldBeVisible = true;\n                that.showContextFrames();\n            }\n            else\n            {\n                this.shouldBeVisible = false;\n                that.hideContextFrames();\n            }\n\n            // to avoid bug that mouse up is stolen by iframe\n            $(\".contextframeIframe\").mouseenter(function (e) {\n                $(document).off('mousemove');\n            });\n            $(\".contextframeIframeget\").mouseenter(function (e) {\n                $(document).off('mousemove');\n            });\n        };\n\n    }\n","import { InitializePluginManager } from \"./PluginManager\";\nimport { InitializePluginManagerDocuments } from \"./PluginManagerDocuments\";\nimport { InitializePluginManagerFormulas } from \"./PluginManagerFormulas\";\nimport { InitializeTasks } from \"./Tasks\";\nimport { InitializeTestManager } from \"./TestManager\";\nimport { InitializeTrainingManager } from \"./TrainingManager\";\nimport { InitializeFieldHandlers as InitializeFieldHandlers  } from \"./FieldHandlers/index\";\n\nexport { InitializeBusinessLogic };\n\nexport * from \"./BasicFunctions\";\nexport * from \"./Branching\";\nexport * from \"./DBCache\";\nexport * from \"./ItemConfiguration\";\nexport * from \"./MatrixReq\";\nexport * from \"./MatrixRequirementsAPI\";\nexport * from \"./MatrixSession\";\nexport * from \"./PluginManager\";\nexport * from \"./PluginManagerDocuments\";\nexport * from \"./PluginManagerFormulas\";\nexport * from \"./PushMessages\";\nexport * from \"./RestConnector\";\nexport * from \"./RestDB\";\nexport * from \"./Tasks\";\nexport * from \"./TestManager\";\nexport * from \"./TrainingManager\";\nexport * from \"./FieldHandlers/index\";\nexport * from \"./NotificationsBL\";\nexport * from \"./NotificationsCache\";\n\nfunction InitializeBusinessLogic() {\n    // Why: sets up field handlers.\n    InitializeFieldHandlers();\n    // Why: sets up the global plugins\n    InitializePluginManager();\n    // Why: sets up the global mDHF, registers it as a plugin.\n    InitializePluginManagerDocuments();\n    // Why: sets up the global mTasks\n    InitializeTasks();\n    // Why: sets up the global mTM, registers it as a plugin.\n    InitializeTestManager();\n    // Why: sets up the global ContextFrameManager.\n    InitializeTrainingManager();\n    // Why: sets up the global tableMath.\n    InitializePluginManagerFormulas();\n}\nexport {GateFieldHandler} from \"./FieldHandlers/GateFieldHandler\";\n","import { IDB } from \"./DBCache\";\nimport { IControlDefinition, IBooleanMap, IStringMap, IItem, matrixSession } from \"./../../globals\";\nimport type { IItemControlOptions } from \"../UI/Components/index\";\nimport type { IBaseControlOptions } from \"../UI/Controls/BaseControl\";\nimport type { IFieldDescription, IFieldParameter } from \"../../ProjectSettings\";\nimport { XRGetProject_StartupInfo_ListProjectAndSettings } from \"../../RestResult\";\nimport {IDashboardParametersBase} from \"./FieldHandlers/Document/IDashboardParametersBase\";\n\nexport type { IPlugin, ISettingPage, IProjectPageParam, IPluginControl, IPluginPanelOptions };\nexport { PluginManager, plugins };\nexport { pluginHooks };\nexport { InitializePluginManager };\n\ninterface IPlugin {\n\n    initItem?:(item: IItem, jui:JQuery) => void\n    ,initServerSettings?:(serverSettings:XRGetProject_StartupInfo_ListProjectAndSettings) => void\n    , updateMenu?: (ul: JQuery, hook: number) => void,\n\n    /**\n     * Returns true if the plugin offers a control that can display fields of type {fieldType}.\n     */\n    supportsControl?: (fieldType: string) => boolean\n\n    ,createControl?:(ctrlObj:JQuery, settings:IBaseControlOptions) => void\n    ,initProject?:(project:string) => void\n    ,isDefault?:boolean\n    ,filterProject?:(db:IDB[]) => void\n    ,updateSearchPanel?:() => void\n    ,updateItemPanel?:() => void\n    ,updateItem?:(item:IItem) => void\n    ,getProjectPagesAsync?:() => Promise<IProjectPageParam[]>\n    ,preSaveHookAsync?:(isItem:boolean, type:string, controls:IControlDefinition[]) => Promise<{}>\n    , renderActionButtons?: (options: IItemControlOptions, body:JQuery, controls:IControlDefinition[]) => boolean,\n    updateTree?:()=>void\n\n    // admin\n    ,getFieldConfigOptions?:() => IFieldDescription[]\n    ,addFieldSettings?:(configApp:any, project:string, pageId:string, fieldType:string, fieldParams:IFieldParameter, ui:JQuery, paramChanged: () => void, canBePublished?:boolean) => void\n    , getProjectSettingPagesAsync?: () => Promise<ISettingPage[]>\n    , getCustomerSettingPagesAsync?: () => Promise<ISettingPage[]>\n    ,getPluginName?:() => string\n    ,getPluginVersion?:() => string\n    ,categorySetting?:(key:string) => string\n    ,editCategorySetting?:(key:string, category:string) => void\n    ,helpUrl?:string\n    , initPrintingAsync? :() => Promise<void> ;\n\n    /**\n     * Returns a list of TinyMCE menu items to be added to the editor.\n     * @param editor\n     */\n    getTinyMenuItems?(editor:any):ITinyMenu[];\n\n    /**\n     * Returns a list of menu items to be added to the user profile menu in the main app.\n     */\n    getUserMenuItems?():IPluginMenuAction[];\n\n    /**\n     * Returns a list of menu items to be added to the user profile menu of the config page.\n     */\n    getConfigUserMenuItems?():IPluginMenuAction[];\n\n    /**\n     * Returns a list of menu items to be added to the project list.\n     */\n    getProjectMenuItems?():IPluginMenuAction[];\n\n    /**\n     * Returns a list of custom searches to be added to the search drowpdown.\n     */\n    getCustomSearches?():IPluginSearch[];\n\n    /**\n     * Returns a list of menu items to be added to the QMS user profile menu in the liveqms.\n     */\n    getQMSUserMenuItems?(): IPluginMenuAction[];\n\n}\n\nexport interface IPluginHooks {\n    shares: number\n}\n\nlet pluginHooks: IPluginHooks;\npluginHooks = { shares: 0 };\n\ninterface ISettingPage {\n    id:string,\n    title: string,\n    type?:string,\n    help?:string,\n    externalHelp?:string,\n    render:(ui:JQuery) => void,\n    advanced?:() => void,\n    del?: () => void,\n    saveAsync?: () => JQueryDeferred<unknown>,\n    getNode?: ()=> IDB\n}\n\ninterface IProjectPageParam {\n    id: string, // the id\n    title:string, // the title\n    render:any, // function to call when the user clicks on icon\n    destroy?:any, // function to call when the user clicks away\n    folder?:string, // folder in which to appear - TOOLS by default\n    order:number, // higher number further down\n    folderTitle?:string, // if the folder does not exists it will be created using this title\n    icon?:string // optional icon\n    usesFilters:boolean // if set to true the page uses filters so the control will be enabled\n}\ninterface IPluginControl { [key: string]: Function }\n\nexport interface  IPluginCoreForDashboard< DASHBOARDPARAMS extends IDashboardParametersBase>  {\n    getDashboardAsync(): Promise<IDashboardPage<DASHBOARDPARAMS>>;\n    getConfig(): IPluginConfigForDashboard;\n}\nexport interface  IPluginConfigForDashboard{\n    dashboard: IPluginFeatureDashboard,\n}\n\n\n\nexport interface IDashboardPage<T extends IDashboardParametersBase>{\n    renderProjectPage(): void,\n    renderProjectPageWithParams?(params:T, interactive:boolean): Promise<JQuery>,\n    onResize(): void\n}\n\n\n\nexport interface IPluginFeatureBase{\n    /** Whether to show the page */\n    enabled: boolean\n    /** Id of the page in the tree/url */\n    id?: string,\n    /** Title of the page in the tree and of the page when displayed */\n    title?: string;\n}\n\n/** interface for the value to be stored by custom field */\nexport interface IPluginFieldValueBase {\n    /**\n     *  html to be rendered to support the field printing outside of custom section\n     */\n    html: string,\n    /**\n     * value to be stored and used by the control\n     */\n    value: unknown,\n}\nexport interface IPluginFeatureDashboard extends IPluginFeatureBase {\n    /** Icon of the dashboard (See font awesome) */\n    icon: string,\n    /** Parent of the dashboard (It should exists)) */\n    parent: string\n    /** Whether using filter when searching.*/\n    usefilter: boolean,\n    /** Order in the tree */\n    order:number,\n}\n\nexport interface ITinySubMenuItem {\n    type: string;\n    text: string\n    onAction:  () =>void\n}\nexport interface ITinyMenuItem {\n    text: string,\n    getSubmenuItems: () => ITinySubMenuItem[]\n}\nexport interface ITinyMenu{\n    id:string,\n    menuItem:ITinyMenuItem;\n}\n\n\n\n/** Server setting for plugin.\n *\n * This you can use to save setting on an instance level (for all projects)\n * The user can edit these in the admin through the Server Setting Page\n */\nexport interface IServerSettingsBase {\n}\n\n/** Project setting for plugin\n *\n * This you can use to save setting for one specific project.\n * The user can edit these in the admin through the Project Setting Page\n */\nexport interface IProjectSettingsBase {\n    /**  This will contains the a project settings */\n}\n\n\ninterface IPluginPanelOptions { type: string, control: JQuery, controlState: number }\n\n\nexport interface IPluginSearch {\n    menu: string;\n    search: ( selectItems:(string)=>void  )=> Promise<void>;\n}\n\nexport interface IPluginMenuAction {\n    icon: string;\n    title: string;\n    action: ()=> Promise<void>;\n}\n\n\n\nclass PluginManager {\n    private _jui:JQuery; // div for popups\n    private _plugins:IPlugin[] = [];\n    private controls:IPluginControl = { };\n    private destructors:IPluginControl = { };\n    private titles:IStringMap = { };\n    private usesFilters:IBooleanMap = { };\n    private activeControlPage:string;\n\n\n    /** Called by the main UI handing over a div which can be used inside a plugin\n     * to display modal popups\n     *\n     * @param {jquery object} jui a $(\"<div />\") object\n     * @returns {undefined}\n     */\n    setUI(jui:JQuery):void  {\n        this._jui = jui;\n    }\n\n    /** function to register a plugin for a specific menu (specified by the hook)\n     *\n     * @param {instance of plugin} plugin\n     * @returns {undefined}\n     */\n    register(plugin: IPlugin): void {\n        this._plugins.push(plugin);\n    }\n\n    /** this method is called from the main UI whenever an item is selected to be\n     * displayed. The information is forwarded to all plugins\n     *\n     * @param {json object} item for example a requirement. see the json documention of item types\n     * @returns {undefined}\n     */\n    init(item:IItem):void {\n       for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].initItem) {\n                this._plugins[idx].initItem(item, this._jui);\n            }\n        }\n    }\n\n    async initPrinting(){\n        for (let idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].initPrintingAsync) {\n                await this._plugins[idx].initPrintingAsync();\n            }\n        }\n    }\n\n    /** this method is called after connecting to server using getServer (\"\")\n     *\n     * @param {json serverSettings} serverSettings or null after unsucessful login\n     * @returns {undefined}\n     */\n    initServerSettings(serverSettings?:XRGetProject_StartupInfo_ListProjectAndSettings):void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            try {\n            if ( this._plugins[idx].initServerSettings ) {\n                this._plugins[idx].initServerSettings(serverSettings);\n            }\n            } catch (e) {\n                console.log(\"error \" + e.toString());\n            }\n        }\n    }\n\n    /** this method is called when creating a menu which has a hook. it allows the plugins to add\n     * li's to the ul supplied\n     *\n     * @param {number} hook identifies the menu\n     * @param {jquery object} ul  a $(\"<ul />) object\n     * @returns {undefined}\n     */\n    updateMenu(hook:number, ul:JQuery):void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].updateMenu) {\n                this._plugins[idx].updateMenu(ul, hook);\n            }\n        }\n    }\n\n    getFieldConfigOptions(): IFieldDescription[] {\n        let fco: IFieldDescription[] = [];\n        for (let idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].getFieldConfigOptions && this._plugins[idx].supportsControl) {\n                const fieldConfig = this._plugins[idx].getFieldConfigOptions();\n                for(let i = 0; i < fieldConfig.length; i++){\n                    if( this._plugins[idx].supportsControl(fieldConfig[i].id) ){\n                        fco.push(fieldConfig[i]);\n                    }\n                }\n\n            }\n        }\n        return fco;\n    }\n    addFieldSettings(configApp:any, project:string, pageId:string, fieldType:string, fieldParams:IFieldParameter, ui:JQuery, paramChanged: () => void, canBePublished?:boolean) {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].addFieldSettings ) {\n                this._plugins[idx].addFieldSettings(configApp,project, pageId, fieldType, fieldParams, ui,  () => paramChanged(), canBePublished);\n            }\n        }\n    }\n    supportsControl(fieldType: string): boolean {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].supportsControl && this._plugins[idx].supportsControl(fieldType)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    createControl(ctrlObj:JQuery, settings:IBaseControlOptions):void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].supportsControl && this._plugins[idx].supportsControl(settings.fieldType)) {\n                this._plugins[idx].createControl(ctrlObj, settings);\n                return;\n            }\n        }\n    }\n\n    initProject(project:string):void {\n        // delete all non default plugins === custom\n        for (var idx = this._plugins.length-1; idx >= 0; idx--) {\n            if ( !this._plugins[idx].isDefault ) {\n                this._plugins.splice(idx,1);\n            }\n        }\n\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].initProject) {\n                // TODO: Catch and log exceptions here so other plugins can load.\n                try{\n                    this._plugins[idx].initProject(project);\n                }\n                catch(e){\n                    //Display error message to user in the console.\n                    console.error(e);\n                }\n            }\n        }\n        this.initPrinting()\n    }\n\n    // to modify db tree after it has been created\n    filterProject(db:IDB[]):void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].filterProject) {\n                this._plugins[idx].filterProject(db);\n            }\n        }\n    }\n\n    // to modify search panel on left after it has been rendered\n    updateSearchPanel():void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].updateSearchPanel) {\n                this._plugins[idx].updateSearchPanel();\n            }\n        }\n    }\n\n    // to modify item on left after it has been rendered\n    updateItemPanel():void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].updateItemPanel) {\n                this._plugins[idx].updateItemPanel();\n            }\n        }\n    }\n\n    // notify plugins that links of item changed\n    updateItem( updates:IItem ):void {\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].updateItem) {\n                this._plugins[idx].updateItem(updates);\n            }\n        }\n    };\n    updateTree()\n    {\n        for (var idx = 0; idx < this._plugins.length; idx++)\n        {\n            if ( this._plugins[idx].updateTree ) {\n                this._plugins[idx].updateTree();\n            }\n         }\n\n        return ;\n    }\n\n\n    getTinyMenus(editor:any):ITinyMenu[] {\n        let list = [];\n        for(let plugin of this._plugins){\n                if( plugin.getTinyMenuItems) {\n                    let menuItems = plugin.getTinyMenuItems(editor);\n                    if( menuItems && menuItems.length > 0)\n                        list.push(...menuItems);\n            }\n        }\n        return list;\n    }\n\n    getCustomSearches():IPluginSearch[] {\n        let list = [];\n        for(let plugin of this._plugins){\n                if( plugin.getCustomSearches) {\n                    let menuItems = plugin.getCustomSearches();\n                    if( menuItems && menuItems.length > 0)\n                        list.push(...menuItems);\n                }\n        }\n        return list;\n    }\n\n    getUserMenuItems():IPluginMenuAction[] {\n        let list = [];\n        for(let plugin of this._plugins){\n                if( plugin.getUserMenuItems) {\n                    let menuItems = plugin.getUserMenuItems();\n                    if( menuItems && menuItems.length > 0)\n                        list.push(...menuItems);\n                }\n        }\n        return list;\n    }\n\n    getQMSUserMenuItems():IPluginMenuAction[] {\n        let list = [];\n        for(let plugin of this._plugins){\n            if( plugin.getQMSUserMenuItems) {\n                let menuItems = plugin.getQMSUserMenuItems();\n                if( menuItems && menuItems.length > 0)\n                    list.push(...menuItems);\n            }\n        }\n        return list;\n    }\n\n    getConfigUserMenuItems():IPluginMenuAction[] {\n        let list = [];\n        for(let plugin of this._plugins){\n                if( plugin.getConfigUserMenuItems) {\n                    let menuItems = plugin.getConfigUserMenuItems();\n                    if( menuItems && menuItems.length > 0)\n                        list.push(...menuItems);\n                }\n        }\n        return list;\n    }\n\n    getProjectMenuItems():IPluginMenuAction[] {\n        let list = [];\n        for(let plugin of this._plugins){\n                if( plugin.getProjectMenuItems) {\n                    let menuItems = plugin.getProjectMenuItems();\n                    if( menuItems && menuItems.length > 0)\n                        list.push(...menuItems);\n                }\n        }\n        return list;\n    }\n\n\n    async getProjectPages():Promise<IProjectPageParam[]> {\n        let that = this;\n\n        let allPages:IProjectPageParam[] = [];\n\n        for (let idx = 0; idx < this._plugins.length; idx++) {\n            if ( this._plugins[idx].getProjectPagesAsync ) {\n                let pages = await this._plugins[idx].getProjectPagesAsync();\n                for(let page of pages){\n                    allPages.push( page );\n                    that.controls[\"_\" + page.id] = page.render;\n                    that.destructors[\"_\" + page.id] = page.destroy;\n                    that.titles[\"_\" + page.id] = page.title;\n                    that.usesFilters[\"_\" + page.id] = page.usesFilters;\n                }\n            }\n        }\n        return allPages;\n    }\n\n    supportsControlPage( controlType:string ):boolean {\n        return !!this.controls[controlType];\n    }\n\n    createControlPage(options:IPluginPanelOptions, toggleFilters?:(boolean)=>void):void {\n        options.control.html(\"\");\n\n        document.title = this.titles[options.type] + \" - \" + matrixSession.getProject();\n        if ( this.usesFilters[options.type]) {\n            toggleFilters(true);\n        }\n        else  {\n            toggleFilters(false);\n        }\n        this.activeControlPage = options.type;\n        this.controls[options.type](options);\n    }\n\n    destroyActiveControlPage():void {\n        if (this.activeControlPage) {\n            try {\n                const destructor = this.destructors[this.activeControlPage];\n                if (destructor) {\n                    destructor();\n                }\n                this.activeControlPage = null;\n            } catch (e) {\n                console.error(\"Error removing control page\", e);\n            }\n        } else {\n            // console.log(\"No active control page\");\n        }\n    }\n\n    callPreSaveHook(isItem:boolean, type:string, controls:IControlDefinition[]):JQueryDeferred<{}> {\n        let that = this;\n        function callRec(idx:number):JQueryDeferred<{}> {\n            var res = $.Deferred();\n            if (idx>=that._plugins.length) {\n                res.resolve();\n                return res;\n            }\n            if (that._plugins[idx].preSaveHookAsync) {\n                that._plugins[idx].preSaveHookAsync(isItem, type, controls).then( function() {\n                    callRec(idx+1).done( function () {\n                        res.resolve( );\n                    }).fail( function() {\n                        res.reject( );\n                    });\n                }).catch(function() {\n                    callRec(idx+1).always( function () {\n                        res.reject( );\n                    });\n                });\n            } else {\n                callRec(idx+1).done( function () {\n                    res.resolve( );\n                }).fail( function() {\n                    res.reject( );\n                });\n            }\n            return res;\n        }\n        return callRec(0);\n    }\n\n    // return true for handled, false for not  handled\n    renderActionButtons(options:IItemControlOptions, body:JQuery, controls:IControlDefinition[]):boolean  {\n        var done = false;\n        for (var idx = 0; idx < this._plugins.length; idx++) {\n            if (this._plugins[idx].renderActionButtons) {\n                if (this._plugins[idx].renderActionButtons(options, body, controls)) {\n                    done = true;\n                }\n            }\n        }\n        // return true if at least on plugin is owner\n        return done;\n    };\n\n    /******************** admin function  */\n\n    getPlugins() {\n        return this._plugins;\n    }\n\n}\n\nvar plugins: PluginManager;\n\nfunction InitializePluginManager() {\n    plugins = new PluginManager(); // plugin manager\n    globalThis.plugins = plugins;\n    globalThis.pluginHooks = pluginHooks;\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { IDB } from \"./DBCache\";\nimport { ISimpleTree } from \"./MatrixReq\";\nimport { IProjectPageParam, plugins } from \"./PluginManager\";\n\nimport { HTMLCleaner } from \"./../matrixlib/index\";\nimport { ICategoryConfig, XRFieldTypeAnnotated } from \"./ItemConfiguration\";\nimport { XCPostCompareHtml } from \"../../RestCalls\";\nimport { RestDB } from \"./RestDB\";\nimport { IItemControlOptions, ILinkType } from \"../UI/Components/index\";\nimport { IBaseControlOptions, IBaseControl } from \"../UI/Controls/BaseControl\";\nimport { CascadingSelect } from \"../UI/Controls/cascadingSelect\";\nimport { IJcxhr } from \"./RestConnector\";\nimport { ITableRow } from \"../UI/Controls/tableCtrl\";\nimport { ILinkCategories } from \"../UI/Controls/linkCollection\";\nimport { ISignaturesInfo, DocBaseImpl } from \"../UI/Controls/docBase.\";\nimport { IFromToSelection } from \"../UI/Controls/itemSelectionFromTo\";\nimport { IPasteSourceSetting, MarkAsTemplateImpl, ITemplateProjects } from \"../UI/Controls/markAsTemplate\";\nimport { ml } from \"./../matrixlib\";\nimport { refLinkStyle, refLinkTooltip } from \"../UI/Parts/RefLinkDefines\";\nimport { ICreateDialogOptions, ItemCreationTools } from \"../UI/Tools/ItemCreationView\";\nimport { Layouter } from \"../UI/Tools/Layouter\";\nimport { IDHFConfig, IDHFConfigTableColumn, IDropdownOption, IDHFConfigCustomColumn, TableCellEditor } from \"../../ProjectSettings\";\nimport { XRGetProject_JobStatus_JobsStatusWithUrl, XRCategoryExtendedType, XRPostProject_LaunchReport_CreateReportJobAck, XRPostProject_CompareHtml_HtmlCompareResult } from \"../../RestResult\";\nimport { Redlining } from \"../../client/plugins/Redlining\";\nimport { Hidden } from \"../../client/plugins/DocumentSections/Hidden\";\nimport { IReportOptions, IDropDownButtonOption, IReportTransferField, IUploadedFileInfo, UIToolsConstants } from \"../matrixlib/MatrixLibInterfaces\";\nimport { IControlDefinition, IItem, globalMatrix, matrixSession, ControlState, app, IGenericMap, matrixApplicationUI, IReference, IItemGet, restConnection, IItemPut, IStringMap } from \"../../globals\";\nimport {FieldDescriptions} from \"./FieldDescriptions\";\nimport {ColumnEditor, FieldHandlerFactory} from \"./FieldHandlers\";\nimport {DocFieldHandlerFactory} from \"./FieldHandlers/Document\";\nimport {GenericDocFieldHandler} from \"./FieldHandlers/Document/GenericDocFieldHandler\";\nimport {IFieldHandler} from \"./FieldHandlers/IFieldHandler\";\nimport {IDocFieldHandler} from \"./FieldHandlers/Document/IDocFieldHandler\";\nimport {ICustomSectionOptions} from \"./FieldHandlers/Document/CustomDocFieldHandler\";\nimport {IDhfTableOptions} from \"./FieldHandlers/Document/GenericTableDocHandler\";\nimport {SectionDescriptions} from \"./FieldHandlers/Document/SectionDescriptions\";\nimport {IPlugin} from \"./PluginManager\";\n\nimport { IPluginDocumentSection, IDHFFieldListItem, IDHFField, IDHFControlDefinition, IDHFControlDefinitionValue,\n    IDHFSection, IDHFSectionOptions, IDHFFieldParameter, IDHFFieldValue, IDHFXMLOptions, IDHFPasteBuffer, IDHFPasteBufferItem,\n    IDHFPasteBufferValue, IDHFReorder, IDHFFileOption, IDHFGuidOid, IDHFWizardData, IDHFFactory, ISectionInfo,\n    IGrandMother, ISectionMap, ItemSortInfo,DocumentSectionType} from \"./DHFInterfaces\";\nimport { NavigationPanel } from '../UI/MainTree/MainTree';\n\n\n\nexport type {\n    IPluginDocumentSection, IDHFFieldListItem, IDHFField, IDHFControlDefinition, IDHFControlDefinitionValue,\n    IDHFSection, IDHFSectionOptions, IDHFFieldParameter, IDHFFieldValue, IDHFXMLOptions, IDHFPasteBuffer, IDHFPasteBufferItem,\n    IDHFPasteBufferValue, IDHFReorder, IDHFFileOption, IDHFGuidOid, IDHFWizardData, IDHFFactory, ISectionInfo,\n    IGrandMother, ISectionMap, ItemSortInfo\n};\nexport { DocumentSectionType, PluginManagerDocuments };\nexport { ColumnTypesInfo, mDHF };\nexport { InitializePluginManagerDocuments };\n\nconst DOC_NUM_NAME = \"Document Number\";\n\nclass PluginManagerDocuments implements IPlugin  {\n    private wasInformedToday: string;\n    private wasInformedTodayAbout: string;\n    private dhf_config: IDHFConfig;\n    private item: IItem;\n    private jui: JQuery;\n    private ColumnTypes: ColumnTypesInfo;\n    private sectionFactories: IDHFFactory[];\n    private sectionTypeNames: ISectionMap;\n    public readonly COPY_PASTE_BUFFER = \"pasteBuffer\";\n\n    public isDefault = true;\n\n    constructor() {\n        let that = this;\n\n        this.wasInformedTodayAbout = \"\";\n        this.wasInformedToday = \"\";\n        this.sectionFactories = [];\n        this.sectionTypeNames = {};\n    }\n\n    // **********************\n    // plugin interface\n    // **********************\n\n    preSaveHook = (isItem: boolean, type: string, controls: IControlDefinition[]): JQueryDeferred<{}> => {\n        //This hook is called before the item is saved. It is used to modify the reportId in case the user has selected only custom sections or static section\n\n        let deferred = $.Deferred();\n        let that = this;\n\n        let useReportNameOverride = true;\n        let reportOverrideForDocSettings = matrixSession.getCustomerSettingJSON(\"reportNameOverrideForDoc\", {\n            enabled:true,\n            reportNameOverride: \"dhf_generic_print\",\n            positiveList: [\n                \"checkbox\",\n                \"audittrail\",\n                \"signaturebox\",\n                \"templateapproval\",\n                \"responsibilities\",\n                \"genericTable\",\n                \"document_options\",\n                \"duedate\",\n                \"figures_tables\",\n                \"multiselect\",\n                \"remarks\",\n                \"richtext\",\n                \"terms_abbreviations\",\n                \"textline\",\n                \"CustomSection\"\n            ]\n        });\n\n        if (reportOverrideForDocSettings.enabled) {\n            $.each(this.item, function (key, val) {\n                if (val && globalMatrix.ItemConfig.getFieldType(that.item.type, key) === \"dhf\") {\n                    var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                    if (reportOverrideForDocSettings.positiveList.indexOf(fieldVal.type) == -1) {\n                        // Not in positive list so we dont fix the report id\n                        useReportNameOverride = false;\n                    }\n                }\n            });\n\n            let field = globalMatrix.ItemConfig.getFieldByName(\"DOC\", \"reportId\");\n            if (field) {\n                for (let c of controls) {\n                    if (c.fieldId == field.id) {\n                        c.control.getController().setValue(useReportNameOverride ? reportOverrideForDocSettings.reportNameOverride : \"dhf_generic\");\n                    }\n                }\n            }\n        }\n\n        deferred.resolve();\n\n        return deferred;\n    }\n\n    initItem(_item: IItem, _jui: JQuery) {\n        this.item = _item;\n        this.jui = _jui;\n    }\n\n    updateMenu(ul: JQuery, hook: number) {\n        // no tools\n        let that = this;\n\n        if (ml.Item.parseRef(this.item.id).isFolder) {\n\n            // find out if there items in buffer\n            let pb = localStorage.getItem(this.COPY_PASTE_BUFFER);\n            let itemsToPaste = pb ?(<IDHFPasteBuffer>JSON.parse(pb)).items.length:0;\n\n\n            if (itemsToPaste && this.isDocumentFormType(this.item.type)) {\n                let s = (itemsToPaste>1)?\"s\":\"\";\n                var pasteDoc = $('<li title=\"paste document' + s +' from template\"><a href=\"javascript:void(0)\">Paste document' + s +'</a></li>').click(function () {\n                    that.pasteTemplates(that.item.id);\n                });\n                ul.append(pasteDoc);\n            }\n        }\n        if ((this.isSignedType(this.item.type) || this.isDocumentFormType(this.item.type))) {\n            let s = ml.Item.parseRef(this.item.id).isFolder?\"s\":\"\";\n            var copyDoc = $('<li title=\"Copy document' + s +' as template\"><a href=\"javascript:void(0)\">Copy document' + s +'</a></li>').click(function () {\n                that.copyTemplates(that.item.id);\n            });\n            ul.append(copyDoc);\n        }\n    }\n\n    supportsControl(ctrl: string): boolean {\n        // should render dhf controls....\n        return false;\n    }\n\n    createControl(ctrl: JQuery, options: IBaseControlOptions) {\n        // should render dhf controls....\n    }\n\n    initProject(project: string) {\n        let that = this;\n\n\n        this.dhf_config = globalMatrix.ItemConfig.getDHFConfig();\n        if (!this.dhf_config) {\n            this.dhf_config = {};\n        }\n        if (!this.dhf_config.categories) {\n            this.dhf_config.categories = {\n                documentTypes: [\"DOC\", \"SIGN\", \"REPORT\"],\n                documentForms: [\"DOC\"],\n                documentSigned: [\"SIGN\"],\n                documentTemplates: [\"SIGN\"],\n                signAs: \"SIGN\"\n            }\n        }\n        this.ColumnTypes = new ColumnTypesInfo(this.dhf_config);\n\n        // add custom tables for each type\n        $.each(this.dhf_config, function (key0, config0) {\n            if (typeof config0 === \"object\") {\n                $.each(config0, function (key1, config1) {\n                    if (key1 === \"columns\") {\n                        $.each(config1, function (idx: number, val: IDHFConfigTableColumn) {\n                            if (val.columnType) {\n                                val.editor = that.ColumnTypes.getEditorOfType(val.columnType);\n                                var options = that.ColumnTypes.getOptionsOfType(val.columnType);\n                                if (options) {\n                                    val.options = options;\n                                }\n                            }\n                        });\n                    }\n                });\n            }\n        });\n\n    }\n\n\n    getProjectPages():Promise<IProjectPageParam[]> {\n        return new Promise((resolve, reject) => {\n            resolve([]);\n        })\n    }\n    renderActionButtons(options: IItemControlOptions, body: JQuery, controls: IDHFControlDefinition[]): boolean {\n        if (!matrixSession.hasDocs() && (this.isSignedType(options.item.type) || this.isDocumentFormType(options.item.type))) {\n            body.append(\"<span style='color:red'>Document module not licensed</span>\");\n            return true;\n        }\n        if (this.dhf_config.categories.documentSigned.indexOf(options.type) !== -1) {\n            this.renderControlsSIGN(options, body, controls);\n            return true;\n        } else if (mDHF.isDocumentFormType(options.type)) {\n            this.renderControlsDOC(options, body, controls);\n            return true;\n        }\n\n        return false;\n    }\n\n    // *****************************\n    // public interface through mDHF\n    // *****************************\n\n    /* this renders an empty dhf control. It needs the actual field value to find out\n    */\n    renderControl(ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions, fieldValue: string): boolean {\n        let that = this;\n        // store values in control so that they can be rendered by the controller\n        let ctrlDef = ctrl;\n        ctrlDef.isDhfType = true;\n\n        let controller = this.dhfFactory(SectionDescriptions.section_hidden); // if nothing is configured - nothing to render\n        controller.setFieldHandler(new GenericDocFieldHandler(SectionDescriptions.section_hidden,{},\"\"));\n\n        if (fieldValue) { // contains type,value,configuration, and xml for reports\n            ctrlDef.dhfValue = <IDHFControlDefinitionValue>JSON.parse(fieldValue);\n            // create the controller\n            controller = this.dhfFactory(ctrlDef.dhfValue.type);\n            ctrlParameter.fieldValue = ctrlDef.dhfValue.fieldValue;\n            ctrlParameter.help = ctrlDef.dhfValue.name;\n\n\n            ctrlDef.dhfValue.ctrlConfig = DocFieldHandlerFactory.GetDHFFieldConfig(globalMatrix.ItemConfig,ctrlDef.dhfValue.type, ctrlDef.dhfValue.ctrlConfig);\n            let docFieldHandler = DocFieldHandlerFactory.createHandler(globalMatrix.ItemConfig, ctrlDef.dhfValue);\n\n            ctrlParameter.fieldHandler = docFieldHandler;\n            controller.setFieldHandler(docFieldHandler);\n            ctrlParameter.preciseSelection = matrixSession.getUISettings().preciseDocSelect ? true : false;\n\n        }\n\n        // render the control\n        controller.renderControl(ctrlDef, ctrlParameter);\n\n        if (ctrlParameter.canEdit && ctrlDef.dhfValue && !ctrlParameter.isTooltip && !ctrlParameter.isPrint && ctrlParameter.controlState != ControlState.HistoryView && matrixSession.isEditor()) {\n\n            let search = $(\"<button title='Update Selection' style='display:none' class='btn btn-xs btn-default hidden-print refreshButton refreshNeeded'> <span class='fal fa-sync-alt' style='margin-left: -1px;'></span></button>\");\n\n            search.click(function (event) {\n                that.runSearch(controller, ctrlDef);\n            });\n\n            // get the dhf section type\n            let sectionName= \"\";\n            if ( ctrlDef && ctrlDef.dhfValue && ctrlDef.dhfValue.type && this.getDhfControls()[ctrlDef.dhfValue.type]) {\n                sectionName = this.getDhfControls()[ctrlDef.dhfValue.type].sectionName;\n            }\n\n            // add buttons\n            var button = $(\"<button title='Configure \" + sectionName + \"' class='btn btn-xs btn-default hidden-print configbutton'> <span class='fal fa-cog'></span></button>\");\n            if (ctrlDef.dhfValue.type == \"checkbox\"  ) {\n                $(\".baseControl\", ctrlDef.control).append(button);\n            } else if ( $(\".inlineHelp\", ctrlDef.control).length ) {\n                $(\".inlineHelp\", ctrlDef.control).before(search).before(button);\n            } else {\n                $(\".baseControlHelp\", ctrlDef.control).append(search).append(button);\n            }\n            var ctrlParam = ctrlParameter;\n\n            if ( ctrlDef.dhfValue.type == \"CustomSection\" ) {\n                $(\"<button title='Layout \" + sectionName + \"' class='btn btn-xs btn-default hidden-print configbutton'> <span class='fal fa-table'></span></button>\")\n                    .appendTo( $(\".baseControlHelp\", ctrlDef.control))\n                    .click( async function() {\n                        let layouter = new Layouter();\n\n                        let froms = \"\";\n                        let tos = \"\";\n                        let currentSelection = await app.getFieldValueAsync(ctrlDef.fieldId);\n\n                        if (currentSelection) {\n                            // get selected items from UI\n                            let conf = <IFromToSelection>JSON.parse(currentSelection);\n                            froms = (conf.from ? conf.from : []).map(x => x.to).join(\",\");\n                            tos = (conf.to ? conf.to : []).map(x => x.to).join(\",\");\n                        }\n                        if (!froms) {\n                            ml.UI.showError(\"need input!\", \"You need to select some items on which to report on\");\n                            return;\n                        }\n                        let config = <ICustomSectionOptions>controller.getConfig(ctrlDef);\n                        controller.getFieldHandler().setDHFConfig(config);\n\n                        let labelFilter = globalMatrix.ItemConfig.getFieldsOfType(\"docFilter\").length == 1 ? await app.getFieldValueAsync(globalMatrix.ItemConfig.getFieldsOfType(\"docFilter\")[0].field.id) : \"\";\n\n                        layouter.show(app.getCurrentItemId(), ctrlDef.fieldId, ml.JSON.clone({ ...config, ...{} }), froms, tos, labelFilter, (newCode: string) => {\n\n                            (<ICustomSectionOptions>controller.getConfig(ctrlDef)).options = JSON.parse(newCode);\n                            ctrl.configTouched = true;\n                            ctrlParameter.valueChanged.apply(null);\n                        });\n                    });\n            }\n\n            button.click(function () {\n                that.showConfigDialog(sectionName, controller, ctrlDef, ctrlParam, \"Configuration Options\", false);\n            });\n\n            if (controller.hasSearch && controller.hasSearch(ctrl)) {\n                // show search button\n                $(\".baseControlHelp\", ctrlDef.control).addClass(\"refreshNeeded\");\n                search.show();\n                if (controller.verifySearchAsync) {\n                    controller.verifySearchAsync( ctrlDef )\n                }\n            }\n            if (controller.verifyContentAsync) controller.verifyContentAsync(ctrlDef);\n        }\n\n        return !ctrlDef.dhfValue || ctrlDef.dhfValue.type !== \"checkbox\";\n    }\n\n    // ItemForm\n    async getValue(ctrl: IDHFControlDefinition) {\n        if (!ctrl.dhfValue) {\n            // unused control\n            return \"\";\n        }\n        // create the controller\n        let controller = <IDHFSection> (ctrl.control as any).getController();\n        let fieldHandler = controller.getFieldHandler();\n        // udpate the controller values\n        ctrl.dhfValue['fieldValue'] = fieldHandler.getData();\n        // define global options\n        let controllerConfig = fieldHandler.dhfFieldConfig;\n\n        let global: IDHFSectionOptions = {\n            globalOptions: true,\n            page_break: controllerConfig['page_break'],\n            sub_section: controllerConfig['sub_section'],\n            landscape: controllerConfig['landscape'],\n            show_section_title: controllerConfig['show_section_title'],\n            automation: controllerConfig['automation']\n        };\n\n        // get specific options of control and add global as a row\n        let options: IDHFXMLOptions[] = JSON.parse( await fieldHandler.getXmlValue());\n        options.push(global);\n\n        // update the xml dump\n        ctrl.dhfValue['fieldValueXML'] = JSON.stringify(options);\n        ctrl.dhfValue['ctrlConfig'] = controllerConfig;\n\n        ctrl.dhfValue.name =  (DOMPurify.sanitize(ctrl.dhfValue.name) +'').replace(/&lt;/g,\"<\");\n        return JSON.stringify(ctrl.dhfValue);\n    }\n\n    /* used by ItemForm to figure if item needs to be saved */\n    configChanged(ctrl: IDHFControlDefinition) {\n        if (matrixApplicationUI.lastMainItemForm) {\n            let allControls =<IDHFControlDefinition[]>matrixApplicationUI.lastMainItemForm.controls;\n            for (var idx = 0; idx <allControls.length; idx++) {\n                if (allControls[idx].isDhfType && allControls[idx].dhfValue) {\n                    let controller = <IDHFSection> ctrl.control.getController();\n                    if (controller.verifyContentAsync) controller.verifyContentAsync(allControls[idx]);\n                }\n            }\n        }\n        return ctrl.configTouched;\n    }\n\n    /* return default format for REPORTs and DOCUMENTs, used by ItemForm for REPORTs */\n    getDefaultFormat(category: string): string {\n        if (this.dhf_config.defaultFormats && this.dhf_config.defaultFormats[category]) {\n            return this.dhf_config.defaultFormats[category].toLowerCase();\n        }\n        return (category === \"REPORT\") ? \"html\" : \"docx\";\n    }\n\n    // DB Cache\n    showInProjectFolder(category: string): boolean {\n        return !(this.dhf_config && this.dhf_config.renderInTree && this.dhf_config.renderInTree.indexOf(category) !== -1);\n    }\n\n    // ItemForm, toolbar, ... (default DOC, SIGN, REPORT)\n    isDocumentType(category: string): boolean {\n        return this.getDocumentTypes().indexOf(category) !== -1;\n    }\n\n    // used from different document sections (default DOC, SIGN, REPORT)\n    getDocumentTypes(): string[] {\n        return this.dhf_config ? ml.JSON.clone(this.dhf_config.categories.documentTypes) : [];\n    }\n\n    // DOC\n    getDocumentFormTypes(): string[] {\n        return this.dhf_config ? this.dhf_config.categories.documentForms : [];\n    }\n\n    // SIGN (could be DOC and SIGN)\n    getDocumentTemplatesTypes(): string[] {\n        return this.dhf_config ? this.dhf_config.categories.documentTemplates : [];\n    }\n\n    // KeyboardManager (default DOC)\n    isDocumentFormType(category: string): boolean {\n        return mDHF.getDocumentFormTypes().indexOf(category) !== -1;\n    }\n\n    // ItemReference, MatrixReq, PluginManager, RestDb (default SIGN)\n    isSignedType(category: string): boolean {\n        return this.dhf_config.categories.documentSigned.indexOf(category) !== -1;\n    }\n\n    // docSIGN\n    // get all SIGN of an doc, maybe with a specific filter\n    getSignedAsync(docId: string, labelFilter?: string): JQueryDeferred<IReference[]> {\n        let that = this;\n\n        function addChildren(children: IDB, ids: string[]) {\n            $.each(children, function (cidx: number, child: IDB) {\n                if (child.isUnselected == 0) {\n                    if (typeof child.children !== \"undefined\") {\n                        addChildren(<any>child.children, ids);\n                    } else {\n                        ids.push(child.id);\n                    }\n                }\n            });\n        }\n        let res = $.Deferred();\n        // get the document details which has a list of all downlinks\n        app.getItemAsync(docId).done(function (doc: IItemGet) {\n            if (labelFilter) {\n                // get the tree with a label filter which shows which items have the label\n                var cmd = \"/tree?fancy&filter=\" + labelFilter;\n                restConnection.getServer(matrixSession.getProject() + cmd).done(function (tree: IDB[]) {\n                    // build a list of item ids which are not filters\n                    tree = RestDB.filterLegacyReportCat(tree);\n                    let signs: string[] = [];\n                    $.each(tree, function (catidx: number, cat: IDB) {\n                        if (that.dhf_config.categories.documentSigned.indexOf(cat.type) !== -1) {\n                            addChildren(<any>cat.children, signs);\n                        }\n                    });\n                    let refs: IReference[] = [];\n                    // check for each downlink if it has the label or not\n                    $.each(doc.downLinks, function (dlidx, dl) {\n                        if (signs.indexOf(dl.to) !== -1) {\n                            refs.push(dl);\n                        }\n                    });\n                    res.resolve(refs);\n                }).fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                    res.reject(jqxhr, textStatus, error);\n                });\n            } else {\n                // return all downlinks\n                res.resolve(doc.downLinks);\n            }\n        }).fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n            res.reject(jqxhr, textStatus, error);\n        });\n\n        return <any>res;\n    }\n\n    // all different document sections\n    registerSection(sectionType: DocumentSectionType, sectionId: string, sectionName: string, creator: (config?: IDHFConfig, dhfType?: string, columnTypes?: ColumnTypesInfo) => IDHFSection, hidden?:boolean) {\n        this.registerSection2( sectionType, true, sectionId, sectionName, creator, hidden);\n    }\n\n    registerSection2(sectionType: DocumentSectionType, dynamic:boolean, sectionId: string, sectionName: string, creator: (config?: IDHFConfig, dhfType?: string, columnTypes?: ColumnTypesInfo) => IDHFSection, hidden?:boolean) {\n        (<IGenericMap>this.sectionFactories)[sectionId] = creator;\n        if (sectionName) {\n            this.sectionTypeNames[sectionId] = {\n                sectionName: sectionName,\n                sectionType: sectionType,\n                hidden:hidden,\n                dynamic:dynamic\n            }\n        }\n    }\n\n    getSections( dynamic:boolean ) {\n        let that = this;\n        let sections = Object.keys(this.sectionTypeNames);\n        return sections.filter( section => that.sectionTypeNames[section].dynamic == dynamic);\n    }\n\n    // in case the user wants to delete a DOC which happens to be a DOC from which a SIGN has been created which is used as template, ask\n    public isUsedAsTemplate( itemId:string) {\n        let type = ml.Item.parseRef(itemId).type;\n\n        if (type == \"DOC\" || type == \"SIGN\") {\n            let templates = <IPasteSourceSetting>globalMatrix.ItemConfig.getSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING);\n            if (templates && templates.templates) {\n                let filter = templates.templates.filter( function(td) { return (type == \"DOC\")?td.fromDOC==itemId:td.fromSign==itemId;});\n                if (filter.length>0){\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n     // in case the user wants to delete a DOC which happens to be a DOC from which a SIGN has been created which is used as template, remove the templates\n     public removeAsTemplate( itemId:string ) {\n\n        let type = ml.Item.parseRef(itemId).type;\n        if (type == \"DOC\" || type == \"SIGN\") {\n            let templates = <IPasteSourceSetting>globalMatrix.ItemConfig.getSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING);\n            templates.templates = templates.templates.filter( function(td) { return (type == \"DOC\")?td.fromDOC!=itemId:td.fromSign!=itemId;});\n            app.setSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING, templates);\n        }\n    }\n\n    private runSearch(controller: IDHFSection, ctrl: IDHFControlDefinition) {\n        if ( controller.executeSearch) {\n            controller.executeSearch(ctrl );\n        }\n    }\n\n    //show config dialog for section, some part like title are available for all, rest is provided by sections itself\n    showConfigDialog(sectionName:string, _controller: IDHFSection, _ctrl: IDHFControlDefinition, _ctrlParameter: IBaseControlOptions, title: string, hideStandardOptions: boolean) {\n        var controller = _controller;\n        var ctrl = _ctrl;\n\n        var ctrlParameter = _ctrlParameter;\n\n        var controllerConfig = controller.getConfig(ctrl);\n        if (typeof controllerConfig.show_section_title == 'undefined') {\n            // default show title and apply numbering if wanted\n            controllerConfig.show_section_title = \"auto\";\n        }\n\n        let isCheckbox = ctrl && ctrl.dhfValue  && ctrl.dhfValue.type==\"checkbox\";\n        let isRichtext = ctrl && ctrl.dhfValue  && ctrl.dhfValue.type==\"richtext\";\n        let isRisk = ctrl && ctrl.dhfValue  && ctrl.dhfValue.type==\"riskstats\";\n        let isFirstSection = globalMatrix.ItemConfig.getFieldsOfType(\"dhf\", \"DOC\")[0].field.id == ctrlParameter.fieldId;\n\n        var ui = $(\"<div>\");\n        if (!hideStandardOptions) {\n            // add common stuff (like name change)\n            var name = $(\"<div>\").refLink({\n                folder: false, // show id if it exists\n                id: \"Name\" + (sectionName?(\" of \"+ sectionName):\"\") + \":\",\n                title: ctrl.dhfValue.name,\n                style: refLinkStyle.edit,\n                tooltip: refLinkTooltip.none,\n                callback: function () {\n                }\n            });\n\n            ui.append(name);\n\n            if (!isCheckbox) {\n                var globalOptionShowSectionTitle = $('<select class=\"docOptionSelect p_show_section_title form-control\" style=\"\">' +\n                '<option value=\"auto\">Show section title</option>' +\n                '<option value=\"nonumber\">Show section title without numbers</option>' +\n                ((!isRichtext && !isRisk)?'<option value=\"notitle\">Do not show section title</option>':'') +\n                (isRichtext?'<option value=\"notitle\">Do not show section title (note: do not use headings in the text box)</option>':'') +\n                '</select>');\n\n                ui.append($(globalOptionShowSectionTitle));\n                globalOptionShowSectionTitle.val(controllerConfig.show_section_title);\n            }\n\n            var globalOptionNewPage = '<div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"p_newpage\" ' + (controllerConfig.page_break ? 'checked' : '') + '> Add page break after this section (word and pdf)</label></div>';\n            ui.append($(globalOptionNewPage));\n\n            if (!isCheckbox) {\n                let isFirstSection = globalMatrix.ItemConfig.getFieldsOfType(\"dhf\", \"DOC\")[0].field.id == ctrlParameter.fieldId;\n                var globalOptionSubSection = `<div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"p_subsection\" ${controllerConfig.sub_section ? 'checked' : ''} ${(isFirstSection && !controllerConfig.sub_section) ? 'disabled' : ''}> Make it a sub-section${isFirstSection?\" (note: first section cannot be a sub-section!)\":\"\"}</label></div>`;\n                ui.append($(globalOptionSubSection));\n            }\n            var globalOptionLandscape = '<div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"p_landscape\" ' + (controllerConfig.landscape ? 'checked' : '') + '> Print this section in landscape</label></div>';\n            ui.append($(globalOptionLandscape));\n\n            var globalOptionAutomation = $('<input autocomplete=\"off\" style=\"height: 20px;width: 420px;float: right;\" class=\"form-control p_automation\" type=\"text\" name=\"automation\" value=\"\" /> ');\n            var sp = $(\"<span>XSLT processing: </span>\").append(globalOptionAutomation);\n            ui.append(sp);\n            ui.append(\"<div style='padding:4px'>\");\n            globalOptionAutomation.val(controllerConfig.automation ? controllerConfig.automation : '');\n        }\n        // per function stuff\n        var custom = $(\"<div>\");\n        ui.append(custom);\n\n        app.dlgForm.html(\"\");\n        app.dlgForm.append(ui);\n\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n\n        let searchBefore = (<any>controllerConfig)[\"search\"]  + \",\"  + (<any>controllerConfig)[\"searchFrom\"] + \",\"  + (<any>controllerConfig)[\"searchTo\"];\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: title,\n            height: 580,\n            width: 680,\n            modal: true,\n            open: function () {\n                controller.showSpecificSettings(ctrl, ctrlParameter, custom);\n            },\n            resizeStop: function () {\n            },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt',\n                click: async function () {// rescue the show hide control and config controls in case it is rendered again\n                    // common settings\n                    if (!hideStandardOptions && ctrl.dhfValue.name !== name.getValue()) {\n                        ctrl.dhfValue.name = name.getValue();\n                        _controller.getFieldHandler().setFieldName(name.getValue());\n                        ctrl.configTouched = true;\n                        if (isCheckbox) {\n                            (ctrl.control as any).find(\".checkboxLabel\").html(ctrl.dhfValue.name);\n                        } else {\n                            let bcs = (ctrl.control as any).find(\".baseControlHelp\").contents();\n                            $.each(bcs, function (bcIdx, bc) {\n                                if (bc.nodeName == \"#text\") {\n                                    bc.textContent = ctrl.dhfValue.name;\n                                }\n                            });\n                        }\n\n                    }\n\n                    controllerConfig = controller.getConfig(ctrl);\n\n                    if (!isCheckbox) {\n                        // save controls\n                        var showHide = $(\"input:first\", ctrl.control);\n                        showHide.detach();\n                        var label = $(\"label:first\", ctrl.control);\n                        label.detach();\n\n                        // specific settings\n                        if (await controller.saveSpecificSettingsAsync(ctrl, ctrlParameter, custom)) {\n                            ctrl.configTouched = true;\n                        }\n                        // remove 'normal' help and add doc stuff again\n                        $(\".baseControlHelp\", ctrl.control).remove();\n                        (ctrl.control as any).prepend(label);\n                        (ctrl.control as any).prepend(showHide);\n\n                        let searchAfter = (<any>controllerConfig)[\"search\"] + \",\" + (<any>controllerConfig)[\"searchFrom\"] + \",\" + (<any>controllerConfig)[\"searchTo\"];\n                        if (searchAfter.replace(/undefined/g, \"\").length == 2) {\n                            $(\".refreshButton\", ctrl.control).removeClass(\"refreshNeeded\").hide();\n                            $(\".baseControlHelp\", ctrl.control).removeClass(\"refreshNeeded\");\n                        } else {\n                            $(\".refreshButton\", ctrl.control).show();\n                            if (searchAfter != searchBefore) {\n                                $(\".refreshButton\", ctrl.control).addClass(\"refreshNeeded\");\n                                $(\".baseControlHelp\", ctrl.control).addClass(\"refreshNeeded\");\n                            }\n                        }\n\n                        if (!hideStandardOptions && controllerConfig.show_section_title != $(ui.find(\".p_show_section_title\")[0]).val()) {\n                            controllerConfig.show_section_title = $(ui.find(\".p_show_section_title\")[0]).val();\n                            // save the checkbox change!\n                            _controller.getFieldHandler().setDHFConfig(controllerConfig);\n                            ctrl.configTouched = true;\n                        }\n\n                        if (!hideStandardOptions && controllerConfig['sub_section'] != $(ui.find(\".p_subsection\")[0]).prop('checked')) {\n                            controllerConfig['sub_section'] = $(ui.find(\".p_subsection\")[0]).prop('checked');\n                            // save the checkbox change!\n                            _controller.getFieldHandler().setDHFConfig(controllerConfig);\n\n                            ctrl.configTouched = true;\n                        }\n\n                    }\n                    if (!hideStandardOptions && controllerConfig['page_break'] != $(ui.find(\".p_newpage\")[0]).prop('checked')) {\n                        controllerConfig['page_break'] = $(ui.find(\".p_newpage\")[0]).prop('checked');\n                        // save the checkbox change!\n                        _controller.getFieldHandler().setDHFConfig(controllerConfig);\n                        ctrl.configTouched = true;\n                    }\n\n                    if (!hideStandardOptions && controllerConfig['landscape'] != $(ui.find(\".p_landscape\")[0]).prop('checked')) {\n                        controllerConfig['landscape'] = $(ui.find(\".p_landscape\")[0]).prop('checked');\n                        // save the checkbox change!\n                        _controller.getFieldHandler().setDHFConfig(controllerConfig);\n                        ctrl.configTouched = true;\n                    }\n                    if (!hideStandardOptions && controllerConfig['automation'] != $(ui.find(\".p_automation\")[0]).val()) {\n                        controllerConfig['automation'] = $(ui.find(\".p_automation\")[0]).val();\n                        // save the checkbox change!\n                        _controller.getFieldHandler().setDHFConfig(controllerConfig);\n                        ctrl.configTouched = true;\n                    }\n                    if (ctrl.configTouched && ctrlParameter.valueChanged) {\n                        ctrlParameter.valueChanged.apply(null);\n                    }\n                    app.dlgForm.dialog(\"close\");\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        });\n    }\n\n    // ContextFrames (Help Tool)\n    getArchiveButtonName() {\n        if (this.dhf_config && this.dhf_config.archiveButtonName) {\n            return this.dhf_config.archiveButtonName;\n        }\n        return \"Ready to Sign / Release\";\n    }\n    getToolFolderName() {\n        if (this.dhf_config && this.dhf_config.toolFolderName) {\n            return this.dhf_config.toolFolderName;\n        }\n        return null;\n    }\n    // ItemControl\n    showCreateFromDocx(options: ICreateDialogOptions) {\n        let that = this;\n        function doImport( params:IDHFWizardData ) {\n            // show spinning wait\n            app.dlgForm.html(\"\").append(ml.UI.getSpinningWait(\"Converting document ...\"));\n            ml.UI.setEnabled($('button', app.dlgForm.parent()), false);\n            // convert document\n\n            let fileId = JSON.parse(params.template)[0].fileId;\n            let fileNo = Number(fileId.split(\"?\")[0]);\n            app.convertDocAsync(fileNo, options.parent).done(function (docId) {\n\n                // patch the document\n                app.getItemAsync(docId).done(function (newDoc) {\n\n                    let changes:IItemPut = { id: docId, onlyThoseFields: 1, onlyThoseLabels: 1 };\n                    changes.title = params.dhfName;\n\n                    let type = ml.Item.parseRef(docId).type;\n                    let docNumberField = globalMatrix.ItemConfig.getFieldId(type, DOC_NUM_NAME);\n\n                    $.each(newDoc, function(fieldId, fieldValue) {\n                        let fieldType = globalMatrix.ItemConfig.getFieldType(type, fieldId);\n                        if ( fieldType === FieldDescriptions.Field_dhf) {\n                            if (fieldValue) {\n                                let parsed = <IDHFControlDefinitionValue>JSON.parse(fieldValue);\n                                if (parsed.type === FieldDescriptions.Field_richtext &&  parsed.fieldValue) {\n                                     parsed.fieldValue = new HTMLCleaner( parsed.fieldValue, false).getClean(HTMLCleaner.CleanLevel.Strict, false);\n                                     parsed.fieldValueXML = JSON.stringify([{\"globalOptions\":true}]);\n                                     (<IGenericMap>changes)[fieldId] = JSON.stringify(parsed);\n                                }\n                            }\n                        } else if (fieldType === FieldDescriptions.Field_textline && \"\"+fieldId == \"\"+docNumberField && params.dhfNumber ) {\n                             (<IGenericMap>changes)[fieldId] = params.dhfNumber;\n                        }\n                    });\n                    if (params.dhfGUID) {\n                        let guid = globalMatrix.ItemConfig.getFieldsOfType(\"guid\", type);\n                        if (guid.length==1) {\n                            (<IGenericMap>changes)[guid[0].field.id] = params.dhfGUID;\n                        }\n                    }\n                    let fileAttachmentControl = globalMatrix.ItemConfig.getFieldsOfType(\"fileManager\", type);\n                    if ( fileAttachmentControl.length > 0 ) {\n                        (<IGenericMap>changes)[fileAttachmentControl[0].field.id] = params.template;\n                    }\n                    app.updateItemInDBAsync(changes, \"post docx conversion\").always(function (newItem) {\n\n                        let createdItem = {\n                            parent: options.parent,\n                            position: 100000,\n                            item: newItem\n                        };\n                        app.insertInTree(createdItem);\n                        app.updateCache(createdItem);\n\n                        app.treeSelectionChangeAsync(docId);\n                        ml.UI.setEnabled($('button', app.dlgForm.parent()), true);\n                        app.dlgForm.dialog(\"close\");\n                    });\n                });\n            });\n        }\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Import and Convert Word Document\",\n            height: 400,\n            width: 720,\n            modal: true,\n            open: function () {\n                var okButton = $('.btnDoIt', app.dlgForm.parent());\n                that.showDHFCreateWizard(options.type, app.dlgForm, $('.btnDoIt', app.dlgForm.parent()), doImport, true);\n            },\n            close: function () {\n                NavigationPanel.focusTree()\n            },\n            resizeStop: function () {\n            },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt',\n                click: function () {\n\n                }\n            } , {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        });\n    }\n\n    // docReview control\n    loadDocument(jobId: number, onLoad: (htmlDOM: any) => void) {\n        let that = this;\n\n        app.getReportDetails(jobId).done(function (progress: XRGetProject_JobStatus_JobsStatusWithUrl) {\n\n            if (progress.status === \"Error\" || progress.status.indexOf(\"Report generation error\") === 0) {\n                ml.UI.showError(\"Error creating document\", \"\");\n            }\n            else if (progress.status !== \"Done\" || progress.progress < 100) {\n                window.setTimeout(function () {\n                    that.loadDocument(jobId, onLoad);\n                }, 500);\n            }\n            else {\n                app.downloadInMemory(jobId, progress.jobFile[progress.jobFile.length - 1].jobFileId.toString()).done(function (htmlpage: string) {\n\n                    var htmlDOM = $.parseHTML(htmlpage);\n                    if (!htmlDOM) {\n                        ml.Logger.log(\"error\", \"Received report is no (valid) HTML.\");\n                    } else {\n                        for (var idx = 0; idx < htmlDOM.length; idx++) {\n                            if ((<{ id: string }>htmlDOM[idx]).id === \"report\") {\n                                onLoad(htmlDOM[idx]);\n                            }\n                        }\n                    }\n                });\n            }\n        });\n    }\n\n    getSignatureMeanings():IStringMap {\n        if (this.dhf_config) {\n            return this.dhf_config.signatureMeanings;\n        }\n        return null;\n    }\n    // *****************\n    // private interface\n    // *****************\n\n    /* returns sections from a pre-configure document, e.g. report, plan, sop, ... */\n    private getDefaultFields(option: string): IDHFField[] {\n\n        var fields: IDHFField[] = [];\n        if ( this.dhf_config.controlledDocs[option] ) {\n            $.each(this.dhf_config.controlledDocs[option].fields, function (index, value) {\n                $.each(value, function (key, val) {\n                    fields.push({ type: key, name: val });\n                });\n            });\n        }\n        return fields;\n    }\n\n    getDhfControls(): ISectionMap {\n        let that = this;\n\n        mDHF.dhf_config\n\n        let sn: ISectionMap = {};\n        let keys = Object.keys(this.sectionTypeNames);\n        keys.sort();\n\n        $.each(keys, function (idx, key) {\n            sn[key] = that.sectionTypeNames[key];\n        });\n        // add custom columns to section options\n        if (this.dhf_config.customTables) {\n            $.each(this.dhf_config.customTables, function (index, table) {\n                sn[table.id] = {\n                    sectionName: table.name, sectionType: DocumentSectionType.CustomTable, hidden:false, dynamic:false\n                };\n            });\n        }\n\n        return sn;\n    }\n\n    // for admin client\n    setConfig( config:IDHFConfig) {\n        this.dhf_config = config;\n    }\n    private appendConfigTool(creationButtons: JQuery, _config: ICategoryConfig, _item: IItem) {\n        let that = this;\n\n        if (!matrixSession.isEditor() || !globalMatrix.ItemConfig.canEdit(_item.type)) {\n            return;\n        }\n        var itemId = _item.id;\n\n        var buttonHolder = $(\"<button id='documentConfig' title='Document Sections' class='btn btn-item hidden-print'> <span class='fal fa-cog'></span></button>\");\n        creationButtons.append(\" \").append(buttonHolder);\n        buttonHolder.click(function () {\n            if (app.getNeedsSave()) {\n                ml.UI.showError(\"Save Item\", \"Please save before modifying document options.\");\n                return;\n            }\n            app.getItemAsync(itemId).done(function (item) {\n                var added = false;\n                var update: IItemPut = {onlyThoseFields:1, onlyThoseLabels:1};\n                $.each(item, function (key, val) {\n                    if (key === \"type\" || key === \"title\" || key === \"id\" || globalMatrix.ItemConfig.getFieldType(item.type, key)) {\n                        if (!added && globalMatrix.ItemConfig.getFieldType(item.type, key) === 'dhf' && !val) {\n                            added = true;\n                            (<IStringMap>update)[key] = JSON.stringify({ \"type\": \"document_options\", \"name\": \"Document Options\", \"fieldValue\": \"\", \"ctrlConfig\": { \"auto_number\": false, \"omit_title\": false } });\n                        } else {\n                            (<IStringMap>update)[key] = val;\n                        }\n                    }\n                });\n                if (!added) {\n                    ml.UI.showError(\"Cannot add document options!\", \"\");\n                    return;\n                }\n                app.updateItemInDBAsync(update, \"report update\").done(function (result) {\n                    app.renderItem(result);\n                    $(\"#buttonDocOptions\").click();\n                }).fail(function (error) {\n                    ml.UI.showError(\"Failed to save changes!\", error);\n                });\n\n            });\n        });\n\n        var button = $(\"<button title='Document Sections' class='btn btn-item hidden-print dhfConfigureSections'> <span class='fal fa-list'></span></button>\");\n        creationButtons.append(\" \").append(button);\n        button.click(function () {\n            if (app.getNeedsSave()) {\n                ml.UI.showError(\"Save Item\", \"Please save before modifying document sections.\");\n                return;\n            }\n            ml.UI.setEnabled(button, false);\n            app.getItemAsync(itemId).done(function (item) {\n                ml.UI.setEnabled(button, true);\n                that.reorderDialog(item);\n            });\n        });\n    }\n\n    private getSignatures(allControls: IDHFControlDefinition[]): string[] {\n        var signatures: string[] = [];\n        for (var idx = 0; idx < allControls.length; idx++) {\n            if (allControls[idx].isDhfType && allControls[idx].dhfValue) {\n                let controller = allControls[idx].control.getController();\n                controller.fieldHandler.addSignatures(signatures, allControls[idx], true);\n            }\n        }\n        return signatures;\n    }\n\n\n    private showDHFCreateWizard(category: string, dlgInner: JQuery, nextButton: JQuery, endWizard: Function, importDocx:boolean) {\n        let that = this;\n\n        async function enableNext() {\n            var enabled = (await documentName.getController().getValueAsync() && await documentName.getController().getValueAsync() !== \"\");\n            if (importDocx) {\n                let val = await createTemplate.getController().getValueAsync();\n                if (val && JSON.parse(val).length > 0) {\n                    if (!enabled) {\n                        documentName.getController().setValue(JSON.parse(val)[0].fileName.replace(\".docx\", \"\"));\n                    }\n                    enabled = true;\n                } else {\n                    enabled = false;\n                }\n            }\n            ml.UI.setEnabled(nextButton, enabled);\n        }\n        // create wizard\n        ml.UI.setEnabled(nextButton, false);\n        var documentName = $(\"<div class='controlContainer'>\");\n        documentName.plainText({\n            controlState: ControlState.DialogCreate,\n            canEdit: true,\n            // TODO(modules): field dummyData wasn't in the original definition, why is it here?\n            dummyData: false,\n            help: 'Document Name',\n            fieldValue: \"\",\n            valueChanged: function () {\n                enableNext();\n            },\n            parameter: {\n                rows: 1,\n                allowResize: false\n            }\n        });\n        dlgInner.append(documentName);\n        let documentId: JQuery = null;\n        if (globalMatrix.ItemConfig.getFieldId(category, DOC_NUM_NAME)) {\n            documentId = $(\"<div  class='controlContainer'>\");\n            documentId.plainText({\n                controlState: ControlState.DialogCreate,\n                canEdit: true,\n                dummyData: false,\n                help: DOC_NUM_NAME,\n                fieldValue: \"\",\n                valueChanged: function () {\n                },\n                parameter: {\n                    rows: 1,\n                    allowResize: false\n                }\n            });\n            dlgInner.append(documentId);\n        }\n        let documentGUID: JQuery = null;\n\n        let createTemplate = $(\"<div  class='controlContainer'>\");\n        /* prepare pre-configured document types, e.g. report, plan, sop... to be used in a drop down */\n        var options: IDHFFieldListItem[] = [];\n        for (var opt in this.dhf_config.controlledDocs) {\n            options.push({ id: opt, label: opt });\n        }\n        var dhfConfig = $(\"<div>\");\n        dlgInner.append(dhfConfig);\n\n        if ( importDocx ) {\n            createTemplate.fileManager({\n                controlState: ControlState.DialogCreate,\n                canEdit: true,\n                help: \"Word Document\",\n                fieldValue: \"\",\n                valueChanged: function() {\n                    enableNext();\n                },\n                parameter: {\n                    readonly: false,\n                    replace: \"type_auto\",\n                    autohide: false,\n                    manualOnly: true,\n                    titleBarControl: null,\n                    extensions:[\"docx\"],\n                    textTodo:\"Upload word document\",\n                    single:true\n                }\n            })\n        } else {\n            // alow user to choose default layout\n            createTemplate.mxDropdown({\n                controlState: ControlState.DialogCreate,\n                canEdit: true,\n                dummyData: false,\n                help: 'Document Sections',\n                fieldValue: \"Empty\",\n                valueChanged: function () {\n                },\n                parameter: {\n                    placeholder: \"choose field preset\",\n                    create: false,\n                    options: options,\n                    maxItems: 1,\n                    sort: false\n                }\n            });\n        }\n        dlgInner.append(createTemplate);\n        // execute the next only once\n        nextButton.one(\"click\", async function (event) {\n            if (importDocx) {\n\n                endWizard({\n                    template: await createTemplate.getController().getValueAsync(),\n                    dhfName: await documentName.getController().getValueAsync() ? await documentName.getController().getValueAsync() : \"no name\",\n                    dhfNumber: (documentId && await documentId.getController().getValueAsync()) ? await documentId.getController().getValueAsync() : \"no id\",\n                    dhfGUID: documentGUID ? (<CascadingSelect>documentGUID.getController()).getGuid() : \"\"\n                });\n                if (event.preventDefault)\n                    event.preventDefault();\n                return false;\n            }\n            documentName.hide();\n            if (documentId) documentId.hide();\n            if (documentGUID) documentGUID.hide();\n            createTemplate.hide();\n\n            var dhfDefaultFields = mDHF.getDefaultFields(await createTemplate.getController().getValueAsync());\n\n            let sectionSelect: IDropdownOption[] = [];\n\n            $.each(mDHF.getDhfControls(), function (key: string, val: ISectionInfo) {\n                if (key !== 'document_options' && !val.hidden) {\n                    sectionSelect.push({id: key, label: val.sectionName, class: val.sectionType.toString()});\n                }\n            });\n            // sort by group + alphabet\n            var sortedSectionTypes = [DocumentSectionType.Static.toString(), DocumentSectionType.Technical.toString(), DocumentSectionType.Database.toString(), DocumentSectionType.Table.toString(), DocumentSectionType.CustomTable.toString()]\n            sectionSelect.sort(function (a, b) {\n                if (sortedSectionTypes.indexOf(a.class) < sortedSectionTypes.indexOf(b.class)) return -1;\n                if (sortedSectionTypes.indexOf(a.class) > sortedSectionTypes.indexOf(b.class)) return 1;\n\n                return a.label < b.label ? -1 : 1;\n            });\n            // insert separators\n            // sectionSelect.splice(0,0 ,{id:\"CUSTOMSECTION\", label:\"CUSTOM SECTION\", disabled:true});\n            var pos = sectionSelect.map(function (ss) {\n                return ss.class;\n            }).indexOf(DocumentSectionType.Static.toString());\n            if (pos != -1) sectionSelect.splice(pos, 0, {id: \"Static\", label: \"Static\", disabled: true});\n            pos = sectionSelect.map(function (ss) {\n                return ss.class;\n            }).indexOf(DocumentSectionType.Database.toString());\n            if (pos != -1) sectionSelect.splice(pos, 0, {id: \"Static\", label: \"Dynamic (Database)\", disabled: true});\n            pos = sectionSelect.map(function (ss) {\n                return ss.class;\n            }).indexOf(DocumentSectionType.Table.toString());\n            if (pos != -1) sectionSelect.splice(pos, 0, {id: \"Static\", label: \"TOCs and Indexes\", disabled: true});\n            pos = sectionSelect.map(function (ss) {\n                return ss.class;\n            }).indexOf(DocumentSectionType.CustomTable.toString());\n            if (pos != -1) sectionSelect.splice(pos, 0, {id: \"Static\", label: \"Custom Tables\", disabled: true});\n\n            dhfConfig.tableCtrl({\n                controlState: ControlState.DialogCreate,\n                canEdit: true,\n                dummyData: false,\n                help: 'Configure Sections',\n                fieldValue: JSON.stringify(dhfDefaultFields),\n                valueChanged: function () {\n                },\n                parameter: {\n                    maxRows: that.getNumberOfDHFSections(category),\n                    canBeModified: true,\n                    columns: [{name: \"Section Title\", field: \"name\", editor: ColumnEditor.textline},\n                        {name: \"Type\", field: \"type\", editor: ColumnEditor.select, options: sectionSelect}\n                    ]\n\n                }\n            });\n\n            // prepare next step\n            // disable next for one second\n            nextButton.prop(\"disabled\", true);\n            nextButton.addClass(\"ui-state-disabled\");\n            window.setTimeout(function () {\n                nextButton.prop(\"disabled\", false);\n                nextButton.removeClass(\"ui-state-disabled\");\n                $(\"span\", nextButton).html(\"Create\");\n            }, 1000);\n\n            nextButton.click(async function (event) {\n                ml.UI.setEnabled(nextButton, false);\n                let dhfItems = <ITableRow[]>(await dhfConfig.getController().getValueAsync() ? JSON.parse(await dhfConfig.getController().getValueAsync()) : []);\n                dhfItems = dhfItems.filter(function (row) {\n                    return !!row.type;\n                }).map(function (row) {\n                    if (!row.name) {\n                        row.name = row.type;\n                    }\n                    return row;\n                });\n                endWizard({\n                    dhfItems: dhfItems,\n                    dhfName: await documentName.getController().getValueAsync() ? await documentName.getController().getValueAsync() : \"no name\",\n                    dhfNumber: (documentId && await documentId.getController().getValueAsync()) ? await documentId.getController().getValueAsync() : \"no id\",\n                    dhfGUID: documentGUID ? (<CascadingSelect>documentGUID.getController()).getGuid() : \"\"\n                });\n                if (event.preventDefault)\n                    event.preventDefault();\n                return false;\n            });\n            if (event.preventDefault)\n                event.preventDefault();\n            return false;\n\n        });\n    }\n\n    public getBaseDOCofSIGN( project:string, itemSigned:IItem ) {\n        let res = $.Deferred();\n\n        let parents = itemSigned.upLinkList?itemSigned.upLinkList.filter( ul => ml.Item.parseRef(ul.itemRef).type==\"DOC\" ):[];\n        if (parents.length==0) {\n            ml.Logger.warning(\"there's a SIGN without a parent DOC - cannot fill sign Info\");\n            res.reject();\n            return res;\n        }\n\n        let signCreationDate = new Date( itemSigned.history[itemSigned.history.length-1].date );\n        let vl = parents[0].itemRef;\n        let theDoc = ml.Item.parseRef(vl);\n\n        app.getProjectItemAsync(project, theDoc.id).done(function (docWithHistory) {\n            // go through history of DOC and find the version which existed just before creating the SIGN\n            let docIdx =  docWithHistory.history.length-1;\n            while( docIdx>=0 && new Date(docWithHistory.history[docIdx].date)<=signCreationDate) {\n                docIdx--;\n            }\n            // that's the version used to create the SIGN\n            let docVersion = docWithHistory.history[docIdx+1].version;\n            // get that version of the DOC\n            app.getProjectItemAsync(project, theDoc.id, docVersion).done(function (itemDoc) {\n\n                res.resolve( itemDoc)\n            }).fail( () => {\n                res.reject();\n            });\n        }).fail( () => {\n            res.reject();\n        });\n        return res;\n    }\n    private createFromTemplate(project: string, signId: string, title: string, options: ICreateDialogOptions) {\n        let that = this;\n\n        app.getProjectCatFields(project).done(function (categories) {\n\n            app.getProjectItemAsync(project, signId).done(function (itemSigned) {\n                if (itemSigned.isDeleted) {\n                    ml.UI.showError( \"Instantiating Template Failed\", \"SIGN has been deleted.\");\n                    return;\n                }\n\n                let signType = ml.Item.parseRef(signId).type;\n                if (that.isDocumentFormType(signType)){\n                    that.transformTemplate( signId, categories, itemSigned, itemSigned.title, project, options);\n                } else {\n                    that.getBaseDOCofSIGN( project, itemSigned).done( (itemDoc:IItem ) => {\n                        that.transformTemplate(signId, categories, itemDoc, itemSigned.title?itemSigned.title:title, project, options);\n                    }).fail( () => {\n                        ml.UI.showError( \"Instantiating Template Failed\", \"The DOC has been deleted.\");\n                    });\n\n                }\n\n\n\n            });\n        }).fail( function(jqxhr, textStatus, error) {\n            ml.UI.showError( \"Instantiating Template Failed\", \"You have no access to this template\");\n        });\n    }\n\n    private transformTemplate(signId: string, categories: XRCategoryExtendedType[], itemDoc: IItem, title: string, project: string, options: ICreateDialogOptions) {\n        let that = this;\n\n        let pasteBuffer: IDHFPasteBufferValue[] = [];\n        let guidFieldId: number = 0;\n\n        $.each(categories, function (cidx, cat) {\n            if (cat.category.shortLabel === itemDoc.type) {\n                let fields = cat.fieldList.field;\n                $.each(fields, function (fidx, f) {\n                    pasteBuffer.push({\n                        def: f,\n                        val: (<IGenericMap>itemDoc)[f.id]\n                    });\n                    if (f.fieldType === FieldDescriptions.Field_guid) {\n                        guidFieldId = f.id;\n                    }\n                });\n            }\n        });\n\n        var itemJson: IItemPut = {};\n\n        itemJson.title = title;\n\n        const docfields = globalMatrix.ItemConfig.getItemConfiguration(ml.Item.parseRef(options.parent).type).fieldList;\n        const pastebufferDHF = pasteBuffer.filter(pb => pb.def.fieldType === FieldDescriptions.Field_dhf);\n        const pastebufferNonDHF = pasteBuffer.filter(pb => pb.def.fieldType !== FieldDescriptions.Field_dhf);\n        $.each(docfields, function (fidx, f) {\n            for (let idx = 0; idx < pastebufferNonDHF.length; idx++) {\n                if (pastebufferNonDHF[idx].def.label === f.label) {\n                    (<IGenericMap>itemJson)[f.id] = pastebufferNonDHF[idx].val;\n                }\n            }\n        });\n        const dhfDocFields = docfields.filter(df => df.fieldType === FieldDescriptions.Field_dhf);\n        if (dhfDocFields.length < pastebufferDHF.length) {\n            ml.UI.showError(\"Template does not match target project\", \"The target project DOCs don't have enough section fields. Please contact your admin to increase the number of sections in the DOC category\");\n        } else {\n            for(let it=0; it<pastebufferDHF.length; it++) {\n                (<IGenericMap>itemJson)[dhfDocFields[it].id] = pastebufferDHF[it].val;\n            }\n            itemJson.title = title;\n            that.pasteTemplate({tree:null,items:[]}, 0, options.parent, true, itemJson,\n                guidFieldId ? (<IGenericMap>itemDoc)[guidFieldId] : \"\", project,signId);\n        }\n    }\n\n    // itemId:  an item : an item or folder\n    private copyTemplates(itemId: string): JQueryDeferred<{}> {\n        let res = $.Deferred();\n\n\n        let tree = app.getSubTree(itemId);\n        let items = app.getChildrenIdsRec(itemId);\n\n        this.preparePasteBuffer(tree);\n\n        let showProgressBar = items.length > 1;\n\n        if ( showProgressBar ) {\n            ml.UI.BlockingProgress.Init([{name:\"Copying Documents\"}]);\n            ml.UI.BlockingProgress.SetProgress(0, 1);\n        }\n        this.copyTemplate(items, 0, !showProgressBar ).done(function() {\n            if ( showProgressBar ) {\n                ml.UI.BlockingProgress.SetProgress(0, 100);\n            }\n        }).fail( function(error:string) {\n            if ( showProgressBar ) {\n                ml.UI.BlockingProgress.SetProgressError(0, error);\n            }\n        }).always( function() {\n            res.resolve();\n        });\n        return res;\n    }\n    public copyTemplate(items:string[], itemIdx:number, quiet:boolean): JQueryDeferred<{}> {\n\n        let that = this;\n\n        let res = $.Deferred();\n\n        if ( items.length == itemIdx) {\n            res.resolve();\n            return res;\n        }\n\n        let itemId = items[itemIdx];\n\n        if (!quiet) {\n            ml.UI.BlockingProgress.SetProgress(0, 100 * itemIdx / items.length);\n        }\n        app.getItemAsync(itemId).done(function (item) {\n            if (that.isDocumentFormType(ml.Item.parseRef(itemId).type)) {\n                app.getItemAsync(itemId, item.history[0].version).done(function (item_h) {\n                    that.addToPasteBuffer(item_h, item.title, itemId + \"-v\" + item.history[0].version, itemId);\n                    that.copyTemplate(items, itemIdx+1, quiet).done( function() {\n                        res.resolve();\n                    }).fail( function(error) {\n                        res.reject(error);\n                    });\n                }).fail( function(error) {\n                    res.reject(error);\n                });\n            } else if (item.upLinkList && item.upLinkList.length && that.isDocumentFormType(ml.Item.parseRef(item.upLinkList[0].itemRef).type)) {\n                let vl = item.upLinkList[0].itemRef;\n                let docVersion = ml.Item.parseRef(vl);\n\n                app.getItemAsync(docVersion.id, docVersion.version).done(function (item) {\n                    that.addToPasteBuffer(item, item.title, vl, itemId);\n                    that.copyTemplate(items, itemIdx+1, quiet).done( function() {\n                        res.resolve();\n                    }).fail( function(error) {\n                        res.reject(error);\n                    });\n                }).fail( function(error) {\n                    res.reject(error);\n                });\n            }\n        });\n        return res;\n    }\n\n    private pasteTemplates(folderId: string) {\n        let that = this;\n\n        let currentBufferString = localStorage.getItem(this.COPY_PASTE_BUFFER);\n        let pasteBuffers = <IDHFPasteBuffer>(currentBufferString?JSON.parse(currentBufferString):{items:[]});\n        if (pasteBuffers.items.length > 1 ) {\n            ml.UI.BlockingProgress.Init([{name:\"Pasting Documents\"}]);\n        }\n        this.pasteTemplate(pasteBuffers, 0, folderId, pasteBuffers.items.length == 1);\n    }\n\n    private pasteTemplate(pasteBuffers:IDHFPasteBuffer, pasteIdx:number, folderId: string, quiet:boolean, itemSource?: IItemPut,  sourceGUID?: string, sourceProject?:string,sourceItem?:string) {\n        let that = this;\n\n        if (!quiet) {\n            ml.UI.BlockingProgress.SetProgress(0, 100 * pasteIdx / pasteBuffers.items.length);\n        }\n\n        let targetCategory = ml.Item.parseRef(folderId).type;\n\n        let sourceref=0;\n        let srfs = globalMatrix.ItemConfig.getFieldsOfType(\"sourceref\", targetCategory);\n        if (srfs.length) {\n            sourceref = srfs.length?srfs[0].field.id:0;\n        }\n        // prepare the item to be created\n        var itemJson: IItemPut = {};\n        if (itemSource) {\n            itemJson = itemSource;\n            if (sourceref) {\n                (<IGenericMap>itemJson)[sourceref] = sourceProject + \"/\" + sourceItem;\n            }\n        } else {\n            let pasteBuffer = pasteBuffers.items[pasteIdx];\n\n\n            itemJson.title = pasteBuffer.title;\n            if (sourceref) {\n                (<IGenericMap>itemJson)[sourceref] = pasteBuffer.sourceProject + \"/\" + pasteBuffer.sourceItem;\n            }\n            var fields = globalMatrix.ItemConfig.getItemConfiguration(targetCategory).fieldList;\n            $.each(fields, function (fidx, f) {\n                for (var idx = 0; idx < pasteBuffer.item.length; idx++) {\n                    if (pasteBuffer.item[idx].def.label === f.label && sourceref != f.id) {\n                        (<IGenericMap>itemJson)[f.id] = pasteBuffer.item[idx].val;\n                    }\n                }\n            });\n        }\n\n        app.createItemOfTypeAsync(targetCategory, itemJson, \"instantiated template\", folderId).done(function (result) {\n            if ( pasteBuffers.items.length > pasteIdx + 1) {\n                that.pasteTemplate(pasteBuffers, pasteIdx+1, folderId, quiet, itemSource, sourceGUID);\n            } else {\n                if (!quiet) {\n                    ml.UI.BlockingProgress.SetProgress(0, 100);\n                }\n                app.treeSelectionChangeAsync(result.item.id);\n            }\n        }).fail( function(error) {\n            if (!quiet) {\n                ml.UI.BlockingProgress.SetProgressError(0, error);\n            }\n        });\n    }\n\n    // returns first field of a given\n    private getFieldByType(fieldType: string, controls: IDHFControlDefinition[]): IBaseControl {\n        for (var idx = 0; idx < controls.length; idx++) {\n            if (controls[idx].fieldType === fieldType) {\n                return (controls[idx].control as any).getController();\n            }\n        }\n        return null;\n    }\n    /** requires sectionName or sectionType to identify field(s) */\n    private getDHFFieldValuesFromItem(sectionName: string, sectionType: string): IDHFControlDefinitionValue[] {\n        let that = this;\n        let value: IDHFControlDefinitionValue[] = [];\n\n        $.each(this.item, function (key, val) {\n            if (val && globalMatrix.ItemConfig.getFieldType(that.item.type, key) === FieldDescriptions.Field_dhf) {\n                var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                if ((sectionName && fieldVal.name.toLocaleLowerCase() === sectionName.toLocaleLowerCase()) ||\n                    (sectionType && fieldVal.type.toLocaleLowerCase() === sectionType.toLocaleLowerCase())) {\n                    value.push(fieldVal);\n                }\n            }\n        });\n        return value;\n    }\n\n    /** requires sectionName or sectionType to identify field */\n    private setDHFFieldValueOfItem(sectionName: string, sectionType: string, newValue: string) {\n        let that = this;\n\n        $.each(this.item, function (key, val) {\n            if (val && globalMatrix.ItemConfig.getFieldType(that.item.type, key) === FieldDescriptions.Field_dhf) {\n                var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                if ((sectionName && fieldVal.name.toLocaleLowerCase() === sectionName.toLocaleLowerCase()) ||\n                    (sectionType && fieldVal.type.toLocaleLowerCase() === sectionType.toLocaleLowerCase())) {\n                    fieldVal.fieldValue = newValue;\n                    let change: IItemPut = { id: that.item.id, onlyThoseFields: 1, onlyThoseLabels: 1 };\n                    (<IGenericMap>change)[<string>key] = JSON.stringify(fieldVal);\n                    app.updateItemInDBAsync(change, \"edit\").done(function () {\n                        app.renderItem();\n                    });\n                    return;\n                }\n            }\n        });\n    }\n\n    public preparePasteBuffer(tree:ISimpleTree) {\n        let pasteBuffer:IDHFPasteBuffer = { tree:tree, items:[]};\n        localStorage.setItem(this.COPY_PASTE_BUFFER, JSON.stringify(pasteBuffer));\n    }\n\n    private addToPasteBuffer(item: IItemGet, title: string, pasteSource: string, sourceItem:string) {\n        var fields = globalMatrix.ItemConfig.getItemConfiguration(item.type).fieldList;\n        var pasteBuffer: IDHFPasteBufferValue[] = [];\n        $.each(fields, function (fidx, f) {\n            pasteBuffer.push({\n                def: f,\n                val: (<IGenericMap>item)[f.id]\n            });\n        });\n\n        let currentBuffer = <IDHFPasteBuffer>JSON.parse(localStorage.getItem(this.COPY_PASTE_BUFFER));\n        currentBuffer.items.push( {\n            sourceItem: sourceItem,\n            sourceProject: matrixSession.getProject(),\n            pasteSource: pasteSource,\n            title: title,\n            item: pasteBuffer\n        });\n        localStorage.setItem(this.COPY_PASTE_BUFFER, JSON.stringify(currentBuffer));\n    }\n\n    private docHasContent(controls: IDHFControlDefinition[]) {\n\n        // check if a doc would be empty int hat case: explain and return false\n        var isEmpty = true;\n        var sectionCount = 0;\n        var noContentSections = 0;\n        $.each(controls, function (cidx, control) {\n            if (control.isDhfType && control.dhfValue) {\n                sectionCount++;\n                if (control.dhfValue.fieldValueXML && control.dhfValue.type != \"document_options\") {\n                    isEmpty = false;\n                }\n                if (control.dhfValue.type === \"terms_abbreviations\") {\n                    noContentSections++;\n                }\n            }\n        });\n\n        if (sectionCount > 0 && app.getNeedsSave()) {\n            return true;\n        }\n\n        isEmpty = isEmpty && !(sectionCount > 0 && noContentSections === sectionCount);\n        if (isEmpty) {\n\n            var message = sectionCount ? \"You need to add some content into the sections:<br><ul>\" +\n                \"<li>To edit a section's content click on the <span class='cbimg'></span> before the section name.</li>\" +\n                \"<li>To change how the content is rendered click on the <span class='fal fa-cog'></span> behind the section name.\" :\n                \"First you need to add some sections. To do this click on the <span class='fal fa-list'></span> icon behind '\" + this.getArchiveButtonName() + \"'\";\n            var dlg =\n                '<div class=\"modal fade bs-example-modal-sm\" role=\"dialog\" >' +\n                '    <div class=\"modal-dialog modal-sm\">' +\n                '        <div class=\"modal-content\">' +\n                '            <div class=\"modal-header\">' +\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>' +\n                '                <h4 class=\"modal-title\">Your document is still empty</h4>' +\n                '            </div>' +\n                '            <div class=\"modal-body\" id=\"message_ack_content\" >' + message +\n                '                <br><br>Find more info here <a href=\"https://urlshort.matrixreq.com/d23/manual/docs\" target=\"blank\">here</a>.' +\n                '            </div>' +\n                '            <div class=\"modal-footer\">' +\n                '                <button id=\"message_ack_ok\" type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Ok</button>' +\n                '            </div>' +\n                '        </div>' +\n                '    </div>' +\n                '</div>';\n            $(dlg).modal();\n\n        }\n\n        return !isEmpty;\n    }\n\n    private  dhfFactory(dhfType: string): IDHFSection {\n        if ((typeof (<IGenericMap>this.sectionFactories)[dhfType]) !== \"undefined\") {\n            let creator = (<IGenericMap>this.sectionFactories)[dhfType];\n            return creator(this.dhf_config, dhfType, this.ColumnTypes);\n        } else {\n            var isTable = false;\n            if (this.dhf_config.customTables) {\n                $.each(this.dhf_config.customTables, function (index, table) {\n                    if (dhfType === table.id) {\n                        isTable = true;\n                    }\n                });\n            }\n            if (isTable) {\n                let creator = (<IGenericMap>this.sectionFactories)[\"dhf_table\"];\n                return creator(this.dhf_config, dhfType, this.ColumnTypes);\n            }\n\n            return new Hidden();\n        }\n    }\n\n    private getNumberOfDHFSections(type: string): number {\n        var maxRows = 0;\n        var fields = globalMatrix.ItemConfig.getFieldsOfType(\"dhf\", type);\n        for (var idx = 0; idx < fields.length; idx++) {\n            maxRows++;\n        }\n        return maxRows;\n    }\n\n    private getControlFieldName(type: string): string {\n        var name = type;\n        $.each(this.getDhfControls(), function (key: string, val: ISectionInfo) {\n            if (key === type) {\n                name = val.sectionName;\n            }\n        });\n        return name;\n    }\n\n    private reorderDialog(_item: IItem) {\n        let that = this;\n\n        var item = _item;\n        var td: JQuery;\n\n        var dhfTable: IDHFReorder[] = [];\n\n        var idx = 0;\n        $.each(item, function (key, val) {\n            if (globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                if (val) {\n                    try{\n                        var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                    if (fieldVal.type !== 'document_options') {\n                        dhfTable.push({ idx: idx, id: key, name: fieldVal.name, type: that.getControlFieldName(fieldVal.type) });\n                    }\n                    idx++;}\n                    catch (error){\n                        console.log(\"Error parsing dhf field: \" + key + \" - \" + error);\n                    }\n                }\n            }\n        });\n\n        var ui = $(\"<div style='position: absolute;top: 12px;bottom: 12px;left: 12px;right: 12px;'>\");\n\n        var nst = $('<div class=\"newSectionType\" style=\"flex-grow: 1\">');\n\n        app.dlgForm.html(\"\");\n        app.dlgForm.append(ui);\n\n        app.dlgForm.removeClass(\"dlg-v-scroll\");\n        app.dlgForm.addClass(\"dlg-no-scroll\");\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Configure Document Sections\",\n            height: 600,\n            width: 650,\n            modal: true,\n            open: function () {\n\n                var enableAdd = async function () {\n                    var table = ml.JSON.fromString(await td.getController().getValueAsync());\n\n                    var count = table.status === \"ok\" ? (<ITableRow[]>ml.JSON.fromString(await td.getController().getValueAsync()).value).length : 0;\n                    var type = await nst.getController().getValueAsync();\n                    var name = nsn.val();\n                    // leave 1 spare for document config\n                    let cannotAddSection = (!type || !name || count + 1 >= that.getNumberOfDHFSections(item.type));\n                    button.prop('disabled', cannotAddSection);\n                    ml.UI.setEnabled($(\".btnSectionAdd\"), cannotAddSection);\n                };\n\n                var addRow = $(\"<div class='rowFlex' style='align-items: top; width: 100%'>\")\n\n                ui.append(addRow);\n\n\n                var nsn = $('<input  class=\"newSectionName form-control\" placeholder=\"enter section name\" style=\"flex-grow: 1; width: auto;height: 38px;\" />');\n                nsn.on('input propertychange', function () {\n                    enableAdd();\n                });\n                addRow.append(nsn);\n\n                var sorted: IDropdownOption[] = [];\n                $.each(mDHF.getDhfControls(), function (key: string, val: ISectionInfo) {\n                    if (key !== 'document_options' && !val.hidden) {\n                        sorted.push({ id: key, label: val.sectionName, class: val.sectionType.toString() });\n                    }\n                });\n                sorted.sort(function (a, b) {\n                    if (a.label < b.label) return -1;\n                    if (a.label > b.label) return 1;\n                    return 0;\n                });\n                addRow.append(nst);\n                nst.mxDropdown({\n                    controlState: ControlState.DialogCreate,\n                    canEdit: true,\n                    dummyData: false,\n                    help: '',\n                    fieldValue: \"Empty\",\n                    valueChanged: function () {\n                        enableAdd();\n                    },\n                    parameter: {\n                        placeholder: \"select section type\",\n                        create: false,\n                        options: sorted,\n                        groups: [\n                            { \"value\": DocumentSectionType.Static.toString(), \"label\": \"Static\" },\n                            { \"value\": DocumentSectionType.Database.toString(), \"label\": \"Dynamic (Database)\" },\n                            { \"value\": DocumentSectionType.Table.toString(), \"label\": \"TOCs and Indexes\" },\n                            { \"value\": DocumentSectionType.CustomTable.toString(), \"label\": \"Custom Tables\" },\n                            { \"value\": DocumentSectionType.Technical.toString(), \"label\": \"Static\" }\n                        ],\n                        maxItems: 1,\n                        sort: false,\n                        maxHeight:\"400px\"\n                    },\n                    noMarkup: true\n                });\n                $(\".selectize-input\", nst).css(\"width\", \"100%\");\n                var button = $(\"<button title class='newSectionAdd btn btn-success hidden-print' style='height: 38px;'> Add </span></button>\");\n                addRow.append(button);\n\n                td = $(\"<div style='position: absolute;top: 65px;bottom: 0;left: 0;right: 0; overflow-x:hidden;overflow-y:auto;'>\");\n                ui.append(td);\n                td.tableCtrl({\n                    help: \"Re-order or delete sections\",\n                    controlState: ControlState.DialogCreate,\n                    parameter: {\n                        canBeModified: true,\n                        columns: [\n                            { name: \"Section name\", field: \"name\", editor: ColumnEditor.none },\n                            { name: \"Section Type\", field: \"type\", editor: ColumnEditor.none }],\n                        create: false,\n                    },\n                    canEdit: true,\n                    create: false,\n                    fieldValue: JSON.stringify(dhfTable)\n                });\n                enableAdd();\n\n                button.click(async function () {\n                    var type = await nst.getController().getValueAsync();\n                    var name = nsn.val();\n                    if (name == \"insertall\") {\n                        $.each(that.getDhfControls(), function (key, val) {\n                            td.insertLine({idx: -1, id: key, type: key, name: key});\n                        });\n                        return;\n                    }\n                    var typeName = that.getControlFieldName(type);\n                    td.insertLine({idx: -1, id: type, type: typeName, name: name});\n                    nsn.val(\"\");\n                    enableAdd();\n\n\n                });\n\n            },\n            resizeStop: function () {\n                app.dlgForm.width(app.dlgForm.parent().width() - 30);\n                td.getController().resizeItem(app.dlgForm.parent().width(), true);\n            },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt btnSectionAdd',\n                click: async function () {\n                    // save old values\n                    var old: IGenericMap = {};\n                    var oidx = 0;\n                    var document_options = \"\";\n\n                    //TODO : Move this to a business logic.\n\n                    $.each(item, function (key, val) {\n                        if (globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                            old[oidx] = val;\n                            oidx++;\n                            try {\n                                var js = <{ type: string }>JSON.parse(val);\n                                if (js.type === \"document_options\") {\n                                    document_options = val;\n                                }\n                            } catch (Exception) {\n                                // nous nous\n                            }\n                        }\n                    });\n                    let newTable = <ITableRow[]>JSON.parse(await td.getController().getValueAsync());\n                    newTable = newTable.filter(function (row) {\n                        return !!row.type;\n                    }).map(function (row) {\n                        if (!row.name) {\n                            row.name = row.type;\n                        }\n                        return row;\n                    });\n\n                    var nidx = 0;\n                    $.each(item, function (key, val) {\n                        if (globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                            if (nidx < newTable.length) {\n                                var line = newTable[nidx];\n                                if (line.idx === -1) {\n                                    // get default settings / value of item\n                                    var sectionCtrl: IDHFControlDefinition = {dhfValue: {fieldValueXML: \"\"}};\n                                    var section = that.dhfFactory(line.id);\n                                    try {\n                                        sectionCtrl.dhfValue['fieldValueXML'] == (sectionCtrl);\n\n                                    } catch (Exception) {\n                                        // nous nous (this could be legacy doc section plugins)\n                                    }\n                                    // new section\n                                    var dhfField = {\n                                        type: line.id,\n                                        name: line.name,\n                                        fieldValueXML: sectionCtrl.dhfValue.fieldValueXML\n                                    };\n                                    (<IGenericMap>item)[key] = JSON.stringify(dhfField);\n                                } else {\n                                    (<IGenericMap>item)[key] = old[line.idx];\n                                }\n                            } else {\n                                // store the remembered document options (once)/clean the rest\n                                (<IGenericMap>item)[key] = document_options;\n                                document_options = \"\";\n                            }\n                            nidx++;\n                        }\n                    });\n\n                    let update: IItemPut = {onlyThoseFields: 1, onlyThoseLabels: 1};\n                    $.each(item, function (key, val) {\n                        if (key === \"type\" || key === \"title\" || key === \"id\" || globalMatrix.ItemConfig.getFieldType(item.type, key)) {\n                            (<IGenericMap>update)[key] = val;\n                        }\n                    });\n\n\n                    // compare old with new\n                    let changed = false;\n                    let newIdx = 0;\n\n                    $.each(update, function (key, val) {\n                        if (globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                            if ((old[newIdx] || val) && old[newIdx] != val) {\n                                changed = true;\n                            }\n                            newIdx++;\n                        }\n                    });\n\n\n                    if (changed) {\n                        app.updateItemInDBAsync(update, \"edit\").done(function (result) {\n                            app.renderItem(result);\n                            app.dlgForm.dialog(\"close\");\n                        }).fail(function (error) {\n                            ml.UI.showError(\"Failed to save changes!\", error);\n                        });\n                    }\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        });\n    }\n\n    // check if SIGN or DOC has a file attachment control and file attachments\n    private hasFileAttachments(type: string, controls: IControlDefinition[], item: IItem): boolean {\n        var hfa = false;\n        $.each(controls, function (ci, c) {\n            if (globalMatrix.ItemConfig.getFieldType(type, c.fieldId) === FieldDescriptions.Field_fileManager) {\n                var iv = (<IGenericMap>item)[c.fieldId];\n                if (iv && (<any[]>JSON.parse(iv)).length > 0) {\n                    hfa = true;\n                }\n            }\n        });\n        return hfa;\n    }\n\n    private hideFileOption(category: string, format: string) {\n        let hide = false;\n        if (this.dhf_config && this.dhf_config.hideFileFormats) {\n            $.each(this.dhf_config.hideFileFormats, function (hfoidx, hfo) {\n                if (hfo.category === category && hfo.format === format) {\n                    hide = true;\n                }\n            });\n        }\n        return hide;\n    }\n\n    private renderControlsSIGN(options: IItemControlOptions, body: JQuery, controls: IDHFControlDefinition[]) {\n        if (options.isItem) {\n            if (options.controlState !== ControlState.Print && options.controlState !== ControlState.Tooltip) {\n                let container = $(\"<div class='controlContainer'>\").appendTo(body);\n                $(\"<div style='padding: 12px 0' class='baseControlHelp'>Manage Documents</div>\").appendTo(container);\n                let rt = $(\"<div class='baseControl rowFlex'>\").appendTo(container);\n                this.showPreviewSign( rt, options);\n                this.renderSignDownload(options, rt, controls);\n            }\n        } else {\n            if (options.controlState === ControlState.FormEdit) {\n                body.append($(\"<span class='baseControlHelp'>Tools</span>\"));\n                var folderEdit = $(\"<div class='hidden-print baseControl'></div>\");\n                body.append(folderEdit);\n                var createTools = new ItemCreationTools();\n                createTools.renderButtons({\n                    parent: options.item.id,\n                    control: folderEdit,\n                    linkTypes: [\n                        { type: options.item.type, name: \"Folder\", buttonName: \"Create\", folder: true }],\n                    type:options.type,\n                    dontOpenNewItem:false\n                });\n            }\n        }\n    }\n\n    private getFilterCtrl(type: string, allControls: IControlDefinition[]) {\n        for (var idx = 0; idx < allControls.length; idx++) {\n            if (globalMatrix.ItemConfig.getFieldType(type, allControls[idx].fieldId) === FieldDescriptions.Field_docFilter) {\n                return allControls[idx].control;\n            }\n        }\n        return null;\n    }\n    private async getFilterValue(filterControl: JQuery) {\n        if (filterControl) {\n            var v = ml.JSON.fromString(await filterControl.getController().getValueAsync());\n            if (v.status === \"ok\") {\n                var list = (<string[]>v.value).join(\",\");\n                return list;\n            }\n        }\n        return null;\n    }\n\n    private showPreviewDoc( anchor:JQuery, id:string, controls: IDHFControlDefinition[]) {\n        let that = this;\n        if (globalMatrix.ItemConfig.getTimeWarp()) { return; }\n        // handle ACL\n        if (!globalMatrix.ItemConfig.canReport(\"DOC\")) { return; }\n\n        $(\"<button class='btn btn-success'> Preview </button>\").appendTo( anchor).click( async () => {\n            let frame = $(`<div class=\"inlineViewer\">`).appendTo(\"body\");\n            let spinning = ml.UI.getSpinningWait(\"loading document: <span class='dprogress'></span> done\").appendTo(frame);\n            $(`<div class='message_close_big'><i class='fal fa-window-close'></i></div>`).appendTo(frame).click(function () {\n                frame.remove();\n            });\n\n            let params: IReportOptions = {format: \"pdf\", inline: true};\n            let labelFilter = await that.getFilterValue(<any>that.getFilterCtrl(\"DOC\", controls));\n            if (labelFilter) {\n                params.filter = labelFilter;\n            }\n\n            ml.ReportGenerator.SaveAndCreate(id, params, \"viewing pdf\", (lastCreatedObject: any, path: string) => {\n                spinning.remove();\n                frame.append(`<embed src=\"${path + \"?disposition=inline\"}\" width=\"100%\" height=\"100%\">`);\n            }, (error: string) => {\n                spinning.remove();\n                frame.append(`document creation failed with error: ${error}`);\n            }, (progress: number) => {\n                $(\".dprogress\", spinning).html(progress + \"%\");\n            });\n\n        });\n    }\n\n    private showPreviewSign( anchor:JQuery, options:IItemControlOptions) {\n        let that = this;\n        if (globalMatrix.ItemConfig.getTimeWarp()) { return; }\n\n        if (!globalMatrix.ItemConfig.canReport(\"SIGN\")) { return; }\n\n        $(\"<button class='btn btn-success  inlineView' title='View'>Preview</button>\").appendTo( anchor).click( () => {\n            let frame = $(`<div class=\"inlineViewer\">`).appendTo(\"body\");\n            let spinning = ml.UI.getSpinningWait(\"loading document: <span class='dprogress'></span> done\").appendTo(frame);\n            $(`<div class='message_close_big'><i class='fal fa-window-close'></i></div>`).appendTo(frame).click(function () {\n                frame.remove();\n            });\n\n            let params:IReportOptions = {format:\"pdf\", inline:true};\n            let signCache = that.getCached( options );\n\n            if (signCache[\"pdf\"]) {\n                // signCache[\"pdf\"] is a file attachment url like \"5745?key\\u003dkey_2d6a3cju4dr5qnm9ogvstfqkn2\"\n\n                let clean = signCache[\"pdf\"].replace(\"\\u003d\",\"=\");\n\n                let path = globalMatrix.matrixRestUrl + \"/\" + matrixSession.getProject() + \"/file/\" + clean + \"&disposition=inline\";\n\n                spinning.remove();\n                frame.append( `<embed src=\"${path}\" width=\"100%\" height=\"100%\">`);\n            } else {\n                if (app.getNeedsSave()) {\n                    ml.UI.showError(\"Save Item\", \"Please save before downloading the signed item.\");\n                    frame.remove();\n                    return;\n                }\n                ml.ReportGenerator.SaveAndCreate(options.id, params, \"viewing pdf\",  (lastCreatedObject:any, path:string) => {\n                    spinning.remove();\n                    frame.append( `<embed src=\"${path}?disposition=inline\" width=\"100%\" height=\"100%\">`);\n                }, (error:string) => {\n                    spinning.remove();\n                    frame.append( `document creation failed with error: ${error}`);\n                }, (progress:number) => {\n                    $(\".dprogress\", spinning).html( progress+\"%\" );\n                });\n            }\n\n        });\n    }\n\n\n    private renderControlsDOC(options: IItemControlOptions, body: JQuery, controls: IDHFControlDefinition[]) {\n        let that = this;\n\n        let category = options.type; // default type for creation\n\n        if (options.item && options.item.type) {\n            category = options.item.type;\n        }\n\n        var id = options.item ? options.item.id : \"\";\n\n        var config = globalMatrix.ItemConfig.getItemConfiguration(options.isItem ? category : \"FOLDER\");\n\n        var showTools = true;\n        if (options.controlState === ControlState.Print || options.controlState === ControlState.Tooltip ||\n            options.controlState === ControlState.DialogCreate || options.controlState === ControlState.HistoryView) {\n            showTools = false;\n        }\n\n        var signedDocuments: JQuery; // in case of signed report this is a list of instances (SIGN) created\n\n        // main logic to create UI\n        if (options.isItem) {\n            if (options.controlState === ControlState.DialogCreate) {\n                if (this.dhf_config.categories.documentForms.indexOf(category) !== -1) {\n                    // start wizard to create new controlled doc\n                    RenderDocDefinitionWizard(body, controls);\n                }\n            } else if (showTools) {\n                let container = $(\"<div class='controlContainer'>\").appendTo(body);\n                // show tools to preview and generate signed doc\n                $(\"<div style='padding: 12px 0;' class='baseControlHelp'>Manage Documents</div>\").appendTo(container);\n\n                let rt = $(\"<div style='margin-bottom:12px' class='baseControl rowFlex'>\").appendTo(container)\n\n                that.showPreviewDoc( rt, options.id, controls);\n\n                if (globalMatrix.ItemConfig.canReport(options.type)) {\n                    rt.append(createPreviewReportButton(category, controls, options.item));\n\n                    rt.append(createExcelButton(category, controls, options.item));\n\n                    this.createCompareButton(rt, options, controls);\n\n                    if (matrixSession.isEditor()) {\n                        // can create signed doc\n                        var dhfConfigTool = createSignatureButton(category, controls, this.getArchiveButtonName());\n                        rt.append(dhfConfigTool);\n\n\n                        if (app.canEditItem(options.item) && !options.locked) {\n                            var x = $(\"<div class='btn-group'>\");\n                            rt.append(x);\n\n                            this.appendConfigTool(x, config, options.item);\n                        }\n                    }\n                } else {\n                    rt.append(\"<div class='inlineHelp'>You have no rights to download documents</div>\");\n                }\n\n                var linkTypes: ILinkCategories[] = [];\n                $.each(this.dhf_config.categories.documentSigned, function (idx, cat) {\n                    linkTypes.push({ type: cat });\n                })\n                // show previously created signed docs\n                signedDocuments = $(\"<div class='controlContainer' >\").linkCollection({\n                    // TODO(modules): I added item to the definition -- error?\n                    item: options.item,\n                    parameter: {\n                        \"linkTypes\": linkTypes,\n                        \"readonly\": true,\n                        \"none\": \"no signed documents have been created so far\"\n                    },\n                    fieldValue: options.item.downLinks,\n                    help: \"Previously created signed documents\"\n                });\n                body.append(signedDocuments);\n\n            }\n\n        } else if (options.controlState === ControlState.FormEdit) {\n            body.append($(\"<span class='baseControlHelp'>Tools</span>\"));\n            var folderEdit = $(\"<div class='hidden-print baseControl'></div>\");\n            body.append(folderEdit);\n            var createTools = new ItemCreationTools();\n            var createButtons: ILinkType[] = [\n                { type: options.item.type, name: \"Folder\", folder: true },\n                { type: options.item.type, name: \"DOCX\", import:true, buttonName:\"Import\" },\n                { type: options.item.type, name: globalMatrix.ItemConfig.getCategoryLabel(category), }\n            ];\n\n            createTools.renderButtons({\n                parent: options.item.id,\n                control: folderEdit,\n                linkTypes: createButtons,\n                dontOpenNewItem:false\n            });\n\n            let templateProjects = <ITemplateProjects>matrixSession.getCustomerSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING_Projects);\n            if (templateProjects && templateProjects.projects && templateProjects.projects.length) {\n                let accessibleProjects = matrixSession.getProjectList(true).map(function (ap) { return ap.shortLabel; });\n                let templateSources = templateProjects.projects.filter( function(p) { return accessibleProjects.indexOf(p) != -1});\n                let templateErrors = templateProjects.projects.filter( function(p) { return accessibleProjects.indexOf(p) == -1});\n\n                appendTemplates( folderEdit, templateSources, 0, [], templateErrors);\n            }\n\n        }\n\n        function appendTemplates(folderEdit:JQuery, projects:string[], next:number, templateOptions:IDropDownButtonOption[], errors:string[]) {\n            if ( next >= projects.length) {\n                if (templateOptions.length) {\n                    let ddb =  ml.UI.createDropDownButton(\"Create from <b>Template</b>\", templateOptions, false, \"createByTemplateId\", true);\n                    folderEdit.append( ddb );\n                    ddb.addClass(\"ddAlignBottom\");\n                }\n                if (errors.length) {\n                    folderEdit.append( $(\"<div style='padding: 12px 0;font-style: italic;'>\").html(\"There are also templates in some projects where you have no read access: \" + errors.join() ))\n                }\n                return;\n            }\n\n            app.readSettingJSONAsync(MarkAsTemplateImpl.PROJECT_SETTING, projects[next], true).done(function (templates: IPasteSourceSetting) {\n                if (templates && templates.templates) {\n                    // find templates for this project\n\n                    $.each(templates.templates, function (idx, ps) {\n                        if (ps.canUseIn.indexOf(matrixSession.getProject()) != -1) {\n                            templateOptions.push({\n                                name:ps.fromProject + \"/\" + ps.fromSign + \" \" + ps.fromName,\n                                click: function () { that.createFromTemplate(ps.fromProject, ps.fromSign, ps.fromName, <any>{ parent: app.getCurrentItemId() }); }\n                            });\n                        }\n                    });\n                }\n                appendTemplates(folderEdit, projects, next+1, templateOptions, errors);\n            }).fail( function() {\n                ml.UI.hideError();\n                errors.push(projects[next]);\n                appendTemplates(folderEdit, projects, next+1, templateOptions, errors);\n            });\n\n        }\n\n\n        function addFileOption(type: string, controls: IDHFControlDefinition[], formats: IDHFFileOption[], name: string, format: string) {\n\n            var pos = (mDHF.getDefaultFormat(type) === format) ? 0 : formats.length;\n            formats.splice(pos, 0, {\n                name: name, click: function () {\n                    that.createConfirmedDownloadOrSIGN( controls, async function () {\n                        ml.ReportGenerator.CreateDoc(id, {format: format}, await that.getFilterValue(<any>that.getFilterCtrl(type, controls)));\n                    });\n                    return false;\n                }\n            });\n\n        }\n\n        function createPreviewReportButton(type: string, controls: IDHFControlDefinition[], item: IItem) {\n\n            var formats: IDHFFileOption[] = [];\n\n            if (!that.hideFileOption(type, \"docx\")) {\n                addFileOption(type, controls, formats, \"Word\", \"docx\");\n                if (that.hasFileAttachments(type, controls, item)) {\n                    addFileOption(type, controls, formats, \"Word with attachments\", \"zipdocx\");\n                }\n            }\n\n            if (!that.hideFileOption(type, \"pdf\")) {\n                addFileOption(type, controls, formats, \"PDF\", \"pdf\");\n                if (that.hasFileAttachments(type, controls, item)) {\n                    addFileOption(type, controls, formats, \"PDF with attachments\", \"zippdf\");\n                }\n            }\n\n            if (!that.hideFileOption(type, \"html\")) {\n\n                addFileOption(type, controls, formats, \"HTML\", \"html\");\n            }\n\n            if (that.hasPackage(controls, item)) {\n                addFileOption(type, controls, formats, \"Package\", \"package\");\n            }\n\n            return ml.UI.createDropDownButton(\"Download document\", formats, false, \"btnDownload\");\n        }\n\n        function createExcelButton(type: string, controls: IDHFControlDefinition[], item: IItem): JQuery {\n            if (!that.hideFileOption(type, \"xlsx\")) {\n                if (PluginManagerDocuments.hasCustomSection(item)) {\n                    return PluginManagerDocuments.excelButtonControl(() => {\n                            that.createConfirmedDownloadOrSIGN(controls, async function () {\n                                ml.ReportGenerator.CreateDoc(\n                                    id,\n                                    {format: \"xlsx\"},\n                                    await that.getFilterValue(<any>that.getFilterCtrl(type, controls)),\n                                );\n                            });\n                            return false;\n                        });\n                }\n            }\n        }\n\n        function createSignatureButton(type: string, controls: IDHFControlDefinition[], btnName: string) {\n            var filterControl = that.getFilterCtrl(type, controls);\n\n            var formats = [{\n                name: \"SIGN\",\n                click: function() {\n                    that.createSIGN(id, signedDocuments, (filterControl as JQuery), controls);\n\n                },\n            }];\n\n            return ml.UI.createDropDownButton(btnName, formats, false, \"archiveBtnId\");\n        }\n\n        function RenderDocDefinitionWizard(body: JQuery, controls: IDHFControlDefinition[]) {\n            var dlgInner = body.parent();\n            var dlgOuter = dlgInner.parent();\n            var createButton: JQuery;\n            var nextButton = $('<button type=\"button\" class=\"btnDoIt2 ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only btn\" role=\"button\" aria-disabled=\"false\">');\n\n            // hide all controls\n            for (var idx = 0; idx < controls.length; idx++) {\n                (controls[idx].control as any).hide();\n            }\n\n            window.setTimeout(function () {\n                var niceSize = ml.UI.getNiceDialogSize(730, 550);\n                dlgOuter.dialog(\"option\", \"height\", niceSize.height);\n                dlgOuter.dialog(\"option\", \"width\", niceSize.width);\n                $(\".dlgCreateMultiple\", dlgOuter.parent()).hide();\n                nextButton.append('<span class=\"ui-button-text\">Next</span>');\n                createButton = $(\".ui-dialog-buttonpane button:contains('Create')\", app.dlgForm.parent());\n                createButton.hide();\n                createButton.after(nextButton);\n            }, 1);\n\n            function updateControls(wizardData: IDHFWizardData) {\n                //TODO : Move this to business logic.\n                var dhfItemIdx = 0;\n                for (var idx = 0; idx < controls.length; idx++) {\n                    if (globalMatrix.ItemConfig.getFieldType(category, controls[idx].fieldId) === FieldDescriptions.Field_dhf) {\n                        // this has been configured before...\n                        if (dhfItemIdx < wizardData.dhfItems.length) {\n                            (controls[idx].control as any).getController().setValue(JSON.stringify(wizardData.dhfItems[dhfItemIdx]));\n                            dhfItemIdx++;\n                        } else if (dhfItemIdx === wizardData.dhfItems.length) {\n                            var dhfField = { type: \"document_options\", name: \"Document Options\", fieldValue: \"\", ctrlConfig: { auto_number: true, omit_title: true } };\n                            (controls[idx].control as any).getController().setValue(JSON.stringify(dhfField));\n\n                            dhfItemIdx++;\n                        }\n                    } else if (controls[idx].name === DOC_NUM_NAME) {\n                        (controls[idx].control as any).getController().setValue(wizardData.dhfNumber);\n                    } else if (controls[idx].fieldType === FieldDescriptions.Field_guid) {\n                        (controls[idx].control as any).getController().setValue(wizardData.dhfGUID);\n                    } else if (controls[idx].name === \"Title\") {\n                        (controls[idx].control as any).getController().setValue(wizardData.dhfName, true);\n                    } else if (controls[idx].name === \"reportId\") {\n                        (controls[idx].control as any).getController().setValue(\"dhf_generic\");\n                    }\n                }\n                createButton.trigger(\"click\");\n            }\n\n            that.showDHFCreateWizard(category, dlgInner, nextButton, updateControls, false);\n        }\n\n    }\n\n    private static hasCustomSection(item:IItem) : boolean {\n        for (const keyString in item) {\n            const key = parseInt(keyString);\n            if (isNaN(key)) {\n                // skip, something's wrong with the key\n            } else {\n                const value = item[key];\n                if (typeof value === \"string\") {\n                    try {\n                        const section = JSON.parse(value);\n                        if (section != null && section.type === \"CustomSection\") {\n                            return true;\n                        }\n                    } catch (e) {\n                        // Not JSON, next...\n                    }\n                }\n            }\n        }\n        return false;\n    }\n\n\n\n    private createSIGN( id:string, signedDocuments:JQuery, filterControl:JQuery, controls:IDHFControlDefinition[] ) {\n        let that = this;\n\n        function fill0(sn: number, len: number) {\n            let sns = sn.toString();\n            while (sns.length < len) {\n                sns = \"0\" + sns;\n            }\n\n            return sns;\n        }\n\n        function last2(x: string) {\n            return x.substr(x.length - 2);\n        }\n\n        let versionFromTable = \"\";\n        async function createSignDoc(signatures: string[]) {\n            var transfer: IReportTransferField[] = [];\n\n            // build name of signed doc\n            let hasTitle = false;\n            let hasHideTitle = false;\n            var signName = \"\";\n            var signDocNumber = \"\";\n            // if document has a DOC NUMBER field, create the title of the SIGN\n            var dnid = globalMatrix.ItemConfig.getFieldId(that.item.type, DOC_NUM_NAME);\n            if ((<IGenericMap>that.item)[dnid] && (<IGenericMap>that.item)[dnid] !== \"no id\") {\n                let docNumber = <string>(<IGenericMap>that.item)[dnid];\n                let sn = parseInt(that.item.id.split(\"-\")[1]);\n\n                hasTitle = docNumber.indexOf(\"_title_\") !== -1;\n                hasHideTitle = docNumber.indexOf(\"_notitle_\") !== -1;\n\n                signDocNumber = docNumber\n                    .replace(\"_notitle_\", \"\") // just a dummy placeholder to ignore the DOC's title\n                    .replace(\"_id_\", that.item.id)\n                    .replace(\"_revision_\", versionFromTable)\n                    .replace(\"_serial_\", fill0(sn, 3))  // serial XX -> 0XX\n                    .replace(\"_serial1_\", fill0(sn, 1))// serial XX -> XX\n                    .replace(\"_serial2_\", fill0(sn, 2)) // serial XX -> XX\n                    .replace(\"_serial3_\", fill0(sn, 3)) // serial XX -> 0XX\n                    .replace(\"_serial4_\", fill0(sn, 4)) // serial XX -> 00XX\n                    .replace(\"_project_\", matrixSession.getProject())\n                    .replace(\"_title_\", that.item.title)\n                    .replace(\"_YYYY_\", new Date().getFullYear().toString())\n                    .replace(\"_YY_\", last2(\"00\" + (new Date().getFullYear() - 2000).toString()))\n                    .replace(\"_MM_\", last2(\"00\" + (new Date().getMonth() + 1).toString()))\n                    .replace(\"_DD_\", last2(\"00\" + (new Date().getDate()).toString()))\n                    .replace(\"_YYYYMMDD_\",\n                        new Date().getFullYear().toString() +\n                        last2(\"00\" + (new Date().getMonth() + 1).toString()) + last2(\"00\" + (new Date().getDate()).toString()))\n\n\n                signName = signDocNumber;\n            }\n            // add / use item title to SIGN item name\n            if (!hasTitle && !hasHideTitle) {\n                signName = signName ? (signName + \" \" + that.item.title) : that.item.title;\n            }\n\n            // find values which need to be transferred (they need to have same label and copyfromdoc set to true\n            var signConfig = globalMatrix.ItemConfig.getItemConfiguration(that.dhf_config.categories.signAs);\n            var docConfig = globalMatrix.ItemConfig.getItemConfiguration(that.item.type);\n            $.each(signConfig.fieldList, function (configIdx, config) {\n                if (config.parameterJson && config.parameterJson.copyfromdoc) {\n                    var toId = config.id;\n                    $.each(docConfig.fieldList, function (docIdx, docConfig) {\n                        if (docConfig.label.toLowerCase() === config.label.toLowerCase()) {\n                            var fromId = docConfig.id;\n                            transfer.push({fromId: fromId.toString(), toId: toId.toString()});\n\n                        }\n                    });\n                }\n            });\n\n\n            ml.ReportGenerator.CreateSignedDoc(\n                id, signatures, signedDocuments,\n                await that.getFilterValue(filterControl), signName, transfer,\n                [], function (signID) {\n                    var signatureInfo = that.getSignatureInfo();\n                }\n            )\n\n        }\n\n        let revisionTableControl:IDHFControlDefinition = null;\n        let revisionTableColumn:string = null;\n        for (let control of controls) {\n            if (control.dhfValue && control.dhfValue && control.dhfValue.ctrlConfig && (<IDhfTableOptions>control.dhfValue.ctrlConfig).columns) {\n                for (let column of  (<IDhfTableOptions>control.dhfValue.ctrlConfig).columns) {\n                    if (column.columnType == \"type12\") {\n                        revisionTableControl = control;\n                        revisionTableColumn = column.field;\n                    }\n                }\n            }\n        }\n\n        if (revisionTableControl) {\n            that.verifyVersionInfo(id, revisionTableControl, revisionTableColumn).done( (version:string) => {\n                versionFromTable = version;\n\n                that.verifyVersionTableComplete(revisionTableControl).done( () => {\n                            that.createConfirmedDownloadOrSIGN(controls, createSignDoc);\n                });\n            });\n        } else {\n            that.createConfirmedDownloadOrSIGN(controls, createSignDoc);\n        }\n    }\n\n    // make sure all values are set\n    private verifyVersionTableComplete(revisionTableControl:IDHFControlDefinition) {\n        let that = this;\n        let res = $.Deferred();\n        let table = <IStringMap[]>(revisionTableControl.dhfValue.fieldValue?JSON.parse(revisionTableControl.dhfValue.fieldValue):null);\n        if (!table || !table.length) {\n            ml.UI.showConfirm( -1, { title:`The table '${revisionTableControl.dhfValue.name}' with the revision field is empty!`,ok:\"Create SIGN\", nok:\"Cancel\"}, () => { res.resolve(\"\");}, () => {res.reject();});\n            return res;\n        } else {\n            let lastRow = table[table.length-1];\n            for (let column of  (<IDhfTableOptions>revisionTableControl.dhfValue.ctrlConfig).columns) {\n                if (!lastRow[column.field]) {\n                    ml.UI.showConfirm( -1, { title:`The field '${column.name}' in table '${revisionTableControl.dhfValue.name}' is empty!`,ok:\"Create SIGN\", nok:\"Cancel\"}, () => { res.resolve(\"\");}, () => {res.reject();});\n                    return res;\n                }\n            }\n        }\n        // no problem!\n        res.resolve();\n        return res;\n    }\n\n    // compares the current Revision from the table with the one from the SIGN with the highest id\n    private verifyVersionInfo(docId:string, revisionTableControl:IDHFControlDefinition, revisionTableColumn:string) {\n        let that = this;\n        let res = $.Deferred();\n        let currentRevision =  revisionTableControl.dhfValue?this.getVersionFromTable(revisionTableControl.dhfValue.fieldValue, revisionTableColumn):\"\";\n        let revisionTable = revisionTableControl.dhfValue?revisionTableControl.dhfValue.name:\"\";\n        if (!currentRevision) {\n            ml.UI.showConfirm( -1, { title:`There is no revision defined in table '${revisionTable}'!`,ok:\"Create SIGN\", nok:\"Cancel\"}, () => { res.resolve(\"\");}, () => {res.reject();});\n        } else {\n            this.getOtherSigns( \"\", docId).done( ( otherSIGNs:string[] ) => {\n                if (!otherSIGNs.length) {\n                    // first sign... to be created so all is good\n                    res.resolve(currentRevision);\n                } else {\n                    let highest = ml.Item.parseRef(otherSIGNs[0]).number;\n                    for ( let next of otherSIGNs ) {\n                        highest = Math.max(ml.Item.parseRef(next).number,highest);\n                    }\n                    let highestSIGNId = ml.Item.parseRef(otherSIGNs[0]).type + \"-\" + highest;\n                    app.getItemAsync(highestSIGNId).done(function (signItem) {\n\n                        // get the date the sign was created\n                        let signCreationDate = new Date( signItem.history[signItem.history.length-1].date );\n\n                        // go through history of DOC and find the version which existed just before creating the SIGN\n                        let docRevisionBeforeSign =  that.item.history.length-1;\n                        while( docRevisionBeforeSign>=0 && new Date(that.item.history[docRevisionBeforeSign].date)<=signCreationDate) {\n                            docRevisionBeforeSign--;\n                        }\n\n                        docRevisionBeforeSign =  that.item.history[docRevisionBeforeSign+1].version\n\n                        app.getItemAsync(docId, docRevisionBeforeSign).done(function (docBeforeSign) {\n\n                            // now we have the old doc. The revision table might anywhere in one of the properties\n                            let previousRevision = \"\";\n                            for (let prop in docBeforeSign) {\n                                let valStr = docBeforeSign[prop];\n                                if (valStr && valStr.length > 2 && valStr[0] == \"{\") {\n                                    try {\n                                        let valJson = JSON.parse(valStr); // this might be a table\n                                        if ( valJson.ctrlConfig && valJson.ctrlConfig.columns && valJson.ctrlConfig.columns.length) { // pretty sure this is a table\n                                            let revisionColumns = valJson.ctrlConfig.columns.filter( column => column.columnType == \"type12\");\n                                            if (revisionColumns.length > 0) { // this is a table with a revision column! we take this\n\n                                                let valFieldStr = valJson.fieldValue; // check if there is a value stored in the table\n                                                if (valFieldStr && valFieldStr.length > 2 && valFieldStr[0] == \"[\") {\n\n                                                    previousRevision =  that.getVersionFromTable(valFieldStr, revisionColumns[0].field);\n\n                                                }\n\n                                            }\n                                        }\n                                    } catch(e){\n\n                                    }\n                                }\n                            }\n\n\n                            if ( currentRevision != previousRevision ) {\n                                // we assume all is good...\n                                res.resolve( currentRevision );\n                                return res;\n                            } else {\n                                ml.UI.showConfirm( -1, { title:`The current revision in table '${revisionTable}' is the same as it was in the last created SIGN!`,ok:\"Create SIGN\", nok:\"Cancel\"}, () => {\n                                    res.resolve(currentRevision);\n                                    return res;\n                                }, () => {\n                                    res.reject();\n                                    return res;\n                                });\n                            }\n\n                        }).fail( function(error) {\n                            res.reject(error);\n                        });\n                    });\n\n                }\n            });\n        }\n        return res;\n    }\n\n    private getVersionFromTable( table:string, column:string) {\n        if (!table) return \"\";\n\n        let currentTable = <IStringMap[]>JSON.parse(table);\n        if(currentTable.length) {\n            let lastRow = currentTable[currentTable.length-1]\n            return lastRow[column];\n        }\n\n        return \"\";\n    }\n\n    private hasPackage( controls: IDHFControlDefinition[], item: any) {\n        for(var idx=0; idx<controls.length; idx++) {\n            if (controls[idx].fieldId && item[controls[idx].fieldId] && globalMatrix.ItemConfig.getFieldType(item.type, controls[idx].fieldId) === \"dhf\") {\n                // this is a configured dhf field\n                let parsed = ml.JSON.fromString( item[controls[idx].fieldId] );\n                if (parsed.status == \"ok\") {\n                    if ((<IDHFControlDefinitionValue>parsed.value).type == \"package\") {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n\n    private createConfirmedDownloadOrSIGN( controls: IDHFControlDefinition[], createFct:Function ) {\n        let that = this;\n\n        if (!that.docHasContent(controls)) {\n            return;\n        }\n\n        // check if the document contains smart text and the user needs to verify that it's correct\n        var config = globalMatrix.ItemConfig.getSmartText();\n        if (!config || !config.replacements) {\n            config = { \"replacements\": [] };\n        }\n        var table = $(\"<table class='table table-bordered text-left'>\");\n        $.each(config.replacements, function (optIdx, opt) {\n            if (opt.warn) {\n                var tr = $(\"<tr>\");\n                tr.append($(\"<td>\").html(opt.what));\n                tr.append($(\"<td>\").html(opt.with));\n                table.append(tr);\n            }\n        });\n        let dateNow = (new Date()).toDateString();\n\n        let allSignatures = that.getSignatures(controls);\n        let signatures = allSignatures.filter( function(user){\n            return user && (globalMatrix.ItemConfig.getUserIds().indexOf(user) != -1);\n        });\n        let msgs:string[] = [];\n        if (signatures.length != allSignatures.length) {\n            msgs.push(\"There are missing users or users without access in a signature table!\");\n        }\n        if ($(\".refreshNeeded:visible\").length!=0) {\n            msgs.push(\"Some item selections based on search expressions have not been updated!\");\n        }\n        if ($(\"tr\", table).length > 0 && (that.wasInformedToday !== dateNow || that.wasInformedTodayAbout !== table.html())) {\n            msgs.push( \"Verify whether the following smart text blocks are correct<br/>\" + $('<div>').append(table.clone()).html());\n        }\n        if (msgs.length!=0) {\n            ml.UI.showConfirm(6, { title: msgs.join(\"<br><br>\"), ok: \"Yes, continue\" }, function () {\n                // remember that user was informed about something today\n                that.wasInformedToday = dateNow;\n                that.wasInformedTodayAbout = table.html();\n                createFct(signatures);\n            }, function () {\n            });\n        } else {\n            createFct(signatures);\n        }\n\n    }\n\n    // return number of required signatures (in SIGN docs) and number of given signatures\n    private getSignatureInfo(item?: IItem):ISignaturesInfo {\n        if (!item) {\n            item = this.item;\n        }\n\n       return DocBaseImpl.readSignatureInfo(item);\n    }\n\n    private getCached( options: IItemControlOptions) {\n        let signCache:IStringMap = {};\n        let signCacheFields = globalMatrix.ItemConfig.getFieldsOfType(\"signCache\", options.type);\n        if (signCacheFields.length==1) {\n            let signCacheField = (<IStringMap>options.item)[signCacheFields[0].field.id];\n            if (signCacheField) {\n                let cached = <IUploadedFileInfo[]> JSON.parse(signCacheField);\n                $.each( cached, function( idx, cache) {\n                    let key = <any>cache.fileName.split('.').pop().toLowerCase();\n                    signCache[ key ] = cache.fileId;\n                });\n            }\n        }\n        return signCache;\n    }\n\n    private renderSignDownload(options: IItemControlOptions, body: JQuery, controls: IDHFControlDefinition[]) {\n        let that = this;\n\n        // if there's a control to cache signs, get it (note at this time it's not yet rendered, so no need to read it's content)\n        let signCache:IStringMap = this.getCached( options );\n\n        // the sign cache is now a lookup per extensions, e.g. signCache[\"pdf\"] = \"5745?key\\u003dkey_2d6a3cju4dr5qnm9ogvstfqkn2\";\n\n        if (options.controlState === ControlState.Print || options.controlState === ControlState.HistoryView || options.controlState === ControlState.Tooltip) {\n            return;\n        }\n        var defaultFormat = mDHF.getDefaultFormat(options.type);\n        var formats: IDHFFileOption[] = [];\n\n        function addOption(format: string, name: string, signCache:IStringMap) {\n\n            var pos = (defaultFormat === format) ? 0 : formats.length;\n            formats.splice(pos, 0, {\n                name: name,\n                click: function () {\n                    if (signCache[format]) {\n                        startDownloadCached(signCache[format]);\n                    } else {\n                        // create and download the file\n                        startDownload(format);\n                    }\n                }\n            });\n        }\n\n        if (!that.hideFileOption(options.type, \"docx\")) {\n            addOption(\"docx\", \"Word\",signCache);\n            if (this.hasFileAttachments(options.type, controls, options.item)) {\n                addOption(\"zipdocx\", \"Word with attachments\", {});\n            }\n        }\n\n        if (!that.hideFileOption(options.type, \"pdf\")) {\n            addOption(\"pdf\", \"PDF\", signCache);\n            if (this.hasFileAttachments(options.type, controls, options.item)) {\n                addOption(\"zippdf\", \"PDF with attachments\", {});\n            }\n        }\n        if (!that.hideFileOption(options.type, \"html\")) {\n            addOption(\"html\", \"HTML\",signCache);\n        }\n        if( options.item.docHasPackage) {\n            addOption(\"package\", \"Package\", {});\n        }\n\n        var signatureInfo = this.getSignatureInfo();\n\n        // default buttons\n        if (signatureInfo.missingSignatures) {\n            var request = $(\"<button class='btn btn-default' style='margin-right:5px !important'>Request Signatures</button>\");\n            body.append(request);\n            request.click(function () {\n                var message = ml.Mail.getCannedMessage(\"please_sign\", \"\", options.item.id);\n                ml.Mail.sendMailDlg(signatureInfo.missing.join(\",\"), null, \"Please review and sign \" + options.item.id, message,\"\");\n            });\n        } else {\n\n            let markAsTemplates = globalMatrix.ItemConfig.getFieldsOfType(\"markAsTemplate\", this.item.type);\n\n            let can = \"release_note\";\n            let subject = \"A document has been released \";\n            let button = \"Send Release Mail\";\n            let users = globalMatrix.ItemConfig.getUserIds();\n\n            if (markAsTemplates.length==1 && MarkAsTemplateImpl.getRequiredApprovals((<any>this.item)[markAsTemplates[0].field.id]).length > 0) {\n                can = \"approve_note\";\n                subject = \"Approval for template \";\n                button = \"Ask for approval \";\n                users = MarkAsTemplateImpl.getRequiredApprovals((<any>this.item)[markAsTemplates[0].field.id]);\n            }\n            // normal document which has been approved and completely signed\n            var request = $(\"<button class='btn btn-default' style='margin-right:5px !important'>\"+button+\"</button>\");\n            body.append(request);\n            request.click(function () {\n                var message = ml.Mail.getCannedMessage(can, \"\", options.item.id);\n\n                var to = users.filter(function (user) { return user != matrixSession.getUser(); });\n\n                ml.Mail.sendMailDlg(to.join(), null, subject + options.item.id, message,\"\");\n            });\n        }\n\n        if (globalMatrix.ItemConfig.canReport(options.type)) {\n            var download = ml.UI.createDropDownButton(\"Download document\", formats, false, \"btnDownload\");\n            body.append(download);\n\n            if (!that.hideFileOption(options.type, \"xlsx\")) {\n                that.getBaseDOCofSIGN(matrixSession.getProject(), options.item)\n                    .done(doc => {\n                        if (PluginManagerDocuments.hasCustomSection(doc)) {\n                            download.after(PluginManagerDocuments.excelButtonControl(() => {\n                                startDownload(\"xlsx\");\n                                return false;\n                            }));\n                        }\n                    })\n            }\n        } else {\n            body.append(\"<div class='inlineHelp'>You have no rights to download documents</div>\")\n        }\n        this.createCompareButton(body, options, controls);\n\n        function startDownload(format: string) {\n\n            // MATRIX-3721 if user modified title (or something else), ask to save first\n            if (app.getNeedsSave()) {\n                ml.UI.showError(\"Save Item\", \"Please save before downloading the signed item.\");\n                return;\n            }\n\n            // MATRIX-4863 wrap in function for use in async download\n            function performDownload() {\n                // MATRIX-3721 force the item to be readonly, this prevents tampering while the server (silently creates a new version)\n                // unless the user selects something else and comes back (that we need to catch somewhere else...)\n                matrixApplicationUI.forceReadonly(options.item.id);\n\n                ml.ReportGenerator.DownloadSignedDoc(options.item.id, { format: format });\n\n                var signatureInfo = that.getSignatureInfo();\n\n                if (signatureInfo.missingSignatures && that.dhf_config.warnMissingSign ) {\n                    ml.UI.showAck(-1, \"There are still some signatures missing\");\n                }\n            }\n\n            if (format == \"xlsx\") {\n                that.getBaseDOCofSIGN(matrixSession.getProject(), options.item)\n                    .done(doc => {\n                        if (PluginManagerDocuments.hasCustomSection(doc)) {\n                            performDownload();\n                        } else {\n                            ml.UI.showError(\"No Custom section\", \"Only DOC/SIGN with a Custom section can be downloaded as an Excel file.\");\n                        }\n                    })\n                    .fail(error => {\n                        ml.UI.showError(\"Error checking DOC\", \"Unable to load original DOC to check for Excel data\");\n                    });\n            } else {\n                performDownload();\n            }\n        }\n        function startDownloadCached(target: string) {\n            // target is a file attachment url like \"5745?key\\u003dkey_2d6a3cju4dr5qnm9ogvstfqkn2\"\n            let clean = target.replace(\"\\u003d\",\"=\");\n            let param = (clean.split(\"?\")[1]).split(\"=\"); // [\"key\", \"key_2d6a3cju4dr5qnm9ogvstfqkn2\"]\n            let params:IStringMap = {};\n            params[param[0]] = param[1];  // params= {key:\"key_2d6a3cju4dr5qnm9ogvstfqkn2\"}\n\n            app.downloadFromUrl(\"file/\" + clean.split(\"?\")[0], params); // 5745, para,s\n        }\n\n    }\n\n    private getOtherSigns( thisSign:string, thisDoc:string):JQueryDeferred<string[]> {\n        let that = this;\n\n        let res = $.Deferred();\n        let otherSigns:string[] = [];\n        app.getItemAsync(thisDoc).done(function (doc: IItemGet) {\n            $.each( doc.downLinks, function(idx, sign){\n                let ref = ml.Item.parseRef(sign.to).id;\n                if (that.isDocumentType(ml.Item.parseRef(sign.to).type) && ref !== thisSign) {\n                    otherSigns.push(ref);\n                }\n            });\n            res.resolve(otherSigns);\n        });\n        return <any>res;\n    }\n\n    private createCompareButton(rt: JQuery, options: IItemControlOptions, controls: IDHFControlDefinition[]) {\n        let that = this;\n\n        // add button for redlining\n\n        let placeHolderRL = $(\"<div class='btnCompare'>\");\n        rt.append(placeHolderRL);\n\n        var versionSelectRL: IDropDownButtonOption[] = [];\n\n\n\n        let thisSign;\n        let thisDoc;\n        // find the mother DOC or use as mother DOC if it is already a doc\n        if (options.type === \"SIGN\" && options.item.upLinkList && options.item.upLinkList.length > 0) {\n            let ref = ml.Item.parseRef(options.item.upLinkList[0].itemRef).id;\n            thisDoc = ref;\n            thisSign = options.id;\n            versionSelectRL.push({ name: \"Current DOC\", click: function () { that.redlineDocuments(ref); } });\n        } else {\n            thisDoc = options.id;\n        }\n\n        this.getOtherSigns(thisSign, thisDoc).done( function(otherSigns) {\n\n            $.each( otherSigns, function( idx, otherSign ) {\n                versionSelectRL.splice(0, 0, { name: otherSign + \" \" + app.getItemTitle(otherSign), click: function () { that.redlineDocuments(otherSign); } });\n            });\n            if (versionSelectRL.length === 1) {\n                placeHolderRL.replaceWith(ml.UI.createDropDownButton(\"Redline against \" + versionSelectRL[0].name, versionSelectRL, false, \"btnCompare\"));\n            } else if (versionSelectRL.length > 0) {\n\n                placeHolderRL.replaceWith(ml.UI.createDropDownButton(\"Redline against ...\", versionSelectRL, false, \"btnCompare\"));\n            } else {\n                // nothing released yet\n                placeHolderRL.remove();\n            }\n        });\n\n\n        // add button for side by side compare\n        var extras = globalMatrix.ItemConfig.getExtrasConfig();\n\n        if (extras && ml.JSON.isTrue(extras.compareInsideX)) {\n\n            let placeHolder = $(\"<div class='btnCompare'>\");\n            rt.append(placeHolder);\n\n            var versionSelect: IDropDownButtonOption[] = [];\n\n            let thisSign:string;\n            let thisDoc:string;\n            // find the mother DOC or use as mother DOC if it is already a doc\n            if ( that.isDocumentFormType(options.item.type)) {\n                thisDoc = options.id;\n            } else if (options.item.upLinkList) {\n                let docsInList = options.item.upLinkList.filter( function(ul) { return that.isDocumentFormType(ml.Item.parseRef(ul.itemRef).type);});\n                if (docsInList.length) {\n                    let ref = ml.Item.parseRef(docsInList[0].itemRef).id;\n                    thisDoc = ref;\n                    thisSign = options.id;\n                    versionSelect.push({ name: thisDoc + \" \" + app.getItemTitle(thisDoc), click: function () { that.compareDocuments(thisDoc, controls); } });\n                }\n            }\n\n            if (!thisDoc) {\n                // no more history\n                placeHolder.remove();\n                return;\n            }\n\n            that.getOtherSigns(thisSign, thisDoc).done( function(otherSigns) {\n\n                $.each( otherSigns, function( idx, otherSign ) {\n                    versionSelect.push({ name: otherSign + \" \" + app.getItemTitle(otherSign), click: function () { that.compareDocuments(otherSign, controls); } });\n                });\n                if (versionSelect.length === 1) {\n                    placeHolder.replaceWith(ml.UI.createDropDownButton(\"Compare with \" + versionSelect[0].name, versionSelect, false, \"btnCompare\"));\n                } else if (versionSelect.length > 0) {\n                    placeHolder.replaceWith(ml.UI.createDropDownButton(\"Compare to ...\", versionSelect, false, \"btnCompare\"));\n                } else {\n                    // nothing released yet\n                    placeHolder.remove();\n                }\n            });\n        }\n\n\n\n    }\n\n    private async compareDocuments(target: string, otherControls: IDHFControlDefinition[]) {\n\n        let that = this;\n        let reportProc: number;\n\n        let ui = $(\"<div style='width:100%'>\");\n        ui.append(ml.UI.getSpinningWait(\"retrieving documents...\"));\n\n        let left: string;\n        let right: string;\n\n        // show dialog\n        app.dlgForm.html(\"\").append(ui);\n\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Compare documents\",\n            height: app.itemForm.height() * 0.9,\n            width: $(document).width() * 0.9,\n            modal: true,\n            close: function () {\n                app.dlgForm.removeClass(\"forcePrint\");\n                $(\".compareTools\").remove();\n            },\n            open: function () {\n                app.dlgForm.addClass(\"forcePrint\");\n            },\n            resizeStop: function (event, ui) {\n                app.dlgForm.resizeDlgContent([]);\n\n            },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnCancelIt',\n                click: function () {\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent([], false);\n\n\n        let otherType = ml.Item.parseRef(target).type;\n        if (this.isDocumentFormType(otherType)) {\n            // the other document is a DOC need to retrieve it to know if there's any label filters to take into account\n            app.getItemAsync(target).done(function (otherDOC: IItem) {\n                let docFilter = globalMatrix.ItemConfig.getFields(otherType).filter(function (field) {\n                    return field.fieldType == \"docFilter\";\n                });\n\n                let otherOptions: IReportOptions = {format: \"html\"};\n                if (docFilter.length && (<any>otherDOC)[docFilter[0].id]) {\n                    let filter = JSON.parse((<any>otherDOC)[docFilter[0].id]);\n                    if (filter.length) {\n                        otherOptions.filter = filter.join(\",\");\n                    }\n                }\n                app.startCreateDocumentAsync(target, otherOptions).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n                    mDHF.loadDocument(result.jobId, function (htmlDOM: any) {\n                        right = htmlDOM;\n                        that.compareDocumentsContent(that.item.id, target, left, right, ui);\n                    })\n                });\n            });\n        } else {\n            app.startCreateDocumentAsync(target, {format: \"html\"}).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n                mDHF.loadDocument(result.jobId, function (htmlDOM: any) {\n                    right = htmlDOM;\n                    that.compareDocumentsContent(that.item.id, target, left, right, ui);\n                })\n            });\n        }\n\n        // start report generation for this DOC or SIGN, if it is a DOC make sure label filters are active\n        let thisOptions: IReportOptions = {format: \"html\"};\n        if (this.isDocumentFormType(this.item.type) && otherControls && otherControls.length) {\n            let labels = await that.getFilterValue(<any>that.getFilterCtrl(this.item.type, otherControls));\n            if (labels) thisOptions.filter = labels;\n        }\n        app.startCreateDocumentAsync(this.item.id, thisOptions).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n            mDHF.loadDocument(result.jobId, function (htmlDOM: any) {\n                left = htmlDOM;\n                that.compareDocumentsContent(that.item.id, target, left, right, ui);\n            })\n        });\n\n    }\n\n    private redlineDocuments(target: string) {\n\n        let that = this;\n\n        if (app.needsSave()) {\n            ml.UI.showError( \"Please Save\", \"Plase save before redlining documents.\");\n            return;\n        }\n\n        let ui = $(\"<div style='width:100%'>\");\n        ui.append(ml.UI.getSpinningWait(\"examining documents...\"));\n\n        // show dialog\n        let dlg = $(\"<div class='forcePrint'>\").appendTo($(\"body\"));\n\n\n        let redlining = new Redlining();\n\n        ml.UI.showDialog(dlg, \"Redline\", ui, $(document).width() * 0.9, app.itemForm.height() * 0.9,\n        [{\n            text: 'Ok',\n            class: 'btnCancelIt',\n            click: function () {\n                dlg.dialog(\"close\");\n            }\n            }], UIToolsConstants.Scroll.Vertical, true, true, () => { redlining.cancelCompare(); dlg.remove(); }, () => { }, () => { dlg.resizeDlgContent([]); }\n        );\n\n        redlining.compareDocuments( ui, that.item.id, target);\n\n    }\n    private filterAlignItems( showDifferent:boolean, showSorted:boolean) {\n        // hide all\n        $(\".compareItem\").hide();\n\n        if ( showDifferent && showSorted) {\n            // not sorted AND not identical\n            //  show sorted                 show different\n            $(\".compareItem\").not(\".compareItemOriginal\").not(\".compareItemSame\").show();\n        } else if ( showDifferent && !showSorted) {\n            // not sorted AND not identical\n            //  show original         show different\n            $(\".compareItemOriginal\").not(\".compareItemSame\").show();\n\n\n        } else if ( !showDifferent && showSorted) {\n            $(\".compareItem\").not(\".compareItemOriginal\").show();\n        } else {\n            $(\".compareItem.compareItemOriginal\").show();\n        }\n    }\n    compareDocumentsContent(thisId:string, otherId:string, left: string, right: string, ui: JQuery) {\n        let that = this;\n        let itemHideIdentical = false;\n        let itemSortAlign = false;\n\n\n        if (!left || !right) {\n            return;\n        }\n        left = new HTMLCleaner( $(left).html(), false).getClean(HTMLCleaner.CleanLevel.Strict, true);\n        right = new HTMLCleaner($(right).html(), false).getClean(HTMLCleaner.CleanLevel.Strict, true);\n        let param:XCPostCompareHtml =  {\n            arg: JSON.stringify({ versions:[left, right]})\n        }\n\n        app.compareHTML(param).done(function (result: XRPostProject_CompareHtml_HtmlCompareResult) {\n            ui.html(\"\");\n            let ctrls = $(\"<div class='compareTools'>\").appendTo(app.dlgForm.parent().find(\".ui-dialog-titlebar\"));\n            let sectionTools = $(\"<div class='compareToolsGroup'>\").appendTo(ctrls);\n            let itemTools = $(\"<div class='compareToolsGroup'>\").appendTo(ctrls);\n\n            $('<span class=\"compareToolsHeader\">Sections:</span>').appendTo(sectionTools);\n            $('<div class=\"checkbox compareTool\" ><label><input type=\"checkbox\">hide identical sections</label></div>').appendTo(sectionTools).click(function (event: JQueryMouseEventObject) {\n                $(\"input\", $(event.delegateTarget)).prop('checked') ? $(\".compareRowSame\").hide() : $(\".compareRowSame\").show();\n            });\n            $(`<div class=\"checkbox compareTool\" ><label><input type=\"checkbox\">hide sections only in ${thisId}</label></div>`).appendTo(sectionTools).click(function (event: JQueryMouseEventObject) {\n                $(\"input\", $(event.delegateTarget)).prop('checked') ? $(\".compareLeftOnly\").hide() : $(\".compareLeftOnly\").show();\n            });\n            $(`<div class=\"checkbox compareTool\" ><label><input type=\"checkbox\">hide sections only in ${otherId}</label></div>`).appendTo(sectionTools).click(function (event: JQueryMouseEventObject) {\n                $(\"input\", $(event.delegateTarget)).prop('checked') ? $(\".compareRightOnly\").hide() : $(\".compareRightOnly\").show();\n            });\n            $('<span class=\"compareToolsHeader\">Items:</span>').appendTo(itemTools);\n            $('<div class=\"checkbox compareTool\" ><label><input type=\"checkbox\">hide identical items</label></div>').appendTo(itemTools).click(function (event: JQueryMouseEventObject) {\n                itemHideIdentical = $(\"input\", $(event.delegateTarget)).prop('checked');\n                that.filterAlignItems(itemHideIdentical, itemSortAlign);\n            });\n            $('<div class=\"checkbox compareTool\" ><label><input type=\"checkbox\">sort and align items</label></div>').appendTo(itemTools).click(function (event: JQueryMouseEventObject) {\n                itemSortAlign = $(\"input\", $(event.delegateTarget)).prop('checked');\n                that.filterAlignItems(itemHideIdentical, itemSortAlign);\n            });\n\n            let headers = $(\"<div class='compareHeaders'>\").appendTo(ui);\n            $(\"<div class='compareHeader'>\").appendTo(headers).html(`This document (${thisId})`);\n            $(\"<div class='compareHeader'>\").appendTo(headers).html(`Other document (${otherId})`);\n\n            that.fillSideBySide($(result.html[0]),$(result.html[1]), ui);\n        });\n    }\n\n    private fillSideBySide(left:JQuery, right:JQuery, ui:JQuery) {\n        let buffer = $(\"<div style='display:none'>\").appendTo(\"body\");\n        buffer.append(left);\n\n        let row: JQuery = $(\"<div>\");\n        let leftUI: JQuery = $(\"<div>\");\n        let rightUI: JQuery = $(\"<div>\");\n        // add left report - each section one row\n        let ssc = $($(\".subchapter\", buffer)[0]);\n        while (ssc && ssc.length > 0) {\n            if (ssc.hasClass(\"subchapter\")) {\n                row = $(\"<div class='compareRow compareLeftOnly'>\").appendTo(ui);\n                leftUI = $(\"<div class='compareLeft'>\").appendTo(row);\n                rightUI = $(\"<div class='compareRight'>\").appendTo(row);\n            }\n            let next = ssc.next();\n            leftUI.append(ssc);\n            ssc = next;\n        };\n        // add right report - if same section (title) exists in left only match it, if not append\n        buffer.html(\"\");\n        buffer.append(right);\n        ssc = $($(\".subchapter\", buffer)[0]);\n        while (ssc && ssc.length > 0) {\n            if (ssc.hasClass(\"subchapter\")) {\n                row = null;\n                $(\".compareRow.compareLeftOnly\", ui).each(function (lri, lr) {\n                    if ($.trim($(\".subchapter\", lr).text()) == $.trim(ssc.text())) {\n                        row = $(lr);\n                        row.removeClass(\"compareLeftOnly\");\n                        rightUI = $(\".compareRight\", row);\n                        return;\n                    };\n                });\n                if (!row) {\n                    row = $(\"<div class='compareRow compareRightOnly'>\").appendTo(ui);\n                    leftUI = $(\"<div class='compareLeft'>\").appendTo(row);\n                    rightUI = $(\"<div class='compareRight'>\").appendTo(row);\n                }\n            }\n            let next = ssc.next();\n            rightUI.append(ssc);\n            ssc = next;\n        };\n\n        // find sections which match\n        $(\".compareRow\", ui).each(function (ridx, row) {\n            // remove all itemspacers (these are added by report engine to have space between items)\n            $(\".compareRow .itemspacer\").remove();\n\n            if (!$(row).hasClass(\"compareRightOnly\") && !$(row).hasClass(\"compareLeftOnly\")) {\n                leftUI = $(row).find(\".compareLeft\");\n                rightUI = $(row).find(\".compareRight\");\n\n                if (leftUI.html() === rightUI.html()) {\n                    $(row).addClass(\"compareRowSame\");\n                }\n\n                // build lists of all items in sections left and right\n                let sortLeft: ItemSortInfo[] = [];\n                let sortRight: ItemSortInfo[] = [];\n                // buffer with name\n                $.each($(\".wide_item_title\", leftUI), function (lii, leftItem) {\n                    let lt = $(leftItem).closest(\"table\");\n                    lt.addClass(\"compareItem\");\n                    sortLeft.push({ itemId: $(\"a\", $(leftItem)).text(), item: lt, existsInBoth: false });\n                });\n                $.each($(\".wide_item_title\", rightUI), function (lii, rightItem) {\n                    let rt = $(rightItem).closest(\"table\");\n                    rt.addClass(\"compareItem\");\n                    sortRight.push({ itemId: $(\"a\", $(rightItem)).text(), item: rt, existsInBoth: false });\n                });\n                // if there are any items either left or right, mark everything in both sections\n                if (sortLeft.length > 0 || sortRight.length > 0) {\n                    leftUI.children().each(function (idx, c) {\n                        $(c).addClass(\"compareItemOriginal\");\n                    });\n                    rightUI.children().each(function (idx, c) {\n                        $(c).addClass(\"compareItemOriginal\");\n                    });\n                }\n                // mark matching and identical items\n                $.each(sortLeft, function (lii, lt) {\n                    $.each(sortRight, function (rii, rt) {\n\n                        if (lt.itemId == rt.itemId) {\n                            lt.existsInBoth = true;\n                            rt.existsInBoth = true;\n                        }\n                        if (lt.item.html() == rt.item.html()) {\n                            lt.item.addClass(\"compareItemSame\");\n                            rt.item.addClass(\"compareItemSame\");\n                        }\n\n                    });\n                });\n                // sort: first matching in top, than by item id\n                sortLeft = sortLeft.sort(function (a, b) {\n                    if (a.existsInBoth && !b.existsInBoth) { return -1; }\n                    if (b.existsInBoth && !a.existsInBoth) { return 1; }\n                    let an = ml.Item.parseRef(a.itemId);\n                    let bn = ml.Item.parseRef(b.itemId);\n                    let at = an.type + an.isFolder?\"-F\":\"\";\n                    let bt = bn.type + bn.isFolder?\"-F\":\"\";\n\n                    return at < bt  || (at == bt &&  an.number < bn.number) ? -1 : 1; // there should not be doubles\n                });\n                sortRight = sortRight.sort(function (a, b) {\n                    if (a.existsInBoth && !b.existsInBoth) { return -1; }\n                    if (b.existsInBoth && !a.existsInBoth) { return 1; }\n                    let an = ml.Item.parseRef(a.itemId);\n                    let bn = ml.Item.parseRef(b.itemId);\n                    let at = an.type + an.isFolder?\"-F\":\"\";\n                    let bt = bn.type + bn.isFolder?\"-F\":\"\";\n\n                    return at < bt  || (at == bt &&  an.number < bn.number) ? -1 : 1; // there should not be doubles\n                });\n                // insert copies of sorted items\n                $.each(sortLeft, function (idx, sl) {\n                    if (sl.existsInBoth) {\n                        // find right idx\n                        let rightIdx = 0;\n                        // identical id in right must exist\n                        while (sortRight[rightIdx].itemId != sl.itemId) {\n                            rightIdx++;\n                        }\n\n                        let nl = sl.item.clone();\n                        nl.removeClass(\"compareItemOriginal\");\n                        nl.addClass(\"compareItemSorted\");\n                        leftUI.append(nl);\n\n                        let nr = sortRight[rightIdx].item.clone();\n                        nr.removeClass(\"compareItemOriginal\");\n                        nr.addClass(\"compareItemSorted\");\n                        rightUI.append(nr);\n                        if (nl.height() > nr.height()) {\n                            nr.css(\"cssText\", \"margin-bottom:\" + (6 + nl.height()-nr.height()) + \"px !important\");\n\n                            // 10 is the margin of compareitem (which is not part of hight calculation) - 4 pixels magic...\n                        } else if (nl.height() < nr.height()) {\n                            nl.css(\"cssText\", \"margin-bottom:\" +  (6 + nr.height()-nl.height())+ \"px !important\");\n                        }\n\n                        nl.hide();\n                        nr.hide();\n\n                    } else {\n                        let nl = sl.item.clone();\n                        nl.removeClass(\"compareItemOriginal\");\n                        nl.addClass(\"compareItemSorted\");\n                        leftUI.append(nl);\n                        let nr = $(\"<div class='compareItem compareItemSorted'>\");\n                        rightUI.append(nr);\n                        nr.height(nl.height());\n                        nl.hide();\n                        nr.hide();\n                    }\n                });\n                $.each(sortRight, function (idx, sr) {\n                    if (sr.existsInBoth) {\n                        // did this already\n                    } else {\n                        let nr = sr.item.clone();\n                        nr.removeClass(\"compareItemOriginal \");\n                        nr.addClass(\"compareItemSorted\");\n                        rightUI.append(nr);\n\n                        let nl = $(\"<div class='compareItem compareItemSorted'>\");\n                        leftUI.append(nl);\n                        nl.height(nr.height());\n                        nl.hide();\n                        nr.hide();\n                    }\n                });\n\n            }\n        });\n\n        buffer.html(\"\");\n    }\n\n    getDocumentStatus( item:IItem ):IDocumentStatus {\n        let status: IDocumentStatus = {};\n        let markAsTemplates = globalMatrix.ItemConfig.getFieldsOfType(\"markAsTemplate\", item.type);\n        let requiredTemplateApprovals:string[] = [];\n        let templateApprovalStatus:ISignaturesInfo = <any>{};\n        if (markAsTemplates.length==1) {\n            requiredTemplateApprovals = MarkAsTemplateImpl.getRequiredApprovals((<any>item)[markAsTemplates[0].field.id]);\n            templateApprovalStatus = MarkAsTemplateImpl.getTemplateSignatureStatus((<any>item)[markAsTemplates[0].field.id]);\n        }\n        let signatureStatus = DocBaseImpl.readSignatureInfo(item);\n\n\n\n\n        if (this.isDocumentFormType (item.type )) {\n            status.isDoc = true;\n            if (requiredTemplateApprovals.length>0) {\n                status.isDocWithTemplate = true;\n            } else if (markAsTemplates.length==1 &&  requiredTemplateApprovals.length==0)  {\n                status.isDocWithEmptyTemplate = true;\n            }\n            // check if there's a signature table and that the status is\n            $.each(item, function (key, val) {\n                if (val && globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                    // special dhf control\n                    var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                    if ( fieldVal.type.toLocaleLowerCase() === \"signaturebox\") {\n\n                        if ( fieldVal.fieldValue && JSON.parse( fieldVal.fieldValue).length) {\n                            status.isDocWithFilledSignatureTable = true;\n                        } else  {\n                            status.isDocWithEmptySignatureTable = true;\n                        }\n                    }\n                }\n            });\n            if ( !status.isDocWithFilledSignatureTable && !status.isDocWithEmptySignatureTable ) {\n                status.isDocWithoutSignatureTable = true;\n            }\n\n        } else if (this.isSignedType(item.type) ) {\n            status.isSign = true;\n            if (requiredTemplateApprovals.length>0) {\n                status.isSignNeedingTemplateApproval = true;\n                if (requiredTemplateApprovals.indexOf(matrixSession.getUser()) != -1) {\n                    status.isSignNeedingTemplateMyApproval = true;\n                }\n            } else if ( templateApprovalStatus.givenSignatures ) {\n                status.isSignApprovedTemplate = true;\n            } else if (signatureStatus.hasSignature && signatureStatus.missingSignatures) {\n                status.isSignNeedingSignature = true;\n            } else if (signatureStatus.hasSignature) {\n                status.isSignCompletlySigned = true;\n            }\n            if (!status.isSignNeedingTemplateApproval && !status.isSignApprovedTemplate && !status.isSignNeedingSignature  && !status.isSignCompletlySigned) {\n                status.isSignNoSignatureNoTemplate = true;\n            }\n        } else{\n            // not a doc not a sign\n        }\n\n        return status;\n    }\n\n    static excelButtonControl(click: () => boolean): JQuery {\n        const tooltip = `Export Custom sections to an Excel file.\\nThis only works with Custom sections, other parts of the document are ignored.\\nThe Custom sections should ideally be tables.`;\n        return $(`<button class='btn btn-default' title='${tooltip}' style='margin-right:5px'>Excel Export</button>`)\n            .click(click);\n    }\n}\n\n\ninterface IDocumentStatus {\n    isDoc?:boolean,\n    isDocWithTemplate?:boolean // it's a DOC with a template field, with some users in there\n    isDocWithEmptyTemplate?:boolean  // it's a DOC with a template field which is empty\n    isDocWithFilledSignatureTable?:boolean  // it's a DOC with a signature field with some users mentioned\n    isDocWithEmptySignatureTable?:boolean // it's a DOC with a signature field without users mentioned\n    isDocWithoutSignatureTable?:boolean // it's a DOC without a signature\n\n    isSign?:boolean\n\n    isSignNeedingTemplateApproval?:boolean // it's a template which needs to be approved\n    isSignNeedingTemplateMyApproval?:boolean // it's a template which needs to be approved by ME\n    isSignApprovedTemplate?:boolean // it's a template which has been approved\n\n    isSignNeedingSignature?:boolean // it's a SIGN which needs to be signed\n    isSignCompletlySigned?:boolean // it's a SIGN which has been signed\n    isSignNoSignatureNoTemplate?:boolean // is's a SIGN no template and no signature\n}\nclass ColumnTypesInfo {\n    private config: IDHFConfig;\n\n    private editorOfType = {\n        type0:ColumnEditor.textline,\n        type1:ColumnEditor.text,\n        type2:ColumnEditor.versionletter,\n        type3:ColumnEditor.none,\n        type4:ColumnEditor.user,\n        type5:ColumnEditor.none,\n        type6:ColumnEditor.signaturemeaning,\n        type7:ColumnEditor.eco,\n        type8:ColumnEditor.ecocapa,\n        type9:ColumnEditor.date,\n//        type10:ColumnEditor.groupuser, // allow user to select a group or a user to sign\n        type11:ColumnEditor.group, // allow to select a group (just as text field, like a role)\n        type12:ColumnEditor.revision,\n        type13:ColumnEditor.date_today,\n        type14:ColumnEditor.number\n    };\n\n    private nameOfType = {\n        type0: \"Text Line\",\n        type14: \"Number\",\n        type1: \"Rich Text\",\n        type4: \"Name\",\n        type9: \"Date\",\n        type13: \"Date (auto)\",\n        type2: \"Version Letter\",\n        type6: \"Signature Meaning\",\n        type3: \"eSignature Signature\",\n        type5: \"eSignature Date\",\n        type7: \"ECO\", // don't show as option in new tables\n        type8: \"ECO/CAPA\",// don't show as option in new tables\n//        type10: \"Name / Group\",\n        type11: \"Group / Role\",\n        type12: \"Revision\"\n\n    };\n\n    constructor(config: IDHFConfig) {\n        this.config = config;\n    }\n\n    private getCustomTypeDef(type: string): IDHFConfigCustomColumn {\n        if (this.config.customColumns) {\n            for (var idx = 0; idx < this.config.customColumns.length; idx++) {\n                if (this.config.customColumns[idx].type === type) {\n                    return this.config.customColumns[idx];\n                }\n            }\n        }\n        return null;\n    }\n\n    getCustomDropDownOptions(type: string): IDropdownOption[] {\n        if (this.config.customColumns) {\n            for (var idx = 0; idx < this.config.customColumns.length; idx++) {\n                if (this.config.customColumns[idx].type === type) {\n                    return this.config.customColumns[idx].options;\n                }\n            }\n        }\n        return null;\n    }\n\n    getNames(currentColumns:string[]): { [key: string]: string } {\n        let  names = ml.JSON.clone(this.nameOfType);\n\n        //type7: \"ECO\", // don't show as option\n        //type8: \"ECO/CAPA\",// don't show as option\n        if (currentColumns.indexOf(\"type7\") == -1 ) {\n            delete names.type7;\n        }\n        if (currentColumns.indexOf(\"type8\") == -1 ) {\n            delete names.type8;\n        }\n\n        if (this.config.customColumns) {\n            for (var idx = 0; idx < this.config.customColumns.length; idx++) {\n                names[this.config.customColumns[idx].type] = this.config.customColumns[idx].name;\n            }\n        }\n\n        return names;\n    }\n\n    getEditorOfType(type: string): TableCellEditor {\n\n        var colDef = this.getCustomTypeDef(type);\n        if (colDef) {\n            return <TableCellEditor>(colDef.editor ? colDef.editor : \"select\");\n        }\n\n        return <TableCellEditor>((<IGenericMap>this.editorOfType)[type]);\n    }\n\n    getOptionsOfType(type: string): IDropdownOption[] {\n        var colDef = this.getCustomTypeDef(type);\n        if (colDef) {\n            return colDef.options;\n        }\n        return [];\n    }\n\n    getNameOfType(type: string): string {\n        var colDef = this.getCustomTypeDef(type);\n        if (colDef) {\n            return colDef.name;\n        }\n        return (<IGenericMap>this.nameOfType)[type];\n    }\n\n}\n\nvar mDHF: PluginManagerDocuments;\n\nfunction InitializePluginManagerDocuments() {\n    mDHF = new PluginManagerDocuments();\n    plugins.register(mDHF);\n}\n","import { IDB, IDBParent, DBCache } from \"./DBCache\";\n\nimport {\n    XCPostAddProjectSetting, XCPostCompareHtml, XCGetProjectAudit, XCPostAddFolder,\n    XCPostAddItem, XCPostSignItem, XCPostConvertWord, XCPostRestoreItem, XCPutEditItem,\n    XCDeleteItem, XCGetNeedleMinimal, XCGetNeedle\n} from \"./../../RestCalls\";\nimport { RestConnector, IJcxhr, IFileParam, IFileUploadProgress } from \"./RestConnector\";\nimport { ml } from \"./../matrixlib\";\nimport {\n    XRPostProject_RestoreItem_UndeleteAnswer,\n    XRGetProject_ProjectSettingAll_GetSettingAck,\n    XRTrimItem,\n    XRGetProject_ItemDetail_TrimItem,\n    XRGetProject_Needle_TrimNeedle,\n    XRGetProject_AllJob_JobsWithUrl,\n    XRPostProject_LaunchReport_CreateReportJobAck,\n    XRGetProject_JobStatus_JobsStatusWithUrl,\n    XRPostProject_CompareHtml_HtmlCompareResult,\n    XRTrimNeedleItem,\n    XRGetProject_NeedleMinimal_StringList,\n    XRGetProject_CategoryList_GetProjectStructAck,\n    XRGetProject_ProjectAudit_TrimAuditList,\n    XRTrimAudit,\n    XRGetProject_Reports_GetReportsAck,\n    XRPostProject_AddFolder_AddItemAck,\n    XRPostProject_SignItem_SignItemAck,\n    XRGetProject_ProjectInfo_ProjectInfo,\n    XRPostProject_AddItem_AddItemAck,\n    XRPutProject_EditItem_TrimItem,\n    XRProjectInfo\n} from \"../../RestResult\";\nimport { mDHF } from \"./PluginManagerDocuments\";\nimport { plugins } from \"./PluginManager\";\nimport { IReportOptions } from \"../matrixlib/MatrixLibInterfaces\";\nimport {\n    IItem,\n    globalMatrix,\n    matrixSession,\n    restConnection,\n    app,\n    IItemGet,\n    IGenericMap,\n    IStringMap,\n    IItemPut,\n    IRestResult,\n    IItemHistory,\n    IRestParam\n} from \"../../globals\";\nimport { mTM } from \"./TestManager\";\n\nexport type { ISearchResult, ISearchResultField, IRestoreItemResult, IUpdateCache };\nexport { RestDB };\n\ninterface ISearchResult {\n    itemId: string,\n    version: number,\n    title: string,\n    fieldVal?: ISearchResultField[],\n    downlinks: string[],\n    uplinks: string[],\n    labels: string[],\n    creationDate?: string\n    // There is a pseudo-field called creationDate which may or may not be here.\n    // We often construct ISearchResult objects from needle searches, and the needle\n    // result has creationDate (sometimes).\n}\ninterface ISearchResultField { id: number, value: string }\n\ninterface IRestoreItemResult { item: string, version: number, response: XRPostProject_RestoreItem_UndeleteAnswer }\ninterface IUpdateCache { item: IItem, parent: string }\n\n\nclass RestDB {\n\n    // see for cache http://learn.jquery.com/code-organization/deferreds/examples/\n\n    private restConnection:RestConnector;\n    private _project:string;\n\n\n    private dbCache:DBCache;\n\n    constructor(init:RestConnector) {\n        this.restConnection = init;\n    }\n\n    setProject(project:string):void {\n        this._project = project;\n        this.restConnection.setProject(project);\n    }\n\n\n    setSettingJSON(key:string, valueJSON:{}):JQueryDeferred<{}> {\n        let that = this;\n        var res = $.Deferred();\n        var newSetting = JSON.stringify(valueJSON);\n        try {\n            var check = JSON.parse(newSetting);\n            let setSetting: XCPostAddProjectSetting =  {\n                value: newSetting,\n                key: key,\n                reason: \"setting change\"};\n            this.restConnection.postServer(this._project + \"/setting\", setSetting).done(function () {\n                globalMatrix.ItemConfig.setSettingJSON(key, valueJSON);\n                res.resolve();\n            }).fail(function(jqxhr: IJcxhr, textStatus:string, error:string) {\n                that.showRestError(jqxhr, textStatus, error);\n                res.reject();\n            });\n        }\n        catch (err) {\n            ml.UI.showError(\"Bad value of setting.\", \"Error was:\" + err);\n            res.reject();\n        }\n        return res;\n    }\n\n    readSettingJSONAsync(key:string, otherProject?:string, noRetry?:boolean):JQueryDeferred<{}> {\n        var res = $.Deferred();\n        this.restConnection.getServer((otherProject ? otherProject : matrixSession.getProject()) + \"/setting\", noRetry).done(function (settings: XRGetProject_ProjectSettingAll_GetSettingAck) {\n            var found = false;\n            if (settings.settingList) {\n                $.each(settings.settingList, function (idx, setting) {\n                    if (setting.key === key && setting.value && setting.value.indexOf('{') !== -1) {\n                        // assume it a json\n                        var val = ml.JSON.fromString(setting.value);\n                        if (val.status === \"ok\") {\n                            found = true;\n                            res.resolve(val.value)\n                        }\n                    }\n                });\n            }\n            if (!found) {\n                res.resolve({});\n            }\n        }).fail( function() {\n            res.reject();\n        });\n        return res;\n    }\n\n\n    setSettingCustomerJSON(  settingId:string, valueJSON:{} ) {\n        let that = this;\n\n        let res = $.Deferred();\n\n        restConnection.postServer(\"all/setting\", {\n            key:settingId,\n            value:JSON.stringify(valueJSON),\n            reason: \"setting change\"\n\n        }).done(function (result) {\n            res.resolve();\n        }).fail(function(jqxhr: IJcxhr, textStatus:string, error:string) {\n            that.showRestError(jqxhr, textStatus, error);\n            res.reject();\n        });\n\n        return res;\n    }\n\n    readSettingCustomerJSONAsync( key:string ) {\n        var res = $.Deferred();\n        this.restConnection.getServer(\"all/setting\").done(function(settings: XRGetProject_ProjectSettingAll_GetSettingAck) {\n            var found = false;\n            if (settings.settingList) {\n                $.each(settings.settingList, function (idx, setting) {\n                    if (setting.key === key && setting.value && setting.value.indexOf('{') !== -1) {\n                        // assume it a json\n                        var val = ml.JSON.fromString(setting.value);\n                        if (val.status === \"ok\") {\n                            found = true;\n                            res.resolve(val.value)\n                        }\n                    }\n                });\n            }\n            if (!found) {\n                res.resolve({});\n            }\n        });\n        return res;\n    }\n\n\n    // set or overwrite the default cache: used by jira addon to avoid caching\n    setCache( externalCache:DBCache ):void {\n        this.dbCache = externalCache;\n    }\n\n    retrieveTreeAsync():JQueryDeferred<{tree:IDB[], project:XRProjectInfo }> {\n        let that = this;\n        var res = $.Deferred<{tree:IDB[], project:XRProjectInfo }>();\n\n        let date = ml.URL.getParameterByName(window.location.href, \"atDate\");\n        let dp = date?(\"&atDate=\"+date):\"\";\n\n        if (date) {\n            globalMatrix.ItemConfig.activateTimewarp(date);\n        }\n\n        this.retrieveConfigAsync().done(function (project:XRProjectInfo) {\n\n            that.restConnection.getProject(\"tree?fancy\"+ dp).done(async function (result: IDB[]) {\n\n                result = RestDB.filterLegacyReportCat(result)\n                plugins.initProject(that._project);\n                mTM.InitializeProject();\n\n                that.dbCache = new DBCache();\n                await that.dbCache.initMatrixTree(result, app.isMedical());\n                res.resolve({tree:result, project:project });\n            });\n        });\n        return res;\n    }\n    retrieveTreeAndItem(itemId:string):JQueryDeferred<{item:IItem, tree:IDB[], project:XRProjectInfo} > {\n        let that = this;\n        var res = $.Deferred<{item:IItem, tree:IDB[], project:XRProjectInfo} >();\n\n        let date = ml.URL.getParameterByName(window.location.href, \"atDate\");\n        let dp = date?(\"&atDate=\"+date):\"\";\n\n        if (date) {\n            globalMatrix.ItemConfig.activateTimewarp(date);\n        }\n\n        this.retrieveConfigAsync().done(function (project:XRProjectInfo) {\n\n            if (itemId ) {\n\n                // check whether to show an item / folder (and not a dashboard or something)\n                let isItem = (globalMatrix.ItemConfig.getCategories(true).indexOf(ml.Item.parseRef(itemId).type) != -1);\n                let itemToGet = isItem?itemId:\"F-DOC-1\";\n\n                let history = \"?history=true\";\n\n                that.restConnection.getProject(\"item/\" + itemToGet + history + \"&withTree=1\", false).done(async function (result: XRTrimItem) {\n\n                    // init tree\n                    let tree = RestDB.filterLegacyReportCat(result.contextTree.children);\n\n                    for (let t of tree) {\n                        if (t.id.startsWith(\"F-\") && !t.children) {\n                            t.children = [];\n                        }\n                    }\n\n                    plugins.initProject(that._project);\n                    mTM.InitializeProject();\n\n                    ml.ContextFrames.init();\n\n                    that.dbCache = new DBCache();\n                    await that.dbCache.initMatrixTree(tree, app.isMedical());\n\n                    let item = that.parseItemJSON(itemId, result);\n\n                    if (that.dbCache.isFolder(itemId)) {\n                        item['children'] = [];\n                    }\n\n                    res.resolve({ item: isItem ? item : null, tree:tree, project:project});\n\n                }).fail(function (error) {\n                    // item might have been deleted\n                    that.loadTreeWithoutItem(dp).done( (db) => {\n                        res.resolve({item:null, tree:db, project:project } );\n                    });\n                });\n\n\n\n            } else {\n                that.loadTreeWithoutItem(dp).done( (db) => {\n                    res.resolve({item:null, tree:db, project:project } );\n                });\n\n            }\n        });\n        return res;\n    }\n\n    protected loadTreeWithoutItem(dp:string):JQueryDeferred<IDB[]>  {\n        let that = this;\n\n        let res = $.Deferred<IDB[]>();\n        that.restConnection.getProject(\"tree?fancy\"+ dp).done(async function (result: IDB[]) {\n\n            result = RestDB.filterLegacyReportCat(result)\n            plugins.initProject(that._project);\n            mTM.InitializeProject();\n\n            that.dbCache = new DBCache();\n            await that.dbCache.initMatrixTree(result, app.isMedical());\n            res.resolve(result);\n        });\n        return res;\n    }\n    static filterLegacyReportCat(result: any[]  ): any[] {\n\n        let enableLegacyReport = globalMatrix.ItemConfig != undefined ? globalMatrix.ItemConfig.getExtrasConfig().enableLegacyReport : undefined;\n        if(enableLegacyReport == undefined || enableLegacyReport == \"0\" )\n        {\n            //Let remove legacy report cat from the tree\n            let fReport1Index = result.findIndex((o)=> {return o.id == \"F-REPORT-1\" });\n            if( fReport1Index != -1)\n            {\n                result[fReport1Index].children = [];\n            }\n        }\n        if( enableLegacyReport == \"1\" )\n        {\n            result = result.filter((item)=>{return item.id != \"F-REPORT-1\"});\n        }\n        return result;\n    }\n\n    doesExist(itemId:string):boolean {\n        return this.dbCache.doesExist(itemId);\n    }\n\n    getChildrenIds(parentId:string):string[] {\n        return this.dbCache.getChildrenIds(parentId);\n    }\n\n    getItemFromTree(itemId:string):IDB {\n        return this.dbCache.getItemFromCache(itemId);\n    }\n\n    getItemAsync(itemId:string, ignoreErrors:boolean, includeHistory:boolean):JQueryDeferred<IItem> {\n        let that = this;\n        var res = $.Deferred();\n\n        let history = includeHistory?\"?history=true\":\"\";\n        if (this.dbCache.isFolder(itemId)) {\n            this.restConnection.getProject(\"item/\" + itemId + history, ignoreErrors).done(function (result:XRGetProject_ItemDetail_TrimItem) {\n                var item = that.parseItemJSON(itemId, result);\n                item['children'] = [];\n                res.resolve(item);\n            }).fail(function (error) {\n                res.reject(error);\n            });\n        } else {\n            this.restConnection.getProject(\"item/\" + itemId + history, ignoreErrors).done(function(result: XRGetProject_ItemDetail_TrimItem) {\n                //TODO update tree (e.g if title changed or parent?)\n                var item = that.parseItemJSON(itemId, result);\n                res.resolve(item);\n            }).fail(function (error) {\n                res.reject(error);\n            });\n        }\n        return res;\n    }\n\n    getNeedlesAsync(searchExpr:string, up:boolean, down:boolean, fields:string, labels:boolean, ignoreFilters?:boolean):JQueryDeferred<IItem[]> {\n        var res:JQueryDeferred<IItem[]> = $.Deferred();\n        let params:IRestParam = {};\n        if( up || down)\n            params.links = up&&down?\"down,up\":up?\"up\":\"down\";\n\n        if( fields)\n            params.fieldsOut = fields\n        if(labels)\n            params.labels = 1 ;\n\n        let items:IItem[] = [];\n        params.search = \"mrql:\"+searchExpr;\n\n        var labelFilter = ml.LabelTools.getFilter();\n        if (!ignoreFilters && labelFilter && labelFilter.length > 0) {\n            params.filter = labelFilter;\n        }\n\n        restConnection.postProject(\"needle\" , params, true).done(function (results: XRGetProject_Needle_TrimNeedle) {\n            $.each(results.needles, function(idx, needle) {\n                var item:IItemGet = {\n                    id: ml.Item.parseRef(needle.itemOrFolderRef).id,\n                    title: needle.title,\n                    type: ml.Item.parseRef(needle.itemOrFolderRef).type,\n                    downLinks: [],\n                    upLinks: [],\n                    modDate: needle.lastModDate,\n                    creationDate: needle.creationDate,\n                    isUnselected: 0,\n                    labels: needle.labels?needle.labels.split(\",\").map( function(label) { return label.substr(1, label.length-2);}) : []\n                };\n\n                if (needle.fieldVal) {\n                    $.each( needle.fieldVal, function(jdx, fieldVal)  {\n                       (<IGenericMap>item)[fieldVal.id.toString()] = fieldVal.value;\n                    });\n                }\n\n                for (var idx = 0; needle.downLinkList && idx < needle.downLinkList.length; idx++) {\n                    var tol = needle.downLinkList[idx].itemRef;\n\n                    item.downLinks.push({to: ml.Item.parseRef(tol).id, title: needle.downLinkList[idx].title, modDate: needle.downLinkList[idx].modDate});\n                }\n\n                for (var idx = 0; needle.upLinkList && idx < needle.upLinkList.length; idx++) {\n                    var tol = needle.upLinkList[idx].itemRef;\n\n                    item.upLinks.push({to: ml.Item.parseRef(tol).id, title: needle.upLinkList[idx].title, modDate: needle.upLinkList[idx].modDate});\n                }\n\n                items.push(item);\n            });\n            res.resolve(items);\n        }).fail( function() {\n            res.reject();\n        });\n\n        return res;\n\n    }\n\n    getItemProjectAsync(project:string, itemId:string, ignoreErrors:boolean, includeHistory:boolean):JQueryDeferred<IItem> {\n        let that = this;\n        var res = $.Deferred();\n\n        let history = includeHistory?\"?history=true\":\"\";\n\n        this.restConnection.getServer(project + \"/item/\" + itemId + history, ignoreErrors).done(function(result: XRGetProject_ItemDetail_TrimItem) {\n            var item = that.parseItemJSON(itemId, result);\n            res.resolve(item);\n        }).fail(function (error) {\n            res.reject(error);\n        });\n\n        return res;\n    }\n\n    getProjectItemAsync(project:string, itemId:string, includeHistory:boolean):JQueryDeferred<IItem> {\n        let that = this;\n        var res = $.Deferred();\n\n        let history = includeHistory?\"?history=true\":\"\";\n\n        this.restConnection.getServer(project + \"/item/\" + itemId + history).done(function(result: XRGetProject_ItemDetail_TrimItem) {\n            var item = that.parseItemJSON(itemId, result);\n            res.resolve(item);\n        }).fail(function (error) {\n            res.reject(error);\n        });\n\n        return res;\n    }\n\n    startReportAsync(itemId:string, reportOptions:IReportOptions):JQueryDeferred<{}> {\n        var res = $.Deferred();\n        reportOptions[\"url\"] = globalMatrix.matrixBaseUrl;\n        reportOptions[\"resturl\"] = globalMatrix.matrixRestUrl;\n        if (globalMatrix.ItemConfig.getTimeWarp()) {\n            reportOptions[\"atDate\"] = globalMatrix.ItemConfig.getTimeWarp();\n        }\n        let isSign = mDHF.isSignedType( ml.Item.parseRef(itemId).type );\n        this.restConnection.postProject(((reportOptions.inline && isSign)?\"signedreport/\":\"report/\") + itemId, reportOptions).done(function (result) {\n            res.resolve(result);\n        });\n\n        return res;\n    }\n\n\n    canLaunchReport(): JQueryDeferred<XRGetProject_AllJob_JobsWithUrl> {\n        return <any>this.restConnection.getServer(\"all/job\");\n    }\n\n    startCreateDocumentAsync(itemId: string, reportOptions: IReportOptions): JQueryDeferred<XRPostProject_LaunchReport_CreateReportJobAck> {\n        var res = $.Deferred();\n        reportOptions[\"url\"] = globalMatrix.matrixBaseUrl;\n        reportOptions[\"resturl\"] = globalMatrix.matrixRestUrl;\n        let isSign = mDHF.isSignedType( ml.Item.parseRef(itemId).type );\n        this.restConnection.postProject((isSign?\"signedreport/\":\"report/\") + itemId, reportOptions).done(function (result:XRPostProject_LaunchReport_CreateReportJobAck) {\n            res.resolve(result);\n        });\n\n        return <any>res;\n    }\n\n    getReportDetails(jobId: number): JQueryDeferred<XRGetProject_JobStatus_JobsStatusWithUrl> {\n        var res = $.Deferred();\n        var fileparam = \"\";\n\n        this.restConnection.getProject(\"job/\" + jobId + fileparam).done(function (result) {\n            res.resolve(result);\n        });\n\n        return <any>res;\n    }\n\n    compareHTML( compareParams:XCPostCompareHtml ):JQueryDeferred<XRPostProject_CompareHtml_HtmlCompareResult> {\n        return <any>this.restConnection.postServer(\"all/compareHtml\", compareParams);\n    }\n\n    download(jobId:number, file:number, param:string[]):void {\n        var fileparam = \"/\" + file;\n        this.restConnection.download(\"job/\" + jobId + fileparam, param);\n    }\n\n    downloadFromUrl(url:string, param?:IStringMap):void {\n        this.restConnection.download(url, param);\n    }\n    downloadInMemory(jobId:number, file:string, dataType?:string):JQueryDeferred<string> {\n        var res = $.Deferred();\n        var fileparam = \"/\" + file;\n        this.restConnection.getFile(\"job/\" + jobId + fileparam, dataType).done(function (result) {\n            res.resolve(result);\n        });\n\n        return <any>res;\n    }\n    downloadInMemoryFromUrl(url:string):JQueryDeferred<string> {\n        var res = $.Deferred();\n        this.restConnection.getFile(url).done(function (result) {\n            res.resolve(result);\n        });\n\n        return <any>res;\n    }\n    getType(itemId:string):string {\n        if(this.dbCache)\n        {\n            return this.dbCache.getType(itemId);\n        }\n        return \"_\";\n    }\n\n    touchAsync(itemId:string, depth:number, comment:string):JQueryDeferred<string> {\n        return <any>this.restConnection.putProject(\"touch/\" + itemId, { reason:comment, nbLayers:depth}, itemId);\n    }\n\n    getIcon(itemId:string):string {\n        return  this.dbCache.getIcon(itemId);\n    }\n\n    private parseSearchResult( needle:XRTrimNeedleItem ,fieldList?:string):ISearchResult {\n        let fullitem = ml.Item.parseRef(needle.itemOrFolderRef);\n        let sr:ISearchResult = {\n            itemId: fullitem.id, version:fullitem.version, title: needle.title, downlinks:[],  uplinks:[],  labels:[]};\n        if ( fieldList &&  fieldList.length>0) {\n            sr.fieldVal = needle.fieldVal;\n        }\n        if (needle.downLinkList) {\n            $.each( needle.downLinkList, function(idx,link) {\n                sr.downlinks.push(ml.Item.parseRef(link.itemRef).id);\n            });\n        }\n        if (needle.upLinkList) {\n            $.each( needle.upLinkList, function(idx,link) {\n                sr.uplinks.push(ml.Item.parseRef(link.itemRef).id);\n            });\n        }\n        if (needle.labels) {\n            let labels = needle.labels.split(\",\");\n            $.each( labels, function(idx,label) {\n                sr.labels.push(label.substr(1, label.length-2));\n            });\n        }\n        return sr;\n    }\n\n    searchAsyncMinimalOutput(term: string, filter?: string, ignoreFilters?: boolean, crossProject?:string):JQueryDeferred<string[]>{\n        var res = $.Deferred();\n        // Add the minimal outputMode flag\n        var params:XCGetNeedleMinimal= { search : term};\n\n        if ( !ignoreFilters && filter && filter.length > 0) {\n            params.filter = filter;\n        }\n        else{\n                var labelFilter = ml.LabelTools.getFilter();\n            if (!ignoreFilters && labelFilter && labelFilter.length > 0) {\n                params.filter = labelFilter;\n            }\n        }\n\n        if (params.search.length > 0) {\n            if (crossProject) {\n\n                this.restConnection.postServer(crossProject + \"/needleminimal\",  params, true).done(function (result: XRGetProject_NeedleMinimal_StringList) {\n                    res.resolve(result);\n                }).fail(function (jqxhr, textStatus, error) {\n                    res.reject(jqxhr, textStatus, error);\n                });\n            } else {\n\n                    this.restConnection.postProject(\"needleminimal\", params, true ).done(function (result: XRGetProject_NeedleMinimal_StringList) {\n                        res.resolve(result);\n                    }).fail( function(jqxhr, textStatus, error) {\n                    res.reject(jqxhr, textStatus, error);\n                    });\n                }\n\n        } else {\n            res.reject();\n        }\n\n        return <JQueryDeferred<string[]>> res;\n    }\n    searchAsync(term:string, filter?:string, ignoreFilters?:boolean, fieldList?:string, crossProject?:string, labels?:boolean, down?:boolean, up?:boolean, treeOrder?:boolean):JQueryDeferred<ISearchResult[]> {\n        let that = this;\n\n        var res = $.Deferred();\n        var params:XCGetNeedle = {   search: term, id : \"\" };\n\n        if (ignoreFilters && filter && filter.length > 0) {\n            params.filter=  filter;\n        }\n        else{\n            var labelFilter = ml.LabelTools.getFilter();\n            if (!ignoreFilters && labelFilter && labelFilter.length > 0) {\n                params.filter = labelFilter;\n            }\n        }\n\n\n        if ( fieldList &&  fieldList.length>0) {\n            params.fieldsOut = fieldList ;\n        }\n        if (treeOrder) {\n            params.treeOrder= 1 ;\n        }\n        if (labels) {\n            params.labels = 1 ;\n        }\n        if (down && up) {\n            params.links = \"up,down\";\n        } else if ( down ) {\n            params.links  = \"down\" ;\n        } else if (up) {\n            params.links  = \"up\";\n        }\n\n        if (globalMatrix.ItemConfig.getTimeWarp()) {\n            params.atDate = globalMatrix.ItemConfig.getTimeWarp();\n        }\n\n        if (params) {\n            if (crossProject) {\n                this.restConnection.postServer(crossProject + \"/needle\",  params, true).done(function(result: XRGetProject_Needle_TrimNeedle) {\n                    var hoi:ISearchResult[] = [];\n                    for (var idx = 0; idx < result.needles.length; idx++) {\n                        hoi.push( that.parseSearchResult(result.needles[idx], fieldList));\n                    }\n                    res.resolve(hoi);\n                }).fail( function(jqxhr, textStatus, error) {\n                res.reject(jqxhr, textStatus, error);\n                });\n            } else {\n                this.restConnection.postProject(\"needle?\", params,true).done(function(result: XRGetProject_Needle_TrimNeedle) {\n                    var hoi:ISearchResult[] = [];\n                    for (var idx = 0; idx < result.needles.length; idx++) {\n                        hoi.push( that.parseSearchResult(result.needles[idx], fieldList));\n                    }\n                    res.resolve(hoi);\n                }).fail( function(jqxhr, textStatus, error) {\n                res.reject(jqxhr, textStatus, error);\n                });\n            }\n        } else {\n            res.reject();\n        }\n        return <any>res;\n    }\n\n\n    getVersionAsync(itemId:string, version:number,  includeHistory?:boolean):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        if (this.dbCache.isFolder(itemId)) {\n            res.resolve();\n        } else {\n            let history = includeHistory?\"?history=true\":\"\";\n            this.restConnection.getProject(\"item/\" + itemId + \"-v\" + version + history).done(function (result:XRGetProject_ItemDetail_TrimItem) {\n                //TODO update tree (e.g if title changed or parent?)\n                var item = that.parseItemJSON(itemId, result);\n                res.resolve(item);\n            }).fail(function (error) {\n                res.reject(error);\n            });\n        }\n        return res;\n    }\n    // get an item from another project\n    getProjectVersionAsync(project:string, itemId:string, version:number, includeHistory?:boolean):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        if (this.dbCache.isFolder(itemId)) {\n            res.resolve();\n        } else {\n            let history = includeHistory?\"?history=true\":\"\";\n            this.restConnection.getServer( project + \"/item/\" + itemId + \"-v\" + version + history).done(function (result:XRGetProject_ItemDetail_TrimItem) {\n                var item = that.parseItemJSON(itemId, result);\n                res.resolve(item);\n            }).fail(function (error) {\n                res.reject(error);\n            });\n        }\n        return res;\n    }\n    // get /cat from another project\n    getProjectCat(project:string):JQueryDeferred<XRGetProject_CategoryList_GetProjectStructAck> {\n        var res = $.Deferred();\n        this.restConnection.getServer(project + \"/cat\").done(function(result: XRGetProject_CategoryList_GetProjectStructAck) {\n            res.resolve(result);\n        }).fail(function (error) {\n            res.reject(error);\n        });\n        return <any>res;\n    }\n\n    getAuditLogAsync(startAt: number, maxResults: number, param: XCGetProjectAudit): JQueryDeferred<XRGetProject_ProjectAudit_TrimAuditList> {\n        if (!param) {\n            param = {};\n        }\n        param.startAt = startAt;\n        param.maxResults = maxResults;\n\n        return <any>this.restConnection.getProject(\"audit\" + \"?\" + $.param(param, true));\n    }\n    getAuditDetailsAsync(auditId?:number):JQueryDeferred<XRTrimAudit> {\n        var res = $.Deferred();\n\n        let param = {\n            auditIdMin:auditId,\n            auditIdMax:auditId,\n            tech:\"yes\",\n            resolveRef:1\n        }\n        this.restConnection.getProject(\"audit\" + \"?\" + $.param(param, true)).done( function( auditDetails:XRGetProject_ProjectAudit_TrimAuditList) {\n            if (auditDetails.audit && auditDetails.audit.length ===1) {\n                res.resolve(auditDetails.audit[0]);\n            } else {\n                res.reject(\"no audit details with this number\");\n            }\n\n        }).fail(function (error) {\n            res.reject(error);\n        });\n        return <any>res;\n    }\n\n    getAvailableReportsAsync():JQueryDeferred<XRGetProject_Reports_GetReportsAck> {\n        return <any>this.restConnection.getServer(\"all/reports\");\n    }\n\n    getTree(subtreeFilter:string[]):IDB[] {\n        return this.dbCache.getTree(subtreeFilter);\n    }\n\n    getParentId(itemId:string):string {\n        return this.dbCache.getParentId(itemId);\n    }\n\n    // return a list of parents of category root\n    getCategoryBreadcrumbs(category:string):string[] {\n        return this.dbCache.getCategoryBreadcrumbs(category);\n    }\n\n    // return a list of item, parent of item, parent of parent of item...\n    getBreadcrumbs(itemId:string):string[] {\n        return this.dbCache.getBreadcrumbs(itemId);\n    }\n\n    /* set style of item / folder\n        computeFolder: 0=look (folder style from lookup)\n        computeFolder: 1=all (all children in folder have style: folder has style)\n        computeFolder: 2=any (any of the children has style: folder has style) */\n    setStyle( itemIds:string[], style:string, computeFolder:number) {\n        return this.dbCache.setStyle( itemIds, style, computeFolder)\n    }\n\n    getRootOfType(type:string):string {\n        return this.dbCache.getRootOfType(type);\n    }\n\n    hasChildren(itemId:string):boolean {\n        return this.dbCache.hasChildren(itemId);\n    }\n\n    isFolder(itemId:string):boolean {\n        return this.dbCache.isFolder(itemId);\n    }\n\n    getItemTitle(itemId:string):string {\n        return this.dbCache.getItemTitle(itemId);\n    }\n\n    isHiddenLink(itemId:string):boolean {\n        return this.dbCache.isHiddenLink(itemId);\n    }\n\n    setHiddenLink(itemId:string, hidden:number):void {\n        this.dbCache.setHiddenLink(itemId, hidden);\n    }\n\n    createItemAsync(itemJson: IItemPut, comment: string, actions: string, parentId: string, dontFailOnCleanup?:boolean): JQueryDeferred<IDBParent> {\n        let that = this;\n        var res2 = $.Deferred();\n        if (itemJson.children) {\n            let postItFolder:XCPostAddFolder = {\n                label: itemJson.title,\n                parent: parentId,\n                reason: comment};\n            for (var par in itemJson) {\n                if (!itemJson.hasOwnProperty(par))\n                    continue;\n                if (postItFolder.hasOwnProperty(par))\n                    continue;\n                if (par === \"type\")\n                    continue;\n                if (par === \"children\")\n                    continue;\n                if (par === \"title\")\n                    continue;\n                if (par === \"labels\" || par === \"linksUp\"|| par === \"linksDown\") {\n                    continue;\n                }\n                let c:string = par;\n                (<IGenericMap>postItFolder)[\"fx\" + par] =  (<IGenericMap>itemJson)[par];\n\n            }\n            if ( dontFailOnCleanup ) {\n                postItFolder.failOnCleanup = 0;\n            }\n            this.restConnection.postProject(\"folder\", postItFolder).done(function(result: XRPostProject_AddFolder_AddItemAck) {\n                //TODO GET not serial BUT complete number like REQ-4 from rest\n                itemJson.id = \"F-\" + itemJson.type + \"-\" + result.serial;\n                res2.resolve(that.dbCache.insertItem(itemJson, parentId));\n            });\n        } else {\n            let postItItem:XCPostAddItem = {\n                title: itemJson.title,\n                folder: parentId,\n                reason: comment,\n                linksUp:\"\",\n                linksDown:\"\"\n                };\n            for (var par in itemJson) {\n                if (!itemJson.hasOwnProperty(par))\n                    continue;\n                if (postItItem.hasOwnProperty(par))\n                    continue;\n                if (par === \"type\")\n                    continue;\n                if (par === \"labels\") {\n                    postItItem.labels = itemJson.labels;\n                    continue;\n                }\n                if ( par === \"linksUp\" ) {\n                    postItItem.linksUp = itemJson.linksUp;\n                    continue;\n                }\n                if (  par === \"linksDown\") {\n                    postItItem.linksDown = itemJson.linksDown;\n                    continue;\n                }\n                (<IGenericMap>postItItem)[\"fx\" + par] =  (<IGenericMap>itemJson)[par];\n            }\n            if ( dontFailOnCleanup ) {\n                postItItem.failOnCleanup = 0;\n            }\n\n            this.restConnection.postProject(\"item\", postItItem).done(function (result:XRPostProject_AddItem_AddItemAck) {\n                itemJson.id = itemJson.type + \"-\" + result.serial;\n                var idbparent = that.dbCache.insertItem(itemJson, parentId);\n                res2.resolve(idbparent);\n            });\n        }\n        return <any>res2;\n    }\n\n    signItemAsync(itemId:string, password:string, comment:string, meaning?:string ):JQueryDeferred<XRPostProject_SignItem_SignItemAck> {\n        var res = $.Deferred();\n        let signature: XCPostSignItem = {\n             password:password\n        }\n        if (meaning) {\n            signature.acceptComments = meaning;\n        }\n        this.restConnection.postProject(\"sign/\" + itemId, signature).done(function (result) {\n            res.resolve(result);\n        }).fail(function(jqxhr: IJcxhr, textStatus:string, error:string) {\n            res.reject(error);\n        });\n        return <any>res;\n    }\n\n    checkPassword(password: string): JQueryDeferred<IRestResult> {\n        return this.restConnection.postServer(\"/user/\" + matrixSession.getUser() + \"/check\", { password: password });\n    }\n\n\n    convertDocAsync(fileNo:number, comment:string, targetDocumentFolder?:string, useOriginal?:boolean):JQueryDeferred<string> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        let convert: XCPostConvertWord = {\n             fileNo:fileNo,\n             reason:comment,\n        }\n        if (useOriginal) {\n            convert.useAsField = 1;\n        }\n        if (targetDocumentFolder) {\n            convert.targetDocumentFolder = targetDocumentFolder;\n        }\n\n        this.restConnection.postProject(\"wordconvert\", convert).done(function (result) {\n            res.resolve(result);\n        }).fail(function(jqxhr: IJcxhr, textStatus:string, error:string) {\n            res.reject(error);\n        });\n\n        return <any>res;\n    }\n\n    restoreItemAsync(itemId:string, title:string, version:number, comment:string):JQueryDeferred<IRestoreItemResult> {\n        let that = this;\n        var res = $.Deferred();\n        var postIt: XCPostRestoreItem = {\n            reason: comment\n        };\n\n        var arg = itemId;\n        if (version) {\n            postIt.at = version;\n        }\n\n        this.restConnection.postProject(\"item/\" + arg, postIt).done(function(result: XRPostProject_RestoreItem_UndeleteAnswer) {\n\n            that.dbCache.deleteItem(itemId);\n            var itemJson:IItem = {title: title, id: itemId, type: ml.Item.parseRef(itemId).type};\n            that.dbCache.insertItem(itemJson, result.newParent);\n            res.resolve({itemId: itemId, version: version, response: result});\n        });\n\n        return <any>res;\n    }\n\n\n    updateItemAsync(itemJson: IItemPut, comment:string, auditAction:string, requireVersion?:number):JQueryDeferred<IItemGet> {\n        let that = this;\n\n        var res = $.Deferred();\n        var putIt: XCPutEditItem = { reason: comment};\n        if ( typeof itemJson.title !== \"undefined\") {\n            putIt.title = itemJson.title;\n        }\n        if (auditAction) {\n            putIt[\"auditAction\"] = auditAction;\n        }\n        if (requireVersion) {\n            putIt[\"currentVersion\"] = requireVersion;\n        }\n        for (var par in itemJson) {\n            if (!itemJson.hasOwnProperty(par))\n                continue;\n            if (putIt.hasOwnProperty(par))\n                continue;\n            if (par === \"type\")\n                continue;\n            if (par === \"category\")\n                continue;\n            if (par === \"links\")\n                continue;\n            if (par === \"title\")\n                continue;\n            if (par === \"id\")\n                continue;\n\n\n            if(isNaN(<any>par)){\n                // it's attribute other than a field\n                (<IGenericMap>putIt)[ par] = (<IGenericMap>itemJson)[par];\n            }else{\n                // it's a number so we assume it's a field\n                (<IGenericMap>putIt)[\"fx\" + par] =  (<IGenericMap>itemJson)[par];\n            }\n        }\n        this.restConnection.putProject(\"item/\" + itemJson.id, putIt, itemJson.id).done(function(result: XRPutProject_EditItem_TrimItem|string) {\n            if (result !== \"putEditItem | You need to set a title argument\") {\n                var item = <IItemGet>that.parseItemJSON(itemJson.id, <XRPutProject_EditItem_TrimItem>result);\n                if (that.dbCache.isFolder(itemJson.id)) {\n                    item['children'] = [];\n                }\n\n                that.dbCache.updateItem(<IItem>itemJson);\n\n                res.resolve(item);\n            } else {\n                ml.Logger.log(\"error\", \"PUT of \" + itemJson.id + \" FAILED. Error was: putEditItem | You need to set a title argument\");\n            }\n        }).fail(function () {\n            // MATRIX-3815\n            res.reject(\"saving failed\");\n        });\n\n        return res;\n    }\n\n    moveItemsAsync(itemIds:string, newFolder:string, newPosition:number, comment:string):JQueryDeferred<{}> {\n        let that = this;\n        var res = $.Deferred();\n\n        if (itemIds.indexOf(\",\") == -1 ) {\n            var putIt = {\n                reason: comment,\n                newFolder: newFolder,\n                newPosition: newPosition + 1\n            };\n            this.restConnection.putProject(\"item/\" + itemIds, putIt).done(function () {\n                that.dbCache.moveItem(itemIds, newFolder, newPosition);\n                res.resolve();\n            }).fail(function () {\n                res.reject();\n            });\n        } else {\n            let moveIt = {\n                items:itemIds,\n                reason:comment\n            }\n            this.restConnection.postProject(\"movein/\" + newFolder, moveIt).done(function () {\n                res.resolve();\n            }).fail(function () {\n                res.reject();\n            });\n        }\n\n        return res;\n    }\n\n    updateCache(newItem:IUpdateCache):void {\n        this.dbCache.insertItem(newItem.item, newItem.parent);\n    }\n\n    // replaces the target, a child inside the target or creates a new child with source\n    copyFrom(target:string, source:IDB) {\n        return this.dbCache.copyFrom(target, source);\n    }\n\n    deleteItemAsync(itemId:string, comment:string, force:boolean):JQueryDeferred<string> {\n        let that = this;\n\n        var res = $.Deferred();\n        var par: XCDeleteItem = {\n            reason: comment,\n            confirm: \"no\"\n        };\n        if (force) {\n            par.confirm = 'yes';\n        }\n        this.restConnection.deleteProjectAsync(\"item/\" + itemId, par).done(function () {\n            var parentItem = that.dbCache.getParentId(itemId);\n            that.dbCache.deleteItem(itemId);\n            res.resolve(parentItem);\n        }).fail(function () {\n            res.reject();\n        });\n\n        return <any>res;\n    }\n\n    uploadFileProjectAsync(file:IFileParam, progress:(p:IFileUploadProgress) =>  void):JQueryDeferred<{}> {\n        return this.restConnection.uploadFileProjectAsync(file, progress);\n    }\n\n    fetchFileAsync(url:string, progress:(p:IFileUploadProgress) =>  void):JQueryDeferred<{}> {\n        return this.restConnection.fetchFileAsync(url, progress);\n    }\n\n    addDownLinkAsync(fromId:string, toId:string, comment:string):JQueryDeferred<{}> {\n        var res = $.Deferred();\n        this.restConnection.postProject(\"itemlink/\" + fromId + \"/\" + toId, {reason: comment}).done(function () {\n            res.resolve();\n        }).fail(function (jqxhr, textStatus, error) {\n            res.reject(jqxhr, textStatus, error);\n        });\n        return res;\n    }\n\n    removeDownLinkAsync(fromId:string, toId:string, comment:string):JQueryDeferred<{}> {\n        var res = $.Deferred();\n        this.restConnection.deleteProjectAsync(\"itemlink/\" + fromId + \"/\" + toId, {reason: comment}).done(function () {\n            res.resolve();\n        }).fail(function () {\n            res.reject();\n        });\n        return res;\n    }\n\n    private retrieveConfigAsync():JQueryDeferred<XRProjectInfo> {\n        var res = $.Deferred<XRProjectInfo>();\n        this.restConnection.getProject(\"\").done(function(result: XRGetProject_ProjectInfo_ProjectInfo) {\n\n            ml.UI.DateTime.initDateTimeSettings();\n            globalMatrix.ItemConfig.init(result);\n            res.resolve(result);\n        });\n        return res;\n    }\n\n    private showRestError(jqxhr: IJcxhr, textStatus:string, error:string):void {\n        ml.UI.showError(\"Server connection error!\", ml.UI.getDisplayError(jqxhr,textStatus, error));\n    }\n\n    private parseItemJSON(itemId:string, result:XRPutProject_EditItem_TrimItem):IItem {\n\n        var item:IItemGet = {\n            id: itemId,\n            title: result.title,\n            type: this.dbCache.getType(itemId),\n            downLinks: [],\n            upLinks: [],\n            modDate: result.modDate,\n            isUnselected: result.isUnselected,\n            labels: result.labels ? result.labels : [],\n            maxVersion: result.maxVersion\n        };\n\n        if (result.docHasPackage) {\n            item.docHasPackage = result.docHasPackage;\n        }\n\n        if (!result.maxVersion) {\n            item.isDeleted = true;\n        }\n\n        if (result.fieldValList) {\n            for (var fieldVal in result.fieldValList.fieldVal) {\n               (<IGenericMap>item)[result.fieldValList.fieldVal[fieldVal].id.toString()] =  result.fieldValList.fieldVal[fieldVal].value;\n            }\n        }\n\n        for (var idx = 0; result.downLinkList && idx < result.downLinkList.length; idx++) {\n            var tol = result.downLinkList[idx].itemRef;\n\n            item.downLinks.push({to: ml.Item.parseRef(tol).id, title: result.downLinkList[idx].title, modDate: result.downLinkList[idx].modDate});\n        }\n\n        for (var idx = 0; result.upLinkList && idx < result.upLinkList.length; idx++) {\n            var tol = result.upLinkList[idx].itemRef;\n\n            item.upLinks.push({to: ml.Item.parseRef(tol).id, title: result.upLinkList[idx].title, modDate: result.upLinkList[idx].modDate});\n        }\n        // copy original up list\n        item.upLinkList = result.upLinkList;\n\n        if (result.availableFormats) {\n            item[\"availableFormats\"] = result.availableFormats;\n        }\n        if (result.selectSubTree) {\n            item[\"selectSubTree\"] = result.selectSubTree;\n        }\n        if (result.requireSubTree) {\n            item[\"requireSubTree\"] = result.requireSubTree;\n        }\n\n        if ( result.crossLinks ) {\n            item.crossLinks = result.crossLinks;\n        }\n\n        var hoi:IItemHistory[] = [];\n        for (var idx = 0; result.itemHistoryList && idx < result.itemHistoryList.itemHistory.length; idx++) {\n            var theAction = result.itemHistoryList.itemHistory[idx];\n            var historyInfo:IItemHistory = {\n                id: itemId,\n                user: theAction.createdByUserLogin,\n                action: theAction.auditAction,\n                version: theAction.version,\n                date: theAction.createdAt,\n                dateUserFormat: theAction.createdAtUserFormat,\n                title: theAction.title,\n                comment: theAction.reason};\n            // now use the information that undeleted items have been deleted just before\n            if (theAction.auditAction === \"undelete\") {\n                if (result.itemHistoryList.itemHistory.length > idx + 1) {\n                    var theDelete = result.itemHistoryList.itemHistory[idx + 1];\n                    if (theDelete.auditAction !== \"delete\") {\n                        historyInfo[\"deletedate\"] = theDelete.deletedAtUserFormat;\n                    }\n                }\n            }\n            hoi.push(historyInfo);\n        }\n        item['history'] = hoi;\n        return <IItem>item;\n    }\n\n}\n","\nimport { ml } from \"./../matrixlib\";\nimport { plugins } from \"./PluginManager\";\nimport type { ICategoryGroup, ICategoryGroups } from \"../../ProjectSettings\";\nimport { XRSettingType, XRCategoryAndSettingListType } from \"../../RestResult\";\nimport { mDHF } from \"./PluginManagerDocuments\";\nimport { UIToolsConstants } from \"../matrixlib/MatrixLibInterfaces\";\nimport { NavBar } from \"../UI/Components\";\nimport { IItem, IStringStringArrayMap, globalMatrix, matrixSession, app } from \"../../globals\";\n\nexport type { IDB, IDBParent, XRCategoryAndSettingListTypeExt };\nexport { DBCache };\n\ninterface ICategoryGroupDB extends ICategoryGroup { kids: IDB[] }\n\ninterface IDB {\n    children?: IDB[], id?: string, title?: string, type?: string, isUnselected?: number, background?: string, border?: string, icon?: string, iconClass?: string, version?: string, extraStyle?: string, mode?:string,\n    order?:number // for now used only for dashboards\n}\ninterface IDBParent { parent: string, position: number, item: IItem }\n\ninterface XRCategoryAndSettingListTypeExt {\n    settingList:XRSettingType[]\n   ,categoryId:number|string\n   ,categoryShort:string\n}\n\ninterface IDBCache {\n    sortChildren(itemId: string);\n    initMatrixTree(init: IDB[], includeActivity: boolean);\n    initConfigTree(init: IDB[]);\n    getTree(subtreeFilter: string[]): IDB[];\n    getParentId(itemId: string): string;\n    getCategoryBreadcrumbs(category: string);\n    getBreadcrumbs(itemId: string): string[];\n    getType(itemId: string): string;\n    getIcon(itemId: string): string;\n    setStyle(itemIds: string[], style: string, computeFolder: number);\n    setStyleRec(folder: IDB[], itemIds: string[], style: string, computeFolder: number): boolean;\n    isFolder(itemId: string): boolean;\n    getItemTitle(itemId: string): string;\n    getItemType(itemId: string): string;\n    isHiddenLink(itemId: string): boolean;\n    setHiddenLink(itemId: string, hidden: number): void;\n    hasChildren(itemId: string): boolean;\n    doesExist(itemId: string): boolean;\n    insertItem(itemJson: IItem, parentId: string): IDBParent;\n    copyFrom(target: string, source: IDB): boolean;\n    getRootOfType(category: string): string;\n    deleteItem(itemId: string): IDB;\n    moveItem(itemId: string, newFolder: string, newPosition: number);\n    updateItem(itemJson: IItem): void;\n    getChildrenIds(parentId: string): string[];\n    getItemFromCache(itemId: string): IDB;\n}\n\nclass DBCache implements IDBCache {\n\n    private db:IDB[] = [];\n    private activities:IDB[] = [];\n    private groupPos:number;\n    private groupDefintion:ICategoryGroups;\n    private breadCrumbs:IStringStringArrayMap = {};\n\n    constructor() {\n\n    }\n\n    protected createVirtualFolder(id:string, title:string, icon?:string, color?:string ) {\n        let folder:IDB = {children: [],\n            iconClass:icon?icon:\"\",\n            id: id,\n            title: title,\n            type: \"_\" + id\n        };\n        let cst:XRCategoryAndSettingListTypeExt = {\n            settingList: [{\n                  key: \"texticon\",\n                  value: JSON.stringify({\n                      color: color ? color : UIToolsConstants.CIColorsGrey.G3_GreyDark.color,\n                      text: id}),\n                  secret:false\n              }],\n              categoryId: id,\n              categoryShort: \"_\" +id\n      };\n        globalMatrix.ItemConfig.addCategorySetting(<XRCategoryAndSettingListType>cst);\n      return folder;\n    }\n\n    protected createVirtualItem(order:number, id:string, title:string, icon?:string ) {\n        let item:IDB = {\n            iconClass:icon?icon:\"\",\n            id: id,\n            title: title,\n            type: \"_\" + id,\n            order:order\n        };\n        return item;\n    }\n\n\n    sortChildren( itemId:string ) {\n        let obj:IDB = this.findInDB(this.db, itemId);\n        if (!obj || !obj.children  || obj.children.length ==0) {\n            // nothing to sort\n            return;\n        }\n\n        obj.children.sort( function(a:IDB,b:IDB) { return a.title < b.title?-1:1;});\n    }\n    async initMatrixTree(init: IDB[], includeActivity: boolean) {\n        let that = this;\n\n        // a cache for breadcrumbs\n        this.breadCrumbs = {};\n\n        // create the nodes for the WORK tab\n        let myWork: IDB = this.createVirtualFolder(\"MYWORK\", \"My Work\");\n\n        let dashboards: IDB = this.createVirtualFolder(\"DASHBOARDS\", \"Dashboards\");\n\n        let tools: IDB = this.createVirtualFolder(\"TOOLS\", \"Tools\");\n\n        let qms: IDB = this.createVirtualFolder(\"QMS\", \"QMS\");\n\n        let auditTools: IDB = this.createVirtualFolder(\"AUDIT\", \"Audit Tools\");\n\n        let connectionTools: IDB = this.createVirtualFolder(\"ADDONS\", \"Add Ons\");\n\n        let branches: IDB = this.createVirtualFolder(\"BRANCHES\", \"Branching\");\n        let imports: IDB = this.createVirtualFolder(\"COMPOSE\", \"Compose\");\n\n        let otherTools: IDB = this.createVirtualFolder(\"OTHER\", \"Other\");\n        let drawers = [myWork, auditTools, branches, imports, dashboards, connectionTools, tools, otherTools, qms];\n\n        //\n        if (includeActivity) {\n\n            if (!globalMatrix.ItemConfig.getTimeWarp()) {\n                auditTools.children.push(this.createVirtualItem(2000, \"DELETED\", \"Deleted Items\", \"fal fa-trash\"));\n            }\n            if (matrixSession.hasAgileSync() && !globalMatrix.ItemConfig.getTimeWarp()) {\n                connectionTools.children.push(this.createVirtualItem(1000, \"SYNC\", \"Agile Sync\", \"fal fa-sync-alt\"));\n            }\n            ;\n            if (app.auditTrailAvailable()) {\n\n                auditTools.children.push(this.createVirtualItem(4000, \"TAGS\", \"Tags\", \"fal fa-tags\"));\n\n                auditTools.children.push(this.createVirtualItem(1000, \"CHANGES\", \"Changes\", \"fal fa-calendar-alt\"));\n\n                if (matrixSession.hasDocs() && !globalMatrix.ItemConfig.getTimeWarp()) {\n                    auditTools.children.push(this.createVirtualItem(5000, \"DOCS\", \"Document Changes and Downloads\", \"fal fa-file-alt\"));\n                }\n                if (matrixSession.hasDocs() && !globalMatrix.ItemConfig.getTimeWarp()) {\n                    myWork.children.push(this.createVirtualItem(3000, \"MYDOCS\", \"My Signatures\", \"fal fa-file-signature\"));\n                }\n            }\n\n            let toolIcons = [\"utensil-knife\", \"shovel-snow\", \"hammer\", \"screwdriver\", \"axe\", \"shovel\", \"knife-kitchen\"];\n\n            let pages = await plugins.getProjectPages();\n            for (let page of pages) {\n\n                // default place for addons = TOOLS\n                page.folder = page.folder ? page.folder : \"OTHER\";\n                page.folderTitle = page.folderTitle ? page.folderTitle : \"Other Tools\";\n                let targets = drawers.filter(function (d) {\n                    return d.id == page.folder;\n                });\n                if (targets.length == 0) {\n                    let targetFolder: IDB = that.createVirtualFolder(page.folder, page.folderTitle);\n                    drawers.push(targetFolder);\n                    targets = [targetFolder];\n                }\n                targets[0].children.push(that.createVirtualItem(page.order, page.id, page.title, page.icon ? page.icon : (\"fal fa-\" + toolIcons[idx % toolIcons.length])));\n            }\n        }\n\n        if ((typeof mDHF !== \"undefined\" || includeActivity) && app) {\n            // remove the empty drawers\n            drawers = drawers.filter(function (d) {\n                return d.children.length > 0;\n            });\n            // sort the items in the drawer\n            $.each(drawers, function (dIdx, drawer) {\n                drawer.children.sort(function (tool1, tool2) {\n                    if (tool1.order < tool2.order) return -1;\n                    if (tool1.order > tool2.order) return 1;\n                    if (tool1.id < tool2.id) return -1;\n                    if (tool1.id > tool2.id) return 1;\n                    return 0;\n                });\n            });\n            // add to navbar\n            if (NavBar.isEnabled()) {\n                let folderNames: string[] = [];\n                $.each(drawers, function (dIdx, drawer) {\n                    that.db.push(drawer);\n                    folderNames.push(drawer.id);\n                });\n                NavBar.setWorkFolders(folderNames);\n            } else {\n                let work: IDB = this.createVirtualFolder(\"TOOLS\", \"Tools\");\n                work.children = drawers;\n\n                // add to project folder\n                this.db.push({\n                    children: [work],\n                    icon: \"projectw.png\",\n                    id: \"F-PROJECT\",\n                    title: (mDHF && mDHF.getToolFolderName()) ? mDHF.getToolFolderName() : \"Project, Reports & Controlled Documents\",\n                    type: \"_PROJECT\"\n                });\n            }\n\n        }\n\n        this.groupDefintion = globalMatrix.ItemConfig ? globalMatrix.ItemConfig.getCategoryGroupConfig() : null;\n        if (this.groupDefintion) {\n            $.each(this.groupDefintion.groups, function (gidx: number, group: ICategoryGroupDB) {\n                // MATRIX-1557 delete group kids cache\n                group.kids = null;\n            });\n        }\n        this.groupPos = this.db.length; // default pos for groups\n\n        // add all items not in a group\n        for (var idx = 0; idx < init.length; idx++) {\n            if (typeof mDHF !== \"undefined\" && mDHF.isDocumentType(init[idx].type) && mDHF.showInProjectFolder(init[idx].type) && !NavBar.isEnabled()) {\n                this.db[0].children.push(init[idx]);\n            } else {\n                var inGroup = false;\n                if (this.groupDefintion) {\n                    // casting group from definition to allow to add kids\n                    $.each(this.groupDefintion.groups, function (gidx: number, group: ICategoryGroupDB) {\n                        // [{\"name\":\"Design Input\", \"color\":\"brown\",\"text\":\"DI\", \"categories\":[\"DI1\",\"DI2\",\"DI3\",\"DI3\"]}]\n                        if (!group.kids) {\n                            group.kids = [];\n                        }\n                        if (group.categories.indexOf(init[idx].type) !== -1) {\n                            inGroup = true;\n                            group.kids.push(init[idx]);\n                        }\n                    });\n                }\n                if (!inGroup) {\n                    this.db.push(init[idx]);\n                }\n            }\n        }\n        // insert groups\n        if (this.groupDefintion) {\n            var autoPos = 0; // in case there is no position specified\n            // casting group to allow to add DB items\n            $.each(this.groupDefintion.groups, function (gidx: number, group: ICategoryGroupDB) {\n                //         [{\"name\":\"Design Input\", \"color\":\"brown\",\"text\":\"DI\", \"categories\":[\"DI1\",\"DI2\",\"DI3\",\"DI3\"],\"helpPage\":\"www.matrixreq.com\"}]\n                var gi: IDB = {\n                    children: group.kids,\n                    icon: \"project.png\",\n                    id: \"F-\" + group.text,\n                    title: group.name,\n                    type: \"_\" + group.text\n                };\n                var position = that.groupPos + (group.position ? group.position : autoPos);\n                autoPos++;\n                if (position >= that.db.length) {\n                    that.db.push(gi);\n                } else {\n                    that.db.splice(position, 0, gi);\n                }\n                let cst: XRCategoryAndSettingListTypeExt = {\n                    settingList: [{\n                        key: \"texticon\",\n                        value: JSON.stringify({\n                            color: group.color,\n                            text: group.text\n                        }),\n                        secret: false\n                    }],\n                    categoryId: \"_\" + group.text,\n                    categoryShort: \"_\" + group.text\n                }\n                globalMatrix.ItemConfig.addCategorySetting(<XRCategoryAndSettingListType>cst);\n            });\n        }\n        plugins.filterProject(this.db);\n\n    }\n\n    initConfigTree(init:IDB[]) {\n        let that = this;\n\n        // add all items not in a group\n        for (var idx = 0; idx < init.length; idx++) {\n            this.db.push(init[idx]);\n        }\n\n    }\n\n    /** getTree returns a tree or a sub tree of the project.\n     * this call is synchronous. The database tree is created once during the\n     * initialization and filtered after as needed.\n     *\n     * @param {type} subtreeFilter\n     * @returns tree object\n     */\n    getTree(subtreeFilter:string[]):IDB[] {\n\n        if ((typeof subtreeFilter) === 'undefined' || subtreeFilter.length === 0)\n        {\n            return this.db;\n        }\n        var st:IDB[] = [];\n        for (var idx = 0; idx < this.db.length; idx++) {\n            if (subtreeFilter.indexOf(this.db[idx].type) !== -1) {\n                st.push(this.db[idx]);\n            }\n            if (this.db[idx].type[0] === \"_\") {\n                // also look in project filter. There are some 'hidden' trees like REPORT, ECO, CAPA, SIGN...\n                // examples of these meta folders are _PROJECT\n                var stree = this.db[idx].children;\n                for (var sdx = 0; sdx < stree.length; sdx++) {\n                    if (subtreeFilter.indexOf(stree[sdx].type) !== -1) {\n                        st.push(stree[sdx]);\n                    }\n                }\n            }\n        }\n\n        return st;\n    }\n\n    getParentId(itemId:string):string {\n        return this.findParentId(this.db, itemId);\n    }\n\n    // this is actually really expensive (it's a depth first search, so for category roots we cache the results)\n    getCategoryBreadcrumbs( category:string ) {\n        if (!this.breadCrumbs[category]) {\n            this.breadCrumbs[category] = this.getBreadcrumbs(\"F-\" + category + \"-1\")\n        }\n        return this.breadCrumbs[category];\n    }\n\n    // this is actually really expensive (it's a depth first search, so for category roots we cache the results)\n    getBreadcrumbs(itemId:string):string[] {\n        let all = [itemId];\n        this.findParentId(this.db, itemId, all);\n        return all;\n    }\n\n    getType(itemId:string):string {\n        var ir = ml.Item.parseRef(itemId);\n        if (ir.type !== \"\") {\n            return ir.type;\n        }\n        // otherwise the id is not a normal id, but something special, like \"-1\" for \"Deleted items... ask the DB\n        var obj:IDB = this.findInDB(this.db, itemId);\n        if (obj && obj.type) {\n            return obj.type;\n        }\n        // no idea...\n        return \"\";\n    }\n\n    getIcon(itemId:string):string {\n        var obj:IDB = this.findInDB(this.db, itemId);\n        if (obj && obj.icon) {\n            return obj.icon;\n        }\n        return null;\n    }\n\n    /* set style of item / folder\n        computeFolder: 0=look (folder style from lookup)\n        computeFolder: 1=all (all children in folder have style: folder has style)\n        computeFolder: 2=any (any of the children has style: folder has style) */\n    setStyle( itemIds:string[], style:string, computeFolder:number) {\n        this.setStyleRec( this.db,itemIds, style, computeFolder );\n    }\n    setStyleRec( folder:IDB[], itemIds:string[], style:string, computeFolder:number):boolean {\n        let that = this;\n        let allOrAny = computeFolder==1?true:false;\n\n        $.each( folder, function(idx, idb) {\n\n            if ( idb.children ) {\n                if (idb.children.length==0 && computeFolder==1) {\n                    allOrAny = false;\n                } else {\n                    // a folder\n                    let children = that.setStyleRec( idb.children, itemIds, style, computeFolder);\n                    let color = false;\n                    switch (computeFolder) {\n                        case 0: color = itemIds.indexOf(idb.id)!=-1; break;\n                        case 1: allOrAny = allOrAny && children; color = children; break;\n                        case 2: allOrAny = allOrAny || children; color = children; break;\n                    }\n                    if (color && (idb.children.length||computeFolder==0)) { idb.extraStyle = style; };\n                }\n            } else {\n                // an item\n                if (itemIds.indexOf(idb.id)!=-1) {\n                    idb.extraStyle = style;\n                    if (computeFolder == 2) {\n                        allOrAny = true;\n                    }\n                } else  if (computeFolder == 1){\n                    allOrAny = false;\n                }\n            }\n        });\n\n        return allOrAny;\n    }\n\n    isFolder(itemId:string):boolean {\n        var obj = this.findInDB(this.db, itemId);\n        if (!obj)\n            return false;\n        return  obj.children ? true : false;\n    }\n\n    getItemTitle(itemId:string):string  {\n        var obj = this.findInDB(this.db, itemId);\n        if (!obj)\n            return globalMatrix.ITEM_DOES_NOT_EXIST;\n        return  obj.title;\n    }\n    getItemType(itemId:string):string  {\n        var obj = this.findInDB(this.db, itemId);\n        if (!obj)\n            return globalMatrix.ITEM_DOES_NOT_EXIST;\n        return  obj.type;\n    }\n    isHiddenLink(itemId:string):boolean {\n        var obj = this.findInDB(this.db, itemId);\n        if (!obj)\n            return true;\n        return  obj.isUnselected && obj.isUnselected === 1;\n    }\n\n    setHiddenLink(itemId:string, hidden:number):void {\n        var obj = this.findInDB(this.db, itemId);\n        if (obj)\n            obj.isUnselected = hidden;\n    }\n\n    hasChildren(itemId:string):boolean {\n        var children = this.findInDB(this.db, itemId).children;\n        return (children && children.length > 0);\n    }\n\n    doesExist(itemId:string):boolean {\n        var obj = this.findInDB(this.db, itemId);\n        return obj ? true : false;\n    }\n\n    insertItem(itemJson:IItem, parentId:string):IDBParent {\n\n        if (typeof parentId !== 'undefined') {\n            var parent = this.findInDB(this.db, parentId);\n            if (!itemJson.type) {\n                itemJson.type = parent.type;\n            }\n            parent.children.push(<IDB>itemJson);\n\n            return {parent: parentId, position: parent.children.length - 1, item: itemJson};\n        }\n        for (var idx = 0; idx < this.db.length; idx++) {\n            if (this.db[idx].type === itemJson.type) {\n                this.db[idx].children.push(<IDB>itemJson);\n                return {parent: this.db[idx].id, position: this.db[idx].children.length - 1, item: itemJson};\n            }\n        }\n        return null;\n    }\n\n    // replaces the target, a child inside the target or creates a new child with source\n    copyFrom(target:string, source:IDB):boolean {\n        var parent = this.findInDB(this.db, target);\n        // check if other tree already exists... if so replace it\n        if (!parent) {\n            ml.Logger.log(\"error\", \"cannot find parent folder in tree replacement.\");\n            return false;\n        }\n        if (parent.id === source.id) {\n            this.internalReplace(parent, source);\n            return true;\n        }\n        if (!parent.children) {\n            ml.Logger.log(\"error\", \"parent is not a folder.\");\n            return false;\n        }\n        for (var idx = 0; idx < parent.children.length; idx++) {\n            if (parent.children[idx].id === source.id) {\n                // replace child\n                this.internalReplace(parent.children[idx], source);\n                return true;\n            }\n        }\n        // create a new child and replace\n        var newChild:IDB = {id: source.id, title:\"\", type:\"\"};\n        parent.children.push(newChild);\n        this.internalReplace(newChild, source);\n        return true;\n    }\n\n\n    getRootOfType(category:string):string {\n        var groups:string[] = [];\n        var gdef: ICategoryGroups = globalMatrix.ItemConfig.getCategoryGroupConfig();\n        if (gdef) {\n            $.each(gdef.groups, function (gi, g) {\n                groups.push(\"_\" + g.text);\n            });\n        }\n        for (var idx = 0; idx < this.db.length; idx++) {\n            if (this.db[idx].type === category) {\n                return this.db[idx].id;\n            }\n            if (groups.indexOf(this.db[idx].type) !== -1) {\n                for (var j = 0; j < this.db[idx].children.length; j++) {\n                    if (this.db[idx].children[j].type === category) {\n                        return this.db[idx].children[j].id;\n                    }\n                }\n            }\n        }\n        return null;\n    }\n\n    deleteItem(itemId:string):IDB {\n        return this.deleteItemRec(this.db, itemId);\n    }\n\n    moveItem(itemId:string, newFolder:string, newPosition:number) {\n        var item = this.findInDB(this.db, itemId);\n        if (item) {\n            this.deleteItemRec(this.db, itemId);\n            this.insertAtRec(this.db, newFolder, newPosition, item);\n        }\n    }\n\n    updateItem(itemJson:IItem):void {\n        if ( typeof itemJson.title == \"undefined\") {\n            // can happen if item is only partially udpated (lables or some fields only)\n            return;\n        }\n        var item = this.findInDB(this.db, itemJson.id);\n        if (item) {\n            item.title = itemJson.title;\n        }\n    }\n\n    getChildrenIds(parentId:string):string[] {\n        var ids:string[] = [];\n        var parent = this.findInDB(this.db, parentId);\n        for (var idx = 0; idx < parent.children.length; idx++) {\n            ids.push(parent.children[idx].id);\n        }\n        return ids;\n    }\n\n    getItemFromCache(itemId:string):IDB {\n        return this.findInDB(this.db, itemId);\n    }\n\n    private internalReplace(oldItem:IDB, newItem:IDB) {\n        oldItem.children = newItem.children;\n        oldItem.icon = newItem.icon;\n        oldItem.isUnselected = newItem.isUnselected;\n        oldItem.title = newItem.title;\n        oldItem.type = newItem.type;\n    }\n\n    private findInChildren(node:IDB, itemId:string):IDB {\n        if (typeof node.children === 'undefined') {\n            return null;\n        }\n        for (var child = 0; child < node.children.length; child++) {\n            var res = this.findInDB(node.children[child], itemId);\n            if (res !== null) {\n                return res;\n            }\n        }\n        return null;\n    }\n\n    private findInDB(tree:IDB[], itemId:string):IDB;\n    private findInDB(tree:IDB, itemId:string):IDB;\n    private findInDB(tree:any, itemId:string):IDB {\n        if ((<IDB>tree).id === itemId) {\n            return tree;\n        }\n        var res = this.findInChildren(tree, itemId);\n        if (res) {\n            return res;\n        }\n        for (var idx = 0; idx < (<IDB[]>tree).length; idx++) {\n            if ((<IDB[]>tree)[idx].id === itemId) {\n                return tree[idx];\n            }\n            res = this.findInChildren(tree[idx], itemId);\n            if (res) {\n                return res;\n            }\n        }\n        return null;\n    }\n\n    // get the parent of an item or all parents if all is passed\n    private findParentId(tree:IDB, itemId:string, all?:string[]):string;\n    private findParentId(tree:IDB[], itemId:string, all?:string[]):string;\n    private findParentId(tree:any, itemId:string, all?:string[]):string {\n\n        if ((<IDB>tree).id === itemId) { // in case it is a leaf\n            return null; // should have found parent!\n        }\n        if ((<IDB>tree).children) { // in case it is a folder\n            for (var idx = 0; idx < (<IDB>tree).children.length; idx++) {\n                if ((<IDB>tree).children[idx].id === itemId) {\n                    if ( all ) {\n                        all.push((<IDB>tree).id);\n                    }\n                    return (<IDB>tree).id;\n                }\n                // maybe it is a child of it's children\n                var res = this.findParentId((<IDB>tree).children[idx], itemId, all);\n                if (res) {\n                    if ( all ) {\n                        all.push((<IDB>tree).id);\n                    }\n                    return res;\n                }\n            }\n        }\n        if ((<IDB[]>tree).length) {// in case it is a collection of folders\n            for (var idx = 0; idx < (<IDB[]>tree).length; idx++) {\n                if ((<IDB[]>tree)[idx].id === itemId) {\n                    return null;\n                }\n                var res = this.findParentId((<IDB[]>tree)[idx], itemId, all);\n                if (res) {\n                    return res;\n                }\n            }\n        }\n        return null;\n    }\n\n    private deleteItemRec(tree:IDB, itemId:string):IDB;\n    private deleteItemRec(tree:IDB[], itemId:string):IDB;\n    private deleteItemRec(tree:any, itemId:string):IDB {\n\n        if (typeof (<IDB>tree).children !== 'undefined') {\n            for (var idx = 0; idx < (<IDB>tree).children.length; idx++) {\n                if ((<IDB>tree).children[idx].id === itemId) {\n                    (<IDB>tree).children.splice(idx, 1);\n                    return tree;\n                }\n                var res = this.deleteItemRec((<IDB>tree).children[idx], itemId);\n                if (res) {\n                    return res;\n                }\n            }\n        } else if (typeof (<IDB[]>tree).length !== 'undefined') {\n            for (var idx = 0; idx < (<IDB[]>tree).length; idx++) {\n                var res = this.deleteItemRec(tree[idx], itemId);\n                if (res) {\n                    return res;\n                }\n            }\n        }\n\n        return null;\n    }\n\n    private insertAtRec(tree:IDB, newFolder:string, newPosition:number, item:IDB):boolean;\n    private insertAtRec(tree:IDB[], newFolder:string, newPosition:number, item:IDB):boolean;\n    private insertAtRec(tree:any, newFolder:string, newPosition:number, item:IDB):boolean {\n        //moveDetails:\n        // \"parentId\":sourceNode.parent.key,\n        // \"index\":sourceNode.getIndex()\n        if ((<IDB>tree) .id === newFolder) {\n            if (typeof (<IDB>tree) .children !== 'undefined') {\n                (<IDB>tree) .children.splice(newPosition, 0, item);\n                return true;\n            } else {\n                // something went wrong...\n                return false;\n            }\n        } else if (typeof (<IDB>tree) .children !== 'undefined') {\n            // this is a folder\n            for (var idx = 0; idx < (<IDB>tree) .children.length; idx++) {\n                var res = this.insertAtRec((<IDB>tree) .children[idx], newFolder, newPosition, item);\n                if (res) {\n                    return res;\n                }\n            }\n            return false;\n        } else if (typeof (<IDB[]>tree).length !== 'undefined') {\n            for (var idx = 0; idx < (<IDB[]>tree).length; idx++) {\n                var res = this.insertAtRec(tree[idx], newFolder, newPosition, item);\n                if (res) {\n                    return res;\n                }\n            }\n            return false;\n        }\n        return false;\n    }\n}\n","export * from \"./ItemForm\";\nexport * from \"./KeyboardShortcuts\";\nexport * from \"./NavigationBar\";\nexport * from \"./ProjectTree\";\nexport * from \"./ProjectList\";\nexport * from \"./ProjectViewDefines\";\nexport * from \"./ProjectView\";\nexport * from \"./SearchBox\";\nexport * from \"./ViewModeSelector\";","// -----------------------------------------------------------\n// A normal item control such as a requirements\n// -----------------------------------------------------------\n\n\nimport {\n    FieldHandlerFactory,\n    ICategoryConfig,\n    IDBParent,\n    IItemWatched,\n    mDHF,\n    MR1,\n    mTM,\n    plugins,\n    XRFieldTypeAnnotated\n} from \"../../businesslogic/index\";\nimport {IBaseControlOptions} from \"../Controls/BaseControl\";\nimport {GateControlImpl, IGate} from \"../Controls/gateControl\";\nimport {ILinkCollectionOptions} from \"../Controls/linkCollection\";\nimport {SelectMode} from \"./ProjectViewDefines\";\nimport {ml} from \"./../../matrixlib\";\nimport {TitleToolbarImpl} from \"../Controls/titleToolbar\";\n// TODO(modules): this is a hacky way to ensure the jquery $.fn.titleToolbar() func is created.\nimport \"../Controls/titleToolbar\";\nimport {\n    ICategorySettingTabs,\n    ICategorySettingTitle,\n    IDropdownGroup,\n    IDropdownOption,\n    IProjectLogo\n} from \"../../../ProjectSettings\";\nimport {XRReportType} from \"../../../RestResult\";\nimport {ItemCreationTools} from \"../Tools/ItemCreationView\";\nimport {Cleanup} from \"../../../client/plugins/beta/Cleanup\";\nimport {IDropDownButtonOption, IReportInput} from \"../../matrixlib/MatrixLibInterfaces\";\nimport {\n    app,\n    ControlState,\n    globalMatrix,\n    IBooleanMap,\n    IControlDefinition,\n    IGenericMap,\n    IItem,\n    IItemGet,\n    IItemPut,\n    IReference,\n    IStringNumberMap,\n    matrixSession\n} from \"../../../globals\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\nimport {IGateStatus} from \"../../businesslogic/FieldHandlers/GateFieldHandler\";\nimport {IFieldHandler} from \"../../businesslogic/FieldHandlers/IFieldHandler\";\n\nexport type { IItemControlOptions, ILinkType };\nexport { ItemControl };\n\ninterface IItemControlOptions extends IBaseControlOptions {\n    id?:string, control?:JQuery, type?:string, item?:IItemGet, dummyData?:{},\n    parent?:string,changed?: Function, isForm?:boolean, isItem?:boolean, isPrint?:boolean, isHistory?:number,\n    isDialog?:boolean, canEdit?:boolean, canEditLabels?:boolean, canEditTitle?:boolean\n}\n\ninterface ILinkType { type: string, name?: string, buttonName?: string, folder?: boolean, import?: boolean, required?: boolean }\n\nclass ItemControl {\n\n    private settings: IItemControlOptions ;\n    private defaultOptions:IItemControlOptions =<any> {\n        control: null, // required, no default: html node in which to paint control\n        type: null, // required, if no item is supplied\n        controlState: ControlState.FormView, // read only rendering\n        item: null, // item or null\n        dummyData: false, // fill controls with a dumy data (for form design...)\n        parent: null, // parent folder if there is one... interesting for delete button and creation\n        changed: function () {\n        } // callback to call if value changes\n    };\n    private resizeItTimer:number;\n    controls: IControlDefinition[] = [];\n    private _title = $(\"<div>\");\n    private _riders = $(\"<div>\");\n    private _outerbody = $(\"<div>\");// outerbody will contain title and body of the item.  the title might be inside the item (e.g. for print rendering)\n    private _body = $(\"<div>\");\n    private config: ICategoryConfig;\n    private title:string;\n    private links: IReference[];\n    private orginalControlState: ControlState;\n    private startEdit:boolean;\n    private duringFill:boolean;\n    private restrictUnlockTo:string[];\n    static lastTab:IStringNumberMap = {};\n    private lastIsDropDown: boolean;\n\n    constructor (options:IItemControlOptions) {\n        let that = this;\n\n        this.settings = ml.JSON.mergeOptions(this.defaultOptions, options)\n\n        this.title = \"\";\n        if (this.settings.item) {\n            try {\n                this.title = decodeURIComponent(this.settings.item.title);\n            } catch (err) {\n                this.title = this.settings.item.title;\n            }\n            if (this.settings.item.type) {\n                this.settings.type = this.settings.item.type; // overwrite,if an item has been passed\n            }\n        }\n        this.orginalControlState = this.settings.controlState;\n\n        // check if a locking label is set\n        let canUnlock = false;\n        this.restrictUnlockTo = [];\n        if ( this.settings.controlState === ControlState.FormEdit ) {\n            let ll = globalMatrix.ItemConfig.getLabelLockConfig();\n            if (ll && this.settings.item.labels) {\n                let ldefs = ml.LabelTools.getLabelDefinitions([this.settings.type]).map( function(ld) {return ld.label;});\n\n                $.each(ll.locks, function(idx, lock) {\n                    if ( that.settings.item.labels.indexOf(lock.label) !== -1 && ldefs.indexOf(lock.label)!=-1){\n                        // locking label is set...\n                        that.settings['allowlinkedit'] = that.settings.controlState == ControlState.FormEdit && ( matrixSession.getUISettings().allowAddLinkToLocked || lock.allowTraces);\n                        that.settings.controlState = ControlState.FormView;\n                        that.settings['locked'] = lock.label;\n                        that.settings['unlockers'] = lock.lockKeeper?lock.lockKeeper.map( function(keeper) { return ml.UI.SelectUserOrGroup.getGroupDisplayNameFromId( keeper );}).join(\", \"):\"\";\n\n                        let canUnlockThis = matrixSession.amIAllowedUser(lock.lockKeeper);\n                        if (canUnlockThis) {\n                            canUnlock = true;\n                            that.restrictUnlockTo.push(lock.label);\n                        }\n                    }\n                });\n\n            }\n        }\n        // initialize object\n\n        // once a SIGN has it's first signature it cannot be changed anymore\n        this.settings['isDialog'] = this.settings.controlState === ControlState.DialogCreate || this.settings.controlState === ControlState.DialogEdit;\n        this.settings['isForm'] = this.settings.controlState === ControlState.FormEdit || this.settings.controlState === ControlState.HistoryView|| this.settings.controlState === ControlState.FormView ;\n        // signed docs cannot be changed as soon as one signature was given\n        this.settings['canEditLinks'] = (this.settings.controlState === ControlState.FormEdit || this.settings.controlState === ControlState.DialogCreate || this.settings.controlState === ControlState.DialogEdit);\n        this.settings['canEdit'] = this.settings['canEditLinks'];\n\n        // besides labels....\n        this.settings['canEditLabels'] = (canUnlock || (this.settings.controlState === ControlState.FormEdit || this.settings.controlState === ControlState.DialogCreate));\n\n        // special rule for title and title bar functions: it should for example be possible to delete already signed docs if the user role allows it...\n        this.settings['canEditTitle'] = (this.settings.controlState === ControlState.FormEdit || this.settings.controlState === ControlState.DialogCreate);\n        this.settings['canDelete'] =  (this.settings.controlState === ControlState.FormEdit);\n        this.settings['isPrint'] = this.settings.controlState === ControlState.Print;\n        this.settings['isTooltip'] = this.settings.controlState === ControlState.Tooltip;\n        this.settings['id'] = this.settings.item ? this.settings.item.id : \"\";\n\n        this.links = this.settings.item ? this.settings.item.downLinks : [];\n\n        this.config = globalMatrix.ItemConfig.getItemConfiguration(this.settings.isItem ? this.settings.type : \"FOLDER\");\n\n        // prepare rendering\n        if (this.settings.isForm && this.settings.controlState != ControlState.HistoryView) {\n            $(this.settings.control).addClass(\"panel panel-default\");\n        }\n\n        // add title control to correct place and prepare it for printing\n        this.controls.push({ control: this._title, name: 'Title' });\n        if (this.settings.isPrint) {\n            var header = $(\"<table class='table-bordered printheader'></table>\");\n            var d = new Date();\n\n            header.append(\"<tr><td>\" +\n                    \"<img class='brandLogo'>\" +\n                    \"</td>\" +\n                    \"<td id='iph'></td>\" +\n                    \"<td class='reportheaderdate'>printed: \" + ml.UI.DateTime.renderHumanDate(d) + \"</td></tr>\");\n\n            var logo = globalMatrix.ItemConfig.getSetting(\"projectLogo\");\n            if (logo && logo.indexOf(\"{\") !== -1) {\n                var rjs = ml.JSON.fromString(logo);\n                    if (rjs.status === 'ok') {\n                        logo = (<IProjectLogo>rjs.value).fileId;\n                    }\n                header.find(\".brandLogo\").attr(\"src\", globalMatrix.matrixRestUrl + \"/\" + matrixSession.getProject() + \"/file/\" + logo);\n            }\n            else {\n                header.find(\".brandLogo\").attr(\"src\", globalMatrix.matrixBaseUrl + \"/static/img/logo_report.png\");\n            }\n            if (this.settings.item && !app.isFolder(this.settings.id)) {\n\n                header.append(\"<tr><td>version: \" + this.settings.item.history[0].version + \" (\" +\n                        this.settings.item.history[0].user + \")</td>\" +\n                        \"<td>comment: \" + this.settings.item.history[0].comment + \"</td>\" +\n                        \"<td class='reportheaderdate'>created: \" + this.settings.item.history[0].dateUserFormat + \"</td></tr>\"\n                        );\n\n            }\n            $(\"#iph\", header).append(this._title);\n            this.settings.control.append(header);\n        }\n\n        if (this.settings.isForm && this.settings.controlState != ControlState.HistoryView) {\n            this._title.addClass(\"panel-heading\");\n            this.settings.control.append(this._title);\n\n            this.settings.control.append(this._outerbody);\n            this._outerbody.on(\"scroll\", () => { $(\".tox-pop\").remove(); });\n            this._outerbody.addClass(\"panel-body-v-scroll\").addClass(\"enabledd\");\n            this._body.addClass(\"panel-body\");\n\n        } else { // isDialog or isPrint\n            this.settings.control.append(this._outerbody);\n            if (this.settings.controlState == ControlState.HistoryView) {\n                this._outerbody.append($(\"<div class='baseControlHelp'>Title</div>\"));\n            }\n            if (!this.settings.isPrint) {\n                this._outerbody.append(this._title);\n            }\n            this._outerbody.on(\"scroll\", () => { $(\".tox-pop\").remove(); });\n            this._outerbody.addClass(\"panel-body-v-scroll\").addClass(\"enabledd\");\n        }\n\n        this.addTabs();\n\n        this._outerbody.append(this._body);\n\n        // create content controls\n        this.lastIsDropDown = false;\n        var list = this.config.fieldList;\n        for (var idx = 0; idx < list.length; idx++) {\n            var ctrl = $(\"<div>\");\n            this._body.append(ctrl);\n            this.controls.push({control: ctrl, name: list[idx].label, fieldId: list[idx].id});\n            this.lastIsDropDown = list[idx].fieldType ==  FieldDescriptions.Field_dropdown;\n        }\n        // add special this.controls, e.g. to create items in folders, or reference list or report buttons\n        // these exist only if these are not special items\n        if (this.settings.controlState != ControlState.HistoryView) {\n            var handled = plugins.renderActionButtons(this.settings, this._body, this.controls);\n\n            if (!handled) {\n                handled = mTM.RenderActionButtons(this.settings, this._body);\n            }\n\n            if (!handled) {\n                if (!handled && this.settings.type.toLowerCase() === \"report\") {\n                    this.renderActionButtonsReport();\n                } else if (!this.settings.isItem && this.settings.controlState === ControlState.FormEdit &&\n                    !globalMatrix.ItemConfig.getCategorySetting(this.settings.type, \"syncInfo\") &&\n                    !app.getImportSource( this.settings.item ))\n                    {\n                    // a normal folder\n                    // add button to create a new folder of this kind\n                    var lt:ILinkType[] = [{type: this.settings.item.type, name: \"Folder\", folder: true}];\n                    // add button to create an item of this kind\n                    var itemTypeName = globalMatrix.ItemConfig.getItemConfiguration(this.settings.item.type).label;\n                    lt.push({type: this.settings.item.type, name: itemTypeName});\n\n                    let controlContainer = $(\"<div class='baseControl'></div>\");\n                    // add buttons to UI\n                    controlContainer.append($(\"<span class='baseControlHelp'>Tools</span>\"));\n                    var folderEdit = $(\"<div class='hidden-print baseControl rowFlex'></div>\");\n                    controlContainer.append(folderEdit);\n\n                    this._body.append(controlContainer);\n\n                    var createTools = new ItemCreationTools();\n                    createTools.renderButtons({\n                        parent: this.settings.item.id,\n                        dontOpenNewItem:false,\n                        control: folderEdit,\n                        linkTypes: lt,\n                        type:that.settings.type});\n\n                }\n            }\n        }\n    }\n    async load(){\n       await this.fillControls()\n        if (!this.settings.isPrint && !this.settings.isTooltip) {\n            this.sendNeedsSave();\n            if ( this.lastIsDropDown && this.settings.canEdit ) {\n                this._body.css(\"padding-bottom\", \"200px\");\n            }\n        }\n        // hide stuff and after a little timeout to allow to show richtext2, hide again\n        this.showTab();\n        window.setTimeout( () => {\n            this.showTab();\n        },501);\n        // to enable dropdown menus at end to open completely\n        this.resizeItem();\n    }\n    // initialize options\n\n    // public interface\n    destroy() :void {\n\n        for (var idx = 0; idx < this.controls.length; idx++) {\n            if (this.controls[idx].control.getController().destroy) {\n                this.controls[idx].control.getController().destroy();\n            }\n        }\n    }\n\n    async getValues(update: IItemPut, latest?: IItemGet): Promise<IItemPut> {\n\n        for (var idx = 0; idx < this.controls.length; idx++) {\n            if (this.controls[idx].fieldId && this.getFieldType(this.controls[idx].fieldId) !== FieldDescriptions.Field_links) {\n                if (this.controls[idx].isDhfType) {\n                    (<IGenericMap>update)[this.controls[idx].fieldId] = await mDHF.getValue(this.controls[idx]);\n                } else if (this.controls[idx].fieldType === FieldDescriptions.Field_labels) {\n                    if (this.settings.id && !app.isFolder(this.settings.id)) {\n                        if (await this.controls[idx].control.getController().getValueAsync(latest)) {\n                            var non_review_labels = JSON.parse(await this.controls[idx].control.getController().getValueAsync(latest));\n                            non_review_labels = ml.LabelTools.resetReviewLabels(non_review_labels, this.settings.type, false);\n                            update.labels = non_review_labels.join(\",\");\n                        }\n                    }\n                } else {\n                    (<IGenericMap>update)[this.controls[idx].fieldId] = await this.controls[idx].control.getController().getValueAsync(latest);\n                }\n            }\n        }\n\n        return update;\n    }\n\n    async saveAsync(category: string, auditAction: string, valueOverwrites?: IItemGet): Promise<IDBParent | IItemGet> {\n        let that = this;\n       let canSaveProceed = true;\n       for (const control of this.controls) {\n           const internalController = control.control.getController();\n           let value = await internalController.getValueAsync()\n           if (category != \"DOC\" && internalController.requiresContent && internalController.requiresContent() && value == \"\") {\n               ml.UI.showError(`Field \"${control.name}\" is empty!`,\n                   `The Project configuration requires the field ${control.name} to have a value.`);\n               canSaveProceed = false;\n           }\n           if (!Cleanup.textOk(value)) {\n               ml.UI.showError(`Field \"${control.name}\" has an invalid character!`,\n                   `Remove invalid character to save - they will look probably be rendered as boxes, like \\u0002`);\n               canSaveProceed = false;\n           }\n       }\n       if (!canSaveProceed) {\n           throw(\"Can't save\");\n       }\n       ml.SmartText.updateCaptionsAndReferences();\n\n       async function performSaveAsync(latest?: IItemGet) {\n           var res = $.Deferred();\n           let type = that.settings.type ? that.settings.type : ml.Item.parseRef(that.settings.parent).type;\n\n           await mTM.PreSaveHook(that.settings.isItem, that.settings.item, type, that.controls);\n\n           plugins.callPreSaveHook(that.settings.isItem, type, that.controls).done(async function () {\n               // create links and labels and save\n               let linksToCreate: { up: string[], down: string[] } = {up: [], down: []};\n               let labelsToSet: string[] = [];\n               for (var idx = 0; idx < that.controls.length; idx++) {\n                   if (that.controls[idx].control.getController().linksToCreate) {\n                       var lc = that.controls[idx].control.getController().linksToCreate();\n                       linksToCreate.up = linksToCreate.up.concat(lc.up);\n                       linksToCreate.down = linksToCreate.down.concat(lc.down);\n                   }\n                   // if a control decides it can trigger labels to be set\n                   if (that.controls[idx].control.getController().labelsToSet && that.controls[idx].control.getController().labelsToSet() && that.controls[idx].control.getController().labelsToSet().length > 0) {\n                       labelsToSet = labelsToSet.concat(that.controls[idx].control.getController().labelsToSet());\n                   }\n               }\n\n               if ((that.settings.isForm && that.settings.controlState != ControlState.HistoryView)\n                   || that.settings.controlState === ControlState.DialogEdit) { // an item was modified\n                   for (var idx = 0; idx < that.controls.length; idx++) {\n                       if (valueOverwrites && that.controls[idx].fieldId && valueOverwrites.hasOwnProperty(that.controls[idx].fieldId.toString())) {\n                           that.controls[idx].control.getController().setValue((<IGenericMap>valueOverwrites)[that.controls[idx].fieldId]);\n                       }\n                   }\n                   var update: IItemPut = {\n                       id: that.settings.id,\n                       title: that._title.data(\"new\"),\n                       type: that.settings.item.type\n                   };\n\n                   if (linksToCreate.up.length > 0) {\n                       update[\"linksUp\"] = linksToCreate.up.join();\n                   }\n                   if (linksToCreate.down.length > 0) {\n                       update[\"linksDown\"] = linksToCreate.down.join();\n                   }\n\n                   update = await  that.getValues(update, latest);\n\n                   if (that.settings.isItem) {\n                       if (valueOverwrites && valueOverwrites.labels) {\n                           update.labels = valueOverwrites.labels.join(\",\");\n                       }\n                   }\n\n                   // now update labels if there is something to update\n                   if (labelsToSet.length) {\n                       update.labels = ml.LabelTools.setLabels(update.labels, labelsToSet);\n                   }\n                   MR1.triggerBeforeSaveAsync(that, that.settings.item, update).done(function () {\n                       app.updateItemInDBAsync(update, auditAction, latest ? latest.history.length : that.settings.item.history.length).done(function (result) {\n                           update.maxVersion = result.maxVersion;\n                           MR1.triggerAfterSave(that, that.settings.item, update);\n                           res.resolve(result);\n                       }).fail(function (error) {\n                           res.reject(error);\n                       });\n\n                   }).fail(function () {\n                       ml.Logger.log(\"info\", \"save cancelled by MR1 script\");\n                       res.reject(\"MR1 cancelled\");\n                   });\n               } else { // an item was created\n                   var actions: string[] = [];\n                   actions.push(\"Created\");\n                   var itemJson: IItemPut = {};\n                   if (!that.settings.isItem) {\n                       itemJson[\"children\"] = []; // make it a folder\n                   }\n                   for (var idx = 0; idx < that.controls.length; idx++) {\n                       if (that.controls[idx].fieldType === FieldDescriptions.Field_labels && that.settings.isItem) {\n                           itemJson.labels = \"\";\n                           var valj = ml.JSON.fromString(await that.controls[idx].control.getController().getValueAsync());\n                           if (valj.status === \"ok\") {\n                               itemJson.labels = (<string[]>valj.value).join();\n                           }\n                       } else if (that.controls[idx].fieldId) {\n                           (<IGenericMap>itemJson)[that.controls[idx].fieldId] = await that.controls[idx].control.getController().getValueAsync();\n                       }\n                   }\n\n                   itemJson.title = that._title.data(\"new\");\n                   if (linksToCreate.up.length > 0) {\n                       itemJson.linksUp = linksToCreate.up.join();\n                   }\n                   if (linksToCreate.down.length > 0) {\n                       itemJson.linksDown = linksToCreate.down.join();\n                   }\n                   if (labelsToSet.length) {\n                       itemJson.labels = ml.LabelTools.setLabels(itemJson.labels, labelsToSet);\n                   }\n\n                   app.createItemOfTypeAsync(category, itemJson, actions.join(), that.settings.parent).done(function (result) {\n                       MR1.triggerAfterItemCreate(result);\n\n                       res.resolve(result);\n                   }).fail(function () {\n                       res.reject();\n                   });\n               }\n           }).fail(function () {\n               ml.Logger.log(\"warning\", \"plugin prevented save!\");\n               res.reject(\"plugin prevented save!\");\n               return res;\n           });\n           return res;\n       }\n\n       let needsLatest = false;\n       if (this.settings.id) {\n           // otherwise this is save during create\n           for (var idx = 0; idx < this.controls.length; idx++) {\n               if (this.controls[idx].control.getController().needsLatest) {\n                   needsLatest = true;\n               }\n           }\n       }\n\n       if (needsLatest) {\n               let latest = await app.getItemAsync(this.settings.id);\n               return performSaveAsync(latest);\n       } else {\n            return performSaveAsync();\n       }\n    }\n\n    addMove( itemId:string, newVersion:number) {\n        // fakes a history change without reloading the item, avoiding merge dialog when saving\n        if (this.settings && this.settings.id == itemId && this.settings.item  && this.settings.item.history) {\n            if (this.settings.item.history.filter( function( he ) {return he.version == newVersion;}).length==0) {\n                 // someone else moved it\n                this.settings.item.history.push( {action: \"move\",comment: \"\",date: \"\",dateUserFormat: \"\",id: itemId,title: \"\",user: \"\", // fake entry\n                version: newVersion});\n            }\n        }\n    }\n\n    resizeItem(force?:boolean) {\n        clearTimeout(this.resizeItTimer);\n        this.resizeItTimer = window.setTimeout(() => this.resizeIt(force), 299);\n    }\n\n    refreshLinks() {\n        for (var cid = 0; cid < this.controls.length; cid++) {\n            if (this.controls[cid].control.getController().refreshLinks) {\n                this.controls[cid].control.getController().refreshLinks( );\n            }\n        }\n    }\n\n     async fillControls() {\n        let that = this;\n        this.duringFill = true;\n        // prepare gate functions\n        let gateTitle = false;\n        let gated: IBooleanMap = {}; // if set to true the field will be disabled\n        for (var idx = 0; idx < this.config.fieldList.length; idx++) {\n            var fieldType = this.config.fieldList[idx].fieldType;\n\n            if (fieldType === FieldDescriptions.Field_gateControl) {\n                // get the fields value (for existing items)\n                let fv = this.settings.item ? (<IGenericMap>this.settings.item)[this.config.fieldList[idx].id] : \"{}\";\n                let fvj = <IGateStatus>(fv ? JSON.parse(fv) : {});\n                let allPassed = fvj.passed;\n                let gateConfig = <IGate>this.config.fieldList[idx].parameterJson;\n                if (gateConfig && gateConfig.allPass) {\n                    if (allPassed && gateConfig.allPass.lockAbove) {\n                        // if passed the above will be disabled\n                        for (var k = 0; k < idx; k++) gated[this.config.fieldList[k].id] = true;\n                    }\n                    if (allPassed && gateConfig.allPass.lockTitle) {\n                        gateTitle = true;\n                    }\n                    if (!allPassed && gateConfig.allPass.enableBelow) {\n                        // needs to be passed to enable the below\n                        for (var k = idx + 1; k < this.config.fieldList.length; k++) gated[this.config.fieldList[k].id] = true;\n                    }\n                } else {\n                    ml.Logger.log(\"warning\", \"badly configured gate control in \" + this.settings.type);\n                }\n            }\n        }\n\n        /** in case up or downlinks would be locked because of gate allow them */\n        if (matrixSession.getUISettings().allowAddLinkToLocked) {\n            for (var k = 0; k < this.config.fieldList.length; k++) {\n                if (this.config.fieldList[k].fieldType == FieldDescriptions.Field_uplinkinfo || this.config.fieldList[k].fieldType == FieldDescriptions.Field_links) {\n                    gated[this.config.fieldList[k].id] = false;\n                }\n            }\n        }\n\n        // render title\n        var th = <ICategorySettingTitle>globalMatrix.ItemConfig.getCategorySetting(this.settings.type, \"title\");\n        let tops = <IBaseControlOptions>ml.JSON.mergeOptions(this.settings, {\n            help: (th && th.create) ? th.create : \"Title\",\n            title: this.title,\n            valueChanged: () => that.sendNeedsSave(),\n            isFolder: app.isFolder(this.settings.id),\n            dummyData: this.settings.dummyData,\n            parameter: {\n                placeholder: (th && th.placeholder) ? th.placeholder : \"enter title\"\n            }\n        });\n        if (gateTitle) {\n            tops.canEditTitle = false;\n            tops.canDelete = false;\n            tops.canEdit = false;\n        }\n        if (!globalMatrix.ItemConfig.canEditTitle(this.settings.type)) {\n            tops.canEditTitle = false;\n        }\n        if (!globalMatrix.ItemConfig.canDelete(this.settings.type)) {\n            tops.canDelete = false;\n        }\n\n        this._title.html(\"\").titleToolbar(tops);\n\n\n        // draw UI\n        let closeControls: JQuery[] = [];\n\n        // make a lookup with controls\n        let mapControls: { [key: number]: IControlDefinition } = {};\n        for (var cid = 0; cid < this.controls.length; cid++) {\n            mapControls[this.controls[cid].fieldId] = this.controls[cid];\n        }\n\n        // go through all configured fields\n\n        // for performance hide\n        if (matrixSession.getUISettings().largeFormRender && this.config.fieldList.length > matrixSession.getUISettings().largeFormRender) {\n            this.settings.control.hide();\n        }\n\n        for (let idx = 0; idx < this.config.fieldList.length; idx++) {\n            const fieldConfig: XRFieldTypeAnnotated = this.config.fieldList[idx];\n            const fieldType = fieldConfig.fieldType;\n\n            let ui = mapControls[fieldConfig.id];\n            if (!ui) {\n                ml.Logger.log(\"warn\", `field ${fieldConfig.id} is weird...`);\n                break;\n            }\n            ui.isDhfType = false;\n            ui.fieldType = fieldType;\n\n            var fieldValue = \"\";\n            if (this.settings.item && this.settings.item[fieldConfig.id]) {\n                fieldValue = (<IGenericMap>this.settings.item)[fieldConfig.id];\n            }\n\n            // Some field types get their configuration not from the database, but elsewhere.\n            // UpdateFieldConfig modifies the fieldConfig.parameterJson object in place to\n            // include those settings.\n            FieldHandlerFactory.UpdateFieldConfig(\n                globalMatrix.ItemConfig, mTM.getConfiguration(), fieldType, this.settings.type, fieldValue, fieldConfig.parameterJson);\n\n            var handler: IFieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, fieldType, fieldConfig.parameterJson);\n            handler.initData(fieldValue);\n\n            // prepare parameter for rendering\n            var ctrlParameter = ml.JSON.mergeOptions(that.settings, {\n                parameter: fieldConfig.parameterJson,\n                fieldId: ui.fieldId,\n                canEdit: that.settings.canEdit &&\n                    app.canEditField(that.settings.type, ui.fieldId) &&\n                    !gated[ui.fieldId] &&\n                    !fieldConfig.parameterJson.readonlyACL,\n                help: fieldConfig.label,\n                fieldValue: fieldValue,  // TODO: to be removed in favor of fieldHandler\n                fieldHandler: handler,\n                fieldType: fieldType,\n                valueChanged: function () {\n                    that.sendNeedsSave(ui.fieldId, fieldConfig.label);\n                }\n            });\n\n            if ((fieldType == FieldDescriptions.Field_uplinkinfo || fieldType == FieldDescriptions.Field_links) && !ctrlParameter.canEdit) {\n                // maybe links can still be added even though the item is readonly\n                if (matrixSession.getUISettings().allowAddLinkToLocked && that.settings['allowlinkedit'] && !ctrlParameter.parameter.readonlyACL) {\n                    ctrlParameter.canEdit = true;\n                }\n                if (that.settings[\"canEditLinks\"]) {\n                    ctrlParameter.canEdit = true;\n                }\n            }\n\n            // whether there should a > to open / close section\n            let canCloseSection = that.settings.item &&\n                ctrlParameter.isItem &&\n                !ctrlParameter.isPrint &&\n                ctrlParameter.controlState != ControlState.HistoryView &&\n                ctrlParameter.isForm &&\n                mDHF &&\n                mDHF.isDocumentType(that.settings.item.type) &&\n                !ctrlParameter.parameter.forceOpen;\n\n            if (typeof ctrlParameter.parameter.visibleOption !== 'undefined') {\n                if (ml.JSON.isTrue(ctrlParameter.parameter.visibleOption)) {\n                } else if (ctrlParameter.parameter.visibleOption === this.settings.type) {\n                } else {\n                    ui.control.hide();\n                }\n            }\n\n            if (!app.canSeeField(this.settings.type, ui.fieldId)) {\n                ui.control.hide();\n            }\n\n            ui.control.html(\"\").addClass(\"controlContainer\").addClass(\"ft_\" + fieldType).attr(\"id\", \"fid_\" + ui.fieldId);\n            if (plugins.supportsControl(fieldType)) {\n                plugins.createControl(ui.control, ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_report) {\n                ui.control.plainText(ml.JSON.setOptions(ctrlParameter, {parameter: {rows: 1}}));\n                globalMatrix.EmbeddedReport(ml.JSON.setOptions(ctrlParameter, {control: ui.control}));\n            } else if (fieldType === FieldDescriptions.Field_richtext) {\n                ui.control.richText(ctrlParameter, this);\n            } else if (fieldType === FieldDescriptions.Field_publishedItemList) {\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_publishedFilesList) {\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_publishedContent) {\n                ui.control.publishedContent(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_text) {\n                ui.control.plainText(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_section) {\n                ui.control.section(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_fileManager || fieldType === FieldDescriptions.Field_signCache) {\n                ui.control.fileManager(ml.JSON.setOptions(ctrlParameter, {parameter: {titleBarControl: this._title}}));\n            } else if (fieldType === FieldDescriptions.Field_docFilter) {\n                ui.control.docFilter(ml.JSON.setOptions(ctrlParameter, {help: \"Document Filter\"}));\n            } else if (fieldType === FieldDescriptions.Field_workflow) {\n                ui.control.workflowControl(<any>ml.JSON.setOptions(ctrlParameter, {parameter: {titleBarControl: this._title}}));\n            } else if (fieldType === \"sourceRef\") {\n                // type should not exist\n                ml.Logger.log(\"warning\", \"Found obsolete type sourceRef\");\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_textline || fieldType === FieldDescriptions.Field_publishedTitle) {\n                ui.control.plainText(ml.JSON.setOptions(ctrlParameter, {parameter: {rows: 1, allowResize: false}}));\n            } else if (fieldType === FieldDescriptions.Field_signatureControl) {\n                canCloseSection = false;\n                ui.control.docSign(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_docTraining) {\n                ui.control.docTraining(<any>ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_docReview) {\n                ui.control.docReview(<any>ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_user) {\n                // Set some UI options for the user control.\n                // Data field options were already set above in FieldHandlerFactory.UpdateFieldConfig().\n                let groups: IDropdownGroup[] = null;\n                if (!ml.JSON.isFalse(ctrlParameter.parameter.showUsers) &&\n                    ml.JSON.isTrue(ctrlParameter.parameter.showGroups)) {\n                    groups = [];\n                    groups.push({value: \"groups\", label: \"groups\"});\n                    groups.push({value: \"users\", label: \"users\"});\n                }\n                if (!ctrlParameter.parameter.placeholder) {\n                    ctrlParameter.parameter.placeholder = \"select user\";\n                }\n                ctrlParameter.parameter.groups = groups;\n                ui.control.mxDropdown(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_date) {\n                ui.control.dateselect(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_dropdown) {\n                ui.control.mxDropdown(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_test_result) {\n                ctrlParameter.parameter.sort = false;\n                let placeholder = fieldValue ? fieldValue : null;\n                ctrlParameter.parameter.placeholder = mTM.getTestRunResultPlaceholder(placeholder);\n                ui.control.mxDropdown(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_links) {\n                let linkTypes = app.getLinkCategories(this.settings.item, <ILinkCollectionOptions>ctrlParameter);\n                ui.control.linkCollection(ml.JSON.setOptions(ctrlParameter, <ILinkCollectionOptions>{\n                    parameter: {\n                        linkTypes: linkTypes\n                    },\n                    fieldValue: this.links\n                }));\n            } else if (fieldType === FieldDescriptions.Field_crosslinks) {\n                ui.control.itemSelection(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_steplist ||\n                fieldType === FieldDescriptions.Field_test_steps ||\n                fieldType === FieldDescriptions.Field_test_steps_result) {\n                ui.control.tableCtrl(ctrlParameter);\n                // ui.control.tableCtrl(ml.JSON.setOptions(options, {parameter: this.getTestStepsConfig(options.type)}));\n            } else if (fieldType === FieldDescriptions.Field_risk) {\n                ui.control.riskCtrl(ml.JSON.setOptions(ctrlParameter, {\n                    links: this.links ? this.links : [] // these are the really existing downlinks (i.e. if someone deleted and item it needs to be removed as mitigation)\n                }));\n            } else if (fieldType === FieldDescriptions.Field_risk2) {\n                ui.control.riskCtrl2(<any>ml.JSON.setOptions(ctrlParameter, {\n                    links: this.links ? this.links : [] // these are the really existing downlinks (i.e. if someone deleted and item it needs to be removed as mitigation)\n                }));\n            } else if (fieldType === FieldDescriptions.Field_checkbox) {\n                canCloseSection = false;\n                ui.control.checkBox(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_htmlForm) {\n                ui.control.htmlform(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_hidden || fieldType === FieldDescriptions.Field_filter_file || fieldType === FieldDescriptions.Field_signature) {\n                canCloseSection = false;\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_hyperlink) {\n                ui.control.hyperlink(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_colorPicker) {\n                ui.control.colorPicker(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_reportId) {\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_dhf) {\n                canCloseSection = mDHF.renderControl(ui, ctrlParameter, fieldValue);\n            } else if (fieldType === FieldDescriptions.Field_sourceref) {\n                canCloseSection = !ctrlParameter.parameter.readonly;\n                ui.control.sourceRef(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_markAsTemplate) {\n                canCloseSection = !ctrlParameter.parameter.readonly;\n                ui.control.markAsTemplate(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_guid) {\n                canCloseSection = false;\n                ui.control.docGUID(ml.JSON.setOptions(ctrlParameter, {parameter: {titleBarControl: this._title}}));\n            } else if (fieldType === FieldDescriptions.Field_oid) {\n                canCloseSection = false;\n                ui.control.docOID(ml.JSON.setOptions(ctrlParameter, {parameter: {titleBarControl: this._title}}));\n            } else if (fieldType === FieldDescriptions.Field_versionLive) {\n                canCloseSection = false;\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_version) {\n                canCloseSection = false;\n                ui.control.hidden(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_currentVersion) {\n                ui.control.docVersionInfo(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_uplinkinfo) {\n                ui.control.uplinkinfo(<any>ml.JSON.setOptions(ctrlParameter, {\n                    parameter: {\n                        linkTypes: app.getLinkCategories(that.settings.item, <ILinkCollectionOptions>ctrlParameter)\n                    },\n                    fieldValue: that.settings.item ? that.settings.item.upLinks : []\n                }));\n            } else if (fieldType === FieldDescriptions.Field_labels) {\n                canCloseSection = false;\n                ctrlParameter.fieldValue = (this.settings.item && this.settings.item.labels) ? JSON.stringify(this.settings.item.labels) : \"\";\n                ui.control.labelsControl(<any>ml.JSON.setOptions(ctrlParameter, {\n                    restrictEditTo: (that.restrictUnlockTo.length ? that.restrictUnlockTo : null),\n                    canEdit: (<IItemControlOptions>ctrlParameter).canEditLabels && globalMatrix.ItemConfig.canModifyLabels(that.settings.type),\n                    parameter: {titleBarControl: this._title}\n                }));\n            } else if (fieldType === FieldDescriptions.Field_syncStatus) {\n                ui.control.syncStatus(ml.JSON.setOptions(ctrlParameter, {controlState: this.orginalControlState}));\n            } else if (fieldType === FieldDescriptions.Field_syncSourceInfo) {\n                ui.control.syncSourceInfo(ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_cascadingSelect) {\n                ui.control.cascadingSelect(<any>ctrlParameter);\n            } else if (fieldType === FieldDescriptions.Field_gateControl) {\n                ui.control.gateControl(<any>ctrlParameter);\n            } else {\n                canCloseSection = false;\n                ui.control.errorControl(ctrlParameter);\n            }\n\n            if (ctrlParameter.parameter.invisible) {\n                canCloseSection = false;\n                ui.control.hide();\n            }\n\n            if (ctrlParameter.parameter.hide_UI) {\n                if (globalMatrix.globalShiftDown && matrixSession.isAdmin()) {\n                    $(\".baseControl\", ui.control).css(\"opacity\", \"0.8\");\n                    $(\".baseControlHelp\", ui.control).css(\"opacity\", \"0.8\");\n\n                    $(\".baseControlHelp\", ui.control).text($(\".baseControlHelp\", ui.control).text() + \" (Hidden for normal user)\");\n                } else {\n                    canCloseSection = false;\n                    $(\".baseControl\", ui.control).hide();\n                    $(\".baseControlHelp\", ui.control).hide();\n\n                }\n            }\n\n            if ((that.settings.isHistory == undefined || that.settings.isHistory < 1) && canCloseSection && that.allowSectionClose(ui, ctrlParameter)) {\n                closeControls.push($(\".baseControl\", ui.control));\n                $(\".baseControl\", ui.control).hide();\n            }\n        }\n\n        // undo performance hide\n        this.settings.control.show();\n\n        setTimeout(function (ctrlsToHide: JQuery[]) {\n            for (var idx = 0; idx < ctrlsToHide.length; idx++) {\n                // weird if controls are hidden only once tables like audit trail are fcked up\n                ctrlsToHide[idx].hide();\n                ctrlsToHide[idx].show();\n                ctrlsToHide[idx].hide();\n            }\n        }, 10, closeControls);\n\n        setTimeout(function () {\n            if (that.settings.item && that.settings.isForm && that.settings.controlState != ControlState.HistoryView) {\n                MR1.triggerItemDisplayed(that.settings.item, that);\n            }\n            if (!that.settings.item && that.settings.isDialog) {\n                MR1.triggerItemCreate(that, that.settings.isItem, that.settings.type);\n            }\n        }, 20);\n\n        this.duringFill = false;\n    }\n\n    async needsSave() {\n        return await this.needsSaveImpl();\n    }\n\n    async hasTitle() {\n        let title = await this._title.getController().getValueAsync();\n        return (title && title != \"\");\n    }\n\n    updateItem(newItem:IItem):void {\n        if (this.settings.id === newItem.id ) {\n            for (var cid = 0; cid < this.controls.length; cid++) {\n                if (this.controls[cid].control.getController().updateItem) {\n                    this.controls[cid].control.getController().updateItem(newItem);\n                }\n            }\n        }\n    }\n\n    setFieldValue(fieldId:number, newValue:string) {\n        for (var cid = 0; cid < this.controls.length; cid++) {\n            if (this.controls[cid].fieldId ==  fieldId) {\n                this.controls[cid].control.getController().setValue( newValue );\n                this.sendNeedsSave();\n            }\n        }\n    }\n\n    async getFieldValue(fieldId: number) {\n        for (var cid = 0; cid < this.controls.length; cid++) {\n            if (this.controls[cid].fieldId == fieldId) {\n                return await this.controls[cid].control.getController().getValueAsync();\n            }\n        }\n        return null;\n    }\n\n    async getCurrentTitle() {\n        return  await this._title.getController().getValueAsync();\n    }\n\n    setViewers( viewers:IItemWatched ) {\n        return (<TitleToolbarImpl>this._title.getController()).setViewers(viewers);\n    }\n\n    getControls(fieldType?:string):JQuery[] {\n        var result:JQuery[] = [];\n        for (var idx = 0; idx < this.config.fieldList.length; idx++) {\n            for (var cid = 0; cid < this.controls.length; cid++) {\n                if (this.controls[cid].fieldId === this.config.fieldList[idx].id) {\n                    if (!fieldType || this.config.fieldList[idx].fieldType === fieldType) {\n                        result.push(this.controls[cid].control);\n                    }\n                }\n            }\n        }\n        return result;\n    }\n    /** returns (first) control with a given title */\n    getControlByName(name:string):JQuery {\n        for (var cid = 0; cid < this.controls.length; cid++) {\n            if ( this.controls[cid].name.toLowerCase() == name.toLowerCase()) {\n                return this.controls[cid].control;\n            }\n        }\n        return null;\n    }\n    /** returns control with a given id */\n    getControlById(fieldId:number):JQuery {\n        for (var cid = 0; cid < this.controls.length; cid++) {\n            if (this.controls[cid].fieldId == fieldId) {\n                return this.controls[cid].control;\n            }\n        }\n        return null;\n    }\n\n    // check if the version displayed is older than the current one\n\n    wasUpdated( itemId:string,  historyLength:number ) {\n        if (this.settings && this.settings.item &&  this.settings.item.id == itemId && this.settings.item.history && this.settings.item.history.length < historyLength ) {\n            return true;\n        }\n        return false;\n    }\n\n    // private functions\n\n    private addTabs( ) {\n        let that = this;\n\n        if (!this.settings.isForm || this.settings.isHistory) {\n            return;\n        }\n        let tabDefinition = <ICategorySettingTabs>globalMatrix.ItemConfig.getCategorySetting(this.settings.type, \"tabs\");\n        if (!tabDefinition || !tabDefinition.tabs || tabDefinition.tabs.length <= 1) {\n            return;\n        }\n\n        let tabs = $('<div id=\"itemTabs\" style=\"color: #333333; background-color: var(--Grey8); margin-top: -4px; padding: 4px; border-top: 1px solid lightgray;\">').insertAfter( this._title );\n        $.each( tabDefinition.tabs, function( tabIdx, tab ) {\n            $(\"<span style='padding:4px;cursor:pointer'>\").html(tab.name).appendTo(tabs).click( function() {\n               that.showTab( tabIdx );\n            });\n        });\n    }\n\n    private showTab( active?:number ) {\n\n        if (!this.settings.isForm || this.settings.isHistory) {\n            return;\n        }\n        let tabDefinition = <ICategorySettingTabs>globalMatrix.ItemConfig.getCategorySetting(this.settings.type, \"tabs\");\n        if (!tabDefinition || !tabDefinition.tabs || tabDefinition.tabs.length <= 1) {\n            return;\n        }\n\n        if (active == undefined) {\n            // get favorite tab in this session in this project\n            active = 0;\n            let lasttab = ItemControl.lastTab[matrixSession.getProject() + \":\" + this.settings.type];\n            if (lasttab) {\n                active = lasttab;\n            }\n        }\n        // remember favorite tab in this session in this project\n        ItemControl.lastTab[matrixSession.getProject() + \":\" + this.settings.type] = active;\n\n        $(\"#itemTabs span\").css(\"font-weight\",\"100\");\n        $($(\"#itemTabs span\")[active]).css(\"font-weight\",\"600\");\n        $.each( this.controls, function( cidx, control) {\n\n            if (tabDefinition.tabs.filter( function(tab) { return tab.fields.indexOf(\"\"+control.fieldId) !=-1; } ).length ==0 ) {\n                // field not in a specific tab so don'T hide it (like title bar or labels)\n            } else if  ( tabDefinition && tabDefinition.tabs && tabDefinition.tabs.length && control.fieldId && tabDefinition.tabs[active].fields.indexOf( \"\"+control.fieldId ) !=-1 ) {\n                control.control.show();\n            } else {\n                control.control.hide();\n            }\n        });\n\n    }\n    private allowSectionClose(ctrl:IControlDefinition,  ctrlParameter: IBaseControlOptions) {\n\n        let isClosed = ctrlParameter.item && globalMatrix.projectStorage.getItem('visible' + ctrlParameter.item.id + \"_\" + ctrl.fieldId) !== 'true';\n\n        // add > control open and close section\n        let helpLabel = $(\"<label for='docfield\" + ctrl.fieldId + \"'>\");\n        let baseControlHelp = $(\".baseControlHelp\", ctrl.control);\n        let checkbox = $(\"<input id='docfield\" + ctrl.fieldId + \"' class='showHideAdmin' type='checkbox' \" + (isClosed ? \"\":\"checked\" ) + \">\");\n        // put checkbox before label\n        baseControlHelp.parent().prepend(checkbox);\n        // put help into label\n        baseControlHelp.wrap(helpLabel);\n\n\n        // put triangle before help text\n        baseControlHelp.before(\"<span class='cbimg fal fa-chevron-right'>\");\n\n        checkbox.change(function(e: JQueryEventObject) {\n            var visibility = $(e.delegateTarget).is(':checked');\n            globalMatrix.projectStorage.setItem('visible' + ctrlParameter.item.id + \"_\" + ctrl.fieldId, visibility ? 'true' : 'false');\n            if (!visibility) {\n                $(\".baseControl\", $(e.delegateTarget).closest(\"div\")).hide();\n                $(\".inlineHelp\", $(e.delegateTarget).closest(\"div\")).hide();\n            }\n            else {\n                $(\".baseControl\", $(e.delegateTarget).closest(\"div\")).show();\n                $(\".inlineHelp\", $(e.delegateTarget).closest(\"div\")).show();\n                // make sure table this.controls are nice shown\n                if (ctrl.control.getController().redraw) {\n                    ctrl.control.getController().redraw();\n                }\n            }\n        });\n\n        return isClosed;\n    }\n\n    public resizeIt(forceRedraw?:boolean) {\n\n        //Let calcultate the width of the form\n\n        // add a scrollbar to the form if needed\n        if (this.settings.isForm && this.settings.controlState != ControlState.HistoryView) {\n            //this._outerbody.height(this.settings.control.height() - this._title.outerHeight() - 8 - ($(\".labelBar\").height()? $(\".labelBar\").height():0));\n        } else {\n            forceRedraw = true; // dialogs should always completely redraw tables otherwise they are badly rendered\n        }\n        var hasScrollbar = this._outerbody.height() < this._body.height();\n        // beautify widths if needed\n        for (var idx = 0; idx < this.controls.length; idx++) {\n            if (this.controls[idx].control.getController().resizeItem) {\n                this.controls[idx].control.getController().resizeItem(this._outerbody.width() - (hasScrollbar ? 15 : 0), forceRedraw);\n            }\n        }\n        if( this.settings.controlState == ControlState.FormView){\n            $(\"#main\").css(\"width\", `calc(100vw - ${$(\"#navLeft\").width() + $(\"#sidebar\").width() + $(\"#dragbar\").width() + $(\"#contextframesizer\").width() + $(\"#contextframe\").width()}px)`)\n        }\n\n    }\n\n    private async needsSaveImpl() {\n        // label change while readonly..\n        let labelChange = false;\n        for (var idx = 0; idx < this.controls.length; idx++) {\n            if (this.controls[idx] &&\n                this.controls[idx].fieldType == FieldDescriptions.Field_labels &&\n                this.controls[idx].control &&\n                this.controls[idx].control.getController &&\n                await  this.controls[idx].control.getController().hasChangedAsync()) {\n                labelChange = true;\n            }\n        }\n        if (!this.settings.canEdit && !labelChange) {\n            return false;\n        }\n        for (var idx = 0; idx < this.controls.length; idx++) {\n            if (this.controls[idx] && this.controls[idx].control && this.controls[idx].control.getController &&  await this.controls[idx].control.getController().hasChangedAsync() ||\n                    (this.controls[idx].isDhfType && mDHF.configChanged(this.controls[idx]))) {\n                if ( !this.startEdit && !this.duringFill && !this.settings.isDialog) {\n                    this.startEdit = true;\n                }\n                return true;\n            }\n        }\n        return false;\n    }\n\n    private getFieldType(fieldId:number) {\n        return globalMatrix.ItemConfig.getFieldType(this.settings.isItem ? this.settings.type : \"FOLDER\", fieldId);\n    }\n\n    private async sendNeedsSave(fieldId?: number, fieldName?: string) {\n\n        if (this.settings.changed) {\n            this.settings.changed(await this.needsSave());\n        }\n        // give the gates a chance to reset themselves\n        if (fieldId) {\n            for (var idx = 0; idx < this.controls.length; idx++) {\n                if (this.controls[idx] && this.controls[idx].fieldType == FieldDescriptions.Field_gateControl) {\n                    (<GateControlImpl>this.controls[idx].control.getController()).changed(fieldId, fieldName);\n                }\n            }\n        }\n\n    }\n\n    private renderActionButtonsReport():void {\n        let that = this;\n\n        var id = this.settings.item ? this.settings.item.id : \"\";\n\n        if (globalMatrix.ItemConfig.getExtrasConfig().enableLegacyReport == undefined || globalMatrix.ItemConfig.getExtrasConfig().enableLegacyReport == \"0\")\n        {\n            that._body.html(`<p class=\"controlContainer\" >REPORT is a legacy feature since MatrixReq v2.3. If required, ask your administrator to reactivate it.</p>\n            <ul><li>Use <span class=\"link\" id=\"EXPORTDOC\">DOC (documents)</span> to create printable reports</li>\n            <li>You can export data as EXCEL or XML in here: <span class=\"link\" id=\"EXPORTURL\">EXPORT</span></li>\n            <li>You can export the data also in the admin client, selecting the project</li>\n            </ul>`);\n            $(\"#EXPORTURL\").click(() => app.treeSelectionChangeAsync(\"EXPORT\"));\n            $(\"#EXPORTDOC\").click(() => app.treeSelectionChangeAsync(\"F-DOC-1\"));\n\n            return;\n        }\n        var showTools = true;\n        if (this.settings.controlState === ControlState.Print || this.settings.controlState === ControlState.Tooltip ||\n                this.settings.controlState === ControlState.DialogCreate || this.settings.controlState === ControlState.HistoryView) {\n            showTools = false;\n        }\n\n        var inputRestriction = false; // by default use input as specified in report\n        var inputFilter:string[]; // by default no filter\n        var inputItems:IReportInput[];\n        var requiredItems:IReportInput[];\n\n        if (this.settings.item && this.settings.item.selectSubTree && this.settings.item.selectSubTree.length) {\n            inputRestriction = true;\n\n            inputFilter = [];\n            inputItems = [];\n\n            for (var idx = 0; idx < this.settings.item.selectSubTree.length; idx++) {\n                var cat = this.settings.item.selectSubTree[idx].category;\n                if (globalMatrix.ItemConfig.getCategories().indexOf(cat) !== -1) {\n                    inputFilter.push( cat );\n                    inputItems.push({to: this.settings.item.selectSubTree[idx].rootFolder});\n                }\n            }\n        }\n\n        if (this.settings.item && this.settings.item.requireSubTree) {\n            requiredItems = [];\n            for (var idx = 0; idx < this.settings.item.requireSubTree.length; idx++) {\n                var cat = this.settings.item.requireSubTree[idx].category;\n                if (globalMatrix.ItemConfig.getCategories().indexOf(cat) !== -1) {\n                    requiredItems.push({to: this.settings.item.requireSubTree[idx].rootFolder});\n                }\n            }\n        }\n        function showInputSelectDialog() {\n\n            async function saveAndCloseDialog() {\n                var inputItems = await tree.getController().getValueAsync();\n\n\n                //MATRIX-3722 Local (browser) storage of REPORT selections is screwed and make the REPORT unusable --> Change of the localstorage item and disable the sanitize\n                if (rememberCheckbox.prop(\"checked\")) {\n                    globalMatrix.projectStorage.setItem('remember_items_selection_' + id, JSON.stringify(inputItems), true);\n                } else {\n                    globalMatrix.projectStorage.setItem('remember_items_selection_' + id, \"\", true);\n                }\n                dlg.dialog(\"close\");\n            }\n\n            ml.Search.searchInDialog();\n\n            var preferred = (typeof mDHF !== \"undefined\") ? mDHF.getDefaultFormat(\"REPORT\") : \"docx\";\n\n            var formats:IDropDownButtonOption[] = [];\n            for (var idx = 0; idx < that.settings.item.availableFormats.length; idx++) {\n                var pos = (preferred === that.settings.item.availableFormats[idx]) ? 0 : formats.length;\n\n                switch (that.settings.item.availableFormats[idx]) {\n                    case \"html\":\n                        formats.splice(pos, 0, {\n                            name: \"HTML\",\n                            click: async function() {\n                                ml.ReportGenerator.CreateReport(id, { format: \"html\" }, await tree.getController().getValueAsync(), requiredItems);\n                                saveAndCloseDialog();\n                                return false;\n                            }});\n                        break;\n                    case \"docx\":\n                        formats.splice(pos, 0, {\n                            name: \"Word\",\n                            click: async function() {\n                                ml.ReportGenerator.CreateReport(id, { format: \"docx\" }, await tree.getController().getValueAsync(), requiredItems);\n                                saveAndCloseDialog();\n                                return false;\n                            }});\n                        break;\n                    case \"pdf\":\n                        formats.splice(pos, 0, {\n                            name: \"PDF\",\n                            click: async function() {\n                                ml.ReportGenerator.CreateReport(id, { format: \"pdf\" }, await tree.getController().getValueAsync(), requiredItems);\n                                saveAndCloseDialog();\n                                return false;\n                            }});\n                        break;\n                    case \"xml\":\n                        formats.splice(pos, 0, {\n                            name: \"XML\",\n                            click: async function() {\n                                ml.ReportGenerator.CreateReport(id, { format: \"xml\" }, await tree.getController().getValueAsync(), requiredItems);\n                                saveAndCloseDialog();\n                                return false;\n                            }});\n                        break;\n                    default:\n                        break;\n                }\n            }\n\n            var linkTypes:string[] = [];\n            for (var idx = 0; idx < inputFilter.length; idx++) {\n                linkTypes.push(inputFilter[idx]);\n            }\n\n            var selectedItems = ml.JSON.clone(inputItems);\n\n            // check if selection was stored\n            //MATRIX-3722 Local (browser) storage of REPORT selections is screwed and make the REPORT unusable --> Change of the localstorage item and disable the sanitize\n            var selectionStored = globalMatrix.projectStorage.getItem('remember_items_selection_' + id, true);\n            if (selectionStored && selectionStored !== \"\") {\n                selectedItems = JSON.parse(selectionStored);\n            }\n\n            // build tree with default (root nodes) or selected items\n            var tree:JQuery = $(\"<div>\").projectView({\n                tree: app.getTree(linkTypes),\n                controlState: ControlState.DialogCreate,\n                selectedItems: selectedItems,\n                canSelectItems: true,\n                selectMode:SelectMode.auto,\n                collectionChanged: function (count:number) {\n                }\n            });\n\n            var rememberCheckbox:JQuery;\n            let dlg = $(\"#selectItemDlg\");\n            dlg.html(\"\");\n            dlg.removeClass(\"dlg-v-scroll\");\n            dlg.addClass(\"dlg-no-scroll\");\n            dlg.append(tree);\n\n            var niceSize = ml.UI.getNiceDialogSize(500, 400);\n            dlg.dialog({\n                autoOpen: true,\n                title: that.settings.item.title + \" Report - Select Input\",\n                height: niceSize.height,\n                width: niceSize.width,\n                modal: true,\n                close: function () {\n                    dlg.parent().html('');\n                    dlg.css('display', \"none\");\n                    // dlg is gone, remove highlights and back to global highlighting\n                    ml.Search.endSearchInDialog();\n                },\n                resizeStop: function () {\n                    dlg.resizeDlgContent([tree]);\n                },\n                open: function () {\n                    if (formats.length > 0) {\n                        $(\".ui-dialog-buttonpane button:contains('Ok')\", dlg.parent()).replaceWith(\n                                ml.UI.createDropDownButton(\"Create\", formats, true));\n                    }\n\n                    rememberCheckbox = $('<input type=\"checkbox\" name=\"remember\" ' + (selectionStored ? \"checked\" : \"\") + '>');\n\n                    $('.ui-dialog-buttonpane button:contains(Remember)', dlg.parent()).replaceWith(\n                            $('<label class=\"dlgCreateMultiple\">').append(rememberCheckbox).append('Remember Selection'));\n\n                },\n                buttons: [ {\n                    text: 'Remember',\n                    class: '',\n                    click: function () {}\n                },{\n                    text: 'Ok',\n                    class: 'btnDoIt',\n                    click: function () {}\n                },{\n                    text: 'Cancel',\n                    class: 'btnCancelIt',\n                    click: function () {\n                        dlg.dialog(\"close\");\n                    }\n                }]\n            }).resizeDlgContent([tree], false);\n\n        }\n        function createReportButton(name:string):JQuery {\n            var formats: IDropDownButtonOption[] = [];\n\n            var preferred = (typeof mDHF !== \"undefined\") ? mDHF.getDefaultFormat(\"REPORT\") : \"docx\";\n\n            for (var idx = 0; idx < that.settings.item.availableFormats.length; idx++) {\n                var pos = (preferred === that.settings.item.availableFormats[idx]) ? 0 : formats.length;\n\n                switch (that.settings.item.availableFormats[idx]) {\n                    case \"html\":\n                        formats.splice(pos, 0, {name: \"HTML\", click: function () {\n                                ml.ReportGenerator.CreateReport(id, {format: \"html\"}, inputRestriction ? inputItems : null, requiredItems);\n                                return false;\n                            }});\n                        break;\n                    case \"docx\":\n                        formats.splice(pos, 0, {name: \"Word\", click: function () {\n                                ml.ReportGenerator.CreateReport(id, {format: \"docx\"}, inputRestriction ? inputItems : null, requiredItems);\n                                return false;\n                            }});\n                        break;\n                    case \"pdf\":\n                        formats.splice(pos, 0, {name: \"PDF\", click: function () {\n                                ml.ReportGenerator.CreateReport(id, {format: \"pdf\"}, inputRestriction ? inputItems : null, requiredItems);\n                                return false;\n                            }});\n                        break;\n                    case \"xml\":\n                        formats.splice(pos, 0, {name: \"XML\", click: function () {\n                                ml.ReportGenerator.CreateReport(id, {format: \"xml\"}, inputRestriction ? inputItems : null, requiredItems);\n                                return false;\n                            }});\n                        break;\n                    case \"zip\":\n                        formats.splice(pos, 0, {name: \"Word with attachments\", click: function () {\n                                ml.ReportGenerator.CreateReport(id, {format: \"zipdocx\"}, inputRestriction ? inputItems : null, requiredItems);\n                                return false;\n                            }});\n                        break;\n                    default:\n                        break;\n                }\n            }\n            return ml.UI.createDropDownButton(name, formats, false);\n        }\n\n        function RenderReportDefinitionDialog(body:JQuery, controls:IControlDefinition[]) {\n            var selectedReport: XRReportType = null;\n\n            var dlgInner = body.parent();\n            var dlgOuter = dlgInner.parent();\n\n            var titleCtrl:JQuery;\n            var decriptionCtrl:JQuery;\n            var decriptionCtrlValue:string;\n            var reportIdCtrl:JQuery;\n\n            for (var idx = 0; idx < controls.length; idx++) {\n\n                if (controls[idx].name === \"Title\") {\n                    titleCtrl = controls[idx].control;\n                    titleCtrl.hide();\n                }\n                else if (controls[idx].name === \"Description\") {\n                    decriptionCtrl = controls[idx].control;\n                }\n                else if (controls[idx].name === \"reportId\") {\n                    reportIdCtrl = controls[idx].control;\n                    reportIdCtrl.hide();\n                }\n            }\n\n            setTimeout(function () {\n                dlgOuter.dialog(\"option\", \"height\", 500);\n                dlgOuter.dialog(\"option\", \"width\", 730);\n                $(\".dlgCreateMultiple\", dlgOuter.parent()).hide();\n            }, 1);\n\n\n            app.getAvailableReportsAsync().done(function (availableReports) {\n\n                var reportSelection:IDropdownOption[] = [];\n                var groups:string[] = [];\n                var groupList:{value:string, label:string}[] = [];\n\n                for (var idx = 0; idx < availableReports.reportList.length; idx++) {\n                    var group = availableReports.reportList[idx].group;\n                    group = group?group:\"hidden\"; // by default do not show 1.5 and earlier reports\n                    if (group.indexOf(\"MR_\")===0) {\n                        var dhf_config = globalMatrix.ItemConfig.getDHFConfig();\n                        if (dhf_config && dhf_config.customReports && dhf_config.customReports.group === group ) {\n                            group = \"Custom\";\n                        } else {\n                            group = \"hidden\";\n                        }\n                    }\n                    if (availableReports.reportList[idx].label.toLowerCase() !== \"legacy\" &&\n                            availableReports.reportList[idx].id.toLowerCase() !== \"dhf_generic\" &&\n                            group !== \"hidden\" ) {\n                        reportSelection.push({\n                            id: availableReports.reportList[idx].id,\n                            label: availableReports.reportList[idx].label,\n                            class:group});\n                        if (groups.indexOf(group) === -1) {\n                            groups.push(group);\n                            groupList.push({value:group, label:group});\n                        }\n                    }\n                }\n\n                async function selectReport(selId: string) {\n\n                    for (var idx = 0; idx < availableReports.reportList.length; idx++) {\n                        if (availableReports.reportList[idx].id === selId) {\n                            selectedReport = availableReports.reportList[idx];\n                        }\n                    }\n\n                    (<TitleToolbarImpl>titleCtrl.getController()).titleCreationMode();\n\n                    titleCtrl.getController().setValue(selectedReport.label, true);\n\n                    if (!decriptionCtrlValue || decriptionCtrlValue === $($(\"<div>\").html(await decriptionCtrl.getController().getValueAsync())).text()) {\n                        // not changed, set to selected item\n\n                        decriptionCtrl.getController().setValue(selectedReport.description);\n                        decriptionCtrlValue = $($(\"<div>\").html(await decriptionCtrl.getController().getValueAsync())).text();\n                    }\n                    reportIdCtrl.getController().setValue(selectedReport.id);\n                }\n\n                var reportSelector = $(\"<div>\");\n                reportSelector.mxDropdown({\n                    controlState: ControlState.DialogCreate,\n                    canEdit: true,\n                    dummyData: false,\n                    help: 'Select Report Template',\n                    fieldValue: \"\",\n                    valueChanged: async function () {\n                        selectReport(await reportSelector.getController().getValueAsync());\n                    },\n                    parameter: {\n                        placeholder: 'select report',\n                        readonly: false,\n                        maxItems: 1, // maxItems which can be selected\n                        options: reportSelection,\n                        groups:groupList,\n                        create: false, // true if values can be added\n                        sort: true // true sort options\n                    }});\n\n                dlgInner.prepend(reportSelector);\n            });\n        }\n\n        if (that.settings.isItem) {\n            if (that.settings.controlState === ControlState.DialogCreate) {\n                RenderReportDefinitionDialog(that._body, that.controls);\n            } else if (showTools) {\n\n                var rt = $(\"<div style='padding-top:12px;padding-bottom:12px;'>\");\n                that._body.append(rt);\n\n                if (globalMatrix.ItemConfig.canReport(\"REPORT\")) {\n                    if (inputRestriction) {\n                        // user can select input items from tree -> pop up a dialog an let choose\n                        var inputSelectionGroup = $(\"<div  class='hidden-print inputSelectionGroup'></div>\");\n                        rt.append(inputSelectionGroup);\n                        inputSelectionGroup.append($(\"<button id='createReportButton' class='btn btn-default'>\").html(\"Create Report\").click(function () {\n                            showInputSelectDialog();\n                        }));\n                    } else {\n                        // uses all input let's create report\n                        rt.append(createReportButton(\"Create Report\"));\n                    }\n                } else {\n                    rt.append(\"<div class='inlineHelp'>You have no rights to download documents</div>\")\n                }\n\n\n            }\n        } else if (that.settings.controlState === ControlState.FormEdit && app.canCreateItemType(\"REPORT\")) {\n            that._body.append($(\"<span class='baseControlHelp'>Tools</span>\"));\n            var folderEdit = $(\"<div class='hidden-print baseControl'></div>\");\n            that._body.append(folderEdit);\n            var createTools = new ItemCreationTools();\n            var createButtons = [{type: that.settings.item.type, name: \"Folder\", folder: true}, {type: that.settings.item.type, name: \"Report Template\"}];\n            createTools.renderButtons({\n                parent: that.settings.item.id,\n                dontOpenNewItem:false,\n                control: folderEdit,\n                linkTypes: createButtons,\n                type:that.settings.type});\n        }\n    }\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ControlState, IReference } from \"../../../globals\"\nimport { IDB } from \"../../businesslogic/index\"\nimport { IBaseControlOptions } from \"../Controls/BaseControl\"\n\nexport type {\n    IProjectPanelControlOptions, IVizMode, IDelayedAction, MyNodeData,\n    MyNode, MyDDData, MyFancytree, MyFancytreeOption\n};\nexport { SelectMode, SearchState, SearchUpdate };\n\ninterface IProjectPanelControlOptions extends IBaseControlOptions {\n    parameter?: {\n        readonly?: boolean, // can be set to overwrite the default readonly status\n        placeholder?: string,\n        maxItems?: number,\n        options?: any\n    },\n    noAnimation?: boolean, // set to true not to anmite opening / closing of tree\n    dragAndDrop?: boolean,\n    controlState?: ControlState, // read only rendering\n    highlight?: boolean // true: input should be highlighted in complete page\n    canFilter?: boolean,//  true: filter / search box should be shown\n    isConfigSearch?: boolean\n    serverSearch?: boolean, // true: search server should be enabled: disabled only in admin client\n    expand?: number, //0, // minimum number of levels to expand \n    tree?: IDB[], // tree in fancy tree style\n    tooltips?: boolean, // show tooltips if available\n    collectionChanged?: (count: number) => void,\n    selectionChanged?: (id: string) => void,\n    onExpand?: (id: string) => void, // optional callback, called when folder is opened \n    dropCallback?: Function // callback after node was dropped\n    crossProject?: string // if tree is for another project\n\n    selectedItems?: IReference[], // list of selected items,\n    selectMode?: SelectMode, // if and how items can be selected\n    glueToBottom?: boolean // if set to true the tree will be as big as possible (e.g. for JIRA plugin)\n    isMainTree?: boolean // set to true if this is the main tree on left\n    autoScroll?: boolean // Scroll to selection, defaults to true\n}\nenum SelectMode {\n    /*** DO NOT CHANGED numbers use from baseControl */\n    none = 0, // cannot select\n    items = 1, // can select items (no folders)\n    folders = 2,  // can select folders (no items)\n    singleItem = 3, // can select one item (no folders)\n    singleFolder = 4, // can select one folder (no items)\n    independent = 5, // can select folder and items (independently)\n    auto = 6, // if all children in folder are selected, selection changes to parent\n    independentAuto = 7, //  can select folder and items independently -> but when checking a folder it adds all children\n    autoPrecise = 8 //  if you select a folder it select everything within, if you unselect something it unselects all parents\n\n}\n\ninterface MyNodeData extends Fancytree.FancytreeNode {\n    cstrender?: boolean, background?: string, shortTitle?: string, border?: string,\n    type?: string, icon?: string, hideCheckbox?: boolean, isUnselected?: boolean, extraStyle?: string, classes?: string[],\n    mode?: string\n}\ninterface MyNode extends Fancytree.FancytreeNode { selected?: boolean, unselectable?: boolean, ul?: JQuery, span?: JQuery, type?: string, subMatch?: boolean, shortTitle?: string }\ninterface MyDDData { otherNode?: MyNode, hitMode?: string }\ninterface MyFancytree extends Fancytree.Fancytree { options?: Fancytree.FancytreeOptions }\ninterface MyFancytreeOption extends Fancytree.FancytreeOptions { filter?: { mode?: string } }\n\nenum SearchState {\n    NoSearch = 0, // the whole tree is shown\n    FilterDone, // a local search (filter of the tree by title and id)\n    ServerRunning, // a search request was send to the server \n    ServerDone // the search results returned\n}\nenum SearchUpdate {\n    inserted_node = 1, // called if a new node has been inserted \n    updated_rec, // called after TC have been executed on server, a whole subtree needs to be inserted\n    filter_status_changed, // called when label and therefore visibility is changed\n    title_changed, // the item's title was changed\n    item_dropped // an item was draged and dropped to a new place (if this happens after creating it , it must be refreshed)\n}\ninterface IVizMode { uid: string, icon: string, text: string, mainTree: boolean, asList: boolean, hide: boolean, check: boolean, expand: boolean }\n\ninterface IDelayedAction { type: string, expression: string }\n","/// <reference types=\"matrixrequirements-type-declarations\" />;\nimport { IItem, ControlState, app,  matrixSession, matrixApplicationUI, globalMatrix } from \"../../../globals\";\nimport {FieldHandlerFactory, IItemWatched, MR1} from \"../../businesslogic/index\";\n\nimport { UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\";\nimport { LabelTools } from \"../../matrixlib/index\";\nimport { IBaseControlOptions, BaseControl } from \"./BaseControl\";\nimport { MarkAsTemplateImpl } from \"./markAsTemplate\";\nimport { ml } from \"./../../matrixlib\";\nimport { refLinkStyle, refLinkTooltip } from \"../Parts/RefLinkDefines\";\nimport { HistoryTools } from \"../Tools/ItemHistoryView\";\nimport { ReferenceTools } from \"../Tools/ItemReferenceView\";\nimport { mTM } from \"../../businesslogic/index\";\nimport { mDHF } from \"../../businesslogic/index\";\nimport { pluginHooks, plugins } from \"../../businesslogic/index\";\nimport { IPanel } from \"../Application\";\nimport { EImportMode } from \"../../businesslogic/ComponentImport\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\nimport {EmptyFieldHandler} from \"../../businesslogic/FieldHandlers/EmptyFieldHandler\";\n\nexport type { ITitleToolbarOptions };\nexport { TitleToolbarImpl };\n\n\ninterface ITitleToolbarOptions extends IBaseControlOptions {\n    parameter?: {\n        readonly?: boolean, // can be set to overwrite the default readonly status\n        placeholder?: string\n    },\n    id?:string,\n    title?:string,\n    item?:IItem,\n    canEditTitle?:boolean,\n    canDelete?:boolean,\n    locked?:string, // set to name of label, if item sis locked by used of label\n    unlockers?:string, //  hint who can unlock it\n    type?:string,\n    validate?:boolean,\n    noAutoActivation?:boolean\n}\n\n$.fn.titleToolbar = function(this:JQuery, options:ITitleToolbarOptions) {\n\n    if (!options.fieldHandler) {\n        options.fieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, FieldDescriptions.Field_dummy, options);\n        options.fieldHandler.initData(JSON.stringify(options.fieldValue));\n    }\n    let baseControl = new TitleToolbarImpl(this, options.fieldHandler as EmptyFieldHandler);\n    this.getController = () => { return baseControl;}\n\n    baseControl.init(options);\n    return this;\n}\n\n\nclass TitleToolbarImpl extends BaseControl<EmptyFieldHandler> {\n\n\n    private settings: ITitleToolbarOptions;\n    private isInHiddenMode:boolean;\n    private link:JQuery;\n    private warnedAboutOutOfDate:boolean;\n    private _refDlgIcon:JQuery;\n\n    constructor(control: JQuery, fieldHandler: EmptyFieldHandler) {\n        super(control,fieldHandler);\n    }\n\n    init( options:ITitleToolbarOptions) {\n        let that = this;\n\n        this._refDlgIcon = null;\n        var defaultOptions:ITitleToolbarOptions = {\n            id: \"\", // identifier of item for which this control is shown\n            title: \"\",\n            controlState: ControlState.FormView, // read only rendering\n            dummyData: false, // fill control with a dummy text (for form design...)\n            valueChanged: function () {\n            }, // callback to call if value changes\n            canEdit: false, // whether data can be edited\n            canEditTitle: false, // whether data can be edited (sometimes the item might 'wrongly marked as' readonly because it is a signed doc with signatures)\n            canDelete: false, // whether item can be deleted\n            validate: true, // default is true. validation requires non-empty string\n            parameter: {\n                readonly: false, // can be set to overwrite the default readonly status\n                placeholder: \"enter title\"\n            }\n        };\n        this.isInHiddenMode = false;\n        this.settings = <ITitleToolbarOptions>ml.JSON.mergeOptions(defaultOptions, options);\n\n        this.warnedAboutOutOfDate = false;\n\n        var showTools = this.settings.controlState === ControlState.FormEdit || this.settings.controlState === ControlState.FormView;\n\n        var title = this.settings.title;\n        if (this.settings.controlState === ControlState.DialogCreate) {\n            this._root.append($(\"<span class='pull-left baseControlHelp itemTitleDemand'>\" + this.settings.help + \"</span>\"));\n        }\n\n        this._root.data(\"original\", this.settings.title);\n        this._root.data(\"new\", this.settings.title);\n        // create title bar\n        if (showTools) {\n            this._root.addClass(\"itemTitleBar\");\n        } else if (this.settings.canEdit) {\n            this._root.addClass(\"itemTitleBarNoTools\");\n        } else {\n            this._root.addClass(\"itemTitleBarNoToolsNoEdit\");\n        }\n\n        let importSource = matrixSession.isConfigClient() ? null : app.getImportSource(this.settings.item);\n\n        this.link = $(\"<div>\").refLink({\n            folder: false, // show id if it exists\n            placeholder: this.settings.parameter.placeholder,\n            id: this.settings.id,\n            title: title,\n            style: ((this.settings.canEdit && this.settings.canEditTitle) ? refLinkStyle.edit : refLinkStyle.link),\n            tooltip: refLinkTooltip.none,\n            callback: function (id:string, newText:string) {\n                if (!that.isInHiddenMode) {\n                    if ( that.settings.type == \"DOC\"  && newText.indexOf(\"\\\\\")!=-1 ){\n                        ml.UI.showError(\"Invalid character in DOC title\", \"backslashes are not allowed!\")\n                    }\n                    that._root.data(\"new\", newText);\n                    if (that.settings.valueChanged) {\n                        that.settings.valueChanged.apply(null);\n                    }\n                }\n            },\n            validate: this.settings.validate,\n            includeSourceLink: (!showTools && importSource && importSource.relation == EImportMode.Include)\n                ? `included from${importSource.downItem.projectShort}/${importSource.downItem.itemRefWithVersion}`\n                : \"\"\n        });\n\n\n        $(\".refId\", this.link).click( function() {\n            if ( that.settings.controlState != ControlState.FormEdit && that.settings.controlState != ControlState.FormView) {\n                // nothing to show\n                return;\n            } else if (ml.Item.parseRef(that.settings.id).isFolder) {\n                return;\n            } else {\n                let currentPanel: IPanel = matrixApplicationUI.currentPanel;\n                if (currentPanel.toggleZen) {\n                    currentPanel.toggleZen();\n                }\n            }\n        });\n\n        this.showOutOfDateIcon();\n\n        this.link.addClass('itemTitle rowFlex');\n        if (this.settings.locked) {\n            let labelTools = ml.CreateNewLabelTools();\n            let dn = labelTools.getDisplayName(this.settings.locked);\n            let lockedBy = $(\"<span class='lockedItem'>\").html(\"<i class='fa fa-lock-alt'></i> (locked)\")\n\n            // tooltip with info why it is locked and how it can be unlocked\n            $(\".refId\",this.link).append( lockedBy);\n\n            let tooltip = \"Locked by label '\" + this.settings.locked + (dn?(\": \"+dn):\"\") +\"'\";\n            tooltip += this.settings.unlockers?(\". Can be unlocked by: \" + this.settings.unlockers+ \".\"):\". Cannot be unlocked in UI.\";\n\n            lockedBy.tooltip({title: tooltip, placement:\"bottom\"});\n        }\n        this._root.append(this.link);\n        if (this.settings.controlState === ControlState.DialogCreate && !this.settings.noAutoActivation) {\n            setTimeout(function () {\n                $(\".refTitle\", that.link).click();\n            }, 500);\n        }\n\n\n        if (this.settings.controlState !== ControlState.DialogCreate) {\n            this.link.find(\".refId\").append($(\"<div class='pull-right itemViewers'>\"));\n\n        }\n        $(this._root).on('focusout.editable', function (e) {\n                $('.editable-open').parent().find(\"form\").trigger('submit');\n                console.log(\"title submitted\")\n            });\n\n        if (showTools) { // add titlebar tools\n            var itemTools = $(\"<div class=' hidden-print toolsBarButtonsContainer'></div>\");\n            this._root.append(itemTools);\n\n\n            var miTouch = $('<li title=\"Create new version of item\"><a href=\"javascript:void(0)\" id=\"toolTouch\">Touch</a></li>').click(function () {\n                app.touchAsync(that.settings.id, 1);\n            });\n\n            var bShare = $('<div class=\"btn-group\">' +\n                    ' <button id=\"shareButton\"  tabindex=\"-1\" type=\"button\" title data-original-title=\"Tools\" data-toggle=\"dropdown\" class=\"btn btn-item btn-sm dropdown-toggle\">' +\n                    '<span class=\"fal fa-ellipsis-v-alt\"></span></button>' +\n                    ' <ul class=\"sharemenu dropdown-menu dropdown-menu-sub pull-right\" role=\"menu\">' +\n                    ' </ul>' +\n                    '</div>');\n            var bShareMenu = $('ul', bShare);\n\n            var extras = globalMatrix.ItemConfig.getExtrasConfig();\n\n\n            if (!this.settings.locked && !this.settings.isFolder && app.touchToolAvailable(this.settings.item) && (!extras || !ml.JSON.isTrue(extras.noTouch))) {\n                bShareMenu.append(miTouch);\n            }\n\n            if (!mDHF.isDocumentType(this.settings.type)) {\n                if (matrixSession.getUISettings().legacyPrint) {\n                    var miPrint = $('<li title=\"prepare to print\"><a href=\"javascript:void(0)\">Print</a></li>').click(function () {\n                        app.print();\n                    });\n                    bShareMenu.append(miPrint);\n                }\n            }\n\n            if (app.mailToolAvailable()) {\n                var miMail = $('<li class=\"mailMenu\"><a id=\"toolSendTo\" href=\"javascript:void(0)\">Send link by mail</a></li>');\n\n                miMail.click(function(event: JQueryEventObject) {\n                    var itemId = app.getCurrentItemId();\n                    var message = ml.Mail.getCannedMessage(\"link\",\"\" , itemId);\n\n                    ml.Mail.sendMailDlg(\"\", null, itemId, message,\"\");\n                });\n                bShareMenu.append(miMail);\n            } else {\n                var miMail = $('<li class=\"mailMenu\"><a href=\"mailto:?subject=' + this.settings.id + '&amp;body=' + location + '\">Email</a></li>');\n                bShareMenu.append(miMail);\n            }\n\n            var labelTools = $('<div class=\"labelTools\">');\n\n            if (globalMatrix.ItemConfig.getLabelsConfig() && globalMatrix.ItemConfig.getLabelsConfig().useLabelBar) {\n                let labelBar = $(\"<div class='labelBar'>\");\n                this._root.after(labelBar);\n                labelBar.append(labelTools);\n            } else {\n                itemTools.after(labelTools);\n            }\n\n\n            var workflowTools = $('<div class=\"btn-group workflowTools\">');\n            itemTools.append(workflowTools);\n\n\n            if (!this.settings.isFolder && (app.hasLinks(this.settings.item) || (mTM.getCloneSources() && mTM.getCloneSources().indexOf(this.settings.type) != -1))) {\n                this._refDlgIcon = $(`<i class=\"fal fa-sitemap\" aria-hidden=\"true\" />`);\n                var refDlgButton = $(\"<button id='referenceToolBtn' tabindex='-1' title data-original-title='References' class='btn btn-item'>\").append(this._refDlgIcon);\n                var refDlgGroup = $(\"<div class='btn-group'>\").append(refDlgButton).click(function () {\n                    var rt = new ReferenceTools();\n                    rt.showReferenceDialog({item: that.settings.item, canEdit:that.settings.canEdit});\n                });\n                itemTools.append(refDlgGroup);\n                this.updateItem();\n            }\n\n            if (!this.settings.isFolder) {\n                // there is no easy way to get history of folder\n                var historyTools = new HistoryTools();\n                historyTools.renderButtons({\n                    control: itemTools,\n                    id: this.settings.id,\n                    isFolder: this.settings.isFolder,\n                    item: this.settings.item,\n                    readOnly: !this.settings.canEdit\n                });\n\n                if (importSource) {\n                    let sourceInfo = (importSource.relation == EImportMode.Include ?\"included from \":\"copied from \") +  importSource.downItem.projectShort + \"/\" + importSource.downItem.itemRefWithVersion;\n                    let sourceLink = $(`<div  class='btn-group'><button id='originalItemBtn' tabindex='-1' title data-original-title='${sourceInfo}' class='btn btn-item'> <span class='fal fa-external-link-alt'></span></button></div>`);\n\n                    sourceLink.click(() => window.open( globalMatrix.matrixBaseUrl + \"/\" + importSource.downItem.projectShort + \"/\" + importSource.downItem.itemRefWithVersion.split(\"-v\")[0]));\n\n                    itemTools.append(sourceLink);\n                }\n\n                let usedBy = app.getUsedBy(this.settings.item);\n\n                if (usedBy) {\n                    let linkList = $(\"<ul>\");\n\n                    for (let useByLink of usedBy) {\n                        let targetType = useByLink.relation == EImportMode.Include ?\"included as\":\"copied as\";\n                        let targetInfo = useByLink.upItem.projectShort + \"/\" + useByLink.upItem.itemRefWithVersion;\n                        $(`<li>${targetType} <span data-target='${targetInfo.split(\"-v\")[0]}' class='refIdHyper includedLink'>${targetInfo}</span></li>`).appendTo(linkList);\n                    }\n                    let targetLink = $(`<div  class='btn-group'><button id='originalItemBtn' tabindex='-1' title data-original-title='used by' class='btn btn-item'> <span class='fal fa-external-link-square-alt'></span></button></div>`);\n                    itemTools.append(targetLink);\n                    targetLink.click(() => {\n                        let usedByDlg = $(\"<div>\").appendTo($(\"body\"));\n\n                        ml.UI.showDialog(usedByDlg, \"Item used by\", linkList, 300, 200,\n                            [{\n                                text: \"Close\",\n                                class: 'btnDoIt',\n                                click: function () {\n                                    usedByDlg.dialog(\"close\");\n                                }\n                            }],\n                            UIToolsConstants.Scroll.Vertical,\n                            true,\n                            true,\n                            () => {\n                                usedByDlg.remove();\n                            },\n                            () => {\n                                $(\".includedLink\", linkList).click( ( e:JQueryEventObject) => {\n                                    window.open(   globalMatrix.matrixBaseUrl + \"/\" + $(e.delegateTarget).data(\"target\"));\n                                });\n                            },\n                            () => { }\n                        );\n                    });\n\n                }\n\n            }\n\n            // The TestManager customizes folder menus in some cases.\n            mTM.UpdateFolderMenu(bShareMenu, this.settings.item);\n\n            let itemParsed = ml.Item.parseRef( this.settings.item.id );\n            let root = itemParsed.number == 1 && itemParsed.isFolder;\n\n            if (this.settings.canEdit && app.canDeleteItem(this.settings.item) && !root) {\n                var bDelete = $(\"<li class=\\\"deleteMenu\\\">Delete</li>\")\n\n                bShareMenu.prepend(\"<li class='divider'></li>\");\n                bShareMenu.prepend(bDelete);\n\n\n                bDelete.click(function () {\n                    var whatToDelete = that.settings.id;\n                    MR1.triggerBeforeDeleteAsync( that.settings.item ).done(function()  {\n                        let isTemplate = mDHF.isUsedAsTemplate( that.settings.item.id );\n                        let message = isTemplate?\n                            (that.settings.item.id + \" is used as template. Deleting will also remove the templates!\")\n                            :(\"Delete '\" + that.settings.item.id + \" \" + title + \" '?\");\n                        let ok = isTemplate?\n                            (\"Delete and remove templates\")\n                            :(\"Delete\");\n\n                        ml.UI.showConfirm(1, {title: message, ok: ok}, function () {\n                            let deletedItems = app.getChildrenIdsRec(whatToDelete)\n                            app.deleteItem(whatToDelete).done(function () {\n                                MarkAsTemplateImpl.removeFromTemplates(deletedItems);\n                                MR1.triggerAfterDelete(that.settings.item);\n                                if (isTemplate) {\n                                    mDHF.removeAsTemplate( that.settings.item.id );\n                                }\n                            });\n                        }, function () {\n\n                        });\n                    }).fail( function() {\n                        ml.Logger.log(\"warn\",\"delete cancelled using MR1\");\n                    });\n\n                });\n            }\n            itemTools.append(bShare);\n            itemTools.append( ml.ContextFrames.getExpender() );\n            $(\"button\", itemTools).tooltip({placement: \"bottom\"});\n\n            // moved after adding history (for jobs plugin to be able to remove it;-)\n            plugins.updateMenu(pluginHooks.shares, bShareMenu);\n\n        }\n\n    }\n    // public interface\n    async hasChangedAsync() {\n        return  this._root.data(\"original\") !== this._root.data(\"new\");\n    }\n    async getValueAsync() {\n        return this._root.data(\"new\");\n    }\n    setValue(newTitle:string, fireUpdate:boolean) {\n        this._root.data(\"new\", newTitle);\n        this._root.find(\"input\").val(newTitle);\n        this._root.find(\".refTitle\").html(newTitle);\n\n        if (fireUpdate && this.settings.valueChanged) {\n            this.settings.valueChanged.apply(null);\n        }\n    }\n    getText() {}\n\n    getValueRaw() {}\n\n    titleCreationMode() {\n        // special mode where control is hidden and used by report generator to set the value\n        this._root.hide();\n        this.isInHiddenMode = true;\n    }\n\n    destroy() {\n        if (this.link) {\n            (<XEditable>(<any>this.link)).destroy();\n        }\n    }\n\n    resizeItem() {\n    }\n\n    setViewers( viewers: IItemWatched) {\n        let that = this;\n\n        if (viewers.item !== this.settings.item.id) {\n            // that can happen\n            // e.g. if use changes item and does not type for a while, the old item will be pinged\n            return;\n        }\n        $(\".itemViewers\", this._root).html(\"\");\n        let ignoredFirstMe=false;\n        let otherEditor = (viewers.editor && !viewers.editor.thisSocket)?viewers.editor.user:\"\";\n\n        if (viewers.editor && this.settings.type != \"XTC\" && this.settings.type != \"SIGN\") {\n            $(\"#thisItemIsDated\").hide();\n        } else {\n            $(\"#thisItemIsDated\").show();\n        }\n\n        $.each(viewers.users, function( vidx, viewer) {\n\n            if (viewer == matrixSession.getUser() && !ignoredFirstMe) {\n                // I myself appear at most once in an item\n                ignoredFirstMe = true;\n                return;\n            }\n\n            let user = globalMatrix.ItemConfig.getUserInfo(viewer);\n            if (!user) {\n                // that's a spying super user;-)\n                return;\n            }\n            let name = (user.firstName?user.firstName:\"\") + \" \"+ (user.lastName?user.lastName:\"\");\n            if (name==\" \") name = viewer;\n            let itemAccess = \"itemViewer\";\n             if (otherEditor==viewer) {\n                otherEditor=\"\"; // there can only be one\n                itemAccess = \"itemEditor\";\n                name += \" - is editing this item\";\n            }\n            let spanItemViewer = $(\"<div class='\" + itemAccess + \"' title='\"+name+\"'></div>\" );\n            spanItemViewer.append(ml.UI.getAvatar(user.login,32) );\n\n            $(\".itemViewers\", that._root).append(spanItemViewer)\n\n        });\n\n    }\n\n    updateItem(newItem?:IItem) {\n        let that = this;\n        if (newItem) {\n            if (newItem.id !== this.settings.item.id) {\n                // that can happen\n                // e.g. if use changes item and does not type for a while, the old item will be pinged\n                // console.write(\"newItem.id !== settings.item.id\");\n                return;\n            }\n            if (newItem.history.length && newItem.history.length !== this.settings.item.history.length &&\n                !(newItem.history.length === this.settings.item.history.length + 1 && newItem.history[0].action === \"move\" && newItem.history[0].user === matrixSession.getUser()) // no warning after simple move by this user! MATRIX-1416\n               ) {\n                if (!this.warnedAboutOutOfDate) {\n                    var message = \"User \" + newItem.history[0].user + \" changed item after you loaded it <br><br> Last change at \" + newItem.history[0].dateUserFormat;\n\n                    ml.UI.showConfirm( -12, { title:message, ok:\"Update to new\", nok:\"Keep displaying old\"}, function() {\n                        app.cancel();\n                    },function() {\n                        that.warnedAboutOutOfDate = true;\n                        that._root.addClass( \"staleItem\" );\n                        $(\".itemTitle\", that._root).tooltip({\n                            title: message + \" \",\n                            placement: \"right\",\n                            html: true,\n                            template: '<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\" style=\"max-width:800px\"></div></div>'});\n                    });\n                }\n            }\n            this.settings.item.downLinks = newItem.downLinks;\n            this.settings.item.upLinks = newItem.upLinks;\n        }\n\n        if (this._refDlgIcon) {\n\n            var downMissing = app.isDownLinkMissing(this.settings.item);\n            var upMissing = app.isUpLinkMissing(this.settings.item);\n            this._refDlgIcon.removeClass(\"refGood\").removeClass(\"refOutdated\").removeClass(\"refMissing\");\n            if (upMissing || downMissing) {\n                this._refDlgIcon.addClass(\"refMissing\");\n            } else if (app.isAnyLinkOutdated(this.settings.item)) {\n                this._refDlgIcon.addClass(\"refOutdated\");\n            } else {\n                this._refDlgIcon.addClass(\"refGood\");\n            }\n        }\n    }\n\n    private toggleOutOfDateIcon() {\n\n    }\n    private showOutOfDateIcon() {\n        let that = this;\n\n        if (this.settings.controlState ==  ControlState.FormEdit && this.settings.item && this.settings.item.history && this.settings.item.upLinks && this.settings.item.upLinks.length) {\n            // check if item is potentially out of date\n            let isXTCorSIGN = this.settings.type == \"XTC\" || this.settings.type == \"SIGN\";\n            // for XTC take time of creation of XTC, for other the last modification time\n            let thisTime = this.settings.item.history[isXTCorSIGN?this.settings.item.history.length-1:0].date;\n            // get the last modification date of all parents\n            let parentLastChange = new Date(this.settings.item.upLinks[0].modDate);\n            for (let parent of this.settings.item.upLinks) {\n                if ( new Date(parent.modDate) > parentLastChange) {\n                    parentLastChange = new Date(parent.modDate);\n                }\n            }\n            if ( new Date(thisTime) < parentLastChange ) {\n                let clickToTouch = this.settings.canEdit?\" Click to touch\":\"\";\n                let message = isXTCorSIGN?(\"the underlying \" + (this.settings.type == \"XTC\"?\"test\":\"DOC\")+ \" was changed after the \" + this.settings.type +\" was created\"):(\"at least one uplinked item is newer than this item.\" + clickToTouch);\n                let icon = $(`<span id=\"thisItemIsDated\" class=\"fal fa-history datedLink\" title=\"${message}\"></span>`);\n                if ( this.settings.canEdit && !isXTCorSIGN) {\n                    icon.css(\"cursor\", \"pointer\").click( () => {\n                        app.touchAsync(that.settings.id, 1);\n                    });\n                }\n                this.link.find(\".refId\").append(icon);\n            }\n        }\n    }\n}\n","/// <reference types=\"bootstrap\" />\nimport { IItemGet, ControlState, IItem } from \"../../../globals\"\nimport { IFieldParameter } from \"../../../ProjectSettings\"\nimport {IFieldHandler} from \"../../businesslogic/FieldHandlers/IFieldHandler\";\nimport {EmptyFieldHandler} from \"../../businesslogic/FieldHandlers/EmptyFieldHandler\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\n\nexport type { ITableParams, IBaseControl, IBaseControlOptions };\nexport { BaseControl };\n\ninterface ITableParams {\n    canBeModified?: boolean, // if true, rows can be added and moved,\n    create?: boolean, // if canBeModified also can add lines (with little icon)\n    showLineNumbers?: boolean, // whether to show line numbers in front of each row\n    maxRows?: number, // if set to a value other than -1, the maximum number of rows which can be created\n    fixRows?: number, // if set to a value other than -1, the number of rows cannot be changed to another value\n    readonly_allowfocus?:boolean\n    columns:any, // TO BE DONE\n    onCellChanged?:Function // callback\n}\n\ninterface IBaseControl {\n\n    getFieldHandler(): IFieldHandler,\n    setFieldHandler(IFieldHandler): void,\n\n    getValueAsync:(latestItem?:IItemGet) => Promise<unknown>,\n    hasChangedAsync:() => Promise<boolean>,\n    resizeItem:(width?:number, forceRedraw?:boolean) => void,\n    destroy:() => void,\n    // optional\n    highlightReferences?: () => void,\n    getText?:Function,\n    getValueRaw?:Function,\n    setValue?:Function,\n    updateItem?:Function,\n    refreshLinks?:Function, // update hyperlinks if there's any (can be smart links or lists of items)\n    linksToCreate?:Function,\n    labelsToSet?:Function,\n    redraw?:Function, // repaint all\n    refresh?:Function, // update row heights\n    needsLatest:boolean,\n    requiresContent?:() => boolean\n\n    // hacks...\n    disableDelayedShow?:boolean // if set to true, the display does not automatically show itself after a timeout (that's only done in tiny text editor(I think))\n}\n\n\ninterface IBaseControlOptions {\n    [key: string]: any,\n    controlState?:ControlState,\n    canEdit?: boolean,\n    help?: string,\n    fieldType?:string,\n    fieldId?:number,\n    valueChanged?: Function,\n    parameter?: IFieldParameter,\n    fieldValue?:any, // value as stored in DB\n    fieldHandler?: IFieldHandler,\n    isItem?:boolean,\n    item?:IItem,\n    isForm?:boolean,\n    isPrint?:boolean,\n    isTooltip?:boolean,\n    id?:string,\n    isHistory?:number, // version shown (if known)\n    type?:string,\n    isFolder?:boolean,\n    requiresContent?:boolean\n}\n\n\nabstract class BaseControl<T extends IFieldHandler> implements IBaseControl {\n    protected _root:JQuery;\n    disableDelayedShow:boolean // if set to true, the display does not automatically show itself after a timeout (that's only done in tiny text editor(I think))\n    needsLatest:boolean;\n\n    constructor( control:JQuery, fieldHandler:T ) {\n        this._root = control;\n        this.needsLatest = false;\n        this.fieldHandler = fieldHandler;\n    }\n    fieldHandler:T;\n     getFieldHandler(){\n         return this.fieldHandler;\n     }\n     setFieldHandler(fieldHandler:T) {\n         this.fieldHandler = fieldHandler;\n     }\n\n    protected createHelp (settings:IBaseControlOptions):JQuery {\n        var helpline = $(\"<span class='baseControlHelp'>\" + settings.help + \"</span>\");\n        helpline.data(\"fieldId\", settings.fieldId);\n        if (settings.parameter.externalHelp && settings.controlState !== ControlState.Print) {\n            var showHelp = $(\"<a href='https://\" + settings.parameter.externalHelp + \"' target='_blank'> <span class='fa fa-info-circle'></span></a>\");\n            helpline.append(showHelp);\n        }\n        if (settings.parameter.popupHelp && settings.controlState !== ControlState.Print) {\n            var showHelp = $(\"<span class='fa fa-question-circle showMore' style='padding-left:10px'></span>\");\n            showHelp.tooltip(<TooltipOptions>{\n                html: true,\n                title: settings.parameter.popupHelp,\n                container: 'body',\n                template: '<div class=\"tooltip smarttext-tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow smarttext-tooltip-arrow\"></div><div class=\"tooltip-inner smarttext-tooltip-inner\"></div></div>'\n            });\n            helpline.append(showHelp);\n        }\n        if (settings.parameter.inlineHelp && settings.controlState !== ControlState.Print) {\n            var showHelp = $(\"<div class='inlineHelp'>\");\n            showHelp.html(settings.parameter.inlineHelp);\n            helpline.append(showHelp);\n        }\n        return helpline;\n    }\n\n\n    abstract getValueAsync(): Promise<any>;\n    abstract hasChangedAsync(): Promise<boolean> ;\n    abstract resizeItem(newWidth?:number, force?:boolean): void;\n    abstract destroy(): void;\n}\n\n","import { app, ControlState, globalMatrix, IItemGet, matrixSession } from \"../../../globals\";\nimport { IDropdownOption } from \"../../../ProjectSettings\";\nimport {FieldHandlerFactory, MR1} from \"../../businesslogic/index\";\nimport { mDHF } from \"../../businesslogic/index\";\nimport { ml } from \"../../matrixlib\";\nimport { IBaseControlOptions } from \"./BaseControl\";\nimport { ISignaturesInfo } from \"./docBase.\";\nimport { DocSignImpl } from \"./docSign\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\nimport {EmptyFieldHandler} from \"../../businesslogic/FieldHandlers/EmptyFieldHandler\";\nimport {GenericFieldHandler} from \"../../businesslogic/FieldHandlers/GenericFieldHandler\";\n\nexport type {\n    IDocMarkAsTemplateOptions, IPasteSourceSetting, IPasteSource, ITempSignatures,\n    ITempSignature, ITemplateProjects\n};\nexport { MarkAsTemplateImpl };\n\ninterface IDocMarkAsTemplateOptions extends IBaseControlOptions {\n    controlState?: ControlState,\n    canEdit?: boolean,\n    help?: string,\n    fieldValue?:string,\n    valueChanged?: Function,\n    parameter?: {\n        inlineHelp?:string;\n    }\n\n}\ninterface IPasteSourceSetting {\n    templates:IPasteSource[];\n}\ninterface IPasteSource {\n    fromProject: string, // project where template comes from\n    fromSign: string, // template (a SIGN or a DOC)\n    fromName:string, // the name at time of publishing\n    fromDOC:string, // if SIGN, the DOC which was made a source\n    canUseIn:string[] // list of projects where template can be instantiated\n}\n\ninterface ITempSignatures {\n    signatures:ITempSignature[]\n}\ninterface ITempSignature {\n    user:string, // user to sign\n    datetime: string // date when it was signed\n}\n\n$.fn.markAsTemplate = function(this:JQuery, options:IDocMarkAsTemplateOptions) {\n\n     if (!options.fieldHandler) {\n        options.fieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, FieldDescriptions.Field_markAsTemplate, options);\n        options.fieldHandler.initData(JSON.stringify(options.fieldValue));\n    }\n    let baseControl = new MarkAsTemplateImpl(this, options.fieldHandler as GenericFieldHandler);\n    this.getController = () => { return baseControl;}\n    baseControl.init(options);\n    return this;\n}\n\ninterface ITemplateProjects {\n    projects:string[],\n    targets:string[]\n}\n\nclass MarkAsTemplateImpl extends DocSignImpl {\n    public static PROJECT_SETTING: string = \"templates\";\n    public static PROJECT_SETTING_Projects: string = \"templateProjects\";\n\n    private originalValue:ITempSignatures;\n    private newValue:ITempSignatures;\n    private pub:JQuery;\n    private publishTo:string[] = [];\n    constructor(control: JQuery,fieldHandler:GenericFieldHandler) {\n        super(control, fieldHandler);\n    }\n\n    private formatUserLogin(userLogin: string) {\n        return globalMatrix.ItemConfig.hasUserInfo(userLogin)\n            ? userLogin\n            : `<s>${userLogin}</s>`;\n    }\n\n    init(options: IDocMarkAsTemplateOptions) {\n        let that = this;\n\n        var defaultOptions = {\n            controlState: ControlState.FormView, // read only rendering\n            canEdit: false, // whether data can be edited\n            valueChanged: function() {\n            }, // callback to call if value changes\n            parameter: {\n                // item the item containing the rest of the information\n            }\n        };\n        this.settings = ml.JSON.mergeOptions(defaultOptions, options);\n\n        // changes shall not overwrite other people's changes\n        this.needsLatest=true;\n\n\n        // get current value\n        this.originalValue = <ITempSignatures> (this.settings.fieldValue?JSON.parse(this.settings.fieldValue):{\n            signatures:[]\n        });\n        this.newValue = ml.JSON.clone( this.originalValue );\n\n        if (options.controlState == ControlState.Tooltip) {\n            return;\n        }\n        let docTypes = mDHF.getDocumentFormTypes(); // [\"DOC\"]\n        let templateTypes = mDHF.getDocumentTemplatesTypes(); // [\"SIGN\"] could be [\"SIGN\",\"DOC\"]\n\n        if ( docTypes.indexOf( options.type) != -1 ) {\n            // in print version do not show anything\n            if (options.controlState == ControlState.Print ) {\n                return;\n            }\n            // this is a DOC, user needs to decide who needs to sign the template to release it\n            this.showSignatureTableEdit( );\n            return;\n        }\n\n        if ( templateTypes.indexOf(options.type) == -1) {\n            // neither a DOC not a SIGN...\n            this._root.html(\"config error: This category cannot be used as template - contact support.\");\n            return;\n        }\n\n        // so this is a SIGN and it's a DOC which still exists\n        let signs = this.getTemplateSignatureStatus();\n        if (signs.signatures.length == 0) {\n            // in print version do not show anything\n            if (options.controlState == ControlState.Print ) {\n                this.hideSignatureCtrl();\n            }\n            // this is a normal document as SIGN .. ignore all template  stuff\n            return;\n        }\n\n        // this is a SIGN or something which has been created from a DOC\n        let uplinks =  options.item.upLinkList?options.item.upLinkList.filter( function(uplink) { return docTypes.indexOf(ml.Item.parseRef(uplink.itemRef).type)!=-1} ):[];\n        if (uplinks && uplinks.length) {\n\n            // this is actually a template, so the template needs approvals\n\n            // hide signature box\n            this.hideSignatureCtrl( );\n\n            // print approval box / template publishing feature\n            if ( signs.missingSignatures ) {\n                if (this.settings.help.indexOf(\"|\")!=-1 && this.settings.help.lastIndexOf(\"|\")!=-1)\n                this.settings.help = this.getHelpPart(1)?this.getHelpPart(1):( this.settings.help +  \" - (required approvals)\");\n                if ( this.settings.parameter && this.settings.parameter.inlineHelp && this.settings.parameter.inlineHelp.indexOf(\"|\")!=-1) {\n                    this.settings.parameter.inlineHelp =  this.settings.parameter.inlineHelp.split(\"|\")[0];\n                }\n                let help = this._root.append(super.createHelp( this.settings));\n                this.pub  = $(\"<div class='baseControl'>\").appendTo(this._root);\n                this.askForSignatures(signs);\n            } else {\n                this.settings.help  = this.getHelpPart(2)?this.getHelpPart(2):( this.settings.help +  \" - (distribution to projects)\");\n                let help = this._root.append(super.createHelp( this.settings));\n                if ( this.settings.parameter && this.settings.parameter.inlineHelp && this.settings.parameter.inlineHelp.indexOf(\"|\")!=-1) {\n                    this.settings.parameter.inlineHelp =  this.settings.parameter.inlineHelp.split(\"|\")[0];\n                }\n                this.pub  = $(\"<div class='baseControl'>\").appendTo(this._root);\n                let vl = ml.Item.parseRef(uplinks[0].itemRef).id;\n                if (signs.signatures.length > 0 ) {\n                    let approvedBy = $(\"<div class='inlineHelp approvedBy'>\").appendTo( this.pub);\n                    let text = \"Approved by \";\n                    $.each( signs.signatures, function(sidx,s) {\n                        text += that.formatUserLogin(s.userid) + \" (\" + ml.UI.DateTime.renderHumanDate(new Date(s.signDate)) + \" )\" + ((sidx < signs.signatures.length - 1) ? \", \" : \"\");\n                    });\n\n                    approvedBy.html(text);\n                }\n                if (options.controlState == ControlState.Print ) {\n                    return;\n                }\n                this.showProjects(vl, options.id );\n            }\n        } else {\n            let help = this._root.append(super.createHelp(this.settings));\n            this.pub  = $(\"<div class='baseControl'>\").appendTo(this._root);\n            this.pub.html(\"Cannot be used as template: underlying \" + docTypes.join(\",\") + \" has been deleted.\")\n        }\n\n    }\n\n    private getHelpPart( part:number ) {\n        let parts = this.settings.help.split(\"|\");\n        return (parts.length==3)?parts[part]:null;\n    }\n    // public interface\n    async hasChangedAsync() {\n\n        return  JSON.stringify( this.originalValue ) != JSON.stringify( this.newValue );\n    }\n    async getValueAsync() {\n        return JSON.stringify( this.newValue );\n    }\n    setValue(  ) {\n        return \"\";\n    }\n\n    destroy() {\n    }\n    resizeItem() {\n\n    }\n\n    static getRequiredApprovals(value:string) {\n        let required:string[] = [];\n\n        if (!value) return required;\n        let jval = <ITempSignatures>JSON.parse(value);\n        if (!jval.signatures) return required;\n\n        for (let idx=0;idx<jval.signatures.length;idx++) {\n            if (!jval.signatures[idx].datetime) {\n                required.push(jval.signatures[idx].user);\n            }\n        }\n\n        return  required;\n    }\n\n    static getTemplateSignatureStatus(value:string):ISignaturesInfo {\n        let signatureStatus: ISignaturesInfo = {\n            signatures:[],\n            missing:[],\n            given:[],\n            signatureDate:{},\n            missingSignatures:0,\n            givenSignatures:0,\n            needSignature:false,\n            hasSignature:false,\n            isTemplate:true\n        }\n        if (!value) return signatureStatus;\n        let jval = <ITempSignatures>JSON.parse(value);\n        if (!jval.signatures) return signatureStatus;\n        // matrixspecs\n\n        $.each(jval.signatures, function (key, val) {\n            if ( val.user ) { // workaround handle existing docs with BUG MATRIX-2442 correctly\n                signatureStatus.signatures.push( {orgid: val.user, userid: val.user,signDateCustomer:ml.UI.DateTime.renderHumanDate( new Date(val.datetime)), signDate: val.datetime, signaturefileid:\"\"});\n                if (val.datetime) {\n                    signatureStatus.given.push(val.user);\n                    signatureStatus.givenSignatures++;\n                    signatureStatus.hasSignature = signatureStatus.hasSignature || (val.user == matrixSession.getUser());\n                } else  {\n                    signatureStatus.missing.push(val.user);\n                    signatureStatus.missingSignatures++;\n                    signatureStatus.needSignature = signatureStatus.needSignature || (val.user == matrixSession.getUser());\n                }\n                signatureStatus.signatureDate[val.user] = ml.UI.DateTime.renderHumanDate( new Date(val.datetime));\n            }\n        });\n        return signatureStatus;\n    }\n\n\n    static removeFromTemplates(deletedItems:string[]) {\n        let cached = <IPasteSourceSetting>globalMatrix.ItemConfig.getSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING);\n\n        // check if any item is used as template if not // nothing to do\n        if (!cached || !cached.templates || cached.templates.filter( function(temp){ return deletedItems.indexOf(temp.fromSign)!=-1;} ).length == 0) {\n            return;\n        }\n        // get most recent setting\n        app.readSettingJSONAsync(MarkAsTemplateImpl.PROJECT_SETTING).done(function (templates: IPasteSourceSetting) {\n\n            templates.templates =  templates.templates.filter( function(temp){ return deletedItems.indexOf(temp.fromSign)==-1;});\n            app.setSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING, templates);\n        });\n    }\n\n    private hideSignatureCtrl( ) {\n        $(\".ft_signatureControl\").hide();\n        window.setTimeout( function() {\n            // just to be sure...\n            $(\".ft_signatureControl\").hide();\n        }, 100);\n    }\n    private showProjects(sourceDoc:string, sourceSign:string) {\n        let that = this;\n\n        // get current project setting\n        app.readSettingJSONAsync(MarkAsTemplateImpl.PROJECT_SETTING).done(function (result) {\n            let templates = <IPasteSourceSetting>result;\n            if (!templates || !templates.templates  ) {\n                templates = {templates:[]};\n            }\n\n            // print table\n            that.publishTo = [];\n            that.showCurrentUsages(templates.templates, sourceDoc, sourceSign);\n            let pb = $(\"<button id='pubTemp' class='btn btn-default btn-sm'>Publish as template for selected projects</button>\").appendTo(that.pub);\n            pb.click( function() {\n                // make sure to have latest and greatest\n                app.readSettingJSONAsync(MarkAsTemplateImpl.PROJECT_SETTING).done(function (result) {\n                    templates = <IPasteSourceSetting>result;\n                    if (!templates || !templates.templates  ) {\n                        templates = {templates:[]};\n                    }\n                    // update\n                    $.each(templates.templates, function (idx, ps) {\n                        if (ps.fromProject == matrixSession.getProject() && ps.fromSign != sourceSign) {\n                            if (ps.fromDOC == sourceDoc) {\n                                // for other items based on the same docs, remove everything which is being published somewhere else\n                                ps.canUseIn = ps.canUseIn.filter( function(p) {\n                                    let doPublish = that.publishTo.indexOf(p)!=-1;\n                                    return !doPublish;\n                                });\n                            }\n                        }\n                    });\n                    // remove templates which are not visible in any projects\n                    templates.templates = templates.templates.filter( function(temp){\n                        return temp.canUseIn.length > 0;});\n                    // remove publishing info for this sign\n                    templates.templates = templates.templates.filter( function(temp){\n                        return temp.fromProject != matrixSession.getProject() || temp.fromSign != sourceSign\n                    });\n                    // add publishing info for this sign\n                    templates.templates.push({ fromProject: matrixSession.getProject(), fromDOC: sourceDoc, fromSign: sourceSign, fromName: app.getItemTitle(sourceSign), canUseIn: ml.JSON.clone(that.publishTo) })\n\n                    app.setSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING, templates).done(function () {\n                        that.pub.html(\"\");\n                        that.showProjects(sourceDoc, sourceSign);\n                    });\n                });\n            });\n        });\n\n    }\n\n    private showCurrentUsages(current:IPasteSource[], sourceDoc:string, sourceSign:string) {\n        let that = this;\n\n        // figure out what is currently used as template\n        let others:string[] = [];\n        $.each(current, function (idx, ps) {\n            if (ps.fromProject == matrixSession.getProject()) {\n                if ( ps.fromSign == sourceSign) {\n                    // this is currently published\n                    that.publishTo = ps.canUseIn;\n                } else if ( ps.fromDOC == sourceDoc) {\n                    // another version of DOC is used as template in some projects\n                    others = others.concat(ps.canUseIn);\n                }\n            }\n        });\n\n        let projects = matrixSession.getProjectList(false).filter(function (p) { return p.shortLabel != \"EMPTY\" && p.shortLabel != matrixSession.getProject(); });\n\n        let templateProjects = <ITemplateProjects>matrixSession.getCustomerSettingJSON(MarkAsTemplateImpl.PROJECT_SETTING_Projects);\n        if (templateProjects && templateProjects.targets && templateProjects.targets.length) {\n            projects = projects.filter( function(p)  {return templateProjects.targets.indexOf(p.shortLabel)!=-1; });\n        }\n\n        let hasUsedOther = false; // whether some have other published versions\n        $.each(projects, function( idx, project) {\n            var short = project.shortLabel;\n            hasUsedOther = hasUsedOther || others.indexOf(project.shortLabel)!=-1;\n\n            var cb = $(\"<div>\").appendTo(that.pub).checkBox({\n                canEdit: true,\n                help: (others.indexOf(project.shortLabel)!=-1?\"* \":\"\") + project.shortLabel + \" - \" + project.label,\n                valueChanged: async function () {\n                    if (await cb.getController().getValueAsync()) {\n                        that.publishTo.push(short);\n                    } else {\n                        that.publishTo = that.publishTo.filter(function (p) {\n                            return p != short\n                        });\n                    }\n                    $(\"#pubTemp\").addClass(\"btn-success\");\n                },\n                parameter: {},\n                fieldValue:  that.publishTo.indexOf(project.shortLabel)==-1 ? \"0\" : \"1\"\n            });\n\n        });\n\n        if (hasUsedOther) {\n            $(\"<div>\").appendTo(that.pub).html(\"* Some project(s) use another version of template\");\n        }\n    }\n\n    // show a table in DOC, where author can decide who needs to sign to release the document\n    private showSignatureTableEdit() {\n        let that = this;\n\n        var userDropdown:IDropdownOption[] = [];\n        var userList = globalMatrix.ItemConfig.getUserNames();\n        for (var udx = 0; udx < userList.length; udx++) {\n            userDropdown.push({id: userList[udx ].login.toLowerCase(), label: userList[udx ].login.toLowerCase()});\n        }\n        let dd = $(\"<div>\").appendTo( this._root );\n\n        let cb = that.settings.valueChanged;\n\n        let userSelectionChanged = async function () {\n            let val = await dd.getController().getValueAsync();\n            if (val) {\n                that.newValue = {\n                    // MATRIX-4764 Don't save deleted user.\n                    signatures: MarkAsTemplateImpl.removeDeletedUsers(val.split(\",\")).map(function (usr: string) {\n                        return {user: usr, datetime: \"\"}\n                    })\n                };\n            } else { // fix MATRIX-2442\n                that.newValue = {\n                    signatures: []\n                };\n            }\n            if (cb) {\n                cb.apply(null);\n            }\n\n        }\n        let params = {\n            fieldValue: that.originalValue.signatures.map( function(us) {return us.user;}).join(\",\"),\n            canEdit:true,\n            help: that.getHelpPart(0)?that.getHelpPart(0):(that.settings.help + \" - (required approvals)\"),\n            parameter: {\n                placeholder: \"select user who need to sign template\",\n                create: false,\n                options: userDropdown,\n                maxItems: 100,\n                sort: true,\n                inlineHelp: (that.settings.parameter && that.settings.parameter.inlineHelp)?that.settings.parameter.inlineHelp:\"\"\n            },\n            valueChanged: userSelectionChanged\n        }\n\n        dd.mxDropdown(params);\n\n        //Fix for MATRIX-4764 Problem with Template approver and deleted users\n        let missingUser = that.originalValue.signatures.filter(sig => globalMatrix.ItemConfig.getUserNames().findIndex(user => user.login.toLowerCase() == sig.user) == -1);\n        if(missingUser.length >0 )\n        {\n           let cleanupUserList =   (a)=> {\n                ml.UI.showAck(-1,  \"These users has been removed sinced they are no longer active : <ul style='margin-left:80px'>\" + missingUser.map(o=> \"<li style='text-align:left;'>\" + o.user + \"</li>\" ).join(\"\") + \"</ul> Please save to correct.\",\n                    \"User list has been cleaned in '\" + params.help +\"'\" )\n                userSelectionChanged();\n                MR1.onItemDisplayed().unsubscribe(cleanupUserList);\n            }\n            MR1.onItemDisplayed().subscribe(this, cleanupUserList ) ;\n        }\n\n    }\n    static removeDeletedUsers(userList: string[]): string[] {\n        return userList.filter(u => globalMatrix.ItemConfig.getUserNames().findIndex(un => un.login.toLowerCase() == (<String>u).toLowerCase()) != -1)\n    }\n\n    private getTemplateSignatureStatus():ISignaturesInfo {\n\n        return MarkAsTemplateImpl.getTemplateSignatureStatus( JSON.stringify(this.originalValue));\n    }\n\n    // ask for signatures\n    private askForSignatures(signatureStatus:ISignaturesInfo) {\n        let that = this;\n\n        let uiCtrl = $(\"<div>\").appendTo(this.pub);\n        // render a signature table with current status if there is 1+ signature in document\n        this.renderSignatureTable(signatureStatus, uiCtrl, \"not yet approved\", \"you need to approve this template\", \"approved at\");\n        if (this.settings.controlState == ControlState.Print || this.settings.controlState == ControlState.Tooltip ) {\n            return;\n        }\n        // show signature box unless user needs to sign or this is a tooltip, print or other special view\n        this.showSignatureField(signatureStatus,uiCtrl, $(uiCtrl.find(\"td\")[0]).width(), \"Approve\", function (pwd:string) {\n            that.signTemplate(pwd);\n        }, true);\n    }\n\n    protected signTemplate( pwd:string ) {\n        let that = this;\n\n\n        app.checkPassword(pwd).done(function () {\n\n            // pwd is correct\n\n            // get item with most current approvals\n            app.getItemAsync(that.settings.id).done(function (item: IItemGet) {\n\n                let current = (<any>item)[that.settings.fieldId];\n\n                that.originalValue = <ITempSignatures> (current?JSON.parse(current):{\n                    signatures:[]\n                });\n                that.newValue = <ITempSignatures> ml.JSON.clone( that.originalValue );\n                $.each( that.newValue.signatures, function(idx, sig){\n                    if (sig.user == matrixSession.getUser()) {\n                        sig.datetime = new Date().toJSON();\n                    }\n                });\n\n                app.saveAsync(false);\n            }).fail( function(error) {\n                ml.UI.showError(\"cannot approve template\", error);\n            });\n        }).fail( function(error) {\n            ml.UI.showError(\"invalid password\", \"\");\n        });\n    }\n}\n","\nimport {FieldHandlerFactory, MR1} from \"../../businesslogic/index\";\nimport { IDHFControlDefinitionValue, mDHF } from \"../../businesslogic/index\";\nimport { IBaseControlOptions } from \"./BaseControl\";\nimport { DocBaseImpl, ISignaturesInfo } from \"./docBase.\";\nimport { ml } from \"./../../matrixlib\";\nimport { XRGetUser_AllUsers_GetUserListAck, XRGetTodosAck, XRTodo } from \"../../../RestResult\";\nimport { UserControl } from \"../Parts/UserControl\";\nimport { IDropDownButtonOption, UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\";\nimport { ControlState, globalMatrix, matrixSession, restConnection, IItemGet, app, IItem } from \"../../../globals\";\nimport {ITableConfigColumn} from \"../../businesslogic/FieldHandlers/Document/GenericTableDocHandler\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\nimport {EmptyFieldHandler} from \"../../businesslogic/FieldHandlers/EmptyFieldHandler\";\nimport {GenericFieldHandler} from \"../../businesslogic/FieldHandlers/GenericFieldHandler\";\n\nexport type { IDocSignOptions, ISignData, ISignComment, ISignature, ISignatureChange };\nexport { DocSignImpl };\n\ninterface IDocSignOptions extends IBaseControlOptions {\n    controlState?: ControlState,\n    canEdit?: boolean,\n    help?: string,\n    fieldValue?:string,\n    valueChanged?: Function,\n    parameter?: {\n        inlineHelp?:string;\n    }\n}\n\ninterface ISignData {\n    rejectComments:ISignComment[],\n    acceptComments:ISignComment[]\n}\n\ninterface ISignComment {\n    user:string, comment:string, createdAt:string\n}\n\n$.fn.docSign = function(this:JQuery, options:IDocSignOptions) {\n\n     if (!options.fieldHandler) {\n        //No need for a field handler here, so let's create a dummy one.\n        options.fieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, FieldDescriptions.Field_dummy, options);\n        options.fieldHandler.initData(options.fieldValue);\n    }\n    let baseControl = new DocSignImpl(this, options.fieldHandler as GenericFieldHandler);\n    this.getController = () => { return baseControl;}\n    baseControl.init(options);\n\n    return this;\n}\n\n// TODO(modules): There is an ISignature here, and another in docReview.ts, missing field orgid. What to do?\ninterface ISignature {\n    orgid: string, // originally user to sign from version 2.3 it can be different if it was changed using the proxy feature\n    userid: string, // user id of the user who is supposed to sign\n    signDate: string,\n    signDateCustomer?:string,\n    signaturefileid:string\n}\n\ninterface ISignatureChange {\n    action:string,\n    value:string\n}\n\nclass DocSignImpl extends DocBaseImpl {\n\n    protected settings: IDocSignOptions;\n    private data:ISignData;\n    private uiCtrl:JQuery;\n    private static iHaveSignature = false;\n    private static iUser = \"\";\n\n    constructor(control: JQuery, fieldHandler: GenericFieldHandler) {\n        super(control, fieldHandler);\n    }\n\n    init( options:IDocSignOptions ) {\n        let that = this;\n\n        this._root.append(super.createHelp(options));\n        this.uiCtrl = $(\"<div class='baseControl'>\").appendTo(this._root);\n\n        //this.uiCtrl.append(\"<div style='color:red'>BETA</div>\");\n\n        let defaultOptions = {\n            controlState: ControlState.FormView, // read only rendering\n            canEdit: false, // whether data can be edited\n            valueChanged: function () {\n            }, // callback to call if value changes\n            parameter: {\n                // item the item containing the rest of the information\n            }\n        };\n        this.settings = ml.JSON.mergeOptions(defaultOptions, options);\n\n        // changes shall not overwrite other people's changes\n        this.needsLatest=true;\n\n        this.data = this.parseValue( this.settings.fieldValue );\n\n        if (this.data.rejectComments && this.data.rejectComments.length) {\n            $.each( this.data.rejectComments, function(rcidx, rejectComment) {\n                that.uiCtrl.append(`<div style='color:red'>Document was rejected by <b>${rejectComment.user}</b> at <b>${ml.UI.DateTime.renderHumanDate( new Date(rejectComment.createdAt))}</b>. Reason was:</div>`);\n                let reason = $(`<div'>${rejectComment.comment}</div>`).appendTo(that.uiCtrl);\n                reason.highlightReferences();\n            });\n        } else {\n            // document was not rejected\n            let signatureStatus = DocBaseImpl.readSignatureInfo(this.settings.item);\n\n            // render a signature table with current status if there is 1+ signature in document\n            this.renderSignatureTable(signatureStatus, this.uiCtrl,\"not yet signed\",\"you need to sign this document\",\"signed at\");\n\n            // show signature box unless user needs to sign or this is a tooltip, print or other special view\n            if (signatureStatus.needSignature) {\n                if (globalMatrix.ItemConfig.canSign(options.type)) {\n                    this.showSignatureField(signatureStatus, this.uiCtrl, $(this.uiCtrl.find(\"td\")[0]).width(), \"Sign\", function (pwd:string) {\n                        that.signDocument(pwd);\n                    }, false);\n                }\n                else {\n                    this._root.append(\"<div class='inlineHelp'>You have no rights to sign documents</div>\");\n                }\n            }\n\n            if ( !that.isMe(DocSignImpl.iUser) ) {\n                DocSignImpl.iUser = matrixSession.getUser();\n                restConnection.getServer(\"user\").done(function (allUsers: XRGetUser_AllUsers_GetUserListAck) {\n                    DocSignImpl.iHaveSignature = false;\n                    for (var idx = 0; idx < allUsers.user.length; idx++) {\n                        if ( that.isMe(allUsers.user[idx].login )) {\n                            DocSignImpl.iHaveSignature = allUsers.user[idx].signatureImage !== \"\";\n                        }\n                    }\n                });\n            }\n\n        }\n\n    }\n\n    // initialize options\n    // public interface\n    async hasChangedAsync () {\n        return false;\n    }\n\n    async getValueAsync(currentItem?:IItemGet) {\n        let that = this;\n\n        return JSON.stringify(this.data);\n    }\n\n    destroy() {\n    }\n\n    resizeItem () {\n        let width =  Math.max(100, $(this.uiCtrl.find(\"td\")[0]).width());\n        $(\"input.signatureInfo\", this.uiCtrl).width( width );\n    }\n\n    private parseValue( fieldVal:string ):ISignData {\n        if (fieldVal) {\n            return <ISignData>JSON.parse(fieldVal);\n        } else {\n            return <ISignData> {\n                rejectComments:[]\n            }\n        }\n    }\n\n    // try to get additional info from original DOC signature table. and than draw the UI\n    protected addSignMeaning(uiCtrl:JQuery) {\n        let that = this;\n\n        let itemId = app.getCurrentItemId();\n        if (ml.Item.parseRef(itemId).type != \"SIGN\" || !globalMatrix.ItemConfig.getDHFConfig().showOriginalSignMeaning) {\n            return;\n        }\n\n        let dhfFields = globalMatrix.ItemConfig.getFieldsOfType(\"dhf\").map(field => \"\" + field.field.id);\n        // get the parent DOC\n        mDHF.getBaseDOCofSIGN(matrixSession.getProject(), that.settings.item).done((theDoc: IItem) => {\n            for ( let field in theDoc) {\n\n                let meanings = mDHF.getSignatureMeanings()?mDHF.getSignatureMeanings():{};\n\n                if (dhfFields.indexOf(field)!=-1 && theDoc[field]) {\n                    let dhfField =  <IDHFControlDefinitionValue>JSON.parse(theDoc[field]);\n                    if (dhfField.type == \"signaturebox\" && dhfField.fieldValue && dhfField.ctrlConfig && (<any>dhfField.ctrlConfig).columns) {\n                        let columns = <ITableConfigColumn[]>(<any>dhfField.ctrlConfig).columns;\n                        let meaningColumn = columns.filter( c => c.columnType == \"type6\");\n                        let userColumn = columns.filter( c => c.columnType == \"type4\");\n                        if (meaningColumn.length && userColumn.length) {\n                            let meaningColumnField = meaningColumn[0].field;\n                            let userColumnField = userColumn[0].field;\n                            let signTable = JSON.parse(dhfField.fieldValue) ;\n                            for (let signDef of signTable ) {\n                                let user = signDef[userColumnField];\n                                let meaning = signDef[meaningColumnField];\n                                let meaningHuman = meanings[meaning]?meanings[meaning]:meaning;\n                                if (user && meaningHuman) {\n                                    $.each( $(\"tr\", $(\".signatureTable\")), (rowIdx, row) => {\n                                        let hasUser=false;\n                                        $.each( $(\"td\", $(row)), (tdIdx, td) => {\n                                            if ($(td).text() == user) hasUser = true;\n                                        });\n                                        if (hasUser) {\n                                            let meaningTd = $(\".OriginalSignMeaning\", $(row));\n                                            let current = $(meaningTd).text();\n                                            current = (current?(current+\", \"):\"\") + meaningHuman;\n                                            $(meaningTd).text(current);\n                                        }\n                                    });\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n         }).fail( () => {\n            ml.Logger.error( \"no original parent of DOC found, columns with signature meaning stays empty...\")\n        });\n    }\n\n    // render signature table (maybe with some extra info from DOC)\n    protected renderSignatureTable(signatureInfo: ISignaturesInfo, uiCtrl:JQuery, notSigned:string, youSign:string, signedAt:string) {\n        let that = this;\n\n        if (signatureInfo.signatures.length === 0) {\n             $(\"<div style='margin-bottom: 12px;'><span class='searchResult'>no signatures required</span></div>\").appendTo( uiCtrl );\n            return;\n        }\n        let sigInfo = $(\"<div class='sigInfo'>\").appendTo( uiCtrl );\n        let statusTable = $(\"<table class='signatureTable table table-bordered'>\");\n        let ctrlContainer = $(\"<div class='baseControl'>\");\n\n        sigInfo.append(ctrlContainer.append(statusTable));\n        let body = $(\"<tbody>\");\n        statusTable.append(body);\n\n        let hasSignComment = false;\n        for (let idx = 0; idx < signatureInfo.signatures.length; idx++) {\n            let needSign = $(\"<td>\").html(\"<span class='needsSignature'>\"+notSigned+\"</span>\");\n            if ( this.isMe(signatureInfo.signatures[idx].userid) && !signatureInfo.signatures[idx].signDate) {\n                needSign = $(\"<td>\").html(\"<span class='needsSignature'>\"+youSign+\"</span>\");\n            }\n            let dateCustomer = signatureInfo.signatures[idx].signDateCustomer;\n\n            let tr = $(\"<tr>\");\n\n            let user = signatureInfo.signatures[idx].userid;\n            let orgid = signatureInfo.signatures[idx].orgid;\n            let userDisplayString = globalMatrix.ItemConfig.hasUserInfo(user) ? user : `<s>${user}</s>`;\n            let userText = `<span title=\"${globalMatrix.ItemConfig.getFullName(user)}\">${userDisplayString}</span>`\n            if ( orgid && orgid != user ) {\n                userText += `<span class=\"proxyInfo\">(proxy for  <span title=\"${globalMatrix.ItemConfig.getFullName(orgid)}\">${orgid}</span>)</span>`;\n            }\n            if (globalMatrix.ItemConfig.getDHFConfig().showOriginalSignMeaning) {\n                tr.append($(`<td class='OriginalSignMeaning'>`));\n            }\n            if (dateCustomer) {\n                tr.append($(\"<td>\").html(userText));\n                let signed = $(\"<td>\").appendTo(tr);\n                signed.append($(\"<span>\").html(signedAt + \" \" + dateCustomer));\n\n\n                if (globalMatrix.ItemConfig.getDHFConfig().signedMeaning) {\n                    let commentCol = $(\"<td class='commentCol'>\").appendTo(tr);\n                    if (that.data.acceptComments) {\n                        let acceptComment = that.data.acceptComments.filter( comment => comment.user == user && comment.comment);\n                        if ( acceptComment.length ) {\n                            hasSignComment = true;\n                            commentCol.append($(\"<div>\").html(acceptComment[acceptComment.length-1].comment));\n                        }\n                    }\n                }\n\n            } else if (globalMatrix.ItemConfig.getDHFConfig().proxyRights && matrixSession.amIAllowedUser(globalMatrix.ItemConfig.getDHFConfig().proxyRights) && that.settings.canEdit) {\n                let tdUser = $(\"<td>\").html(`<span>${userText}</span> <button data-proxy=\"${user}\" class=\"proxy btn btn-xs\" style=\"float:right\">proxy</button>`);\n                tr.append(tdUser);\n                tr.append(needSign);\n                if (globalMatrix.ItemConfig.getDHFConfig().signedMeaning) {\n                    let commentCol = $(\"<td class='commentCol'>\").appendTo(tr);\n                }\n            } else {\n                tr.append($(\"<td>\").html(userText));\n                tr.append(needSign);\n                if (globalMatrix.ItemConfig.getDHFConfig().signedMeaning) {\n                    $(\"<td class='commentCol'>\").appendTo(tr);\n                }\n            }\n\n            body.append(tr);\n        }\n        if (!hasSignComment) {\n            $(\".commentCol\").hide();\n        }\n        // fill column with sign meaning from DOC\n\n        if (globalMatrix.ItemConfig.getDHFConfig().showOriginalSignMeaning) {\n            this.addSignMeaning(uiCtrl);\n        }\n\n        // handle proxy button\n        $(\".proxy\").click( function(event) {\n            let btn = $(event.delegateTarget);\n            let user = btn.data(\"proxy\");\n\n            if (app.needsSave()) {\n                ml.UI.showError(\"Cannot change user\", \"You need to save first.\");\n                return;\n            }\n\n            ml.UI.SelectUserOrGroup.showSingleSelectDialog( user, \"Select Proxy\", \"Replaces required signature\", true,false,  ( newUser ) => {\n                if (newUser == user) {\n                    // nothing changed\n                    return;\n                }\n                if (signatureInfo.signatures.map(info => info.userid).indexOf( newUser ) !=-1) {\n                    ml.UI.showError(\"User exists\", \"The same user cannot sign for two\")\n                    return;\n                }\n                let signatureFieldId = globalMatrix.ItemConfig.getFieldsOfType(\"signature\", \"SIGN\")[0].field.id;\n                let update = {id:that.settings.item.id , onlyThoseFields:1,onlyThoseLabels:1};\n                let oldSign = that.settings.item[signatureFieldId];\n                let newSign = oldSign.replace( `user=\"${user}\" userId=\"${that.getUserId(user)}\"`,`user=\"${newUser}\" userId=\"${that.getUserId(newUser)}\"`);\n                (<any>update)[\"fx\"+signatureFieldId] = newSign;\n\n                app.updateItemInDBAsync(update, \"proxy change\").done(function () {\n\n                    app.treeSelectionChangeAsync(that.settings.item.id);\n                    that.removeNotifications( that.settings.item.id, user );\n                });\n\n            }, null);\n\n        });\n\n    }\n\n    // remove signature notifications for one or more users\n    protected removeNotifications( itemId:string, user?:string ){\n        let that = this;\n\n        if (!globalMatrix.ItemConfig.getDHFConfig().fixNotifications) {\n            return;\n        }\n        restConnection.getProject(\"todo?includeFuture=0&itemRef=\" + itemId).done(function (allNotification: XRGetTodosAck) {\n            let toDelete = allNotification.todos.filter( todo => todo.action && todo.action.todoType ==\"needSignature\" && (!user || user==todo.login ));\n            that.removeNotificationsRec(toDelete,0);\n        });\n    }\n\n    protected removeNotificationsRec(toDelete: XRTodo[], idx:number ) {\n        let that = this;\n        if (idx>=toDelete.length) return;\n        restConnection.deleteServerAsync(matrixSession.getProject() + \"/todo/\" + toDelete[idx].todoId, {}).done(() => {\n            that.removeNotificationsRec(toDelete, idx+1);\n        });\n    }\n    protected getUserId(login:string) {\n        let user = globalMatrix.ItemConfig.getUserNames().filter(info => info.login == login);\n        if (user.length != 1) return 0;\n        let userId = user[0].id;\n        if (userId == -1) {\n            // this is a user who has access only through a user group. get the real id\n            $.each(globalMatrix.ItemConfig.getUserGroups(), function (ugIdx, ug) {\n                $.each( ug.membership, function(mIdx,m) {\n                    if ( m.login == login) {\n                        userId = m.userId;\n                    }\n                });\n            });\n        }\n        return userId\n    }\n\n    protected showSignatureField(signatureInfo: ISignaturesInfo, uiCtrl:JQuery, columnSize:number, btnName:string, onSign:(pwd:string)=> void, templateApproval:boolean) {\n        let that = this;\n\n        if (!signatureInfo.needSignature || this.settings.controlState === ControlState.Print || this.settings.controlState === ControlState.Tooltip || this.settings.controlState === ControlState.HistoryView || this.settings.locked) {\n            return;\n        }\n\n        var needEnterUserName = matrixSession.getCustomerSetting(\"needEnterUserName\") == \"1\";\n\n        new UserControl().askForPassword( uiCtrl, btnName, !needEnterUserName, Math.max(100,columnSize), (name, pwd) => {\n            if (!pwd) {\n                ml.UI.showError(\"You must supply a password to sign the document\", \"\");\n            } else if (needEnterUserName && name != matrixSession.getUser()) {\n                 ml.UI.showError(\"Please provide your user id\", \"\");\n            } else {\n                onSign(pwd);\n            }\n        });\n        if (!templateApproval) {\n            if (globalMatrix.ItemConfig.getDHFConfig().signatureHint) {\n                $(\".signatureInfo button\").html(globalMatrix.ItemConfig.getDHFConfig().canReject ? \"Reject/Sign*\" : \"Sign*\")\n                uiCtrl.append(`<div class=\"inlineHelp\" style=\"margin-top:12px;font-size:smaller\">* ${globalMatrix.ItemConfig.getDHFConfig().signatureHint}</div>`);\n            }\n            if (globalMatrix.ItemConfig.getDHFConfig().canReject || globalMatrix.ItemConfig.getDHFConfig().signedMeaning) {\n                // replace the sign button by a dropdown\n                this.replaceSignButton();\n            }\n        }\n    }\n\n    // make the sign button a drop down menu with different options\n    protected replaceSignButton() {\n        let that = this;\n        let ddOptions: IDropDownButtonOption[] = [];\n        if (globalMatrix.ItemConfig.getDHFConfig().signedMeaning && globalMatrix.ItemConfig.getDHFConfig().signedMeaning.length) {\n            for (let meaning of globalMatrix.ItemConfig.getDHFConfig().signedMeaning) {\n                ddOptions.push({ name:meaning,click: () => {that.signFromDropdown( meaning );}});\n            }\n        } else {\n            // normal sign\n            ddOptions.push({ name:\"Sign\",click: () => {that.signFromDropdown( );}});\n        }\n        if (globalMatrix.ItemConfig.getDHFConfig().canReject) {\n            ddOptions.push({ name:\"Reject\",click: () => {\n                if (globalMatrix.ItemConfig.getDHFConfig().rejectWithoutPass) {\n                    that.rejectSign();\n                } else {\n                    that.rejectSignWithPass();\n                }\n            }});\n        }\n\n        $(\".signatureInfo button\").replaceWith( ml.UI.createDropDownButton($(\".signatureInfo button\").html(), ddOptions, false, \"signBtn\", true));\n        $(\"ul\", $(\".signatureInfo\")).addClass(\"pull-right\");\n\n    }\n    protected rejectSignWithPass() {\n        let pwd = $(\".signatureInfo input[placeholder='password']\").val();\n        let name = $(\"input.signatureInfo\").val();\n        let needEnterUserName = matrixSession.getCustomerSetting(\"needEnterUserName\") == \"1\";\n        if (!pwd) {\n            ml.UI.showError(\"You must supply a password to reject the document\", \"\");\n        } else if (needEnterUserName && name != matrixSession.getUser()) {\n            ml.UI.showError(\"Please provide your user id\", \"\");\n        } else {\n            app.checkPassword(pwd).done(() => {\n                this.rejectSign();\n            }).fail( () => {\n                ml.UI.showError(\"Incorrect Password\", \"\");\n            });\n        }\n    }\n\n    // ask user for comment and reject SIGN\n    protected rejectSign() {\n        let that = this;\n\n        let subj = $(\"<div>\").richText({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help:\"Reject message\",\n            fieldValue:\"\",\n            valueChanged: function () {\n            }, // callback to call if value changes\n            parameter: {}\n        });\n\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n        let ui = $(\"<div style='width:100%;height:100%'>\");\n\n        ui.append(subj);\n\n        ui.addClass(\"dlg-no-scroll\");\n        ui.removeClass(\"dlg-v-scroll\");\n\n        ml.UI.showDialog( dlg, \"Reject SIGN\", ui, -730, -470,\n        [{\n            text: 'Reject',\n            class: 'btnDoIt',\n            click: async function () {\n                let text = await subj.getController().getValueAsync();\n                if (globalMatrix.ItemConfig.getDHFConfig().rejectNeedsComment && !text) {\n                    return false;\n                }\n                restConnection.putProject(`sign/${that.settings.item.id}`, {rejectSign: (text ? text : \"rejected\")}).done(() => {\n                    app.treeSelectionChangeAsync(that.settings.item.id);\n                });\n                dlg.dialog(\"close\");\n            }\n        }, {\n            text: 'Cancel',\n            class: 'btnCancelIt',\n            click: function () {\n                dlg.dialog(\"close\");\n            }\n        }]\n            , UIToolsConstants.Scroll.None, false, false, () => { dlg.remove(); }, () => { $(\"input\", subj).focus(); }, () => { });\n    }\n\n    protected signFromDropdown( meaning?:string ) {\n        let pwd = $(\".signatureInfo input[placeholder='password']\").val();\n        let name = $(\"input.signatureInfo\").val();\n        let needEnterUserName = matrixSession.getCustomerSetting(\"needEnterUserName\") == \"1\";\n        if (!pwd) {\n            ml.UI.showError(\"You must supply a password to sign the document\", \"\");\n        } else if (needEnterUserName && name != matrixSession.getUser()) {\n             ml.UI.showError(\"Please provide your user id\", \"\");\n        } else {\n            this.signDocument( pwd, meaning );\n        }\n    }\n\n    protected signDocument( pwd:string, meaning?:string ) {\n        let that = this;\n\n        if (app.needsSave()) {\n             ml.UI.showError(\"You need to save other changes first\", \"\");\n             return;\n        }\n\n        function addSignature() {\n\n            app.signItemAsync(that.settings.item.id, pwd, meaning).done(function (result) {\n                if (result && !result.ok) {\n                    ml.UI.showError(\"Could not sign document\", result.result);\n                    return;\n                }\n                // get item with new signatures\n                app.getItemAsync(that.settings.id).done(function (item: IItemGet) {\n\n                   // do automation stuff\n                    let lastSignature = DocBaseImpl.readSignatureInfo(item).missingSignatures === 0;\n\n                    MR1.triggerAfterSignature( item, lastSignature);\n\n                    app.renderItem();\n                });\n\n\n            }).fail(function (error) {\n                if (error) {\n                    ml.UI.showError(\"Could not sign document\", error);\n                } else {\n                    // cancelled save\n                }\n            });\n        }\n\n\n        if (!DocSignImpl.iHaveSignature) {\n            ml.UI.showConfirm(4, {title: \"You have not uploaded a signature image! Do you want to sign the document without an image?\", ok: \"Sign anyway\"}, function () {\n                addSignature();\n            }, function () {\n\n            });\n        } else {\n            addSignature();\n        }\n\n    }\n\n}\n","\nimport { IDHFControlDefinitionValue, mDHF } from \"../../businesslogic/index\";\nimport { BaseControl } from \"./BaseControl\";\nimport { ISignature } from \"./docReview\";\nimport { ml } from \"./../../matrixlib\";\nimport { IItemGet, globalMatrix, matrixSession } from \"../../../globals\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\nimport {IDhfTableOptions} from \"../../businesslogic/FieldHandlers/Document/GenericTableDocHandler\";\nimport {EmptyFieldHandler} from \"../../businesslogic/FieldHandlers/EmptyFieldHandler\";\nimport {GenericFieldHandler} from \"../../businesslogic/FieldHandlers/GenericFieldHandler\";\n\nexport type { ISignaturesInfo };\nexport { DocBaseImpl };\n\ninterface ISignaturesInfo {\n    signatures:ISignature[],\n    missing:string[],\n    given:string[],\n    signatureDate:{[key:string]:string},\n    missingSignatures:number,\n    givenSignatures:number,\n    \n    needSignature:boolean, // if the user looking at this item needs to sign\n    hasSignature:boolean, // true if this is a document which has at least one signature \n\n    isTemplate:boolean // if the item contains a \"templateapproval\" field, it is a template. and this needs to be signed instead of filling the signature table\n}\n\nabstract class DocBaseImpl extends BaseControl<GenericFieldHandler> {\n    \n    \n    constructor( control:JQuery, fieldHandler:GenericFieldHandler) {\n        super(control,fieldHandler);\n    } \n\n    // this method returns all signature information from a item\n    // the item can be a DOC, SIGN, RELEASE \n    // depending on the type (e.g. DOC) it looks for different fields\n    static readSignatureInfo( item:IItemGet ):ISignaturesInfo {\n        let that = this;\n        let signatureStatus: ISignaturesInfo = {\n            signatures:[],\n            missing:[],\n            given:[],\n            signatureDate:{},\n            missingSignatures:0,\n            givenSignatures:0,\n            needSignature:false,\n            hasSignature:false,\n            isTemplate:false\n        }\n        \n        if (!item) {\n            return signatureStatus;\n        }\n        \n        $.each(item, function (key, val) {\n            if (val && globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                // special dhf control\n                var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                if ( fieldVal.type.toLocaleLowerCase() === \"templateapproval\") {\n                    signatureStatus.isTemplate = true;\n                }\n            }\n        });\n        \n        if ( mDHF.isDocumentFormType (item.type ) ) { // DRAFT, DOC, ...\n            $.each(item, function (key, val) {\n                if (val && globalMatrix.ItemConfig.getFieldType(item.type, key) === FieldDescriptions.Field_dhf) {\n                    // special dhf control\n                    var fieldVal = <IDHFControlDefinitionValue>JSON.parse(val);\n                    if ( fieldVal.type.toLocaleLowerCase() === (signatureStatus.isTemplate?\"templateapproval\":\"signaturebox\")) {\n                        // control is a signature table\n                        $.each( fieldVal, function( tableIdx, value ) {\n                            // get calue of control\n                            let tableStr = value.fieldValue;\n                            if ( tableStr ) {\n                                let table = JSON.parse(tableStr);\n                                $.each(table, function(rowIdx, row) {\n                                    $.each((<IDhfTableOptions>value.ctrlConfig).columns, function(tableColIdx, tableCol) {\n                                        let user = row[tableCol.field];\n                                        if ( tableCol.editor == \"user\" && user && signatureStatus.missing.indexOf(user)==-1) {\n                                            signatureStatus.missingSignatures++;\n                                            signatureStatus.missing.push(user);\n                                        }\n                                    });\n                                });\n                            }\n                        });\n                    }\n                }\n            });\n        } else { \n            // this is a signed item\n            $.each(item, function (detail, val) {\n                if (typeof val === \"string\" && val.indexOf(\"<signatures \") === 0) {\n                    var signaturesXML = $(val);\n                    $.each(signaturesXML.find(\"signature\"), function (idx, signature) {\n                        signatureStatus.hasSignature = true; // there is at least this signature field\n                        let orgUser= $(signature).attr(\"originaluserlogin\");\n                        let currentUser = $(signature).attr(\"user\").toLowerCase();\n                        let sig = {\n                            orgid: orgUser?orgUser.toLowerCase():currentUser,\n                            userid: currentUser,\n                            signDate: ($(signature).attr(\"signDate\")),\n                            signaturefileid: ($(signature).attr(\"signaturefileid\")),\n                            signDateCustomer: ($(signature).attr(\"signDateCustomer\"))\n                        };\n                        if (that.isMeTest(sig.userid)) {\n                            signatureStatus.needSignature = !sig.signDate;\n                        }\n                        if (sig.signDate) {\n                            signatureStatus.given.push($(signature).attr(\"user\"));\n                            signatureStatus.givenSignatures++;\n                            if (!sig.signDateCustomer) {\n                                // in some old projects signDateCustomer was not set...\n                                sig.signDateCustomer = ml.UI.DateTime.renderHumanDate(new Date(sig.signDate));\n                            }\n                        } else {\n                            signatureStatus.missingSignatures++;\n                            signatureStatus.missing.push($(signature).attr(\"user\"));\n                        }\n                        signatureStatus.signatureDate[ $(signature).attr(\"user\").toLowerCase() ] = sig.signDateCustomer;\n                        signatureStatus.signatures.push(sig);\n                    });\n                }\n            });\n        }\n        return signatureStatus;\n    \n    }\n    static isMeTest( user:string ) {\n        return user.toLowerCase() === matrixSession.getUser().toLowerCase();\n    } \n    protected isMe( user:string ) {\n        return DocBaseImpl.isMeTest(user);\n    } \n\n};\n\n","import { JsonEditorValidation } from \"../../../jsonvalidation/JsonValidator\";\nimport { IFieldDescription } from \"../../ProjectSettings\";\nimport {plugins} from \"./PluginManager\";\nexport { FieldDescriptions };\n\nclass FieldDescriptions {\n\n    public static Field_sourceref = \"sourceref\";\n    public static Field_markAsTemplate = \"markAsTemplate\";\n    public static Field_dhf = \"dhf\";\n    public static Field_docFilter = \"docFilter\";\n\n    // normal fields\n    public static Field_richtext = \"richtext\";\n    public static Field_text = \"text\";\n    public static Field_section = \"section\";\n    public static Field_fileManager = \"fileManager\";\n    public static Field_tasksControl = \"tasksControl\";\n    public static Field_textline = \"textline\";\n    public static Field_user = \"user\";\n    public static Field_date = \"date\";\n    public static Field_dropdown = \"dropdown\";\n    public static Field_links = \"links\";\n    public static Field_uplinkinfo = \"uplinkinfo\";\n    public static Field_crosslinks = \"crosslinks\";\n    public static Field_risk2 = \"risk2\";\n    public static Field_checkbox = \"checkbox\";\n    public static Field_gateControl = \"gateControl\";\n    public static Field_colorPicker = \"colorPicker\";\n    public static Field_steplist = \"steplist\";\n\n    // toolbar\n    public static Field_labels = \"labels\";\n    public static Field_workflow = \"workflow\";\n\n    // tests and xtcs\n    public static Field_test_steps = \"test_steps\";\n    public static Field_test_steps_result = \"test_steps_result\";\n    public static Field_test_result = \"test_result\";\n\n    // agile sync\n    public static Field_syncStatus = \"syncStatus\";\n    public static Field_syncSourceInfo = \"syncSourceInfo\";\n\n    // beta should not be used really\n    public static Field_report = \"report\";\n    public static Field_cascadingSelect = \"cascadingSelect\";\n    public static Field_hyperlink = \"hyperlink\";\n\n    // technical - these need to be added once when creating a new DOC category or something special like this\n    public static Field_reportId = \"reportId\";\n    public static Field_filter_file = \"filter_file\";\n    public static Field_signature = \"signature\";\n    public static Field_signatureControl = \"signatureControl\";\n    public static Field_signCache= \"signCache\";\n    static Field_publishedItemList= \"publishedItemList\"\n    static Field_publishedFilesList = \"publishedFilesList\";\n    static Field_publishedContent= \"publishedContent\";\n    static Field_publishedTitle = \"publishedTitle\";\n    static Field_docTraining= \"docTraining\";\n    static Field_docReview = \"docReview\";\n    static Field_risk = \"risk\";\n    static Field_htmlForm = \"htmlForm\";\n    static Field_hidden = \"hidden\";\n    static Field_dummy = \"dummy\";\n    static Field_guid = \"guid\";\n    static Field_oid = \"oid\";\n    static Field_versionLive = \"versionLive\";\n    static Field_version = \"version\";\n    static Field_currentVersion = \"currentVersion\";\n    static Field_riskFolder = \"riskFolder\";\n    static Field_reviewControl = \"reviewControl\";\n\n    public static findById(idToFind: string): IFieldDescription | undefined {\n        let returnedValue = undefined;\n        let result = this.descriptions.filter((description) => description.id === idToFind);\n\n        returnedValue = result.length === 1 ? result[0] : undefined;\n        if( returnedValue == undefined){\n            // try to find it in the plugins, if they exist\n            let descriptionFromPlugins = plugins?.getFieldConfigOptions() ?? [];\n            result = descriptionFromPlugins.filter((description) => description.id === idToFind);\n            returnedValue = result.length === 1 ? result[0] : undefined;\n        }\n        return returnedValue;\n    }\n\n    public static appendFieldDescriptions(newFields: IFieldDescription[]) {\n        for (let fco of newFields) {\n            let result = this.descriptions.filter((description) => description.id === fco.id);\n            if (result.length == 0) {\n                this.descriptions.push(fco);\n            }\n        }\n    }\n\n    public static get(): IFieldDescription[] { return FieldDescriptions.descriptions; }\n\n    // A [fieldId]: JsonValidationFunction map built up at runtime.\n    // We can't build this at compile time because validation functions are high-level entities.\n    private static validationFunctions = {};\n\n    private static descriptions: IFieldDescription[] = [\n        // [ \"richtext\",  \"user\" , \"date\", \"text\", \"textline\" ,\"test_result\",\n        //         \"crosslinks\", \"gateControl\",\"fileManager\", \"reviewControl\"];\n        // docs and sign\n        { id: FieldDescriptions.Field_sourceref, capabilities: { canImportedFromExcel:true, canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Source (Original Document) [sourceref]\", class: \"docsign\", help: \"keeps a reference to original document when copying and pasting\" },\n        { id: FieldDescriptions.Field_markAsTemplate, capabilities: { canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Mark as template [markAsTemplate]\", class: \"docsign\", help: \"allows to define DOC templates which can be used in other projects\" },\n        { id: FieldDescriptions.Field_dhf, capabilities: { canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"DFH field  [dhf]\", class: \"docs\", help: \"for documents only: holds a section in a document\" },\n        { id: FieldDescriptions.Field_docFilter, capabilities: { canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Label Filter in DOCs [docFilter]\", class: \"docs\", help: \"a special field for Document categories to filter documents by label\" },\n\n        // normal fields\n        { id: FieldDescriptions.Field_richtext, capabilities: { canImportedFromExcel:true, canBeUnsafe: true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true, canRequireContent: true }, label: \"Rich Text Control [richtext]\", class: \"all\", help: \"a rich text editor field (with formatting)\" },\n        { id: FieldDescriptions.Field_text, capabilities: { canImportedFromExcel:true, canBeUnsafe: true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true, canRequireContent: true }, label: \"Plain Text Control [text]\", class: \"all\", help: \"a text editor field (no formatting)\" },\n        { id: FieldDescriptions.Field_section, capabilities: { canBeUsedInDocs: false, canHideInDoc: false, canBeXtcPreset: false, canBePublished: true, canBeReadonly: false, canRequireContent: false }, label: \"Section with explanation [section]\", class: \"all\", help: \"a title with some explanation to separate fields\" },\n        { id: FieldDescriptions.Field_fileManager, capabilities: {canImportedFromExcel:true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true }, label: \"File Manager Control [fileManager]\", class: \"all\", help: \"a control which allows to attach files by browsing or drag and drop\" },\n        { id: FieldDescriptions.Field_tasksControl, capabilities: { canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Tasks Control [tasksControl]\", class: \"all\", help: \"a field which shows links to external systems, like JIRA, github etc. (eg extensions folder)\" },\n        { id: FieldDescriptions.Field_textline, capabilities: { canImportedFromExcel:true, canBeUnsafe: true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true, canRequireContent: true }, label: \"Text Line Control [textline]\", class: \"all\", help: \"a field for one line of text\" },\n        { id: FieldDescriptions.Field_user, capabilities: { canImportedFromExcel:true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true, canRequireContent: true }, label: \"User Select Control [user]\", class: \"all\", help: \"a drop down to select a user in the project\" },\n        { id: FieldDescriptions.Field_date, capabilities: {canImportedFromExcel:true,  canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true, canRequireContent: true }, label: \"Date Select Control [date]\", class: \"all\", help: \"a field to select a date\" },\n        { id: FieldDescriptions.Field_dropdown, capabilities: { canBeUnsafe: true, needsConfiguration: true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true, canRequireContent: true }, label: \"Drop Down Control [dropdown]\", class: \"all\", help: \"a drop-down selection field\" },\n        { id: FieldDescriptions.Field_links, capabilities: { canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Down Traces Control [links]\", class: \"all\", help: \"a field to show and edit down traces as defined in the traceability configuration\" },\n        { id: FieldDescriptions.Field_uplinkinfo, capabilities: { schema: \"IUpLinkDetails\", needsConfiguration: true, canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Uplink information [uplinkinfo]\", class: \"all\", help: \"a field to show information about up traces in the user interface\" },\n        { id: FieldDescriptions.Field_crosslinks, capabilities: {canImportedFromExcel:true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Cross Project Link Control [crosslinks]\", class: \"all\", help: \"a field to add links to other matrix projects\" },\n        { id: FieldDescriptions.Field_risk2, capabilities: { canBeUnsafe: true, onlyOne: true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Risk Control [risk2]\", class: \"all\", help: \"a field rendering an FMEA-type risk field\" },\n        { id: FieldDescriptions.Field_checkbox, capabilities: { canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true }, label: \"Checkbox Control [checkbox]\", class: \"all\", help: \"a checkbox field\" },\n        { id: FieldDescriptions.Field_hyperlink, capabilities: {  canImportedFromExcel:true, canBeUsedInDocs:true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: true, canBeReadonly: true, canRequireContent: true}, label: \"Hyperlink Control [hyperlink]\", class: \"all\", help: \"a field holding a hyperlink (url)\" },\n\n        {\n            id: FieldDescriptions.Field_gateControl,\n            capabilities: {\n                canImportedFromExcel:true,\n                canBeUnsafe: true, needsConfiguration: true, canHideInDoc: true, canBeXtcPreset: true, canBePublished: false,\n                canBeReadonly: true, schema: \"IGate\"\n            },\n            label: \"Gate Control [gateControl]\", class: \"all\", help: \"a quality gate field\"\n        },\n\n        {\n            id: FieldDescriptions.Field_colorPicker,\n            capabilities: {\n                canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: true,\n                canBePublished: true, canBeReadonly: true, canRequireContent: true\n            },\n            label: \"Color picker [colorPicker]\", class: \"super\", help: \"a color picker field\"\n        },\n\n        {\n            id: FieldDescriptions.Field_steplist,\n            capabilities: {\n                needsConfiguration: true, canBeUsedInDocs: true, canHideInDoc: true, canBeXtcPreset: false,\n                canBePublished: true, canBeReadonly: true, canBeUnsafe: true,\n                schema: \"IFieldParameter\",\n            },\n            label: \"Table Control [steplist]\",\n            class: \"all\",\n            help: \"a field rendered as a table\",\n        },\n\n        // toolbar\n        { id: FieldDescriptions.Field_labels, capabilities: { onlyOne: true, canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Labels [labels]\", class: \"toolbar\", help: \"shows defined labels in the item's tool bar\" },\n        { id: FieldDescriptions.Field_workflow, capabilities: { onlyOne: true, canBeUsedInDocs: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"One2One Issue Mapping [workflow]\", class: \"toolbar\", help: \"a field shown in the item's tool bar showing the status of an external ticket (i.e. jira)\" },\n\n        // tests and xtcs\n        { id: FieldDescriptions.Field_test_steps, capabilities: { canBeUnsafe: true, onlyOne: true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Test Table [test_steps]\", class: \"tests\", help: \"a special table control to define tests (see test configuration)\" },\n        { id: FieldDescriptions.Field_test_steps_result, capabilities: { canBeUnsafe: true, onlyOne: true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Test Result Table [test_steps_result]\", class: \"xtcs\", help: \"a special table control to define tests with results (see test configuration)\" },\n        { id: FieldDescriptions.Field_test_result, capabilities: { canImportedFromExcel:true, onlyOne: true, canHideInDoc: true, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Test Result Summary [test_result]\", class: \"xtcs\", help: \"a special field to compute or specify the overall test result\" },\n\n\n        // agile sync\n        { id: FieldDescriptions.Field_syncStatus, capabilities: { onlyOne: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"SYNC Status [syncStatus]\", class: \"sync\", help: \"control to hold the information about synced external items \" },\n        { id: FieldDescriptions.Field_syncSourceInfo, capabilities: { onlyOne: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"SYNC Source Info [syncSourceInfo]\", class: \"sync\", help: \"a control to show control syncing of external items\" },\n\n\n        // beta should not be used really\n        { id: FieldDescriptions.Field_report, capabilities: { canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Embedded Report [report]\", class: \"beta\", help: \"allows to embed a standard report\" },\n        { id: FieldDescriptions.Field_cascadingSelect, capabilities: { canHideInDoc: false, canBeXtcPreset: true, canBePublished: true, canBeReadonly: true }, label: \"Cascading Select [cascadingSelect]\", class: \"beta\", help: \"a field to select values from hierachies of drop downs\" },\n\n        // technical - these need to be added once when creating a new DOC category or something special like this\n        { id: FieldDescriptions.Field_reportId, capabilities: { onlyOne: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"report ID [reportId]\", class: \"super\", help: \"contains the id of the xslt template for reports\" },\n        { id: FieldDescriptions.Field_filter_file, capabilities: { onlyOne: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"filter_file [filter_file]\", class: \"super\", help: \"internal field required for documents\" },\n        { id: FieldDescriptions.Field_signature, capabilities: { onlyOne: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Signature Table [signature]\", class: \"super\", help: \"field showing signature in documents\" },\n        { id: FieldDescriptions.Field_signatureControl, capabilities: { onlyOne: true, canHideInDoc: false, canBeXtcPreset: false, canBePublished: false, canBeReadonly: true }, label: \"Signature Password Field [signatureControl]\", class: \"super\", help: \"field with control for signatures\" }\n    ];\n\n    static setValidationFunction(fieldId: string, validator: JsonEditorValidation) {\n        let fieldDesc = FieldDescriptions.findById(fieldId);\n        if (!fieldDesc) {\n            throw new Error(`No such field type ${fieldId} registered`);\n        }\n        fieldDesc.capabilities.validationFunction = validator;\n    }\n}\n","import { app, globalMatrix, matrixSession, restConnection } from \"../../../globals\";\nimport { IAutoFillSetting, IDropdownOption } from \"../../../ProjectSettings\";\nimport { XRSettingType, XRGetUser_AllUsers_GetUserListAck, XRGetProject_ProjectInfo_ProjectInfo, XRGetProject_ProjectAccess_GetAccessAck } from \"../../../RestResult\";\nimport { IFileUploadProgress, IFileUploadResult, IJcxhr } from \"../../businesslogic/RestConnector\";\nimport { ml } from \"../../matrixlib\";\nimport { Email } from \"./EmailValidator\";\nimport { StrongPass } from \"./PasswordValidator\";\nimport { User } from \"./UserNameValidator\";\n\nexport type {\n    UserEditMode, IUserCreate, IUserGet, ITokenConfig, IEmailNotificationSetting\n};\nexport { UserControl, userControls };\n\ntype UserEditMode = \"create\" | \"useredit\" | \"adminedit\";\n\ninterface IUserCreate {\n    pw1?:string,\n    pw2?:string,\n    pw3?:string,\n    password?:string,\n    admin?:number,\n    login?:string,\n    email?:string,\n    firstName?:string,\n    lastName?:string,\n    signatureImage?:number\n    customerAdmin?:number,\n    signaturePassword?:string,\n    userSettingsList?:XRSettingType[]\n}\ninterface IUserGet {\n    pw1?:string,\n    pw2?:string,\n    pw3?:string,\n    password?:string,\n    admin?:number,\n    login?:string,\n    email?:string,\n    firstName?:string,\n    lastName?:string,\n    signatureImage?:string\n    customerAdmin?:number,\n    signaturePassword?:string\n}\n\ninterface ITokenConfig {\n    enabled:boolean,\n    users:string[]\n}\n\ninterface IEmailNotificationSetting {\n    periodicity:\"\"|\"weekly\"|\"daily\";\n\n}\nclass UserControl {\n\n    static TOKEN_CONFIG = \"settingsToken\";\n    static EMAILNOTIF_CONFIG = \"emailNotificationReminders\";\n    constructor() {\n    }\n\n    // mode\n    // create (always an admin)\n    // adminedit (an admin editing in admin client)\n    // useredit (a user through menu)\n\n    editUserDetails(mode:UserEditMode, userId?:string, userAddedCb?:Function, noUserAddedCb?:Function) {\n        let that = this;\n        restConnection.getServer(\"user\").done( async (allUsers: XRGetUser_AllUsers_GetUserListAck) => {\n            var userDetails: IUserCreate;\n            if (userId) {\n                for (var idx = 0; idx < allUsers.user.length; idx++) {\n                    if (allUsers.user[idx].login.toLowerCase() === userId.toLowerCase()) {\n                        userDetails = <IUserCreate><any>allUsers.user[idx];\n                        userDetails.login = userDetails.login.toLowerCase();\n                    }\n                }\n            }\n            await that.editUserDetailsDlg(mode, userDetails, userAddedCb, noUserAddedCb, allUsers);\n        }).fail(function (error) {\n            ml.UI.showError(\"Cannot edit user\", error);\n        });\n    }\n\n    resetPassword(userId:string) {\n        let that = this;\n        restConnection.getServer(\"user\").done(function (allUsers: XRGetUser_AllUsers_GetUserListAck) {\n            for (var idx = 0; idx < allUsers.user.length; idx++) {\n                if (allUsers.user[idx].login.toLowerCase() === userId.toLowerCase()) {\n                    let currentUser = <IUserGet><any>allUsers.user[idx]\n                    var userDetails: IUserCreate = <IUserCreate><any>currentUser;\n                    userDetails.password = that.generatePassword( );\n                    userDetails.signaturePassword = that.generatePassword( );\n                    // fix MATRIX-1046 reset password button resets admin flag\n                    userDetails.admin = userDetails.customerAdmin;\n                    // fix MATRIX-1660 The \"reset password\" function in the admin UI doesn't work anymore\n                    if (currentUser.signatureImage == \"\") {\n                        userDetails.signatureImage  = -1;\n                    } else {\n                        userDetails.signatureImage = parseInt(currentUser.signatureImage.split(\"?\")[0]);\n                    }\n                    restConnection.putServer(\"user/\" + userDetails.login.toLowerCase(), {\n                        json: JSON.stringify(userDetails)\n                    }).done(function (result) {\n                       /* MATRIX-2996 initial set password dialog ask for user name if not set*/\n                         var askForName=( (userDetails.firstName == undefined || userDetails.firstName == \"\"   ) ||\n                                                ( userDetails.lastName == undefined || userDetails.lastName == \"\" ))\n                        that.createUserMail(allUsers, userDetails.login.toLowerCase(), true, \"\",askForName);\n\n                    }).fail(function (errorMsg) {\n                        ml.UI.showError(\"Failed to change passwords!\", errorMsg);\n                    });\n                }\n            }\n        }).fail(function (error) {\n            ml.UI.showError(\"Cannot retrieve user info!\", error);\n        });\n    };\n\n    private canAutoFill = false;\n\n    askForPassword( container:JQuery, btnName:string, showUser:boolean, userWidth:number, onSign: ( name:string, pwd:string ) => void ) {\n        let that = this;\n\n        let table = $('<div class=\"signatureInfo input-group\" style=\"margin-top:12px;width:100%\">').appendTo(container);\n\n         // by default do not allow change\n        let autoFill = <IAutoFillSetting>matrixSession.getCustomerSettingJSON(\"autoFillSettings\", {});\n        that.canAutoFill = autoFill.allowAutoFill || autoFill.allowDocSignAutoFill;\n\n        let name =  $(\"<input autocomplete='off' type='text' class='signatureInfo form-control' placeholder='enter user id' style='padding:8px'>\");\n        let pwd = $(\"<input type='\" + (that.canAutoFill?\"password\":\"text\" ) + \"' class='form-control' placeholder='password'>\");\n        let signIt = $(\"<button class='form-control btn btn-default'>\" + btnName + \"</button>\").click(function () {\n           onSign( name.val(), pwd.val());\n        });\n\n        let pwdSpan = $(\"<span class='input-group-btn'>\").append(pwd);\n        table.append( name );\n        table.append( pwdSpan );\n        table.append( $(\"<span class='input-group-btn'>\").append(signIt));\n        if (userWidth) {\n            name.width( userWidth );\n            pwdSpan.css( \"width\", \"90%\" );\n        } else  {\n            pwdSpan.css( \"width\", \"90%\" );\n        }\n\n\n        that.initUserAndPassword(name,pwd,showUser);\n\n        pwd.on(\"keyup paste\", () => {\n            pwd.attr( \"type\", \"password\");\n        });\n    }\n\n    protected initUserAndPassword(name:JQuery, pwd:JQuery, showUser:boolean) {\n        // canChange is set to true at first keypress, mousedown before that\n        // it is an autofill which is not allowed in signature box\n        if (showUser) { // normally the user can be displayed and not be changed\n            name.val(matrixSession.getUser() + (this.canAutoFill ? \"\" : \" \")); // the \" \"  makes sure the password is not filled when loading\n            name.attr(\"readonly\",\"readonly\");\n        }\n\n        if (this.canAutoFill) return;\n\n        if (!showUser)  {\n            // sometimes user need to type it (this is actually a very special case)\n            name.val( \"\" );\n        }\n\n        pwd.val( \"\" );\n    }\n\n    private async updateGlobalUserInfo() {\n        if (globalMatrix.ItemConfig.isConfigured() && matrixSession.getProject()) {\n            try {\n                const accessInfo = <XRGetProject_ProjectAccess_GetAccessAck>\n                    await restConnection.getServer(matrixSession.getProject() + \"/access\");\n                globalMatrix.ItemConfig.addUsers(accessInfo.userPermission, accessInfo.groupPermission);\n            } catch (e) {\n                ml.Logger.error(\"Error updating global user information.\");\n            }\n        }\n    }\n\n    private async editUserDetailsDlg(mode: UserEditMode, userDetails: IUserCreate, userAddedCb:Function, noUserAddedCb:Function, userInfo:XRGetUser_AllUsers_GetUserListAck) {\n        let that = this;\n\n        if (mode === \"create\") {\n            userDetails = {\n                login: \"\",\n                email: \"\",\n                firstName: \"\",\n                lastName: \"\",\n                customerAdmin: 0\n            };\n        }\n        var tablewidth = 680;\n        var form = $(this.getUserDetailsHTML(mode, userDetails.login));\n\n        app.dlgForm.hide();\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n        var scrollPanel = $('<div class=\"layoutContainerScroll\"></div>');\n        app.dlgForm.append(scrollPanel);\n        scrollPanel.append(form);\n\n        var table = $('#userPrefTable');\n\n        var save = function(event: JQueryEventObject) {\n                that.enableSavePwd(true);\n                ml.UI.showSuccess((mode === \"create\")?'Creating user!':'Updating user!');\n\n                var newValues = readform();\n                if (!newValues) {\n                    return;\n                }\n                var pl = \"\";\n\n\n                $.each($(\".qmsViewerOnly:checked\"), function (idx, p) {\n                    let url = globalMatrix.matrixBaseUrl + \"/pub/\" + $(p).data(\"pid\");\n                    pl += \"<a href='\" +url+\"'><b>\" + $(p).data(\"pid\") + \"</b> - \" + $(p).data(\"plabel\") + \"</a> (as QMS viewer)<br/>\";\n                });\n\n\n                $.each($(\".proch:checked\"), function (idx, p) {\n                    pl += \"<b>\" + $(p).data(\"pid\") + \"</b> - \" + $(p).data(\"plabel\") + \"<br/>\";\n                });\n\n\n                // create or update user\n                saveData(newValues).done(function () {\n                    // MATRIX-1341\n                    // The create user function in the admin UI doesn't open up projects for users\n                    // save projects to give access later\n                    var paccess:string[] = [];\n                    $.each($(\".proch:checked\"), function (idx, p) {\n                        paccess.push($(p).data(\"pid\"));\n                    });\n\n                    var paccessQms:string[] = [];\n                    $.each($(\".qmsViewerOnly:checked\"), function (idx, p) {\n                        paccessQms.push($(p).data(\"pid\"));\n                    });\n                    app.dlgForm.dialog(\"close\");\n                    // user created\n                    if (mode === \"create\") {\n                        restConnection.getServer(\"user\").done(async function (allUsers: XRGetUser_AllUsers_GetUserListAck) {\n                            // update list of existing users if necessary.\n                            await that.updateGlobalUserInfo();\n\n                            var askForName= ((newValues.firstName == undefined || newValues.firstName == \"\"   ) ||\n                                            ( newValues.lastName == undefined || newValues.lastName == \"\" ))\n                            // send mail to user\n                            that.createUserMail(allUsers, newValues.login, false, pl,askForName );\n\n                            // give initial access rights to projects\n                            $.each(paccess, function (idx, pid) {\n                                restConnection.postServer(\"user/\" + newValues.login + \"/\" + pid, {\n                                    permission: \"2\", // read Write access\n                                    reason: \"admin.js\"}\n                                );\n                            });\n\n                            // give initial access rights to projects\n                            $.each(paccessQms, function (idx, pid) {\n                                restConnection.postServer(\"user/\" + newValues.login + \"/\" + pid, {\n                                    permission: \"4\", // QMS access\n                                    reason: \"admin.js\"}\n                                );\n                            });\n                        });\n\n                    }\n                });\n\n\n            };\n\n\n        if( mode !== \"create\")\n        {\n\n            var table3= $(\"<table class='userSettings' style='width:100%'><tbody/></table>\");\n            $(\"#userPref\").append(table3);\n\n            var table2 = $(\"<table class='dateSettings' style='width:100%'><tbody/></table>\");\n\n            $(\"#userPref\").append(table2);\n\n            await  ml.UI.DateTime.renderSettingControlsAsync({\n                user:userDetails.login,\n                help:\"User Date and Time Settings\",\n                table:table2});\n\n\n\n            $(\"#userPref\").append(table2);\n\n\n            if (userDetails.login === matrixSession.getUser())\n            {\n                ml.UI.ThemeSelector.renderThemeSelectorControl(\"Theme\",table3);\n            }\n\n\n            that.renderNotificationEmailReminder(userDetails, table3);\n\n\n\n            var savePwDiv = $(\"<div class=''  ></div>\")\n            var saveButton = $(\"<button class='savePwButton ' id='saveBtn'> Save </button>\").click(save);\n            saveButton.button();\n            var savePwTb = $(\" <span class='' style='float:right'><button class='' >PW</button></span></div>\");\n            savePwTb.append(saveButton);\n            savePwDiv.append(savePwTb);\n            table.after(savePwDiv);\n\n            setTimeout( ()=>{$(\"#ud_pw3\").width($(\"#ud_login\").width()  - $(\"#saveBtn\").width()-40)}, 400);\n\n        }\n\n        $(\"input\", scrollPanel).on(\"change keyup paste\", function () {\n\n            that.enableSavePwd(!readform());\n            let isEnabled = !$(\"#saveBtn\").attr(\"disabled\");\n            $(\"#ud_pw3\").css(\"border-color\", isEnabled?\"\":\"red\");\n\n        });\n\n        // attach password creation handler\n        $(\".pwgen\", scrollPanel).click(function(event: JQueryEventObject) {\n            that.generatePassword($(event.delegateTarget));\n        });\n\n        // fill form with input\n        $.each(userDetails, function (detail, val) {\n            if (detail === \"signatureImage\") {\n                if (val && val !== -1) {\n                    $(\"#ud_currentImg\").html(\"\").append(\"<img class='signature' src='\" + globalMatrix.matrixRestUrl + \"/all/file/\" + val + \"'>\");\n                }\n            }\n            if (detail === \"customerAdmin\") {\n                $(\"#ud_\" + detail).prop(\"checked\", val ? true : false);\n            } else {\n                $(\"#ud_\" + detail).val(val);\n            }\n        });\n\n        // hide / disable stuff which cannot be changed\n\n        if (mode === \"create\" ) {\n            $(\"#ud_pw1_line\").hide();\n            $(\"#ud_pw1R_line\").hide();\n            $(\"#ud_pw2_line\").hide();\n            $(\"#ud_pw1\").val(that.generatePassword());\n            $(\"#ud_pw1R\").val($(\"#ud_pw1\").val());\n            $(\"#ud_pw2\").val(that.generatePassword());\n        } else if (mode === \"adminedit\") {\n            $(\"#ud_login\").attr(\"readonly\", \"readonly\");\n        } else {\n            $(\"#ud_login\").attr(\"readonly\", \"readonly\");\n            $(\".admin_line\").hide();\n        }\n        if (matrixSession.oAuthOnly()) {\n            $(\"#ud_pw1\").val(that.generatePassword());\n            $(\"#ud_pw1R\").val($(\"#ud_pw1\").val());\n            $(\"#ud_pw1_line\").hide();\n            $(\"#ud_pw1R_line\").hide();\n        }\n        if (userInfo.needDoublePassword != 1 && !matrixSession.oAuthOnly()) {\n            $(\"#ud_pw2_line\").hide();\n            $(\"#ud_pw1\").on('change keyup paste', function () {\n                $(\"#ud_pw2\").val($(\"#ud_pw1\").val() + \"#'Ä*PSSD\");\n            });\n        }\n        if (mode !== \"useredit\") {\n            $(\".ud_useredit_line\").hide();\n        }\n        if(mode === \"adminedit\")\n        {\n            $(\"fieldset\", app.dlgForm).css(\"border\", \"none\").css(\"padding\", 0).css(\"padding-bottom\", 0);\n            $(\"legend\", app.dlgForm).hide();\n\n        }\n        if (mode === \"create\") {\n\n            $(\"fieldset\", app.dlgForm).css(\"border\", \"none\").css(\"padding\", 0).css(\"padding-bottom\", 0);\n            $(\"legend\", app.dlgForm).hide();\n\n            var accessRights = $(\"<div >\");\n            table.after(accessRights);\n            if (matrixSession.getProjectList(false).filter(p => p.qmsProject).length > 0)\n            {\n                accessRights.append(\"<span class='baseControlHelp'>LiveQMS (viewer only)</span>\");\n                $.each(matrixSession.getProjectList(false), function (ip, p)\n                {\n                    if (  p.shortLabel !== \"EMPTY\") {\n                        if( p.qmsProject)\n                        {\n\n                            accessRights.append(\n                                '<div style=\"padding-left:35px\" >' +\n                                '<label><input type=\"checkbox\" class=\"qmsViewerOnly\" data-pid=\"' + p.shortLabel + '\" data-plabel=\"' + p.label + '\">' +\n                                '<span style=\"padding-left:10px\">' + p.shortLabel + '</span> <span style=\"font-weight:normal\">' + p.label + '</span>'  +\n                                '</div>');\n                        }\n                    }\n                });\n            }\n            accessRights.append(\"<span class='baseControlHelp'>Give user read/write access to these projects</span>\");\n\n            accessRights.append(\n                '<div style=\"padding-left:35px\" >' +\n                '<label><input type=\"checkbox\" class=\"toogleProjectAccess\">' +\n                '<span style=\"padding-left:10px;font-weight:normal\">toggle all projects</span></label>' +\n                '</div>');\n\n                $('.toogleProjectAccess').change(function() {\n                    let checked = $('.toogleProjectAccess').is(\":checked\");\n                    $.each( $(\".proch\"), function(idx, proch) {\n                        $(proch).prop(\"checked\", checked);\n\n                    });\n                    if( checked)\n                        $(\".qmsViewerOnly\").prop(\"checked\",false);\n\n                });\n            $.each(matrixSession.getProjectList(false), function (ip, p) {\n                if (  p.shortLabel !== \"EMPTY\") {\n                    accessRights.append(\n                            '<div style=\"padding-left:35px\" >' +\n                            '<label><input type=\"checkbox\" class=\"proch\" data-pid=\"' + p.shortLabel + '\" data-plabel=\"' + p.label + '\">' +\n                            '<span style=\"padding-left:10px\">' + p.shortLabel + '</span> <span style=\"font-weight:normal\">' + p.label + '</span></label>' +\n                            '</div>');\n                }\n            });\n\n            $(\".proch\").change(function(event)\n                {\n                    if($(event.target).is(\":checked\"))\n                    {\n                        $(\".qmsViewerOnly[data-pid='\" + $(event.target).data(\"pid\") +\"']\").prop(\"checked\",false)\n                    }\n                }\n            );\n            $(\".qmsViewerOnly\").change(function(event)\n            {\n                if($(event.target).is(\":checked\"))\n                {\n                    $(\".proch[data-pid='\" + $(event.target).data(\"pid\") +\"']\").prop(\"checked\",false);\n                    $(\".toogleProjectAccess\").prop(\"checked\",false);\n                }\n            }\n        );\n\n        }\n        // init validators\n        var pw1 = new StrongPass(\"#ud_pw1\", {\n            passFail: function () {\n                //console.log(passed);\n            },\n            passIndex: userInfo.passwordStrength,\n            other: \"#ud_pw2\"\n        });\n        var pw2 = new StrongPass(\"#ud_pw2\", {\n            passFail: function () {\n                //console.log(passed);\n            },\n            passIndex: userInfo.passwordStrength,\n            other: \"#ud_pw1\"\n        });\n\n        var user = new User(\"#ud_login\");\n        var email = new Email(\"#ud_email\");\n\n        // handle signature file upload\n        $(\"#ud_signatureImageChange\").change(function () {\n            var files = (<HTMLInputElement>$(\"#ud_signatureImageChange\")[0]).files;\n            if (files) {\n                let validFileExtensions = [\"jpg\", \"jpeg\", \"bmp\", \"gif\", \"png\"];\n                let nameparts = files[0].name.toLowerCase().split(\".\");\n                if (validFileExtensions.indexOf(nameparts[nameparts.length-1]) != -1) {\n\n                    restConnection.uploadFileCustomerAsync(files[0], function (progress: IFileUploadProgress) {\n                    }).done(function (result:IFileUploadResult) {\n                        let imgPath = globalMatrix.matrixRestUrl + \"/all/file/\" + result.fileId + \"?key=\" + result.key;\n\n                        let testSize = $(\"<img style='display:none'>\").appendTo(\"body\").attr(\"src\", imgPath).load( function( event ) {\n                            if (testSize.height() > 300 || testSize.width() > 800 ) {\n                                ml.UI.showError( \"Signature image too large\", \"Image cannot exceed 800x300 pixels.\");\n                            } else {\n                                $(\"#ud_signatureImage\").val(result.fileId);\n                                $(\"#ud_currentImg\").html(\"\").append(\"<img class='signature' src='\" + imgPath +\"'>\");\n                                if (mode === \"useredit\" && matrixSession.oAuthOnly()) {\n                                    that.enableSaveOAuth();\n                                }\n                            }\n                            testSize.remove();\n                        });\n                    }).fail(function (error) {\n                        ml.UI.showError(\"Failed to upload image\", error);\n                    });\n                } else {\n                    ml.UI.showError(\"Only image files are supported\", \"\");\n                }\n            }\n        });\n\n        // function to get values back from form\n        function readform() {\n\n            var error = false;\n\n            error = ($(\"#ud_pw1\").val()!=\"\" && !pw1.isOK()) || error;\n            error = ((userInfo.needDoublePassword == 1 || matrixSession.oAuthOnly()) && ($(\"#ud_pw2\").val() != \"\" && !pw2.isOK())) || error;\n            error = !email.isOK() || error;\n            error = !user.isOK() || error;\n            if (error) {\n                return null;\n            }\n            let signImageVal = <string>$(\"#ud_signatureImage\").val();\n            let signImage =  signImageVal?parseInt(signImageVal.split(\"?\")[0]):-1;\n            return {\n                login: (<string>$(\"#ud_login\").val()).toLowerCase(),\n                email: $(\"#ud_email\").val(),\n                pw1: $(\"#ud_pw1\").val(),\n                firstName: $(\"#ud_firstName\").val(),\n                lastName: $(\"#ud_lastName\").val(),\n                signatureImage: signImage,\n                pw2: $(\"#ud_pw2\").val(),\n                pw3: $(\"#ud_pw3\").val(),\n                customerAdmin: $(\"#ud_customerAdmin\").prop(\"checked\") ? 1 : 0\n            };\n        }\n\n        function saveData(newValues:IUserCreate) {\n            var res = $.Deferred();\n            var signatureImage = -1;\n            if (newValues.signatureImage) {\n                signatureImage = newValues.signatureImage;\n                if (isNaN(signatureImage)) {\n                    signatureImage = -1;\n                }\n            }\n            var jsonParamObj = {\n                login: newValues.login.toLowerCase(),\n                email: newValues.email,\n                password: newValues.pw1,\n                firstName: newValues.firstName,\n                lastName: newValues.lastName,\n                signatureImage: signatureImage,\n                signaturePassword: newValues.pw2, // signature for password\n                admin: newValues.customerAdmin // whether user is an admin\n            };\n\n            if (!jsonParamObj.password) delete jsonParamObj.password;\n            if (!jsonParamObj.signaturePassword) delete jsonParamObj.signaturePassword;\n\n            var jsonParam = JSON.stringify(jsonParamObj);\n\n            if (mode === \"create\") {\n                restConnection.postServer(\"user\", {\n                    json: jsonParam\n                }).done(function () {\n                    if (userAddedCb) {\n                        userAddedCb();\n                    }\n                    res.resolve();\n\n                }).fail(function (jqxhr:IJcxhr, textStatus:string, error:string) {\n\n\n                    let msg:string =  ml.UI.getDisplayError(jqxhr, textStatus, error);\n\n                    if ( jqxhr &&\n                        jqxhr.responseJSON &&\n                        jqxhr.responseJSON.detailsList &&\n                        jqxhr.responseJSON.detailsList.length &&\n                        jqxhr.responseJSON.detailsList[0].indexOf(\"Last operation would overflow number of licenses (error in compute)|CreateUserMethod\")!=-1) {\n                        msg = \"There are no more write licenses.\";\n                    } else if ( jqxhr && jqxhr.responseText && jqxhr.responseText.indexOf(\"duplicate\") !== -1) {\n                        msg = \"user id exists already\";\n                    }\n\n                    ml.UI.showError(\"Failed to create user!\", msg);\n\n                    if (noUserAddedCb) {\n                        noUserAddedCb();\n                    }\n                    res.reject();\n                });\n            } else if (mode === \"adminedit\") {\n\n                restConnection.putServer(\"user/\" + newValues.login.toLowerCase(), {\n                    json: jsonParam\n                }).done(function (result) {\n                    if (userAddedCb) {\n                        userAddedCb();\n                    }\n                    res.resolve();\n                }).fail(function (errorMsg) {\n                    ml.UI.showError(\"Failed to create user!\", errorMsg);\n                    if (noUserAddedCb) {\n                        noUserAddedCb();\n                    }\n                    res.reject();\n                });\n            } else if (matrixSession.oAuthOnly()) { // user edit oAuth only\n\n                that.setUserData(newValues.login.toLowerCase(), jsonParam, userAddedCb,noUserAddedCb).done( function() {\n                    res.resolve();\n                }).fail( function() {\n                    res.reject();\n                });\n            } else  { // user edit normal auth user\n\n                $.post(globalMatrix.matrixRestUrl + \"/user/\" + newValues.login.toLowerCase() + \"/login\", { password: newValues.pw3 }).done(function (data) {\n                    that.setUserData(newValues.login.toLowerCase(), jsonParam, userAddedCb,noUserAddedCb, newValues.pw1 != \"\" && newValues.pw2 != \"\").done( function() {\n                        res.resolve();\n                    }).fail( function() {\n                        res.reject();\n                    });\n                }).fail(function (jqxhr, textStatus, error) {\n                    ml.UI.showError(\"Incorrect current password!\", \"\");\n                    if (noUserAddedCb) {\n                        noUserAddedCb();\n                    }\n                    res.reject();\n                });\n            }\n            return res;\n        }\n\n        let buttons = [];\n\n\n\n        buttons.push({\n            text: 'Close',\n            class: 'btnCancelIt',\n            click: function () {\n                if (noUserAddedCb) {\n                    noUserAddedCb();\n                }\n                app.dlgForm.dialog(\"close\");\n            }\n        });\n        if(mode === \"create\" || mode == \"adminedit\"){\n                    buttons .push({\n                    text: (mode === \"create\")?'Create':'Save',\n                    class: 'btnDoIt savePwButton',\n                    click: save\n                });\n            }\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: (mode === \"create\" )?\"Create new User\":\"My profile\",\n            width: tablewidth + 80,\n            height:600,\n            modal: true,\n            resize:function(){\n                $(\"#ud_pw3\").width($(\"#ud_login\").width()  - $(\"#saveBtn\").width()-40);\n            },\n            open: function () {\n                var pwb = $('span button:contains(PW)', app.dlgForm.parent());\n\n                if (mode === \"useredit\") {\n                    if (matrixSession.oAuthOnly()) {\n                        pwb.replaceWith($(\"<span>\"));\n                        $(\"#ud_signatureImage\").data(\"org\", $(\"#ud_signatureImage\").val());\n                        let saveOAuth = $(`<button id=\"saveBtnOAuth\" class=\"ui-button ui-corner-all ui-widget\"> Save </button>`).click( () => {\n                            saveData(  readform() );\n                        });\n                        $(\"#saveBtn\").hide().parent().append(saveOAuth);\n                        $(\"#ud_pw2\").on(\"change keyup paste\", function () {\n                            that.enableSaveOAuth();\n                        });\n                        that.enableSaveOAuth();\n                    } else {\n                        // request a current password to change user\n                        var pwp = $('<input type=\"text\" class=\"form-control ud_useredit_line\" id=\"ud_pw3\" style=\"height:31px;margin-right:10px;width:250px;display: inline-block;\" placeholder=\"enter current password to save\">');\n                        pwp.on(\"keyup\", function() {\n                            pwp.attr(\"type\",\"password\");\n                        });\n                        var errorPwp = $(\"<span id='errorPWP' style='color:red;padding-right:8px;'>\").html(ml.UI.spaceMessage(false, true));\n                        pwb.replaceWith($(\"<span>\").append(errorPwp).append(pwp));\n                        $(\"#saveBtn\").closest(\"div\").css(\"margin-top\", \"36px\");\n                        errorPwp.hide();\n\n                        $(\".savePwButton\").button(\"disable\");\n                        pwp.on(\"change keyup paste\", function () {\n                            that.enableSavePwd(!readform());\n                        });\n                        that.enableSavePwd(!readform());\n                    }\n                } else {\n                    pwb.hide();\n                    $(\"#saveBtn\").hide();\n                    $(\"#userPref .dateSettings\").hide();\n                    that.enableSavePwd(!readform());\n                }\n\n            },\n            buttons: buttons\n        });\n\n    }\n\n    enableSaveOAuth( ) {;\n        ml.UI.setEnabled( $(\"#saveBtnOAuth\"), $(\"#ud_signatureImage\").data(\"org\") !=$(\"#ud_signatureImage\").val() || !!$(\"#ud_pw2\").val());\n    }\n\n    saveEmailNotificationsSetting(user:string, setting:IEmailNotificationSetting)\n    {\n        let data = {\n            key: UserControl.EMAILNOTIF_CONFIG,\n            value: JSON.stringify(setting),\n            reason: \"Updating notification Setting\"\n        }\n        restConnection.postServer(\"user/\" + user + \"/setting\", data).then(() => {\n            if (user == matrixSession.getUser())\n            {\n                matrixSession.tryReconnect();\n            }\n        });\n\n    }\n    renderNotificationEmailReminder(userDetails: IUserCreate, table: JQuery) {\n        let that = this;\n\n        if( userDetails.userSettingsList == undefined)\n        {\n            userDetails.userSettingsList = [];\n        }\n\n        let emailNotificationSettings =  userDetails.userSettingsList.filter((set)=>{ return set.key == UserControl.EMAILNOTIF_CONFIG });\n\n        let emailNotificationSetting:IEmailNotificationSetting = emailNotificationSettings.length>0 ? JSON.parse(emailNotificationSettings[0].value ): {periodicity:\"\"};\n\n        let tableBody  = $(\"tbody\",table);\n        tableBody.append($('<tr class=\"notif showInAdmin\" ><td colspan=\"2\" class=\"baseControlHelp\">Notifications Digest Email</td></tr'));\n\n        var tr = $(\"<tr  class='notif showInAdmin' >\");\n        tableBody.append(tr);\n\n        tr.append($(\"<td class='admin_utdl'>\").append($(\"<label class='control-label'>\").html(\"Email notifications\")));\n\n        let options: IDropdownOption[] = [\n            {id:\"\", label:\"No email\"},\n            {id:\"daily\", label:\"Email me daily\"},\n            {id:\"weekly\", label:\"Email me weekly\"}\n        ];\n\n        let div=  $(\"<div/>\");\n\n        // ml.UI.addDropdownToValue(  \"Periodicity\", emailNotificationSetting, \"periodicity\", options, false, false, () => {\n        //     that.saveEmailNotificationsSetting(userDetails.login, emailNotificationSetting); });\n\n\n        tr.append($(\"<td>\").append(`<select  style=\"width: 100%;height: 34px;\" class=\"form-control\" id=\"emailNotifCombo\">\n                <option value=\"\">No email</option>\n                <option value=\"daily\">Email me daily</option>\n                <option value=\"weekly\">Email me weekly</option>\n           </select>`));\n\n        $(\"#emailNotifCombo\").change((o)=>{\n            var value = $( \"#emailNotifCombo option:selected\" ).val();\n            emailNotificationSetting.periodicity = value;\n            that.saveEmailNotificationsSetting(userDetails.login, emailNotificationSetting);\n        });\n        $(\"#emailNotifCombo\").val(emailNotificationSetting.periodicity );\n\n        tr.append($(\"<td>\").append(\"\"));\n\n    }\n    private createUserMail(allUsers: XRGetUser_AllUsers_GetUserListAck, user: string, reset: boolean, pl: string, askForName: boolean) {\n        let that = this;\n        let prl = parseInt(matrixSession.getCustomerSetting(\"passwordResetLimitation\"));\n        // if NaN or undefined then fallback to 3days\n        let maxDuration = prl ? prl : 72;\n        restConnection.postServer(\"user/\" + user + \"/token\", {\n            purpose: \"password_reset\",\n            validity:maxDuration,\n            reason:\"password reset by admin\"\n        }).done(async function (token: any) {\n            // Update list of existing users if necessary.\n            await that.updateGlobalUserInfo();\n\n            var userDetails = (allUsers.user.filter(o=>o.login == user));\n\n            let additionnalParameters  =\"\"\n            if( askForName) {\n                additionnalParameters = \"&askForName=1\";\n                if(userDetails.length >0 ) {\n                    additionnalParameters += \"&first=\" + userDetails[0].firstName+ \"&last=\"+ userDetails[0].lastName ;\n                }\n\n            }\n            let url = globalMatrix.matrixBaseUrl + \"/resetPassword.jsp?user=\" + user + \"&passwordStrength=\" + allUsers.passwordStrength + additionnalParameters + \"&double=\" + ((allUsers.needDoublePassword == 1 || matrixSession.oAuthOnly()) ? \"1\" : \"0\") + \"&oAuthOnly=\" + (matrixSession.oAuthOnly() ? \"1\" : \"0\") + \"&token=\" + token.token;\n\n\n            var userinfo =  \"You need to set your password(s) using this link: <a href='\" + url +\"'>\"+url+\"</a><br/><br/>\" +\n                \"Once you set your password you can login here: <a href='\" + globalMatrix.matrixBaseUrl + \"'>\" + globalMatrix.matrixBaseUrl + \"</a><br/>\" +\n                \"Your user id is: <b>\" + user + \"</b><br/><br/>\"+\n                \"Note: you have \" + maxDuration + \" hours to do this. If you are too late ask your admin for a new link!\";\n\n                var message = ml.Mail.getCannedMessage(reset?\"reset_pwd\":\"new_user\", user, \"\");\n\n                message = message.replace(\"_userinfo_\", userinfo);\n                message = message.replace(\"_projectlist_\", pl);\n\n                ml.Mail.sendMail(user, \"\", \"\", reset?\"Password Reset\":\"Access to Matrix\", message,undefined,undefined,1);\n        });\n\n    }\n\n    private enableSavePwd(disable:boolean) {\n        let pwp = $(\"#ud_pw3\");\n        let errorPwp = $(\"#errorPWP\");\n        let errorMatch = $(\"#errorMatch\");\n        let btn = $(\".savePwButton\");\n        errorPwp.hide();\n        errorMatch.hide();\n\n        if ($(\"#ud_pw1\").val() != $(\"#ud_pw1R\").val())  {\n            btn.button(\"disable\");\n            errorMatch.show();\n        }  else if (pwp.length && (<string>pwp.val()).length === 0) {\n            btn.button(\"disable\");\n        } else if (pwp.length && (<string>pwp.val()).indexOf(\" \") !== -1) {\n            btn.button(\"disable\");\n            errorPwp.show();\n        } else {\n            btn.button(disable?\"disable\":\"enable\");\n        }\n\n    }\n\n    private setUserData( userId:string, jsonParam:string, userAddedCb:Function, noUserAddedCb:Function , signOut = true):JQueryDeferred<{}> {\n        let res = $.Deferred();\n        restConnection.putServer(\"user/\" + userId, {\n            json: jsonParam\n        }).done(function (result) {\n            if (userAddedCb) {\n                userAddedCb();\n            }\n            if(signOut)\n                {\n                matrixSession.signOut(false);\n                    ml.UI.showSuccess(\"The password has been updated!\");\n                }\n\n            res.resolve();\n        }).fail(function (errorMsg) {\n            ml.UI.showError(\"Failed to create user!\", errorMsg);\n            if (noUserAddedCb) {\n                noUserAddedCb();\n            }\n            res.reject();\n        });\n        return res;\n    }\n\n    private getUserDetailsHTML(mode:string, login:string) {\n\n/* !!! IMPORTANT !!!\n    In response to a customer's concern about compliance with 21 CFR Part 11 Section 11.200a(3),\n    it was found that our system allows administrators to change a user's password or email and subsequently\n    log in as that user, potentially impersonating them and signing documents on their behalf.\n\n    To address this compliance issue, we have made the following changes:\n      - Any changes to a user's email address now require a support ticket.\n      - We have restricted the ability to change a user's password and email  to  superadmins (or the user itself).\n\n    These changes ensure that the system complies with the requirement for \"2 or more\" individuals\n    and enhances security by limiting certain administrative actions.\n    See : SER-25549\n*/\n\n\n        let part11disabled = (mode==\"useredit\" || (mode==\"adminedit\" && login == matrixSession.getUser()));\n\n\n        let isUserSelf = mode == \"useredit\" ||  login == matrixSession.getUser() ;\n        let isSuperAdmin = matrixSession.isSuperAdmin();\n        let isAdmin = matrixSession.isAdmin();\n        let isCreate = mode == \"create\";\n\n        let canEditEmail = (isSuperAdmin || isCreate);\n        let canSeeEmail = isSuperAdmin || isAdmin || isCreate\n        let canEditName =(isSuperAdmin || isCreate || isAdmin)   && ! isUserSelf ;\n\n        let canEditPassWord = isSuperAdmin || isCreate || isUserSelf;\n        let canSeePassWord = isSuperAdmin || isCreate  || isUserSelf;\n        let canEditSignature = isSuperAdmin || isCreate  || isUserSelf;\n\n\n\n\n\n        let part11 = part11disabled?\"disabled for part 11 compliance, ask \" + (mode==\"adminedit\"?\"another\":\"an\")+\" admin to change\":\"\";\n\n        return '<div class=\"container\" style=\"width:100%;white-space:nowrap;\">' +\n            '<fieldset><legend>User info</legend><table id=\"userPrefTable\" style=\"width:100%\" >' +\n            '  <tr><td colspan=\"2\" class=\"baseControlHelp\">Sign-In</td></tr>' +\n            '  <tr>' +\n            '    <td class=\"admin_utdl\"><label for=\"ud_login\" class=\"control-label\">User Id</label></td>' +\n            '    <td class=\"admin_utdr\"><input autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"ud_login\" placeholder=\"User id\"></td>' +\n            '  </tr>' +\n            '  <tr>' +\n            '    <td class=\"admin_utdl\"><label for=\"ud_firstName\" class=\"control-label\">First Name</label></td>' +\n            '    <td class=\"admin_utdr\"><input title=\"'+part11 +'\" autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"ud_firstName\" placeholder=\"First name\" ' +(canEditName ? \"\" : 'disabled') + '></td>' +\n            '  </tr>' +\n            '  <tr>' +\n            '    <td class=\"admin_utdl\"><label for=\"ud_lastName\" class=\"control-label\">Last Name</label></td>' +\n            '    <td class=\"admin_utdr\"><input title=\"'+part11 +'\" autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"ud_lastName\" placeholder=\"Last name\" ' + (canEditName ? \"\" : 'disabled') + '></td>' +\n            '  </tr>' +\n            '  <tr ' + (canSeeEmail?\"\":\"style='display:none' \") +'>' +\n            '    <td class=\"admin_utdl\"><label for=\"ud_email\" class=\"control-label\">Email</label></td>' +\n            '    <td class=\"admin_utdr\"><input title=\"'+part11 +'\" autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"ud_email\" placeholder=\"Email\" ' + (canEditEmail ? \"\" : \"disabled\") + '></td>' +\n            '  </tr>' +\n            '  <tr   ' + (canSeePassWord?\"\":\"style='display:none' \") +' id=\"ud_pw1_line\">' +\n            '    <td class=\"admin_utdl\"><label autocomplete=\"new-password\" for=\"ud_pw1\" class=\"control-label\">Password for Login</label>' +\n            //'       <button class=\"btn btn-default btn-xs pwgen\" data-target=\"ud_pw1\" id=\"ud_cpw1\" >create</button>' +\n            '    </td>' +\n            '    <td class=\"admin_utdr\"><input autocomplete=\"new-password\" type=\"password\" class=\"form-control\" id=\"ud_pw1\" placeholder=\"password\" '+(canEditPassWord?\"\":\"disabled\") +' ></td>' +\n            '  </tr>' +\n            '  <tr  ' + (canSeePassWord?\"\":\"style='display:none' \") +' id=\"ud_pw1R_line\">' +\n            '    <td class=\"admin_utdl\"><label autocomplete=\"new-password\" for=\"ud_pw1R\" class=\"control-label\">Repeat</label>' +\n            '    </td>' +\n            '    <td class=\"admin_utdr\"><input autocomplete=\"new-password\" type=\"password\" class=\"form-control\" id=\"ud_pw1R\" placeholder=\"repeat\" '+(canEditPassWord?\"\":\"disabled\") +'>' +\n            '         <div id=\"errorMatch\" style=\"color:red;\">passwords do not match</div></td>' +\n            '  </tr>' +\n            //'  <tr><td colspan=\"2\" class=\"baseControlHelp\">Electronic Signatures</td></tr>' +\n            '  <tr>' +\n            '    <td class=\"admin_utdl\"><label class=\"control-label\">Signature Image</label></td>' +\n            '    <td class=\"admin_utdr\">' +\n            '       <span id=\"ud_currentImg\"></span>' +\n            '       <label for=\"ud_signatureImageChange\"  style=\"color:blue;font-weight:normal;cursor:pointer;' + (canEditSignature?\"\":\"display:none\") +'\">select signature image</label>' +\n            '       <input accept=\"image/JPEG,image/GIF,image/PNG,image/BMP\" style=\"display:none\" type=\"file\" id=\"ud_signatureImageChange\">' +\n            '       <input autocomplete=\"off\" style=\"display:none\" type=\"text\" id=\"ud_signatureImage\">' +\n            '    </td>' +\n            '  </tr>' +\n            '  <tr>' +\n            '    <td class=\"admin_utdl\"></td>' +\n            '    <td class=\"admin_utdr\">' +\n            '    </td>' +\n            '  </tr>' +\n            '  <tr ' + (canSeePassWord?\"\":\"style='display:none' \") +' id=\"ud_pw2_line\">' +\n            '    <td class=\"admin_utdl\"><label for=\"ud_pw2\" class=\"control-label\">Password for eSignatures</label>' +\n            //'       <button class=\"btn btn-default btn-xs pwgen\" data-target=\"ud_pw2\" id=\"ud_cpw2\" >create</button>' +\n            '    </td>' +\n            '    <td class=\"admin_utdr\"><input type=\"password\" class=\"form-control\" id=\"ud_pw2\" placeholder=\"password\" '+(canEditPassWord?\"\":\"disabled\") +'></td>' +\n            '  </tr>' +\n            '  <tr class=\"admin_line\"><td colspan=\"2\" class=\"baseControlHelp\">Server Administration Rights</td></tr>' +\n            '  <tr class=\"admin_line\">' +\n            '    <td class=\"admin_utdl\" colspan=\"2\" > <div class=\"checkbox\"><label><input id=\"ud_customerAdmin\" type=\"checkbox\"> is administrator</label></div></td>' +\n            '  </tr>' +\n            '  </table></fieldset><br/>' +\n            '<fieldset id=\"userPref\"><legend>User preferences</legend></fieldset>';\n\n    }\n\n    private generatePassword(btn?:JQuery) {\n        var keylist1 = \"ABCDEFGHIJKLMNPQRSTUVWXYZabcdefghijklmnpqrstuvwxyz123456789_@?+-\";\n        var keylist2 = \"_@?+-\";\n\n        function gp(chars:string, count:number) {\n            var pwd = '';\n            for (var idx = 0; idx < count; idx++) {\n                pwd += chars.charAt(Math.floor(Math.random() * chars.length));\n            }\n            return pwd;\n        }\n\n        var pw = gp(keylist1, 11) + gp(keylist2, 1) + gp(keylist1, 3);\n        if (btn) {\n            var target = btn.data(\"target\");\n            $(\"#\" + target).val(pw);\n            // make readable\n            (<HTMLInputElement>$(\"#\" + target).get(0)).type = 'text';\n        }\n        return pw;\n    }\n\n}\n\n\nvar userControls = new UserControl();\n\n","export { Email };\n\n// makes an email field with validation out of an input field\nclass Email {\n    \n    private element:JQuery;\n    private resultBox:JQuery;\n    constructor (e:string)\n    {\n        this.element = $(e);\n        this.resultBox = $(\"<div>\");\n        this.resultBox.css(\"color\", \"red\");\n\n        this.element.parent().append(this.resultBox);\n        this.element.keyup(() => this.validate());\n       \n    }\n    \n    isOK () {\n        return this.validate();\n    }\n       \n    private validate() {\n        var name = this.element.val();\n        if (name === \"\") {\n            this.resultBox.html('email is required and cannot be empty');\n            this.resultBox.show();\n            return false;\n        }\n        if (/^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(name)) {\n            this.resultBox.hide();\n            return true;\n        }\n\n        this.resultBox.html('This is not a correct email');\n        this.resultBox.show();\n        return false;\n    }\n}","import { ml } from \"../../matrixlib\";\n\nexport { StrongPass };\n\ninterface PasswordOptions {\n            minChar?: number, // too short while less than this\n\n            passIndex?: number, // Weak\n\n            // output verdicts, colours and bar %\n            label?: string,\n            verdicts?: string[],\n            colors?: string[],\n            width?: string[],\n            // tweak scores here\n            scores?: number[],\n            passFail?:(result:boolean) => void ,\n            other?:string\n}\n\nclass StrongPass {\n    private options:PasswordOptions;\n    private bannedPasswords:string[];\n    private checks:{re:RegExp, score:number}[];\n    private element:JQuery;\n    private resultBox:JQuery;\n    \n    constructor(element:string, param:PasswordOptions) {\n        \n        let defaultOptions:PasswordOptions = {\n            minChar: 6, // too short while less than this\n\n            passIndex: 3, // Weak\n\n            // output verdicts, colours and bar %\n            label: 'Password strength: ',\n            verdicts: [\"Error: Too Short\",\"Error: far too weak\",\"Error: very weak\",\"Error: still very weak\",\"Error: too weak\",\"Error: still too weak\"],\n            colors: ['#ccc','#500','#800','#f60','#050','#0f0'],\n            width: ['0%','10%','30%','60%','80%','100%'],\n            // tweak scores here\n            scores: [10,15,25,45],\n            passFail: (result:boolean) => {} ,\n            other:\"\"\n        };\n    \n        this.bannedPasswords = [\n            // see study here: http://smrt.io/JlNfrH\n            '123456', '12345', '123456789', 'password', 'iloveyou', 'princess', 'rockyou', '1234567', '12345678', 'abc123', 'nicole',\n            'daniel', 'babygirl', 'monkey', 'jessica', 'lovely', 'michael', 'ashley', '654321', 'qwerty', 'password1', 'welcome', 'welcome1',\n            'password2', 'password01', 'password3', 'p@ssw0rd', 'passw0rd', 'password4', 'password123', 'summer09', 'password6',\n            'password7', 'password9', 'password8', 'welcome2', 'welcome01', 'winter12', 'spring2012', 'summer12', 'summer2012'\n        ];\n        \n        this.checks = [\n            /* alphaLower */ {\n                re: /[a-z]/,\n                score: 1\n            },\n            /* alphaUpper */ {\n                re: /[A-Z]/,\n                score: 5\n            },\n            /* mixture of upper and lowercase */ {\n                re: /([a-z].*[A-Z])|([A-Z].*[a-z])/,\n                score: 2\n            },\n            /* threeNumbers */ {\n                re: /(.*[0-9].*[0-9].*[0-9])/,\n                score: 7\n            },\n            /* special chars */ {\n                re: /.[!@#$%^&*?_~]/,\n                score: 5\n            },\n            /* multiple special chars */ {\n                re: /(.*[!@#$%^&*?_~].*[!@#$%^&*?_~])/,\n                score: 7\n            },\n            /* all together now, does it look nice? */ {\n                re: /([a-zA-Z0-9].*[!@#$%^&*?_~])|([!@#$%^&*?_~].*[a-zA-Z0-9])/,\n                score: 3\n            },\n            /* password of a single char sucks */ {\n                re: /(.)\\1+$/,\n                score: 2\n            }\n        ];\n \n        this.resultBox = $(\"<div>\");\n        this.options = <any>ml.JSON.mergeOptions(defaultOptions, param);\n        this.element = $(element);\n        this.createBox();\n        this.attachEvents();       \n    }\n    setPassIndex (newIndex:number) {\n        this.options.passIndex = newIndex;\n        this.runPassword();\n    }\n\n    isOK () {\n        return this.runPassword();\n    }\n\n    private attachEvents() {\n        // only attach events once \n        this.element.keyup(() => this.runPassword());\n    }\n\n    private createBox() {\n        this.element.parent().append(this.resultBox);\n    }\n\n    private runPassword() {\n        var password :string= this.element.val();\n\n        this.resultBox.html(\"\");\n        let score = this.checkPassword(password);\n        let index = 0;\n        let s:number[] = ml.JSON.clone(this.options.scores);\n        let verdict:string;\n\n        if (this.bannedPasswords.indexOf(password.toLowerCase()) !== -1) {\n            this.resultBox.append(\"Error: banned password\");\n            this.resultBox.css(\"color\", \"red\");\n            this.resultBox.show();\n            this.options.passFail(false);\n            return false;\n        } else if (password === \"\") {\n            this.resultBox.append(\"you must enter a password\");\n            this.resultBox.css(\"color\", \"red\");\n            this.resultBox.show();\n            this.options.passFail(false);\n            return false;\n        } else if (password !== \"\" && password.indexOf(\" \") !== -1) {\n            this.resultBox.append(\"spaces are not allowed in password\");\n            this.resultBox.css(\"color\", \"red\");\n            this.resultBox.show();\n            this.options.passFail(false);\n            return false;\n        } else if (password !== \"\" && this.options.other !== \"\" && $(this.options.other).val() === password) {\n            this.resultBox.append(\"login and signature password must be different\");\n            this.resultBox.css(\"color\", \"red\");\n            this.resultBox.show();\n            this.options.passFail(false);\n            return false;\n        } else {\n            if (score < 0 && score > -199) {\n                index = 0;\n            }\n            else {\n                s.push(score);\n                s.sort(function (a, b) {\n                    return a - b;\n                });\n                index = s.indexOf(score) + 1;\n            }\n\n            var passed = index >= this.options.passIndex;\n            if (passed) {\n                this.resultBox.hide();\n            } else {\n                verdict = this.options.verdicts[index] || this.options.verdicts[this.options.verdicts.length-1];\n                this.resultBox.append(\"Score \" + score + \" verdict \" + verdict);\n                this.resultBox.css(\"color\", passed ? \"black\" : \"red\");\n                this.resultBox.show();\n            }\n            this.options.passFail(passed);\n            return passed;\n        }\n\n    };\n   \n    private checkPassword(pass:string):number {\n        let score = 0;\n        let minChar = this.options.minChar;\n        let len = pass.length;\n        let diff = len - minChar;\n\n        (diff < 0 && (score -= 100)) || (diff >= 5 && (score += 18)) || (diff >= 3 && (score += 12)) || (diff === 2 && (score += 6));\n\n        $.each(this.checks, function (idx, check) {\n            pass.match(check.re) && (score += check.score);\n        });\n\n        // bonus for length per char\n        score && (score += len);\n        return score;\n    }\n\n\n\n \n}\n\n","export { User };\n\nclass User {\n    \n    private element:JQuery;\n    private resultBox:JQuery;\n    \n    constructor(el:string) {\n        this.element =  $(el);\n        this.resultBox = $(\"<div>\");\n        this.resultBox.css(\"color\", \"red\");\n\n        this.element.parent().append(this.resultBox);\n        this.element.keyup(() => this.validate());\n    }\n   \n    isOK () {\n        return this.validate();\n    } \n    \n    private validate() {\n        var name:string = this.element.val();\n        if (name === \"\") {\n            this.resultBox.html(\"The user id is required and cannot be empty\");\n            this.resultBox.show();\n            return false;\n        }\n        if (name.length < 1 || name.length > 30) {\n            this.resultBox.html('The user id must be at least 1 and at most 30 characters long');\n            this.resultBox.show();\n            return false;\n        }\n        if (/^[a-zA-Z0-9_\\.\\-]+$/.test(name)) {\n            this.resultBox.hide();\n            return true;\n        }\n\n        this.resultBox.html('The user id can only consist of letters, dots, digits, dash and underscores');\n        this.resultBox.show();\n        return false;\n    }\n}  \n\n   \n","/// <reference types=\"matrixrequirements-type-declarations\" />\n\n// -----------------------------------------------------------\n// Functions to show history in dialog or in item details\n// -----------------------------------------------------------\n\nimport { XCPostCompareHtml } from \"../../../RestCalls\";\nimport { XRTag, XRTrimAudit, XRMergeHistory, XRTrimNeedleItem, XRGetProject_ProjectAudit_TrimAuditList, XRGetProject_Tags_TagList } from \"../../../RestResult\";\nimport { IVersionDetails, IReferenceUpdate, BranchingHelper } from \"../../businesslogic/index\";\nimport { MR1 } from \"../../businesslogic/index\";\nimport { ml } from \"../../matrixlib\";\nimport { ItemControl } from \"../Components/ItemForm\";\nimport { NavigationPanel } from \"../MainTree/MainTree\";\nimport { refLinkStyle, refLinkTooltip } from \"../Parts/RefLinkDefines\";\nimport { UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\";\nimport { IItem, app, IRestParam, globalMatrix, matrixSession, ControlState, restConnection, matrixApplicationUI, IItemHistory } from \"../../../globals\";\nimport {render} from \"react-dom\";\n\nexport type {\n    IHistory, IHistoryMap, IPanelOptions, IMergeLine, IAccordionLine, IReportLine, IExecuteLine,\n    ISignLine, IAccordionToggleOptions, IShowHistoryDialogOptions, IShowHistoryDialogButtonOptions\n};\nexport { HistoryTools };\n\ninterface IHistory {\n    history: IVersionDetails[], id: string,\n    panel?: JQuery, panelBorder?: JQuery, header?: JQuery, wasEdit?: boolean\n};\n\ninterface IHistoryMap { [key: string]: IHistory };\n\ninterface IPanelOptions {\n    deletedItems: boolean,\n    deletedate?: string,\n    ctrl: JQuery,\n    id: string,\n    title: string,\n    isFolder: boolean,\n    version: number,\n    user: string,\n    action: string,\n    dateServer: string,\n    date: string,\n    comment: string,\n    allowRestore: boolean,\n    fullVersion: string,\n    auditId: number,\n    tags: XRTag[]\n}\n\ninterface IMergeLine { user: string, date: string, dateServer: string, tags: XRTag[], comment: string, ctrl: JQuery, auditId: number, action: string }\ninterface IAccordionLine { id: string, title: string, version: number, user: string, date: string, dateServer: string }\ninterface IReportLine extends IAccordionLine { job: number }\ninterface IExecuteLine extends IAccordionLine { }\ninterface ISignLine extends IAccordionLine { reason: string }\ninterface IAccordionToggleOptions { ctrl: JQuery, id: string, version: number, panelId: number, auditId: number, action: string };\ninterface IShowHistoryDialogOptions { item: IItem, preselect?: number[], id?: string, isFolder?: boolean, readOnly?: boolean }\ninterface IShowHistoryDialogButtonOptions { item: IItem, control: JQuery, id?: string, isFolder?: boolean, readOnly?: boolean }\n\n\nclass HistoryTools {\n    onNewResult(cb: () => void) {\n        this.onNewResultCallback = cb;\n    }\n\n    private onNewResultCallback:() => void;\n\n    private panelIdCounter: number;\n    private controls: ItemControl[];\n    private lastHistory: string;\n    private readHistory: IHistoryMap;\n    private lastWasTimewarp = false;\n\n    constructor() {\n        this.panelIdCounter = 0;\n        this.controls = [];\n    }\n\n    compareLatest(itemId: string): void {\n        let that = this;\n\n        app.getItemAsync(itemId).done(function (item) {\n            that.showHistoryDialog({ item: item, preselect: [0, item.history.length], readOnly: !app.canEditItem(item) });\n        });\n    }\n    compare(fullVersion: string): void {\n        let that = this;\n\n        var i0 = ml.Item.parseRef(fullVersion);\n        app.getItemAsync(i0.id).done(function (item) {\n            that.showHistoryDialog({ item: item, preselect: [i0.version - 1, i0.version], readOnly: !app.canEditItem(item) });\n        });\n    }\n    compareVersions(itemId: string, oldVersion: number, newVersion: number): void {\n        let that = this;\n\n        app.getItemAsync(itemId).done(function (item) {\n            that.showHistoryDialog({ item: item, preselect: [oldVersion, newVersion], readOnly: !app.canEditItem(item) });\n        });\n    }\n    // compare what is in current editor against what is in database now\n    diffAgainstLatest(localChanges: IRestParam): void {\n        let that = this;\n        app.getItemAsync(app.getCurrentItemId()).done(function (item) {\n            // make a copy of item and copy in all the changes from the UI\n            let copyOfItem = ml.JSON.clone(item);\n            $.each(copyOfItem, function (key, _val) { if (localChanges[key] != null) copyOfItem[key] = localChanges[key]; if (localChanges[\"fx\" + key] != null) copyOfItem[key] = localChanges[\"fx\" + key]; });\n            copyOfItem.title = localChanges.title;\n            // compare the item against the UI\n            that.showDiffDialog(item, copyOfItem);\n        });\n    }\n    showDeletedItems(ctrl: JQuery): void {\n        let that = this;\n\n        app.itemForm.prepend(ml.UI.getPageTitle(\"Deleted Items\"));\n\n        if (ml.UI.DateTime.requiresTimeZoneWarning()) {\n            $(\".toolbarButtons .buttonCTA\").remove();\n            $(\".toolbarButtons\").append(ml.UI.DateTime.getTimeZoneCTA());\n        }\n\n        var control = $('<div class=\"panel-body-v-scroll fillHeight\"></div>');\n        ctrl.append(control);\n        var accordion = $('<div class=\"panel-group history-panel-group\" id=\"accordion\"></div>');\n        control.append(accordion);\n        var progressBar = $('<div style=\"height:4px;\"></div><div class=\"progress progress-striped active\">' +\n            '  <div name=\"progress-bar\" class=\"progress-bar\"  role=\"progressbar\" aria-valuenow=\"1\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:1%\">' +\n            '    <span class=\"sr-only\"></span>' +\n            '  </div>' +\n            '</div>');\n        control.append(progressBar);\n        progressBar.hide();\n        var rendered = 0;\n        var showDelayed = window.setTimeout(function () { progressBar.show(); }, 1000); // wait for 1 second to show a progress bar\n        app.getDeletedItemsAsync(function (item: IVersionDetails) { // update UI callback\n            rendered++;\n            let panel = that.createPanel({\n                deletedItems: true,\n                ctrl: control,\n                id: item.id,\n                title: item.title,\n                isFolder: false,\n                version: item.version,\n                user: item.user,\n                action: \"\",\n                dateServer: item.date,\n                date: item.dateUserFormat,\n                comment: item.comment,\n                allowRestore: true,\n                fullVersion: item.fullVersion,\n                auditId: item.auditId,\n                tags: item.tags\n            });\n            accordion.append(panel);\n\n            // add timewarp info\n            if (globalMatrix.ItemConfig.isAfterTimeWarp(item.date)) {\n                that.lastWasTimewarp = true;\n                panel.addClass(\"timewarp\");\n            } else if (that.lastWasTimewarp) {\n                that.lastWasTimewarp = false;\n                panel.addClass(\"justAfterTimewarp\");\n            }\n\n\n        }, function (progress: number) { // update progress\n            $(\"div[name=progress-bar]\", progressBar).data(\"valuenow\", progress).width(progress + \"%\");\n        }).done(function (_total) {\n            clearTimeout(showDelayed);\n            progressBar.hide();\n            if (rendered === 0) {\n                control.append(\"<p style='padding:8px;margin-top:8px;'>There are no deleted items in this project</p>\");\n            }\n        });\n    }\n\n\n    showActivity(ctrl: JQuery, auditIdMin?: number, auditIdMax?: number): void {\n\n        let that = this;\n        if (ml.UI.DateTime.requiresTimeZoneWarning()) {\n            $(\".toolbarButtons .buttonCTA\").remove();\n            $(\".toolbarButtons\").append(ml.UI.DateTime.getTimeZoneCTA());\n        }\n        var control = $('<div class=\"panel-body-no-scroll\">');\n        ctrl.append(control);\n\n        var accordion = $('<div class=\"panel-group history-panel-group\" id=\"accordion\">');\n        control.append(accordion);\n        control.append(ml.UI.getSpinningWait());\n        let thisIstheEnd = $(\"<div id='endOfIt' style='text-align:center; margin:10px; display:none;'> the end! </div>\")\n        control.append(thisIstheEnd);\n\n        let loadMoreDiv = $(\"<div style='text-align:right;'  ><a id='loadMore' style='display:block; text-align:right; width:100%;margin:10px; cursor:pointer;text-decoration:underline; '> Load more... </a></div>\");\n        control.append(loadMoreDiv);\n\n\n        let loading = false;\n\n        let loadMore = ((_t: any) => {\n            console.log('Loading more into calendar')\n            if( !loading)\n            {\n                loadMoreDiv.show();\n                if (that.pFrom + that.pCount < that.pTotal ) {\n                    if (($(\"#accordion\").height() - $(\".change-result\").scrollTop()) < ($(\".change-result\").height() + 30)) {\n                       loading = true ;\n                       thisIstheEnd.hide();\n                        $(\".spinningWait\", control).replaceWith(ml.UI.getSpinningWait());\n                        that.showNextActivity(accordion, control, that.pFrom + that.pCount, that.pCount)\n                                .always(()=>{\n                                    loading = false;\n                                    if(that.onNewResultCallback != undefined)\n                                    {\n                                        that.onNewResultCallback();\n                                    }\n                                    loadMoreDiv.show();\n                                }) ;\n                    }\n                }\n                else{\n                    thisIstheEnd.show();\n                    loadMoreDiv.hide();\n                 }\n            }\n\n\n\n\n        });\n\n\n        this.showNextActivity(accordion, control, 0, 200, auditIdMin, auditIdMax).then(() => {\n\n            if( that.pTotal == 0 )\n            {\n                $(\".calendar-wrapper .spinningWait\").hide();\n                $(\"<div>No changes </div>\").insertAfter($(\".change-result h1\"));\n                thisIstheEnd.hide();\n                loadMoreDiv.hide();\n            }\n            if(that.onNewResultCallback != undefined)\n            {\n                that.onNewResultCallback();\n            }\n            if (!that.scrollInstalled) {\n\n                $(\"#loadMore\").click(loadMore);\n                $(\".change-result\").on(\"scroll\", loadMore);\n\n                that.scrollInstalled = true;\n\n            }\n            if( !loading)\n            {\n                $(\".spinningWait\", control).hide();\n                $(\"#loadMore\").show();\n            }\n        });\n\n\n\n    }\n\n\n    showReadersDigest(ctrl: JQuery): void {\n\n        app.itemForm.prepend(ml.UI.getPageTitle(\"Document Changes and Downloads\"));\n        if (ml.UI.DateTime.requiresTimeZoneWarning()) {\n            $(\".toolbarButtons .buttonCTA\").remove();\n            $(\".toolbarButtons\").append(ml.UI.DateTime.getTimeZoneCTA());\n        }\n        var control = $('<div class=\"panel-body-v-scroll  fillHeight\" style=\"margin:0 12px\">');\n        ctrl.append(control);\n\n        var doclist = $('<div>');\n        control.append(doclist);\n        control.append(ml.UI.getSpinningWait());\n        this.readHistory = {};\n        this.showNextReaders(doclist, control, 0, 100);\n    }\n\n    renderButtons(options: IShowHistoryDialogButtonOptions) {\n\n        var button = $(\"<div  class='btn-group'><button id='historyDlgBtn' tabindex='-1' title data-original-title='History' class='btn btn-item'> <span class='fal fa-history'></span></button></div>\");\n\n        var data: IShowHistoryDialogOptions = {\n            id: options.id,\n            item: options.item,\n            isFolder: options.isFolder,\n            readOnly: options.readOnly\n        };\n\n        button.click(() => this.showHistoryDialog(data));\n\n        options.control.append(button);\n    };\n\n\n\n    private createPanel(options: IPanelOptions): JQuery {\n        let that = this;\n\n        this.panelIdCounter++;\n        var icon = $('<i class=\"hideCopy fal fa-chevron-right\"></i>');\n        var ir = ml.Item.parseRef(options.id);\n\n\n        var itemDisp = $(\"<span ></span>\");\n        if (options.isFolder) {\n            app.getItemAsync(options.id, options.version).done(function (data) {\n                itemDisp.refLink({\n                    id: options.id,\n                    title: data.title,\n                    style: refLinkStyle.show,\n                    tooltip: refLinkTooltip.none\n                });\n            });\n            itemDisp.addClass('history-header');\n\n            itemDisp.addClass('key-' + options.id);\n        }\n\n        if (options.title) {\n            itemDisp = $('<span class=\"history-header key-' + options.id + '\"><b>' + options.id + ' ' + options.title + '</span>');\n        }\n        var versionInfo = $(\"<span ></span>\");\n        if (options.deletedItems || options.action === \"delete\") {\n            versionInfo = $('<span class=\"history-header \"><span class=\"historyPanelDeletedInfo historyPanelActionInfo\">deleted</span> by <span class=\"historyPanelUserInfo\">' + options.user + '</span></span>');\n        } else {\n            let action = options.action == \"undelete\" ? \"restore\" : options.action;\n            versionInfo = $('<span class=\"history-header\">Version <span class=\"historyPanelVersionInfo\">' + options.version + '</span> - <span class=\"historyPanelActionInfo\">' + action + '</span> by <span class=\"historyPanelUserInfo\">' + options.user + '</span></span>');\n        }\n        var tags = $(\"<span class='taglist'>\");\n        var tag_labels: string[] = [];\n        if (options.tags) {\n            $.each(options.tags, function (_idx, et) {\n                tag_labels.push(\"[\" + et.label + \"]\");\n            });\n            tags.html(tag_labels.join(', '));\n        }\n        var rollback = $('<a class=\"history-header history-restore\">' + 'restore' + '</a>').click(function (event: JQueryEventObject) {\n            event.stopPropagation();\n            var version: number;\n            if (options.deletedItems) {\n                $(event.delegateTarget).parent().parent().parent().parent().parent().hide();\n            } else {\n                version = options.version;\n            }\n            app.restoreItemAsync(options.id, options.title, version).done(function (result) {\n                if (result) {\n\n                    if (options.deletedItems) {\n                        var parent = result.response.newParent;\n                        NavigationPanel.openFolder(parent, true);\n                    } else {\n                        app.dlgForm.dialog(\"close\");\n                    }\n                    MR1.triggerAfterRestore(options.id);\n                }\n            });\n            return false;\n        });\n        var compare = $('<a class=\"hideCopy history-header history-restore activityViewChanges\">' + 'view changes' + '</a>').click(function (event: JQueryEventObject) {\n            event.stopPropagation();\n\n            var ht = new HistoryTools();\n            ht.compare($(event.delegateTarget).data(\"fullVersion\"));\n            return false;\n        }).data(\"fullVersion\", options.fullVersion);\n        var tag = $('<a class=\"hideCopy history-header history-restore activityTag\">' + 'tag version' + '</a>').click(function (event: JQueryEventObject) {\n            event.stopPropagation();\n            var auditId = $(event.delegateTarget).data(\"auditId\");\n            that.createTag(auditId, (label: string) => {\n                tag_labels.push(\"[\" + label + \"]\");\n                tags.html(tag_labels.join(', '));\n                ml.UI.showSuccess(\"Tag has been created\");\n            });\n            return false;\n        }).data(\"auditId\", options.auditId);\n\n        var deletedAtDate = \"\";\n        if (options.deletedate) {\n            deletedAtDate = '<div style=\"color: darkgray;\"><div class=\"fal fa-trash-alt\" /> ' + options.deletedate + '</div>';\n        }\n        var date = that.createDateInfo(options.date, deletedAtDate);\n        var header = $('<span name=\"collapseOne' + this.panelIdCounter + '\"></span>');\n\n        var comment = that.createCommentInfo(options.comment);\n\n        header.append(icon);\n        header.append(itemDisp);\n        header.append(\"<span class='hideScreen'>&nbsp;</span>\");\n        header.append(versionInfo);\n\n        var tools = $(\"<div class='hideCopy pull-right'>\");\n        date.append(tools);\n\n        if (options.action === \"edit\" || options.action === \"reviewed\") {\n            if (!options.id || !ml.Item.parseRef(options.id).isFolder) {\n                tools.append(compare);\n            }\n        }\n\n        if (options.allowRestore && matrixSession.isEditor()) {\n            tools.append(rollback);\n        }\n\n        if (options.auditId) {\n            tools.append(tag);\n            tools.append(tags);\n        }\n\n        header.append(date);\n        var panel = $('<div class=\"panel panel-default\">' +\n            '    <div class=\"panel-heading history-panel\">' +\n            '    </div>' +\n            '    <div name=\"collapseOne' + this.panelIdCounter + '\" class=\"hideCopy panel-collapse collapse\">' +\n            '      <div class=\"panel-body\"></div>' +\n            '    </div>' +\n            '  </div>');\n\n        if (ir.isFolder && options.action !== \"touch\") {\n            icon.css(\"color\", \"transparent\");\n        } else {\n            panel.css(\"cursor\", \"pointer\");\n        }\n\n        let toggleOptions: IAccordionToggleOptions = {\n            ctrl: options.ctrl,\n            id: options.id,\n            version: options.version,\n            panelId: this.panelIdCounter,\n            auditId: options.auditId,\n            action: options.action\n        };\n\n        $(\".panel-heading\", panel).append(header).append(comment).click(() => this.toggle(toggleOptions));\n        if (tags.html()) {\n            $(\".panel-heading\", panel).append($(\"<span class='hideScreen'><i>Tags: </i></span>\").append(tags.html()));\n        }\n        panel.append(\"<div class='hideScreen'>&nbsp;</div>\");\n        return panel;\n    }\n\n    private createDateInfo(date: string, deletedAtDate: string) {\n        return $('<span class=\"pull-right\" style=\"text-align:right;\"><div><span class=\"hideScreen\"><i>Change Date: </i></span>' + date + '</div>' + (deletedAtDate ? deletedAtDate : \"\") + '</span>');\n    }\n    private createCommentInfo(comment: string) {\n        return $(\"<div class='historyComment'>\").html(\"<span class='hideScreen'><i>Comment: </i></span>\" + comment).highlightReferences();\n    }\n\n    private createTag(auditId: string, update: (label: string) => void) {\n        const okButtonSelector = \"div.ui-dialog[aria-describedby=newTagDialog] > .ui-dialog-buttonpane > .ui-dialog-buttonset > .btnDoIt\";\n        async function tagStatusChange() {\n            var okButton = $(okButtonSelector);\n            if (await tagLabel.getController().getValueAsync() !== \"\" && await tagLabel.getController().getValueAsync() !== \"\") {\n                okButton.prop(\"disabled\", false);\n                okButton.removeClass(\"ui-state-disabled\");\n            } else {\n                okButton.prop(\"disabled\", true);\n                okButton.addClass(\"ui-state-disabled\");\n            }\n        }\n\n        let newTagDlg = $(\"<div id='newTagDialog'>\").appendTo(\"body\");\n        let newTagContent = $(\"<div>\");\n\n        var tagLabel = $(\"<div id='tagLabel'>\").plainText({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help: \"Tag Name\",\n            fieldValue: \"\",\n            valueChanged: function () {\n                tagStatusChange();\n            },\n            parameter: {\n                rows: 1\n            }\n        });\n        newTagContent.append(tagLabel);\n        var tagComment = $(\"<div id='tagComment'>\").plainText({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help: \"Tag Comment\",\n            fieldValue: matrixSession.getComment(),\n            valueChanged: function () {\n                tagStatusChange();\n            },\n            parameter: {\n                allowResize: false,\n                rows: 9,\n            }\n        });\n        newTagContent.append(tagComment);\n\n        ml.UI.showDialog(newTagDlg, \"Create Tag\", newTagContent, -730, -400, [{\n            text: 'Ok',\n            class: 'btnDoIt',\n            click: async function () {\n                restConnection.postProject(\"tag\", {\n                    label: await tagLabel.getController().getValueAsync(),\n                    auditId: auditId,\n                    comments: await tagComment.getController().getValueAsync(),\n                    type: \"tag\"\n                }).done(async function () {\n                    update(await tagLabel.getController().getValueAsync());\n                }).fail(function (jqxhr, textStatus, error) {\n                    if (jqxhr && jqxhr.responseText && jqxhr.responseText.indexOf(\"This tag already exists for this project\") !== -1) {\n                        ml.UI.showError(\"Could not create tag\", \"A tag with this label already exist\");\n                    } else {\n                        ml.UI.showError(\"Could not create tag\", \"Status:\" + textStatus + \". Error was:\" + error);\n                    }\n                });\n                newTagDlg.dialog(\"close\");\n            }\n        }, {\n            text: 'Cancel',\n            class: 'btnCancelIt',\n            click: function () {\n                newTagDlg.dialog(\"close\");\n            }\n            }], UIToolsConstants.Scroll.None, false, false, () => {\n            //close\n            newTagDlg.remove();\n        }, () => {\n            // open\n            tagStatusChange();\n        });\n    }\n    private createReportLine(options: IReportLine): JQuery {\n        let that = this;\n\n        //  id: item.id,\n        //        title: item.title,\n        //        version: item.version,\n        //         user: item.user,\n        //        date: item.date\n        //        job:number or empty in case the report has been removed\n\n        var icon = $('<span class=\"fal fa-list-alt downloadFile\"></span>');\n        var downloadText = $(\"\");\n        // if job is 1 week or less show download button / otherwise the file will be gone\n        if (options.job && options.dateServer && (new Date().getTime() - new Date(options.dateServer).getTime() < 7 * 24 * 60 * 60 * 1000)) {\n            icon.css(\"cursor\", \"pointer\").click(function () {\n\n            }).tooltip({\n                title: \"document creation\",\n                placement: 'bottom'\n            });\n            downloadText = $('<span class=\"hideCopy history-header history-restore pull-right downloadFile\">&nbsp;<a href=\"javascript:void(0)\">download</a></span>').click(function () {\n                that.downloadReport(options.job);\n            });\n        } else {\n            icon.css(\"cursor\", \"pointer\").tooltip({\n                title: \"document creation\",\n                placement: 'bottom'\n            });\n        }\n\n        var itemDisp = $('<span class=\"history-header key-' + options.id + '\"><b>' + options.id + '</b> ' + options.title + '</span>');\n        var versionInfo = $('<span class=\"history-header\"><span class=\"hideScreen\">&nbsp;</span>(Version ' + options.version + ') - was <span class=\"historyPanelActionInfo\">produced</span> by ' + options.user + '</span>');\n        var date = that.createDateInfo(options.date, null);\n        var extraline = $(\"<div class='historyComment'>\").html(\"&nbsp;\");\n\n        var tools = $(\"<div class='hideCopy' >\");\n        date.append(tools);\n        tools.append(downloadText);\n\n        var panel = $('<div class=\"panel panel-default\">' +\n            '    <div class=\"panel-heading-report panel-heading history-panel\">' +\n            '    </div>' +\n            '  </div>');\n        $(\".panel-heading\", panel).append(icon).append(itemDisp).append(versionInfo).append(date).append(extraline);\n        return panel;\n    }\n\n    private createExecuteLine(options: IExecuteLine): JQuery {\n        //  id: item.id,\n        //        title: item.title,\n        //        version: item.version,\n        //         user: item.user,\n        //        date: item.date\n        //        job:number or empty in case the report has been removed\n\n        var icon = $('<span class=\"fal fa-exchange\"></span>');\n\n\n        var itemDisp = $('<span class=\"history-header key-' + options.id + '\"><b>' + options.id + '</b> ' + options.title + '</span>');\n        var versionInfo = $('<span class=\"history-header\"><span class=\"historyPanelUserInfo\">' + options.user + '</span> <span class=\"historyPanelActionInfo\">created test forms</span></span>');\n        var date = this.createDateInfo(options.date, null);\n        var extraline = $(\"<div class='historyComment'>\").html(\"&nbsp;\");\n\n        var panel = $('<div class=\"panel panel-default\">' +\n            '    <div class=\"panel-heading-report panel-heading history-panel\">' +\n            '    </div>' +\n            '  </div>');\n        $(\".panel-heading\", panel).append(icon).append(itemDisp).append(versionInfo).append(date).append(extraline);\n        return panel;\n    }\n\n    private createReferenceLine(options: IReferenceUpdate): JQuery {\n\n        var icon = options.added ? $('<span class=\"fal fa-link\">') : $('<span class=\"fal fa-unlink\">');\n        var action = options.added ? \"Added\" : \"Deleted\";\n        var itemDisp = $('<span class=\"history-header key-' + options.fromId + '\"><b>' + options.fromId + '</b> ' + action + ' link to <b>' + options.toId + '</b></span>');\n        var versionInfo = $('<span class=\"history-header\"><span class=\"hideScreen\">&nbsp;</span>- by ' + options.user + '</span></span>');\n        var date = this.createDateInfo(options.dateUserFormat, null);\n        var extraline = this.createCommentInfo(options.comment);\n\n        var panel = $('<div class=\"panel panel-default\">' +\n            '    <div class=\"panel-heading-report panel-heading history-panel\">' +\n            '    </div>' +\n            '  </div>');\n        $(\".panel-heading\", panel).append(icon).append(itemDisp).append(versionInfo).append(date).append(extraline);\n        panel.append(\"<div class='hideScreen'>&nbsp;</div>\");\n        return panel;\n    }\n\n    private createSignLine(options: ISignLine): JQuery {\n        //  id: item.id,\n        //        title: item.title,\n        //        version: item.version,\n        //         user: item.user,\n        //        date: item.date\n        //        job:number or empty in case the report has been removed\n\n        var icon = $('<span class=\"fal fa-pencil\"></span>');\n\n        var itemDisp = $('<span class=\"history-header key-' + options.id + '\"><b>' + options.id + '</b> ' + options.title + '</span>');\n        var versionInfo = $('<span class=\"history-header\"><span class=\"hideScreen\">&nbsp;</span>- was <span class=\"historyPanelActionInfo\">' + (typeof options.reason != 'undefined' ? options.reason : \"signed\") + '</span></span>');\n\n        var date = this.createDateInfo(options.date, null);\n        var extraline = $(\"<div class='historyComment'>\").html(\"&nbsp;\");\n\n        var panel = $('<div class=\"panel panel-default\">' +\n            '    <div class=\"panel-heading-report panel-heading history-panel\">' +\n            '    </div>' +\n            '  </div>');\n        $(\".panel-heading\", panel).append(icon).append(itemDisp).append(versionInfo).append(date).append(extraline);\n        return panel;\n    }\n\n    private createMergeLine(options: IMergeLine): JQuery {\n        //        user: item.user,\n        //        date: item.date\n        //        job:number or empty in case the report has been removed\n\n\n        this.panelIdCounter++;\n        let icon = $('<span style=\"cursor:pointer\" class=\"fal fa-code-merge\"></span>');\n\n        let itemDisp = $('<span class=\"history-header\"><b>' + 'MERGE' + '</b></span>');\n        let versionInfo = $('<span class=\"history-header\"><span class=\"hideScreen\">&nbsp;</span>- by ' + options.user + '</span></span>');\n\n        let date = this.createDateInfo(options.date, null);\n        let header = $('<span name=\"collapseOne' + this.panelIdCounter + '\"></span>');\n        let comment = this.createCommentInfo(options.comment);\n\n        header.append(icon);\n        header.append(itemDisp);\n        header.append(versionInfo);\n\n        let tools = $(\"<div class='hideCopy pull-right'>\");\n        let tags = $(\"<span class='taglist'>\");\n        let tag_labels: string[] = [];\n        if (options.tags) {\n            $.each(options.tags, function (_idx, et) {\n                tag_labels.push(\"[\" + et.label + \"]\");\n            });\n            tags.html(tag_labels.join(', '));\n        }\n        date.append(tools.append(tags));\n        header.append(date);\n\n        var panel = $('<div class=\"panel panel-default\">' +\n        '    <div class=\"panel-heading history-panel\">' +\n        '    </div>' +\n        '    <div name=\"collapseOne' + this.panelIdCounter + '\" class=\"hideCopy panel-collapse collapse\">' +\n        '      <div class=\"panel-body\"></div>' +\n        '    </div>' +\n        '  </div>');\n\n        panel.css(\"cursor\", \"pointer\");\n\n        let toggleOptions: IAccordionToggleOptions = {\n            ctrl: options.ctrl,\n            id: null,\n            version: null,\n            panelId: this.panelIdCounter,\n            auditId: options.auditId,\n            action: options.action\n        };\n        $(\".panel-heading\", panel).append(header).append(comment).click(() => this.toggle(toggleOptions));\n        return panel;\n    }\n    private downloadReport(jobNumber: number): void {\n        app.getReportDetails(jobNumber).done(function (progress) {\n            app.download(jobNumber, progress.jobFile[progress.jobFile.length - 1].jobFileId);\n        });\n    }\n\n\n    private async toggle(options: IAccordionToggleOptions) {\n        let that = this;\n\n        if (options.action !== \"merge\") {\n            let ir = ml.Item.parseRef(options.id);\n            if (ir.isFolder && options.action !== \"touch\") {\n                // there is no history of folders...\n                return;\n            }\n        }\n        var tag = \"collapseOne\" + options.panelId;\n        var panelHeader = $(\"span[name='\" + tag + \"']\", options.ctrl);\n        $(\".fa-chevron-right\", panelHeader).removeClass(\"fa-chevron-right\").addClass(\"fa-chevron-up\");\n        $(\".fa-chevron-down\", panelHeader).removeClass(\"fa-chevron-down\").addClass(\"fa-chevron-right\");\n        $(\".fa-chevron-up\", panelHeader).removeClass(\"fa-chevron-up\").addClass(\"fa-chevron-down\");\n        var panel = $(\"div[name='\" + tag + \"']\", options.ctrl);\n        var panelBody = $(\".panel-body\", panel);\n        if (panelBody.html() === \"\") {\n            switch (options.action) {\n                case \"touch\":\n                    app.getAuditDetailsAsync(options.auditId).done(function (audit: XRTrimAudit) {\n                        panelBody.append(\"<p>The following items have been touched:</p>\");\n                        let actionDetails = $(\"<ul>\");\n                        $.each(audit.techAudit, function (_idx, ta) {\n                            if (ta.operation === \"add\" && ta.table === \"item_instance\" && ta.ref) {\n                                actionDetails.prepend($(\"<li>\").append(ml.Item.renderLink(ta.ref)));\n                            }\n                        });\n                        panelBody.append(actionDetails);\n                    });\n                    break;\n                case \"merge\":\n                    app.getAuditDetailsAsync(options.auditId).done(function (audit: XRTrimAudit) {\n                        let mergeMain = audit.techAudit.filter(ta => ta.table == \"merge_main\");\n                        if (mergeMain.length) {\n                            let mergeId = mergeMain[0].index;\n                            restConnection.getProject(\"mergehistory\").done((history: XRMergeHistory) => {\n                                let details = history.entries.filter(his => his.id == mergeId);\n                                if (details.length) {\n                                    let isMerge = matrixSession.getBranches(matrixSession.getProject(), \"\").map(info => info.branch).lastIndexOf(details[0].branchProject) != -1;\n                                    if (isMerge) {\n                                        panelBody.append(`<p>Merge back from branch: ${details[0].branchProject}</p>`);\n                                    } else {\n                                        panelBody.append(`<p>Updated from mainline: ${details[0].branchProject}</p>`);\n                                    }\n                                    let ul = $(\"<ul>\").appendTo(panelBody);\n                                    for (let detail of details[0].details) {\n                                        BranchingHelper.addMergeDetail(ul, detail, null, isMerge);\n                                    }\n                                } else {\n\n                                    // ignore operation: \"add\" , table \"item_link\"\n                                    panelBody.append(`<p>Merge back from a deleted or not accessible branch. The following has been modified:</p>`);\n                                    let ul = $(\"<ul>\").appendTo(panelBody);\n                                    let links = false;\n                                    let items: string[] = [];\n                                    for (let change of audit.techAudit) {\n                                        if (change.table == \"item_link\") {\n                                            links = true;\n                                        } else if (!change.ref || items.indexOf(change.ref) != -1) {\n                                            // already registered\n                                        } else {\n                                            if (change.table == \"item_instance\") {\n                                                if (change.operation == \"add\") {\n                                                    items.push(change.ref);\n                                                } else if (change.operation == \"invalidate\") {\n                                                    items.push(change.ref);\n                                                }\n                                                if (change.operation == \"moved\") {\n                                                    items.push(change.ref);\n                                                }\n                                            }\n                                        }\n                                    }\n                                    for (let item of items) {\n                                        ul.append($(`<li>Item created/update/moved/deleted: ${item}</li>`));\n                                    }\n                                    if (links) {\n                                        ul.append($(`<li>Links have been modified</li>`));\n                                    }\n                                }\n                                panelBody.highlightReferences();\n                            });\n                        }\n                    });\n                    break;\n                default:\n                    app.getItemAsync(options.id, options.version).done(async function (data) {\n                        let render = new ItemControl({\n                            control: panelBody,\n                            controlState: ControlState.HistoryView,\n                            isHistory: options.version,\n                            item: data,\n                            isItem: !data.children\n                        });\n                        await render.load();\n                        that.controls.push(render);\n                    });\n\n                    break;\n            }\n        }\n\n        panel.collapse('toggle');\n        app.dlgForm.resizeDlgContent(this.controls);\n    }\n\n    updateVersionPanes(): void {\n        let that = this;\n\n        // get all visible version panes\n        var visiblePanes = $(\".versionpane:visible .panel-body-v-scroll\");\n\n        // nothing is displayed\n        if (visiblePanes.length < 1) {\n            return;\n        }\n\n        // only one version is displayed: show without change markup\n        if (visiblePanes.length == 1) {\n            const shadows = JSON.parse($(visiblePanes[0]).parent().data(\"shadowRoots\"));\n            $(visiblePanes[0]).html($(visiblePanes[0]).parent().data(\"originalHTML\"));\n            visiblePanes[0].querySelectorAll(\".shadow-root\").forEach(element => {\n                const shadowRoot = element.attachShadow({mode: \"open\"});\n                shadowRoot.innerHTML = shadows[element.id];\n            });\n            matrixApplicationUI.lastMainItemForm.resizeIt(true);\n            that.updateRowHeights($(\".slickTable\", $(visiblePanes[0])));\n            return;\n        }\n\n        // build data to send to compare function\n        let versions: string[] = [];\n        $.each(visiblePanes, function (_idx, visiblePane) {\n            let rendered = $(\"<div>\").html($(visiblePane).parent().data(\"originalHTML\"));\n            $(\"textarea,pre\", rendered).each(function (idx, select) {\n                $(select).replaceWith(\"<div>\" + $(select).html().replace(/(?:\\r\\n|\\r|\\n)/g, \"<br>\") + \"</div>\");\n            });\n            $(\".fal.fa-square\", rendered).each((idx, elem) => {\n                $(elem).parent().addClass(\"history-unchecked\");\n            });\n            $(\".fal.fa-square-square\", rendered).each((idx, elem) => {\n                $(elem).parent().addClass(\"history-checked\");\n            });\n            const shadows = JSON.parse($(visiblePane).parent().data(\"shadowRoots\"));\n            rendered[0].querySelectorAll(\".shadow-root\").forEach(element => {\n                element.innerHTML = HistoryTools.compare_css + shadows[element.id];\n            });\n            versions.push(rendered.html());\n        });\n\n        let split = this.splitVersions( versions );\n        let compareParams: XCPostCompareHtml = {\n            arg: JSON.stringify(split?{versionsMultiple:split}:{ versions: versions })\n        }\n        // call compare\n        app.compareHTML(compareParams).done(function (compareResults) {\n            $.each(visiblePanes, function (idx, visibleVersionPane) {\n                if (split) {\n\n                    let compare = `<div class='dialog-body'>`;\n                    for (let assemble =0; assemble<compareResults.htmlMultiple.length; assemble++ ) {\n                        compare += compareResults.htmlMultiple[assemble][idx].replace(/pull-left/g,\"\");\n                    }\n                    compare += `</div>`;\n                    $(visibleVersionPane).parent().data(\"compareHTML\", compare);\n                } else {\n                    $(visibleVersionPane).parent().data(\"compareHTML\", compareResults.html[idx]);\n                }\n\n            });\n            that.renderVersionPanes();\n            // make sure hyperlinks open in new view\n            $(\".itemTitle>a\", visiblePanes).attr(\"target\", \"_blank\");\n        });\n    }\n\n    public splitVersions( versions:string[] ):string[][] {\n        let split:string[][]=[];\n\n        let parts = 0;\n        // split each of html blobs\n        for (let version of versions) {\n            let oneSplit: string[] = [];\n            split.push( oneSplit );\n            let all = $(version);\n            for ( let child of all.children().toArray() ) {\n                oneSplit.push( child.outerHTML );\n            }\n            if (parts && oneSplit.length != parts) {\n                // items not well aligned -> don't compare section by section\n                return null;\n            }\n            parts = oneSplit.length;\n        }\n        // transpose the array\n        let splitTranspose:string[][]=[];\n\n        for ( let part = 0; part<parts; part ++) {\n            splitTranspose.push( [] );\n            for (let doc = 0; doc<versions.length; doc++) {\n                splitTranspose[part].push( split[doc][part] );\n            }\n        }\n\n        return splitTranspose;\n    }\n    private updateRowHeights(table: JQuery) {\n        // calculate real rendered heights of cells and adjust heights accordingly\n        let rows = $(\".slick-row\", table);\n        if (rows.length < 1) return; // nothing to update\n\n        var cellSizer = $(\"<div style='padding:0px 4px 0px 4px'>\");\n        $(\"body\").append(cellSizer.css(\"left\", \"-20000px\"));\n        let top = 0;\n        $.each(rows, function (_ridx, row) {\n            let columns = $(\".slick-cell\", $(row));\n            let height = Math.max(20, $(row).height());\n            $.each(columns, function (_cidx, col) {\n                //if ( $(\".multiLineFormatter\"),$(col) ||  $(\".itemRefFormatter\"),$(col) ) {\n                cellSizer.width(Math.max(10, $(col).width() - 10));\n                cellSizer.html($(col).html());\n                height = Math.max(height, cellSizer.height());\n                $(col).css(\"padding-top\", \"0\").css(\"padding-bottom\", \"0\");\n                //}\n                $(col).css(\"height\", \"100%\");\n            });\n            $(row).height(height);\n            $(row).css(\"top\", top + \"px\");\n            top += height;\n        });\n        cellSizer.remove();\n        table.height(top + 27); // where does that number come from?\n        $(\".slick-viewport\", table).css(\"height\", \"100%\");\n    }\n\n    private renderVersionPanes(): void {\n        let that = this;\n\n        let visiblePanes = $(\".versionpane:visible  .panel-body-v-scroll\");\n        let titles = $(\".versionpane:visible .itemTitleBarNoToolsNoEdit\");\n\n        // several versions are displayed show each with change markup\n        $.each(visiblePanes, function (_idx, visiblePane) {\n            $(visiblePane).html($(visiblePane).parent().data(\"compareHTML\"));\n            visiblePane.querySelectorAll(\".shadow-root\").forEach(element => {\n                const content = element.innerHTML;\n                element.innerHTML = \"\";\n                const shadow = element.attachShadow({mode: \"open\"});\n                shadow.innerHTML = content;\n            });\n            $.each($(\".slickTable\", $(visiblePane)), function (_tableIdx, table) {\n                that.updateRowHeights($(table));\n            });\n        });\n\n        let visibleBodies = $(\".versionpane:visible  .dialog-body\");\n        var count = $(visibleBodies[0]).children().length;\n        // just a safety check if number of fields changes the code after would be fairly random\n        for (var idx = 1; idx < visibleBodies.length; idx++) {\n            if (count !== $(visibleBodies[idx]).children().length) {\n                return;\n            }\n\n        }\n        // assume.... all 1+ panes have same structure: adjust heights\n        for (var c = 0; c < count; c++) {\n            var mh = 0;\n            for (var idx = 0; idx < visibleBodies.length; idx++) {\n\n                var p = $($(visibleBodies[idx]).children()[c]);\n                p.css(\"height\", \"auto\");\n                mh = Math.max(mh, p.height());\n            }\n            // run from right to left\n            for (var idx = visibleBodies.length - 1; idx >= 0; idx--) {\n                var p = $($(visibleBodies[idx]).children()[c]);\n                //Add 1px of room\n                p.height(mh +1);\n            }\n\n        }\n        // same for version info\n        visibleBodies = $(\".versionpane:visible .versionInfo\");\n        var mh = 0;\n        for (var idx = 0; idx < visibleBodies.length; idx++) {\n\n            var p = $(visibleBodies[idx]);\n            p.css(\"height\", \"auto\");\n            mh = Math.max(mh, p.height());\n        }\n        for (var idx = 0; idx < visibleBodies.length; idx++) {\n            var p = $(visibleBodies[idx]);\n            p.height(mh);\n        }\n\n    }\n\n    async renderItemMeat(hi: JQuery, item: IItem) {\n        let itemForm = new ItemControl({\n            control: hi,\n            controlState: ControlState.HistoryView,\n            isHistory: 1,\n            item: item,\n            isItem: true,\n            parameter: {\n                manualTableHeights: true,\n                reviewMode: true // don't show outdated icons\n            }\n        });\n        await itemForm.load();\n\n        let itemDetails = $(\".panel-body-v-scroll\", hi);\n        itemDetails.css(\"display\", \"flex\");\n        itemDetails.css(\"flex-direction\", \"column\");\n\n        ml.SmartText.prepareForReadReadRender(itemDetails);\n    }\n\n    private async showSaveConflict(dlg: JQuery, latest: IItem, localChanges: IItem) {\n\n        let that = this;\n\n        async function showVersion(hi: JQuery, item: IItem, version: string, userLogin: string) {\n            $(\"#tellToSelect\").hide();\n\n            const userLoginDisplay = that.formatUserLogin(userLogin);\n            var vi = $(\"<div class='versionInfo'>\");\n            var header = $(\"<div class='baseControlHelp'>Version Info</div>\");\n            hi.append(header);\n            hi.append(vi);\n            vi.append(\"<div class=''>Version: <span class='historyDlgVersionDetail'>\" + version + \"</span></div>\");\n            vi.append(\"<div class=''>User: <span class='historyDlgVersionDetail'>\" + userLoginDisplay + \"</span></div>\");\n\n            hi.append(\"<hr>\");\n\n            await that.renderItemMeat(hi, item);\n\n            hi.data(\"status\", \"show\");\n            hi.show();\n        }\n\n        let changeView = $(\"<div>\").appendTo(dlg);\n\n        $(\"<div class='warningMerge'>\").html(`Someone changed and saved the same item (${app.getCurrentItemId()}) while you were editing it. In order not to overwrite these changes:<br>\n        <ul style=\"text-align: left;font-size: smaller;margin-left: 100px;\">\n        <li>open the changed item in another <a href='${ml.Item.parseRef(app.getCurrentItemId()).url}' target='_blank'>tab</a></li>\n        <li>copy the changes you did in this tab</li>\n        <li>close this tab (to be able to edit in the other tab)</li>\n        <li>manually update the item with your changes</li>`).appendTo(changeView);\n\n\n        if (latest.history.length &&\n            latest.history.length > 0) {\n            let flex = $(\"<div style='display:flex;justify-content: center;'>\").appendTo(changeView);\n            var changed = $(\"<div class='versionpane'>\").appendTo(flex);\n            var current = $(\"<div class='versionpane'>\").appendTo(flex);\n\n            // latest.history is organized newest to oldest.\n            await showVersion(changed, latest, \"New Version on Server\", latest.history[0].user);\n            await showVersion(current, localChanges, \"Your Changes\", matrixSession.getUser());\n\n            this.updateVersionPanes();\n        } else {\n            // it's a folder\n        }\n    }\n\n    private compareVersionDialog(item: IItem, history: IItemHistory[], selectBar: boolean, show: number[], allowRestore: boolean) {\n        let that = this;\n\n        var trmy = $(\"<tr id='historyDlgYear' style='background-color: #eee;'>\"); var last_my = \"\"; var span_my = 0;\n        var trday = $(\"<tr id='historyDlgMonth' style='background-color: #eee;'>\"); var last_day = \"\"; var span_day = 0;\n        var trtime = $(\"<tr id='historyDlgTime'>\");\n        var trdetails = $(\"<tr>\");\n        var tddetails = $(\"<td>\").attr(\"colspan\", history.length);\n        trdetails.append(tddetails);\n        var flex = $(\"<div style='display:flex;justify-content: center;'>\");\n        tddetails.append(flex);\n        var format_my = new SimpleDateFormat(\"yyyy MMMM\");\n        var format_day = new SimpleDateFormat(\"d\");\n        var format_time = new SimpleDateFormat(\"HH:mm\");\n        let itemIsDeleted = item.isDeleted;\n\n        let timewarpVersion = -1;\n        if (globalMatrix.ItemConfig.getTimeWarp()) {\n            let treeInfo = app.getItemFromTree(item.id);\n            if (treeInfo.version) {\n                let vp = treeInfo.version.split(\"/\");\n                timewarpVersion = Number(vp[0]);\n                itemIsDeleted = treeInfo.version.indexOf(\"*\") != -1;\n            }\n        }\n        for (var idx = history.length - 1; idx >= 0; idx--) {\n            var date = new Date(history[idx].date);\n            var my = format_my.format(date);\n            var day = format_day.format(date);\n            var time = format_time.format(date);\n            let newMonth = false;\n            if (my !== last_my) {\n                newMonth = true;\n                span_my = 1;\n                trmy.append($(\"<td>\").html(my).css(\"font-weight\", \"bold\").css(\"text-align\", \"center\"));\n                last_my = my;\n            } else {\n                span_my++;\n                $(\"td\", trmy).last().attr(\"colspan\", span_my);\n            }\n            if (day !== last_day || newMonth) {\n\n                span_day = 1;\n                trday.append($(\"<td>\").html(day).css(\"font-weight\", \"bold\").css(\"text-align\", \"center\"));\n                last_day = day;\n            } else {\n                span_day++;\n                $(\"td\", trday).last().attr(\"colspan\", span_day);\n            }\n            let timewarp = history[idx].version == timewarpVersion;\n            let timewarpClass = \"\";\n            if (timewarpVersion != -1) {\n                if (history[idx].version > timewarpVersion) timewarpClass = \" timepwarp_after\";\n                if (history[idx].version == timewarpVersion) timewarpClass = \" timepwarp_day\";\n            }\n            // always show very first and last one and always the last of a day\n            let other_day = idx ==  history.length - 1 || idx == 0 || new Date(history[idx].date).getDate() != new Date(history[idx - 1].date).getDate() || timewarp;\n\n            var time_toggle = $(\"<td class='historyDlgVersionPaneSelector \" + (other_day ? \"last_day\" : \"any_day\") + timewarpClass + \"'>\").html(\"<div>\" + time + \"</div>\" + \"<div>rev&nbsp;\" + history[idx].version + \"</div>\");\n            time_toggle.data(\"rev\", history[idx].version);\n            time_toggle.click(function (event: JQueryEventObject) {\n                let revision = $(event.delegateTarget).data(\"rev\");\n                // update top bar\n                var hi = $(\"#ver\" + revision);\n                $(event.delegateTarget).toggleClass(\"historyDlgVersionPaneSelected\");\n                // update side bar\n                let selected = $(event.delegateTarget).hasClass(\"historyDlgVersionPaneSelected\");\n                $.each($(\".historyDetailLine\"), function (_hrlIdx, hrl) {\n                    if ($(hrl).data(\"rev\") == revision) {\n                        selected ? $(hrl).parent().addClass(\"historyVersionContainerSelected\") : $(hrl).parent().removeClass(\"historyVersionContainerSelected\");\n                    }\n                });\n                // update panes\n                if (hi.data(\"status\") === \"show\") {\n                    hi.hide();\n                    hi.data(\"status\", \"hide\");\n                    that.updateVersionPanes();\n                } else if (hi.data(\"status\") === \"hide\") {\n                    hi.show();\n                    hi.data(\"status\", \"show\");\n                    that.updateVersionPanes();\n                } else {\n                    showVersion(hi, revision);\n                }\n\n                if ($(\".versionpane:visible\").length === 0) {\n                    $(\"#tellToSelect\").show();\n                } else {\n                    $(\"#tellToSelect\").hide();\n                }\n            });\n            trtime.append(time_toggle);\n            var vp = $(\"<div class='versionpane' id='ver\" + history[idx].version + \"'>\");\n            vp.hide();\n            flex.append(vp);\n            if (show.indexOf(history[idx].version) !== - 1) {\n                showVersion(vp, history[idx].version);\n                time_toggle.addClass(\"historyDlgVersionPaneSelected\");\n            }\n        }\n\n        if (itemIsDeleted) {\n            trmy.append($(\"<td rowspan='4' style='vertical-align: middle;border: 1px solid #ddd;'>\").html(\"<span style='color:red'>item deleted</span>\"));\n        }\n        if (!show || show.length === 0) {\n            flex.append(\"<div id='tellToSelect'>select revisions to be shown / compared</div>\");\n        }\n\n        function showVersion(hi: JQuery, r: number) {\n            $(\"#tellToSelect\").hide();\n            var h = history[history.length - r];\n            var vi = $(\"<div class='versionInfo'>\");\n            var header = $(\"<div class='baseControlHelp'>Version Info</div>\");\n            hi.append(header);\n            hi.append(vi);\n            vi.append(\"<div class=''>Version: <span class='historyDlgVersionDetail'>\" + h.version + \"</span></div>\");\n            if (h.action == \"signature\") {\n                vi.append(\"<div class=''>Action: <span class='historyDlgVersionDetail'>\" + h.comment + \"</span>\" + \"</div>\");\n            } else {\n                let restoreInfo = \"\";\n                if ( h.deletedate ) {\n                    restoreInfo = (h.deletedate == h.dateUserFormat)?\" (rolled back to previous version)\":` (was deleted on ${h.deletedate}) `;\n                }\n                vi.append(\"<div class=''>Action: <span class='historyDlgVersionDetail'>\" + h.action + \"</span>\" + restoreInfo + \"</div>\");\n                var comment = $(\"<div class='' style='white-space: pre-wrap'>Comment: <span class='historyDlgVersionDetail'>\" + h.comment + \"</span></div>\");\n                comment.highlightReferences();\n                vi.append(comment);\n                const userLoginDisplay = that.formatUserLogin(h.user);\n                vi.append(\"<div class=''>User: <span class='historyDlgVersionDetail'>\" + userLoginDisplay + \"</span></div>\");\n            }\n            vi.append(\"<div class='' style='margin-bottom:4px'>Date: <span class='historyDlgVersionDetail'>\" + h.dateUserFormat + \"</span></div>\");\n            hi.append(\"<hr>\");\n            app.getItemAsync(h.id, (r === history.length && !itemIsDeleted && !globalMatrix.ItemConfig.getTimeWarp()) ? undefined : r).done(async function (data: IItem) {\n                let itemForm = new ItemControl({\n                    control: hi,\n                    controlState: ControlState.HistoryView,\n                    isHistory: r,\n                    item: data,\n                    isItem: !data.children,\n                    parameter: {\n                        manualTableHeights: true,\n                        reviewMode: true // don't show outdated icons\n                    }\n                });\n\n                await itemForm.load();\n                let itemDetails = $(\".panel-body-v-scroll\", hi);\n\n                ml.SmartText.prepareForReadReadRender(itemDetails);\n\n                that.updateVersionPanes();\n            });\n\n            var rollback = $('<a class=\"history-header history-restore\">' + 'restore' + '</a>').click(function (event: JQueryEventObject) {\n                if (event.preventDefault)\n                    event.preventDefault();\n                if (event.stopPropagation)\n                    event.stopPropagation();\n\n                var r = $(event.delegateTarget).data(\"ver\");\n                var h = history[history.length - r];\n                app.restoreItemAsync(h.id, h.title, r).done(function (result) {\n                    if (result) {\n                        MR1.triggerAfterRestore(h.id);\n                        app.dlgForm.dialog(\"close\");\n                    }\n                });\n                return false;\n            }).data(\"ver\", r);\n            if (r !== history.length && matrixSession.isEditor() && allowRestore) {\n                header.append(rollback);\n            }\n\n            hi.data(\"status\", \"show\");\n            hi.show();\n        }\n\n        var selectTable = $(\"<table class='table table-bordered' style='width:100%;border:none'>\");\n        var tbody = $(\"<tbody>\");\n        selectTable.append(tbody);\n\n        tbody.append(trmy);\n        tbody.append(trday);\n        tbody.append(trtime);\n        tbody.append(trdetails);\n\n        if (selectBar) {\n            return selectTable;\n        } else {\n            return flex;\n        }\n    }\n\n    // check if item is either not specified or as expected\n    private checkItemId( xr:XRTrimNeedleItem, itemId:string) {\n        if (!xr) return true;\n        if (!xr.itemOrFolderRef) return true;\n        return itemId == ml.Item.parseRef(xr.itemOrFolderRef).id;\n    }\n\n    private formatUserLogin(userLogin: string): string {\n        return globalMatrix.ItemConfig.hasUserInfo(userLogin) ? userLogin : `<s>${userLogin}</s>`;\n    }\n\n    private formatUserName(userLogin: string, userName: string): string {\n        return globalMatrix.ItemConfig.hasUserInfo(userLogin) ? userName : `<s>${userName}</s>`;\n    }\n\n    private showHistoryDetails(itemId: string, simpleHistory:IItemHistory[], historyUnfiltered: XRGetProject_ProjectAudit_TrimAuditList, tags: XRGetProject_Tags_TagList) {\n        let that = this;\n\n        let inner = $(\"<div class='detailsHistoryContainer'>\")\n            .appendTo($(\"#detailsHistory\"));\n\n        const printAction: { [key: string]: [string, string] } = {\n            \"edit item\": [\"modified\", \"fa-pencil\"],\n            \"reviewed item\": [\"reviewed\", \"fa-check\"],\n            \"touch items\": [\"touched\", \"fa-hand-point-up\"],\n            \"undelete item\": [\"restored\", \"fa-trash-restore\"],\n            \"delete item\": [\"deleted\", \"fa-trash\"],\n            \"add item\": [\"created\", \"fa-plus\"],\n            \"execute tests\": [\" created test form\", \"fa-cogs\"],\n            \"add link\": [\"add link\", \"fa-link\"],\n            \"merge merge\": [\"merged\", \"fa-code-merge\"],\n            \"clone project\": [\"project copy\", \"fa-copy\"],\n            \"import_module item\": [\"import\", \"fa-external-link\"],\n            \"delete import\": [\"delete import\", \"fa-trash\"]\n        };\n\n        // MATRIX-4704 filter history: there's some entries which belong to other items, get rid of those\n        let audit = historyUnfiltered.audit.filter( historyEntry => that.checkItemId(historyEntry.itemBefore,itemId) && that.checkItemId(historyEntry.itemAfter,itemId) );\n\n        let version = 1;\n        let preVersion = 0;\n        let line = null;\n        let auditIdx = audit.length - 1;\n        let tagIdx = 0;\n        if (tags.length && tags[0].label == \"base\") tags[0].label = \"Project creation\";\n\n        tags.sort(function (a, b) {\n            return a.auditId - b.auditId;\n        });\n        let begin:JQuery;\n\n        let lastSelectionBucket:JQuery = null;\n        while (auditIdx >= 0 || tagIdx < tags.length) {\n\n            if (auditIdx < 0 || (tagIdx < tags.length && tags[tagIdx].auditId < audit[auditIdx].auditId)) {\n                let tag = $(`\n                    <div class='historyTagLine' title='Tagged time: ${tags[tagIdx].auditTime}'>\n                        <div class=\"tagLabel\"><span>${tags[tagIdx].label}</span></div>\n                        <div class=\"historyIcon historyTagIcon\"><i class=\"fal fa-tag\"></i></div>\n                    </div>\n                `).prependTo(inner);\n                if ( tags[tagIdx].label.match(/^MERGE_.*_begin$/) ) {\n                    begin = tag;\n                } else if ( begin &&  tags[tagIdx].label.match(/^MERGE_.*_end$/)) {\n                    $(\".tagLabel\", begin).html(`<span>${tags[tagIdx].label.replace(\"_end\",\"_begin_end\")}</span>`);\n                    tag.remove();\n                }\n                tagIdx++;\n            } else {\n                begin = null;\n                let historyEntry = audit[auditIdx];\n                let icon = \"\";\n                let negateIcon = false;\n                let createdSign = \"\";\n                let actionName = \"\";\n                let detail = null;\n                if ( ml.Item.parseRef(itemId).type != \"XTC\" && historyEntry.action == \"execute\") {\n                    // special case (XTC execution does not create a new version but it has the XTC as item after...)\n                } else if (historyEntry.itemAfter && historyEntry.itemAfter.itemOrFolderRef) {\n                    version = ml.Item.parseRef(historyEntry.itemAfter.itemOrFolderRef).version;\n                    createdSign = (ml.Item.parseRef(historyEntry.itemAfter.itemOrFolderRef).type == \"SIGN\" && ml.Item.parseRef(itemId).type == \"DOC\")?ml.Item.parseRef(historyEntry.itemAfter.itemOrFolderRef).id:\"\";\n                } else {\n                    let explicitVersion = simpleHistory.filter( sh => sh.date == historyEntry.dateTime);\n                    if (explicitVersion.length == 1) {\n                        version = explicitVersion[0].version;\n                    }\n                }\n\n                let ad = historyEntry.action + \" \" + historyEntry.entity;\n                const print = printAction[ad];\n                let hideLine = false;\n                if (createdSign) {\n                    actionName = \"created sign\";\n                    detail = \"Created \" + createdSign;\n                    version = preVersion;\n                } else  if ( historyEntry.action == \"indexer\") {\n                    actionName = \"reindex\";\n                    icon = \"fa-pencil\";\n                    historyEntry.reason = \"Item updated after config change\";\n                } else if ( historyEntry.reason == \"SignReject\") {\n                    actionName = \"rejected signature\";\n                    icon = \"fa-pencil\";\n                    detail = \"rejected document\";\n                    negateIcon = true;\n                    historyEntry.reason = \"\";\n                } else if (print) {\n                    actionName = print[0];\n                    icon = print[1];\n                } else if (ad == \"add item_link\") {\n                    let itemUp = historyEntry.itemUp.itemOrFolderRef;\n                    let itemDown = historyEntry.itemDown.itemOrFolderRef;\n                    icon = \"fa-link\";\n                    if (itemUp == itemId) {\n                        actionName = \"Link down\";\n                        detail = \"link:\" + itemDown;\n                    } else {\n                        actionName = \"Link up\";\n                        detail = \"uplink:\" + itemUp;\n                    }\n                } else if (ad == \"delete item_link\") {\n                    let itemUp = historyEntry.itemUp.itemOrFolderRef;\n                    let itemDown = historyEntry.itemDown.itemOrFolderRef;\n                    icon = \"fa-unlink\";\n                    if (itemUp == itemId) {\n                        detail = \"remove link:\" + itemDown;\n                    } else {\n                        detail = \"remove uplink:\" + itemUp;\n                    }\n                } else if (ad == \"signature item\") {\n                    icon = \"fa-pencil\";\n                    detail = historyEntry.reason;\n                    historyEntry.reason = \"\";\n                } else if (ad == \"move item\") {\n                    icon = \"fa-arrow-right\";\n                    actionName = \"move\";\n                } else if (ad == \"store signed item\") {\n                    hideLine = true;\n                } else if (ad == \"document reject item\") {\n                    detail = \"Rejected Document\";\n                    actionName = ad;\n                    icon = \"fa-pencil\";\n                    negateIcon = true;\n                    // hack remove if server's fixed\n                    if (version == preVersion) version += 1;\n                } else {\n                    actionName = ad;\n                    icon = \"fa-question-circle\";\n                }\n\n                if (actionName == \"restored\") {\n                    detail = \"restored\";\n                }\n\n                if (!hideLine) {\n\n                    const detailLine = detail !== null ? `<b>${detail}${historyEntry.reason?\":\":\"\"}</b> ` : \"\";\n                    const userNameDisplay = this.formatUserName(historyEntry.userLogin,\n                        globalMatrix.ItemConfig.getFullName(historyEntry.userLogin));\n\n                    if (version !== preVersion ) {\n                        lastSelectionBucket = $(`<div class=\"historyVersionContainer\"/>`).prependTo(inner)\n                    } else if (actionName == \"deleted\") {\n                        lastSelectionBucket = $(`<div class=\"historyVersionContainerDeleted\"/>`).prependTo(inner)\n                    }\n\n                    let negate = \"<i class='fal fa-slash' style='position: absolute;left: 10px;'></i>\";\n\n                    line = $(`\n                        <div class='historyDetailLine'>\n                            <div class=\"historyIcon\" title=\"${actionName}\"><i class=\"fal ${icon}\"></i>${negateIcon?negate:\"\"}</div>\n                            <div class=\"historyDetail\">\n                                <span class='historyDetailAction'>${detailLine}${historyEntry.reason}</span>\n                                <div class='historyDetailDate'>\n                                    <span>${historyEntry.dateTimeUserFormat}</span>\n                                    <span>${userNameDisplay}</span>\n                                </div>\n                            </div>\n                        </div>\n                    `).prependTo(lastSelectionBucket).data(\"rev\", actionName==\"deleted\"?-1:version);\n\n\n                    if (version !== preVersion) {\n                        line.append($(`\n                            <span class=\"historyTagContainer\">\n                                <a class=\"historyTag\" title=\"Create Tag\" data-auditid=\"${historyEntry.auditId}\">\n                                    <div class=\"addLabelImage\"></div>\n                                </a>\n                            </span>\n                        `));\n                    } else {\n                        line.append($(`<span class=\"historyTagContainer\">`));\n                    }\n                }\n\n                preVersion = version;\n                auditIdx--;\n            }\n        }\n\n\n        $('.historyTag').click(function (event: JQueryEventObject) {\n            if (event.preventDefault)\n                event.preventDefault();\n            if (event.stopPropagation)\n                event.stopPropagation();\n\n            let auditId = $(event.delegateTarget).data(\"auditid\");\n            let clickedLine = $(event.delegateTarget).closest(\".historyVersionContainer\");\n            //TODO:[TS] Discuss with Wolfgang, this is messy, should recreate UI from state instead\n            that.createTag(auditId, function (newTag) {\n\n                let line = $(`\n                    <div class='historyTagLine'>\n                        <div class=\"tagLabel\"><span>${newTag}</span></div>\n                        <div class=\"historyIcon historyTagIcon\" title=\"Tagged\"><i class=\"fal fa-tag\"></i></div>\n                    </div>\n                `).insertBefore(clickedLine);\n\n                ml.UI.showSuccess(\"Tag has been created\");\n            });\n            return false;\n        });\n\n        $(\".historyDetailLine\", inner).click(function (event: JQueryMouseEventObject) {\n\n            let clicked = $(event.delegateTarget);\n            let revision = clicked.data(\"rev\");\n            let tab = $('td.historyDlgVersionPaneSelector').filter(function (_idx, node) { return $(node).data(\"rev\") == revision; });\n\n            tab.trigger(\"click\");\n            if (event.preventDefault) event.preventDefault();\n            if (event.stopPropagation) event.stopPropagation();\n        });\n    }\n\n    private showHistoryDialog(options: IShowHistoryDialogOptions) {\n        let that = this;\n\n        app.dlgForm.html(\"\");\n        app.dlgForm.addClass(\"dlg-no-scroll\");\n        app.dlgForm.removeClass(\"dlg-scroll\");\n\n\n        let versions = this.compareVersionDialog(options.item, options.item.history, true, options.preselect ? options.preselect : [], !options.readOnly);\n        let detailsVersion = $(\"<div class='detailsVersions'>\").append(versions)\n        let detailsHistory = $(\"<div id='detailsHistory'>\");\n\n        app.dlgForm.append(detailsHistory).append(detailsVersion);\n\n        if (ml.UI.DateTime.requiresTimeZoneWarning()) {\n            app.dlgForm.append(ml.UI.DateTime.getTimeZoneCTA());\n        }\n\n        // prevent auto scrolling when opening dialog\n        let scrollTop = $(\"#itemDetails > .panel-body-v-scroll\").length?$(\"#itemDetails > .panel-body-v-scroll\")[0].scrollTop:0;\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"History of '\" + (options.id ? options.id : options.item.id) + \"'\",\n            width: $(document).width() * 0.85,\n            height: app.itemForm.height() * 0.85,\n            modal: true,\n            resizeStop: function () {\n                app.dlgForm.resizeDlgContent(that.controls);\n            }, open: function () {\n                ml.UI.pushDialog(app.dlgForm);\n                if (app.dlgForm[0].scrollWidth > app.dlgForm.innerWidth()) {\n                    $(\".any_day > div\").hide();\n\n                    // still bigger? -> scroll right\n                    if (app.dlgForm[0].scrollWidth > app.dlgForm.innerWidth()) {\n                        app.dlgForm[0].scrollLeft = app.dlgForm[0].scrollWidth - app.dlgForm.innerWidth() + 10;\n                    }\n                }\n                that.initHistoryOptionSelect(options.item.history, $('.cbHide'), options.id ? options.id : options.item.id);\n            }, close: function () {\n                if (scrollTop) $(\"#itemDetails > .panel-body-v-scroll\")[0].scrollTop = scrollTop;\n                ml.UI.popDialog(app.dlgForm);\n            },\n            buttons: [{\n                text: 'Hide ',\n                class: 'cbHide',\n                click: function () {\n                }\n            }, {\n                text: 'Ok',\n                class: 'btnOk',\n                click: function () {\n                    app.dlgForm.removeClass(\"dlg-scroll\");\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent(this.controls);\n    };\n\n    private initHistoryOptionSelect(history:IItemHistory[], container: JQuery, itemId: string) {\n        let that = this;\n\n        const optionsHistoryViewSelect = [\"Time Bar\", \"Time Bar Condensed\", \"Full History\"];\n        let currentStr = globalMatrix.serverStorage.getItem(\"HistoryViewSelect\");\n        let current = currentStr ? Number(currentStr) : 0;\n\n\n        let dropup = ml.UI.createDropDownButton(\"\", [{\n            name: optionsHistoryViewSelect[0], click: () => {\n                that.updateHistoryOptionSelect(history, dropup, itemId, 0, optionsHistoryViewSelect[0]);\n            }\n        }, {\n            name: optionsHistoryViewSelect[1], click: () => {\n                that.updateHistoryOptionSelect(history, dropup, itemId, 1, optionsHistoryViewSelect[1]);\n            }\n        }, {\n            name: optionsHistoryViewSelect[2], click: () => {\n                that.updateHistoryOptionSelect(history, dropup, itemId, 2, optionsHistoryViewSelect[2]);\n            }\n        }], true, \"HistoryViewSelect\", true);\n\n        container.replaceWith(dropup);\n\n        that.updateHistoryOptionSelect(history, dropup, itemId, current, optionsHistoryViewSelect[current]);\n    }\n\n    private updateHistoryOptionSelect(simpleHistory:IItemHistory[], dropup: JQuery, itemId: string, option: number, text: string) {\n        let that = this;\n\n        dropup.removeClass(\"open\");\n\n        $(\"#HistoryViewSelect\").html(text);\n        globalMatrix.serverStorage.setItem(\"HistoryViewSelect\", option + \"\");\n\n        switch (option) {\n            case 0:\n                $(\"#historyDlgYear\").show();\n                $(\"#historyDlgMonth\").show();\n                $(\"#historyDlgTime\").show();\n                $(\".any_day > div\").show();\n                $(\"#detailsHistory\").hide();\n                $(\"#detailsHistory\").removeClass('detailsHistoryEx');\n                $(\".detailsVersions\").removeClass('detailsVersionsEx');\n                break;\n            case 1:\n                $(\"#historyDlgYear\").show();\n                $(\"#historyDlgMonth\").show();\n                $(\"#historyDlgTime\").show();\n                $(\"#detailsHistory\").hide();\n                $(\".any_day > div\").hide();\n                $(\"#detailsHistory\").removeClass('detailsHistoryEx');\n                $(\".detailsVersions\").removeClass('detailsVersionsEx');\n                break;\n            default:\n                $(\"#historyDlgYear\").hide();\n                $(\"#historyDlgMonth\").hide();\n                $(\"#historyDlgTime\").hide();\n                $(\"#detailsHistory\").show();\n                $(\"#detailsHistory\").addClass('detailsHistoryEx');\n                $(\".detailsVersions\").addClass('detailsVersionsEx');\n                if ($(\"div\", $(\"#detailsHistory\")).length == 0) {\n                    restConnection.getProject(\"tag\").done(function (tags: XRGetProject_Tags_TagList) {\n                        restConnection.getProject(\"audit?startAt=0&maxResults=1000&itemRef=\" + itemId).done(function (history: XRGetProject_ProjectAudit_TrimAuditList) {\n                            that.showHistoryDetails(itemId, simpleHistory, history, tags);\n\n                            // get the currently shown tabs\n                            let shown:number[] = [];\n                            $.each($(\".historyDlgVersionPaneSelected\"), ( topIdx, top ) => {\n                                shown.push ( $(top).data(\"rev\") );\n                            });\n                            // highlight them in the bar on left\n                            $.each($(\".historyDetailLine\"), function (_hrlIdx, hrl) {\n                                if (shown.indexOf( $(hrl).data(\"rev\") ) !=-1 ) {\n                                    $(hrl).parent().addClass(\"historyVersionContainerSelected\");\n                                }\n                            });\n                        });\n                    });\n                }\n                break;\n        }\n    }\n    private showDiffDialog(latest: IItem, localChanges: IItem) {\n        let that = this;\n\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n        app.dlgForm.addClass(\"dlg-scroll\");\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Item changed\",\n            height: $(window).height() - 40,\n            width: $(window).width() - 40,\n            modal: true,\n            resizeStop: function () {\n                app.dlgForm.resizeDlgContent(that.controls);\n            }, open: function () {\n                ml.UI.pushDialog(app.dlgForm);\n                that.showSaveConflict(app.dlgForm, latest, localChanges);\n\n            }, close: function () { ml.UI.popDialog(app.dlgForm); },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnOk',\n                click: function () {\n                    app.dlgForm.removeClass(\"dlg-scroll\");\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent(this.controls);\n    };\n\n\n\n\n    private showNextActivity(accordion: JQuery, control: JQuery, from: number, count: number, auditIdMin?: number, auditIdMax?: number): JQueryDeferred<string> {\n        let that = this;\n        let d = $.Deferred<string>();\n        app.getActivityAsync(function (item, _first, _last, updatedLink) { // update UI callback\n            $(\".spinningWait\", control).hide();\n            let versionPanel: JQuery;\n            if (item) {\n                if (item.action === 'report') {\n                    versionPanel = that.createReportLine({\n                        id: item.id,\n                        title: item.title,\n                        version: item.version,\n                        user: item.user,\n                        date: item.dateUserFormat,\n                        dateServer: item.date,\n                        job: item.job\n                    });\n                    accordion.append(versionPanel);\n                } else if (item.action === 'execute') {\n                    versionPanel = that.createExecuteLine({\n                        id: item.id,\n                        title: item.title,\n                        version: item.version,\n                        user: item.user,\n                        dateServer: item.date,\n                        date: item.dateUserFormat\n                    });\n                    accordion.append(versionPanel);\n                } else if (item.action === 'signature') {\n                    versionPanel = that.createSignLine({\n                        id: item.id,\n                        title: item.title,\n                        version: item.version,\n                        user: item.user,\n                        dateServer: item.date,\n                        date: item.dateUserFormat,\n                        reason: item.reason\n                    });\n                    accordion.append(versionPanel);\n                } else if (item.action === 'merge') {\n                    versionPanel = that.createMergeLine({\n                        user: item.user,\n                        dateServer: item.date,\n                        date: item.dateUserFormat,\n                        tags:item.tags,\n                        comment:item.comment,\n                        ctrl: control,\n                        auditId: item.auditId,\n                        action: item.action\n                    });\n                    accordion.append(versionPanel);\n                } else {\n                    versionPanel = that.createPanel({\n                        deletedItems: (item.action === 'deleted'),\n                        ctrl: control,\n                        id: item.id,\n                        title: item.title,\n                        isFolder: false,\n                        version: item.version,\n                        user: item.user,\n                        action: item.action,\n                        dateServer: item.date,\n                        date: item.dateUserFormat,\n                        comment: item.comment,\n                        allowRestore: false,\n                        fullVersion: item.fullVersion,\n                        auditId: item.auditId,\n                        tags: item.tags\n                    });\n                    accordion.append(versionPanel);\n\n                    that.lastHistory = item.dateUserFormat;\n                }\n            } else if (updatedLink) {\n                versionPanel = that.createReferenceLine(updatedLink);\n                accordion.append(versionPanel);\n                that.lastHistory = updatedLink.dateUserFormat;\n            }\n            // add timewarp info\n            if (versionPanel && item && globalMatrix.ItemConfig.isAfterTimeWarp(item.date)) {\n                that.lastWasTimewarp = true;\n                versionPanel.addClass(\"timewarp\");\n            } else if (that.lastWasTimewarp) {\n                that.lastWasTimewarp = false;\n                versionPanel.addClass(\"justAfterTimewarp\");\n            }\n        }, from, count, auditIdMin, auditIdMax).done(function (total) {\n\n            that.pFrom = from;\n            that.pCount = count;\n            that.pTotal = total;\n            d.resolve();\n        });\n\n        return d;\n\n\n    }\n    pFrom: number;\n    pCount: number;\n    pTotal: number;\n\n    scrollInstalled = false;\n\n    private showNextReaders(doclist: JQuery, control: JQuery, from: number, count: number) {\n        let that = this;\n\n        app.getActivityAsync(function (item: IVersionDetails) { // update UI callback\n            $(\".spinningWait\", control).hide();\n            if (item) { // item can be null for added links\n                if (item.id.indexOf(\"DOC-\") === 0 || item.id.indexOf(\"SIGN-\") === 0) {\n                    if (!that.readHistory[item.id]) {\n                        that.readHistory[item.id] = { history: [], id: item.id };\n                    }\n                    that.readHistory[item.id].history.push(item);\n                    that.showReadHistory(doclist, that.readHistory[item.id]);\n                }\n                that.lastHistory = item.dateUserFormat;\n            }\n        }, from, count).done(function (total) {\n            if (from + count < total) {\n                $(\".spinningWait\", control).html('Showing activity after ' + that.lastHistory + '. <span class=\"showMore\">show more...</span>').show().click(function () {\n                    $(\".spinningWait\", control).replaceWith(ml.UI.getSpinningWait());\n                    that.showNextReaders(doclist, control, from + count, count);\n                });\n            }\n        });\n    }\n\n    private formatReadHistoryAction(action: string, actionDetails: IVersionDetails): JQuery {\n        var result = $(\"<span>\");\n        if (action === \"signed\") {\n            var reason = actionDetails.reason.split(\" by \");\n            if (reason.length > 1) {\n                result.append(\"<b>\" + action + \"</b> by \" + reason[1] + \" at \" + actionDetails.dateUserFormat);\n            } else {\n                result.append(\"<b>\" + action + \"</b> at \" + actionDetails.dateUserFormat);\n            }\n        } else {\n            result.append(\"<b>\" + action + \"</b> by \" + actionDetails.user + \" at \" + actionDetails.dateUserFormat);\n        }\n        return result;\n    }\n\n    private showReadHistory(doclist: JQuery, doc: IHistory): void {\n        let that = this;\n\n        if (!doc.panel) {\n            var plus = $('<span class=\"fal fa-minus-square plusctrl\">');\n            plus.data(\"doc\", doc.id);\n            plus.data(\"open\", true);\n            plus.click(function (event: JQueryEventObject) {\n                var info = that.readHistory[$(event.delegateTarget).data(\"doc\")];\n                if ($(event.delegateTarget).data(\"open\")) {\n                    $(event.delegateTarget).removeClass(\"fa-minus-square\");\n                    $(event.delegateTarget).addClass(\"fa-plus-square-o\");\n                    $(event.delegateTarget).data(\"open\", false);\n                    info.panelBorder.hide();\n                } else {\n                    $(event.delegateTarget).addClass(\"fa-minus-square\");\n                    $(event.delegateTarget).removeClass(\"fa-plus-square-o\");\n                    $(event.delegateTarget).data(\"open\", true);\n                    info.panelBorder.show();\n                }\n            });\n\n            doc.header = $('<div class=\"\">').refLink({\n                folder: false, // show id if it exists\n                id: doc.id,\n                title: doc.history[0].title,\n                style: refLinkStyle.selectTree,\n                tooltip: refLinkTooltip.none\n            });\n            doc.panel = $('<div class=\"detailsRead\">');\n            doc.panelBorder = $('<div class=\"detailsReadOuter\">');\n            doclist.append(plus).append(doc.header).append(doc.panelBorder.append(doc.panel));\n        }\n        var current = doc.history[doc.history.length - 1];\n        var version = $('<div class=\"\">');\n        doc.panel.append(version);\n        if (current.action === 'edit') {\n            if (!doc.wasEdit) {\n                version.append(this.formatReadHistoryAction(\"modified\", current));\n            } else {\n                // don't show this is an edit after an edit or create\n            }\n            doc.wasEdit = true;\n        } else if (current.action === 'add') {\n            version.append(this.formatReadHistoryAction(\"created\", current));\n        } else if (current.action === 'report') {\n            version.append(this.formatReadHistoryAction(\"downloaded\", current));\n            doc.wasEdit = false;\n        } else if (current.action === \"signature\") {\n            version.append(this.formatReadHistoryAction(\"signed\", current));\n            doc.wasEdit = false;\n        } else {\n            version.append(this.formatReadHistoryAction(current.action, current));\n            doc.wasEdit = false;\n        }\n    }\n\n    // This is used in the shadowed compare display\n    private static compare_css: string = `\n    <style>\n    .compareTools {\n        position: absolute;\n        right: 3em;\n        top: 8px;\n        color: #2920dc\n    }\n\n    .compareToolsHeader {\n        padding-right: 10px;\n        font-weight: 700\n    }\n\n    .compareToolsGroup {\n        display: table;\n        float: left\n    }\n\n    .compareTool {\n        padding-right: 12px;\n        display: table-cell\n    }\n\n    .compareRow {\n        display: table-row\n    }\n\n    .compareLeft {\n        display: table-cell;\n        width: 720px;\n        vertical-align: top;\n        padding-right: 10px\n    }\n\n    .compareItem {\n        margin-bottom: 10px!important\n    }\n\n    .compareRight {\n        width: 700px;\n        display: table-cell;\n        vertical-align: top;\n        padding-left: 10px\n    }\n\n    @media print {\n        .forcePrint {\n            height: initial!important;\n            max-height: initial!important;\n            min-height: initial!important\n        }\n    }\n\n    .compare_add {\n        background-color: #ff0!important;\n        display: inline-block;\n        white-space:normal;\n    }\n\n    .compare_remove {\n        display: inline-block;\n        color: red!important;\n        text-decoration: line-through!important;\n        white-space:normal;\n    }\n\n    .compare_style {\n        background-color: #f3f391!important;\n        white-space:normal;\n    }\n\n    .compareHeaders {\n        display: table-row\n    }\n\n    .compareHeader {\n        display: table-cell;\n        width: 700px;\n        text-align: center;\n        font-size: x-large;\n        padding-top: 20px\n    }\n    </style>\n    `;\n}\n","// -----------------------------------------------------------\n// Project tree (on left of default layout)\n\nimport { IReference, ControlState, IItem, globalMatrix, app } from \"../../../globals\";\nimport { IDB, IDBParent } from \"../../businesslogic/index\";\nimport { ml } from \"../../matrixlib\";\nimport \"../Components/ProjectView\";\nimport { ProjectView } from \"../Components/ProjectView\";\nimport { plugins } from \"../../businesslogic/index\";\nimport { NavBar } from \"../Components\";\n\nexport type { MatrixTreeOptions, ITreeDropInfo };\nexport { MainTreeImpl, NavigationPanel };\n\n// -----------------------------------------------------------\ninterface MatrixTreeOptions {\n    noAnimation:boolean,\n    highlight: boolean,\n    canFilter: boolean,\n    serverSearch: boolean,\n    expand: number,\n    canSelectItems: boolean,\n    canFilterExclusiv: boolean,\n    selectedItems: IReference[],\n    isConfigSearch?:boolean,\n    tree?:IDB[],\n    controlState: ControlState,\n    dropCallback: (moveDetails:ITreeDropInfo) => boolean, // callback to be called after drop, returns true if item can be dropped\n    selectionChanged: (id:string) => void, // callback to be called when selection in tree changes\n    onExpand?:  (id:string) => void // optional callback, called when folder is opened\n    isMainTree?:boolean // can be set to true to indicate it's the main tree on left\n}\ninterface ITreeDropInfo { parentId: string, itemId: string, index: number, updateUI?: () => void }\n\nclass MainTreeImpl {\n    private settings: MatrixTreeOptions;\n    private _jui:JQuery;\n    private triggerSelectionChange:boolean;\n\n    constructor() {\n        let that = this;\n        // define default settings\n        this.settings = {\n            noAnimation: false,\n            highlight: true,\n            canFilter: true,\n            serverSearch: true,\n            expand: 0,\n            canSelectItems: false,\n            canFilterExclusiv: true,\n            selectedItems: [],\n            controlState: ControlState.FormEdit,\n            dropCallback: (moveDetails:ITreeDropInfo) => {\n                if (moveDetails.itemId === app.getCurrentItemId() &&\n                    app.getNeedsSave()) {\n                    ml.UI.showError(\"Save First\", \"Please save the changes before moving the item.\");\n\n                    return false;\n                }\n\n                app.moveItemsAsync(moveDetails.itemId, moveDetails.parentId, moveDetails.index).done(function () {\n                    if (moveDetails.updateUI) {\n                        moveDetails.updateUI();\n                    }\n                }).fail(function () {\n\n                });\n                return true;\n            },\n            selectionChanged: (id:string) => {\n                if (that.triggerSelectionChange) {\n                    app.treeSelectionChangeAsync(id).done(function () {\n                    }).fail(function () {\n                    });\n                }\n            }\n        };\n        this.init($(\"#projectTree\"));\n\n        this.triggerSelectionChange = true;\n    }\n    init( control:JQuery ) {\n        this._jui = control;\n    }\n\n    focusTree() {\n        this._jui.getController().tree.find('ul.ui-fancytree').focus()\n    }\n\n    render(treeSettings?:MatrixTreeOptions) {\n        // Register with search tools.\n        let that = this;\n        ml.Search.OnCancelSearch.subscribe(that, function (arg) {\n            that.clearFilter();\n        });\n        if ( treeSettings ){\n            this.settings = treeSettings;\n        }\n        this.settings[\"tree\"] = app.getTree();\n        this.settings.isMainTree = true;\n\n        this._jui.html(\"\");\n        this._jui.projectView(this.settings);\n        window.setTimeout(function () {\n            $(\".ui-fancytree\").focus();\n        }, 200);\n        plugins.updateSearchPanel();\n    }\n\n    update(item:IItem):void {\n        // if the node changed, it might be the title: update in tree\n        if (typeof item.title == \"undefined\") {\n            // a partial update (only some fields or labels) will not change label\n            return;\n        }\n        // avoid 'malicious' item titles...\n        item.title = item.title.replace(/</g,\"&lt;\");\n        (<ProjectView>this._jui.getController()).setTitle(item.id, item.title);\n    }\n\n    remove(itemId:string):void {\n        (<ProjectView>this._jui.getController()).removeNode(itemId);\n    }\n\n    // open a folder (optionally also parent folders)\n    openFolder(itemId:string, expandToRoot?:boolean) {\n        (<ProjectView>this._jui.getController()).openTree(itemId);\n        if (expandToRoot) {\n            var parent = app.getParentId(itemId);\n            if (parent && parent != \"F-PROJECT\") {\n                NavigationPanel.openFolder(itemId, true);\n            }\n        }\n    }\n   // open a folder (optionally also parent folders)\n    closeFolder(itemId:string) {\n        (<ProjectView>this._jui.getController()).closeTree(itemId);\n    }\n    select(itemId:string):void {\n        this.triggerSelectionChange = false;\n        try {\n            NavBar.activateItemsTab(itemId);\n            (<ProjectView>this._jui.getController()).select(itemId);\n        } catch (ex) {\n            // the change of selection can fail if the tree is filtered (so the item is not shown)\n        }\n        this.triggerSelectionChange = true;\n    }\n\n    isSelected(itemId:string):boolean {\n        return (<ProjectView>this._jui.getController()).isSelected(itemId);\n    }\n\n    insertInTree(newItem:IDBParent, noEscape?:boolean ):void {\n        // the parameter new item contains information about the new item\n        // newitem = {parent: ID of (parent) folder, position: position inside folder, item: json object defining the item\n        // the item itself has (\"title\", \"type\", \"id\", and \"children\" if it is a folder\n\n        if (newItem && newItem.item && !noEscape) newItem.item.title = newItem.item.title.replace(/</g,\"&lt;\");\n\n        (<ProjectView>this._jui.getController()).insertNode(newItem.parent, newItem.item, {at:newItem.position});\n\n    }\n\n    moveInTree( itemId:string, newParentId:string, newPosition:number ) {\n         (<ProjectView>this._jui.getController()).moveNode( newParentId, itemId, newPosition);\n    }\n    insertUpdateTreeRec(target:string, source:IDB) {\n        // this function either replaces the target and or a child of the target with the new database stuff, if the source does not exists it's added\n\n        if (target === source.id) {\n            (<ProjectView>this._jui.getController()).updateRec(source);\n        }\n        else {\n            (<ProjectView>this._jui.getController()).insertRec(target, source);\n        }\n    }\n\n    destroy():void {\n        this._jui.html(\"\");\n    }\n\n    clearFilter():void {\n        // called if the user starts searching in a selection dialog to remove highlights from NavigationPanel\n        if( this._jui && this._jui.getController )\n            (<ProjectView>this._jui.getController()).clearFilter();\n    }\n\n    updateItemIsUnselected(itemId:string, isUnselected:boolean):void {\n        if( this._jui && this._jui.getController )\n            (<ProjectView>this._jui.getController()). updateItemIsUnselected(itemId, isUnselected);\n    }\n\n    updateNotificationCounters():void {\n        if( this._jui && this._jui.getController )\n             (<ProjectView>this._jui.getController()). updateNotificationCounters();\n   }\n}\n\nvar NavigationPanel: MainTreeImpl = new MainTreeImpl();\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ControlState, IReference, IGenericMap, globalMatrix, app, matrixSession } from \"../../../globals\"\nimport {FieldHandlerFactory, IDB} from \"../../businesslogic/index\"\nimport { IBaseControlOptions, IBaseControl } from \"../Controls/BaseControl\"\nimport { ListView } from \"./ProjectList\"\nimport { ProjectTree } from \"./ProjectTree\"\nimport { SearchBox } from \"./SearchBox\"\nimport { ViewModeSelector } from \"./ViewModeSelector\"\nimport { ml } from \"../../matrixlib\"\nimport { refLinkStyle, refLinkTooltip } from \"../Parts/RefLinkDefines\"\nimport { NotificationList } from \"../../../client/plugins/Notifications\"\nimport { plugins } from \"../../businesslogic/index\";\nimport { IProjectPanelControlOptions, MyDDData, MyFancytree, MyNode, MyNodeData, SearchUpdate, SelectMode } from \"./ProjectViewDefines\";\n\n// TODO(modules): an inelegant way to force a side effect from a module load.\nimport \"../Parts/RefLink\";\nimport { EImportMode } from \"../../businesslogic/ComponentImport\"\nimport {IFieldHandler} from \"../../businesslogic/FieldHandlers/IFieldHandler\";\nimport {GenericFieldHandler} from \"../../businesslogic/FieldHandlers/GenericFieldHandler\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\n\nexport { ProjectView };\n\n$.fn.projectView = function(this:JQuery,options:IProjectPanelControlOptions) {\n\n    let baseControl = new ProjectView(this);\n    this.getController = () => { return baseControl;}\n    if (!options.fieldHandler) {\n        options.fieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, FieldDescriptions.Field_dummy, options);\n        options.fieldHandler.initData(JSON.stringify(options.fieldValue));\n    }\n    baseControl.setFieldHandler(options.fieldHandler)\n    baseControl.init(options);\n    return this;\n}\n\nclass ProjectView implements IBaseControl {\n    public settings: IProjectPanelControlOptions;\n    public viewModeSelector: ViewModeSelector;\n    public searchBox: SearchBox;\n    public projectTree: ProjectTree;\n    public listView: ListView;\n    public prefixCategory:string; // set to a category id, if search should only be in category\n    public tree:JQuery;\n    private _root:JQuery;\n    public needsLatest:boolean; // no meaning juts to be compatible with\n\n    fieldHandler: IFieldHandler;\n    private currentFilterContainer: JQuery;\n    getFieldHandler(): IFieldHandler {\n       return  this.fieldHandler;\n\n    }\n    setFieldHandler(fh:IFieldHandler) {\n        this.fieldHandler = fh;\n    }\n\n    constructor( control:JQuery) {\n        this._root = control;\n    }\n\n\n    init( options:IBaseControlOptions ) {\n        let that = this;\n\n        var defaultOptions: IProjectPanelControlOptions = {\n            controlState: ControlState.FormView, // read only rendering\n            highlight: true, // true: input should be highlighted in complete page\n            canFilter: true, // true: filter / search box should be shown\n            serverSearch: true, // true: search server should be enabled: disabled only in admin client\n            expand: 0, // minimum number of levels to expand\n            selectedItems: [], // list of selected items,\n            dragAndDrop: (options.controlState === ControlState.FormEdit), // embedded editable tree allows drag and drop\n            tree: [], // tree in fancy tree style\n            tooltips: true, // show tooltips if available\n            selectionChanged: function() { }, // callback if selection was changed, if not set a click will open another window\n            dropCallback: function() { }, // callback after node was dropped\n            collectionChanged: function(count: number): void { }, // callback if checkbox in tree was set or unset\n            selectMode: 0, // no selection\n            autoScroll: true\n        };\n\n        this.settings = ml.JSON.mergeOptions(defaultOptions, options);\n\n        this.settings.dragAndDrop = this.settings.dragAndDrop && matrixSession.isEditor();\n\n        // render and search\n        var ctrlDiv = $(\"<div class='treeCtrl'>\");\n        this._root.append(ctrlDiv);\n\n\n\n        this.projectTree = new ProjectTree(this, this.settings.canFilter);\n        this.listView = new ListView(this);\n        this.searchBox = new SearchBox(this);\n        this.viewModeSelector = new ViewModeSelector(this);\n        // let expandMinLevel = 2;\n        // if ( this.settings.tree.length > 1 ) {\n        //     this.settings.expand = 0;\n        //     expandMinLevel = 0;\n        // }\n        // initialize object\n        if (this.settings.controlState === ControlState.Print || this.settings.controlState === ControlState.Tooltip) {\n            return; // nothing to do\n        }\n\n        // add ui for filter and search\n        if (this.settings.canFilter ) {\n            // tree/list filter method\n            var filter = $(`<div id=\"searchFilter\" data-cy='searchFilter' class=\"\" style=\"width:100%\"></div>`);\n            ctrlDiv.append(filter);\n\n           $('<label class=\"treeLabel searchVizMode\">View type</label>').insertBefore($(\".listContent\"));\n           this.viewModeSelector.getVizModeControl(function() {\n                that.searchBox.render();\n            }).insertAfter($(\"label.searchVizMode\", this._root));\n\n            let labelFilters = $('<label class=\"treeLabel itemFilterTool \">Filters</label>').insertAfter($(\"label.searchVizMode\"));\n            this.currentFilterContainer = $('<div id=\"currentFilterContainer\" class=\"itemFilterTool\"></div>');\n            this.currentFilterContainer.insertAfter(labelFilters);\n\n            $(\"<div class='itemFilterTool itemFilterToolContainer'><button class='btn btn-xs btn-link itemFilterTool clearFilter'  id='clearSelectedFilter'  data-cy='clearFilter' '>Clear filter</span></div>\").insertAfter(this.currentFilterContainer);\n\n            $(\"#clearSelectedFilter\").click(function() {\n                ml.LabelTools.setFilter([]);\n                $(\"#filterDialog\").remove();\n                app.loadProject(matrixSession.getProject(), app.getCurrentItemId()).then(()=>{\n                    $(\".itemFilterTool\").hide();\n                });\n            });\n\n            // search field\n            this.searchBox.renderSearchField(filter, this.settings.serverSearch, that.settings.highlight, that.settings.isConfigSearch?? false, this.currentFilterContainer);\n\n\n\n        }\n        this._root.append($('<label class=\"treeLabel treeName\">Contents</label>'));\n        // add ui for tree\n        this.tree = $('<div name=\"ftree\" data-cy=\"tree\" class=\"treeContent\"></div>');\n        this._root.append(this.tree);\n\n\n        var doNotTriggerSelectionChange = false; // if true the client will not be informed,\n        var rememberLastActivation:string; // to avoid double activations (which can arrive if one saves while it gets activated again)\n\n        // determine native select mode of tree\n        var sm = 0;\n        switch (this.settings.selectMode) {\n            case SelectMode.none: //(later we must hide checkboxes)\n            case SelectMode.singleItem:\n            case SelectMode.singleFolder:\n                sm = 1;  // checking one item will uncheck other checked\n                break;\n            case SelectMode.items:\n            case SelectMode.folders:\n            case SelectMode.independent:\n            case SelectMode.independentAuto:\n            case SelectMode.autoPrecise:\n                    sm = 2;  // checkboxes for items and/or folders, checking one does not influence other\n                break;\n            case SelectMode.auto:\n                sm = 3;\n                break;\n        }\n        let fireUpdates = true;\n        var fto = <Fancytree.FancytreeOptions>{\n            checkbox: this.settings.selectMode != SelectMode.none,\n            selectMode:  sm,\n            clickFolderMode: 4, // expand with double click:\n            autoActivate: false,\n            autoCollapse: false,\n            imagePath: globalMatrix.matrixBaseUrl + \"/img/\",\n            autoScroll: this.settings.autoScroll,\n            keyboard: true,\n            tabbable: true, // we don't want the focus frame\n            minExpandLevel: 1, // expandMinLevel,\n            focus: function(e, data) {\n                var ctree = $(e.delegateTarget).find(\".ui-fancytree\");\n                if (!ctree.is(\":focus\")) {\n                    ctree.focus();\n                }\n            },\n            expand: function(e, data) {\n                if (that.settings.onExpand) {\n                    that.settings.onExpand( data.node.key);\n\n                }\n                plugins.updateTree();\n\n            },\n            blur: function(e, data) {\n                data.node.scheduleAction(\"cancel\",0);\n            },\n            select: function(e, data) {\n                if ( fireUpdates ) {\n                    that.saveSelection(\"new\");\n                }\n            },\n            activate: function(e, data) {\n                var node = data.node;\n                if (!doNotTriggerSelectionChange && that.settings.selectionChanged && rememberLastActivation !== node.key) { // call app\n                    rememberLastActivation = node.key;\n                    that.settings.selectionChanged.apply(null, [node.key]);\n                }\n            },\n            click: function(e, data) { // allow re-loads\n                // TODO(modules): not sure how to fix this. There is a namespace declaration in\n                // externals-fancytree, but it doesn't work.\n                var tt = (<any>($.ui)).fancytree.getEventTargetType(e.originalEvent);\n                if (tt !== \"expander\" && tt !== \"checkbox\" && data.node && !data.node.expanded) {\n                    data.node.setExpanded();\n                }\n                // now follows a workaround for MATRIX-634 label filtering tree kaput\n                // the jquery toggle function (with a nice event) gets somehow screwed in fancy tree\n                // so I just wait a little and after 220 ms I make sure the item is actually toggled\n\n                if (tt === \"expander\" || (data.node && !data.node.expanded)) {\n                    var node: MyNode = data.node;\n                    var x = $(node.ul);\n                    var y = data.node.expanded;\n                    window.setTimeout(function() {\n                        y ? x.hide() : x.show();\n                    }, 220);\n                }\n\n                if (that.settings.selectMode == SelectMode.independentAuto && tt === \"checkbox\" && data.node.folder && !data.node.isSelected()) {\n                    fireUpdates = false;\n                    that.projectTree.selectChildren(data.node);\n                    fireUpdates = true;\n                }\n                if (that.settings.selectMode == SelectMode.autoPrecise && tt === \"checkbox\" ) {\n                    if (data.node.folder && !data.node.isSelected()) {\n                        fireUpdates = false;\n                        that.projectTree.selectChildren(data.node);\n                        fireUpdates = true;\n                    }\n\n                    if ( data.node.isSelected()) {\n                        fireUpdates = false;\n                        that.projectTree.unselectParents(data.node);\n                        if (data.node.folder) {\n                            that.projectTree.unSelectChildren(data.node);\n                        }\n                        fireUpdates = true;\n                    }\n                    // set partial selection status after click\n                    window.setTimeout( () => {that.projectTree.forcePartial();}, 1);\n\n                }\n                return true;\n            },\n            renderNode: function(event: JQueryEventObject, data: Fancytree.EventData) {\n                // Optionally tweak data.node.span\n                var node: MyNode = data.node;\n                var myNodeData = <MyNodeData>node.data;\n                if (myNodeData.cstrender) {\n                    node.unselectable = that.settings.selectMode == SelectMode.none\n                        || (node.folder && ( that.settings.selectMode == SelectMode.items || that.settings.selectMode == SelectMode.singleItem  ) )\n                        || (!node.folder && ( that.settings.selectMode == SelectMode.folders || that.settings.selectMode == SelectMode.singleFolder  ) );\n                    var $span = $(node.span);\n\n                    let dataCy = myNodeData.shortTitle ?? myNodeData.title;\n                    if( dataCy != undefined)\n                    {\n                        dataCy = $(`<span>${dataCy}</span>`).text().replace(\" \",\"-\")\n                        $span.attr(\"data-cy\",dataCy);\n                    }\n\n                    if (node.unselectable) {\n                        $(\".fancytree-checkbox\",$span).remove();\n                    }\n                    if (myNodeData.background) {\n                        $span.css(\"background-color\", myNodeData.background);\n                    }\n                    if (myNodeData.border) {\n                        $span.css(\"border\", myNodeData.border);\n                    }\n                    if (node.parent.parent === null) {\n                        // grey borders around root nodes\n                        // $span.css(\"background-color\", \"#e5e5e5\").css(\"border\", \"1px solid rgb(204, 204, 204)\");\n                    }\n                    if (that.settings.selectionChanged) { // call app\n                        $span.find(\"> span.fancytree-title\").refLink({\n                            id: node.key,\n                            folder: node.folder,\n                            title: myNodeData.shortTitle,\n                            css: myNodeData.extraStyle,\n                            style: refLinkStyle.show,\n                            tooltip: that.settings.tooltips ? refLinkTooltip.html : refLinkTooltip.none,\n                            crossProject: that.settings.crossProject,\n                            callback: function() {\n                                if (that.settings.canSelectItems) {\n                                    node.toggleSelected();\n                                }\n                                // prevent second round trip in activate\n                                rememberLastActivation = node.key;\n                                var ret = that.settings.selectionChanged.apply(null, [node.key]);\n                                return ret;\n                            }\n                        });\n                    } else {\n                        $span.find(\"> span.fancytree-title\").refLink({\n                            id: node.key,\n                            folder: node.folder,\n                            title: myNodeData.shortTitle,\n                            style: refLinkStyle.link,\n                            css: myNodeData.extraStyle,\n                            crossProject: that.settings.crossProject,\n                            tooltip: that.settings.tooltips ? refLinkTooltip.html : refLinkTooltip.none\n                        });\n                    }\n                }\n            },\n            extensions: [\"dnd\", \"filter\"],\n            dnd: {\n                preventVoidMoves: true, // Prevent dropping nodes 'before self', etc.\n                preventRecursiveMoves: true, // Prevent dropping nodes on own descendants\n                autoExpandMS: 400,\n                focusOnClick: true, // to enable keyboard navigation!\n                dragStart: function(node:Fancytree.FancytreeNode) {\n                    let isIncluded = (<MyNodeData>node.data).mode == EImportMode.Include;\n                        // MATRIX-5845 allow to move the root ... into another place in the root\n                        // || (<MyNodeData>node.data).mode == EImportMode.IncludeRoot; // it's the root of the includes\n\n                    return that.settings.dragAndDrop && app.canDragDrop((<MyNode>node.data).type, node.key) && !isIncluded;\n                },\n                dragEnter: function(node:Fancytree.FancytreeNode, dddata:MyDDData):string[]|boolean {\n                    if (dddata === null || dddata.otherNode === null || dddata.otherNode.data === null) {\n                        return false;\n                    }\n                    if (app.dragEnter) {\n                        return app.dragEnter(<Fancytree.FancytreeNode>dddata.otherNode, node);\n                    }\n                    if ((<MyNode>dddata.otherNode.data).type !== (<MyNode>node.data).type) {\n                        return false;\n                    }\n                    if (node.folder) {\n                        if ((<MyNode>node.parent.data).type !==(<MyNode> dddata.otherNode.data).type) {\n                            return [\"after\"];\n                        }\n                        return true;\n                    }\n                    if (node.parent === null || (<MyNode>node.parent.data).type !== (<MyNode>dddata.otherNode.data).type) {\n                        return false;\n                    }\n                    return [\"before\", \"after\"];\n                },\n                dragOver: function(node:Fancytree.FancytreeNode, dddata:MyDDData, hitMode:string):any {\n                    /** Return false to disallow dropping this node.\n                     *\n                     */\n\n                    // Prevent dropping a parent below it's own child\n                    if (!dddata || node.isDescendantOf(dddata.otherNode)) {\n                        ml.Logger.log(\"error\", \"FALSE node.isDescendantOf(dddata)\");\n                        return false;\n                    }\n                    // Prohibit dropping in anything which is an include\n                    if ((<MyNodeData>node.data).mode == EImportMode.Include || (<MyNodeData>node.data).mode == EImportMode.IncludeRoot) {\n                        return false;\n                    }\n\n                    // Prohibit include root to be dropped into anything but root folder\n                    if ((<MyNodeData>dddata.otherNode.data).mode  == EImportMode.IncludeRoot) {\n                        var target = that.calculateDropTarget(node, dddata.hitMode);\n                         if (target.key !=  \"F-\" + (<MyNodeData>node.data).type + \"-1\") {\n                            return false;\n                        }\n                    }\n\n                    // Prohibit creating children in non-folders (only sorting allowed)\n                    if (!(<MyNode>node.data).isFolder && hitMode === \"over\") {\n                        ml.Logger.log(\"error\", \"after !node.data.isFolder && hitMode ==='over'\");\n                        return \"after\";\n                    }\n                },\n                dragDrop: function(node:Fancytree.FancytreeNode, dddata:MyDDData) {\n                    // Prohibit dropping in anything which is an include\n                    if ((<MyNodeData>node.data).mode == EImportMode.Include || (<MyNodeData>node.data).mode == EImportMode.IncludeRoot) {\n                        return;\n                    }\n\n                    if (that.settings.dragAndDrop) {\n                        var target = that.calculateDropTarget(node, dddata.hitMode);\n                        // Prohibit include root to be dropped into anything but root folder\n                        if ((<MyNodeData>dddata.otherNode.data).mode  == EImportMode.IncludeRoot && target.key !=  \"F-\" + (<MyNodeData>node.data).type + \"-1\") {\n                            return;\n                        }\n                        that.settings.dropCallback.apply(null, [{\n                            parentId: target.key,\n                            itemId: dddata.otherNode.key,\n                            index: target.index,\n                            updateUI: function() {\n                                dddata.otherNode.moveTo(node, dddata.hitMode);\n                                var key = dddata.otherNode.key;\n                                that.render(SearchUpdate.item_dropped, key);\n                            }\n                        }]);\n                    }\n                },\n                dragStop: function(node:Fancytree.FancytreeNode, dddata:MyDDData) {\n                    // after a drag and drop the selection in the tree changes (no idea why)\n                    // to prevent the client to do this the following lines are required\n                    // the timeout ensures that all triggers started by the drag finished when resetting\n                    // doNotTriggerSelectionChange\n                    doNotTriggerSelectionChange = true;\n                    var selectionBeforeDrag = app.getCurrentItemId();\n                    window.setTimeout(function() {\n                        (<MyFancytree>that.tree.fancytree(\"getTree\")).options.autoScroll = false;\n                        (<MyFancytree>that.tree.fancytree(\"getTree\")).activateKey(selectionBeforeDrag);\n                        (<MyFancytree>that.tree.fancytree(\"getTree\")).options.autoScroll = true;\n                        doNotTriggerSelectionChange = false;\n                    }, 1);\n                }\n\n            }//dnd: {\n        }\n        if (this.settings.canFilter) {\n            (<IGenericMap>fto)[\"filter\"] = {\n                mode: \"dimm\",\n                autoApply: true\n            };\n        }\n        if (this.settings.noAnimation) {\n            (<IGenericMap>fto)[\"toggleEffect\"] = false;\n        }\n        if (NotificationList.isEnabled() && this.settings.isMainTree) {\n            if (fto.extensions) {\n                fto.extensions.push( \"notificationCounter\" )\n            } else {\n                fto[\"extensions\"] = [\"notificationCounter\"];\n            }\n        }\n        this.tree.fancytree(fto); // $(\"#tree\").fancytree({\n        this.projectTree.treeFromDb(this.settings.tree);\n\n        if (!matrixSession.isConfigClient()) {\n            // do the initial filtering: maybe there are some project labels\n            this.searchBox.resetSearch();\n        }\n\n        // select items\n        $.each(this.settings.selectedItems, function(index, key) {\n            var item: Fancytree.FancytreeNode = (<Fancytree.Fancytree>that.tree.fancytree(\"getTree\")).getNodeByKey(key.to);\n            if (item) {\n                item.setSelected();\n                if (that.settings.selectMode == SelectMode.autoPrecise && ml.Item.parseRef( key.to ).isFolder ) {\n                    that.forceSelectChildren( key.to );\n                }\n            }\n        });\n\n        if (that.settings.selectMode == SelectMode.autoPrecise) {\n            // set partial selection for special precision mode\n            that.projectTree.forcePartial();\n        }\n\n        if (this.settings.expand && this.settings.expand > 0) {\n            (<Fancytree.Fancytree>this.tree.fancytree(\"getRootNode\")).visit(function(node) {\n                if (node.getLevel() <= that.settings.expand)\n                    node.setExpanded(true);\n            });\n        }\n        this.resizeItem();\n\n        this.saveSelection(\"original\");\n        this.saveSelection(\"new\");\n    }\n\n    private forceSelectChildren( id:string ) {\n        let that = this;\n\n        for (let child of app.getChildrenIds(id)) {\n            let item: Fancytree.FancytreeNode = (<Fancytree.Fancytree>that.tree.fancytree(\"getTree\")).getNodeByKey(child);\n            if (item) {\n                item.setSelected();\n                if (  ml.Item.parseRef(child ).isFolder ) {\n                    that.forceSelectChildren( child );\n                }\n            }\n        }\n\n    }\n    // public interface\n    async hasChangedAsync() {\n        return JSON.stringify(this._root.data(\"original\")) !== JSON.stringify(this._root.data(\"new\"));\n    }\n\n    async getValueAsync():Promise<IReference[]> {\n        return this._root.data(\"new\");\n    }\n\n    setValue(selectedItems:string[]) {\n        this.projectTree.setSelectedItems(selectedItems);\n        this.listView.setSelectedItems(selectedItems);\n    }\n\n    toggleSelection(selected:boolean) {\n        if ( this.viewModeSelector.showAsList()) {\n            this.listView.selectAll(selected);\n        } else {\n            this.projectTree.selectAll(selected);\n        }\n    }\n\n    destroy() {\n    }\n\n    resizeItem() {\n        this.searchBox.updateHeights();\n    }\n    clearFilter() {\n        this.searchBox.resetSearch();\n    }\n    filterStatusChanged(itemId:string) {\n        this.render(SearchUpdate.filter_status_changed, itemId);\n    }\n\n    // tree creation\n    insertNode(parentKey: string, item:IDB, position:{at:number}) {\n\n        var nn = this.projectTree.addNode(this.projectTree.getNode(parentKey), item, position);\n\n        this.render(SearchUpdate.inserted_node, item.id,item );\n    }\n\n    moveNode(parentId: string, itemId:string, position:number) {\n\n        var nn = this.projectTree.moveNode(parentId, itemId, position);\n        this.render(SearchUpdate.inserted_node, itemId);\n        this.projectTree.openTree(parentId);\n    }\n    refresh() {\n        this.render(SearchUpdate.inserted_node);\n    }\n\n    updateRec (item:IDB) {\n        this.projectTree.updateRec(item);\n        this.searchBox.render();\n    }\n\n    insertRec (parentKey:string, item:IDB) {\n        this.projectTree.insertRec(parentKey, item);\n        this.searchBox.render();\n    }\n\n    updateTopPosition( top:number ):void {\n        if (!this.settings.canFilter) {\n            $(\".treeContent\", this._root).css(\"top\",\"4px\");\n            $(\".listContent\", this._root).css(\"top\",\"4px\");\n        } else {\n            $(\".treeContent\", this._root).css(\"top\",top+\"px\");\n            $(\".listContent\", this._root).css(\"top\",top+\"px\");\n        }\n    }\n\n    appendController ( controller:JQuery):void {\n        this._root.append(controller);\n    }\n\n    render(subtree?:number, itemId?:string, item?:IDB) {\n\n        if (subtree === SearchUpdate.inserted_node ||\n            subtree === SearchUpdate.filter_status_changed ||\n            subtree === SearchUpdate.item_dropped ||\n            subtree === SearchUpdate.title_changed) {\n\n            this.listView.redrawItem(item?item.id:itemId);\n            if (subtree === SearchUpdate.inserted_node ||\n                subtree === SearchUpdate.filter_status_changed ||\n                subtree === SearchUpdate.title_changed ) { // MATRIX-1378\n                this.projectTree.applyFilter();\n            }\n        }\n    }\n\n    openTree(key:string) {\n        this.projectTree.openTree(key);\n    }\n    closeTree(key:string) {\n        this.projectTree.closeTree(key);\n    }\n    setTitle(key:string, title:string) {\n        if ( this.projectTree.setTitle(key, title) ) {\n            this.render(SearchUpdate.title_changed, key);\n        }\n    }\n    removeNode(key:string) {\n        this.projectTree.removeNode(key);\n    }\n    select(key:string) {\n        this.projectTree.select(key);\n    }\n    isSelected(key:string) {\n        return this.projectTree.isSelected(key);\n    }\n    updateItemIsUnselected(itemId:string, isUnselected:boolean) {\n        if ( this.projectTree.updateItemIsUnselected(itemId, isUnselected)) {\n            this.filterStatusChanged(itemId);\n        }\n    }\n\n    updateNotificationCounters() {\n        this.projectTree.updateNotificationCounters();\n    }\n    private saveSelection(target:string) {\n        var sel = (<MyFancytree>this.tree.fancytree(\"getTree\")).getSelectedNodes(\n            this.settings.selectMode == SelectMode.auto || this.settings.selectMode == SelectMode.autoPrecise);\n        var selKey: IReference[] = [];\n        for (var idx = 0; idx < sel.length; idx++) {\n            let myNodeData = <MyNodeData>sel[idx].data;\n            let title = (sel[idx].folder && sel[idx].title)?sel[idx].title:(myNodeData && myNodeData.shortTitle)?myNodeData.shortTitle:sel[idx].title;\n            selKey.push({to: sel[idx].key, title: title});\n        }\n        this._root.data(target, selKey);\n        this.settings.collectionChanged.apply(null, [sel.length]);\n    }\n\n    private calculateDropTarget(targetNode:MyNode, mode:string) {\n        // simulate fancy tree to check where it would go\n        if (mode === undefined || mode === \"over\") {\n            mode = \"child\";\n        }\n        var targetParent = (mode === \"child\") ? targetNode : targetNode.parent;\n        var pos = 0;\n\n        if (targetParent.hasChildren()) {\n            switch (mode) {\n                case \"child\":\n                    // Append to existing target children\n                    pos = targetParent.children.length;\n                    break;\n                case \"before\":\n                    // Insert this node before target node\n                    pos = $.inArray(targetNode, targetParent.children);\n                    break;\n                case \"after\":\n                    // Insert this node after target node\n                    pos = 1 + $.inArray(targetNode, targetParent.children);\n                    break;\n            }\n        }\n\n        return  {\n            key: targetParent.key,\n            index: pos\n        };\n    }\n\n    getRoot() {\n        return this._root;\n    }\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ICompanyUISettings } from \"../../businesslogic/index\";\nimport { ISearchCounts } from \"./ProjectTree\";\nimport { MyNodeData, MyNode, SelectMode } from \"./ProjectViewDefines\";\nimport { ProjectView } from \"./ProjectView\";\nimport { ml } from \"./../../matrixlib\";\nimport { NavBar } from \"./NavigationBar\";\nimport { refLinkStyle, refLinkTooltip } from \"../Parts/RefLinkDefines\";\nimport { app, globalMatrix, matrixSession } from \"../../../globals\";\n\nexport type { IUIMap, IKeyTitle };\nexport { ListView };\n\ninterface IUIMap { [key: string]: JQuery }\n\ninterface IKeyTitle { key: string, title: string }\nclass ListView {\n        // list control\n        private control:JQuery;\n        // results from the last search\n        private hits:string[] = [];\n        private selected:string[]  = [];\n        private projectWarn:boolean = false;\n        private panel:ProjectView;\n        private sRoot:JQuery = $(\"<div>\"); // a list with all selected nodes\n        private uRoot:JQuery = $(\"<div>\"); // a list with all search results\n        private nodes:IUIMap = {};     // a lookup from id to ui node to show / hide search results\n        private noSelected:JQuery;     // node showing that nothing is selected\n\n        constructor (panel:ProjectView) {\n            this.panel = panel;\n            this.control = $(\"<div class='listContent'>\");\n\n            this.panel.appendController( this.control );\n            if ( panel.settings.glueToBottom) {\n                this.control.css(\"bottom\",0);\n            }\n            this.control.hide();\n        }\n\n\n        // show the list\n        show () {\n            this.control.show();\n        }\n        // hide the list\n        hide() {\n            this.control.hide();\n        }\n        setSelectedItems(selectedItems:string[]) {\n            let that = this;\n\n            $.each(selectedItems, function(hidx,hit) {\n                if ( that.selected.indexOf(hit) ===-1 ) {\n                    that.selected.push(hit);\n                    var node = that.getFancyTree().getNodeByKey(hit);\n                    if (node) {\n                        node.setSelected(true);\n                    }\n                }\n            });\n            this.showNodes();\n        }\n\n        redrawItem( itemId:string ) {\n            let newNode = this.getFancyTree().getNodeByKey(itemId);\n\n            // this can be called if the visibility status changed or the item was renamed\n            $.each( $(\".node_\" + itemId, this.control) , function (idx, ui_node) {\n                if ( !newNode ) {\n                    $(ui_node).hide();\n                } else {\n                   (<MyNodeData>newNode.data).isUnselected?$(ui_node).hide():$(ui_node).show();\n                   let title = newNode.title;\n                   if (title.indexOf( newNode.key + \" \") == 0) {\n                       // that's a weird hack -> in items the newNode.title has the item ID inside, in folders the newNode.data.title\n                       // we need to have just the title\n                       title = title.replace( newNode.key + \" \", \"\");\n                   }\n                   $(\".refTitle\", $(ui_node)).html(title);\n                }\n            });\n        }\n\n        filterList( match:string ):ISearchCounts {\n            let that = this;\n\n            this.projectWarn = false;\n            this.selected = [];\n            this.hits = [];\n            var hitCount = 0;\n\n            if ( match ) {\n\n                var treeMatch = (match + \"\").replace(/([.?*+\\^\\$\\[\\]\\\\(){}|-])/g, \"\\\\$1\"); // make sure a '.' is treated literally\n                var treeMatchRegEx = new RegExp(\".*\" + treeMatch + \".*\", \"i\");\n\n                this.getFancyRootNode().visit(function(node: Fancytree.FancytreeNode){\n\n                    if ((!that.panel.prefixCategory || ml.Item.parseRef(node.key).type == that.panel.prefixCategory) && !!treeMatchRegEx.exec(node.title) )   {\n                        if ((<MyNodeData>node.data).isUnselected) {\n                            // project label filter\n                            that.projectWarn = true;\n                        }  else {\n                            that.hits.push(node.key);\n                            hitCount++;\n                        }\n                    }\n                    if ((<MyNode>node).selected) {\n                        that.selected.push(node.key);\n                    }\n\n                });\n\n\n            } else {\n                // project label filter\n                this.getFancyRootNode().visit(function(node: Fancytree.FancytreeNode){\n                    if ((<MyNodeData>node.data).isUnselected) {\n                        // project label filter\n                        that.projectWarn = true;\n                    } else {\n                        hitCount++;\n                    }\n                    if ((<MyNode>node).selected) {\n                        that.selected.push((<MyNode>node).key);\n                    }\n                });\n            }\n            return this.showNodes( );\n        };\n\n        showSearchResults( serverSearchResults:string[] ) {\n            let that = this;\n\n            this.projectWarn = false;\n            this.selected = [];\n            this.hits = [];\n            // only show items in list which would be in (subtree)\n            $.each(serverSearchResults, function(idx,key) {\n\n                var node = (<Fancytree.Fancytree>that.getFancyTree()).getNodeByKey(key);\n                if (node) {\n                    that.hits.push(key);\n                }\n\n            });\n            this.getFancyRootNode().visit(function(node: Fancytree.FancytreeNode){\n                if ((<MyNodeData>node.data).isUnselected) {\n                    // project label filter\n                    that.projectWarn = true;\n                }\n                if ((<MyNode>node).selected) {\n                    that.selected.push(node.key);\n                }\n            });\n            return this.showNodes( ); //serverSearchResults, this.selected, this.projectWarn );\n        };\n\n        selectAll(setSelected:boolean) {\n            let that = this;\n\n            if ( setSelected ) {\n                $.each(this.hits, function(hidx,hit) {\n                    if ( that.selected.indexOf(hit) ===-1 && ( that.panel.settings.selectMode==SelectMode.auto || !ml.Item.parseRef(hit).isFolder) )  {\n                        that.selected.push(hit);\n                        var node = that.getFancyTree().getNodeByKey(hit);\n                        if (node) {\n                            node.setSelected(true);\n                        }\n                    }\n                });\n            } else {\n                $.each(this.selected, function(sidx,sel) {\n                    var node = that.getFancyTree().getNodeByKey(sel);\n                    if (node) {\n                        node.setSelected(false);\n                    }\n                });\n                this.selected = [];\n            }\n            this.showNodes();\n        }\n\n        private getTitleFromTree( itemId:string ) {\n            let title = \"\";\n             this.getFancyRootNode().visit(function(node: Fancytree.FancytreeNode){\n                if (node.key == itemId)   {\n                    title = (<MyNodeData>node.data).shortTitle;\n                }\n            });\n            return title;\n        }\n\n        private showNodes( all?:boolean ):ISearchCounts {\n            let that = this;\n\n            function divider(text:string) {\n                var x=$(\"<div style='position:relative'>\");\n                x.append($(\"<div>\").append($(\"<hr style='margin-top:16px;margin-bottom:20px;border-color: lightgrey;'>\")));\n                x.append($(\"<div style='color:lightgrey;position:absolute;right:0;margin-top:-20px'>\").html(text));\n                return x;\n            }\n            // maybe remove folders if checkboxes should be shown\n            var hitsDisplay:string[] = [];\n\n            if ( !this.panel.settings.canSelectItems || this.panel.settings.selectMode==SelectMode.auto ) {\n                hitsDisplay = this.hits;\n            } else {\n                $.each( this.hits, function(hidx,hit) {\n                    if ( !ml.Item.parseRef(hit).isFolder ) {\n                        hitsDisplay.push(hit);\n                    }\n                });\n            };\n\n            let counts:ISearchCounts = {\n                current:hitsDisplay.length,\n                total:hitsDisplay.length,\n                perTab: that.panel.settings.crossProject?[]:NavBar.countPerTab(hitsDisplay)\n            }\n            if (this.panel.settings.isMainTree) {\n                hitsDisplay = hitsDisplay.filter( function( itemId ) {\n                    return NavBar.isInCurrentTab(itemId);\n                });\n                counts.current = hitsDisplay.length;\n            }\n            // split list in checked and unchecked\n\n            this.sRoot = $(\"<div>\");\n            this.uRoot = $(\"<div>\");\n            this.nodes = {};\n            this.noSelected = $(\"<span style='color:grey;width:100%;text-align:center;padding-top:20px'>nothing selected</span>\");\n\n            this.control.html(\"\");\n            if ( this.panel.settings.canSelectItems) {\n                this.control.append(divider(\"selected\"));\n                this.control.append(this.sRoot);\n                this.control.append(divider(\"search results\"));\n            }\n\n            this.control.append(this.uRoot);\n            this.sRoot.append(this.noSelected);\n            if (this.selected.length > 0) {\n                this.noSelected.hide();\n                $.each( this.selected, function(sn,n) {\n                    that.sRoot.append(that.createNode(n, true));\n                });\n            }\n\n            // decide how many items to show in list view -> by default 200\n            let ui: ICompanyUISettings = <ICompanyUISettings>matrixSession.getCustomerSettingJSON(\"ui\", {});\n            let maxShow = ui.maxHits?ui.maxHits:200;\n            let actualShow = all?hitsDisplay.length:Math.min( hitsDisplay.length, maxShow);\n\n            for ( let sn=0; sn<actualShow; sn++) {\n                let n = hitsDisplay[sn];\n                let node = that.createNode(n, false);\n                that.uRoot.append(node);\n                that.nodes[n] = node;\n                if (that.selected.indexOf(n) !==-1) {\n                    node.hide();\n                }\n            };\n            // if not allow were shown, allow user to show the rest\n            if (hitsDisplay.length > actualShow) {\n                let showRest = $(`<div class='showMore' >show ${hitsDisplay.length-actualShow} remaining...</div>`);\n                that.uRoot.append(showRest);\n                showRest.on(\"click\", () => {\n                    showRest.replaceWith( ml.UI.getSpinningWait(\"please wait...\"));\n                    window.setTimeout( () => {\n                        that.showNodes(true);\n                    },1);\n                });\n            }\n            return counts;\n        }\n\n        private createNode(itemId:string, checked:boolean) {\n            let that = this;\n\n            function toggleSelect(checkbox:JQuery) {\n                var id = checkbox.data(\"itemId\");\n\n                if (checkbox.prop(\"checked\")) { // now it has been checked\n                    if (that.panel.settings.singleSelect) {\n                        // unselect the current\n                        that.panel.toggleSelection(false);\n                    }\n                    // hide it\n                    if ( that.nodes[id] ) {\n                        checkbox.prop(\"checked\",\"\");\n                        that.nodes[id].hide();\n                    }\n                    // add it to the  list of hits\n                    that.sRoot.append(that.createNode(id, true));\n\n                    // add it to global selection\n                    var node = that.getFancyTree().getNodeByKey(id);\n                    if (node) {\n                        node.setSelected(true);\n                    }\n               } else {\n                    // uncheck it,\n                    checkbox.parent().remove();\n                    // show it in search results (if it is a hit)\n                    if ( that.nodes[id] ) {\n                        that.nodes[id].show();\n                    }\n                    // remove from global selection\n                    var node = that.getFancyTree().getNodeByKey(id);\n                    if (node) {\n                        node.setSelected(false);\n                    }\n               }\n               if (that.sRoot.children().length > 1) {\n                   that.noSelected.hide();\n               } else {\n                   that.noSelected.show();\n               }\n            }\n            var cnode = $(\"<div class='search-list-node node_\"+ itemId +\"'>\");\n\n\n            if ( this.panel.settings.canSelectItems) {\n               var cb = $('<input type=\"checkbox\" '+ (checked?'checked':'')+' class=\"listSelect\" >');\n               cnode.append(cb);\n               cb.click(function(event: JQueryEventObject) {\n                    // this is the item\n                   toggleSelect($(event.delegateTarget));\n               }).data(\"itemId\", itemId);\n\n           }\n\n            var node = $(\"<span>\");\n            cnode.append(node);\n\n            if (this.panel.settings.selectionChanged && !this.panel.settings.canSelectItems) { // call app\n                node.refLink({\n                    id: itemId,\n                    folder: false,\n                    title: this.panel.settings.crossProject ? that.getTitleFromTree(itemId) : app.getItemTitle(itemId),\n                    style: app.isHiddenLink(itemId) ? refLinkStyle.show : refLinkStyle.select,\n                    tooltip: this.panel.settings.tooltips?refLinkTooltip.html:refLinkTooltip.none,\n                    crossProject:this.panel.settings.crossProject,\n                    callback: function () {\n                        $(\".search-list-node-selected\", cnode.parent()).removeClass(\"search-list-node-selected\");\n                        cnode.addClass(\"search-list-node-selected\");\n                        app.treeSelectionChangeAsync(itemId);\n                    }\n                });\n                node.addClass(\"search-list-node\");\n                $(\".refTitle\",cnode).click( function() {\n                    $(\".search-list-node-selected\", cnode.parent()).removeClass(\"search-list-node-selected\");\n                    cnode.addClass(\"search-list-node-selected\");\n                    app.treeSelectionChangeAsync(itemId);\n                });\n\n            } else {\n                node.refLink({\n                    id: itemId,\n                    folder: false,\n                    title: this.panel.settings.crossProject ? that.getTitleFromTree(itemId) : app.getItemTitle(itemId),\n                    style: refLinkStyle.link,\n                    crossProject:this.panel.settings.crossProject,\n                    tooltip: this.panel.settings.tooltips?refLinkTooltip.html:refLinkTooltip.none\n                });\n                node.click(function(event: JQueryEventObject) {\n                    var checkbox = $(event.delegateTarget).parent().find(\"input\");\n                    checkbox.prop(\"checked\", !checkbox.prop(\"checked\"));\n                    toggleSelect(checkbox);\n                });\n            }\n            return cnode;\n        }\n\n        getFancyRootNode():Fancytree.FancytreeNode {\n            return <Fancytree.FancytreeNode>this.panel.tree.fancytree(\"getRootNode\");\n        }\n        getFancyTree():Fancytree.Fancytree {\n            return <Fancytree.Fancytree>this.panel.tree.fancytree(\"getTree\");\n        }\n    }\n","// bar left side of screen\n\n\nimport { ISearchCountsTab } from \"./ProjectTree\";\nimport { ml } from \"./../../matrixlib\";\nimport { matrixSession, app, globalMatrix, IStringNumberMap } from \"../../../globals\";\n\nexport type { INavigationBar, INavigationBarTab, INavigationBarTabRuntime, IStringTabMap };\nexport { TabMode, NavigationBar };\nexport { NavBar };\nexport { initialize };\n\ninterface INavigationBar {\n    disableTabs:boolean,\n    tabs:INavigationBarTab[],\n    // favorites:INavigationFavorite[] // above help could be some favorite links\n}\n\ninterface INavigationBarRuntime extends INavigationBar {\n    tabs:INavigationBarTabRuntime[],\n    // favorites:INavigationFavorite[] // above help could be some favorite links\n}\n\n// tabs in bar\ninterface INavigationBarTab {\n    name:string // display name\n    icon:string // icon to be shown\n    mode:TabMode, // by default show / hide\n    other:string[], // categories to show / hide\n}\n\ninterface INavigationBarTabRuntime extends INavigationBarTab {\n    // these are programmatically filled\n    node?:JQuery; // the UI component for the tab\n    trees?:JQuery[]; // the UI components <li> in the tree of that tab\n    isActive?:boolean;\n}\n\ninterface IStringTabMap { [key: string]: INavigationBarTab }\n\nenum TabMode {\n    ShowAsDefault = 1,\n    HideAsDefault\n}\n\nclass NavigationBar {\n\n    static navbarWidth:number = 0;\n    protected rootTabMap:IStringTabMap = {};\n    protected workFolders:string[] = [];\n    protected enabled:boolean = false;\n    protected bar:INavigationBarRuntime;\n    protected helpButton:JQuery;\n    private navBarOpened = true;\n\n    private static getDefaultBar(project: string): INavigationBar {\n        return  {\n            disableTabs:false,\n            tabs:[\n                {\n                    name: matrixSession.isQMSProject(project) ? \"Quality Manual\" : \"Design\",\n                    icon:\"fal fa-paint-brush\",\n                    mode:TabMode.ShowAsDefault,\n                    other:[\"F-DOC-1\",\"F-SIGN-1\", \"_\", \"F-REPORT-1\", \"F-PUB-1\"], // categories to hide\n                },\n                {\n                    name: \"Documents\",\n                    icon:\"fal fa-book\",\n                    mode:TabMode.HideAsDefault,\n                    other:[\"F-DOC-1\",\"F-SIGN-1\"], // categories to show\n                },\n                {\n                    name: \"Tools\",\n                    icon:\"fal fa-tools\",\n                    mode:TabMode.HideAsDefault,\n                    other:[ \"_\", \"F-REPORT-1\"], // categories to show\n                },\n                {\n                    name: \"Publish\",\n                    icon:\"fal fa-upload\",\n                    mode:TabMode.HideAsDefault,\n                    other:[ \"F-PUB-1\"], // categories to show\n                }\n\n            ]\n        }\n    }\n\n    constructor() {\n        let that = this;\n        $(window).resize( function() {\n            that.resizeBarItems();\n        });\n    }\n\n\n    public static getConfig(): INavigationBar {\n        let setting = globalMatrix.ItemConfig.getNavigationBarConfig();\n        if (!setting || JSON.stringify(setting) == \"{}\" || !setting.tabs) {\n            const project = matrixSession.getProject();\n            return NavigationBar.getDefaultBar(project);\n        }\n        return setting;\n    }\n\n    // navigation bar left\n    init() {\n        let that = this;\n\n        if (!app.mainApp) return;\n\n        $(\"#navLeft\").remove();\n\n         this.navBarOpened = localStorage.getItem(\"navBarOpened\") === \"true\" ;\n\n        // unless there's a project / server specific bar\n        let projectSetting = NavigationBar.getConfig();\n        this.enabled  = !projectSetting.disableTabs;\n\n        if (!this.enabled)  {\n            NavigationBar.navbarWidth = 0;\n            $(\"#sidebar\").css(\"left\", 0 );\n            $('#main').css(\"left\", $(\"#sidebar\").width() + \"px\");\n            app.resizeItem(true);\n            $(\".mainHelp\").show();\n            return;\n        }\n\n        $(\".mainHelp\").hide();\n\n        this.bar = ml.JSON.clone(projectSetting);\n\n        $.each(this.bar.tabs, function(tabIdx, tab) {\n            let tools = tab.other.indexOf(\"_\");\n            if (tools!=-1) {\n                // replace this by tools\n                tab.other.splice( tools, 1, ...that.workFolders);\n            }\n        });\n        this.createTabs( );\n        this.drawNavigationBar();\n        //Delay the resize\n        setTimeout(()=>{ that.resizeBarItems()}, 100);\n        this.activateTab( this.bar.tabs[0] );\n        this.updateNotificationCounters();\n        this.resizeWitdh();\n\n    }\n\n    isEnabled() {\n        let projectSetting = NavigationBar.getConfig();\n        return !projectSetting.disableTabs;\n    }\n    // check if a certain item of the tree is in the current tab\n    isInCurrentTab( itemId:string ) {\n\n        if (!this.enabled) return true; // there's only 1 tab, kind off\n        if (!app.mainApp) return true;\n        let tab = this.getTab(itemId);\n        return tab?tab.isActive:true;\n    }\n    getCurrentTab() {\n        for (let tab of this.bar.tabs) {\n            if ( tab.isActive ) return tab.name;\n        }\n    }\n    countPerTab( itemIds:string[] ):ISearchCountsTab[] {\n\n        if (!this.enabled) return []; // no tabs\n        if (!app.mainApp) return []; // no tabs\n        let result: ISearchCountsTab[] = [];\n        let resultMap:IStringNumberMap = {};\n        for(let item of itemIds) {\n            let tab = this.getTab(item );\n            if (!resultMap[tab.name]) {\n                resultMap[tab.name] = 0;\n            }\n            resultMap[tab.name]++;\n        }\n        for( let key in resultMap) {\n            result.push( {tabName:key, count: resultMap[key]} );\n        }\n        return result;\n    }\n\n    // activates a tab with a specific item\n    activateItemsTab( itemId:string ) {\n\n        if (!this.enabled) return\n        if (!app.mainApp) return;\n\n        let tab = this.getTab(itemId);\n\n        if (!tab) {\n            return; // some non existing item\n        }\n\n        if (tab.isActive) {\n            // nothing to do\n            return;\n        }\n\n        this.activateTab(tab);\n    }\n\n    // show badges for the tab\n    updateNotificationCounters() {\n        if (!this.enabled) return;\n        $(\".navBarNotification\").remove();\n        $.each( this.bar.tabs, function(tabIdx, tab) {\n            let count = 0;\n            $.each( tab.trees, function(liIdx, li) {\n                count += li.data(\"notifications\")?li.data(\"notifications\"):0;\n            });\n            if (count) {\n                $('<span class=\"notificationCounter navBarNotification\">').html(\"\"+count).appendTo(tab.node);\n            }\n        });\n    }\n\n    // create the bar on the left side\n    protected drawNavigationBar() {\n        let that = this;\n\n        let navLeft = $(\"<div id='navLeft' class='hidden-print'>\").prependTo( \"#highlightContext\");\n\n        // help button\n        this.addHelpButton();\n        // tabs\n\n        $.each( this.bar.tabs, function( tabIdx, tab) {\n            let node = $(`<div class=\"navLeftTab\">\n                            <div class=\"navLeftIcon\" title=\"${tab.name}\">\n                                <i class=\"${tab.icon }\"></i>\n                            </div>\n                            <div class=\"navLeftText\">${tab.name }</div>\n                        </div>`)\n            .appendTo(navLeft)\n            .click( function() {\n                that.activateTab( tab );\n            });\n            tab.node = node;\n        });\n        navLeft.append(($(\"<div class='flexGrowSpacer'/>\")))\n        // Add a toggle button to resize the bar\n        let toggleButton = $(\"<div class='navLeftTab navLeftToggle'><i class='navLeftIcon fal fa-angle-double-left'></i></div>\").appendTo(navLeft);\n        toggleButton.click( ()=> {\n            this.toggleBar();\n        });\n\n\n    }\n\n    // that's all the pages from third party plugins\n    setWorkFolders( folders:string[] ) {\n        this.workFolders = folders;\n    }\n\n    // resize\n    protected resizeBarItems() {\n        if (!this.enabled ||  this.bar.tabs.length ==0 || !this.navBarOpened) return;\n        $(\".navLeftText\").show();\n        let lastTab = this.bar.tabs[this.bar.tabs.length-1].node;\n        let lastPos = lastTab.position().top + lastTab.height() + 20; // some margin 20\n\n    }\n    // sort all items from the tree into the tabs, remove the tabs which are empty\n    protected createTabs() {\n        let that = this;\n\n        let leftOvers:JQuery[] = [];\n\n        $.each( that.bar.tabs, function ( tabIdx, tab) {\n            tab.trees = [];\n        });\n\n        that.bar.tabs.push( {\n            name: \"Other\",\n            icon:\"far fa-window-alt\",\n            mode:TabMode.ShowAsDefault,\n            other:[ ], // categories to hide\n            trees:[] // the content\n        });\n\n        $.each($(\"#projectTree .treeContent > ul\").children(), function( idx, li) {\n            $.each( that.bar.tabs, function ( tabIdx, tab) {\n                let show = true;\n                if (tab.mode == TabMode.HideAsDefault) {\n                    show=false;\n                    $.each( tab.other, function(otherIdx, other) {\n                        if ( $(\".key-\" + other , $(li)).length ) {\n                            show = true;\n                        }\n                    });\n                } else  if (tab.mode == TabMode.ShowAsDefault) {\n                    show=true;\n                    $.each( tab.other, function(otherIdx, other) {\n                        if ( $(\".key-\" + other , $(li)).length ) {\n                            show = false;\n                        }\n                    });\n                }\n\n                if ( show ) {\n                    // add the node to the tab\n                    tab.trees.push( $(li) );\n                    // remember that the node for that key is in the tab\n\n                    let keys =  $(\".refTitle\", $(li))[0].className.split(/\\s+/).filter( function(cls) { return cls.indexOf(\"key-\")==0;});\n                    if (keys.length==1) {\n                        that.rootTabMap[keys[0].replace(\"key-\",\"\")] = tab;\n                    }\n                    return false;\n                } else {\n                    // continue to search\n                    return true;\n                }\n\n            });\n\n        });\n\n        // now remove all the empty ones\n        this.bar.tabs = this.bar.tabs.filter( function(tab) { return tab.trees.length > 0;});\n    }\n\n    // switch tab (from search)\n\n    switchTab( tabName:string ) {\n        if (!this.enabled || !this.bar.tabs.length ) return false ; // nothing to do\n        let tab = this.bar.tabs.filter( tab => tab.name == tabName);\n        if (tab.length ==0) return; // should not happen\n\n        $(\".navLeftIcon\").css(\"background-color\",\"\");\n        $(\".navLeftIcon\", tab[0].node).css(\"background-color\",\"var(--red-500\");\n        $(\".navLeftTabActive\").removeClass(\"navLeftTabActive\");\n        tab[0].node.addClass(\"navLeftTabActive\");\n\n        // hide all\n        $.each($(\"#projectTree .treeContent > ul\").children(), function( idx, li) {\n            $(li).hide();\n        });\n\n        // deactivate others\n        $.each( this.bar.tabs, function(tabIdx, t) {\n            t.isActive=false;\n        });\n\n        // activate the one\n        tab[0].isActive = true;\n        $.each( tab[0].trees, function(liIdx,li) {\n            li.show();\n        });\n\n    }\n    // user clicks on tab\n    protected activateTab( tab:INavigationBarTabRuntime ) {\n        $(\".treeName\").text(tab.name);\n        if (tab.isActive) return;\n\n        // make sure there's no filter\n        ml.Search.cancelSearch();\n\n        $(\".navLeftIcon\").css(\"background-color\",\"\");\n        $(\".navLeftIcon\", tab.node).css(\"background-color\", \"var(--red-500)\");\n        $(\".navLeftTabActive\").removeClass(\"navLeftTabActive\");\n        tab.node.addClass(\"navLeftTabActive\");\n\n        // hide all\n        $.each($(\"#projectTree .treeContent > ul\").children(), function( idx, li) {\n            $(li).hide();\n        });\n\n        // deactivate others\n        $.each( this.bar.tabs, function(tabIdx, t) {\n            t.isActive=false;\n        });\n\n        // activate the one\n        tab.isActive = true;\n        $.each( tab.trees, function(liIdx,li) {\n            li.show();\n        });\n    }\n\n    private getTab( itemId:string ): INavigationBarTabRuntime {\n        // check if it is a 'normal database item' if so take it's category\n        let category = ml.Item.parseRef(itemId).type;\n        // skip the line when getting the breadcrumb\n\n        let bread = category ? app.getCategoryBreadcrumbs(category) : app.getBreadcrumbs(itemId);\n        let butter = bread[bread.length-1];\n\n        return this.rootTabMap[butter];\n    }\n\n\n    private toggleBar() {\n        if (this.navBarOpened) {\n            this.navBarOpened = false;\n        } else {\n            this.navBarOpened = true;\n        }\n\n        localStorage.setItem(\"navBarOpened\", this.navBarOpened ? \"true\" : \"false\");\n        this.resizeWitdh();\n    }\n\n    private resizeWitdh() {\n\n        if (this.navBarOpened) {\n            $(\".navLeftToggle i\").removeClass(\"fal fa-arrow-to-right\").addClass(\"fal fa-arrow-to-left\");\n            $(\"#navLeft\").removeClass(\"navLeftSmall\");\n            $(\".navLeftText\").show();\n            $(\".navLeftTab\").css(\"width\",\"unset\")\n            NavigationBar.navbarWidth = 287;\n        }\n        else {\n            $(\".navLeftToggle i\").removeClass(\"fal fa-arrow-to-left\").addClass(\"fal fa-arrow-to-right\");\n            NavigationBar.navbarWidth = 72;\n            $(\"#navLeft\").addClass(\"navLeftSmall\");\n            $(\".navLeftText\").hide();\n        }\n        app.resizeItem(true);\n\n\n\n    }\n\n    private addHelpButton() {\n        if( this.helpButton)\n            this.helpButton.remove();\n        this.helpButton = $(\"<div class='navLeftHelp dropup'><i class='fal fa-question-circle dropdown-toggle' data-toggle='dropdown'></i>\" + matrixSession.getHelpButton() + \"</div>\").prependTo(\".navbar-brand\");\n\n\n    }\n}\n\nvar NavBar: NavigationBar;\n\nfunction initialize() {\n    NavBar = new NavigationBar();\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\n\nimport { ICategorySettingTextIcon } from \"../../../ProjectSettings\";\nimport { IDB } from \"../../businesslogic/index\";\nimport { ml } from \"../../matrixlib\";\nimport { MyNode, MyNodeData, SelectMode, MyFancytreeOption, MyFancytree } from \"./ProjectViewDefines\";\nimport { ProjectView } from \"./ProjectView\";\nimport { mTM } from \"../../businesslogic/index\";\nimport { NavBar } from \"./NavigationBar\";\nimport { IStringMap, globalMatrix, app } from \"../../../globals\";\nimport { EImportMode } from \"../../businesslogic/ComponentImport\"\n\nexport type { ISearchCounts, ISearchCountsTab };\nexport { ProjectTree };\n\ninterface ISearchCounts {\n    current:number; // number of hits in current tab of navigation bar is visible (or all otherwise)\n    total:number // total number\n    perTab:ISearchCountsTab[] // count per tab\n}\ninterface ISearchCountsTab {\n    tabName:string\n    count:number;\n}\n\nclass ProjectTree {\n\n        private hits:string[] = [];\n        private allHits:string[] = [];\n        private lastFilterFct: (node: Fancytree.FancytreeNode) => boolean;\n        private panel:ProjectView;\n        private canBeFiltered:boolean;\n        private delayedFilter:number;\n        // performance stuff for tree\n        private lt:string; // last added type\n        private lit:string; // last added type's icon text\n\n        private legacyColors:IStringMap = {\n            REQ: \"#0000a4\", // UIToolsConstants.CIColors.BlueEastBay.color,\n            UC: \"#41c9dd\", //UIToolsConstants.CIColors.BlueLagoon.color,\n            SPEC: \"#00a600\", //UIToolsConstants.CIColors.GreenSushi.color,\n            DOC: \"#2a6ac0\", //UIToolsConstants.CIColors.Black.color,\n            SIGN: \"#2a6ac0\", //UIToolsConstants.CIColors.Black.color,\n            REPORT: \"#2a6ac0\", //UIToolsConstants.CIColors.Black.color,\n            RISK: \"#a90000\", // UIToolsConstants.CIColors.RedPersimmon.color,\n            TC: \"#41c9dd\", // UIToolsConstants.CIColors.GreyDark.color\n            TRUN:\"#faebd7\", // special case for legacy TRUN folder icons\n            XTC:\"#faebd7\" // special case for legacy TRUN folder icons\n        }\n    public  alpha: 40;\n\n\n        constructor (panel:ProjectView, canBeFiltered:boolean) {\n            this.panel = panel;\n            this.canBeFiltered = canBeFiltered;\n        }\n        // show the tree\n        show() {\n            this.panel.tree.show();\n        };\n        // hide the tree\n        hide() {\n            this.panel.tree.hide();\n        }\n\n        setSelectedItems(selectedItems:string[]) {\n            let that = this;\n            $.each(selectedItems, function (index, key) {\n                var item = that.getNode(key);\n                if (item) {\n                    item.setSelected();\n                }\n            });\n        }\n\n        applyFilter() {\n            let that = this;\n            if ( this.canBeFiltered && this.lastFilterFct) {\n                    clearTimeout(this.delayedFilter);\n                    that.delayedFilter = window.setTimeout( () => {\n                        this.getFancyTree().filterNodes((node) => this.lastFilterFct(node));\n                    }, 100);\n            }\n        }\n\n        // hotfix one item - not good after the next change in the tree it will be rendered again wrongly\n        redrawItem( itemId:string ) {\n            var node = this.getNode(itemId);\n            if (node) {\n                node.render();\n                var span = $((<MyNode>node).span);\n                if ((<MyNodeData>node.data).isUnselected) {\n                    span.removeClass(\"fancytree-match\");\n                } else  {\n                    span.addClass(\"fancytree-match\");\n                }\n            }\n        }\n        openTree(key:string) {\n             this.getNode(key).setExpanded(true);\n        }\n        closeTree(key:string) {\n             this.getNode(key).setExpanded(false);\n        }\n        selectAll(isSelected:boolean) {\n            let that = this;\n            if (isSelected) {\n                $.each(this.hits, function (hi, hit) {\n                    if ( that.panel.settings.selectMode == SelectMode.auto || !ml.Item.parseRef(hit).isFolder) {\n                        var item = that.getNode(hit);\n                        if (item) {\n                            item.setSelected();\n                        }\n                    }\n                });\n            } else {\n                this.getFancyTree().visit(function(node){\n                    node.setSelected(false);\n                });\n            }\n        };\n\n        // this selects children and in case a folder is selected also the children of the folder\n        selectChildren( node:Fancytree.FancytreeNode ) {\n            let children = node.getChildren();\n            if (!children) {\n                return;\n            }\n            for (let child of children ) {\n                if (!child.isSelected()) {\n                    child.setSelected(true);\n                }\n                if (child.isFolder()) {\n                    this.selectChildren(child);\n                }\n            }\n        }\n        unSelectChildren( node:Fancytree.FancytreeNode ) {\n            let children = node.getChildren();\n            if (!children) {\n                return;\n            }\n            for (let child of children ) {\n                if (child.isSelected()) {\n                    child.setSelected(false);\n                }\n                if (child.isFolder()) {\n                    this.unSelectChildren(child);\n                }\n            }\n        }\n        // this unselects all parents of a item or folder\n        unselectParents( node:Fancytree.FancytreeNode ) {\n            let parent = node.getParent();\n            if (!parent) {\n                return;\n            }\n            if (parent.isSelected()) {\n                parent.setSelected(false);\n                this.unselectParents( parent );\n            }\n        }\n\n        setHideMismatches( hideMismatches:boolean ) {\n            var currentMode = (<MyFancytreeOption>(<MyFancytree>this.getFancyTree()).options).filter.mode;\n            var nextMode = hideMismatches?\"hide\":\"dimm\";\n\n            if (currentMode === nextMode) {\n                return;\n            }\n\n            (<MyFancytreeOption>(<MyFancytree>this.getFancyTree()).options).filter.mode = nextMode;\n            this.getFancyTree().clearFilter();\n        }\n\n        forcePartial() {\n\n            function _walk(node){\n                let i, l, child, someSelected,\n                    children = node.children;\n\n                if( children && children.length ){\n                    // check all children recursively\n                    someSelected = false;\n\n                    for( i=0, l=children.length; i<l; i++ ){\n                        child = children[i];\n                        // the selection state of a node is not relevant; we need the end-nodes\n                        if( _walk(child)  ) {\n                            someSelected = true;\n                        }\n                    }\n\n                    if ( someSelected && !node.selected) {\n                        $(node.span).addClass(\"fancytree-partsel\");\n                        node.extraClasses = \"fancytree-partsel\";\n                    } else {\n                        $(node.span).removeClass(\"fancytree-partsel\");\n                        node.extraClasses = \"\";\n                    }\n                }\n                return someSelected || !!node.selected;\n            }\n\n            let tree = (<any>this.getFancyTree());\n            _walk(tree.rootNode);\n        }\n        filterTree( match?:string ):ISearchCounts {\n            let that=this;\n\n            this.hits=[];\n            this.allHits=[];\n            let total = 0;\n            if ( match ) {\n                var treeMatch = (match + \"\").replace(/([.?*+\\^\\$\\[\\]\\\\(){}|-])/g, \"\\\\$1\"); // make sure a '.' is treated literally\n                var treeMatchRegEx = new RegExp(\".*\" + treeMatch + \".*\", \"i\");\n\n                this.lastFilterFct = function treeFilter(node: Fancytree.FancytreeNode) {\n                    if ((<MyNodeData>node.data).isUnselected) {\n                        // project label filter\n                        return false;\n                    }\n\n                    var sel = (!that.panel.prefixCategory || ml.Item.parseRef(node.key).type == that.panel.prefixCategory) && !!treeMatchRegEx.exec(node.title);\n\n                    if (sel) {\n                        this.allHits.push(node.key);\n                        total++;\n                        if (that.panel.settings.isMainTree) {\n                            sel = NavBar.isInCurrentTab( node.key );\n                        }\n                        if (sel) {\n                            that.hits.push(node.key);\n                        }\n                    }\n\n                    return sel;\n                };\n\n                this.canBeFiltered && (<Fancytree.Fancytree>this.getFancyTree()).filterNodes( (node:Fancytree.FancytreeNode) => this.lastFilterFct(node) );\n\n                // after rendering the tree: maybe open to see all leafs\n                if (this.panel.viewModeSelector.isExpandTree()) {\n                    this.getFancyRootNode().visit(function(node:Fancytree.FancytreeNode){\n                        if (node.isFolder() && (<MyNode>node).subMatch || !that.panel.viewModeSelector.hideMismatches()) {\n                            node.setExpanded((<MyNode>node).subMatch?true:false, {noAnimation: true, noEvents: true, scrollIntoView: false});\n                        }\n                    });\n                }\n                return {current:this.hits.length, total:total, perTab:NavBar.countPerTab(this.allHits)};\n\n            } else {\n                // just in case\n                let total = this.removeFilter();\n                return  {current:total, total:total, perTab:NavBar.countPerTab(this.hits)};\n            }\n        }\n\n        removeFilter() {\n            let that=this;\n\n            this.hits=[];\n\n            // just apply global filters (no expanding)\n            this.lastFilterFct = function treeFilter(node: Fancytree.FancytreeNode) {\n                if ((<MyNodeData>node.data).isUnselected) {\n                    // project label filter\n                    return false;\n                }\n                that.hits.push(node.key);\n                return true;\n            };\n\n            this.canBeFiltered && this.getFancyTree().filterNodes( (node) => this.lastFilterFct(node) );\n            return this.hits.length;\n        }\n        showSearchResults( serverSearchResults:string[] ):ISearchCounts {\n            let that = this;\n\n            this.hits=[];\n            let countAll = 0;\n\n            this.lastFilterFct = function treeFilter(node: Fancytree.FancytreeNode) {\n                if ((<MyNodeData>node.data).isUnselected) {\n                    return false;\n                }\n\n                if (serverSearchResults.length > 0) {\n                    let sel = serverSearchResults.indexOf(node.key) !== -1;\n                    if ( sel ) {\n                        countAll++;\n                        if (that.panel.settings.isMainTree) {\n                            sel = NavBar.isInCurrentTab( node.key );\n                        }\n                        if (sel) {\n                            that.hits.push(node.key);\n                        }\n                    }\n                    return sel;\n                }\n                return false;\n            };\n\n            this.canBeFiltered && this.getFancyTree().filterNodes( (node) => this.lastFilterFct(node));\n\n            // after rendering the tree: maybe open to see all leafs\n            if (this.panel.viewModeSelector.isExpandTree()) {\n                this.getFancyRootNode().visit(function(node:Fancytree.FancytreeNode){\n                    node.setExpanded((<MyNode>node).subMatch?true:false);\n                });\n            }\n            return {current:this.hits.length, total:countAll, perTab:NavBar.countPerTab(serverSearchResults)};\n        };\n\n        getFancyRootNode():Fancytree.FancytreeNode {\n            return <Fancytree.FancytreeNode>this.panel.tree.fancytree(\"getRootNode\");\n        }\n        getFancyTree():Fancytree.Fancytree {\n            return <Fancytree.Fancytree>this.panel.tree.fancytree(\"getTree\");\n        }\n        getNode(key:string):Fancytree.FancytreeNode {\n            return this.getFancyTree().getNodeByKey(key);\n        }\n        removeNode(key:string){\n            this.getNode(key).remove();\n        }\n\n        setTitle(key:string, title:string):boolean {\n            try {\n                var node = <MyNode>this.getNode(key);\n                if (node) {\n                    var changed =  title !== node.shortTitle;\n\n                    if (node.data) {\n                        if ( title == (<MyNodeData>node.data).shortTitle) {\n                            changed = false;\n                        }\n                        var foldertext = $(\".refTitle span:not(.highlight)\",node.span);\n                        if (node.folder && foldertext.length !== 0 ) {\n                            (<MyNodeData>node.data).shortTitle = foldertext[0].outerHTML + title;\n                        }\n                        else {\n                            (<MyNodeData>node.data).shortTitle = title;\n                        }\n                    }\n                    node.shortTitle = title;\n                    node.title = node.folder ? title : (node.key + \" \" + title);\n\n                    return changed;\n                }\n            } catch( exp) {\n\n            }\n            return false;\n        }\n\n        select(key:string) {\n            var ft = this.getFancyTree();\n\n            NavBar.activateItemsTab(key);\n            if (this.panel.tree.is(\":visible\")) {\n                // if the tree is not visible it throws an exception, because of option to auto activate\n                ft.activateKey(key);\n            } else {\n                (<MyFancytree>ft).options.autoScroll = false;\n                ft.activateKey(key);\n                (<MyFancytree>ft).options.autoScroll = true;\n            }\n        }\n\n        isSelected(key:string):boolean {\n            let treeNode = this.getNode(key);\n            return treeNode.isActive();\n        }\n\n         // private functions\n\n        updateRec (item:IDB) {\n            let treeNode = this.getNode(item.id);\n            treeNode.title = item.title;\n            if (item.children) {\n                // recreate children\n                treeNode.children = [];\n                this.addNodes(treeNode, item.children);\n            }\n        }\n        insertRec (parentKey:string, item:IDB) {\n            let parent = this.getNode(parentKey);\n            if (!parent.children) {\n                parent.children = [];\n            }\n\n            for (var idx=0;idx<parent.children.length;idx++) {\n                if (parent.children[idx].key === item.id) {\n                    // replace child\n                    this.updateRec(item);\n                    return;\n                }\n            }\n            // create a new child and replace\n            var nn = this.addNode(parent, item);\n            this.updateRec( item );\n        }\n        moveNode(parentId:string, itemId:string, position:number) {\n            let parentNode = this.getNode(parentId);\n\n            let itemNode = this.getNode(itemId);\n            // remove from current parent\n            let oldParent = itemNode.parent;\n            oldParent.children = oldParent.children.filter( function(child) {\n                return child.key != itemId;\n            });\n            // insert in new place\n            if (!parentNode.children) {\n                parentNode.children = [];\n            }\n            if (position >= parentNode.children.length) {\n                parentNode.children.push(itemNode);\n            } else {\n                parentNode.children.splice(position, 0, itemNode);\n            }\n            itemNode.parent = parentNode;\n        }\n        addNode(treeNode:Fancytree.FancytreeNode , item:IDB, position?:{at:number}): Fancytree.FancytreeNode {\n\n            var newNode: Fancytree.FancytreeNode;\n\n            if (item.hasOwnProperty(\"children\") === true) { // a folder\n\n                if (item.type !== this.lt) {\n                    this.lit = \"\";\n                    var icontext = \"\";\n                    var param = <ICategorySettingTextIcon>globalMatrix.ItemConfig.getCategorySetting(item.type, 'texticon');\n                    if (param) {\n                        param =<any> ml.JSON.mergeOptions({color: 'black', text: item.type}, param);\n                        let color = ml.UI.standardizeColor(param.color, this.alpha); // add alpha\n                        let style = '';\n                       // if( item.id.endsWith(\"-1\") && item.id.startsWith(\"F-\") )\n                            style = `style=\"background-color: ${color};\"`\n                        this.lit = '<span class=\"fancytree-icontext\" ' + style +  '>' + param.text + '</span>';\n                    }\n                }\n\n                var icontext = this.lit;\n                let hasIconText = icontext;\n                // hack for test runs of type TRUN\n                if (typeof mTM !== 'undefined' && mTM.isXTC(item.type)) { // this is a XTC type\n                    if (treeNode.parent) {\n                        // not the top level TRUN but a TRUN,...\n\n                        icontext = icontext?icontext:('<span class=\"fancytree-icontext fancytree-iconxtc\"  style=\"color: ' + 'grey' + ';\">' + 'RUN' + '</span>');\n                        var tp = item.title.indexOf(\"(F-\"); // e.g. The system is delivered (F-TC-6)\n                        if (!hasIconText && tp !== -1) {\n                            // most likely this is an executed folder... try to get information from where it comes from\n                            var te = item.title.indexOf(\"-\", tp + 3);\n                            if (te !== -1) {\n                                let category = item.title.substr(tp + 3, te - tp - 3); // -> TC\n                                var source = app.getTree([category]);\n                                if (source && source.length === 1) {\n                                    item.icon = source[0].icon;\n                                    icontext = \"\";\n                                    var param = <ICategorySettingTextIcon>globalMatrix.ItemConfig.getCategorySetting(category, 'texticon');\n                                    if (param) {\n                                        param = <any>ml.JSON.mergeOptions({color: 'black', text: category}, param);\n                                        let color = ml.UI.standardizeColor(param.color,this.alpha); // add alpha\n                                        icontext = '<span class=\"fancytree-icontext fancytree-iconxtc\" style=\"background-color: ' + color + '; b\">' + param.text + '</span>';\n                                    }\n                                }\n                            }\n                        }\n                    } else {\n                        icontext = icontext?icontext:('<span class=\"fancytree-icontext fancytree-iconxtc\" style=\"background-color: ' + this.legacyColors[\"TRUN\"]  + ';\">' + \"TRUN\" + '</span>');\n                    }\n                } else if (!hasIconText && item.type && this.legacyColors[item.type]) {\n                    let color = ml.UI.standardizeColor(this.legacyColors[item.type],this.alpha); // add alpha\n\n                    icontext = '<span class=\"fancytree-icontext fancytree-iconxtc\" style=\"background-color: ' +color + ';\">' + item.type + '</span>';\n                }\n                let nodeData = <Fancytree.NodeData>{\n                    shortTitle: icontext + item.title, // as displayed\n                    title: item.title, // this is not displayed but used for searches\n                    key: item.id,\n                    type: item.type,\n                    background: item.background,\n                    border: item.border,\n                    cstrender: true,\n                    folder: true,\n                    hideCheckbox: this.panel.settings.selectMode == SelectMode.none\n                        || (this.panel.settings.selectMode == SelectMode.items || this.panel.settings.selectMode == SelectMode.singleItem  ),\n                    isUnselected: item.isUnselected,\n                    icon:icontext?false:item.icon,\n                    extraStyle: item.extraStyle,\n                    mode: item.mode // copy mode over if it's set (it's coming from the server: EImportMode.Copy or EImportMode.Import)\n                };\n\n                if (item.iconClass) {\n                    (<any>nodeData).icon = true;\n                    nodeData.iconclass = item.iconClass + \" fancy-icon\";\n                }\n                if (item.mode == EImportMode.Include || item.mode == EImportMode.IncludeRoot) {\n                    (<MyNodeData>nodeData).shortTitle = `<i class=\"fal fa-external-link-alt importedFolder\"></i>` +  (<MyNodeData>nodeData).shortTitle;\n                }\n                newNode = treeNode.addChildren(nodeData);\n                this.addNodes(newNode, item.children);\n\n                let hasNotLatest = false;\n                $.each(newNode.children, function(cidx, child) {\n                    if (child.extraClasses && child.extraClasses.indexOf(\"notLatest\")!=-1) {\n                        hasNotLatest = true;\n                    }\n                });\n                if ( hasNotLatest ) {\n                    newNode.extraClasses = newNode.extraClasses?(newNode.extraClasses + \"notLatest\"):\"notLatest\";\n                }\n\n            } else {\n                let fn = <Fancytree.NodeData>{\n                    shortTitle: item.title, // as displayed\n                    title: item.id + \" \" + item.title, // this is not displayed but used for searches\n                    key: item.id,\n                    cstrender: true,\n                    type: item.type,\n                    isUnselected: item.isUnselected,\n                    extraStyle: item.extraStyle,\n                    mode: item.mode // copy mode over if it's set\n                }\n\n                if (item.icon) {\n                    fn.icon = item.icon;\n                    fn.extraClasses = \"fancy-icon\";\n                }\n                if (item.iconClass) {\n                    fn.iconclass = item.iconClass + \" fancy-icon\";\n                }\n                if (item.mode == EImportMode.Include) {\n                    (<any>fn).icon = true;\n                    fn.iconclass =\"fal fa-external-link-alt importedItem\";\n                }\n                if ( item.version && item.version.split(\"/\")[0] !=  item.version.split(\"/\")[1] ) {\n                    fn.extraClasses = fn.extraClasses?(fn.extraClasses + \"notLatest\"):\"notLatest\";\n                }\n                newNode = treeNode.addChildren(fn);\n            }\n\n            if (position && position.at < treeNode.children.length) {\n                var newChild = treeNode.children[treeNode.children.length - 1];\n                treeNode.children.splice(treeNode.children.length - 1, 1);\n                treeNode.children.splice(position.at, 0, newChild);\n            }\n\n            return newNode;\n        }\n\n        treeFromDb( dbTree:IDB[] ) {\n            this.lt = \"\";\n            this.addNodes(this.getFancyRootNode(), dbTree);\n        }\n\n        updateItemIsUnselected(itemId:string, isUnselected:boolean):boolean {\n            try {\n                var node = this.getNode(itemId);\n                if (node) { // sometimes the node does not yet exist, e.g. when creating a signed doc\n                    if ( (<MyNodeData>node.data).isUnselected !== isUnselected) {\n                        (<MyNodeData>node.data).isUnselected = isUnselected;\n                        return true;\n                    }\n                }\n            } catch(exp) {\n                // mobile client has no tree...\n            }\n            return false;\n        }\n\n        updateNotificationCounters() {\n            (<any>this.getFancyTree()).updateNotificationCounters();\n        }\n\n         private addNodes(treeNode:MyNodeData, obj:IDB[]) {\n            let that = this;\n             $.each(obj, function(idx:number, idb:IDB) {\n                that.addNode(treeNode, idb);\n            });\n        }\n}\n","export { EImportMode };\r\n\r\nenum EImportMode  {\r\n    Include = \"include\", \r\n    Copy = \"copy\",\r\n    IncludeRoot = \"recipient_folder_include\"\r\n}","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ml } from \"../../matrixlib\";\nimport { ISearchCounts } from \"./ProjectTree\";\nimport { SearchState, IDelayedAction } from \"./ProjectViewDefines\";\nimport { ProjectView } from \"./ProjectView\";\n\nimport { UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\";\nimport { NavBar } from \"./NavigationBar\";\nimport { app, globalMatrix, matrixSession } from \"../../../globals\";\nimport {LabelSwitches} from \"../Parts/LabelSwitches\";\nimport {plugins} from \"../../businesslogic\";\n\nexport { SearchBox };\n\nclass SearchBox {\n    private spinnerServerSearch:number;\n    private currentStatus: SearchState;\n    private currentResults:string[];\n    private currentSearchExpression:string;\n    private delayedAction:IDelayedAction;\n    private panel:ProjectView;\n    private filterHighlight_timeout:number; // timeout for highlighting while filtering\n    private filterSearch_timeout:number; // timeout for search while filtering\n    private searchMetaInfo:JQuery;\n    private isEnabled:boolean;\n    private isConfigSearch :boolean;\n    private savedSearchIndex = -1;\n\n    constructor( panel:ProjectView) {\n        this.panel = panel;\n\n        this.currentStatus = SearchState.NoSearch;\n        this.currentResults = []; // results from server (\n        this.currentSearchExpression = \"\"; // no search expression\n        this.delayedAction = null;\n\n        this.isEnabled = false;\n        this.isConfigSearch = false;\n    }\n\n    // after a resize fix display...\n    updateHeights() {\n\n        this.isEnabled && this.updateSearchStatusHeights();\n    }\n\n    renderSearchField(searchBox: JQuery, enableServerSearch: boolean, highlightResults: boolean, isConfigSearch: boolean, currentFilterContainer: JQuery) {\n        let that = this;\n\n        this.isEnabled = true;\n        that.isConfigSearch = isConfigSearch;\n\n        var inputSpace = $('<div class=\"mrqlSearchInputContainer\">');\n        var inputCtrl = $('<input  data-cy=\"mrqlSearchInput\" autocomplete=\"off\" type=\"text\" autofocus=\"autofocus\" name=\"search\" placeholder=\"Search...\" class=\"form-control searchNoX\">');\n        searchBox.append(inputSpace.append(inputCtrl));\n\n        // clear input field\n        inputSpace.append('<span data-cy=\"searchClear\" name=\"clear\" class=\"fal fa-times-circle filter-clear-x\"></spans>');\n        $(\"span[name=clear]\", searchBox).click(function(evt) {\n            ml.Search.hideHighlight();\n            $(\"input[name=search]\", searchBox).val(\"\").focus();\n            that.resetSearch();\n        }); // icon left of search server button inside the text input field\n\n        // add box for server search\n        if (enableServerSearch) {\n            var ss = this.getMiracleControl(inputCtrl);\n            searchBox.append(ss);\n        }\n\n         if(ml.LabelTools.getLabelDefinitions(null).length > 0 ){\n             // add Global filter\n             this.addGlobalFilter(searchBox, currentFilterContainer);\n         }\n\n\n\n        // handle filter / search input field\n        $(\"input[name=search]\", searchBox).keyup(function(e: JQueryEventObject) {\n\n            clearTimeout(that.filterSearch_timeout);\n            clearTimeout(that.filterHighlight_timeout);\n\n            // get search string\n            let untrimmed = $(e.delegateTarget).val();\n            let trimmed = $.trim($(e.delegateTarget).val());\n\n            if ( that.setPrefixCategory( untrimmed ) ) {\n                untrimmed = untrimmed.substr(that.panel.prefixCategory.length+1);\n                trimmed = trimmed.substr(that.panel.prefixCategory.length+1);\n                if ( trimmed.length == 0) {\n                    // just a prefix has been type, e.g. REQ:\n                    return;\n                }\n            }\n\n            // user hit return\n            if (e && e.keyCode === 13 && !isConfigSearch) {\n                // run fulltext search\n                that.savedSearchIndex  = -1;\n                that.search(trimmed, highlightResults);\n                that.addToSavedSearch(trimmed,searchBox);\n                return;\n            }\n            if (e && e.keyCode ===38)\n            {\n                let savedSearchLength = $(\".savedSearch\").length;\n                if( savedSearchLength > 0)\n                {\n                    that.savedSearchIndex ++;\n                    let  newVal = $(\".savedSearch\",searchBox)[that.savedSearchIndex % savedSearchLength ].innerText ;\n                    let textField = $(\".searchNoX\",searchBox);\n                   $(document).ready(()=>{\n                    textField.val( newVal);\n                   }) ;\n\n\n                }\n\n            }\n\n            if (e && e.keyCode ===40)\n            {\n                let savedSearchLength = $(\".savedSearch\").length;\n                if( savedSearchLength > 0)\n                {\n                    e.preventDefault();\n                    that.savedSearchIndex --;\n                    if( that.savedSearchIndex < 0)\n                    {\n                        that.savedSearchIndex = savedSearchLength-1;\n                    }\n\n\n                    console.log( that.savedSearchIndex );\n                    let  newVal = $(\".savedSearch\",searchBox)[that.savedSearchIndex % savedSearchLength ].innerText ;\n                    let textField = $(\".searchNoX\",searchBox);\n                    $(document).ready(()=>{\n                        textField.val( newVal);\n                       }) ;\n\n\n                }\n\n            }\n\n\n\n            if (e && e.keyCode === 32 && trimmed.toLowerCase().indexOf(\"mrql\") === -1 && app.getItemTitle(trimmed.toUpperCase())) {\n                if ( searchBox.closest(\"#projectTree\").length === 1) {\n\n                    that.panel.select(trimmed.toUpperCase());\n                    $(\"input[name=search]\", searchBox).val(\"\");\n                    ml.Search.hideHighlight();\n                    that.resetSearch();\n                    return;\n                }\n            }\n            if (e && e.which === $.ui.keyCode.ESCAPE || trimmed === \"\") {\n                $(\"input[name=search]\", searchBox).val(\"\");\n                that.resetSearch();\n                ml.Search.hideHighlight();\n                that.panel.resizeItem();\n                return;\n            }\n            // Pass text as filter string (will be matched as substring in the node title)\n            if (untrimmed.indexOf(\"mrql:\")!=0) {\n                that.filterSearch_timeout = window.setTimeout(function() {\n                    that.filter(untrimmed);\n                    that.panel.resizeItem();\n\n                    if (highlightResults) {\n                        // highlight again (the filtering above removes the highlights from the tree)\n                        clearTimeout(that.filterHighlight_timeout);\n\n                        that.filterHighlight_timeout = window.setTimeout(function() {\n                            ml.Search.highlight(trimmed);\n                        }, 100);\n\n                    }\n                    // instead of hard coded timeouts allow to overwrite per pc\n                    // serverStorage.setItem(\"timeoutSearch1\",2000)) less than 2 letters entered. default 3000ms\n                    // serverStorage.setItem(\"timeoutSearch2\",4000)) 2+ letters entered . default 3000ms\n                }, (trimmed && trimmed.length > 2) ? Number(globalMatrix.serverStorage.getItemDefault(\"timeoutSearch2\", \"600\")) : Number(globalMatrix.serverStorage.getItemDefault(\"timeoutSearch1\", \"1200\")));\n\n\n                if (highlightResults) {\n                    // wait a bit and highlight in main page\n\n                    clearTimeout(that.filterHighlight_timeout);\n                    that.filterHighlight_timeout = window.setTimeout(function() {\n                        ml.Search.highlight(trimmed);\n                    }, 300);\n                }\n            }\n        }).focus();\n\n        // add search status info\n        // checkbox to select all\n        this.searchMetaInfo = $(\"<div class='searchMetaInfo'>\");\n        this.searchMetaInfo.append($('<div class=\"searchResultInfo\">'));\n        if (!this.panel.settings.singleSelect)\n            this.searchMetaInfo.append($(\"<div class='searchResultSelect'>\")\n                    .append('<label><input data-cy=\"searchSelectAll\" type=\"checkbox\"><span style=\"font-weight:normal;font-style:italic;padding-left:10px\">Un/Select all</span></label>'));\n        this.searchMetaInfo.append($(\"<div class='searchResultWaiting'>\").append(ml.UI.getSpinningWait(\"searching...\")));\n        this.searchMetaInfo.children().hide();\n        this.searchMetaInfo.insertAfter(searchBox);\n\n        $(\"input\", this.searchMetaInfo).click(function(event: JQueryEventObject) {\n            that.panel.toggleSelection($(event.delegateTarget).prop(\"checked\"));\n        });\n    }\n\n    private setPrefixCategory( searchExpression:string ):boolean {\n        let that = this;\n        that.panel.prefixCategory = \"\";\n        $.each(globalMatrix.ItemConfig.getCategories(), function (idx, cat) {\n            if (searchExpression.toUpperCase().indexOf(cat.toUpperCase() + \":\")==0) {\n                that.panel.prefixCategory = cat;\n            }\n        });\n        return that.panel.prefixCategory != \"\";\n    }\n    // renders a tree or a list, with or without checkboxes\n    // refresh only is set if the tree changes, rather than the search\n    render() {\n        let that = this;\n\n        if (!this.isEnabled) {\n            return;\n        }\n        if ( this.currentStatus === SearchState.NoSearch ) {\n\n            this.showSearchStatus(-1, true);\n\n            // render as tree control\n            this.panel.listView.hide();\n            this.panel.projectTree.show();\n            // make sure nothing is hidden or dimmed\n            this.panel.projectTree.setHideMismatches(false);\n            // render the tree without any filters\n            this.panel.projectTree.removeFilter();\n\n\n\n        } else if ( this.currentStatus === SearchState.ServerRunning ) {\n            // user might click faster than server can react\n            this.delayedAction = {\n                type:\"render\",\n                expression:null\n            };\n            return;\n        } else if ( this.currentStatus === SearchState.FilterDone ) {\n\n            // this is a local filtering: do it\n            if ( this.panel.viewModeSelector.showAsList())  {\n                // render as list control\n                this.panel.listView.show();\n                this.panel.projectTree.hide();\n                // show results\n                let matches = this.panel.listView.filterList(this.currentSearchExpression);\n\n                that.showMatches( matches, true );\n            } else {\n                // render as tree control\n                this.panel.listView.hide();\n                this.panel.projectTree.show();\n                // hide or dim\n                this.panel.projectTree.setHideMismatches(this.panel.viewModeSelector.hideMismatches());\n                // render the tree with current filter\n                var matches = this.panel.projectTree.filterTree(this.currentSearchExpression);\n                that.showMatches( matches, true );\n            }\n        } else if ( this.currentStatus === SearchState.ServerDone ) {\n\n            // this is a local filtering: do it\n            if ( this.panel.viewModeSelector.showAsList())  {\n                // render as list control\n                this.panel.listView.show();\n                this.panel.projectTree.hide();\n                // show results\n                let actualResults = this.panel.listView.showSearchResults(this.currentResults);\n                that.showMatches( actualResults, false );\n            } else {\n                // render as tree control\n                this.panel.listView.hide();\n                this.panel.projectTree.show();\n                // hide or dim\n                this.panel.projectTree.setHideMismatches(this.panel.viewModeSelector.hideMismatches());\n                // render the tree with current filter\n                let actualResults = this.panel.projectTree.showSearchResults(this.currentResults);\n                that.showMatches( actualResults, false );\n            }\n        }\n\n    };\n\n    protected showMatches(matches:ISearchCounts, localSearch:boolean) {\n\n        let diff = matches.total - matches.current;\n        let details = \"\";\n        if (diff) {\n            details = \"There are \" + diff + \" hits in other tabs:\";\n            details += \"<ul>\";\n            for (let tab of matches.perTab) {\n                if (tab.tabName == NavBar.getCurrentTab())  {\n                    details += `<li><span class=\"\" data-tab=\"${tab.tabName}\">${tab.tabName} ${tab.count} matches</span></li>`;\n                } else {\n                    details += `<li><span class=\"searchResultTabLink\" data-tab=\"${tab.tabName}\">${tab.tabName} ${tab.count} matches</span></li>`;\n                }\n            }\n            details += \"</ul>\";\n        }\n        this.showSearchStatus(matches.current, localSearch, details);\n    }\n    // resets the search\n    resetSearch () {\n        $(\".searchVizMode\", this.panel.getRoot()).hide();\n        this.panel.viewModeSelector.setEnabled(false);\n        this.currentResults = []; // No results\n        this.currentSearchExpression = \"\";\n        // always render as tree:\n        this.currentStatus = SearchState.NoSearch;\n        this.render();\n    };\n\n    private getMiracleControl(textField:JQuery):JQuery {\n            let that = this;\n\n            let btn_grp = $('<div class=\"rowFlex\" style=\"\">');\n\n            let mir_btn = $('<span class=\"mrqlSearchIcon\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Fulltext search on server\"><i style=\"\" class=\"fal fa-search\"></span>');\n            mir_btn.appendTo($(\".mrqlSearchInputContainer\"));\n            btn_grp.append( '<span class=\"btn btn-ssearch\" data-cy=\"searchBoxMrqlDP\"  type=\"button\" data-toggle=\"dropdown\"><span class=\"fal fa-chevron-down\"></span></span>');\n\n        let config = globalMatrix.ItemConfig.getSearchConfig();\n            if (!config || !config.searches || config.searches.length === 0) {\n                config = {searches: [{name:\"outdated links\", expr:\"mrql:outdated=1\"},\n                {name:\"last week\", expr:\"mrql:updated<1w\"},\n                {name:\"failed tests\", expr:'mrql:\"test run result\"~\"error\"'}]};\n            } else {\n                // sort\n                $.each( config.searches, function (idx, st) {\n                    st.name = st.name.split(\"'\").join('\"');\n                    st.expr = st.expr.split(\"'\").join('\"');\n                });\n            }\n\n            let ul = $(' <ul id=\"savedSearches\" class=\"dropdown-menu dropdown-menu-sub pull-right role=\"menu\"> ');\n\n            for ( let idx=0; idx<config.searches.length; idx++) {\n               let li = $('<li data-cy=\"serverSearchExp\" title=\"'+ config.searches[idx].expr + '\"><a href=\"javascript:void(0)\">' + config.searches[idx].name +'</a></li>');\n                ul.append(li);\n                li.click( function(event: JQueryEventObject) {\n                    if (that.panel.settings.highlight) {\n                        // wait a bit and highlight\n                        window.setTimeout(function() {\n                            ml.Search.highlight($(event.delegateTarget).data(\"mrql\"));\n                        }, 50);\n                    }\n                    textField.val($(event.delegateTarget).data(\"mrql\"));\n                    that.search( $(event.delegateTarget).data(\"mrql\") );\n                }).data(\"mrql\",config.searches[idx].expr)\n            }\n            let help = $('<li class=\"miracleHelp\" title=\"Miracle Help\" ><a class=\"documentationLink\" href=\"javascript:void(0)\">Miracle Help</a></li>');\n            ul.append(help);\n            help.click(function() {\n               window.open(\"https://urlshort.matrixreq.com/d23/manual/miracle\");\n            });\n\n            let items = that.getSavedSearches();\n            items.forEach((item)=>{\n                item = decodeURIComponent(item);\n                let li = $(\"<li/>\").attr(\"title\",item).append($('<a class=\"savedSearch\" href=\"javascript:void(0)\"/>').text(item));\n                ul.append(li);\n                li.click( function(event: JQueryEventObject) {\n                    textField.val(event.currentTarget.textContent);\n                    var e = $.Event('keyup');\n                    e.keyCode = 13; // Enter key\n                    textField.trigger(e);\n\n                }).data(\"mrql\",item);\n            });\n\n\n        let pluginsSearchInjection = plugins.getCustomSearches();\n        if( pluginsSearchInjection.length > 0){\n            ul.append($('<li class=\"divider\"></li>'));\n            for(let ps of pluginsSearchInjection) {\n                let li = $('<li data-cy=\"serverSearchExp\" title=\"' + ps.menu + '\"><a href=\"javascript:void(0)\">' + ps.menu + '</a></li>');\n                ul.append(li);\n                li.click(async (event: JQueryEventObject) => {\n                    this.currentStatus = SearchState.ServerRunning;\n                    this.render();\n                     await ps.search((itemIds: string[]) => {\n                        that.panel.tree.fancytree(\"getTree\").visit(function (node: Fancytree.FancytreeNode) {\n                            this.currentStatus = SearchState.ServerDone;\n                            if (itemIds.indexOf(node.key) != -1) {\n                                that.currentResults.push(node.key);\n                            }\n                            that.render();\n                        });\n                    });\n                });\n            }\n        }\n\n\n            ul.css(\"max-width\",$('#sidebar').width() -10  + \"px\");\n\n            btn_grp.append( ul );\n\n\n            $(\"i\", mir_btn).click( () => {\n\n                that.doSearch(textField);\n\n            });\n\n            return btn_grp;\n        }\n    doSearch(textField:JQuery){\n        let that = this;\n        let searchExpression = textField.val();\n        if ( that.setPrefixCategory(searchExpression)) {\n            searchExpression = searchExpression.substr(that.panel.prefixCategory.length+1);\n        }\n        that.search( searchExpression );\n        that.addToSavedSearch(searchExpression,textField.parent().parent() )\n    }\n    addToSavedSearch(str:string, filter:JQuery){\n        let that = this;\n        let items = that.getSavedSearches();\n        str = str.trim();\n        let strEncoded =encodeURIComponent(str);\n        if( str.length == 0)\n        {\n            return\n        }\n        let strIndex = items.indexOf(strEncoded);\n        let decodedStr= decodeURIComponent(str);\n\n        let def = $.Deferred();\n\n        if( strIndex !=- 1 )\n        {\n            items.splice(strIndex,1);\n            $().ready(()=>{\n                $(\"li[title='\"+decodedStr +\"']\", filter).remove();\n            })\n        }\n\n        items.unshift(strEncoded)\n        items.splice(10);\n        globalMatrix.projectStorage.setItem(\"savedSearches\", JSON.stringify(items), false);\n        $().ready(()=>{\n            let li = $(\"<li/>\").attr(\"title\",decodedStr).append($('<a class=\"savedSearch\" data-cy=\"localSearchExp\" href=\"javascript:void(0)\"/>').text(decodedStr));\n            li.insertAfter($(\".miracleHelp\",filter));\n            li.click( function(event: JQueryEventObject) {\n\n                let textField = $(\".searchNoX\",filter);\n                textField.val(decodeURIComponent(str));\n                    textField.val($(event.delegateTarget).data(\"mrql\"));\n                    var e = $.Event('keyup');\n                    e.keyCode = 13; // Enter key\n                    textField.trigger(e);\n            }).data(\"mrql\",decodedStr);\n        });\n\n\n    }\n    getSavedSearches():string[] {\n\n        let items:string[] = undefined\n        if (globalMatrix.projectStorage)\n        {\n            let itemsString = globalMatrix.projectStorage.getItem(\"savedSearches\", true);\n            if(itemsString && itemsString != \"\")\n            {\n                items = JSON.parse(itemsString);\n                if( items != undefined)\n                {\n                    return items;\n                }\n\n            }\n        }\n\n        return items ?? [] ;\n\n    }\n\n    // runs a local search\n    private filterAgainExpression:string;\n    private filter(filterExpression:string) {\n        this.filterAgainExpression = filterExpression;\n        this.filterAgain();\n    }\n\n    private filterAgain() {\n\n        if ( this.currentStatus === SearchState.ServerRunning ) {\n            // user might click faster than server can react\n            this.delayedAction = {\n                type:\"filter\",\n                expression:this.filterAgainExpression\n            };\n            return;\n        }\n\n        if ( this.filterAgainExpression === \"\" ) {\n            this.resetSearch();\n            return;\n        }\n        this.panel.viewModeSelector.setEnabled(true);\n\n        this.currentStatus = SearchState.FilterDone;\n        this.currentSearchExpression = this.filterAgainExpression;\n        this.render();\n    };\n\n    // runs a server search\n    private search (searchExpression:string, highlightResults?:boolean) {\n        var that = this;\n        $(\".searchVizMode\", this.panel.getRoot()).show();\n        searchExpression = searchExpression.replace(/_me_/g, matrixSession.getUser());\n        searchExpression = searchExpression.replace(/_this_/g, app.getCurrentItemId());\n\n        if ( this.currentStatus === SearchState.ServerRunning ) {\n            // user might click faster than server can react\n            this.delayedAction = {\n                type:\"server\",\n                expression:searchExpression\n            };\n            return;\n        }\n\n        this.delayedAction = null;\n\n        this.panel.viewModeSelector.setEnabled(true);\n\n        if ( searchExpression === \"\" ) {\n            this.resetSearch();\n            return;\n        }\n        this.currentResults = [];\n        this.currentStatus = SearchState.ServerRunning;\n\n\n        this.showSearchStatus(-3, true);\n\n        app.searchAsyncMinimalOutput(searchExpression\n            .replace(\"descendant=*\", \"descendant=\" + app.getCurrentItemId())\n            .replace(\"ancestor=*\", \"ancestor=\" + app.getCurrentItemId())\n            .replace(\"parent=*\", \"parent=\" + app.getCurrentItemId())\n            .replace(\"child=*\", \"child=\" + app.getCurrentItemId()), null, false, this.panel.settings.crossProject).done(function (results: string[]) {\n\n            if (that.panel.prefixCategory) {\n                results = results.filter( function(result) { return ml.Item.parseRef(result).type == that.panel.prefixCategory;});\n            }\n\n            /*\n            this is potentially n2 if the results is the whole tree ....\n\n            for (var idx = 0; idx < results.length; idx++) {\n                // verify that the tree is not filtered otherwise\n                var node = that.panel.tree.fancytree(\"getTree\").getNodeByKey(results[idx]);\n                if (node) {\n                    // if not add it to results\n                    that.currentResults.push(results[idx]);\n                }\n            }\n            */\n\n            // that's the same but indexOf is much faster\n            that.panel.tree.fancytree(\"getTree\").visit(function(node: Fancytree.FancytreeNode) {\n                if (results.indexOf( node.key) !=-1 ) {\n                    that.currentResults.push(node.key);\n                }\n            });\n\n\n            that.showSearchStatus(that.currentResults.length, false);\n            // search done\n            that.currentStatus = SearchState.ServerDone;\n            if (that.delayedAction) {\n                that.doDelayed();\n                return;\n            }\n            let filtered = that.render();\n\n            if (highlightResults) {\n                // highlight again (the filtering above removes the highlights from the tree)\n                window.clearTimeout(that.filterHighlight_timeout);\n                that.filterHighlight_timeout = window.setTimeout(function() {\n                    ml.Search.highlight(searchExpression);\n                }, 100);\n            }\n        }).fail( function(jqxhr, textStatus, error)  {\n\n            if (jqxhr) {\n                let errorText = \"unknown error\";\n                if ( jqxhr && jqxhr.responseJSON ) {\n                    if ( jqxhr.responseJSON.detailsList && jqxhr.responseJSON.detailsList.length > 0) {\n                        errorText = jqxhr.responseJSON.detailsList[0];\n                    }\n                    if ( jqxhr.responseJSON.displayError ) {\n                        errorText = jqxhr.responseJSON.displayError;\n                    }\n                    ml.UI.showError( \"Search failed\", errorText);\n                }\n                // error in search\n                that.showSearchStatus(-2, false, errorText.replace(\"[EClient/MRQL]|\",\"\").replace(\"|FindItemsMethod\",\"\"));\n                that.currentStatus = SearchState.ServerDone;\n                that.doDelayed(); // just in case\n            } else {\n                // no search performed (e.g. empty string)\n                that.showSearchStatus(-1, false);\n                that.currentStatus = SearchState.NoSearch;\n                that.doDelayed(); // just in case\n            }\n        });\n\n\n    };\n\n\n    // delayed actions might happen if user types or uses UI while a server\n    // request is going on. in that case the (last) delayed action is done after\n    // server returns\n    private doDelayed() {\n        if (!this.delayedAction) {\n            return;\n        }\n        if (this.delayedAction.type===\"server\") {\n            this.search(this.delayedAction.expression);\n        } else if (this.delayedAction.type===\"filter\") {\n            this.filter(this.delayedAction.expression,);\n        } else if (this.delayedAction.type===\"render\") {\n            this.render();\n        }\n    }\n\n    // status:\n    // -1 no search running\n    // -2 error (details contains message)\n    // -3 server search running\n    // 0 no matching results\n    // n>0 n matching results\n    private showSearchStatus(status:number, local:boolean, details?:string) {\n\n        let that = this;\n        var searchResultInfo = $(\".searchResultInfo\",this.panel.getRoot() );\n\n        clearTimeout(this.spinnerServerSearch);\n        $(\".searchResultWaiting\",  this.panel.getRoot() ).hide();\n        $(\".searchResultSelect\",   this.panel.getRoot() ).hide();\n\n        let searchHint = \"\";\n        if ( ml.LabelTools.getFilter() ) {\n            let filterNames = ml.LabelTools.getFilter().split(\",\").map(function(f) { return ml.LabelTools.getFilterName(f);}).join(\",\");\n            searchHint += \" <span style='color:\" + UIToolsConstants.CIColors.BrownDiSerria.color + \"'>Results filtered by label(s): '\" + filterNames + \"'</span>.\";\n        }\n        if ( local && !that.isConfigSearch) {\n            searchHint += \" Click <a class='performFullTextSearch'>here</a> to run fulltext search.\";\n        }\n\n        if ( status === -3 ) {\n            this.spinnerServerSearch = window.setTimeout( function() {\n                $(\".searchResultWaiting\", that.searchMetaInfo).show();\n                that.updateSearchStatusHeights();\n            }, 200);\n        } else if ( status === -2 ) {\n            searchResultInfo.html(\"error in search expression: \" + details);\n            searchResultInfo.show();\n        } else if (status === -1 ) {\n            searchResultInfo.html(\"\");\n            searchResultInfo.hide();\n            $(\".searchVizMode\", this.panel.getRoot()).hide();\n\n\n        } else if ( status ===0 ) {\n            searchResultInfo.html(\"<span style='color:grey;width:100%;padding-top:20px'>No matching items found.\" + searchHint + (details?details:\"\")+ \"</span>\");\n            searchResultInfo.show();\n            $(\".searchVizMode\", this.panel.getRoot()).show();\n        } else {\n            searchResultInfo.html( status + \" matching items found.\" + (details?details:\"\") + searchHint);\n            searchResultInfo.show();\n            $(\".searchVizMode\", this.panel.getRoot()).show();\n            if (this.panel.settings.canSelectItems) {\n                $(\".searchResultSelect\", this.panel.getRoot()  ).show();\n            }\n\n        }\n\n        $(\".performFullTextSearch\",searchResultInfo).on(\"click\", ()=>{\n            that.doSearch( $(\".searchNoX\",searchResultInfo.parentsUntil(\".treeCtrl\").parent()));\n        })\n        $(\".searchResultTabLink\", searchResultInfo).click( (event)  =>  {\n            let link = $(event.delegateTarget);\n            let tab = link.data( \"tab\");\n            NavBar.switchTab(tab);\n            that.render();\n        });\n\n        this.updateSearchStatusHeights();\n    }\n\n    // recompute position of tree/list control\n    private updateSearchStatusHeights() {\n\n        var top = 44;\n        $.each(this.searchMetaInfo.children(), function( idx, div) {\n           if ($(div).is(\":visible\")) {\n               top += $(div).height();\n           }\n        });\n\n        this.panel.updateTopPosition(top);\n    }\n    private addGlobalFilter(filter: JQuery, currentFilterContainer: JQuery){\n\n\n\n\n\n        if (!globalMatrix.ItemConfig.getTimeWarp()) {\n\n\n            let filterButton = $(`<span class=\"btn btn-ssearch searchBoxFilter\" data-cy=\"searchBoxFilter\" type=\"button\" ><span class=\"fal fa-filter\"></span></span>`)\n            filter.prepend(filterButton);\n\n            let dialog = $(\"#filterDialog\") ;\n            // Do not add the dialog if allready exists\n            if (dialog.length == 0) {\n\n                // show and apply project filters\n\n                let dialog = $('<div class=\"modal \" id=\"filterDialog\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"filterDialogLabel\" aria-hidden=\"true\">');\n                let dialogContent = $('<div class=\"modal-dialog modal-lg\" role=\"document\">');\n                let dialogContentInner = $('<div class=\"modal-content\">');\n                let dialogHeader = $('<div class=\"modal-header\">');\n                let dialogBody = $('<div class=\"modal-body\">');\n                let dialogFooter = $('<div class=\"modal-footer\">');\n                let dialogTitle = $('<h4 class=\"modal-title\" id=\"filterDialogLabel\">Filters</h4>');\n                let dialogClose = $('<button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>');\n\n                dialogHeader.append(dialogClose);\n                dialogHeader.append(dialogTitle);\n                dialogFooter.append(dialogClose);\n                dialogContentInner.append(dialogHeader);\n                dialogContentInner.append(dialogBody);\n                dialogContentInner.append(dialogFooter);\n                dialogContent.append(dialogContentInner);\n                dialog.append(dialogContent);\n                $(\"body\").append(dialog);\n\n                dialogClose.click(function () {\n                    dialog.modal(\"hide\");\n                });\n                dialogClose.click(function () {\n                    dialog.modal(\"hide\");\n                });\n\n                $(\"<div  id='globalProjectFilter'>/div>\").html('').appendTo(dialogBody);\n                var labelFilter = ml.LabelTools.getFilter();\n                if (labelFilter && labelFilter.length > 0 && ml.LabelTools.getFilterColor()) {\n                    $(\"header\").css(\"background-color\",ml.LabelTools.getFilterColor());\n                } else {\n                    $(\"header\").css(\"background-color\",\"\");\n                }\n\n\n                // show the filters -> if someone uses them, reload  the project with the filter\n                new LabelSwitches($(\"#globalProjectFilter\"), true, null, (labelFilter && labelFilter.length > 0) ? labelFilter.split(\",\") : [], \"project_filter\", function (newSelection: string[]) {\n                    app.canNavigateAwayAsync().done(function () {\n                        ml.LabelTools.setFilter(newSelection);\n                        app.loadProject(matrixSession.getProject(), app.getCurrentItemId()).then(()=>{\n                            if( currentFilterContainer.length > 0){\n                                $(\".itemFilterTool\").show();\n                                new LabelSwitches($(\"#currentFilterContainer\"), false, null, newSelection, \"filter_chip\", (sel) => {\n                                });\n                            }\n                            else{\n                                $(\".itemFilterTool\").hide();\n                            }\n\n                            ml.UI.toggleFilters(true);\n                        });\n                    // this code shouldn't be reachable, but let's leave it just in case\n                    }).fail(function () {\n                        ml.UI.showError(\"Filter was not activated.\", \"To activate reload project after saving the item!\");\n                    });\n                });\n\n\n\n\n            }\n\n\n\n\n\n            filterButton.click(() => {\n                dialog.modal(\"show\");\n            })\n\n        } else {\n            // no filters\n            $(\"#projectTree\").addClass(\"timewarp\");\n        }\n\n    }\n\n}\n","import { ILabelGroup, ILabel, ILabelInstance, IAutoFillSetting, ILabelsConfig } from \"../../../ProjectSettings\";\nimport { XRLabelHistory } from \"../../../RestResult\";\nimport { IItem, globalMatrix, matrixSession, app, ControlState, IStringMap, restConnection } from \"../../../globals\";\nimport { MR1 } from \"../../businesslogic\";\nimport { FieldDescriptions } from \"../../businesslogic/FieldDescriptions\";\nimport { ml } from \"../../matrixlib\";\nimport { LabelTools } from \"../../matrixlib/LabelTools\";\n\nexport { LabelSwitches };\n\nclass LabelSwitches extends LabelTools {\n\n    private lexist: boolean = false;\n    private isFilter: boolean;\n\n    private dbClickCounter = 0;\n    private dbClickTimer: number;\n    private groups: ILabelGroup[];\n    private ui: JQuery;\n    private canEdit: boolean;\n    private category: string;\n    private currentLabelsOn: string[];\n    private mode: string;\n    private valueChanged: (clo: string[]) => void;\n    private item?: IItem;\n    private restrictEditTo: string[];\n    private canAutoFill = false;\n\n    constructor(ui: JQuery, canEdit: boolean, category: string, currentLabelsOn: string[], mode: string, valueChanged: (clo: string[]) => void, item?: IItem, restrictEditTo?: string[]) {\n        super(ml.Logger, ml.JSON);\n\n        // get label definitions\n        let labelList = this.getLabelList();\n        if (labelList.length === 0) {\n            return\n        }\n\n        // get all label names\n        let allLabels = this.getLabelNames();\n        if (allLabels.length === 0) {\n            return;\n        }\n\n        // there are some labels\n        this.lexist = true;\n        this.isFilter = category === null;\n\n        // set other parameters\n        this.ui = ui;\n        this.canEdit = canEdit;\n        this.category = category;\n        this.currentLabelsOn = currentLabelsOn;\n        this.mode = mode;\n        this.valueChanged = valueChanged;\n        this.item = item;\n        this.restrictEditTo = restrictEditTo;\n\n        // get label groups\n        this.groups = this.getLabelGroups(category);\n\n        this.showLabels();\n    }\n\n    protected hasCombinedFilterMenu(): boolean {\n        let conf = this.getConfig().getSetting(\"labels\");\n        if (!conf) {\n            return false;\n        }\n        let confJson = this.json.fromString(conf);\n        if (confJson.status !== \"ok\") {\n            return false;\n        }\n        return this.json.isTrue((<ILabelsConfig>confJson.value).useFilterMenu);\n    }\n\n    private showLabels() {\n\n        let setting = this.getConfig().getLabelsConfig();\n\n        // each group is a button group with at least one button inside\n        for (var gid = 0; gid < this.groups.length; gid++) {\n\n            let group;\n            if(this.mode == \"filter_chip\") {\n                group = this.addChip(gid);\n                continue;\n            }\n\n            if (this.groups[gid].labelDef.length === 0) {\n                continue; // next group\n            }\n\n\n            let selectionMethod = this.isFilter ? this.groups[gid].filterSelection : this.groups[gid].selection;\n            if (selectionMethod === \"design_review\" && this.mode !== \"item_create\") {\n                group = this.create_group_design_review(gid);\n            }\n            else if (selectionMethod === \"review\" && this.mode !== \"item_create\") {\n                group = this.create_group_review(gid);\n            } else if (selectionMethod === \"or\") {\n                group = this.create_group_or(gid);\n                if (this.mode !== \"doc_filter\" && this.isFilter && this.groups[gid].filterMenu) {\n                    if (this.hasCombinedFilterMenu()) {\n                        this.add_to_global_dropdown(gid, group);\n                    } else {\n                        this.create_dropdown_group(gid, group);\n                    }\n                }\n\n            } else if (selectionMethod === \"xor\" || (selectionMethod === \"review\" && this.mode === \"item_create\")) {\n                group = this.create_group_xor(gid);\n                if (this.mode === \"item_create\" && !this.json.isTrue(this.groups[gid].defaultAsk)) {\n                    group.hide();\n                }\n            }\n            // bug fix (groups are right to left in item title bar)\n            if (group && this.mode == \"item_title\" && !setting.invertGroups) {\n                group.css(\"float\", \"none\");\n            }\n\n        }\n        // hack -> hide the empty label heading if there's no labels\n        if (this.mode == \"item_create\" && this.groups.filter(g => !!g.defaultAsk || (g.labelDef && g.labelDef.filter(l => !!l.defaultAsk).length > 0)).length == 0) {\n            // use does not need to set labels when creating new items\n            $(\".baseControlHelp\", this.ui.parent()).hide();\n        }\n\n\n\n    };\n\n    private setEnabled(enabled: boolean) {\n        if (enabled) {\n            $(\"#labelDisabler\").remove();\n        } else {\n            this.ui.css(\"position\", \"relative\");\n            $(\"<div id='labelDisabler'>\").appendTo(this.ui);\n        }\n    }\n\n    labelsExist(): boolean {\n        return this.lexist;\n    }\n\n    private canEditLabel(labelId: string) {\n\n        if (!this.canEdit) return false;\n        if (!this.restrictEditTo) return true;\n        return this.restrictEditTo.indexOf(labelId) != -1;\n    }\n\n    /**\n     *  this.ui elements for different label this.groups\n     */\n    private create_group_or(gid: number): JQuery {\n\n        let that = this;\n\n        var btnGroup = $('<div class=\"btn-group labelTools\">');\n        this.ui.append(btnGroup);\n\n        $.each(this.groups[gid].labelDef, function (idx: number, label: ILabel) {\n\n            label.isNegative = that.currentLabelsOn.indexOf((\"!\" + label.label)) > -1;\n            label.isSelected = label.isNegative || that.currentLabelsOn.indexOf(label.label) > -1;\n\n            var switchFunction: Function; // single click\n            var invertFunction: Function; // dbl click for filter or null\n            switchFunction = function (button: JQuery) {\n                if (!that.canEditLabel(label.label)) {\n                    return;\n                }\n\n                let rememberBefore = that.json.clone(that.currentLabelsOn);\n\n                var click_label = button.data(\"label\");\n                var click_gid = button.data(\"gid\");\n\n                $.each(that.groups[click_gid].labelDef, function (idx, label) {\n                    if (label.label === click_label) {\n                        label.isSelected = !label.isSelected;\n                        label.isNegative = false;\n                    }\n                });\n\n                button.tooltip('hide');\n                button.replaceWith(that.createLabel(click_label, gid, switchFunction, invertFunction));\n\n                if (that.valueChanged) {\n                    that.updateSelection();\n                    that.valueChanged(that.currentLabelsOn);\n                }\n                that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n            };\n\n            if (that.isFilter && that.canEdit) {\n                invertFunction = function (button: JQuery) {\n                    if (!that.canEditLabel(label.label)) {\n                        return;\n                    }\n\n                    var click_label = button.data(\"label\");\n                    var click_gid = button.data(\"gid\");\n                    let negativePrefix = \"\";\n                    $.each(that.groups[click_gid].labelDef, function (idx, label) {\n                        if (label.label === click_label) {\n                            if (label.isSelected) {\n                                label.isNegative = !label.isNegative;\n                                negativePrefix = label.isNegative ? \"!\" : \"\";\n                            } else {\n                                label.isSelected = true;\n                                label.isNegative = true;\n                                negativePrefix = \"!\";\n                            }\n                        }\n                    });\n\n                    button.tooltip('hide');\n                    button.replaceWith(that.createLabel(negativePrefix + click_label, gid, switchFunction, invertFunction));\n\n                    if (that.valueChanged) {\n                        that.updateSelection();\n                        that.valueChanged(that.currentLabelsOn);\n                    }\n                }\n            }\n\n            var btn = that.createLabel((label.isNegative ? \"!\" : \"\") + label.label, gid, switchFunction, invertFunction);\n            // add button to group\n            btnGroup.append(btn);\n            // hide button if it should not be shown in create dialog\n            if (that.mode === \"item_create\" && !that.json.isTrue(label.defaultAsk)) {\n                btn.hide();\n            }\n\n\n        });\n        return btnGroup;\n    };\n\n    private triggerLabelChanged(before: string[], after: string[]) {\n        if (this.isFilter) {\n            return;\n        }\n        let set = after.filter(function (label) { return before.indexOf(label) == -1; });\n        let unset = before.filter(function (label) { return after.indexOf(label) == -1; });\n        if (set.length > 0 || unset.length > 0) {\n            MR1.triggerAfterLabelChange(this.item, set, unset);\n        }\n    }\n\n    private create_group_xor(gid: number): JQuery {\n        let that = this;\n\n        var btnGroup = $('<div class=\"btn-group labelTools\">');\n        this.ui.append(btnGroup);\n\n        let canEditGroup = false;\n        $.each(this.groups[gid].labelDef, function (idx, label) {\n            if (that.canEditLabel(label.label)) {\n                canEditGroup = true;\n            }\n        });\n\n        $.each(this.groups[gid].labelDef, function (idx, label) {\n\n            label.isSelected = that.currentLabelsOn.indexOf(label.label) > -1;\n\n            var switchFunction: Function;\n            switchFunction = function (button: JQuery) {\n                let rememberBefore = that.json.clone(that.currentLabelsOn);\n                if (!canEditGroup) {\n                    return;\n                }\n                button.tooltip('hide');\n                var click_label = button.data(\"label\");\n                var click_gid = button.data(\"gid\");\n\n                $.each(that.groups[click_gid].labelDef, function (idx, label) {\n                    // not possible to unselect a label, so clicked label will always be on\n                    label.isSelected = label.label === click_label;\n                    var newButton = that.createLabel(label.label, gid, switchFunction);\n                    (<ILabelInstance>label).btn.replaceWith(newButton);\n                    (<ILabelInstance>label).btn = newButton;\n                });\n\n                if (that.valueChanged) {\n                    that.updateSelection();\n                    that.valueChanged(that.currentLabelsOn);\n                }\n                that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n            };\n\n            (<ILabelInstance>label).btn = that.createLabel(label.label, gid, switchFunction);\n\n            // add button to group\n            btnGroup.append((<ILabelInstance>label).btn);\n        });\n\n        return btnGroup;\n    };\n\n    private create_group_review(gid: number): JQuery {\n        let that = this;\n\n        var btnGroup = $('<div class=\"btn-group labelTools\">');\n        this.ui.append(btnGroup);\n\n        // special handling for review labels! if no review flag is set show it in item as not set\n        var color = this.groups[gid].noColor ? this.groups[gid].noColor : \"red\";\n        var icon = this.groups[gid].noIcon ? this.groups[gid].noIcon : null;\n        var name = this.groups[gid].noName ? this.groups[gid].noName : (icon ? \"\" : \"not set\");\n\n        // this will be a drop down button\n        var btn: JQuery;\n        if (this.mode == \"item_history\") {\n            // in history render a simplified version of labels to be more easily comparable\n            btn = this.createButton(\"\", gid, name, \"\", \"\", icon, null, null, \"labelInHistory\");\n        } else {\n            btn = this.createButton(\"\", gid, name, color, \"transparent\", icon, null, null, \"labelIsMenu\");\n        }\n        // for reviews it is possible that no label is set or one...\n        // the one which is set is the only one displayed\n\n        // figure out if the user can change something in group\n        // canEdit must be true\n        // but if this is a lock keeper, he can undo only his locks....\n        let canEditGroup = false;\n        $.each(this.groups[gid].labelDef, function (idx: number, label: ILabel) {\n            if (that.canEditLabel(label.label)) {\n                canEditGroup = true;\n            };\n        });\n\n        $.each(this.groups[gid].labelDef, function (idx: number, label: ILabel) {\n            label.isSelected = false;\n            if (that.currentLabelsOn.indexOf(label.label) !== -1) {\n                label.isSelected = true;\n                // this is part of drop down menu....\n                btn = that.createLabel(label.label, gid, function () { });\n                btn.addClass(\"labelIsMenu\");\n            }\n        });\n\n        var tooltip = this.groups[gid].tooltip ? this.groups[gid].tooltip : \"\";\n        if (tooltip) {\n            btn.tooltip({ title: tooltip, placement: \"bottom\", container: \"body\" });\n        }\n\n        // check if there are defined reviewers of label\n        var userCanDo = matrixSession.amIAllowedUser(this.groups[gid].reviewers);\n\n        if (!userCanDo || this.mode === \"item_print\" || !canEditGroup) {\n            // we are done... this is not interactive...\n            btn.css(\"cursor\", \"inherit\")\n            btnGroup.append(btn);\n            return btnGroup; //$(\"\");\n        }\n\n        // add drop down menu\n        btn.addClass(\"dropdown-toggle\");\n        btn.attr(\"data-toggle\", \"dropdown\");\n        btn.append(\"<span class='caret' style='margin-left:5px'/>\")\n        var ddbtn = $('<div class=\"dropdown\">');\n        ddbtn.append(btn);\n        var options = $('<ul  class=\"dropdown-menu\">');\n        $.each(this.groups[gid].labelDef, function (idx: number, label: ILabel) {\n            var icon = \"<span style='margin-right:8px'/>\";\n            var name = label.displayName ? label.displayName : \"\";\n            if (label && label.style && label.style.label && label.style.label.on) {\n                if (label.style.label.on.icon) {\n                    var color = label.style.label.on.foreground ? \"color:\" + label.style.label.on.foreground + \";\" : \"\";\n                    var bg = label.style.label.on.background ? \"background-color:\" + label.style.label.on.background + \";\" : \"\";\n\n                    icon = \"<i class='fal fa-\" + label.style.label.on.icon + \"' style='margin-left:-10px;margin-right:2px; width:22px; padding: 4px; border-radius:var(--smallBorderRadius);\" + color + bg + \"' ></i>\";\n                }\n                if (label.style.label.on.displayName) {\n                    name = label.style.label.on.displayName;\n                }\n            }\n\n            var li = $(\"<li class='labelMenuEntry'></li>\").html('<a href=\"javascript:void(0)\" style=\"min-width:100%\">' + icon + name + '</a>');\n            li.data(\"label\", label.label);\n            li.data(\"gid\", gid);\n            options.append(li);\n            li.click(function (e: JQueryEventObject) {\n                $(\".tooltip\").remove();\n                let rememberBefore = that.json.clone(that.currentLabelsOn);\n\n                // set just the selected label from the group\n                var group = that.groups[$(e.delegateTarget).data(\"gid\")];\n                var selected = $(e.delegateTarget).data(\"label\");\n\n                var askForComment = group.askForComment ? group.askForComment : false;\n                $.each(group.labelDef, function (idx: number, label: ILabel) {\n                    if (label.label === selected) {\n                        askForComment = label.askForComment ? label.askForComment : askForComment;\n                    }\n                });\n                function setLabel(comment?: string) {\n                    let labelsOff: string[] = [];\n                    $.each(group.labelDef, function (idx, label) {\n                        label.isSelected = label.label === selected;\n                        if (!label.isSelected) {\n                            labelsOff.push(label.label);\n                        }\n                    });\n                    // set and save label\n                    that.saveAfterLabelChange(comment);\n                };\n                if (askForComment) {\n\n                    $('#dialog_comment_text').val(matrixSession.getComment());\n                    $('#dialog_comment_ok').off(\"click\");\n                    $('#dialog_comment_nok').off(\"click\");\n\n                    $('#dialog_comment_ok').one(\"click\", function () {\n                        setLabel($('#dialog_comment_text').val());\n                        that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n                    });\n                    $('#dialog_comment_nok').one(\"click\", function () { });\n\n                    $('#dialog_comment').modal({ backdrop: 'static' });\n\n                } else {\n                    setLabel();\n                    that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n                }\n            });\n        });\n\n        btnGroup.append(ddbtn);\n\n        if (this.groups[gid].showComments && this.item && this.item.history) {\n\n            var history = this.item.history;\n            var reviews = 0;\n            $.each(history, function (hixd, h) {\n                reviews += (h.action === 'reviewed') ? 1 : 0;\n            });\n            if (reviews > 0) {\n                options.append($(\"<li class='' >\").html('<hr>'));\n                $.each(history, function (hixd, h) {\n                    if (h.action === 'reviewed') {\n                        options.append($(\" <li class='reviewedCommentMenutitem' style='display:flex'>\").html(\"<span class='hqlu'>\" + h.user + \"</span> <span class='hqld' >(\" + h.dateUserFormat + \"):</span> <span class='hqlc'>\" + h.comment + '</span>'));\n                    }\n                });\n                options.width(300 + ddbtn.width());\n            }\n            options.css(\"top\",\"30px\");\n\n        }\n        ddbtn.append(options);\n\n        return btnGroup;\n    };\n\n    private saveAfterLabelChange(comment: string) {\n        let that = this;\n        // set label\n        that.updateSelection();\n\n        // save: pass the labels to the touch, this overwrites the labels\n        // a normal save reset's review labels!\n        var mainComment = matrixSession.getComment();\n        if (comment) {\n            matrixSession.setComment(comment);\n        }\n        that.setEnabled(false); // save will render labels as readonly\n\n        app.setLabels({ labels: that.currentLabelsOn }).done(function () {\n            // after save item will be repainted\n            matrixSession.setComment(mainComment);\n        }).fail(() => {\n            that.setEnabled(true); // save will render labels 'normally'\n        });\n    }\n\n    private create_group_design_review(gid: number) {\n        let that = this;\n\n        var btnGroup = $('<div class=\"btn-group labelTools\">');\n        this.ui.append(btnGroup);\n        for( let label of this.groups[gid].labelDef) {\n\n\n            label.isNegative = that.currentLabelsOn.indexOf((\"!\" + label.label)) > -1;\n            label.isSelected = label.isNegative || that.currentLabelsOn.indexOf(label.label) > -1;\n\n            var switchFunction: Function; // single click\n            var invertFunction: Function; // dbl click for filter or null\n            switchFunction = async function(button: JQuery) {\n                let rememberBefore = that.json.clone(that.currentLabelsOn);\n\n                let click_label = button.data(\"label\");\n\n                if (that.mode === \"item_print\" || !that.canEditLabel(click_label)) {\n                    return;\n                }\n\n                var click_gid = button.data(\"gid\");\n\n                // get the label definition\n                var labelDef: ILabel;\n                $.each(that.groups[click_gid].labelDef, function(idx, label) {\n                    if (label.label === click_label) {\n                        labelDef = label;\n                    }\n                });\n                // get review job details\n                let review_job = that.getDesignReview(click_label);\n\n                // check if there are defined reviewers of label\n                let userCanDo = matrixSession.amIAllowedUser(review_job.reviewerField ? await that.getUsersFromField(review_job.reviewerField) : review_job.reviewers);\n                if (!userCanDo) {\n                    ml.UI.showError(\"You do not have sufficient rights to perform review\", \"\", 3000);\n                }\n\n                button.tooltip('hide');\n\n                function setReviewResult(comment: string, passed: boolean): void {\n\n                    $.each(that.groups[click_gid].labelDef, function(idx, label) {\n                        if (label.label === click_label) {\n                            label.isSelected = passed;\n                            label.isNegative = false;\n                        }\n                    });\n\n                    button.replaceWith(that.createLabel(click_label, gid, switchFunction, invertFunction));\n                    // set and save label\n                    that.saveAfterLabelChange(comment);\n                };\n\n                // here we can show a dialog (since this never happens while creating an item\n                async function reviewStatusChange() {\n                    var okButton = $(\".ui-dialog-buttonpane button:contains('Pass')\", app.dlgForm.parent());\n                    var failButton = $(\".ui-dialog-buttonpane button:contains('Fail')\", app.dlgForm.parent());\n\n                    if (!userCanDo) {\n                        okButton.prop(\"disabled\", true);\n                        okButton.addClass(\"ui-state-disabled\");\n                        failButton.prop(\"disabled\", true);\n                        failButton.addClass(\"ui-state-disabled\");\n                        return;\n                    }\n                    var isOk = await drComment.getController().getValueAsync() !== \"\";\n                    if (isOk) {\n                        $.each($(\".drcbcontrol\"), function(idx, drcb) {\n                            if (!$(drcb).data(\"new\")) { // get the value directly from control\n                                isOk = false;\n                            }\n                        });\n                    }\n                    if (isOk) {\n                        okButton.prop(\"disabled\", false);\n                        okButton.removeClass(\"ui-state-disabled\");\n                    } else {\n                        okButton.prop(\"disabled\", true);\n                        okButton.addClass(\"ui-state-disabled\");\n                    }\n                }\n\n                app.dlgForm.hide();\n                app.dlgForm.html(\"\");\n                app.dlgForm.removeClass(\"dlg-no-scroll\");\n                app.dlgForm.addClass(\"dlg-v-scroll\");\n                var settingsUI = $(\"<div>\");\n                settingsUI.append($(\"<h2>\").html(review_job.reviewHelp));\n                $.each(review_job.reviewDetails, function(idx, rd) {\n                    if (rd.type == \"signature\") {\n                        settingsUI.append($(\"<p style='margin:0px 20px 10px 0px;font-weight: bold;'>\").html(rd.name))\n\n                        // do not allow chrome to fill passwords (quite a hack)\n                        let autoFill = <IAutoFillSetting>matrixSession.getCustomerSettingJSON(\"autoFillSettings\", {});\n                        that.canAutoFill = autoFill.allowAutoFill || autoFill.allowLabelSignAutoFill;\n\n                        let form = $('<form>').appendTo(settingsUI);\n                        let table = $('<div class=\"signatureInfo input-group\" style=\"margin-top:12px;width:100%\">').appendTo(form);\n                        let name = $(\"<input autocomplete='off' type='text' class='signatureInfo form-control' placeholder='enter user id' style='padding:8px'>\");\n                        let pwd = $(\"<input type='\" + (that.canAutoFill ? \"password\" : \"text\") + \"' class='review_password form-control' placeholder='password' style='margin: 0px 20px 20px 0px; width: 200px;'>\");\n                        let pwdSpan = $(\"<span class='input-group-btn'>\").append(pwd);\n                        table.append(name);\n                        table.append(pwdSpan);\n                        pwd.on(\"change keyup paste\", function() {\n                            reviewStatusChange();\n\n                        });\n                        pwd.on(\"keyup paste\", function() {\n                            pwd.attr(\"type\", \"password\");\n                        });\n                        // set user name and reset password (in case it is a not allowed auto fill)\n                        that.initPasswordField(name, pwd);\n\n                    } else {\n                        settingsUI.append($(\"<div class='drcbcontrol'>\").checkBox({\n                            controlState: ControlState.FormEdit, // read only rendering\n                            canEdit: userCanDo,\n                            fieldValue: \"false\",\n                            help: rd.name,\n                            valueChanged: async function(checked: boolean) {\n                                var comment = await drComment.getController().getValueAsync() + \"\\n\" + rd.name + \" \" + (checked ? \"passed\" : \"failed\");\n                                drComment.getController().setValue(comment);\n                                reviewStatusChange();\n                            }\n                        }));\n                    }\n                    settingsUI.append($(\"<p style='margin:-7px 20px 10px 26px'>\").html(rd.help))\n                });\n                var drComment = $(\"<div id='designReviewComment'>\").plainText({\n                    controlState: ControlState.FormEdit,\n                    canEdit: userCanDo,\n                    help: review_job.commentHeading ? review_job.commentHeading : \"Design Review Comment\",\n                    fieldValue: matrixSession.getComment(),\n                    valueChanged: function() {\n                        reviewStatusChange();\n                    },\n                    parameter: {\n                        allowResize: true\n                    }\n                });\n\n                settingsUI.append(drComment);\n                app.dlgForm.append(settingsUI);\n                app.dlgForm.dialog({\n                    autoOpen: true,\n                    title: review_job.reviewName,\n                    height: app.itemForm.height() * 0.9,\n                    width: 730,\n                    modal: true,\n                    open: function() {\n                        reviewStatusChange();\n                    },\n                    close: function() {\n                    },\n                    resizeStop: function() {\n                    },\n                    buttons: [{\n                        text: 'Pass',\n                        class: 'btnDoIt',\n                        click: async function() {\n                            if ($(\".review_password\", app.dlgForm).length) {\n                                let pwd = $(\".review_password\", app.dlgForm).val();\n\n                                app.checkPassword(pwd).done(function() {\n\n                                    that.verifyRevisionTable(click_label, review_job.revisionTableName).then(async () => {\n\n                                        setReviewResult(await drComment.getController().getValueAsync(), true);\n                                        that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n                                    });\n\n                                    app.dlgForm.dialog(\"close\");\n                                }).fail(function(jqxhr, textStatus, error) {\n                                    ml.UI.showError(\"Incorrect  password!\", \"\");\n                                });\n                            } else {\n                                setReviewResult(await drComment.getController().getValueAsync(), true);\n                                that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n\n                                app.dlgForm.dialog(\"close\");\n                            }\n                        }\n                    }, {\n                        text: 'Fail',\n                        class: 'btnDoIt2',\n                        click: async function() {\n                            setReviewResult(await drComment.getController().getValueAsync(), false);\n                            that.triggerLabelChanged(rememberBefore, that.currentLabelsOn);\n                            app.dlgForm.dialog(\"close\");\n                        }\n                    }, {\n\n                        text: 'Cancel',\n                        class: 'btnCancelIt',\n                        click: function() {\n                            app.dlgForm.dialog(\"close\");\n                        }\n                    }\n                    ]\n                });\n\n\n            };\n\n            if (that.isFilter && that.canEdit) {\n                invertFunction = function (button: JQuery) {\n\n                    var click_label = button.data(\"label\");\n                    var click_gid = button.data(\"gid\");\n\n                    $.each(that.groups[click_gid].labelDef, function (idx, label) {\n                        if (label.label === click_label) {\n                            if (label.isSelected) {\n                                label.isNegative = !label.isNegative;\n                            } else {\n                                label.isSelected = true;\n                                label.isNegative = true;\n                            }\n                        }\n                    });\n\n                    button.tooltip('hide');\n                    button.replaceWith(that.createLabel(click_label, gid, switchFunction, invertFunction));\n\n                    if (that.valueChanged) {\n                        that.updateSelection();\n                        that.valueChanged(that.currentLabelsOn);\n                    }\n                };\n            }\n            var btn = that.createLabel((label.isNegative ? \"!\" : \"\") + label.label, gid, switchFunction, invertFunction);\n\n            // add button to group\n            btnGroup.append(btn);\n\n            // hide button if it should not be shown in create dialog\n            if (that.mode === \"item_create\") {\n                btn.hide();\n            }\n        }\n        return btnGroup;\n    }\n\n    protected async verifyRevisionTable(label: string, revisionTableName: string) :Promise<void>{\n        let that = this;\n        return new Promise<void>(async function(resolve, reject) {\n\n            if (!that.item) {\n                // nothing to worry about - we are creating a new item\n                resolve();\n                return;\n            }\n            if (!revisionTableName) {\n                // nothing to worry about - this is a normal label\n                resolve();\n                return;\n            }\n\n            let revisionTableField = this.getConfig().getFieldByName(that.category, revisionTableName);\n            if (!revisionTableField) {\n                // nothing to worry about - there is no revision table in this category\n                that.logger.log(\"warn\", `Label has revisionTableName '${revisionTableName}' defined but there is no such table in ${that.category}`);\n                resolve();\n                return;\n            }\n\n            let revisionColumn: string;\n            if (!revisionTableField.parameterJson || !<any>revisionTableField.parameterJson.columns) {\n                // nothing to worry about - there is no columns in table in this category\n                that.logger.log(\"warn\", `Label has revisionTableName '${revisionTableName}' defined but there are no columns defined ${that.category}`);\n                resolve();\n                return;\n            }\n\n            for (let column of <any>revisionTableField.parameterJson.columns) {\n                if (column.editor == \"revision\") {\n                    revisionColumn = column.field;\n                }\n            }\n\n            if (!revisionColumn) {\n                // nothing to worry about - there is no revision column in table\n                that.logger.log(\"warn\", `Label has revisionTableName '${revisionTableName}' defined but there is no revision column in table in ${that.category}`);\n                resolve();\n                return;\n            }\n            if (revisionTableField.fieldType != FieldDescriptions.Field_steplist) {\n                that.logger.log(\"warn\", `Label has revisionTableName '${revisionTableName}' defined but the field is not a table in ${that.category}`);\n                resolve();\n                return;\n            }\n\n            let revisionTableVal = await app.getFieldValueAsync(revisionTableField.id);\n            let currentValue = that.getRevisionFromTable(revisionTableVal, revisionColumn);\n\n            if (!currentValue) {\n                // empty table\n                ml.UI.showConfirm(-1, {\n                    title: `No revision defined in last row of table '${revisionTableName}'!`,\n                    ok: \"Set Label\",\n                    nok: \"Cancel\"\n                }, () => {\n                    resolve();\n                }, () => {\n                    reject();\n                });\n                return;\n            }\n\n            let empty = false;\n            for (let column of <any>revisionTableField.parameterJson.columns) {\n                if (!that.getRevisionFromTable(revisionTableVal, column.field)) {\n                    empty = true;\n                }\n            }\n\n            if (empty) {\n                ml.UI.showConfirm(-1, {\n                    title: `Last row of table '${revisionTableName} has empty cells'!`,\n                    ok: \"Set Label\",\n                    nok: \"Cancel\"\n                }, () => {\n                    $(\".modal-backdrop\").remove();\n                    that.compareRevisions(currentValue, revisionTableField.id, revisionColumn, label).done(() => {\n                        resolve();\n                    }).fail(() => {\n                        reject();\n                    }).always(() => {\n                        $(\".modal-backdrop\").remove();\n                    });\n                }, () => {\n                    reject();\n                });\n            } else {\n                that.compareRevisions(currentValue, revisionTableField.id, revisionColumn, label).done(() => {\n                    resolve();\n                }).fail(() => {\n                    reject();\n                }).always(() => {\n                    $(\".modal-backdrop\").remove();\n                });\n            }\n            return;\n        });\n    }\n\n    private compareRevisions(currentRevision: string, versionTableField: number, revisionTableColumn: string, label: string) {\n        let res = $.Deferred();\n        let that = this;\n        this.getLastTimeLabelWasSet(that.item.id, label, 0).then((lastRevision: number) => {\n            if (!lastRevision) {\n                // it was never set ... no problem\n                res.resolve();\n            } else {\n                app.getItemAsync(that.item.id, lastRevision).done(function (lastSetVersion) {\n                    let lv = lastSetVersion[versionTableField];\n                    let fieldValue = JSON.parse(lv ? lv : \"{}\");\n\n                    let previousRevision = fieldValue ? that.getRevisionFromTable(JSON.stringify(fieldValue), revisionTableColumn) : \"\";\n                    if (currentRevision != previousRevision) {\n                        // we assume all is good...\n                        res.resolve(currentRevision);\n                    } else {\n                        ml.UI.showConfirm(-1, { title: `The current revision '${currentRevision}' is the same as it was when the label '${label}' was set the last time!`, ok: \"Set Label\", nok: \"Cancel\" }, () => { res.resolve(); }, () => { res.reject(); });\n                    }\n                }).fail(function (error) {\n                    res.reject(error);\n                });\n            }\n        });\n\n        return res;\n    }\n\n    protected getRevisionFromTable(revisionTableVal: string, revisionColumn: string) {\n        let revisionTable = <IStringMap[]>(revisionTableVal ? JSON.parse(revisionTableVal) : []);\n        if (!revisionTable.length) {\n            // empty table\n            return \"\";\n        }\n        return revisionTable[revisionTable.length - 1][revisionColumn];\n    }\n    // get a list of users / user groups from a drop down field\n    protected async getUsersFromField(fieldName: string) {\n\n        let cat = ml.Item.parseRef(app.getCurrentItemId()).type;\n        let field = this.getConfig().getFieldByName(cat, fieldName);\n        if (!field) {\n            this.logger.log(\"warning\", `the field ${fieldName} does not exist in category ${cat}. Cannot get users from that field.`);\n            return [];\n        }\n        let val = await app.getFieldValueAsync(field.id);\n\n        return val.split(\",\");\n    }\n\n    protected initPasswordField(name: JQuery, pwd: JQuery) {\n        name.val(matrixSession.getUser() + (this.canAutoFill ? \"\" : \" \")); // the \" \"  makes sure the password is not filled when loading\n        name.attr(\"readonly\", \"readonly\");\n\n        if (this.canAutoFill) return;\n        pwd.val(\"\");\n    }\n\n    // move all buttons into one dropdown (for filter)\n    private add_to_global_dropdown(gid: number, btnGroup: JQuery): void {\n        let that = this;\n\n        var globalFilterMenu = this.ui.find(\".globalFilterMenu\");\n        if (globalFilterMenu.length === 0) {\n            var somethingSelected = this.currentLabelsOn.length > 0 ? \"Filter\" : \"Filter\";\n            var menuGroup = $('<div id=\"setFilter\"  class=\"btn-group dropdown\">');\n            var menuBtn = $('<button class=\"btn btn-default btn-label dropdown-toggle filterMenu\" data-toggle=\"dropdown\">' + somethingSelected + '&nbsp;<span class=\"caret\"></span></button>');\n            var globalFilterMenu = $('<ul class=\"dropdown-menu globalFilterMenu\" style=\"max-height:' + ($(window).height() - 100) + 'px\" role=\"menu\">');\n            menuGroup.append(menuBtn).append(globalFilterMenu);\n            this.ui.append(menuGroup);\n            if (this.currentLabelsOn.length > 0) {\n                var reset = $('<a href=\"javascript:void(0)\" id=\"resetFilter\">Remove all filter</a>')\n                reset.click(function () {\n                    that.valueChanged([]);\n                });\n                globalFilterMenu.append($(\"<li>\").append(reset));\n            }\n        }\n\n        // create menu section:\n        // add line unless this is the first thing in the menu\n        if ($(\".globalFilterMenu li\").length > 0) {\n            globalFilterMenu.append(\"<li class='limenuLine'><span class='menuLine'></span></li>\");\n        }\n        // add group name if there is one\n\n        if (this.groups[gid].filterMenu && this.groups[gid].filterMenu.displayName) {\n            let lastMenuHeadings = $(\".menuHeading\", globalFilterMenu);\n            let lastIsSame = lastMenuHeadings.length && $(lastMenuHeadings[lastMenuHeadings.length - 1]).text() == this.groups[gid].filterMenu.displayName;\n            if (!lastIsSame) {\n                globalFilterMenu.append(\"<li><span class='menuHeading'>\" + this.groups[gid].filterMenu.displayName + \"</span></li>\");\n            }\n        }\n\n        // move all buttons in a dropdown list with buttons unless they are selected\n        btnGroup.find(\"button\").each(function (idx, btn) {\n            var label = $(btn).data(\"label\");\n            if (that.currentLabelsOn.indexOf((\"!\" + label)) === -1 && that.currentLabelsOn.indexOf(label) === -1) {\n                globalFilterMenu.append($(\"<li class='btnline'>\").append($('<a href=\"javascript:void(0)\">').append(btn)));\n                var nf = $(\"<span class='negativeFilter btn-link'  title data-original-title='filter by label not set' >not</span>\");\n                $(btn).parent().prepend(nf);\n                nf.click(function (e: JQueryEventObject) {\n                    var label = $(e.delegateTarget).data(\"label\");\n                    that.currentLabelsOn.push(\"!\" + label);\n                    that.valueChanged(that.currentLabelsOn);\n                }).data(\"label\", label)\n                    .tooltip({ placement: \"bottom\", container: \"body\" });\n            }\n        });\n        // move filter select dropdown after btn group\n        $(\"#setFilter\").insertAfter(btnGroup);\n    }\n\n    // move all labels of one group into a dropdown (rather than simple buttons)\n    private create_dropdown_group(gid: number, btnGroup: JQuery): void {\n        let that = this;\n\n        var somethingSelected = false;\n        $.each(this.groups[gid].labelDef, function (idx, label) {\n            somethingSelected = somethingSelected || that.currentLabelsOn.indexOf((\"!\" + label.label)) > -1 || that.currentLabelsOn.indexOf(label.label) > -1;\n        });\n\n        // modify button group to a dropdown button group\n        btnGroup.addClass(\"dropdown\");\n     //   btnGroup.removeClass(\"labelTools\");\n\n        // move all buttons in a dropdown list with buttons\n        var btnUl = $('<ul class=\"dropdown-menu globalFilterMenu\" role=\"menu\">');\n        btnGroup.find(\"button\").each(function (idx: number, btn: Element) {\n            btnUl.append($(\"<li class='filterGroupDD'>\").append(btn));\n            if (that.currentLabelsOn.indexOf((\"!\" + $(btn).data(\"label\"))) === -1) {\n                var nf = $(\"<span class='negativeFilter'  title data-original-title='filter by label not set' >not</span>\");\n                $(btn).parent().prepend(nf);\n                nf.click(function (e: JQueryEventObject) {\n                    $(\".tooltip\").remove();\n\n                    var alreadySet = that.currentLabelsOn.indexOf($(e.delegateTarget).data(\"label\"));\n                    if (alreadySet > -1) {\n                        that.currentLabelsOn.splice(alreadySet, 1);\n                    }\n                    var label = $(e.delegateTarget).data(\"label\");\n                    that.currentLabelsOn.push(\"!\" + label);\n                    that.valueChanged(that.currentLabelsOn);\n                }).data(\"label\", $(btn).data(\"label\"))\n                    .tooltip({ placement: \"bottom\", container: \"body\" });\n            }\n\n        });\n\n        // create menu button\n        var menuDefinition = somethingSelected ? this.groups[gid].filterMenu.on : this.groups[gid].filterMenu.off;\n        if (!menuDefinition) {\n            menuDefinition = {\n                foreground: \"black\",\n                background: \"transparent\",\n                displayName: this.groups[gid].filterMenu.displayName,\n                tooltip: \"\"\n            }\n        }\n        var i = \"\";\n        if (menuDefinition.icon) {\n            i = \"<i class='fal fa-\" + menuDefinition.icon + \"' style='margin-right:6px'></i>\";\n        }\n        var tt = \"\";\n        if (menuDefinition.tooltip) {\n            tt = \" title data-original-title='\" + menuDefinition.tooltip + \"' \";\n        }\n        var btn = $(\"<button class='btn btn-default btn-label dropdown-toggle' data-toggle='dropdown' \" + tt + \">\" + i + menuDefinition.displayName + \"&nbsp;<span class='caret'></span></button>\");\n        btn.css(\"background-color\", menuDefinition.background).css(\"color\", menuDefinition.foreground);\n        btn.data(\"gid\", gid);\n\n        // append menu button\n        btnGroup.append(btn);\n        // append menu options\n        btnGroup.append(btnUl);\n\n        btn.tooltip({ placement: \"bottom\" });\n\n    }\n\n    // gets selection from all groups\n    private updateSelection() {\n        this.currentLabelsOn = [];\n        for (var gid = 0; gid < this.groups.length; gid++) {\n            for (var lid = 0; lid < this.groups[gid].labelDef.length; lid++) {\n                if (this.groups[gid].labelDef[lid].isSelected) {\n                    if (this.groups[gid].labelDef[lid].isNegative) {\n                        this.currentLabelsOn.push(\"!\" + this.groups[gid].labelDef[lid].label);\n                    }\n                    else {\n                        this.currentLabelsOn.push(this.groups[gid].labelDef[lid].label);\n                    }\n                }\n            }\n        }\n    }\n\n    // paint one 'normal' label button\n    private createButton(label: string, gid: number, name: string, foreground: string, background: string, icon: string, onClick: Function, onDblClick: Function, extraClass: string): JQuery {\n        let that = this;\n\n        var i = \"\";\n        if (icon) {\n            i = \"<i class='fal fa-\" + icon + \"' style='\" + (name ? \"margin-right:6px\" : \"\") + \"'></i>\";\n        }\n        var btn = $(\"<button tabindex='-1' class='btn btn-default btn-label \" + extraClass + \"' \" + (this.canEdit ? \"\" : \"disabled\") + \">\" + i + name + \"</button>\");\n        btn.css(\"background-color\", background).css(\"color\", foreground);\n        btn.data(\"label\", label);\n        btn.data(\"gid\", gid);\n\n        btn.click(function (e: JQueryEventObject) {\n\n            $(\".tooltip\").remove();\n\n            var buttonClicked = $(e.delegateTarget);\n            // make sure (drop down menus don't close\n            if (onDblClick) {\n                if (e.preventDefault)\n                    e.preventDefault();\n                if (e.stopPropagation)\n                    e.stopPropagation();\n\n                that.dbClickCounter++;\n\n                if (that.dbClickCounter === 1) {\n                    that.dbClickTimer = window.setTimeout(function () {\n                        // after 700 ms: reset counter and make the click\n                        that.dbClickCounter = 0;\n                        if (onClick) {\n                            onClick(buttonClicked);\n                        }\n                    }, 700);\n                } else {\n                    // dbl click...\n                    clearTimeout(that.dbClickTimer);\n                    that.dbClickCounter = 0;\n                    onDblClick(buttonClicked);\n                }\n\n            } else if (onClick) {\n                onClick(buttonClicked);\n            }\n        });\n\n        return btn;\n    }\n\n    // create one 'normal' label as button\n    private createLabel(labelId: string, gid: number, onClick: Function, onDblClick?: Function): JQuery {\n\n        var isNegative = false; // set true for negative project filters\n        if (labelId.indexOf(\"!\") !== -1) {\n            labelId = labelId.replace(\"!\", \"\");\n            isNegative = true;\n        }\n\n        var labelList = this.getLabelList();\n\n        var labelDef: ILabel;\n        $.each(this.groups[gid].labelDef, function (idx, ll) {\n            if (ll.label === labelId) {\n                labelDef = ll;\n            }\n        });\n\n        if (!labelDef) {\n            // the label does not exist (anymore): ignore\n            return $(\"\");\n        }\n\n        if (this.mode != \"project_filter\" && labelDef.editors && labelDef.editors.indexOf(matrixSession.getUser()) === -1) {\n            onClick = function () { };\n            onDblClick = function () { };\n        }\n        // figure out if label/filter should be shown as on\n        var isOn = labelDef.isSelected;\n        if (!isOn && this.mode === \"item_print\") {\n            // labels is off - so it should not be shown in print mode\n            return $(\"\");\n        }\n\n        // legacy logic to retrieve names/colors/icons\n        var displayName = labelDef.displayName ? labelDef.displayName : \"\";\n        var foreground = isOn ? \"white\" : labelDef.color;           // default: white on color is on\n        var background = isOn ? labelDef.color : \"transparent\";\n\n\n        var tooltip = labelDef.toolTipFilterOn ? labelDef.toolTipFilterOn : \"\";\n        var icon: string;\n\n        // new logic\n        if (labelDef.style) {\n            let stylefl = this.isFilter ? labelDef.style.filter : labelDef.style.label;\n            if (stylefl) {\n                let style = isOn ? stylefl.on : stylefl.off;\n                if (style) {\n                    displayName = style.displayName ? style.displayName : displayName; // overwrite name\n                    foreground = style.foreground ? style.foreground : foreground;\n                    background = style.background ? style.background : background;\n                    icon = style.icon ? style.icon : icon;\n                    tooltip = style.tooltip ? style.tooltip : tooltip;\n                }\n            }\n        }\n\n        if (labelDef && labelDef.label) {\n            if (tooltip) {\n                tooltip = labelDef.label + \": \" + tooltip;\n            } else {\n                tooltip = labelDef.label;\n            }\n        }\n        let btn: JQuery = null;\n        // create the button\n        if (icon || displayName) {\n            if (isNegative) {\n                displayName = displayName ? (\"NOT \" + displayName) : \"NOT\";\n            }\n            var statusClass = (isNegative ? \"labelIsNot \" : \"\") + (isOn ? \"labelIsOn \" : \"\");\n            if (this.mode == \"item_history\") {\n                // in history render a simplified version of labels to be more easily comparable\n                btn = this.createButton(labelId, gid, displayName + (isOn ? \" (on)\" : \" (off)\"), \"\", \"\", icon, onClick, onDblClick, \"labelInHistory\");\n            } else {\n                btn = this.createButton(labelId, gid, displayName, foreground, background, icon, onClick, onDblClick, statusClass);\n            }\n\n            if (tooltip) {\n                btn.tooltip({ title: tooltip, placement: \"bottom\", container: \"body\" });\n            }\n        }\n        if(btn.css(\"background\") == \"transparent\" && btn.css(\"color\") == \"rgb(0, 0, 0)\"){\n            btn.css(\"color\",\"var(--Accent)\");\n        }\n\n        return btn;\n    }\n\n    private addChip(gid: number) {\n\n            let that = this;\n\n            var btnGroup = $('<div class=\"btn-group labelTools chip\">');\n            this.ui.append(btnGroup);\n\n            $.each(this.groups[gid].labelDef, function (idx: number, label: ILabel) {\n\n                label.isNegative = that.currentLabelsOn.indexOf((\"!\" + label.label)) > -1;\n                label.isSelected = label.isNegative || that.currentLabelsOn.indexOf(label.label) > -1;\n                if(  label.isSelected)  {\n                    var btn = that.createLabel((label.isNegative ? \"!\" : \"\") + label.label, gid, ()=>{}, ()=>{});\n\n\n                    btn.append($(\"<a class='fal fa-times' />\").click(()=>{\n                        //Remove filter\n                        let currentFilter = ml.LabelTools.getFilter().split(\",\");\n                        let index = currentFilter.indexOf((label.isNegative ? \"!\" : \"\") + label.label);\n                        if(index > -1) {\n                            currentFilter = currentFilter.filter((value,i)=> i != index);\n                            ml.LabelTools.setFilter(currentFilter);\n                            $(\"#filterDialog\").remove();\n                            app.canNavigateAwayAsync().done(function () {\n                                $(\".tooltip\").remove();\n                                $(\".itemFilterTool\").hide();\n                                ml.LabelTools.setFilter(currentFilter);\n\n                                app.loadProject(matrixSession.getProject(), app.getCurrentItemId()).then(() => {\n                                    if (currentFilter.length > 0) {\n                                        $(\".itemFilterTool\").show();\n                                        new LabelSwitches($(\"#currentFilterContainer\"), false, null, currentFilter, \"filter_chip\", (sel) => {\n                                        });\n                                    } else {\n                                        $(\".itemFilterTool\").hide();\n                                    }\n                                    ml.UI.toggleFilters(true);\n\n                                });\n\n                            }).fail(function () {\n                                ml.UI.showError(\"Filter was not activated.\", \"To activate reload project after saving the item!\");\n                            });\n\n                        }\n\n\n                    }));\n                    btnGroup.append(btn);\n                }\n\n\n\n            });\n            return btnGroup;\n    }\n}\n","import { lab } from \"d3\";\nimport { XRLabelHistory } from \"../../RestResult\";\nimport { globalMatrix, restConnection } from \"../../globals\";\nimport { ml } from \"../matrixlib\";\nimport { LabelManager } from \"./LabelManager\";\nimport { IJSONTools, ILabelTools, ILoggerTools } from \"./MatrixLibInterfaces\";\n\nexport { LabelTools };\n\nclass LabelTools extends LabelManager implements ILabelTools {\n    constructor(logger: ILoggerTools, json: IJSONTools) {\n        super(logger, json, () => globalMatrix.ItemConfig);\n    }\n\n    async getLastTimeLabelWasSet(itemId: string, label: string, beforeRevision: number): Promise<number> {\n        const labelHistory: XRLabelHistory = <XRLabelHistory>await restConnection.getProject(\n            \"labelhistory?itemRef=\" + itemId);\n        return this.decipherLastTimeLabelWasSet(labelHistory, itemId, label, beforeRevision);\n    }\n}\n\n","import { ILabel, ILabelsConfig, IDesignReview, ILabelGroup } from \"../../ProjectSettings\";\nimport { XRLabelHistory } from \"../../RestResult\";\nimport { ItemConfiguration } from \"../businesslogic\";\nimport { ILoggerTools, IJSONTools, IChangedLabels, ILabelManager } from \"./MatrixLibInterfaces\";\nexport { LabelManager };\n\ntype GetItemConfigFunction = () => ItemConfiguration;\n\nclass LabelManager implements ILabelManager {\n    public ignoreProjectFilter = false;\n    private activeFilter = \"\";\n\n    constructor(protected logger: ILoggerTools, protected json: IJSONTools,\n        protected getConfig: GetItemConfigFunction) { }\n\n    getFilterColor(): string {\n        var labels = this.getConfig().getLabelsConfig();\n\n        if (!labels || !labels.filterBackgroundColor) {\n            return null;\n        }\n        return labels.filterBackgroundColor;\n    };\n\n    // return list of selected filters as , separated list\n    getFilter(): string {\n        if (this.ignoreProjectFilter) {\n            return \"\";\n        }\n        var filters: string[] = [];\n\n        var labelsAll = this.getLabelNames();\n        if (labelsAll.length === 0) {\n            return \"\";\n        }\n\n        var stored: string = this.activeFilter;\n        if (!stored || stored === \"\") {\n            return \"\";\n        }\n\n        // only return filters which (still) exist \n        var cs = stored.split(\",\");\n        for (let sf of cs) {\n            if (labelsAll.indexOf(sf.replace(\"!\", \"\")) > -1) {\n                filters.push(sf);\n            }\n        }\n\n        return filters.length > 0 ? filters.join(\",\") : \"\";\n    };\n\n    getDisplayName(labelId: string) {\n        let labels = this.getLabelList();\n        let displayName = \"\";\n        for (let label of labels) {\n            if (label.label == labelId) {\n                displayName = label.displayName;\n                if (label.style.label.on.displayName) {\n                    displayName = label.style.label.on.displayName;\n                }\n            }\n        }\n        return displayName;\n    }\n\n    getFilterName(labelId: string) {\n        let labels = this.getLabelList();\n        let displayName = \"\";\n        for (let label of labels) {\n            if (label.label == labelId) {\n                displayName = label.displayName;\n                if (label.style && label.style.filter && label.style && label.style.filter.on && label.style.filter.on.displayName) {\n                    displayName = label.style.filter.on.displayName;\n                }\n            }\n        }\n        return displayName;\n    }\n\n    // return the existing labels for the passed types (or all labels if no type is passed)\n    getLabelDefinitions(categories: string[]): ILabel[] {\n        var all = this.getLabelList();\n        if (!categories || categories.length === 0) {\n            return all;\n        }\n        let relevant: string[] = [];\n        let relevantLabel: ILabel[] = [];\n        for (let label of all) {\n            for (let category of label.categories) {\n                if (categories.indexOf(category) > -1 && relevant.indexOf(label.label) === -1) {\n                    relevant.push(label.label);\n                    relevantLabel.push(label);\n                }\n            }\n        }\n        return relevantLabel;\n    };\n\n    setFilter(filter: string[]) {\n        this.activeFilter = filter.join(\",\");\n    };\n\n    /* clean up the set labels: in case a set label is in review or design review group, \n        it is possible that the label is removed from the list of set labels / replaced by another label in the group.\n\n        This depends on the groups's setting.\n\n        @param addXor If no label is set in a xor group, the default can be automatically set.\n    \n        @return the list of labels after the review groups have been reset\n    \n     */\n    resetReviewLabels(labelIds: string[], category: string, addXor?: boolean): string[] {\n        let that = this;\n        let cleaned: string[] = [];\n        // get label groups\n        let groups = this.getLabelGroups();\n        let labelList = this.getLabelList();\n\n        // copy all lables besides the review labels\n        for (let label of labelIds) {\n            let isReviewLabel = false;\n            for (var gid = 0; gid < groups.length; gid++) {\n                if (((groups[gid].selection === \"review\" && this.json.isTrue(groups[gid].reset)) ||\n                    (groups[gid].selection === \"design_review\" && !this.json.isFalse(groups[gid].reset))) &&\n                    groups[gid].labels.indexOf(label) !== -1) {\n                    isReviewLabel = true;\n                }\n            }\n\n            if (!isReviewLabel) {\n                cleaned.push(label);\n            }\n        }\n        // add all default review states - if no other label is set in the review group\n        for (var gid = 0; gid < groups.length; gid++) {\n            if ((groups[gid].selection === \"review\" ||\n                (addXor && groups[gid].selection === \"xor\")) &&\n                groups[gid].default) {\n                var groupIsSet = false;\n                for (let cleanLabel of cleaned) {\n                    if (groups[gid].labels.indexOf(cleanLabel) !== -1) {\n                        groupIsSet = true;\n                    }\n                }\n                if (!groupIsSet) {\n                    // verify if label actually is defined for group...\n                    var defaultIsForType = false;\n                    for (let label of labelList) {\n                        if (groups[gid].default === label.label && label.categories.indexOf(category) !== -1) {\n                            defaultIsForType = true;\n                        }\n                    }\n                    if (defaultIsForType) {\n                        cleaned.push(groups[gid].default);\n                    }\n                }\n            }\n        }\n\n        return cleaned;\n    };\n\n    /* return the list of default labels for a category */\n    getDefaultLabels(category: string): string[] {\n        let that = this;\n\n        // get current positive filters\n        let currentFilter = this.getFilter();\n        let posFilter: string[] = [];\n        const filterItems = currentFilter.split(\",\");\n        for (let f of filterItems) {\n            if (f.indexOf(\"!\") !== 0) {\n                posFilter.push(f);\n            }\n        }\n        // each label which is not in a xor/review group can be default\n        let defaultLabels: string[] = [];\n        let labelList = this.getLabelList();\n        for (let label of labelList) {\n            let group = that.getGroupOfLabel(label.label);\n\n            if (group && label.categories.indexOf(category) !== -1 && // label must exist for cateogry type\n                (group.selection !== 'xor' && group.selection !== 'review') && // it must not be in a xor or review group\n                (this.json.isTrue(label.default) || // the default value must be set to on OR \n                    (label.default === \"filter\" && posFilter.indexOf(label.label) !== -1))) { // the default must be filter and it must be set in the current filter\n                defaultLabels.push(label.label);\n            }\n        }\n\n        return this.resetReviewLabels(defaultLabels, category, true);\n    };\n\n    hasLabels() {\n        return (this.getLabelList().length > 0);\n    };\n\n    // implement logic to set labels. \n    setLabels(oldLabelIds: string, labels: string[]): string {\n        let that = this;\n        let old = oldLabelIds ? oldLabelIds.split(\",\") : [];\n        for (let label of labels) {\n            old = that.setLabel(old, label);\n        }\n        return old.join(\",\");\n    }\n\n    // implement logic to set a label. \n    // This depends on the type of group: for xor / review labels other group members must be reset\n    setLabel(oldLabelIds: string[], label: string): string[] {\n        let labelIds: string[] = this.json.clone(oldLabelIds);\n\n        if (labelIds.indexOf(label) !== -1) {\n            // label already set - ignore\n            return labelIds;\n        }\n\n        let group = this.getGroupOfLabel(label);\n\n        if (!group || group.selection == \"or\") {\n            // simple label without group / or group: just set it\n            labelIds.push(label);\n        } else if (group.selection == \"xor\" || group.selection == \"review\") {\n            // remove all labels from group\n            for (let otherLabel of group.labels) {\n                labelIds = labelIds.filter(function (existingLabel) {\n                    return existingLabel != otherLabel;\n                });\n            }\n            // set the label\n            labelIds.push(label);\n        } else {\n            this.logger.log(\"warn\", \"setLabel: unkown group type of label: '\" + label + \"'\");\n        }\n\n        return labelIds;\n    };\n\n    // return the last time a label was set on a given item before a revision (=0 if any)\n    decipherLastTimeLabelWasSet(labelHistory: XRLabelHistory, itemId: string, label: string, beforeRevision: number): number {\n        let itemHistory = labelHistory.entries.filter(entry => entry.itemRef == itemId);\n        if (itemHistory.length > 0) {\n            let history = itemHistory[0].labels.filter(l => l.label == label);\n            if (history.length > 0 && history[0].set.length > 0) {\n                // ignore all sets after the beforeRevision  (unless 0 is passed)\n                let sets = history[0].set.filter(set => !beforeRevision || set.version < beforeRevision);\n                return sets[sets.length - 1].version;\n            }\n        }\n        // label was never set all good\n        return 0;\n    }\n\n    // implement logic to reset a label. \n    // This depends on the type of group: for xor / review labels a default label might need to be set\n    unsetLabel(oldLabelIds: string[], label: string): string[] {\n        let labelIds: string[] = this.json.clone(oldLabelIds);\n\n        if (labelIds.indexOf(label) === -1) {\n            // label is not actually set - ignore\n            return labelIds;\n        }\n\n        let group = this.getGroupOfLabel(label);\n\n        // remove the label\n        labelIds = labelIds.filter(function (existingLabel) {\n            return existingLabel != label;\n        });\n\n        if (!group || group.selection == \"or\") {\n            // simple label without group / or group - nothing else to do\n\n        } else if (group.selection == \"xor\" || group.selection == \"review\") {\n            if (group.default) {\n                labelIds.push(group.default);\n            }\n        } else {\n            this.logger.log(\"warn\", \"unsetLabel: unkown group type of label: '\" + label + \"'\");\n        }\n\n        return labelIds;\n    };\n\n    compareLabels(before: string[], after: string[]): IChangedLabels {\n        let result: IChangedLabels = {\n            changed: false,\n            added: [],\n            removed: [],\n            delta: \"\"\n        }\n\n        before = before || [];\n        after = after || [];\n        let delta: string[] = [];\n\n        for (var idx = 0; idx < after.length; idx++) {\n            if (before.indexOf(after[idx]) === -1) {\n                result.added.push(after[idx]);\n                delta.push(after[idx]);\n            }\n        }\n\n        for (var idx = 0; idx < before.length; idx++) {\n            if (after.indexOf(before[idx]) === -1) {\n                result.removed.push(before[idx]);\n                delta.push(\"-\" + before[idx]);\n            }\n        }\n        result.delta = delta.join(\",\");\n        result.changed = result.added.length + result.removed.length > 0;\n        return result;\n    }\n    static timeWarpLabel = \"_timewarp_\";\n\n    protected getLabelList(): ILabel[] {\n        let labelsAll = this.getConfig().getSetting(\"labels\");\n        if (!labelsAll) {\n            return [];\n        }\n        let labelsJson = this.json.fromString(labelsAll);\n        if (labelsJson.status !== \"ok\" || !(<ILabelsConfig>labelsJson.value).labels) {\n            return [];\n        }\n\n        return (<ILabelsConfig>labelsJson.value).labels;\n    }\n\n    getLabelNames(): string[] {\n\n        let labelList = this.getLabelList();\n\n        let allLabels: string[] = [];\n        for (let label of labelList) {\n            allLabels.push(label.label);\n        }\n\n        return allLabels;\n    }\n\n    protected getDesignReviews(): IDesignReview[] {\n        let labelsAll: string = this.getConfig().getSetting(\"labels\");\n        if (!labelsAll) {\n            return [];\n        }\n        var labelsJson = this.json.fromString(labelsAll);\n        if (labelsJson.status !== \"ok\") {\n            return [];\n        }\n\n        return (<ILabelsConfig>labelsJson.value).design_reviews ? (<ILabelsConfig>labelsJson.value).design_reviews : [];\n    }\n\n    getDesignReview(labelId: string): IDesignReview | null {\n        var dr = this.getDesignReviews();\n        for (var idx = 0; idx < dr.length; idx++) {\n            if (dr[idx].label === labelId) {\n                return dr[idx];\n            }\n        }\n        return null;\n    }\n\n    isFiltered(category: string, labels: string): boolean {\n\n        let filters = this.getFilter();\n        if (!filters) return false; // no filters -> not filtered out \n\n        let isFilteredOut = false;\n        // there are some filters so lets check\n        let labelsSet = labels ? labels.split(\",\") : [];\n        let labelsForItem = this.getLabelDefinitions([category]).map(function (labelDef) { return labelDef.label; });\n\n        const filtersArray = filters.split(\",\");\n        filtersArray.forEach((filter) => {\n            let label = filter.replace(\"!\", \"\"); // to get rid of negation of filters\n            if (labelsForItem.indexOf(label) == -1) return; // irrelevant, try next filter\n            if (label != filter) { // negative filter\n                isFilteredOut = isFilteredOut || labelsSet.indexOf(label) != -1;\n            } else {\n                isFilteredOut = isFilteredOut || labelsSet.indexOf(label) == -1;\n            }\n        });\n        return isFilteredOut;\n    }\n\n    getLabelsOfLabelGroupsType(labelGroupType: string): string[] {\n        if (!labelGroupType) {\n            return [];\n        }\n        let labels: string[] = [];\n        for (let lg of this.getLabelGroups()) {\n            if (lg.groupType == labelGroupType) {\n                labels = labels.concat(lg.labels);\n            }\n        }\n        for (let lg of this.getDesignReviews()) {\n            if (lg.groupType == labelGroupType) {\n                labels.push(lg.label);\n            }\n        }\n\n        return labels;\n    }\n    getLabelGroups(category?: string): ILabelGroup[] {\n        let labelsAll = this.getConfig().getSetting(\"labels\");\n        if (!labelsAll) {\n            return [];\n        }\n        let labelsJson = this.json.fromString(labelsAll);\n        if (labelsJson.status !== \"ok\") {\n            return [];\n        }\n\n        let labelList = this.getLabelList();\n        let groups: ILabelGroup[] = (<ILabelsConfig>labelsJson.value).groups ? (<ILabelsConfig>labelsJson.value).groups : [];\n        let design_reviews = this.getDesignReviews();\n\n        // by default all labels end up in the last group\n        for (var gid = 0; gid < groups.length; gid++) {\n            // prepare to add label definitions of actual labels to display\n            groups[gid].labelDef = [];\n            // by default all filters are in \"or\" mode\n            if (!groups[gid].filterSelection) {\n                groups[gid].filterSelection = \"or\";\n            }\n        }\n\n        // now add actual labels to display to each group, any label should be displayed at most once\n        labelList.forEach((label) => {\n            if (category && label.categories.indexOf(category) === -1) {\n                // this is an item, and label does not exist for item\n                return;\n            }\n\n            // check if label is in group\n            for (var gid = 0; gid < groups.length; gid++) {\n                for (var lid = 0; lid < groups[gid].labels.length; lid++) {\n                    if (groups[gid].labels[lid] === label.label) {\n                        groups[gid].labelDef.push(label);\n                        return;\n                    }\n                }\n            }\n\n            // check if label is in review\n            for (var gid = 0; gid < design_reviews.length; gid++) {\n                if (design_reviews[gid].label === label.label) {\n                    groups.push({\n                        selection: \"design_review\", labels: [label.label], filterSelection: \"or\", labelDef: [label], reset: design_reviews[gid].reset,\n                        filterMenu: design_reviews[gid].filterMenu\n                    });\n                    return;\n                }\n            }\n\n            // create a new group\n            groups.push({ virtualGroup: true, selection: \"or\", labels: [label.label], filterSelection: \"or\", labelDef: [label] });\n        });\n\n        return groups;\n    }\n\n    // returns the group of a label\n    protected getGroupOfLabel(labelID: string): ILabelGroup | null {\n        let groups = this.getLabelGroups();\n        for (var gid = 0; gid < groups.length; gid++) {\n            if (groups[gid].labels.indexOf(labelID) !== -1) {\n                return groups[gid];\n            }\n        }\n        return null;\n    }\n    // returns the background color of the main tool bar to be used if filters are activated\n\n}\n\n","import { globalMatrix } from \"../../../globals\";\nimport { IVizMode, SelectMode } from \"./ProjectViewDefines\";\nimport { ProjectView } from \"./ProjectView\";\n\nexport { ViewModeSelector };\n\n\n  // this function manages the display style selection of the tree\nclass ViewModeSelector {\n\n    private isMainTree:boolean;\n    private btn:JQuery;\n    private img:JQuery;\n    private searchVizModes: IVizMode[];\n    private panel:ProjectView;\n\n    constructor(panel:ProjectView) {\n        this.panel = panel;\n        this.isMainTree = panel.settings.canSelectItems;\n\n        this.searchVizModes = [\n            // uid: a unique id used by selenium tests...\n            // icon: icon to show\n            // text: text in drop down\n            // maintree: whether available in main tree,\n            // asList: whether to show as list\n            // hide: whether to hide elements which don't match\n            // expand: whether to expand tree\n            {\n                uid: \"0\", icon: \"search_dimtree.svg\", text: \"grey out mismatches\",\n                mainTree: true, asList: false, hide: false, check: false, expand: false\n            }\n            , {\n                uid: \"1\", icon: \"search_expanddimtree.svg\", text: \"grey out mismatches and expand tree\",\n                mainTree: true, asList: false, hide: false, check: false, expand: true\n            }\n            , {\n                uid: \"2\", icon: \"search_hidetree.svg\", text: \"hide mismatches\",\n                mainTree: true, asList: false, hide: true, check: false, expand: false\n            }\n            , {\n                uid: \"3\", icon: \"search_expandtree.svg\", text: \"hide mismatches and expand tree\",\n                mainTree: true, asList: false, hide: true, check: false, expand: true\n            }\n\n            //    ,{ icon:\"search_checklist.png\", text:\"select in list\",   mainTree:false,   asList:true,  hide:true,    check:true , expand:false}\n            //   ,{ icon:\"search_checktree.png\", text:\"select in tree\",   mainTree:false,   asList:false, hide:false,   check:true, expand:false }\n        ];\n        if (!this.selectFoldersOnly()) {\n            this.searchVizModes.push( {\n                uid: \"4\", icon: \"search_list.svg\", text: \"show as list\",\n                mainTree: true, asList: true, hide: true, check: false, expand: false\n            });\n        }\n        if( this.panel.settings.isConfigSearch?? false)\n        {\n            this.searchVizModes = this.searchVizModes.filter((i)=>{return i.uid === \"1\";})\n        }\n    }\n\n    private selectFoldersOnly() {\n        return !!(this.panel && this.panel.settings && (this.panel.settings.selectMode==SelectMode.singleFolder || this.panel.settings.selectMode==SelectMode.folders));\n    }\n    getVizModeControl (onChange:Function):JQuery {\n        let that = this;\n\n        let lastMode = this.getMode();\n\n        var current = this.searchVizModes[lastMode];\n        var btn_grp = $('<div class=\"searchVizMode\" style=\"\">');\n        this.btn = $('<div data-cy=\"searchMode\"\" type=\"button\" title=\"\" data-original-title=\"Tree search filter mode\" data-toggle=\"dropdown\" class=\" earchVizMode btn btn-stree btn-sm dropdown-toggle\">');\n        this.img = $('<img style=\"height:24px; margin-left: 0px;\" src=\"' + globalMatrix.matrixBaseUrl + '/img/' + current.icon + '\" />');\n        this.btn.append(`<div class=\"btnContent\"> <img style=\"margin-left: -6px;\" src=\"${ globalMatrix.matrixBaseUrl + '/img/' +current.icon}\" />\n                                   <span style=\"padding-left:10px\">${current.text}<span></div>`);\n\n        this.btn.append('<span style=\"margin-left: 0px;\"  class=\"caret\">');\n        btn_grp.append( this.btn );\n        this.btn.data(\"uid\",current.uid);\n        this.setEnabled( false );\n        var ul = $(' <ul class=\"dropdown-menu dropdown-menu-sub\" role=\"menu\"> ');\n        for ( var idx=0; idx<this.searchVizModes.length; idx++) {\n            if ( !this.isMainTree || this.searchVizModes[idx].mainTree ) {\n                var img_src = globalMatrix.matrixBaseUrl + '/img/' + this.searchVizModes[idx].icon;\n\n                var li = $(`<li data-cy=\"${this.searchVizModes[idx].text}\"  title=\"${this.searchVizModes[idx].text}\">\n                        <a href=\"javascript:void(0)\">\n                            <img style=\"margin-left: -6px;\" src=\"${img_src}\" />\n                            <span style=\"padding-left:10px\">${this.searchVizModes[idx].text}<span>\n                        </a>\n                    </li>`);\n                ul.append(li);\n                li.click((event: JQueryEventObject) => {\n                    var selIdx = $(event.delegateTarget).data(\"lidx\");\n                    var imgLink = globalMatrix.matrixBaseUrl + '/img/' + this.searchVizModes[selIdx].icon;\n                    that.btn.data(\"uid\",$(event.delegateTarget).data(\"uid\"));\n                    that.btn.find(\".btnContent\").html(`<img style=\"margin-left: -6px;\" src=\"${imgLink}\" />\n                            <span style=\"padding-left:10px\">${this.searchVizModes[selIdx].text}<span>`);\n\n                    if( that.panel.settings.isConfigSearch == undefined ||  that.panel.settings.isConfigSearch == false)\n                    {\n                        that.setMode(selIdx);\n                    }\n                    onChange();\n                }).data(\"lidx\",idx).data(\"uid\",this.searchVizModes[idx].uid).data(\"img_src\", img_src);\n\n            }\n        }\n        btn_grp.append( ul );\n        return btn_grp;\n    }\n\n\n    // function to grey out button (in case nothing is in search bar)\n    setEnabled(enabled:boolean):void {\n        $(\"img\", this.btn).css(\"opacity\", enabled?1:0.3);\n    }\n\n    showAsList ( ):boolean {\n        return this.searchVizModes[this.getMode()].asList;\n    }\n\n    hideMismatches( ):boolean {\n        return this.searchVizModes[this.getMode()].hide;\n    }\n\n    isExpandTree ( ):boolean {\n        return this.searchVizModes[this.getMode()].expand;\n    }\n\n       // rememebered last filter\n    private getMode():number {\n        var svm = localStorage.getItem('searchFilter' + (this.isMainTree?\"Select\":\"Main\"));\n        if (svm) {\n            let option = parseInt(svm);\n            return option >= this.searchVizModes.length?0:option;\n        } else {\n            return 0; // default dimmable tree\n        }\n    }\n    // remember last filter method\n    private setMode( mode:number ) {\n        localStorage.setItem('searchFilter' + (this.isMainTree ? \"Select\" : \"Main\"), mode.toString());\n    }\n}\n\n","\n//Import\n/// <reference types=\"matrixrequirements-type-declarations\" />\n\nimport { DateFieldHandler, IDB, MatrixSession } from \"../../common/businesslogic/index\";\nimport { IPlugin, IProjectPageParam, IPluginPanelOptions, plugins } from \"../../common/businesslogic/index\";\nimport { ml } from \"../../common/matrixlib\";\nimport { DateSelectImpl } from \"../../common/UI/Controls/dateselect\";\nimport { NavigationPanel } from \"../../common/UI/MainTree/MainTree\";\nimport { IItem, IStringNumberMap, ControlState, app, matrixSession, restConnection, globalMatrix,  } from \"../../globals\";\nimport { INotificationConfig, IContextPageConfigTab, notificationSetting, defaultNotificationConfig } from \"../../ProjectSettings\";\nimport { XRGetTodosAck, XRTodo, XRGetProject_Todos_GetTodosAck, XRTodoCount } from \"../../RestResult\";\nimport { IContextInformation, UIToolsConstants } from \"../../common/matrixlib/MatrixLibInterfaces\";\nimport { NavBar } from \"../../common/UI/Components\";\nimport { NotificationsBL } from \"../../common/businesslogic/NotificationsBL\";\nimport { INotificationsChanges } from \"../../common/businesslogic/NotificationsCache\";\n\nexport type { INotificationTableOptions };\nexport { Notifications, NotificationList };\nexport { initialize };\n\ninterface INotificationTableOptions {\n    allowDelete:boolean,\n    selectable: boolean;\n    forColumn: boolean;\n    itemColumn: boolean;\n    doneColumn: boolean;\n    canCloseMine: boolean;\n    canCloseAll: boolean;\n    showAddButton: boolean;\n    none: string;\n    tableClass?:string,\n    moveDoneTo?:string\n}\n\n// TODO: This is not a plugin since there are places in the code which refer to the class statically.\n// Integrate it into businesslogic.\nclass Notifications implements IPlugin {\n\n    private notificationConfig:INotificationConfig;\n    private lastCount:number;\n    private newNotification:boolean;\n    private _item:IItem;\n    private lastMenu:JQuery;\n    private projectCount:IStringNumberMap = null;\n    public isDefault = true;\n    previousNotificationsIds: number[] = [];\n\n    constructor() {\n        this.addFancyTreeNotificationCounterPlugin();\n        this.watchActivity();\n\n\n\n    }\n    onUpdate(ui: JQuery, config: IContextPageConfigTab, context: IContextInformation) {\n\n    }\n\n    init()\n    {\n\n        let that = this ;\n        $().ready(()=>{\n            if (matrixSession && matrixSession.serverConfig) {\n\n                let all = restConnection.getServer(\"all/todo\").done((result) => {\n                    that.setPreviousNotificationsIds( (<XRGetTodosAck>result).todos.map((o)=>{return o.todoId ;})) ;\n                });\n\n            }\n\n    });\n\n    }\n    setPreviousNotificationsIds(notifIds: number[]) {\n\n        localStorage.setItem(\"previousNotificationsIds\", JSON.stringify(notifIds));\n\n    }\n    getPreviousNotificationsIds(): number[] {\n\n        let notif = [];\n        let notifAsString = localStorage.getItem(\"previousNotificationsIds\");\n\n        if(notifAsString != undefined )\n        {\n             let parseNotif =  JSON.parse(notifAsString);\n            if( parseNotif != undefined)\n            {\n                return parseNotif;\n            }\n\n        }\n        return notif;\n\n    }\n    initItem( item:IItem, jui:JQuery ) {\n        if (!this.isEnabled()) {\n            return;\n        }\n        this._item = item;\n        if (!this.projectCount) {\n            this.projectCount = {};\n            this.countRec(app.getTree());\n        }\n    }\n\n    initServerSettings() {\n    }\n\n    initProject() {\n        this.notificationConfig = <INotificationConfig>matrixSession.getCustomerSettingJSON(notificationSetting, defaultNotificationConfig);\n        NotificationsBL.NoticationCache.setEnabled(this.isEnabled());\n\n        if (!this.isEnabled()) {\n            return;\n        }\n        this.updateProjectMenu();\n        this.init();\n        this.projectCount = null;\n    }\n\n    isEnabled() {\n        return this.notificationConfig && this.notificationConfig.enabled;\n    }\n\n\n    getProjectPagesAsync():Promise<IProjectPageParam[]> {\n        return new Promise((resolve, reject) => {\n            let pages:IProjectPageParam[] = [];\n            let that = this;\n\n            if (this.isEnabled() && !globalMatrix.ItemConfig.getTimeWarp()) {\n                pages.push({ id: \"NOTIFICATION\", title:  \"My Notifications\", folder:\"MYWORK\", order:2000, icon:\"fal fa-bell\",  usesFilters:false,\n                    render: async (options: IPluginPanelOptions) => that.renderNotificationProjectPage(options)});\n            }\n            window.setTimeout( function() {\n                if (!that.projectCount) {\n                    that.projectCount = {};\n                    that.countRec(app.getTree());\n                }\n            }, 1);resolve(pages);\n        })\n    }\n\n    updateMenu(ul:JQuery) {\n        if (!this.isEnabled() || !ul || !this._item || ml.Item.parseRef(this._item.id).isFolder) {\n            return;\n        }\n\n        let that = this;\n\n        this.lastMenu = ul;\n\n        $(\".notificationMenu\").remove();\n        $(\".notificationBtn\").remove();\n\n        let myNotification = NotificationsBL.NoticationCache.getProjectNotifications(matrixSession.getProject(), app.getCurrentItemId());\n\n        let myNotificationMarker = myNotification.length?\n            (\"<i class='fal fa-bell '></i><span class='fancytree-notificationCounter notificationCounter'>\" + myNotification.length + \"</span>\"):\n            \"<i class='fal fa-bell '></i>\";\n        $('<div class=\"btn-group\" style=\"\"><button class=\"btn btn-item btn-sm notificationBtn\" tabindex=\"-1\" title=\"Show and create notifications\">'+myNotificationMarker+'</button></div>').click( function( event:JQueryMouseEventObject ) {\n            that.showAllNotificationsDialog();\n        }).insertBefore( $(\"#shareButton\").closest(\"div\"));\n\n    }\n\n    private userCanAcknowledgeNotification(notification:XRTodo) {\n        return !notification.auto;\n        // that should be  notification.action.todoType == \"user\" ||  notification.action.todoType == \"signaturesDone\" ||  notification.action.todoType == \"reviewsDone\";\n    }\n    supportsControl() {\n        return  false;\n    }\n\n\n\n    private watchActivity() {\n        let that = this;\n\n        $(window).on('keyup click', function(event) {\n            if (that.newNotification) {\n                app.updateFavicon(matrixSession.getProject(), false);\n                that.newNotification = false;\n            }\n        });\n    }\n\n    private updateActivity(newCount:number) {\n        if (newCount > this.lastCount) {\n            app.updateFavicon(matrixSession.getProject(), true);\n            this.newNotification = true;\n        }\n        this.lastCount = newCount;\n    }\n\n\n    // this gets all the updates about the user's notifications after being signalled that something changed for the user\n     async updateUI(notifChanged:INotificationsChanges) {\n        let that = this;\n            // update UI\n        that.projectCount = null;  // removing the cache, so it will be reloaded next time updateCounters is called\n\n        let total = notifChanged.total;\n        let allNotifications = notifChanged.allNotifications;\n\n        that.updateCounters();\n        that.updateActivity( total );\n        that.updateMenu(that.lastMenu);\n\n        // Send browser notification. The random delay will avoid duplicates\n        if( that.notificationConfig.browserNotificationDisabled == undefined || that.notificationConfig.browserNotificationDisabled == false)\n        {\n            let timeOut =  that.notificationConfig.browserNotificationAutoCloseAfter != undefined ?  that.notificationConfig.browserNotificationAutoCloseAfter : 9000;\n\n            allNotifications.todos.forEach((t)=>{\n                if (that.getPreviousNotificationsIds().indexOf(t.todoId) == -1 && t.login == matrixSession.getUser())\n                {\n                    if (  window.Notification != undefined ) {\n\n                    if ( window.Notification.permission !== \"granted\")\n                            window.Notification.requestPermission();\n                    else {\n                            var n = new Notification(t.projectShort  + \"/\" + t.itemRef , {\n                                icon: globalMatrix.matrixBaseUrl + \"/favicon_medical.ico\",\n                                body: t.originatorLogin  + \": \" +  NotificationsBL.getMessage( t )   ,\n                                requireInteraction: true,\n                            });\n\n                            n.onclick = ()=>{ window.open(globalMatrix.matrixBaseUrl  + \"/\" +t.projectShort + \"/\"  + t.itemRef )};\n                            }\n                            setTimeout(()=>{ if(n!=undefined)\n                            {\n                                n.close();\n                            }\n                            },timeOut);\n                        }\n                    }\n                });\n\n        }\n        that.setPreviousNotificationsIds(allNotifications.todos.map((o)=>{return o.todoId ;})) ;\n\n    }\n\n\n\n    private async renderNotificationProjectPage(options:IPluginPanelOptions) {\n        let that = this;\n\n        if (options.controlState === ControlState.Print) {\n            return;\n        }\n\n        document.title = \"Notifications - \" + matrixSession.getProject();\n\n        options.control.html(\"\");\n\n        let h2 = ml.UI.getPageTitle(\"Notifications overview\").appendTo(options.control);\n        // paint the tabs\n        let tabpanel = $('<div role=\"tabpanel\" class=\"tabpanel-container contextFrameContainer\" style=\"top:60px;padding: 5px;\">');\n        let tabpanelul = $('<ul class=\"nav nav-tabs contextFrameTabs\" role=\"tablist\">');\n\n        let tabpanels = $('<div class=\"tab-content\">');\n        // enable copy\n        ml.UI.copyBuffer( h2, \"copy to clipboard\", tabpanels, options.control, ( copied:JQuery) => {\n            $(\".tabpaneltab.tab-pane\", copied).not(\".active\").remove();\n            $(\".tab-content\", copied).css(\"height\", \"\");\n        });\n\n        options.control.append(tabpanel);\n        tabpanel.append(tabpanelul);\n        tabpanel.append(tabpanels);\n\n        tabpanelul.append('<li role=\"presentation\" class=\"active\"><a href=\"#MYNOTIFICATIONS\"  role=\"tab\" data-toggle=\"tab\">Notifications for me</a></li>');\n        let myNotifications = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane active\" id=\"MYNOTIFICATIONS\" >');\n        tabpanels.append(myNotifications);\n\n        tabpanelul.append('<li role=\"presentation\"><a href=\"#MYDONE\"  role=\"tab\" data-toggle=\"tab\">My previous notifications</a></li>');\n        let myDone = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane\" id=\"MYDONE\" >');\n        tabpanels.append(myDone);\n\n        tabpanelul.append('<li role=\"presentation\"><a href=\"#MYOWNED\"  role=\"tab\" data-toggle=\"tab\">Notifications I created</a></li>');\n        let myOwned = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane\" id=\"MYOWNED\" >');\n        tabpanels.append(myOwned);\n\n        tabpanelul.append('<li role=\"presentation\"><a href=\"#MYOWNEDDONE\"  role=\"tab\" data-toggle=\"tab\">Previous notifications I created</a></li>');\n        let myOwnedDone = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane\" id=\"MYOWNEDDONE\" >');\n        tabpanels.append(myOwnedDone);\n\n        // adjust heights of panels\n        let height = $(\"#main\").height() - tabpanels.offset().top + $(\"#main\").offset().top;\n        tabpanels.height(  height );\n\n\n        let notifs = await NotificationsBL.getGetNotificationsNowAndFuture(matrixSession.getProject());\n        that.renderNotificationTable(myNotifications, {\n            allowDelete: globalMatrix.globalShiftDown, selectable: globalMatrix.globalShiftDown, forColumn: false, itemColumn: true, doneColumn: false, canCloseMine: true, canCloseAll: false, showAddButton: false, none: \"you have no todos\", moveDoneTo: \"MYDONE\"\n        }, notifs.todosForNow.filter(function (notification) {\n            return notification.login == matrixSession.getUser() && !notification.closedAt;\n        }));\n\n        that.renderNotificationTable(myNotifications, {\n            allowDelete: globalMatrix.globalShiftDown, selectable: globalMatrix.globalShiftDown, forColumn: false, itemColumn: true, doneColumn: false, canCloseMine: true, canCloseAll: true, showAddButton: false, none: \"\", moveDoneTo: \"MYDONE\"\n        }, notifs.todosForLater.filter(function (notification) {\n            return notification.login == matrixSession.getUser() && !notification.closedAt;\n        }));\n        that.renderNotificationTable(myDone, {\n            allowDelete: globalMatrix.globalShiftDown, selectable: false, forColumn: false, itemColumn: true, doneColumn: true, canCloseMine: false, canCloseAll: true, showAddButton: false, none: \"you did not finish any todo\"\n        }, notifs.todosForNow.filter(function (notification) {\n            return notification.login == matrixSession.getUser() && notification.closedAt;\n        }));\n        that.renderNotificationTable(myOwned, {\n            allowDelete: globalMatrix.globalShiftDown, selectable: globalMatrix.globalShiftDown, forColumn: true, itemColumn: true, doneColumn: false, canCloseMine: false, canCloseAll: true, showAddButton: false, none: \"you did not create any todos\", moveDoneTo: \"MYOWNEDDONE\"\n        }, notifs.todosForNow.filter(function (notification) {\n            return notification.originatorLogin == matrixSession.getUser() && !notification.closedAt;\n        }));\n        that.renderNotificationTable(myOwned, {\n            allowDelete: globalMatrix.globalShiftDown, selectable: globalMatrix.globalShiftDown, forColumn: true, itemColumn: true, doneColumn: false, canCloseMine: false, canCloseAll: true, showAddButton: false, none: \"\"\n        }, notifs.todosForLater.filter(function (notification) {\n            return notification.originatorLogin == matrixSession.getUser() && !notification.closedAt;\n        }));\n        that.renderNotificationTable(myOwnedDone, {\n            allowDelete: globalMatrix.globalShiftDown, selectable: false, forColumn: true, itemColumn: true, doneColumn: true, canCloseMine: false, canCloseAll: false, showAddButton: false, none: \"none of your todos were done\"\n        }, notifs.todosForNow.filter(function (notification) {\n            return notification.originatorLogin == matrixSession.getUser() && notification.closedAt;\n        }));\n\n        app.waitForMainTree(() => { options.control.highlightReferences() });\n    }\n    // renders a row with a notifications and +- actions on it\n    protected renderNotificationRow(tr:JQuery, notification:XRTodo, tableOptions:INotificationTableOptions) {\n        let that = this;\n\n        let isAutomatic = !that.userCanAcknowledgeNotification( notification );\n        let isForMe = notification.login == matrixSession.getUser();\n        let isFromMe = notification.originatorLogin == matrixSession.getUser();\n\n        if ( notification.future) {\n            tr.addClass(\"future\");\n        }\n        if ( notification.closedAt) {\n            tr.addClass(\"past\");\n        }\n        if ( !isForMe) {\n            tr.addClass(\"others\");\n        }\n\n        if (tableOptions.selectable || tableOptions.allowDelete) {\n            let input = $('<input class=\"notificationSelector\" type=\"checkbox\">').data(\"todoid\", notification.todoId);\n            $('<td>').appendTo(tr).append(input);\n        }\n        if (tableOptions.itemColumn) $('<td>' + notification.itemRef + '!</td>').appendTo(tr);\n        if (tableOptions.forColumn) $('<td>' + (notification.login == matrixSession.getUser() ? \"You\" : notification.login) + '</td>').appendTo(tr);\n        $('<td style=\"white-space: pre-wrap;\"\">' +  NotificationsBL.getMessage( notification) + '</td>').appendTo(tr);\n        $('<td>' + notification.originatorLogin + '</td>').appendTo(tr);\n        $('<td>' + notification.createdAtUserFormat + '</td>').appendTo(tr);\n        if (tableOptions.doneColumn)  $('<td>' + notification.closedAtUserFormat + '</td>').appendTo(tr);\n        if (tableOptions.canCloseMine || tableOptions.canCloseAll) {\n            if (tableOptions.canCloseAll||isForMe||isFromMe) {\n                let td = $('<td>').appendTo(tr);\n                if (isAutomatic && !that.notificationConfig.closeAuto) {\n                    return;\n                }\n                if (notification.closedAt) {\n                    if (!tableOptions.doneColumn) $('<span class=\"closedAt\">Closed: ' + notification.closedAtUserFormat + '</span>').appendTo(td);\n                    return;\n                }\n                let closeStyle = \"btn-link\";\n                let closeText = \"acknowledge\";\n                let closeTitle = \"remove notification\";\n                if (isAutomatic) {\n                    closeStyle = \"btn-link\";\n                    closeText = \"force acknowledge\";\n                    closeTitle = \"notification will also go once you do the job!\"\n                }\n                if (notification.future) {\n                    closeStyle = \"btn-link\";\n                    closeText = \"acknowledge already\";\n                    closeTitle =\"remove notification already now\";\n                }\n                if (!isForMe) {\n                    closeStyle = \"btn-link\";\n                    closeText = \"mark done\";\n                    closeTitle = \"mark notification as done for someone else\"\n                }\n                if (tableOptions.moveDoneTo) {\n                    tr.addClass(\"canBeClosed\");\n                    tr.data(\"todoId\", notification.todoId);\n                    tr.data(\"moveTo\", tableOptions.moveDoneTo);\n                }\n                $('<button class=\"' + closeStyle + '\" title=\"' + closeTitle + '\">' + closeText + '</button>').appendTo(td).click( function(event:JQueryMouseEventObject) {\n                    let button = $(event.delegateTarget);\n                    NotificationsBL.deleteNotificationId(matrixSession.getProject(), button.data(\"todoid\"), false).then(function () {\n                        if ( tableOptions.moveDoneTo ) {\n\n                            let todoId = button.closest(\"tr\").data(\"todoId\");\n                            let toBeMoved = $(\".canBeClosed\").filter(function(trIdx, tr) { return $(tr).data(\"todoId\")==todoId;});\n                            $.each( toBeMoved, function( idx, tbm) {\n                                let moveTo = $(tbm).data(\"moveTo\");\n                                let tbodys = $(\"tbody\", $(\"#\" +moveTo));\n                                if ( tbodys.length ) {\n                                    $(\".btn\", $(tbm) ).replaceWith(\"<span>just now</span>\");\n                                    $(tbodys[0]).append( $(tbm) );\n                                } else {\n                                    button.closest(\"tr\").remove();\n                                }\n                            });\n                        } else {\n                            button.closest(\"tr\").remove();\n                        }\n                    });\n                }).data(\"todoid\", notification.todoId);\n            } else {\n                $('<td>').appendTo(tr);\n            }\n        }\n    }\n    // renders a table with notifications and +- actions on them\n    protected renderNotificationTable(container:JQuery, tableOptions: INotificationTableOptions, notifications:XRTodo[]) {\n        let that = this;\n\n        if ( notifications.length == 0 && !tableOptions.showAddButton) {\n            if (tableOptions.none) {\n                $('<p>').html(tableOptions.none).appendTo(container);\n            }\n            return;\n        }\n\n        let table = $(\"<table class='table table-lined \"+(tableOptions.tableClass?tableOptions.tableClass:\"\")+\"'>\");\n\n        if (!tableOptions.none) {\n            $('<p>').html(\"Upcoming notifications\").appendTo(container);\n        }\n        let tbody = $(\"<tbody>\");\n\n        // add notifications\n        $.each(notifications, function(idx, notification) {\n            let tr = $(\"<tr>\").appendTo(tbody)\n            that.renderNotificationRow(tr, notification, tableOptions);\n        });\n\n        // create table with headings and body\n        let thead = $(\"<thead><tr>\"\n        +((tableOptions.selectable || tableOptions.allowDelete)?\"<th data-sorter='false' style='white-space: nowrap;'><input class='selectAllNotification' type='checkbox'> all</th>\":\"\")\n        +(tableOptions.itemColumn?\"<th>Item</th>\":\"\")\n        +(tableOptions.forColumn?\"<th>Notification For</th>\":\"\")\n        +\"<th>Notification</th><th>Originator</th><th>Due date</th>\" + ( tableOptions.doneColumn?\"<th>Done at</th>\":\"\")\n        +((tableOptions.canCloseMine || tableOptions.canCloseAll)?\"<th></th>)\":\"\")\n        +\"</tr></thead>\");\n\n        if (tableOptions.showAddButton && this.notificationConfig.manualCreate) {\n            //  create an extra row with add button\n            let addRow =  $(\"<tr>\").appendTo(tbody);\n            let columnCount = $(\"th\", thead).length;\n            let addCell =  $(\"<td colspan='\" + columnCount  + \"'>\").appendTo( addRow );\n\n            $(\"<button style='margin-top: 12px;' class='btn btn-success btn-xs'><i class='fal fa-bell' style='margin-right:12px'></i>Create New</button>\")\n            .appendTo(addCell)\n            .click( function() {\n                that.showCreateNotificationDialog( ).done( async function( todoIds:Number[] ) {\n                   let allNotification =  await NotificationsBL.getAllNotificationForItem( matrixSession.getProject(), app.getCurrentItemId() );\n                        // create is always for current item\n                        let todos = allNotification.todos.filter( function( todo) {return todoIds.indexOf( todo.todoId )!=-1;});\n                        $.each( todos, function(idx,todo) {\n                            let newNotificationRow = $(\"<tr>\").insertBefore(addRow);\n                            that.renderNotificationRow( newNotificationRow, todo, tableOptions);\n                        });\n                        table.trigger('update');\n                    });\n            });\n        }\n\n        // assemble table\n\n        table.append(thead)\n        .append(tbody)\n        .appendTo(container).tablesorter();\n\n        if (tableOptions.selectable || tableOptions.allowDelete) {\n            $(\".selectAllNotification\", table).click( function() {\n                $(\".notificationSelector\", table).prop(\"checked\", $(\".selectAllNotification\", table).prop(\"checked\"));\n            });\n            if ( tableOptions.selectable ) {\n                $(\"<button title class='btn btn-xs btn-default hideCopy'>Mark as done</button>\").appendTo(container).click( function() {\n                    that.closeNotifications($(\".notificationSelector:checked\", table), false);\n                });\n            }\n            if ( tableOptions.allowDelete ) {\n                $(\"<button title class='btn btn-xs btn-default hideCopy'>Permanently delete</button>\").appendTo(container).click( function() {\n                    that.closeNotifications($(\".notificationSelector:checked\", table), true);\n                });\n            }\n\n            $(\"<p><br></p>\").appendTo(container);\n        }\n    }\n\n    protected indicateNotificationChange() {\n        $(\".notificationBtn\").removeClass(\"bounce\").addClass(\"bounce\");\n    }\n    protected closeNotifications( notifications:JQuery, deleteThem:boolean) {\n        ml.UI.BlockingProgress.Init([{name:\"Acknowledging notifications\"}]);\n        this.deleteNotificationIdRec(matrixSession.getProject(), notifications, deleteThem, 0);\n    }\n    // show all notifications for current user\n    protected updateProjectMenu() {\n        let that = this;\n\n        let menu = $(\"#idNotificationList\");\n        let menuResponsive = $(\"#idNotificationListResponsive\");\n        // add a navigation icon left next button to project  menu\n        $(\".notificationBtnMenu\").remove();\n        let projectButton = $('<button class=\"btn btn-item  notificationBtnMenu dropdown-toggle\" data-toggle=\"dropdown\" title=\"\" data-original-title=\"Show all notifications\"><i class=\"fal fa-bell notificationAction\"></i></button>')\n            .insertBefore(menu);\n        let projectButtonResponsive = $('<buttton class=\"btn btn-item  notificationBtnMenu dropdown-toggle\" data-toggle=\"dropdown\" title=\"\" data-original-title=\"Show all notifications\"><i class=\"fal fa-bell notificationAction\"></i></buttton>')\n            .insertBefore(menuResponsive);\n        // remove old items\n        menu.html(\"\");\n        menuResponsive.html(\"\");\n\n        $.each(matrixSession.getProjectList(false), function (idx, project) {\n            // We skip projects that we don't have access\n            if (project.accessType === \"none\")\n                return;\n\n            let notificationCount:XRTodoCount = NotificationsBL.NoticationCache.getTotalNotificationsProject( project.shortLabel );\n            if (notificationCount) {\n                // there are some notifications for project\n                let mss:string[] = [];\n                // take up to first two messages from recent message list\n                if ( notificationCount.firstTodos.length > 0 ) mss.push( NotificationsBL.getMessage( notificationCount.firstTodos[0]) );\n                if ( notificationCount.firstTodos.length > 1 ) mss.push( NotificationsBL.getMessage( notificationCount.firstTodos[1]) );\n\n                // format messages for ui: 3 lines\n                let last = \"\";\n                if( mss.length>0)\n                 {\n                     if( mss[0] != undefined)\n                     {\n                         last =     (mss[0].length<30?mss[0]:(mss[0].substring(0, 30 - 3) + \"...\"));\n                     }\n                 }\n                 let before = \"\";\n                 if( mss.length>1)\n                 {\n                     if( mss[1] != undefined)\n                     {\n                         before =   (mss[1].length<30?mss[1]:(mss[1].substring(0, 30 - 3) + \"...\"));\n                     }\n                 }\n                let more = (notificationCount.nbTodos>mss.length)?((notificationCount.nbTodos-mss.length) + \" more messages\"):\"\";\n\n                // build ui\n\n                let img = matrixSession.getImgFromProject(project.shortLabel, 5);\n\n                let msg = ` ${img} <span class='mainmenu'>${project.shortLabel}\n                                        <div class=\"notificationMenuSummary\">\n                                        <span class=\"last\">${last}</span>\n                                        <span class=\"before\">${before}</span>\n                                        <span class=\"more\">${more}</span>\n                                        </div>\n                                    </span>`;\n\n                $('<li style=\"position: relative;\">' + msg + '</li>').appendTo(menu).click(function (event: JQueryEventObject) {\n\n                    app.canNavigateAwayAsync().done(function () {\n                        // If we have QMSViewer only access, we open the published QMS in a new tab.\n                        if (project.accessType === \"qmsviewer\") {\n                            window.open(`${globalMatrix.matrixBaseUrl}/pub/${$(event.delegateTarget).data(\"project\")}?USER=training`);\n                        }\n                        else {\n                            matrixSession.loadProject(null, $(event.delegateTarget).data(\"project\") + \"/MYWORK\", true);\n                        }\n\n                    });\n                }).data(\"project\", project.shortLabel)\n                $('<li style=\"position: relative;\">' + msg + '</li>').appendTo(menuResponsive).click( function(event:JQueryEventObject) {\n                    app.canNavigateAwayAsync().done(function () {\n                        matrixSession.loadProject(null, $(event.delegateTarget).data(\"project\") + \"/MYWORK\", true);\n\n                    });\n                }).data(\"project\", project.shortLabel)\n            }\n        });\n        // fake show the list, to get the sizes\n        let height = Math.max($(\"#main\").height(), 200);\n        // end fake show the list, to get the sizes\n        $( \"#idNotificationList\")\n            .css(\"max-height\", height+ \"px\")\n            .css(\"overflow-y\",\"auto\")\n            .css(\"overflow-x\",\"none\");\n        $( \"nav\").css(\"visibility\",\"\").css(\"display\",\"\");\n\n        // do main button\n        this.lastCount = NotificationsBL.NoticationCache.getTotalNotifications( );\n        if ( this.lastCount ) {\n            projectButton.append( $(\"<span class='notificationIcon'>\").html(\"\"+this.lastCount));\n            projectButtonResponsive.append( $(\"<span class='notificationIcon'>\").html(\"\"+this.lastCount));\n        }\n\n    }\n\n\n    // show a dialog asking for details of a notification to create\n    protected showCreateNotificationDialog() {\n        let that = this;\n        let res = $.Deferred();\n\n        let sendTo:string[] = [];\n\n        async function updateSend() {\n            var sendButton = $(\".btnDoIt\", ui.parent().parent());\n            var enabled = sendTo.length && subj && await subj.getController().getValueAsync() !== \"\";\n            ml.UI.setEnabled(sendButton, enabled);\n        }\n\n        let usel = $(\"<div>\");\n\n        // take users from current project\n        ml.UI.SelectUserOrGroup.showMultiUserSelect( usel, \"For\", [], \"Create Notification For\",\"\",\"\", true, true, (selection:string[]) => {\n            sendTo = selection;\n            updateSend();\n        });\n\n\n        let subj = $(\"<div>\").plainText({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help:\"Notification message\",\n            fieldValue:\"\",\n            valueChanged: function () {\n                updateSend();\n            }, // callback to call if value changes\n            parameter: {\n                allowResize: false}\n        });\n\n        let dateSel = $(\"<div>\").dateselect({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help:\"Date to activate (optional)\",\n            fieldValue:\"\",\n            valueChanged: function () {\n                updateSend();\n            },\n            parameter: {\n                allowClear: true,\n                minDate: new Date()\n            }\n        });\n\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n        let ui = $(\"<div style='width:100%;height:100%'>\");\n\n        ui.append(dateSel);\n        ui.append(usel);\n        ui.append(subj);\n\n        ui.addClass(\"dlg-no-scroll\");\n        ui.removeClass(\"dlg-v-scroll\");\n\n        ml.UI.showDialog( dlg, \"Create Notification\", ui, -730, -500,\n        [{\n            text: 'Create',\n            class: 'btnDoIt',\n            click: async function () {\n                let text = DOMPurify.sanitize(await subj.getController().getValueAsync()) + '';\n                let dateStr = await dateSel.getController().getValueAsync();\n                let date = DateFieldHandler.getDateFromString(dateStr);\n                if (date && ml.UI.DateTime.renderDashFormat(date) == ml.UI.DateTime.renderDashFormat(new Date())) {\n                    // date is for today\n                    date = null;\n                }\n                let created =  await NotificationsBL.createNotification(sendTo, matrixSession.getProject(), app.getCurrentItemId(), text, null, date);\n                res.resolve(created)\n                dlg.dialog(\"close\");\n            }\n        }, {\n            text: 'Cancel',\n            class: 'btnCancelIt',\n            click: function () {\n                dlg.dialog(\"close\");\n            }\n        }]\n            , UIToolsConstants.Scroll.None, false, false, () => { dlg.remove(); }, () => { updateSend(); $(\"textarea\", subj).focus(); }, () => { });\n\n        return res;\n    }\n\n\n    // show a dialog with all notifications\n    protected showAllNotificationsDialog():void {\n\n        let that = this;\n\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n        let ui = $(\"<div style='width:100%'>\");\n\n        ml.UI.showDialog( dlg, \"Notifications\", ui, 900, 600,\n            [{\n            text: 'Ok',\n            class: 'btnDoIt',\n            click: function () {\n                dlg.dialog(\"close\");\n            }\n            }], UIToolsConstants.Scroll.Vertical, true, true, () => { dlg.remove(); }, () => {\n                that.showNotifications(ui);\n        },  () => { }\n        );\n    }\n\n    private showNotifications(ui:JQuery) {\n        let that = this;\n        ui.html(\"\").append( ml.UI.getSpinningWait(\"getting notifications...\") );\n\n        restConnection.getProject(\"todo?includeDone=1&includeFuture=1&itemRef=\" + app.getCurrentItemId()).done(function (allNotification: XRGetTodosAck) {\n\n            ui.html(\"\");\n\n            let cbs = {\n                others:(localStorage.getItem(\"ShowNotificationOthers\")==\"0\")?false:true,\n                future:(localStorage.getItem(\"ShowNotificationFuture\")==\"0\")?false:true,\n                past:(localStorage.getItem(\"ShowNotificationPast\")==\"0\")?false:true,\n            };\n\n            let table = $(\"<table style='width:100%'>\").appendTo(ui);\n            let tr = $(\"<tr>\").appendTo(table);\n            let td1 = $(\"<td>\").appendTo(tr);\n            let td2 = $(\"<td>\").appendTo(tr);\n            let td3 = $(\"<td>\").appendTo(tr);\n\n            ml.UI.addCheckbox( td1, \"Show notifications for others\", cbs, \"others\", function( ){\n                that.filterNotifications(ui,cbs );\n            });\n            ml.UI.addCheckbox( td2, \"Show notifications for future\", cbs, \"future\", function( ){\n                that.filterNotifications(ui,cbs );\n            });\n            ml.UI.addCheckbox( td3, \"Show notifications from the past\", cbs, \"past\", function( ){\n                that.filterNotifications(ui,cbs );\n            });\n\n            $('<div style=\"margin-bottom: 40px;\">').appendTo( ui); // just a bit of space\n\n            that.renderNotificationTable(ui,\n                { allowDelete:false, selectable: false, forColumn: true, itemColumn: false, doneColumn: false, canCloseMine: true, canCloseAll: false, showAddButton: true, none: \"no (more) to dos\", tableClass:\"itemNotifications\" },\n                allNotification.todos);\n\n            that.filterNotifications(ui, cbs);\n        });\n    }\n    // hide / show notifications depending on checkboxes, remember last value\n    protected filterNotifications(ui:JQuery, cbs:any) {\n\n        localStorage.setItem(\"ShowNotificationOthers\", cbs.others?\"1\":\"0\");\n        localStorage.setItem(\"ShowNotificationFuture\", cbs.future?\"1\":\"0\");\n        localStorage.setItem(\"ShowNotificationPast\", cbs.past?\"1\":\"0\");\n\n        $(\"tr\", ui).show();\n        if (!cbs.others) $(\"tr.others\",ui).hide();\n        if (!cbs.future) $(\"tr.future\",ui).hide();\n        if (!cbs.past) $(\"tr.past\",ui).hide();\n    }\n\n    // mark a notification as resolved (mark as done)\n    deleteNotificationDlg( notification:XRTodo) {\n        let that = this;\n        let res = $.Deferred();\n        ml.UI.showConfirm( -1, { title:\"Remove notification '\"+  NotificationsBL.getMessage( notification ) + \"'\", ok:\"Ok\", nok:\"Cancel\"},  () => {\n            try{\n                NotificationsBL.deleteNotification(notification);\n                res.resolve();\n            }\n            catch (err){\n                 res.reject();\n            }\n        }, null);\n        return res;\n    }\n\n\n\n    protected deleteNotificationIdRec( project:string, notifications:JQuery, deleteThem:boolean, idx:number) {\n        let that = this;\n        let res = $.Deferred();\n\n        if ( notifications.length <= idx) {\n            res.resolve();\n            return res;\n        }\n        NotificationsBL.deleteNotificationId( project, $(notifications[idx]).data(\"todoid\"), deleteThem).then( function() {\n\n            ml.UI.BlockingProgress.SetProgress(0, (idx+1) * 100 / notifications.length);\n            $(notifications[idx]).closest(\"tr\").css(\"color\",\"lightgrey\").css(\"text-decoration\", \"line-through\");\n\n            that.deleteNotificationIdRec( project, notifications, deleteThem, idx+1).done( function() {\n                res.resolve();\n            }).fail( function() {\n                res.reject();\n            });\n        }).catch( function() {\n            ml.UI.BlockingProgress.SetProgressError(0, \"failed deleting todo\");\n        });\n\n        return res;\n    }\n\n\n\n\n    // create a new notification object\n\n\n    // count the notifications of a folder by adding up notifications of it's items\n    private countRec( idb:IDB[] ) {\n        let that = this;\n        let sum = 0;\n        for(const child of idb) {\n            let count = 0;\n\n            if (child.children) {\n                // this is a folder\n                count = that.countRec( child.children );\n            }\n            else {\n                count = NotificationsBL.NoticationCache.getProjectNotifications(matrixSession.getProject(), child.id).length;\n            }\n            that.projectCount[child.id] = count;\n            sum += count;\n        };\n\n        return sum;\n    }\n\n    // update the counters in the tree: build a new cache and repaint them\n    protected updateCounters(  ) {\n        let that = this;\n\n        // update counters\n        window.setTimeout( function() {\n            if (!that.projectCount) {\n                that.projectCount = {};\n                that.countRec(app.getTree());\n                that.updateProjectMenu();\n\n                // change icons in tree\n                NavigationPanel.updateNotificationCounters();\n                NavBar.updateNotificationCounters();\n            }\n        }, 1);\n\n    }\n\n    // returned the cached count of notifications for a specific item\n    // if it is not yet cached, recreate it\n    protected getNotificationCount( itemId:string ) {\n        let that = this;\n\n        if (!this.projectCount) {\n            this.projectCount = {};\n            this.countRec(app.getTree());\n        }\n        return this.projectCount[itemId];\n    }\n    private addFancyTreeNotificationCounterPlugin() {\n\n        (<any>(<any>($.ui)).fancytree)._FancytreeClass.prototype.updateNotificationCounters = function () {\n            var tree = this\n\n            tree.visit(function(node:any){\n                node.updateNotificationCounters(false);\n            });;\n        };\n\n        (<any>(<any>($.ui)).fancytree)._FancytreeNodeClass.prototype.updateNotificationCounters = function (doParents: boolean) {\n            var node = this\n\n            if (node.span) {\n                var $badge = $(\"span.fancytree-notificationCounter\", node.span),\n                extOpts = node.tree.options.notificationCounter,\n                count = NotificationList.getNotificationCount( node.key);\n                if (count  && node.span && (!node.isExpanded() || !extOpts.hideExpanded)\n                ) {\n                    if (!$badge.length) {\n                        if (node.folder) {\n                            let expander = $(\"span.fancytree-expander\",node.span);\n                            $badge= $(\"<span class='fancytree-notificationCounter notificationCounter'/>\").insertBefore(expander);\n                        } else {\n                            $badge= $(\"<span class='fancytree-notificationCounter notificationCounter'/>\").insertBefore(\n                                $(\"span.fancytree-icon,span.fancytree-custom-icon\",node.span));\n                        }\n                    }\n                    $badge.text(count);\n                    $badge.closest(\"li\").data(\"notifications\", count);\n                } else {\n                    $badge.closest(\"li\").data(\"notifications\", 0);\n                    $badge.remove();\n                }\n                if (doParents && extOpts.deep && !node.isTopLevel() && !node.isRoot()) {\n                    node.parent.updateCounters();\n                }\n            }\n        }\n\n        // TODO(modules): improve all this casting.\n        const tmp: Fancytree.FancytreeStatic = (<any>$.ui).fancytree;\n        tmp.registerExtension({\n            // Every extension must be registered by a unique name.\n            name: \"notificationCounter\",\n            // Version information should be compliant with [semver](http://semver.org)\n            version: \"1.0\",\n\n            // Extension specific options and their defaults.\n            // This options will be available as `tree.options.notificationCounter.hideExpanded`\n\n            options: {\n                deep: true,\n                hideZeros: true,\n                hideExpanded: false,\n                // dnd: {\n                //     axis: \"y\"\n                // }\n            },\n\n            // Local functions are prefixed with an underscore '_'.\n            // Callable as `this._local._appendCounter()`.\n\n            /*_appendCounter: function(bar) {\n                var tree = this;\n            },*/\n\n            // **Override virtual methods for this extension.**\n\n            // `treeInit` is triggered when a tree is initialized. We can set up classes or\n            // bind event handlers here...\n            treeInit: function() {\n\n            (<any>this)._super.apply(this, arguments);\n\n                // Add a class to the tree container\n                (<any>this).$container.addClass(\"fancytree-ext-notificationCounter\");\n            },\n\n            // Destroy this tree instance (we only call the default implementation, so\n            // this method could as well be omitted).\n\n            treeDestroy: function() {\n                //(<any>this)._superApply(arguments);\n    (<any>this)._super.apply(this, arguments);\n            },\n\n            // Overload the `renderTitle` hook, to append a counter badge\n            nodeRenderTitle: function(ctx:any, title:any) {\n                var node = ctx.node,\n                    extOpts = ctx.options.notificationCounter,\n                    count = NotificationList.getNotificationCount(node.key);\n                // Let the base implementation render the title\n                // We use `_super()` instead of `_superApply()` here, since it is a little bit\n                // more performant when called often\n                (<any>this)._super(ctx, title);\n                // Append a counter badge\n                if (count && (!node.isExpanded() || !extOpts.hideExpanded)\n                ) {\n                    if (node.folder) {\n                        $(\"span.fancytree-expander\",node.span).before(\n                            $(\"<span class='fancytree-notificationCounter notificationCounter'/>\").text(count)).closest(\"li\").data(\"notifications\",count)\n                    } else {\n                        $(\"span.fancytree-icon,span.fancytree-custom-icon\",node.span).before(\n                            $(\"<span class='fancytree-notificationCounter notificationCounter'/>\").text(count));\n\n                    }\n                }\n            }\n        })\n    }\n\n    static anchorTimer;\n    static anchorNotifications() {\n        window.clearTimeout(Notifications.anchorTimer);\n        let itemId = app.getCurrentItemId();\n        Notifications.anchorTimer = window.setTimeout( () => {\n            if (itemId == app.getCurrentItemId()) {\n                let project = matrixSession.getProject();\n\n                for (let notification of NotificationsBL.NoticationCache.getNotifications()) {\n                    if ( notification.projectShort == project &&  itemId==notification.itemRef ) {\n                        let anchor = NotificationsBL.getField( notification );\n                        $(anchor).append(`<i class=\"fal fa-bell\" style=\"color:${notification.userId}\"></i>`);\n                    }\n                }\n            }\n        }, 1000);\n    }\n}\n\nvar NotificationList: Notifications;\n\nfunction initialize() {\n    NotificationList = new Notifications();\n    plugins.register(NotificationList);\n}\n","// example generation of json schema from typescript type\n// \n//  typescript-json-schema web/ts/ProjectSettings.ts ITestConfig > test.txt\n\nimport { IStringMap, IStringStringArrayMap } from \"./globals\";\nimport { JsonEditorValidation } from \".././jsonvalidation/JsonValidator\";\nimport { IPrintFunctionParamsOverwrites } from \"./printinterface/PrintFunction\";\nimport { ColumnEditor } from \"./common/businesslogic\";\n\nexport type {\n    IDeletedProjects, IWorkflowConfig, IWorkflowConfigOne2One, IWorkflowConfigProjectsAndTypes, IWorkflowConfigIssueType,\n    IWorkflowConfigStates, IWorkflowConfigStateDetails, IWorkflowConfigJira, IWorkflowConfigZoho, IWorkflowConfigIssueTypesZoho,\n    ITraceConfig, ITraceConfigDetails, ITraceConfigRule, TTraceRule, IQMSConfig,\n    ITraining, ITrainingMessages, IPublication, IPublicationCategory, IPublicationCategoryGroup, IPublishLegacy,\n    ILabelsConfig, ILabelStyle, ILabel, ILabelInstance, ILabelTemplate, ILabelGroup,\n    IFilterMenu, IDesignReview, IMailConfig, IMailConfigCanned, IMailConfigCustom, ISearchConfig, ISearchConfigSearch,\n    IInitialSearches, ILabelLockConfig, ILabelLockConfigLocks, IRiskConfig,\n    IRiskConfigMethod, IRiskConfigRT, IRiskConfigMitgationType, IRiskConfigFactor, IColDef, IRiskConfigMitgationTable, IRiskConfigTablesColumn,\n    RiskTableCellEditor, IRiskConfigFactorInputType, IRiskConfigFactorOption, IRiskConfigSelectChanges, IRiskConfigFactorWeight, IRiskConfigFactorWeightValue,\n    IRiskConfigReduction, IRiskConfigReductionOptions, IRiskConfigZone, IRiskConfigRPN, IRiskPostReduction, ICascadingSelect,\n    ICascadingSelectGroup, ICascadingSelectNumber, ICascadingSelectSelect, ICascadingSelectText,\n    IDHFConfig, ICaptions, ICaption, IDHFCategories, IDHFConfigCustomReports, IDHFConfigDefaultFormats, IDHFConfigDefaultFormatsOption,\n    IDHFConfigHideFormat, IDHFConfigCustomColumn, IDHFConfigTable, IDHFConfigTableColumn, IDHFConfigTableColumnType, IDHFConfigCustomTable,\n    IDHFConfigStandardDocs, IDHFConfigStandardDocsDef, IDHFConfigStandardDocsSection, IContextPageConfig, IContextPageConfigHelp,\n    IContextPageConfigTab, ContextPageConfigTabOption, ITestConfig, ITestConfigPresetField, ITestConfigTables, ITestConfigTablesColumns,\n    ITestConfigTablesColumn, TableCellEditor, ITestRule, ITestRuleAuto, ITestRuleManual, ITestRuleStep, TestResultType,\n    TestResultRule, ICategorySetting, ICategorySettingTitle, ICategorySettingTextIcon, ICategorySettingTabs, ICategorySettingTab,\n    ICategoryGroups, ICategoryGroup, IACL, IACLRules, IACLGroupsAcl, IFieldParameter, IDropDownConfig,\n    IDropdownGroup, IDropdownOption, IAutoFillSetting, ISmartTextConfig, ISmartTextConfigReplacement, IProjectLogo,\n    IExtras, IImportConfig, IImportConfigDetails, IEmbeddedReport, IProjectGroups, IProjectGroup, IFieldCapabilities, IFieldDescription, INotificationConfig,\n    IAutoColumn, IAutoColumnMap, IAutoColumnMapping,\n    ICleanup, ICleanupProtocol\n};\n\nexport { EnumItemPublish, qmsDefaultConfig, mailConfigSetting, smartTextConfigSetting, autoColumnSetting, autoColumnDefault, notificationSetting, defaultNotificationConfig, ACL_SETTING };\n\n// --------------------------------------------------\n// public project settings in admin client\n// --------------------------------------------------\n\ninterface IDeletedProjects {\n    deleted:string[];\n}\n\n// *******************************\n// workflow (JIRA, Zoho, Weblinks\n// *******************************\n\ninterface IWorkflowConfig {\n    enabled?: boolean,\n    defaultProjectId?: string,\n    defaultTypeId?: string,\n    projectsAndTypes?: IWorkflowConfigProjectsAndTypes[],\n    one2one?: IWorkflowConfigOne2One,\n    states?: IWorkflowConfigStates[],\n    pluginId: number\n}\ninterface IWorkflowConfigOne2One {\n    projectId: string, typeId: string\n}\ninterface IWorkflowConfigProjectsAndTypes {\n    key: string, id: string, issueTypes: IWorkflowConfigIssueType[], name: string\n}\ninterface IWorkflowConfigIssueType {\n    id: string, name: string, icon?: string, quickIssue?: boolean\n}\ninterface IWorkflowConfigStates {\n    projectId: string, typeId: string, states: IWorkflowConfigStateDetails[]\n}\ninterface IWorkflowConfigStateDetails {\n    name: string, color: string, background: string, done: boolean | string\n}\ninterface IWorkflowConfigJira extends IWorkflowConfig {\n    hideCreateJiraSimpleIssue?: boolean,\n    hideCreateJiraNativeIssue?: boolean,\n    requireCommitTicket?: boolean,\n    addJIRAComment?: boolean,\n\n}\ninterface IWorkflowConfigZoho extends IWorkflowConfig {\n    zohoBaseUrl?: string\n}\ninterface IWorkflowConfigIssueTypesZoho extends IWorkflowConfigIssueType {\n    prefix: string,\n    details?: string\n}\n\n// *******************************\n// trace config        \n// *******************************\ninterface ITraceConfig { rules: ITraceConfigDetails[] } // configuration of tracability rules \ninterface ITraceConfigDetails {\n    category: string, // id of category\n    creates_end: string|boolean,\n    end_point?:string,\n    reporting: string[], up_rules: ITraceConfigRule[], down_rules: ITraceConfigRule[]\n}\ninterface ITraceConfigRule { message: string, name: string, rule: TTraceRule, any_of: string[] }\ntype TTraceRule = \"can_have\" | \"must_have\"\n// *******************************\n// qms configuration        \n// *******************************\n\n\nenum EnumItemPublish {\n    IfNotInGroup=0, //allow items to be published unless they are in a group\n    Always=1, // allow items to be published even if they are in a group\n    Never=2 // items cannot be published by itself \n}\n\n\ninterface IQMSConfig {\n    /** there's only one publication in the array supported */\n    publications: IPublication[ ]\n    // roles are defined globally\n    rolesTargetProjects?:string[] // a list of projects to which the roles can be published to\n    affectedByField?:string //optional to overwrite the default field name \"Affected by Process\"; \n    responsibleForField?:string // optional to overwrite the default field name \"Responsible for Process Application\"; \n    training?:ITraining\n    /** Experimental: comma separated list of labels to show in published site -> if they are set */\n    showLabels?:string\n    /** obsolete */\n    legacyRoles:boolean, // set to true to show roles as drop downs and not as groups\n}\ninterface ITraining {\n    messages?:ITrainingMessages;\n}\ninterface ITrainingMessages {\n    trainingSub?:string\n    trainingText?:string\n    overdueSub?:string\n    overdueText?:string\n}\n\ninterface IPublication {\n    /** information for each publishable category */\n    rules: IPublicationCategory[], // which categories to publish when\n    /** needs to be PUB right now */\n    toCategory:string // into which category to publish default PUB\n    /** needs to be pub right now */\n    target:string // same as toTarget for URL, default pub\n    /** comma separated list of users who can publish */\n    publisher: string // comma separated list of publishers\n    /** beta: userMode: default 0 - select the logged in user, 1 no user pre selected, 2: hide all other users , 3: hide all other users (Strict mode) */\n    userMode?:number,\n    /** obsolete */\n    keepFlatList:boolean // if true items are created as flat list. if not set (new default) items are created in a folder hierarchy\n}\ninterface IPublicationCategory {\n    /** the category for which the rule applies  */\n    category:string, // category id\n    /** a list of labels which must be set to be able to publish (approved labels)*/\n    readyLabels: string[], // in case there are labels which must be set to be able to publish\n    /** how individual items can be published:  0 - only if they are not in a group, 1 - independently of groups, 2 - only as part of a group*/\n    itemRules: EnumItemPublish // to define if items should only be published as part of a group,\n    /** name of the group, displayed in the UI as heading in the navigation of the live qms */\n    groupName?: string; // name of group like SOP\n    /** identification of labels which define the group (groupType setting in labels)  */\n    groupLabelType?: string // identification of label, e.g. SOP labels\n    /** if a PROC should only be published with its WI,s the group down would be WI*/\n    groupDown?:string[] // categories which are pulled in group\n}\n\ninterface IPublicationCategoryGroup {\n    category:string, // grouping based on which category\n    groupName: string; // name of group like SOP\n    groupLabelType: string // identification of label\n}\n\nconst qmsDefaultConfig: IQMSConfig = {\n    publications: [{\n        rules: [\n            {\n                category: \"PROC\", // category id\n                readyLabels: [\"PROCOK\"], // in case there are labels which must be set to be able to publish\n                itemRules: EnumItemPublish.IfNotInGroup,\n                groupName: \"SOP\",\n                groupLabelType: \"SOPS\",\n                groupDown: [\"WI\"]\n            },\n            {\n                category: \"WI\", // category id\n                readyLabels: [\"WIOK\"], // in case there are labels which must be set to be able to publish\n                itemRules: EnumItemPublish.IfNotInGroup,\n            }\n        ], // which categories to publish when\n        toCategory: \"PUB\", // into which category to publish\n        target:\"pub\", // the name under which to publish the category (part of the URL, defaults to pub)\n        keepFlatList:false, // if true items are created as flat list. if not set (new default) items are created in a folder hierarchy\n        publisher: \"_\" // comma separated list of publishers _ for legacy: look in category setting for PUB,\n        \n    }\n    ],\n    legacyRoles:false // use user groups \n}\n\ninterface IPublishLegacy {\n    publisher:string // comma separated list of users who can click on publish button\n}\n\n// *******************************\n// labels configuration        \n// *******************************\ninterface ILabelsConfig {\n    /** basic label definitions */\n    labels: ILabel[],\n    /** grouping of labels to or, xor or review groups */\n    groups: ILabelGroup[],\n    /** array of the design review labels */\n    design_reviews?: IDesignReview[],\n    /** allows to change the background color of the top bar if a filter is selected */\n    filterBackgroundColor?: string,\n    /** if set to true, the filters are shown in a drop down menu (each group needs to be added as well)*/\n    useFilterMenu?: boolean,\n    /** beta: when looking at an item, it shows the labels underneath the item if set to true - this allows for more items.. */\n    useLabelBar?:boolean \n    /** invert groups in items (this will make groups show in the wrong order... as it was in 2.2 and before) */\n    invertGroups?:boolean\n}\n\n\ninterface ILabelStyle {\n    label: {\n        on: {\n            foreground: string,\n            background: string,\n            icon?: string,\n            displayName: string,\n            tooltip?: string\n        },\n        off: {\n            foreground: string,\n            background: string,\n            icon?: string,\n            displayName: string,\n            tooltip?: string\n        }\n    },\n    filter: {\n        on: {\n            foreground: string,\n            background: string,\n            icon?: string,\n            displayName: string,\n            tooltip?: string\n        },\n        off: {\n            foreground: string,\n            background: string,\n            icon?: string,\n            displayName: string,\n            tooltip?: string\n        }\n    }\n}\ninterface ILabel {\n    label: string,\n    categories: string[],\n    editors?: string[], // can be set to restrict clicking on labels to comma seperated list of users\n    reportName: string,\n    reportHide?: string, // can be 'unset' in order to not show it if it is NOT set\n    default?: boolean | string // set the label when creating new elements\n    defaultAsk?: boolean, // show in UI to set when creating new elements\n    style: ILabelStyle\n    // dynamic\n    isSelected?: boolean,\n    isNegative?: boolean,\n    askForComment?: boolean,\n    displayName?: string,\n    toolTipFilterOn?: string,\n    color?: string\n    template?: ILabelTemplate\n    dontCopy?:boolean // if set to true the label will be ignored during copy and paste of items\n}\n\ninterface ILabelInstance extends ILabel {\n    btn:JQuery;\n}\n\ninterface ILabelTemplate {\n    id: number,\n    name: string,\n    key: string\n}\ninterface ILabelGroup {\n    selection: string,\n    labels: string[],\n    filterMenu?: IFilterMenu,\n    // only for some groups\n    default?: string, defaultAsk?: boolean,\n    noColor?: string, noName?: string, noIcon?: string,\n    reset?: boolean,\n    foreground?: string, background?: string\n    askForComment?: boolean,\n    showComments?: boolean,\n    tooltip?: string,\n    reviewers?: string[], // can be a list of reviewers: if set only these users can change the label \n    groupType?:string, // can be used to set a group type (used internally e.g. to indicate a group is a SOP group)\n    //dynamic\n    labelDef?: ILabel[],\n    filterSelection?: string\n    virtualGroup?:boolean // set to true of the group is created on the fly for labels which are in no real group\n}   \n\ninterface IFilterMenu {\n    displayName: string,\n    on?: {\n        foreground: string,\n        background: string,\n        icon?: string,\n        displayName: string,\n        tooltip?: string\n    },\n    off?: {\n        foreground: string,\n        background: string,\n        icon?: string,\n        displayName: string,\n        tooltip?: string\n    }\n\n}\ninterface IDesignReview {\n    /** id of label (no spaces, special characters) */\n    label: string,\n    /** define who can approve the review. Empty array -> everybody.  */\n    reviewers?: string[],\n    /** beta: allow to specify the name of a field from which to take possible approvers. If set it has precedence over reviewers */\n    reviewerField?:string,\n    /** set to true if labels should be reset if item is changed */\n    reset: boolean,\n    /** title of review  */\n    reviewName: string,\n    /** sub title */\n    reviewHelp: string,\n    /** list of questions, checkboxes, or a signature box */\n    reviewDetails: { name: string, help?: string, type?:string }[],\n    /**  can be set to rename comment field to something else than \"Design Review Comment\" */\n    commentHeading?:string,  \n    /** can be used to set a group type (used internally e.g. to indicate a group is a design review for a Process) */\n    groupType?:string, \n    /** can be used to put the reviews' filter into the filter menu if enabled */\n    filterMenu?:IFilterMenu\n    /** beta: allows to name a table field. If this exists, the revision need to increase when setting the label */\n    revisionTableName?:string\n}\n\n// *******************************\n// mail config\n// *******************************\nconst mailConfigSetting = \"mail_config\";\ninterface IMailConfig {\n    canned?: IMailConfigCanned, // can be used to overwrite standard email messages send / proposed by the system\n    defaultCC?:string[], // can be set to a default CC user to be added to all emails\n}\ninterface IMailConfigCanned {\n    /**  replacement for please sign message (in SIGN page)*/\n    please_sign?: string,\n    /** replacement for look at item message (in tool menu)*/\n    look_at?: string, \n   /** replacement for training message (in SIGN page)*/\n    training?: string, \n   /** replacement for document released message (in SIGN page)*/\n   release_note?: string, \n   /** Generic replacement */\n   [key:string]:string|undefined \n}\ninterface IMailConfigCustom {\n    name: string, // name of this mail in send to menu \n    categories: string[], // categories for which message should be available\n    to: string[], // a list of users who should get the message\n    subject: string, // the subject\n    message: string // the message\n}\n\n// *******************************\n// *******************************\ninterface ISearchConfig {\n    searches: ISearchConfigSearch[],\n    init?: IInitialSearches[]\n}\ninterface ISearchConfigSearch {\n    name: string, expr: string\n}\ninterface IInitialSearches {\n    expr: string, style:string, computeFolder:number\n}\n// *******************************\n// label lock config \n// *******************************\n\ninterface ILabelLockConfig {\n    locks:ILabelLockConfigLocks[]\n}\ninterface ILabelLockConfigLocks {\n    label:string, // label which locks \n    lockKeeper:string[], // user who can unlock the item (by resetting the label)\n    /**  if set to true, the user can add up / down traces to the item even if the item is locked*/\n    allowTraces?:boolean\n}\n\n// *******************************\n// risk config\n// *******************************\ninterface IRiskConfig {\n    factors?: IRiskConfigFactor[], //  a list of factors contributing to risk levels, see below\n    method?: IRiskConfigMethod, // \"+\" or \"*\" whether to add or multiply the risk factors, \"lookup\" to get values from lookup table\n    // '+' / '*' as method:\n    maxGreen?: number, // the maximum risk level value which will be shown in green (low risk)\n    maxYellow?: number, // the maximum risk level value which will be shown in yellow (moderate risk), all above will be red (high risk)\n    // 'lookup' as method\n    charts?: IRiskConfigZone[], // colors and text per risk class\n    rpns?: IRiskConfigRPN[], // lookup table to determine for risk priority numbers based on weights\n    // risk controls\n    riskCategory?:string, // can be used to overwrite the risk category which by default is RISK\n    riskCategories?:string[], // can be used to specify several risk categories 8if there's more than one)\n    mitigationTypes?: IRiskConfigMitgationType[], // a list of categories which can be used as risk controls, see below. If there are no mitigations the RBM section will not be shown.\n    mitigationTable?: IRiskConfigMitgationTable, // when user wants to show risk in table instead of 'normal' item list \n    mitigationColDef?:IColDef // can be used to specify css of column if rendered as table\n    reductions?: IRiskConfigReduction[], // a list describing how risk levels can be reduced by risk controls, see below.\n    postReduction?: IRiskPostReduction // option for user selection after risk controls\n    // optional setting to configure if/how risk assessment is rendered\n    rbm?: IRiskConfigRT,// allows to overwrite the default text used for Risk Before Mitigation fields \n    ram?: IRiskConfigRT, // allows to overwrite the default text used for Risk After Mitigation fields (RAM) \n    controls?: string, // allows to overwrite the default text used for Risk Controls \n    // \n    hazard_category?: string\n}\ntype IRiskConfigMethod = \"+\" | \"*\" | \"lookup\";\n\ninterface IRiskConfigRT {\n    short: string, // text used in UI just before the field\n    long: string, // text used in tooltip in UI\n    report: string, // text used in report\n    hidden?: boolean // default:false, set to true if this should not be displayed/reported\n    colDef?:IColDef // can be used to specify css of column if rendered as table\n}\ninterface IRiskConfigMitgationType {\n    type: string, //  the short label of the category, like REQ, SPEC, TC, ...\n    name: string //  the name shown on the button to select the items, e.g.Requirement, Risk Control, ...\n}\ninterface IRiskConfigFactor {\n    type: string, // an unique identification of the factor\n    label: string, // the label displayed in the UI, where user can enter some text, e.g. \"Cause\" or \"Effect\"\n    weights: IRiskConfigFactorWeight[] // an array of definitions describing how the factor contributes to the risk level, each weight is a a drop down of values\n    hideTextInput?: boolean, // default: false, set to trueif there should not be a text input field to specify details \n    readonly?: boolean, //  default: false, can be set to true if user should not be able to change the field \n    inputType?: IRiskConfigFactorInputType, // default:text (a single line text input), can be used to overwrite the input as a drop down selection or a text area \n    options?: IRiskConfigFactorOption[], // if inputType is \"select\" this contains the values which can be selected \n    spancols?:boolean // if true and there are no weights, the input field will be spanning over full width\n\n    colDef?:IColDef // can be used to specify css of column if rendered as table\n}\n\ninterface IColDef {\n    width?:string, // if rendered as table this can be used to specify the css of the width\n    minWidth?:string, // if rendered as table this can be used to specify the css of the min-width\n    maxWidth?:string// if rendered as table this can be used to specify the css of the max-width\n    rowSpan?:boolean // if set to true, all rows, share the same value for that column\n}\n\ninterface IRiskConfigMitgationTable {\n    columns:IRiskConfigTablesColumn[]\n}\n\ninterface IRiskConfigTablesColumn {\n    name: string,\n    field: string,\n    editor: RiskTableCellEditor,\n    options?: any\n}\ntype RiskTableCellEditor = \"control\" | \"reduction\"; // note these are the 'special' editors  for risk reduction table, all others works also...\n\ntype IRiskConfigFactorInputType = \"text\" | \"select\" | \"textarea\" | \"richtext\";\n\ninterface IRiskConfigFactorOption {\n    value: string, // a unique identifier\n    label: string, // text to display\n    changes: IRiskConfigSelectChanges[] // for input select only. Allows to automatically change other inputs / weights when the select changes \n}\n\ninterface IRiskConfigSelectChanges {\n    changesFactor?: string, // identifier (type) the factor to be modified OR\n    changesWeight?: string, // identifier (type) the weight to be modified \n    value: number|string // the new value to set\n}\n\ninterface IRiskConfigFactorWeight {\n    type: string, // an identifier of the contributing factor\n    help: boolean, // if set true a help popover will explain the values\n    label: string, // the label displayed in the UI, where the user can select a value from the drop down, e.g. \"Probability\", \"Severit\"y or \"Detectability\"\n    readonly?: boolean, // default false, set to true, if an input field should not be changeable by the user  \n    hidden?: boolean, // default false, set to true, if field should be hidden\n    values: IRiskConfigFactorWeightValue[] // an array of options of the drop down\n    colDef?:IColDef // can be used to specify css of column if rendered as table\n}\n\ninterface IRiskConfigFactorWeightValue {\n    shortname: string,// name displayed in the UI, can omitted to only show the factor\n    help: string,// name displayed in tool tip help\n    factor: number //factor which goes into calculation of risk\n}\n\ninterface IRiskConfigReduction {\n    name: string,// a unqiue id of the reduction factor\n    options: IRiskConfigReductionOptions[] // an array of reductions factors describing how the risk level can be reduced. These show up as drop down of values:\n}\ninterface IRiskConfigReductionOptions {\n    shortname: string, // the string shown in drop down\n    by: number,  // the amount by which a factor of the risk is changed (so negative values reduce the risk level)\n    changes: string, // defines which weight is reduced.\n}\ninterface IRiskConfigZone {\n    zone?: string, // unqiue ID\n    foreground?: string, // foreground color in the user interface\n    background?: string, // background color in the user interface\n    textColor?: string, // text color in reports\n    label?: string // text to be displayed\n}\n\ninterface IRiskConfigRPN { // e.g. { \"probability\":5, \"severity\":4, \"zone\":\"LOW\", \"text\":\"5 x 4 = 20\" }\n    zone: string, // ID of zone\n    text: string, // for below combination of numbers: the resulting zone(char) and text\n    [key: string]: string | number // properties for each weight defining the lookup value for this lookup entry\n}\n\ninterface IRiskPostReduction {\n    weights: IRiskConfigFactorWeight[]\n    help?: string // help text, defaults to \"Risk After Risk Controls\"\n}\n\n\n// *******************************\n// cascading select config\n// *******************************\n\ninterface ICascadingSelect {\n    startGroupId: string, // selectes one of the define groups to start with\n    groups: ICascadingSelectGroup[] // GUID is made out a combination of the defined groups\n}\ninterface ICascadingSelectGroup {\n    groupId: string, // id of a group\n    type: \"text\" | \"number\" | \"select\",\n    spec: ICascadingSelectText | ICascadingSelectNumber | ICascadingSelectSelect[] // depends on type\n}\ninterface ICascadingSelectNumber {\n    counter: string, // db counter name\n    format: string, // how number is displayed, e.g. ### or ##, ...\n    nextGroupId: string // possibly another group to follow\n}\ninterface ICascadingSelectSelect {\n    text: string, // option in dropdown menu\n    help?: string, // help text for user\n    nextGroupId: string // if option is selected, possibly another group to follow\n}\ninterface ICascadingSelectText {\n    text: string, // static text block\n    nextGroupId: string // possibly another group to follow\n}\n\n\n\n\n// *******************************\n// dhf config\n// *******************************\n\ninterface IDHFConfig {\n    /** if set to true the created PDFs won't be locked */\n    doNotLockPDF?: boolean \n    /** default formats for different report types */\n    defaultFormats?: IDHFConfigDefaultFormats \n    /** table configuration for audit trail table */\n    audittrail?: IDHFConfigTable, // \n    /** table configuration for signature table*/\n    signatures?: IDHFConfigTable, \n    /** table configuration for responsibilities table */\n    responsibilities?: IDHFConfigTable, \n    /** list with predefined document sections when creating new DOC items */\n    controlledDocs?: IDHFConfigStandardDocs,\n    /** can be used to define custom table columns (e.g. dropdowns) */\n    customColumns?: IDHFConfigCustomColumn[],\n    /** allows to specify an alternative for \"Ready to Sign / Release\" button*/\n    archiveButtonName?: string, \n    /** if set to true a warning will be shown if there's a missing signature */\n    warnMissingSign?:boolean  \n    // 2.0\n    /** possibility to overwrite options in signature meaning column */\n    signatureMeanings?:IStringMap // \n    \n    // 2.3\n    /**  beta: if true a user can reject instead of signing. the reject comment will be stored and showed, other cannot sign anymore */\n    canReject?:boolean, \n    /**  beta:  if canReject is true and this is true the user can reject without supplying a password */\n    rejectWithoutPass?:boolean, \n    /** beta: if canReject is true and this is true the user needs to supply special comment to reject */\n    rejectNeedsComment?:boolean, \n    /** beta: text shown in signature box if someone needs to sign something */\n    signatureHint?: string \n    /** beta: list of users who can change name of person who needs to sign */\n    proxyRights?:string[] \n    /** beta: a list of options to declare what user is signing for [\"i release\", \"i confirm correct\",\"I don't know\"], */\n    signedMeaning?:string[] \n    /** beta: removes not needed notifications and adds new ones when changing signatures proxies */\n    fixNotifications?:boolean \n    /** beta: 0 leave original sign info. 1 replace name and title when changing signature proxies */\n    proxySignTableUpdate?:number \n    /** beta: set to true show a column with sign meaning in SIGN */\n    showOriginalSignMeaning?:boolean \n\n    // obsolete:\n    /** obsolete */\n    hideFileFormats?: IDHFConfigHideFormat[], // possibility to hide formats per report type\n    /** obsolete */\n    customTables?: IDHFConfigCustomTable[] // possibility to define custom tables \n    //  customTable1_id\": IDHFConfigTable,\n    // customTable2_id: IDHFConfigTable, \n    /** obsolete  */\n    customReports?: IDHFConfigCustomReports, // legacy option defining customer specific reports \n    /**  obsolete */\n    categories?: IDHFCategories, // allows to overwrite defaults\n    /**  obsolete */\n    captions?: ICaptions, // set to at least {} will enable captions for figures/tables (see below for more options)\n    /**  obsolete */\n    renderInTree?:string[], // if REPORT, SIGN, DOC should be rendered in normal tree\n    /** obsolete */\n    toolFolderName?:string, // can be set to rename the \"Project, Reports & Controlled Documents\" folder\n    /** obsolete */\n    functionDefaults?:IPrintFunctionParamsOverwrites // overwrites for print functions\n}\n\n// definition of formatting of captions and references to captions\ninterface ICaptions {\n    figure?: ICaption, // optional: specify how references to captions are rendered (default italic)\n    table?: ICaption// optional: specify how references to captions are rendered (default italic)\n}\ninterface ICaption {\n    preNo: string, // e.g. \"Figure \"\n    postNo: string, // e.g \".\"\n    \n}\ninterface IDHFCategories {\n    documentTypes: string[], // DOC, SIGN, REPORT\n    documentForms: string[], // DOC\n    documentSigned: string[], // SIGN items which have / can be signed (frozen)\n    documentTemplates: string[] // SIGN items which can be used as a template\n    signAs: string  // SIGN category to create in order to sign\n}\n\ninterface IDHFConfigCustomReports {\n    // allows to add custom reports (legacy option, not available to customers)\n    group: string;\n}\ninterface IDHFConfigDefaultFormats {\n    DOC: IDHFConfigDefaultFormatsOption, // default format of documents create from DOC items\n    SIGN: IDHFConfigDefaultFormatsOption, // default format of documents create from SIGN items\n    REPORT: IDHFConfigDefaultFormatsOption, // default format of documents create from REPORT items\n    [map: string]: IDHFConfigDefaultFormatsOption\n}\ntype IDHFConfigDefaultFormatsOption =\n    \"docx\" // word\n    | \"pdf\" // pdf\n    | \"html\" // html\n    ;\n\ninterface IDHFConfigHideFormat {\n    category: string,\n    format: IDHFConfigDefaultFormatsOption\n}\ninterface IDHFConfigCustomColumn {\n    type: string,\n    options: IDropdownOption[]|any,\n    name: string,\n    editor?: string\n}\ninterface IDHFConfigTable {\n    columns: IDHFConfigTableColumn[]\n}\ninterface IDHFConfigTableColumn {\n    name: string,\n    field: string, // col0, col1, col2, etc.\n    columnType: IDHFConfigTableColumnType,\n    pos: number,  // pos of column 0,1,2\n    editor?: TableCellEditor,\n    options?: IDropdownOption[]\n}\ntype IDHFConfigTableColumnType =\n    \"type0\" // Short Text (one line text)\n    | \"type1\" // Long Text (multi line text)\n    | \"type2\" // Version Letter (A, B, C, ...)\n    | \"type3\" // eSignature (for electronic signatures)\n    | \"type4\" // Name (a printed user name)\n    | \"type5\"  // eDate (automatic date if there is a eSignature in the same row)\n    | \"type6\" // : \"signaturemeaning\",\n    | \"type7\" // : \"eco\",\n    | \"type8\" // \"ecocapa\"\n    | \"type9\" // date\n    | \"type10\" // not used anymore\n    | \"type11\" // Group / Role\n    | \"type12\" // Revision\n    | \"type13\" // auto date: when creating a new row set the date\n    | \"type14\" // number\n    \n    ;\ninterface IDHFConfigCustomTable {\n    name: string, // name of table (in section selection dialog\n    id: string // internal id of table (valid json keys, e.g. customTable1_id)\n}\n\ninterface IDHFConfigStandardDocs {\n    [key: string]: IDHFConfigStandardDocsDef // defines a standard doc template, e.g \"Plan\": IDHFConfigStandardDocsDef\n}\ninterface IDHFConfigStandardDocsDef {\n    fields: IDHFConfigStandardDocsSection[] // defines sections of a standard doc template\n}\ninterface IDHFConfigStandardDocsSection {\n    [key: string]: string\n}\n\n// *******************************\n// context pages \n// *******************************\n\ninterface IContextPageConfig {\n    categoryHelp?: IContextPageConfigHelp, // allows to define specific help text per category (needs \"help\" tab enabled)\n    itemHelp?: IContextPageConfigHelp, // allows to define specific help text per item (needs \"help\" tab enabled)\n    tabs?: IContextPageConfigTab[] // defines the tabs in the context pages\n}\ninterface IContextPageConfigHelp {\n    [key: string]: string // defines custom help information for a given category if na item of this category is selected, e.g. \"UREQ\":\"please enter user requirements\",\"SREQ\":\"define system requirements here\"\n}\ninterface IContextPageConfigTab {\n    title: string, // the name of the context tab in the ui\n    type: ContextPageConfigTabOption, // defines the content of the tab\n    tabId?:string, // internal tab id once generated\n    hipchat?: boolean, // depriciated\n    baseURL?: string // (required for type iframe) Note: the url must be on an https://  protocol, otherwise the browser will reject to load it.\n}\n\ntype ContextPageConfigTabOption =\n    \"help\" // shows a tab with pre-defined (or custom) help explaining what you can do with the selected item, depedning on its category \n    | \"support\" // allows to create help desk tickets from within the software including information about the item/project and operating system / browser\n    | \"faq\" // shows a tab with faqs about the product. This is useful for first time visitors\n    | \"references\" //  shows a tab with all up and down references of the selected items\n    | \"smartlinks\" // shows a tab with all smartlinks in the text boxes and tables of the selected item\n    | \"iframe\" // embeds an iframe. This iframe can be page which is hosted on your own servers. When called it receives the content of the selected item (as payload) \n    | \"iframeget\" // embeds an iframe. This iframe can be page which is hosted on your own servers. When called it receives part of the item information in the called url\n    | \"upreferences\" // (recursive) uplinks\n    | \"downreferences\" // (recursive) downlinks\n    | \"foldercontent\" //  shows the items and folders in a folder \n    | \"trainings\" // shows any registered trainings\n    ;\n\n// *******************************\n// XTCconfig\n// *******************************\n\ninterface ITestConfig {\n    xtcType: string, // must be \"XTC\"\n    cloneSources: string[], // all categories which can be converted to XTC, e.g. [ \"TC\", \"ITC\" ]\n    presetFields: ITestConfigPresetField[], // fields that the user can enter when creating XTCs, e.g. [ { \"field\": \"name\", \"value\": \"Version\" } ]\n    render: ITestConfigTables, // defines how tables look like\n    defaultTestResultResult: string, // \"an|warning|not started\",\n    automatic: ITestRuleAuto[],\n    manual: ITestRuleManual[],\n    perStep: ITestRuleStep[],\n    reExecute?:string, // a (search expression) to find failed tests to re execute them\n    autoFillTester?:string // first - set it to user saving if empty, last - always set it to user saving, \"\" - don't set it\n}\n\ninterface ITestConfigPresetField {\n    field: string, // how to identify the field (\"name\" means the displayed name\", \"meaning\" can refer to a field setting fieldMeaning)\n    value: string, // the what the field name should be\n}\ninterface ITestConfigTables {\n    [key: string]: ITestConfigTablesColumns;\n}\n\ninterface ITestConfigTablesColumns {\n    columns: ITestConfigTablesColumn[]\n}\n\ninterface ITestConfigTablesColumn {\n    name: string,\n    field: string,\n    editor: TableCellEditor,\n    options?: IDropdownOption[]|any\n}\n\ntype TableCellEditor = ColumnEditor.text | ColumnEditor.none | ColumnEditor.textline | ColumnEditor.design | ColumnEditor.uprules | ColumnEditor.downrules | ColumnEditor.rules | ColumnEditor.result | ColumnEditor.user | ColumnEditor.versionletter | ColumnEditor.date | ColumnEditor.select;\n\ninterface ITestRule {\n    human: string, //a human readable text explaining the test result\n    code: string, // a unique identifier for the status of the test result\n    render: TestResultType // whether test result means 'ok' (all good), 'error' (test failed), 'warning' (e.g. not completed): this is used in report renderings\n}\n\ninterface ITestRuleAuto extends ITestRule {\n    rule: TestResultRule, // the type of rule to determine from the test steps the overall status. Can be 'one', 'all' or ''. The first rule matching determines the status\n    param: string // parameter for the rule, i.e. a code of a test step\n}\n\ninterface ITestRuleManual extends ITestRule {\n    command: string // Tthe string in the drop down menu\n}\ninterface ITestRuleStep extends ITestRuleManual {\n    key: string, // the keyboard shortcut\n    image: string // so far only internally used to show icons for common states (passed, fail and docu)\n}\n\ntype TestResultType = \"ok\" | \"error\" | \"warning\";\ntype TestResultRule = \"all\" | \"one\" | \"\";\n\n\n\n// --------------------------------------------------\n// project settings full admin client\n// --------------------------------------------------\n\n// ******************************* \n// categories rendering / label + color\n// *******************************\ninterface ICategorySetting { }\ninterface ICategorySettingTitle extends ICategorySetting {\n    // name of category setting: title \n    // example of value:  {create:\"TITLE OF THIS\", placeholder:\"enter title of this\"}\n    create?: string,      // if user can enter title of an item, this is the text of th ehlpe to displayed, if not specified the default is Title:\n    placeholder?: string, // if this is set this is the placeholder for the title input input field. Default \"enter title\" \n}\ninterface ICategorySettingTextIcon extends ICategorySetting {\n    // name of category setting: textIcon \n    // example of value:  {color:\"#345500\", text:\"RC\"}\n    color?: string, // html color of category font in tree\n    text?: string, //  short label of category in tree\n}\ninterface ICategorySettingTabs extends ICategorySetting {\n    // define tabs inside an item\n    tabs:ICategorySettingTab[] \n}   \ninterface ICategorySettingTab {\n    id?:string, // temp ids for ui,\n    name: string, //  tab name\n    fields: string[] // fields to display in tab\n}\n// ******************************* \n// grouping of categories in meta categories\n// *******************************\n\ninterface ICategoryGroups {\n    groups: ICategoryGroup[] // a list of groups\n}\n\ninterface ICategoryGroup {\n    categories: string[], // list of categories in that group\n    text: string,   // label displyed in tree (short form / bold)\n    name: string,  // name displayed in tree (long form)\n    color: string,  // color of group in tree\n    position?: number,  // position \n    helpPage?: string // link to a page which contains group specific help\n}\n\n\n// ******************************* \n// ACL user access lists\n// *******************************\nconst ACL_SETTING = \"acl\";\n    \ninterface IACL {\n    rules: IACLRules[] // a list of rules\n}\n\ninterface IACLRules {\n    name:string // \n    groups: string[], // group names\n    acl:IACLGroupsAcl[], // access rights for group\n}\ninterface IACLGroupsAcl {\n    category: string, // name of the category\n    fields?: string[],  // fields array, can exist for edit... if fields array exist but is empty no user can edit anything\n                        // in field array you'll find field name which allow editing\n    rights: string[], // given rights\n }\n/*\n { category:\"REQ\", rights:[\"edit\"], fields:[]}\n { category:\"REQ\", rights:[\"edit\"]}\n*/\n // --------------------------------------------------\n// field settings in full admin client\n// --------------------------------------------------\n\ninterface IFieldParameter {\n    [key: string]: any,\n    // common control options = all filed types and all categories\n    /** if set to true, the control will not be editable by the user */\n    readonly?: boolean,\n    /** if set to true the field will not be shown in reports */\n    hide_report?: boolean,\n    /** if set to true the field will not be shown in documents */\n    hide_document?: boolean,\n    /** if set to true the field will not be shown in published (QMS) */\n    hide_publication?: boolean,\n    // options to show help for an input field\n    hide_UI?:boolean,\n    /** set to 1 to not clean the field values */    \n    unsafeHtml?:number,\n    /** this can be set to point to a an external website which is openend when user clicks on a link, e.g.\n     * \"externalHelp\":\"matrix.com\". Note this must be a website which is accesible through https://url */\n    externalHelp?: string,\n    /** this can be set to show help as a tooltip, e.g. \"popupHelp\":\"enter a short description\" */\n    popupHelp?: string,\n    /** this can be set to render a help line underneath the \"heading\":\"enter a long description\" */\n    inlineHelp?: string,\n    /** for folder category */\n    visibleOption?: string,\n    /** for SIGN category\n     * if set to true, the field is not visible (only makes sense with the above flag)\n     */\n    invisible?: boolean,\n    /** this allows to copy fields from underlying DOC into the SIGN item.\n     * Note: Fields are copied only if this is set to true and the labels (names) of the field is the same in the\n     * DOC and the SIGN */\n    copyfromdoc?: boolean\n    /** legacy options */\n    adminVisibility?: boolean,\n    /** legacy options */\n    requiresContent?: boolean,\n}\n\n// *******************************\n// drop down options\n// *******************************\ninterface IDropDownConfig {\n    fieldMeaning?: string, // can be used in reports / docs\n    placeholder?: string, // to be shown if no value is selected\n    options: IDropdownOption[], // list of options in drop down\n    groups?: IDropdownGroup[], // grouping of option\n}\ninterface IDropdownGroup {\n    value: string, // id of group (as class reference in drop down option), groups are sorted by this ID\n    label: string // name of group as displayed in UI\n\n}\n\ninterface IDropdownOption {\n    id: string, // internal ID\n    label: string, // visible name in drop down\n    class?: string, // if option should be in a group of options, this is the id (value) of  group \n    disabled?: boolean, // for classic select dropdowns in table, allow to define unselectable things\n    strikethrough?: boolean // to visually indicate that a selection is deleted, out-of-date, etc\n}\n\n// --------------------------------------------------\n// settings with user interface\n// --------------------------------------------------\n\ninterface IAutoFillSetting {\n    allowAutoFill:boolean, // if set to true auto fill is allowed for all of the below\nallowLoginAutoFill:boolean, // overwrite auto fill setting for login\n    allowDocSignAutoFill:boolean, // overwrite auto fill setting for electronic signatures\n    allowLabelSignAutoFill:boolean, // overwrite auto fill setting for label signatures\n    allowGateAutoFill:boolean // overwrite auto fill setting for gate signatures\nallowPublishAutoFill:boolean // overwrite auto fill setting for publications\n}\n\n// *******************************\n// smart text , abbreviations, ....\n// *******************************\nconst smartTextConfigSetting = \"rtf\";\ninterface ISmartTextConfig { replacements?: ISmartTextConfigReplacement[] }\ninterface ISmartTextConfigReplacement { \n    /** id of the macro: needs to be simple combination of letters and digits */\n    what: string, \n    /** the text to display */\n    with: string, \n    /** value from 1 to 4: 1=plain text 2=rich text 3=term 4=abbreviation */\n    tagType: number, \n    /**  additional explanation for terms*/\n    description?: string, \n    /** set to true to ask user to review before creating document */\n    warn: boolean, \n    /** date/time of creation */\n    when: string \n    /** internal: not to be used */\n    projectSetting?: boolean, \n    /** legacy: now handled by tagType */\n    plain?: boolean, \n    /**  Include this term/abv in the List of Terms and abbreviation doc section when not surrounded with _ */\n    tableNoUnderscore?:boolean\n    \n}\ninterface IProjectLogo { fileId: string }\n\n\n// --------------------------------------------------\n// hidden / beta features\n// --------------------------------------------------\n\n\ninterface IExtras {\n    tableCanImport: boolean | string, // set to true to allow importing into table  \n    copyPaste: boolean | string, // set to true to allow copy paste \n    moveIn: boolean | string, // set to true to allow to move into folder\n    excelImport: boolean | string, // set to true to allow to import from excel\n    deepTouch: boolean | string, // allows items to be touched recursively \n    noTouch:  boolean | string,  // allows items to hide touch from the menu\n    setLabel: boolean | string // allow to set labels on multiple items in tree\n    compareX: boolean | string // allow to compare any documents (also between projects)\n    compareInsideX: boolean | string // allow to compare any documents \n    indexer:boolean // allow to re-index database after config changes\n    cleanup:boolean | string // show cleanup tools\n    defaultToNewEditor:boolean | string // show cleanup tools\n    enableLegacyReport?:\"0\"|\"1\"|\"2\" // Allow to re-enabled the legacy REPORT category. 0=warning, 1=removed, 2=enabled\n}\n\ninterface IEmbeddedReport {\n    reportId: string;\n}\n\ninterface IProjectGroups {\n    groups: IProjectGroup[]\n}\n\ninterface IProjectGroup {\n    name: string,\n    projects: string[]\n}\n\n// --------------------------------------------------\n// (custom) fields\n// --------------------------------------------------\n\ninterface IFieldCapabilities {\n    /** if set only one of this kind of fields can be created per category*/\n    onlyOne?:boolean\n    /** can be published to QMS site */\n    canBePublished:boolean\n    /** can be set to readonly */\n    canBeReadonly:boolean\n    /** whether field can be hidden in DOCs */\n    canHideInDoc: boolean,\n    /** whether a field can be a preset in an XTC */\n    canBeXtcPreset: boolean,\n    /** whether a field needs to have a value set */\n    canRequireContent?: boolean\n    /** whether a field can be added to DOCs and SIGN */\n    canBeUsedInDocs?: boolean\n    /** an optional validation function to run against the code*/\n    validationFunction?:JsonEditorValidation\n    /** the name of interface schema. If no validation is provided this will also be used for validation*/\n    schema?:string\n    /** if true the user needs to set some settings to make it useful*/\n    needsConfiguration?:boolean //\n    /**  user can allow unsafe text entry,*/\n    canBeUnsafe?:boolean //\n    /** Can be imported from excel */\n    canImportedFromExcel?:boolean\n}\n\ninterface IFieldDescription {\n    id: string,\n    label: string,\n    class: string, // in which categories it can be used: all (well all categories), toolbar, docs, report, sign, sync, beta\n    help: string,\n    capabilities: IFieldCapabilities // what the field can be used\n}\n// --------------------------------------------------\n// notification\n// --------------------------------------------------\ninterface INotificationConfig {\n    enabled:boolean, // show notification user interface\n    closeAuto:boolean, // allow user to close automatically created notification\n    manualCreate:boolean, // allow user to create\n    browserNotificationDisabled?:boolean,\n    browserNotificationAutoCloseAfter?: number;\n\n}\n\nlet notificationSetting = \"\";\nlet defaultNotificationConfig: INotificationConfig = {\n    enabled:true,\n    closeAuto:true,\n    manualCreate:true,\n    browserNotificationDisabled : false,\n    browserNotificationAutoCloseAfter:9000\n};\n// --------------------------------------------------\n// column autofill\n// --------------------------------------------------\n\n/** allow to set cell in table column if another dropdown cell in same row changes*/\ninterface IAutoColumn {\n    /** a list of mappings (which cell is updated upon change of which cell) */\n    maps:IAutoColumnMap[];\n}\n\ninterface IAutoColumnMap {\n    /** name of cell which triggers change */\n    dropdownColumnName:string;\n    /** name of cell which is updated  */\n    textColumnName:string;\n    /** mapping from selected to set value */\n    mapping:IAutoColumnMapping[];\n}\n\ninterface IAutoColumnMapping {\n    /** selected value */\n    dropdownValue:string;\n    /** set value */\n    textValue:string;\n}\n\n// setting can be for customer (e.g. user titles) and project (user roles)\nconst autoColumnSetting = \"autoColumn\";\nconst autoColumnDefault: IAutoColumn = { maps: [] };\n\n\n// -----------------------------------------\n// html cleanup \n// -----------------------------------------\n\ninterface ICleanup {\n    \"cleanup\": boolean,\n    \"tags\": string[],\n    \"attributes\": IStringStringArrayMap,\n    \"enforcedAttributes\":IStringStringArrayMap,\n    \"protocolAttributes\": ICleanupProtocol[]\n}\ninterface ICleanupProtocol {\n    \"element\":string,\n    \"attribute\": string,\n    \"protocols\": string[]\n}\n\n\n/** defines parameters for imports */ \ninterface IImportConfig {\n    /** includes keep same id */\n    includes: IImportConfigDetails,\n    /** copies are editable new copies */\n    copies:IImportConfigDetails\n}\n\n\ninterface IImportConfigDetails { \n    /** includes can be locked by specifying a lock label */\n    lockLabel:string,\n    /** there can be a list of users who can import (if there's nobody in there, or no list is defined: everybody can) */\n    importMasters?:string[]\n}\n","import { XRGetProject_Todos_GetTodosAck, XRGetTodosAck, XRTodo } from \"../../RestResult\";\nimport { restConnection } from \"../../globals\";\nimport { NotificationsCache } from \"./NotificationsCache\";\n\n\nexport class NotificationsBL {\n    static NoticationCache: NotificationsCache = new NotificationsCache();\n\n    //\n    /**\n     * Returns the message of the notification. either the message is plain text or some formatted json object\n     * @param todo\n     */\n    static getMessage( todo:XRTodo ) {\n        if (!todo || !todo.action || !todo.action.text) return \"\";\n        if (todo.action.text[0] != \"{\") return todo.action.text;\n        try {\n            let json = JSON.parse( todo.action.text );\n            if (json.message) {\n                return json.message;\n            }\n        } catch (e ) {};\n        return  todo.action.text;\n    }\n    /**\n     * Returns the field of the notification. either the message is plain text or some formatted json object: the anchor is a place in the UI\n     * @param todo\n     */\n    static getField( todo:XRTodo ) {\n        if (!todo || !todo.action || !todo.action.text) return null;\n        if (todo.action.text[0] != \"{\") return null;\n        try {\n            let json = JSON.parse( todo.action.text );\n            if (json.field) {\n                return json.field;\n            }\n        } catch (e ) {};\n        return  null;\n    }\n    //\n    /**\n     *  either the message is plain text or some formatted json object: the reply is a reference to another todo - for which this is a replyTo\n     * @param todo\n     */\n    static getReply( todo:XRTodo ) {\n        if (!todo || !todo.action || !todo.action.text) return null;\n        if (todo.action.text[0] != \"{\") return null;\n        try {\n            let json = JSON.parse( todo.action.text );\n            if (json.replyTo) {\n                return json.replyTo;\n            }\n        } catch (e ) {};\n        return  null;\n    }\n\n    /**\n     * Create a notification for a list of users on a specific item in a project. The notification will be due to a specific date\n     * @param users\n     * @param project\n     * @param item\n     * @param text\n     * @param type\n     * @param atDate\n     */\n    static async createNotification( users:string[], project:string, item:string, text:string, type:string, atDate:Date): Promise<XRTodo[]> {\n        let that = this;\n        let todoDetails:any = {\n            text:text,\n            logins:users.join(\",\")\n        }\n        if (atDate) {\n            todoDetails.atDate = atDate.toISOString();\n        }\n        if ( type ) {\n            todoDetails.todoType = type;\n        }\n         return <XRTodo[]> await restConnection.postServer(project + \"/todo/\" + item, todoDetails);\n    }\n\n    /**\n     * Remove a notification by its id\n     * @param project\n     * @param todoId\n     * @param deleteThem\n     */\n    static async deleteNotificationId( project:string, todoId:number, deleteThem:boolean):Promise<void> {\n        await restConnection.deleteServerAsync(project + \"/todo/\" + todoId, deleteThem ? { hardDelete: \"yes\" } : {});\n        return;\n    }\n\n    /**\n     * Remove a notification\n     * @param notification Notif to remove\n     */\n    static async deleteNotification( notification:XRTodo) {\n        return NotificationsBL.deleteNotificationId(notification.projectShort, notification.todoId, false);\n    }\n\n    /**\n     * Return all notifications (for all projects)\n     */\n    static async getAllNotifications() {\n        let allNotifications =  <XRGetProject_Todos_GetTodosAck> await  restConnection.getServer(\"all/todo\", true);\n        return allNotifications;\n    }\n\n    /**\n     * Return all notifications for a specific project. The notifications are divided into two groups: for now and for later\n     * @param project\n     */\n    static async getGetNotificationsNowAndFuture(project:string): Promise<{ todosForLater: XRTodo[]; todosForNow: XRTodo[] }> {\n\n        let allNotifications = <XRGetTodosAck> await restConnection.getServer(project+\"/todo?includeDone=1&includeFuture=1\", true);\n        return {\n             todosForNow : allNotifications.todos.filter(function (notification) { return !notification.future }),\n             todosForLater: allNotifications.todos.filter(function (notification) { return notification.future }).sort(function (a, b) {\n                let da = new Date(a.createdAt).getTime();\n                let db = new Date(b.createdAt).getTime();\n                return da > db ? 1 : -1;\n            })\n        }\n    }\n\n    /**\n     * Return all notifications for a specific project and a specific item\n     * @param project\n     * @param currentItemId\n     */\n    static async getAllNotificationForItem(project: string, currentItemId: string): Promise<XRGetTodosAck> {\n        let result = <XRGetTodosAck> await restConnection.getServer(project + \"/\"+ \"todo?includeFuture=1&itemRef=\"+currentItemId, true);\n        return result;\n    }\n}\n","import { XRGetTodosAck, XRTodo, XRTodoCount } from \"../../RestResult\";\nimport {  NotificationsBL } from \"./NotificationsBL\";\n\n\nexport interface INotificationsChanges{\n    total:number;\n    allNotifications:XRGetTodosAck;\n}\nexport class NotificationsCache {\n    private myTodoCount: XRTodoCount[] = [];\n    private myTodos: XRTodo[] = [];\n    private isEnabled: boolean;\n\n    setNotificationCounts(todos: XRTodoCount[]) {\n        this.myTodoCount = todos;\n    }\n\n    getNotificationCounts() {\n        return this.myTodoCount;\n    }\n\n    getNotifications(): XRTodo[] {\n        return this.myTodos;\n    }\n\n    setNotifications(todos: XRTodo[]) {\n        this.myTodos = todos;\n    }\n\n\n    private notificationUpdateTimer: number;\n\n    /**\n     * Update the notifications cache  for the provided list of projects\n     * @param projects\n     */\n    async update(projects:string[]): Promise<INotificationsChanges> {\n        return new Promise((resolve, reject) => {\n            if (!this.isEnabled) {\n                resolve({ total: 0, allNotifications: undefined });\n            }\n            clearTimeout(this.notificationUpdateTimer);\n\n            this.notificationUpdateTimer = window.setTimeout(() => {\n                this.getAllNotificationsAndUpdateCache(projects).then((changes) => {\n                    // in case there's a couple of notifications created in a short time\n                    resolve(changes);\n                });\n\n            }, 300 + Math.random() * 700); // wait up to 1 second before updating UI -> in case user has many tabs open\n        });\n\n    }\n\n\n    setEnabled(isEnabled: boolean) {\n        this.isEnabled = isEnabled;\n    }\n\n\n    /**\n     * Return the total number of notifications for a specific project from the cache\n     * @param project\n     */\n    getTotalNotificationsProject(project: string) {\n        let list = this.getNotificationCounts().filter(function(notificationCount) {\n            return notificationCount.projectShort == project;\n        });\n        return list.length ? list[0] : null;\n    }\n    /**\n     * Return the total number of notifications from the cache\n     */\n    getTotalNotifications() {\n        let sum = 0;\n        $.each(this.getNotificationCounts(), function(cidx, notificationCount) {\n            sum += notificationCount.nbTodos;\n        });\n        return sum;\n    }\n\n    /**\n     * Return the notifications for a specific project and item from the cache\n     * @param project\n     * @param item\n     */\n    getProjectNotifications(project: string, item: string) {\n        return this.getNotifications().filter(function(notification) {\n            return (!project || notification.projectShort == project) && (!item || item == notification.itemRef);\n        });\n    }\n\n    private async getAllNotificationsAndUpdateCache(projects:String[]): Promise<INotificationsChanges> {\n        let that = this;\n\n        let allNotifications = await NotificationsBL.getAllNotifications();\n        let notificationCounts: XRTodoCount[] = [];\n\n        // create object with counts\n\n        notificationCounts = allNotifications.todoCounts.filter(function(notificationCount) {\n            return projects.indexOf(notificationCount.projectShort) != -1;\n        });\n\n        let total = 0;\n        for (let tc of notificationCounts) {\n            total += tc.nbTodos;\n        }\n\n        // show a icon if the number increased\n\n        // store them in session\n        NotificationsBL.NoticationCache.setNotificationCounts(notificationCounts);\n        NotificationsBL.NoticationCache.setNotifications(allNotifications.todos);\n        return { total: total, allNotifications: allNotifications };\n\n    }\n\n}\n","import { app, globalMatrix } from \"../../../globals\";\nimport { ml } from \"../../matrixlib\";\nimport { HTMLCleaner } from \"../../matrixlib/index\";\nimport { IRefLinkOptions, refLinkStyle, refLinkTooltip } from \"./RefLinkDefines\";\n\n$.fn.refLink = function( this:JQuery, options:IRefLinkOptions ) {\n\n    let component = new RefLink(this, options);\n    this.destroy = () => component.destroy();\n    this.getValue = () => component.getValue();\n    return this;\n}\n\nclass RefLink  {\n\n    private settings:IRefLinkOptions;\n    private newTitle:string;\n    private lineEditor:any;\n    private ttpart:JQuery;\n\n    constructor( control:JQuery, options:IRefLinkOptions) {\n        let that = this;\n\n        this.settings = options;\n        // defaults\n        this.settings.style = (typeof this.settings.style === 'undefined') ? refLinkStyle.show : this.settings.style;\n        this.settings.tooltip = (typeof this.settings.tooltip === 'undefined') ? refLinkTooltip.none : this.settings.tooltip;\n\n        this.settings.validate = (typeof this.settings.validate === 'undefined') ? true : this.settings.validate;\n\n        this.newTitle = this.settings.title;\n        var title = this.settings.title;\n\n        var isFolderLink = (typeof this.settings.folder !== 'undefined' && this.settings.folder);\n        var key = this.settings.id; // key without revision\n        if (localStorage.getItem('matixShowVersionInId') === 'true') {\n            var versionPos = key.indexOf(\"-v\");\n            if (versionPos !== -1) {\n                key = key.substring(0, versionPos);\n            }\n        }\n        let extraClass = \"\";\n        if( key.startsWith(\"F-\") &&  key.endsWith(\"-1\") )\n            extraClass = \"key-top\";\n\n        var linkId = \"<span class='\" + extraClass + \" \" + (this.settings.isHidden ? \"refId greyRefIdHyper\" : \"refId refIdHyper\") + \"'>\" + (isFolderLink ? \"\" : key) + \"</span>\";\n        let style = this.settings.css?(\" style='\" + this.settings.css + \"'\"):\"\";\n\n\n        var linkTitle = \"<span class='key-\" + key + \" \" + (this.settings.isHidden ? \"refTitle greyTitle\" : \"refTitle\") + \"'\" + style + \">\" + title + \"</span> \";\n        if (key && key[0] === \"-\") {\n            // special node, e.g. Deleted Items\n            linkId = \"\";\n            linkTitle = \"<span class='refTitleSpecial'>\" + title + \"</span> \";\n        }\n        var theTitle = $(linkTitle);\n        if (this.settings.hideTitle) {\n            theTitle.hide();\n        }\n        if (this.settings.includeSourceLink) {\n            theTitle.append(`<span class=\"fal fa-external-link-alt\" style=\"font-size: small;margin-left: 12px;\" title=\"${this.settings.includeSourceLink}\">`);\n        }\n        var ttpart = $(\"\");\n        if (this.settings.style === refLinkStyle.link) {\n            ttpart = $(\"<a>\" + linkId + \"</a>\").attr(\"href\", app.createItemUrl(this.settings.id, this.settings.crossProject)).attr('target', '_blank');\n            control.html(\"\").append(ttpart).append(theTitle);\n        } if (this.settings.style === refLinkStyle.selectTree) {\n            ttpart = $(\"<a>\" + linkId + \"</a>\").css(\"cursor\", \"pointer\");\n            ttpart.off(\"click\").click(function(evt):any {\n                if (evt.ctrlKey ||evt.metaKey ) {\n                    var win = window.open(app.createItemUrl(that.settings.id), '_blank');\n                    if (win) {\n                        //Browser has allowed it to be opened\n                        win.focus();\n                    } else {\n                        //Browser has blocked it\n                        alert('Please allow popups for this site');\n                    }\n                    if (evt.preventDefault)\n                        evt.preventDefault();\n                    if (evt.stopPropagation)\n                        evt.stopPropagation();\n                } else {\n                    return app.treeSelectionChangeAsync(that.settings.id);\n                }\n            });\n            control.html(\"\").append(ttpart).append(theTitle);\n        } else if (this.settings.style === refLinkStyle.edit) {\n            this.lineEditor = <any>theTitle.editable({\n                mode: 'inline',\n                onblur: 'submit',\n                placeholder: that.settings.placeholder,\n                clear: false,\n                showbuttons: false,\n                validate: function(value:string):any {\n                    if ($.trim(value) == '' && that.settings.validate && $(this).css(\"display\")!=\"none\" ) {\n                        if (that.settings.callback) {\n                            that.settings.callback.apply(null, [that.settings.id, \"\"]);\n                        }\n                        return { msg: 'title required!', newValue: '', activate: false }\n                    }\n                },\n                success: function(response:any, newValue:string) {\n                    if (that.settings.callback) {\n                        let text = new HTMLCleaner(newValue, true).getClean(HTMLCleaner.CleanLevel.Basic);\n                        that.settings.callback.apply(null, [that.settings.id, text]);\n                    }\n                }\n            });\n            ttpart = $(linkId);\n            (<JQuery>this.lineEditor).on('shown', function(event: JQueryEventObject) {\n                if (that.settings.callback && that.settings.validate) {\n                    $(event.delegateTarget).data('editable').input.$input.on('keyup', function(e: JQueryEventObject) {\n                        that.newTitle = $(e.delegateTarget).val();\n                        that.settings.callback.apply(null, [that.settings.id, that.newTitle]);\n                    });\n                }\n            });\n            control.html(\"\").append(ttpart).append(this.lineEditor);\n        } else if (this.settings.style === refLinkStyle.show) {\n            ttpart = $(linkId);\n            control.html(\"\").append(ttpart).append(theTitle);\n            if (this.settings.callback) {\n                control.off(\"click\").click(function(evt) {\n\n                    if (evt.ctrlKey ||evt.metaKey) {\n                        var win = window.open(app.createItemUrl(that.settings.id, that.settings.crossProject), '_blank');\n                        if (win) {\n                            //Browser has allowed it to be opened\n                            win.focus();\n                        } else {\n                            //Browser has blocked it\n                            alert('Please allow popups for this site');\n                        }\n                        if (evt.preventDefault)\n                            evt.preventDefault();\n                        if (evt.stopPropagation)\n                            evt.stopPropagation();\n                    } else {\n                        return that.settings.callback.apply(null, [that.settings.id]);\n                    }\n                });\n            }\n        } else if (this.settings.style === refLinkStyle.select) {\n\n            ttpart = $(\"<span class='\" + (this.settings.isHidden ? \"refId greyRefIdHyper\" : \"refId refIdHyper\") + \"'>\" + key + \"</span>\");\n            control.html(\"\").append(ttpart).append(theTitle);\n            if (this.settings.callback) {\n                ttpart.off(\"click\").click(function(evt) {\n                    if (evt.ctrlKey ||evt.metaKey) {\n                        var win = window.open(app.createItemUrl(that.settings.id), '_blank');\n                        if (win) {\n                            //Browser has allowed it to be opened\n                            win.focus();\n                        } else {\n                            //Browser has blocked it\n                            alert('Please allow popups for this site');\n                        }\n                    } else {\n                        return that.settings.callback.apply(null, [that.settings.id]);\n                    }\n                });\n            }\n        }\n\n        if (this.settings.tooltip === refLinkTooltip.html&&\n            that.settings.id.indexOf(\"-\") != 0 &&\n            app.getType(that.settings.id)[0] != \"_\" &&\n            !app.isFolder(that.settings.id) &&\n            app.getCurrentItemId() != that.settings.id) {\n            ttpart.data(\"tooltip\", \"popover\").data(\"placement\", \"bottom\");\n\n            ttpart.tooltip({ title: \"hold shift to see a preview\", trigger: '', container:\"body\" });\n            ttpart.on('mouseover', function(event) {\n                if (!globalThis.globalMouseDown) {\n                    ml.UI.showTooltip(that.settings.id, $(event.delegateTarget), event, that.settings.crossProject);\n\n                    ttpart.tooltip('show');\n                    // and hide after a second\n                    setTimeout(function () { // the hiding on leave / click is really not working well\n                        ttpart.tooltip('hide');\n                        $(\".tooltip.fade\").remove(); // the hiding is really not working well\n                    }, 1000);\n                }\n                else {\n                    ttpart.tooltip('hide');\n                }\n            });\n            ttpart.on('mouseleave', function() {\n                ml.UI.hideTooltip();\n                ttpart.tooltip('hide');\n            });\n            ttpart.on('mousedown', function() {\n                ml.UI.hideTooltip(true);\n                ttpart.tooltip('hide');\n            });\n        }\n    }\n\n\n    getValue(): string {\n        return this.newTitle;\n    }\n\n    destroy() {\n        if (this.lineEditor) {\n            this.lineEditor.off();\n            this.lineEditor.editable('destroy');\n        }\n        if (this.ttpart) {\n            this.ttpart.off();\n        }\n\n    }\n\n}\n\n\nglobalThis.globalMouseDown = false;\n\n\n$(document).mousedown(function () {\n    globalThis.globalMouseDown = true;\n}).mouseup(function () {\n    globalThis.globalMouseDown = false;\n});\n","// -----------------------------------------------------------\n// Tools to show reference dialog (with up and downtraces)\n// -----------------------------------------------------------\n\n/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { app, globalMatrix, IItem, IReference, matrixSession } from \"../../../globals\";\nimport { ml } from \"../../matrixlib\";\nimport { SelectMode } from \"../Components/ProjectViewDefines\";\nimport { refLinkStyle, refLinkTooltip } from \"../Parts/RefLinkDefines\";\nimport { ItemCreationTools } from \"./ItemCreationView\";\nimport { ItemSelectionTools } from \"./ItemSelectionView\";\n\nimport { UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\";\n\nexport type { IReferenceToolsOptions };\nexport { ReferenceTools };\n\ninterface IReferenceToolsOptions { item: IItem, canEdit: boolean, callback?: (item: IItem) => void }\n\nclass ReferenceTools {\n\n\n    showReferenceDialog (options:IReferenceToolsOptions) {\n        if( options.callback == undefined)\n        {\n            //Make sure we have a callback\n            options.callback = (item:IItem)=>{};\n        }\n        var treeContainer = $('<div class=\"Container nodeContainer\"></div>');\n\n        let riskCategories = globalMatrix.ItemConfig.getFieldsOfType(\"risk2\").map(function (rc) { return rc.category });\n\n        var allDownTypes: DrawTreeType[] = [];\n        $.each(globalMatrix.ItemConfig.getLinkTypes(options.item.type, true, true), function (idx, type) {\n            allDownTypes.push({type: type});\n        });\n        $.each(globalMatrix.ItemConfig.getLinkTypes(options.item.type, true, false), function (idx, type) {\n            allDownTypes.push({type: type});\n        });\n\n        var allUpTypes: DrawTreeType[] = [];\n        $.each(globalMatrix.ItemConfig.getLinkTypes(options.item.type, false, true), function (idx, type) {\n            if (riskCategories.indexOf( type ) == -1) {\n                allUpTypes.push({type: type});\n            }\n        });\n        $.each(globalMatrix.ItemConfig.getLinkTypes(options.item.type, false, false), function (idx, type) {\n            if (riskCategories.indexOf( type ) == -1) {\n                allUpTypes.push({type: type});\n            }\n        });\n\n        var rootDown: DrawTreeNode;\n        var rootUp: DrawTreeNode;\n        function hideXTCs(nodes: DrawTreeNode[]) {\n            let hideFrom = 1000;\n            let hideTo = -1000;\n            for (var idx = 0; idx<nodes.length; idx++) {\n                // assume that all XTCs come one after the other...\n                if (ml.Item.parseRef(nodes[idx].id).type == \"XTC\") {\n                    if (idx<hideFrom) hideFrom = idx;\n                    if (idx>hideTo) hideTo = idx;\n                }\n            }\n            if (hideTo-hideFrom>2) {\n                // at least 4 XTCs\n                let dotdotdot: DrawTreeNode = {\n                    isRoot:false,\n                    isOutDate:false,\n                    Class:\"nodesExpand\",\n                    Nodes:[],\n                    ToolTip:\"click to expand\",\n                    Content:$(\"<span>...</span>\")\n                }\n                dotdotdot.Hidden = nodes.splice(hideFrom+1, hideTo-hideFrom-1);\n                nodes.splice(hideFrom+1,0,dotdotdot);\n            }\n        }\n        function createStartNode(item:IItem):void {\n            var itemDate = new Date(item.modDate);\n            var missingDownLinks = app.getMissingDownLinks(item);\n            let evalDownlinks = app.evaluateTraceRule(item, true);\n\n            rootDown = {isRoot: true, isDown: true, id: item.id, Content: $(\"<div></div>\").refLink({\n                    id: item.id, title: \"\", style: refLinkStyle.show, tooltip: refLinkTooltip.html, hideTitle:true\n                }), Nodes: []};\n\n            for (var idx = 0; idx < item.downLinks.length; idx++) {\n                var refDate = new Date(item.downLinks[idx].modDate);\n\n                rootDown.Nodes.push({isCreate: false, isOutDate: (refDate < itemDate), isDown: true,  isIndirect: item.downLinks[idx].isIndirect, id: item.downLinks[idx].to, Content: $(\"<div></div>\").refLink({\n                        id: item.downLinks[idx].to, title: \"\", style: refLinkStyle.show, tooltip: refLinkTooltip.html, hideTitle:true\n                    }), Nodes: []});\n            }\n            hideXTCs(rootDown.Nodes);\n            if (matrixSession.isEditor() && options.canEdit) {\n                for (var idx = 0;idx < missingDownLinks.length; idx++) {\n                    let required = (evalDownlinks.missingMustHaveCategories.indexOf(missingDownLinks[idx])!=-1)?\"nodeCreate\":\"nodeCreateOptional\";\n\n                    rootDown.Nodes.push({isCreate: true, type: missingDownLinks[idx], isDown: true, Class: required, ToolTip: \"Create new linked item\", Content: $(\"<div>\").html(missingDownLinks[idx]), Nodes: []});\n                }\n            }\n            var missingUpLinks = app.getMissingUpLinks(item);\n            let upRequired = app.evaluateTraceRule(item, false);\n            rootUp = {isRoot: true, isDown: false, id: item.id, Content: $(\"<div></div>\").refLink({\n                    id: item.id, title: \"\", style: refLinkStyle.show, tooltip: refLinkTooltip.html, hideTitle:true\n                }), Nodes: []};\n            for (var idx = 0; idx < item.upLinks.length; idx++) {\n                var refDate = new Date(item.upLinks[idx].modDate);\n                rootUp.Nodes.push({isCreate: false, isOutDate: (refDate > itemDate), isDown: false, isIndirect: item.upLinks[idx].isIndirect, id: item.upLinks[idx].to, Content: $(\"<div></div>\").refLink({\n                        id: item.upLinks[idx].to, title: \"\", style: refLinkStyle.show, tooltip: refLinkTooltip.html, hideTitle:true\n                    }), Nodes: []});\n            }\n            if (matrixSession.isEditor() && options.canEdit) {\n                for (var idx = 0; idx < missingUpLinks.length; idx++) {\n                    let required = (upRequired.missingMustHaveCategories.indexOf(missingUpLinks[idx])!=-1)?\"nodeCreate\":\"nodeCreateOptional\";\n\n                    rootUp.Nodes.push({isCreate: true, type: missingUpLinks[idx], isDown: false, Class: required, ToolTip: \"Create new linked item\", Content: $(\"<div>\").html(missingUpLinks[idx]), Nodes: []});\n                }\n            }\n            if (allUpTypes.length > 0 && matrixSession.isEditor() && options.canEdit) {\n                rootUp.Nodes.push({isSelect: true, types: allUpTypes, isDown: false,  Class: \"nodeCreate\", ToolTip: \"Select linked item\", Content: $(\"<div>\").html(\"Select\"), Nodes: []});\n            }\n            if (allDownTypes.length > 0 && matrixSession.isEditor() && options.canEdit) {\n                rootDown.Nodes.push({isSelect: true, types: allDownTypes, isDown: true, Class: \"nodeSelect\", ToolTip: \"Select linked item\", Content: $(\"<div>\").html(\"Select\"), Nodes: []});\n            }\n        }\n\n        function RefreshTree() {\n            var oldContainer = treeContainer;\n            oldContainer.hide();\n            treeContainer = $('<div class=\"Container nodeContainer\"></div>');\n            app.dlgForm.append(treeContainer);\n            DrawTree({\n                Container: treeContainer,\n                RootDown: rootDown,\n                RootUp: rootUp,\n                Layout: \"Horizontal\",\n                OnNodeClick: NodeClick,\n                OnNodeDoubleClick: NodeDoubleClick});\n            oldContainer.html(\"\");\n            var ph = treeContainer.parent().height();\n            var pw = treeContainer.parent().width();\n            var nh = treeContainer.height();\n            var nw = treeContainer.data(\"maxWidth\");\n            if (ph > nh) {\n                treeContainer.css({top: (ph - nh) / 2});\n            }\n            if (pw > nw) {\n                treeContainer.css({left: (pw - nw) / 2});\n            }\n            treeContainer.width(nw);\n        }\n\n        function NodeClick(theNode: DrawTreeNode, event: MouseEvent) {\n            if (theNode.Class == \"nodesExpand\") {\n                theNode.Nodes = ml.JSON.clone(theNode.Hidden);\n                theNode.Class = \"nodesExpanded\";\n                RefreshTree();\n            } else if (theNode.Class == \"nodesExpanded\") {\n                // toggle XTCs\n                theNode.Nodes = null;\n                theNode.Class = \"nodesExpand\";\n                RefreshTree();\n            } else if (theNode.isSelect) {\n                app.dlgForm.dialog(\"close\");\n                var select = new ItemSelectionTools();\n                select.showDialog({\n                    linkTypes: theNode.types,\n                    getSelectedItems: async function () {\n                        return theNode.isDown ? options.item.downLinks : options.item.upLinks;\n                    },\n                    selectionChange: function(newRefs: IReference[]) {\n                        var oldRefs = theNode.isDown ? options.item.downLinks : options.item.upLinks;\n                        // figure out if the old refs have some links to some items which cannot be selected in tree (e.g. uplinks as risk controls -> these should not be removed)\n                        let selectableTypes = (theNode.isDown?allDownTypes:allUpTypes).map( function(st) {return st.type;});\n                        $.each(oldRefs, function(oridx,oref) {\n                            if (selectableTypes.indexOf( ml.Item.parseRef(oref.to).type) ==-1) {\n                                newRefs.push( oref );\n                            }\n                        });\n                        var changes = ml.Item.updateReferences(oldRefs, newRefs, theNode.isDown ? options.item.id : null, theNode.isDown ? null : options.item.id);\n                        app.commitChangeListAsync(changes).always(function (error, stepsDone) {\n                            options.callback(options.item);\n                        });\n\n\n                    },\n                    selectMode:SelectMode.items,\n                });\n\n            } else if (theNode.isCreate) {\n\n                if (app.canCreateItemType(theNode.type, false)) {\n                    app.dlgForm.dialog(\"close\");\n                    var create = new ItemCreationTools();\n                    create.showDialog({\n                        name: globalMatrix.ItemConfig.getItemConfiguration(theNode.type).label,\n                        parent: app.getRootOfType(theNode.type),\n                        type: theNode.type,\n                        folder: false,\n                        dontOpenNewItem:true,\n                        created: function(created) {\n                            var fromId:string;\n                            var toId:string;\n                            if (theNode.isDown) {\n                                fromId = options.item.id;\n                                toId = created.to;\n                            } else {\n                                fromId = created.to;\n                                toId = options.item.id;\n                            }\n                            app.addDownLinkAsync(fromId, toId).done(function () {\n\n                            }).fail(function () {\n                                ml.UI.showError(\"Could not link items.\", \"\");\n                            }).always(function(){\n                                 options.callback(options.item);\n                            });\n                        }\n\n\n                    });\n                }\n            } else if ( event.ctrlKey) {\n                var win = window.open(app.createItemUrl(theNode.id), '_blank');\n                if (event.preventDefault)\n                    event.preventDefault();\n                if (event.stopPropagation)\n                    event.stopPropagation();\n                return;\n            } else if (theNode.Nodes.length == 0) {\n\n                app.getItemAsync(theNode.id).done(function (item) {\n                    if (theNode.isDown) {\n                        for (var idx = 0; idx < item.downLinks.length; idx++) {\n                            theNode.Nodes[idx] = {\n                                isCreate: false, isDown: true, isIndirect: item.downLinks[idx].isIndirect, id: item.downLinks[idx].to, Content: $(\"<div></div>\").refLink({\n                                    id: item.downLinks[idx].to, title: \"\", style: refLinkStyle.show, tooltip: refLinkTooltip.html, hideTitle:true\n                                }), Nodes: []};\n                        }\n                        hideXTCs(theNode.Nodes);\n                    } else {\n                        for (var idx = 0; idx < item.upLinks.length; idx++) {\n                            theNode.Nodes[idx] = {isCreate: false, isDown: false, isIndirect: item.upLinks[idx].isIndirect,id: item.upLinks[idx].to, Content: $(\"<div></div>\").refLink({\n                                    id: item.upLinks[idx].to, title: \"\", style: refLinkStyle.show, tooltip: refLinkTooltip.html, hideTitle:true\n                                }), Nodes: []};\n                        }\n                    }\n                    // Draw the tree for the first time\n                    RefreshTree();\n                });\n            }\n        }\n\n        function NodeDoubleClick(theNode: DrawTreeNode, event: MouseEvent) {\n            if(theNode.id == undefined){\n                console.warn(\"No id defined for node. Cannot open item. It's problably double click on select or create.\");\n                return;\n            }\n\n            if ( event.ctrlKey ||event.metaKey ) {\n                var win = window.open(app.createItemUrl(theNode.id), '_blank');\n                if (event.preventDefault)\n                    event.preventDefault();\n                if (event.stopPropagation)\n                    event.stopPropagation();\n                return;\n            }\n            app.dlgForm.dialog(\"close\");\n            app.treeSelectionChangeAsync(theNode.id).done(function () {\n            }).fail(function () {\n            }).always(function(){ options.callback(options.item);});\n        }\n\n\n\n        ml.UI.showDialog(\n            app.dlgForm,\n            \"References of '\" + options.item.id + \"'\",\n            treeContainer, 900, 400,\n            [{\n                text:'Close',\n                class:'btnCancelIt',\n                click:function () {\n                    app.dlgForm.dialog(\"close\");\n                }\n            }], UIToolsConstants.Scroll.Auto, false, true, null, null,\n            function () {\n                app.dlgForm.resizeDlgContent([]);\n                RefreshTree();\n            }\n        );\n\n        /*\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"References of '\" + options.item.id + \"'\",\n            height: 400,\n            width: 900,\n            modal: true,\n            resizeStop: function () {\n                app.dlgForm.resizeDlgContent([]);\n                RefreshTree();\n            },\n            open: function () {},\n            buttons: []\n        });\n       */\n        app.getItemAsync(options.item.id).done(function (item: IItem) {\n            createStartNode(item);\n            RefreshTree();\n        })\n\n    };\n}\n","import { IReference, ControlState, globalMatrix, app, matrixSession } from \"../../../globals\";\nimport { IDBParent } from \"../../businesslogic/index\";\nimport { MR1, IPreCreateItemEvent } from \"../../businesslogic/index\";\nimport { mDHF } from \"../../businesslogic/index\";\nimport { ml } from \"../../matrixlib\";\nimport { ILinkType, ItemControl } from \"../Components/ItemForm\";\nimport { NavigationPanel } from \"../MainTree/MainTree\";\n\nexport type { ICreateDialogOptions, ICreateDialogEventOptions, ICreateDialogButtonOptions };\nexport { ItemCreationTools };\n\n// -----------------------------------------------------------\n// Dialog to create new folder or items of any kind\n// -----------------------------------------------------------\ninterface ICreateDialogOptions {\n    type:string,\n    name: string,\n    folder:boolean,\n    created?: (newItems: IReference) => void,\n    singleCreate?:boolean, // set to true to hide create multiple\n    dontOpenNewItem:boolean, // if set to true, the selection in the tree does not change\n    parent:string,\n    closed?:Function\n}\n\ninterface ICreateDialogEventOptions {\n    data:ICreateDialogOptions\n}\n\ninterface ICreateDialogButtonOptions {\n    control: JQuery,\n    linkTypes: ILinkType[],\n    singleCreate?:boolean, // set to true to hide create multiple\n    created?: (newRef:IReference) => void,\n    isRiskControl?: boolean,\n    type?:string,\n    parent?:string,\n    docTemplate?:boolean,\n    open?:(view:ItemControl) => void // called just after dialog was opened\n    tinybuttons?:boolean,\n    dontOpenNewItem:boolean, // if set to true, the selection in the tree does not change\n}\n\nclass ItemCreationTools {\n\n    private onOpenDlg:(view:ItemControl) => void;\n    // pops up a dialog to create one or more items of the given type\n    showDialog(options:ICreateDialogOptions) {\n        this.showCreateDialog(options);\n    }\n\n    renderButtons(options:ICreateDialogButtonOptions) {\n        let that = this;\n\n        if (options.type && !globalMatrix.ItemConfig.canCreate(options.type)) {\n            options.control.append(\"<div class='inlineHelp'>You have no rights to create items or folders in this category</div>\");\n            return;\n        }\n        // save on open callback if there is any\n        this.onOpenDlg = options.open;\n\n        options.control.addClass(\"rowFlex\").addClass(\"createButtons\");\n\n        for (var idx = 0; idx < options.linkTypes.length; idx++) {\n\n            var disabled = app.canCreateItemType(options.linkTypes[idx].type, options.linkTypes[idx].folder) ? \"\" : \"disabled\";\n\n            var seleniumClass = \"\";\n            var name = options.linkTypes[idx].buttonName?options.linkTypes[idx].buttonName:\"Create\";\n            name += \" <b>\" + options.linkTypes[idx].name + \"<b>\";\n            seleniumClass = \"sel_create_\" + (options.linkTypes[idx].folder?\"Folder\":options.linkTypes[idx].type);\n            if (options.linkTypes[idx].buttonName==\"Import\") {\n                seleniumClass = \"sel_import_\" + options.linkTypes[idx].name;\n            }\n            var riskFormat=options.isRiskControl?\"btn-sm \"+(idx===0?\"rcb0\":\"rcbn\"):\"\";\n            if (options.tinybuttons) { // overwrite style\n                riskFormat=options.isRiskControl?\"btn-xs rcbn\":\"btn-xs\";\n                name = \"+\" + options.linkTypes[idx].type;\n            }\n            var button = $(\"<button class='\"+ riskFormat + \" buttonCreateSelect btn btn-success \"+ seleniumClass + \"' \" + disabled + \">\" + name + \"</button>\");\n            var parent = app.getRootOfType(options.linkTypes[idx].type);\n            if (options.parent) {\n                parent = options.parent;\n            }\n\n            let btnInfo:ICreateDialogOptions = {\n                type: options.linkTypes[idx].type,\n                name: options.linkTypes[idx].name,\n                folder: options.linkTypes[idx].folder,\n                created: options.created,\n                parent: parent,\n                singleCreate:options.singleCreate,\n                dontOpenNewItem:options.dontOpenNewItem\n            };\n            if (options.linkTypes[idx].import) {\n                button.click(() => mDHF.showCreateFromDocx(btnInfo));\n            } else {\n                button.click(() => this.showCreateDialog(btnInfo));\n\n            }\n            options.control.append(button);\n            if (!globalMatrix.ItemConfig.canCreate(options.linkTypes[idx].type)) {\n                ml.UI.setEnabled(button,false);\n            }\n\n        }\n    }\n\n    private async showCreateDialog(options: ICreateDialogOptions) {\n        let that = this;\n        // options.type -> the type of item to create\n        // options.name -> the name of item type to create\n        // options.created callback called after item was created\n        // options.closed callback called after dialog was closed\n        // options.multiple NYI (allow to create several\n        // options.parent -> needed for folder tools (undefinef for root folders)\n        // options.folder -> true for folder tools\n\n        // prepare dialog - nice and clean..\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n\n        // render form\n        // The boolean {controlInitialized} is necessary because otherwise we can get\n        // a JavaScript error in {reviewSaveState} below, if ctrl is not defined.\n        let controlInitialized = false;\n        let ctrl = new ItemControl({\n            control: app.dlgForm,\n            controlState: ControlState.DialogCreate,\n            parent: options.parent,\n            type: options.type,\n            isItem: !options.folder,\n            changed: function () {\n                reviewSaveState();\n            }\n        });\n        await ctrl.load();\n\n        controlInitialized = true;\n\n        async function reviewSaveState() {\n            if (controlInitialized) {\n                changeSaveState(await ctrl.needsSave() && await ctrl.hasTitle());\n            }\n        }\n\n        var createdMultiple = false;\n\n        MR1.onItemCreateDlgOpen().subscribe(this, this.onDialogOpen);\n\n        let ok = false;\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Create new \" + options.name,\n            height: 300,\n            width: 900,\n            modal: true,\n            closeOnEscape: false, // escape is annoying because it cannot be undone and it can happen when entering tables\n            open: function () {\n                if (options.singleCreate) {\n                    $('.ui-dialog-buttonpane button:eq(0)', app.dlgForm.parent()).hide();\n                } else {\n                    $('.ui-dialog-buttonpane button:eq(0)', app.dlgForm.parent()).replaceWith(\n                        '<label class=\"dlgCreateMultiple\"><input type=\"checkbox\" name=\"createMultiple\">' +\n                        'Create multiple</label>');\n                }\n                // needs to be after line above (changes the first button;-)\n                changeSaveState(false);\n                matrixSession.startCommitTransaction();\n\n            },\n            close: function () {\n                MR1.onItemCreateDlgOpen().unsubscribe(that.onDialogOpen);\n                MR1.triggerItemCreateClose(ok);\n\n                ctrl.destroy();\n                app.dlgForm.parent().html('');\n                app.dlgForm.css('display', \"none\");\n                if (options.closed) {\n                    options.closed();\n                }\n                matrixSession.stopCommitTransaction();\n                NavigationPanel.focusTree()\n            },\n            resizeStop: function () {\n                app.dlgForm.resizeDlgContent([ctrl]);\n            },\n            buttons: [{\n                text: 'Create multiple',\n                class: 'btnCreateMultiple',\n                click: function () {\n                }\n            }, {\n                text: 'Create',\n                class: 'btnDoIt',\n                click: function () {\n                    ok = true;\n                    window.setTimeout(function () {\n                        // disable button during creation\n                        // this needs to be done as soon as the create callback was handled\n                        changeSaveState(false);\n                    }, 1);\n                    window.setTimeout(function () {\n                        save();\n                    }, 200);\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    matrixSession.stopCommitTransaction();\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent([ctrl], true);\n\n        // disable create button\n        function changeSaveState(enabled: boolean) {\n            var saveButton = $('.ui-dialog-buttonpane button:eq(0)', app.dlgForm.parent());\n            ml.UI.setEnabled(saveButton, enabled);\n        }\n\n        var save = async function () {\n            if (await ctrl.needsSave()) {\n                ctrl.saveAsync(options.type, null).then(function (result: IDBParent) {\n                    if (!createdMultiple) {\n                        // make sure the item is visible, open the folder\n                        NavigationPanel.openFolder(options.parent);\n                    }\n                    if (options.created) {\n                        options.created({to: result.item.id, title: result.item.title});\n                    }\n                    if (!$(\"input[name=createMultiple]\", app.dlgForm.parent()).is(':checked')) {\n                        app.dlgForm.dialog(\"close\");\n                        if (!createdMultiple && !options.dontOpenNewItem && (options.folder || !matrixSession.getUISettings().legacyKeepFolder && !app.needsSave())) {\n                            // just one folder was created: select it in tree\n\n                            app.treeSelectionChangeAsync(result.item.id);\n                        }\n                    } else {\n                        createdMultiple = true;\n                        changeSaveState(false);\n                        ctrl.destroy();\n                        ctrl.fillControls();\n                    }\n                }).catch(function () {\n                    changeSaveState(true);\n                });\n            }\n        };\n        return this;\n    };\n\n    private onDialogOpen(event:IPreCreateItemEvent)     {\n        let that = <ItemCreationTools>event.caller;\n        if (that.onOpenDlg) {\n            that.onOpenDlg(event.view);\n        }\n    }\n    private showCreateDialogEvent(event:ICreateDialogEventOptions) {\n        this.showCreateDialog({\n            type: event.data.type,\n            name: event.data.name,\n            folder: event.data.folder,\n            created: event.data.created,\n            parent: event.data.parent,\n            singleCreate: event.data.singleCreate,\n            dontOpenNewItem:false\n        });\n    };\n\n}\n","\n// -----------------------------------------------------------\n// Dialog to selection items\n// -----------------------------------------------------------\n\n\nimport { IDropdownOption } from \"../../../ProjectSettings\"\nimport { XRGetProject_CategoryList_GetProjectStructAck, XRGetProject_ProjectSettingAll_GetSettingAck, XRGetProject_FullTree_FancyFolderList, XRProjectType } from \"../../../RestResult\"\nimport { IDB, DBCache, ItemConfiguration } from \"../../businesslogic/index\"\nimport { RestDB } from \"../../businesslogic/index\"\nimport { ml } from \"../../matrixlib\"\nimport { ILinkType } from \"../Components/ItemForm\"\nimport { SelectMode } from \"../Components/ProjectViewDefines\"\nimport { ProjectView } from \"../Components/ProjectView\"\nimport { UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\"\nimport {\n    IReference,\n    app,\n    ControlState,\n    globalMatrix,\n    matrixSession,\n    setIC,\n    restConnection,\n    IRestParam\n} from \"../../../globals\"\n\nexport type { IItemSelectDialogOptions, IItemSelectButtonOptions };\nexport { ItemSelectionTools };\n\ninterface IItemSelectDialogOptions {\n    linkTypes: ILinkType[],\n    getSelectedItems: () => Promise <IReference[]>, // is called before dialog is opened to get currently selected items\n    selectionChange: (newSelection:IReference[]) => void, // is called when the dialog is closed (with select)\n\n    crossProjectInit?: Function,\n    crossProject?:boolean,\n    crossProjectProject?:string, // set to project name if project should be preselected (instead of letting user pick one)\n    crossProjectFilter?:string, // optional to filter by label\n    crossProjectFilterStrict?:boolean, // optional to remove no matching items\n    allowedProjects?:XRProjectType[], // optional to limit the allowed projects to the passed list\n    allowedCategories?:string[], // optional list of categories which can be selected\n    selectMode?:SelectMode // select Mode\n    selectOptions?:JQuery // allows to show some additional input underneath tree\n    allowAutoDownlinkSelection?: boolean // if set to true, the user can click a button and all downlinks of the current selection are included\n    dialogTitle?:string // optional. possibility to change the default dialog title\n    focusOn?:string // open tree to a specific place\n\n    height?:number // optional a dialog height\n    autoScroll?:boolean // should the view scroll to the active node? defaults to true\n}\ninterface IItemSelectButtonOptions extends IItemSelectDialogOptions {\n    buttonName?:string,\n    smallbutton?:boolean,\n    isRiskControl?:boolean,\n    control:JQuery,\n    tinybutton?:boolean\n}\nclass ItemSelectionTools {\n\n    constructor() {\n\n    }\n\n    showDialog(options:IItemSelectDialogOptions):void {\n        this.showSelectDialog(options);\n    }\n\n    renderButtons(options:IItemSelectButtonOptions):void {\n        options.control.addClass(\"rowFlex\");\n        var buttonName = options.buttonName ? options.buttonName : \"Select Existing\";\n        var renderStyle = options.smallbutton ? \"btn-sm \" : \"\";\n\n        var seleniumClass = \"sel_\" + buttonName.replace(/ /g, \"\");\n\n        var riskFormat=options.isRiskControl?\"btn-sm rcbn\":\"\";\n\n        if ( options.tinybutton ) {\n            buttonName = \"()\";\n            renderStyle = \"btn-xs\";\n            riskFormat = options.isRiskControl?\"rcbn\":\"\";\n        }\n        var button = $(\"<button name='selectRef' class='\"+ riskFormat +\" buttonCreateSelect btn btn-default \" + seleniumClass + \" \"  + renderStyle + \"'>\" + buttonName + \"</button>\");\n        var dlgOptions:IItemSelectDialogOptions = {\n            linkTypes: options.linkTypes,\n            getSelectedItems: options.getSelectedItems,\n            selectionChange: options.selectionChange,\n            selectMode: options.selectMode,\n            crossProject: options.crossProject,\n            crossProjectInit: options.crossProjectInit,\n            crossProjectProject: options.crossProjectProject,\n            allowedProjects:options.allowedProjects,\n            allowedCategories:options.allowedCategories,\n            allowAutoDownlinkSelection:options.allowAutoDownlinkSelection,\n            crossProjectFilter: options.crossProjectFilter?options.crossProjectFilter:null,\n            crossProjectFilterStrict: options.crossProjectFilterStrict\n        };\n        if (options.crossProject) {\n            button.click(() => this.showCrossProjectDialog(dlgOptions));\n        } else {\n            button.click(() => this.showSelectDialog(dlgOptions));\n        }\n\n       options.control.append(button);\n    }\n\n\n    private showSelectDialog(options:IItemSelectDialogOptions) {\n        let that = this;\n\n        // remove global highlight and show only matches in dlg after\n        ml.Search.searchInDialog();\n\n        var linkTypes: string[] = [];\n        for (var idx = 0; idx < options.linkTypes.length; idx++) {\n            linkTypes.push(options.linkTypes[idx].type);\n        }\n\n        let  container = $(\"<div style='height: 100%'>\");\n        let tree = $(\"<div class='itemSelectionContainer'>\").appendTo(container);\n        tree.append(ml.UI.getSpinningWait(\"Loading tree\"));\n\n        app.waitForMainTree(loadTree);\n\n        let dlg = $(\"#selectItemDlg\");\n        ml.UI.showDialog(\n            dlg,\n            options.dialogTitle?options.dialogTitle:\"Select Items\",\n            container,\n            500,\n            options.height?options.height:600,\n            [{\n                text:'Select',\n                class:'btnDoIt',\n                click:async function () {\n                    options.selectionChange(await tree.getController().getValueAsync());\n                    dlg.dialog(\"close\");\n                }\n            },{\n                text:'Cancel',\n                class:'btnCancelIt',\n                click:function () {\n                    dlg.dialog(\"close\");\n                }\n            }],\n            UIToolsConstants.Scroll.None,\n            true,\n            true,\n            function () {\n                // dlg is gone, remove highlights and back to global highlighting\n                ml.Search.endSearchInDialog();\n                ml.UI.popDialog(dlg);\n            },\n            function () {\n                ml.UI.pushDialog(dlg);\n                if (options.selectOptions) {\n                    $(\".treeContent\", container).css(\"bottom\", options.selectOptions.height());\n                    $(\".listContent\", container).css(\"bottom\", options.selectOptions.height());\n                }\n                if ( options.focusOn ) {\n                    (<ProjectView>tree.getController()).select(options.focusOn);\n                }\n            },\n        )\n\n\n        async function loadTree() {\n            //Let's remove the loading stuff\n            tree.html(\"\");\n            let treeData = app.getTree(linkTypes)\n            tree.projectView({\n                tree: treeData,\n                controlState: ControlState.DialogCreate,\n                selectedItems: await options.getSelectedItems(),\n                canSelectItems: true,\n                selectMode: options.selectMode,\n                expand: (options.selectMode == SelectMode.auto || options.selectMode == SelectMode.independent) ? 0 : 1,\n                autoScroll: options.autoScroll\n            })\n            if (options.selectOptions) {\n                container.append(options.selectOptions)\n            }\n        }\n    }\n\n    private toggleSelect( enabled:boolean) {\n        ml.UI.setEnabled($(\".btnDoIt\", $(\"#selectItemDlg\").parent() ), enabled);\n    }\n    showCrossProjectDialog(options:IItemSelectDialogOptions) {\n        let that = this;\n\n        let originalIC = ml.JSON.clone(globalMatrix.ItemConfig);\n\n        // remove global highligh and show only matches in dlg after\n        ml.Search.searchInDialog();\n\n        var linkTypes:string[] = [];\n        for (var idx = 0; idx < options.linkTypes.length; idx++) {\n            linkTypes.push(options.linkTypes[idx].type);\n        }\n\n        var dlgUi = $(\"<div>\");\n        dlgUi.append('<span class=\"ui-helper-hidden-accessible\"><input autocomplete=\"off\" type=\"text\"/></span>');\n        var projectList = options.allowedProjects?options.allowedProjects:matrixSession.getProjectList(true);\n        var projectSelect: IDropdownOption[] = [];\n        $.each(projectList, function (projectIdx, project) {\n            if (!options.crossProjectProject || options.crossProjectProject === project.shortLabel) {\n                projectSelect.push({id: project.shortLabel, label: project.shortLabel + \" - \" + project.label });\n            }\n        });\n        var tree = $(\"<div>\").html(\"Select a project\");\n        var projectSelection = $(\"<div>\").mxDropdown({\n            controlState: ControlState.DialogCreate,\n            canEdit: true,\n            dummyData: false,\n            help: 'Project',\n            parameter: {\n                readonly: false,\n                placeholder: \"select project\",\n                splitHuman: false,\n                options: projectSelect\n            },\n            valueChanged: async function () {\n                var newProjectId = await projectSelection.getController().getValueAsync();\n                projectSelection.hide();\n                options.crossProjectInit(newProjectId);\n                setIC(new ItemConfiguration(ml.Logger, ml.JSON));\n\n                if (options.allowAutoDownlinkSelection) {\n\n                    // add a button to auto select downlinked items\n                    $(`<div class='dlgLinkButton'>select all downlinks</div>`).appendTo($(\".ui-dialog-buttonpane\", dlg.parent())).click(async () => {\n                        let selection = (await tree.getController().getValueAsync()).map(sel => sel.to);\n                        let di = selection.map(sel => `uplinkm=${sel}`);\n                        if (di.length) {\n                            ml.UI.BlockingProgress.Init([{name: \"getting downlinks of current selection\"}], true);\n                            ml.UI.BlockingProgress.SetProgress(0, 1);\n                            let search = `/needleminimal`;\n                            let params:IRestParam  ={ search: `mrql:${di.join(\" or \")}` }\n                            restConnection.postServer(newProjectId + search).done((downlinks) => {\n                                tree.getController().setValue(selection.concat(downlinks));\n                                ml.UI.BlockingProgress.SetProgress(0, 100);\n                            });\n                        }\n                    });\n                }\n\n                restConnection.getServer(newProjectId + \"/cat\").done(function (catDetails: XRGetProject_CategoryList_GetProjectStructAck) {\n                    globalMatrix.ItemConfig.addCategories(catDetails);\n\n                    restConnection.getServer(newProjectId + \"/setting\").done(function (settings: XRGetProject_ProjectSettingAll_GetSettingAck) {\n                        globalMatrix.ItemConfig.addSettings(settings);\n                        let treeSearch = \"/tree?fancy\" + (options.crossProjectFilter ? (\"&filter=\" + options.crossProjectFilter) : \"\");\n                        restConnection.getServer(newProjectId + treeSearch).done(async function (result: XRGetProject_FullTree_FancyFolderList) {\n                            result = RestDB.filterLegacyReportCat(result);\n                            if (options.allowedCategories) {\n                                result = result.filter(node => options.allowedCategories.includes(node.type));\n                            }\n                            if (options.crossProjectFilterStrict) {\n                                result = <XRGetProject_FullTree_FancyFolderList>that.removeHidden(<IDB[]>result);\n                            }\n                            var pdb = new DBCache();\n                            await pdb.initMatrixTree(result, false);\n                            var treeContent = pdb.getTree(linkTypes);\n\n                            tree.html(\"\").projectView({\n                                tree: treeContent,\n                                controlState: ControlState.DialogCreate,\n                                selectedItems: options.getSelectedItems(),\n                                canSelectItems: true,\n                                selectMode: options.selectMode,\n                                expand: options.selectMode == SelectMode.auto ? 0 : 1,\n                                crossProject: newProjectId\n                            });\n                            if (options.selectOptions) {\n                                $(\".treeContent\", tree).css(\"bottom\", options.selectOptions.height() + 4);\n                            }\n                            that.toggleSelect(true);\n                        }).fail(function () {\n                            setIC(originalIC);\n                        });\n                    }).fail(function () {\n                        setIC(originalIC);\n                    });\n                }).fail(function () {\n                    setIC(originalIC);\n                });\n            }\n\n        });\n\n        dlgUi.append(projectSelection);\n        dlgUi.append(tree);\n\n        var niceSize = ml.UI.getNiceDialogSize(750, 400);\n\n        let dlg = $(\"#selectItemDlg\");\n        dlg.html(\"\");\n        dlg.removeClass(\"dlg-v-scroll\");\n        dlg.addClass(\"dlg-no-scroll\");\n        dlg.append(dlgUi);\n\n        if (options.selectOptions) {\n            dlg.append(options.selectOptions);\n        }\n        dlg.dialog({\n            autoOpen: true,\n            title: \"Select Project and Items\",\n            height: niceSize.height,\n            width: niceSize.width,\n            modal: true,\n            close: function () {\n                // just in case it was added\n                setIC(originalIC);\n                $(\".dlgLinkButton\").remove();\n                // dlg is gone, remove highlights and back to global highlighting\n                ml.Search.endSearchInDialog();\n                ml.UI.popDialog(dlg);\n            },\n            open: function () {\n\n                ml.UI.pushDialog(dlg);\n                if ( options.crossProjectProject ) {\n                    projectSelection.getController().setValue(options.crossProjectProject, false, true);\n                }\n                that.toggleSelect(false);\n\n            },\n            resizeStop: function (event, ui) {\n                if (tree) {\n                    dlg.resizeDlgContent([tree]);\n                }\n            },\n            buttons: [{\n                text: 'Select',\n                class: 'btnDoIt',\n                click: async function () {\n                    options.selectionChange(await tree.getController().getValueAsync());\n\n                    dlg.dialog(\"close\");\n                }\n            },{\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n\n                    dlg.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent([tree], false);\n    };\n\n    private removeHidden( tree:IDB[]) {\n        let that = this;\n        let newTree:IDB[] = [];\n        $.each(tree, function(idx, node) {\n            if (!node.isUnselected) {\n                let pushy :IDB = {\n                     id:node.id\n                    , title: node.title\n                    , type: node.type\n                    , isUnselected: node.isUnselected\n                }\n                if ( typeof  node.children !== 'undefined' ) {\n                    pushy.children = that.removeHidden(node.children);\n                }\n                newTree.push(pushy);\n            }\n        });\n\n        return newTree;\n    }\n}\n","import { IDB, ItemConfiguration } from \"../../../common/businesslogic/index\";\nimport { IPlugin, IProjectPageParam, IPluginPanelOptions, plugins } from \"../../../common/businesslogic/index\";\nimport { ml } from \"../../../common/matrixlib\";\nimport { IBaseControlOptions } from \"../../../common/UI/Controls/BaseControl\";\nimport { IItem, globalMatrix, restConnection, ILink, app, matrixSession } from \"../../../globals\";\n\nimport { XRGetProject_StartupInfo_ListProjectAndSettings, XRGetProject_Needle_TrimNeedle, XRGetTodosAck, XRTrimNeedleItem, XRTodo } from \"../../../RestResult\";\nimport {FieldDescriptions} from \"../../../common/businesslogic/FieldDescriptions\";\nimport { NotificationsBL } from \"../../../common/businesslogic/NotificationsBL\";\n\nexport type { IXmlCharIssues };\nexport { Cleanup };\nexport { initialize };\n\ninterface IXmlCharIssues { itemId: string, details: string }\n\nclass Cleanup implements IPlugin {\n    private item:IItem;\n    private jui:JQuery;\n    static FIX_THE_ZOMBIE = \"Fix the zombie link to \";\n    static FIX_THE_IMAGE = \"Fix the zombie image \";\n    static FIX_INVALID_XML = \"Find invalid xml\";\n\n    public static badEncodedChars = [\n        // ok: #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]\n\n        \"[\\x00-\\x08]\",\n                    // OK: #x9 | #xA\n        \"[\\x0B-\\x0C]\",\n                    // OK: #xD\n        \"[\\x0E-\\x1F]\",\n                    // OK: [#x20-#xD7FF]\n        \"[\\uD800-\\uDFFF]\",\n                    // OK: [#xE000-#xFFFD]\n        \"[\\uFFFE-\\uFFFF]\",\n\n        // some bad html characters NOT USED https://www.w3schools.com/tags/ref_charactersets.asp\n        String.fromCharCode(129),\n        String.fromCharCode(141),\n        String.fromCharCode(143),\n        String.fromCharCode(144),\n        String.fromCharCode(157),\n    ];\n\n    // ****************************************\n    // standard plugin interface\n    // ****************************************\n\n    public isDefault = true;\n    constructor() {}\n    initItem(_item:IItem, _jui:JQuery) {\n        this.item = _item;\n        this.jui = _jui;\n    }\n\n    initServerSettings( serverSettings:XRGetProject_StartupInfo_ListProjectAndSettings ) {\n    }\n\n    updateMenu(ul:JQuery, hook:number) {\n\n        return;\n    }\n\n    supportsControl(fieldType: string): boolean {\n        return false;\n    }\n\n    createControl(ctrl: JQuery, options: IBaseControlOptions) {\n\n    }\n\n    initProject() {\n\n    }\n\n\n    // project pages show in the top in Projects, Reports and Documents\n    getProjectPagesAsync():Promise<IProjectPageParam[]> {\n        return new Promise((resolve, reject) => {\n            let that = this;\n            let pages: IProjectPageParam[] = [];\n\n            let extras = globalMatrix.ItemConfig.getExtrasConfig();\n            if (extras && ml.JSON.isTrue(extras.cleanup)) {\n\n                pages.push({\n                    id: \"CLEANUP\",\n                    title: \"technical verification of project\",\n                    folder: \"TOOLS\",\n                    order: 1000,\n                    icon: \"fal fa-washer\",\n                    usesFilters: true,\n                    render: (options: IPluginPanelOptions) => that.renderProjectPage(options)\n                })\n\n            }\n            resolve(pages);\n        })\n    }\n\n\n\n    // ****************************************\n    // Misc functions called by task control\n    // to create / refresh UI components\n    // ****************************************\n\n    private renderProjectPage(options:IPluginPanelOptions) {\n        let that = this;\n\n        ml.UI.toggleFilters(false);\n\n        let cleanUpTasks = $(\"<ul style='margin-top:6px'>\");\n        ml.UI.getPageTitle(\"Cleanup\").appendTo(options.control);\n        let page = $('<div class=\"panel-body-v-scroll fillHeight\" style=\"padding:12px\">').appendTo(options.control);\n\n        $(\"<button title class='btn btn-success hidden-print'>Find zombie smart links</button>\")\n            .appendTo(page)\n            .click( function() {\n                cleanUpTasks.html(\"\").append(ml.UI.getSpinningWait(\"finding zombie links\"));\n                that.runCleanupSmartZombies(cleanUpTasks);\n            });\n        $(\"<button style='margin-left:12px' title class='btn btn-success hidden-print'>Find zombie images</button>\")\n        .appendTo(page)\n        .click( function() {\n            cleanUpTasks.html(\"\").append(ml.UI.getSpinningWait(\"finding zombie links\"));\n            that.runCleanupImageZombies(cleanUpTasks);\n        });\n        $(\"<button style='margin-left:12px' title class='btn btn-success hidden-print'>Find invalid characters</button>\")\n        .appendTo(page)\n        .click( function() {\n            cleanUpTasks.html(\"\").append(ml.UI.getSpinningWait(\"finding invalid characters\"));\n            that.runCleanupCharacters(cleanUpTasks);\n        });\n        let results = $(\"<div style='padding-top:6px'>\").appendTo(page);\n        results.append(\"<p><b>Zombie smart links</b> are smart links which point to items which done exist (anymore).</p>\");\n        results.append(\"<p><b>Zombie images</b> are images which are on a third party server. These are problematic, because during the report generation, our server might not have the right to access these, so they will be missing in the generated documents.</p>\");\n        results.append(\"<p><b>Invalid characters</b> are characters which cannot be printed. In case data gets imported (maybe through the api or excel), some items might these unprintable characters and printing will fail.</p>\");\n\n        results.append(cleanUpTasks).appendTo(page);\n    }\n\n    private runCleanupSmartZombies(cleanUpTasks:JQuery) {\n\n        let that = this;\n\n        app.getNeedlesAsync(\"category!=XTC\",false,false,\"*\",false ).done( (needles: IItem[] ) => {\n\n            cleanUpTasks.html(\"\");\n\n            let zombies:ILink[]=[];\n\n            let allItems = needles.map( function( needle){ return ml.Item.parseRef(needle.id).id});\n            let allFolders = that.getFolders(app.getTree());\n\n\n            let all = allItems.concat(allFolders).concat(app.getItemTitle(\"F-XTC-1\") ? app.getChildrenIdsRec(\"F-XTC-1\") : []);\n\n            $.each( needles, function( idx, needle) {\n\n                let item = ml.Item.parseRef(needle.id).id;\n\n                let smartLinks = that.getSmartLinks( needle );\n                if (smartLinks) {\n                    $.each(smartLinks, function( fsl, sl) {\n                        if (all.indexOf(sl)==-1) {\n                            console.log( \"zombie: \" + sl + \" in id \" + item);\n                            let parsed = ml.Item.parseRef(sl);\n                            let first = (parsed.isFolder?\"F-\":\"\") + parsed.type;\n\n                            cleanUpTasks.append(\"<li>\" + item+  \" has a zombie link to <span>\" + first + \"-</span>\" + parsed.number + \"</li>\")\n                            zombies.push({ from:item, to:sl });\n                        }\n                    });\n                }\n            });\n\n            cleanUpTasks.highlightReferences();\n\n            if (zombies.length) {\n                ml.UI.showConfirm(-1,  { title:\"Found \" + zombies.length+ \" zombie links! These are smart links which point to non existing items.\", ok:\"Create Notifications\", nok:\"Review Manually\"},  () => {\n\n                    restConnection.getProject(\"todo\", true).done(async function  (allNotifications: XRGetTodosAck) {\n                       let oldFixIt = allNotifications.todos.filter( function(todo) {\n                           if (NotificationsBL.getMessage(todo).indexOf(Cleanup.FIX_THE_ZOMBIE)!=0) {\n                               // an unrelated notification - ignore it\n                               return false;\n                           }\n                           for( var zidx=0; zidx < zombies.length; zidx++)  {\n                                if (zombies[zidx].from == todo.itemRef && NotificationsBL.getMessage(todo) == that.getZombieNotificationName(zombies[zidx].to)) {\n                                    // there is a zombie and a notification, no need to create a new one, nor to remove  the old\n                                    zombies.splice(zidx,1);\n                                    return false;\n                                }\n                           };\n                           return true;\n                       });\n                       // now oldFixIt contains all the obsolete notifications and zombies all new ones\n                        await that.createSmartZombieNotifications(zombies, 0);\n                        that.removeNotifications(oldFixIt, 0);\n                    });\n\n                }, null);\n            } else {\n                ml.UI.showSuccess(\"no zombies found!\");\n            }\n\n        }).fail( function() {\n            ml.UI.showError(\"Error retrieving project data\" , \"\");\n        });\n\n    }\n\n    // create a notification about a smart link being a zombie\n    private async  createSmartZombieNotifications(zombies:ILink[], idx:number) {\n        let that = this;\n\n        if (zombies.length<=idx) {\n            return ;\n        }\n        try{\n            await NotificationsBL.createNotification([matrixSession.getUser()], matrixSession.getProject(), zombies[idx].from, that.getZombieNotificationName(zombies[idx].to), null, null);\n        }\n        catch(e) {} // ignore errors\n        try{\n            await that.createSmartZombieNotifications(zombies, idx+1)\n        }\n        catch(e) {} // ignore errors\n        return ;\n    }\n\n    private getZombieNotificationName( itemId:string ) {\n        return Cleanup.FIX_THE_ZOMBIE + itemId;\n    }\n    private getSmartLinks( needle:IItem) {\n\n        if (!needle.fieldVal) {\n            return null;\n        }\n\n        // define expression for smart links\n        var regexstr = '((F-)*(\\/)*(' + globalMatrix.ItemConfig.getCategories(true).join(\"|\") + ')-[0-9]+)';\n        var re = new RegExp(regexstr,'g');\n\n        // parse fields\n        var links:string[] = [];\n        $.each( needle.fieldVal, function(idx, fieldVal) {\n\n            // some fields needs to be ignored\n            let fieldType = globalMatrix.ItemConfig.getFieldById(ml.Item.parseRef(needle.id).type, fieldVal.id).fieldType;\n            if (  fieldType == FieldDescriptions.Field_crosslinks || fieldType==FieldDescriptions.Field_fileManager ||  fieldType==FieldDescriptions.Field_signCache || fieldType==FieldDescriptions.Field_risk2 || fieldType == FieldDescriptions.Field_publishedItemList){\n                return;\n            }\n            var match = fieldVal.value?fieldVal.value.match(re):null;\n            if (match) {\n                $.each( match, function(midx,m) {\n                    if ( m.indexOf(\"/\")==0) return; // folder or cross project are not yet supported\n                    if (links.indexOf(m) ===-1) {\n                        links.push(m);\n                    }\n                });\n\n            }\n        });\n        return links;\n    }\n    private runCleanupImageZombies(cleanUpTasks:JQuery) {\n\n        let that = this;\n\n        app.getNeedlesAsync(\"category!=XXXXXX\", false,false,\"*\",false).done((resultsNeedles)=>{\n\n            cleanUpTasks.html(\"\");\n\n            let zombies:ILink[]=[];\n\n            $.each( resultsNeedles, function( idx, needle) {\n\n                let item = needle.id;\n\n                let imageLinks = that.getImages( needle );\n                if (imageLinks) {\n                    $.each(imageLinks, function( fsl, sl) {\n\n                        console.log( \"zombie: \" + sl + \" in id \" + item);\n\n                        cleanUpTasks.append(\"<li>\" + item+  \" has a zombie image '<span>\" + sl+ \"'</li>\");\n                        zombies.push({ from:item, to:sl });\n                    });\n                }\n            });\n\n            $(\"img\", cleanUpTasks).addClass(\"cleanupImg\");\n            cleanUpTasks.highlightReferences();\n\n            if (zombies.length) {\n                ml.UI.showConfirm(-1,  { title:\"Found \" + zombies.length+ \" zombie images! These are images which point to an external file server.\", ok:\"Create Notifications\", nok:\"Review Manually\"},  () => {\n\n                    restConnection.getProject(\"todo\", true).done(async function (allNotifications: XRGetTodosAck) {\n                       let oldFixIt = allNotifications.todos.filter( function(todo) {\n                           if (NotificationsBL.getMessage(todo).indexOf(Cleanup.FIX_THE_IMAGE)!=0) {\n                               // an unrelated notification - ignore that\n                               return false;\n                           }\n                           for( var zidx=0; zidx < zombies.length; zidx++)  {\n                                if (zombies[zidx].from == todo.itemRef && NotificationsBL.getMessage(todo) == that.getZombieImageName(zombies[zidx].to)) {\n                                    // there is a zombie and a notification, no need to create a new one, nor to remove  the old\n                                    zombies.splice(zidx,1);\n                                    return false;\n                                }\n                           };\n                           return true;\n                       });\n                       // now oldFixIt contains all the obsolete notifications and zombies all new ones\n                        try{\n                            await that.createImageZombieNotifications(zombies, 0);\n                        }\n                        catch (e){\n                            console.warn(e);\n                        }\n                        that.removeNotifications(oldFixIt, 0);\n                    });\n\n                }, null);\n            } else {\n                ml.UI.showSuccess(\"no zombies found!\");\n            }\n\n        }).fail( function() {\n            ml.UI.showError(\"Error retrieving project data\" , \"\");\n        });\n\n    }\n\n\n\n     // create a notification about a smart link being a zombie\n     private async createImageZombieNotifications(zombies:ILink[], idx:number):Promise<void> {\n        let that = this;\n\n        if (zombies.length<=idx) {\n            return ;\n        }\n         try {\n             await NotificationsBL.createNotification([matrixSession.getUser()], matrixSession.getProject(), zombies[idx].from, that.getZombieImageName(zombies[idx].to), null, null);\n         } catch (e) {\n             console.warn(e);\n         }\n         try {\n             await that.createSmartZombieNotifications(zombies, idx + 1);\n         } catch (e) {\n             console.warn(e);\n         }\n\n    }\n\n    private getZombieImageName( link:string ) {\n        return Cleanup.FIX_THE_IMAGE;\n    }\n\n\n    private removeNotifications(oldFixIt:XRTodo[], idx:number) {\n        let that = this;\n\n        if (oldFixIt.length<=idx) {\n            return;\n        }\n        NotificationsBL.deleteNotification( oldFixIt[idx]).then( function() {\n            that.removeNotifications(oldFixIt, idx+1);\n        });\n    }\n\n    private getFolders(tree:IDB[]):string[] {\n        let that = this;\n\n        let folders:string[] = [];\n        $.each( tree, function( idx, folderOrItem) {\n            if (folderOrItem.children) {\n                folders.push(folderOrItem.id);\n                folders = folders.concat( that.getFolders(folderOrItem.children) );\n            }\n        })\n\n        return folders;\n    }\n    // image links\n    private getImages( item:IItem) {\n\n        let fields = globalMatrix.ItemConfig.getFields( ml.Item.parseRef(item.id).type);\n\n        // define expression for smart links\n        let quote = \"['\" + '\"]+';\n        let regexstr = '<img.*?src.*?=.*?' + quote + '.*?' + quote + '.*?>';\n        let re = new RegExp(regexstr,'g');\n\n        // parse fields\n        var links:string[] = [];\n        for (let field of fields) {\n            let fieldVal = item[field.id];\n            var match = fieldVal?fieldVal.match(re):null;\n            if (match) {\n                $.each( match, function(midx,m) {\n                    if (m.indexOf(globalMatrix.matrixBaseUrl) != -1) return; // local - no issue\n                    if ( m.indexOf(\"data:image\")!=-1) return; // embedded no issue\n                    if ( links.indexOf(m)==-1) links.push(m.replace(/\\\\\"/g,'\"'));\n                });\n\n            }\n        };\n        return links;\n    }\n\n\n    /*****************************************\n     *\n     * invalid xml characters\n     *\n    */\n\n   private async runCleanupCharacters(cleanUpTasks:JQuery) {\n\n        let that = this;\n        cleanUpTasks.html(\"\");\n\n\n       for (let category of globalMatrix.ItemConfig.getCategories(true)) {\n            let line = $(`<li>Testing category: ${category}</li>`).appendTo(cleanUpTasks);\n\n            let xmlCharIssues:IXmlCharIssues[] = [];\n\n           let results = <XRGetProject_Needle_TrimNeedle>await restConnection.getProject(`needle?search=mrql:category=${category}&fieldsOut=*`);\n\n            for(let needle of results.needles) {\n                let itemId =  ml.Item.parseRef(needle.itemOrFolderRef).id;\n                for( let fieldVal of needle.fieldVal) {\n                    that.testXML(xmlCharIssues, itemId, fieldVal.id, JSON.stringify(fieldVal.value));\n                }\n                that.testXML(xmlCharIssues, itemId, 0, needle.title);\n            }\n            if (xmlCharIssues.length==0) {\n                line.append(\"<span> - no issues found</span>\");\n            }\n            for (let issue of xmlCharIssues) {\n                cleanUpTasks.append(\"<li>\" + ml.Item.parseRef(issue.itemId).link +  \" has an issue \" + issue.details +\"</li>\")\n            }\n        }\n   }\n\n    static textOk( fieldVal:any ) {\n        if (!fieldVal) {\n            return true;\n        }\n\n        let text = typeof fieldVal == \"string\"?fieldVal:JSON.stringify(fieldVal);\n\n        for (var j=0; j<Cleanup.badEncodedChars.length; j++) {\n            let matches = text.match(Cleanup.badEncodedChars[j]);\n            if (matches) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    private testXML( xmlCharIssues:IXmlCharIssues[], itemId:string, fieldId:number, fieldVal:string) {\n\n        for (var j=0; j<Cleanup.badEncodedChars.length; j++) {\n            if (fieldVal)  {\n            let matches = fieldVal.match(Cleanup.badEncodedChars[j]);\n                if (!matches) {\n                    try {\n                        let parsed = JSON.parse(fieldVal);\n                        matches = parsed.match(Cleanup.badEncodedChars[j]);\n                    } catch (e) {\n                        // not sire\n                    }\n                }\n                if ( matches ) {\n                    let pos = matches[\"index\"]-10;\n                    let cat = ml.Item.parseRef(itemId).type;\n                    let fieldName = fieldId > 0 ? globalMatrix.ItemConfig.getFieldById(cat, fieldId).label : \"title\";\n                    xmlCharIssues.push( {itemId:itemId, details: \"field:'\" +  fieldName + \"' pos:\" + matches[\"index\"] + \" char:\" + matches[0] + \" near: \" + fieldVal.substr( pos<0?0:pos, 20 )});\n                }\n            }\n        }\n\n    }\n\n}\n\n// register the engine as plugin\nfunction initialize() {\n    let mCleanup = new Cleanup();\n    plugins.register(mCleanup);\n}\n","// event.metaKey\n// On Macintosh keyboards, the META key maps to the Command key (⌘).\n// On Windows keyboards, the META key maps to the Windows key.\n// PC   -> Mac\n// CTRL    -> COMMAND\n// ALT     -> Option (Alt-Gr)\n// WINDOWS ->\n/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ReviewContextFrame } from \"../../../client/plugins/ReviewContextFrame\";\nimport { app, globalMatrix, matrixApplicationUI } from \"../../../globals\";\nimport { MR1, IItemViewEvent } from \"../../businesslogic/index\";\nimport { mDHF } from \"../../businesslogic/index\";\nimport { ml } from \"./../../matrixlib\";\n\nexport type { IShortcut, IShortCutOverWrite };\nexport { KeyboardShortcuts };\n\ninterface IShortcut {\n    disableEdge: boolean, disableSafari: boolean, withCtrl: boolean, keyCode: number, key: string, help: string, \n    category:string, inElement:string[], notInElement:string[], fct:(event: JQueryEventObject, that?:KeyboardShortcuts) => void };\ninterface IShortCutOverWrite { orgCtrl: boolean, newCtrl: boolean, orgKey: string, newKey: string, orgKeyCode: number, newKeyCode: number }\n\nclass KeyboardShortcuts {\n    private lastKeyDown: Date;\n    private shortCuts: IShortcut[];\n    private documentSectionIdx:number = 0;\n    \n    constructor() {\n        let that = this;\n        \n        this.defineShortcuts();\n\n        MR1.onItemDisplayed().subscribe( this, this.initToggleSection );\n    }\n\n    private defineShortcuts() {\n        let that = this;\n        this.shortCuts = [];\n        this.addCtrlShortcut( \"?\", \"Global\", \"show help dialog\", null, null, this.help, true, true ); \n        this.addShortcut( \"Delete\", \"Delete\", \"delete item\", null, [\".baseControl\",\".itemTitle\",\"#itemDetails\", \"input\",\"textarea\"], this.delete, true, false ); \n        this.addCtrlShortcut( \"l\", \"Global\", \"(l)ocate / find / search\", null, null, this.focusSearch, false, true ); \n        this.addShortcut( '<span class=\"short-ctrl\">ctrl</span> - l - ITEM-ID <span class=\"short-ctrl\">space</span>', \"Global\", \"(l)ocate and select item in tree\", null, null, this.focusSearch, false, true ); \n        this.addCtrlShortcut( \"m\", \"Global\",\"mirror current item in review frame\", null, null, this.showInReview, false, false );\n        this.addCtrlShortcut( \"Z\", \"Global\",\"zen preview of items and docs\", null, null, this.showZen, false, false );\n        \n        this.addCtrlShortcut( \"1\", \"Item Editing/Creation\",\"click on 1st create / select button\", null, null, this.createSelect, true, false );\n        this.addCtrlShortcut( \"2\", \"Item Editing/Creation\",\"click on 2nd create / select button\", null, null, this.createSelect, true, false );\n        this.addCtrlShortcut( \"3\", \"Item Editing/Creation\",\"click on 3rd create / select button\", null, null, this.createSelect, true, false );\n        this.addCtrlShortcut( \"4\", \"Item Editing/Creation\",\"click on 4th create / select button\", null, null, this.createSelect, true, false );\n        this.addCtrlShortcut( \"s\", \"Item Editing/Creation\",\"save item, create in new item dialog, select in item select dialog\", null, null, this.save, false, false );\n        this.addCtrlShortcut( \"5\", \"\", \"\", null, null, this.createSelect,true, false);\n        this.addCtrlShortcut( \"6\", \"\", \"\",  null, null, this.createSelect, true, false);\n        this.addCtrlShortcut( \"7\", \"\", \"\",  null, null, this.createSelect, true, false);\n        this.addCtrlShortcut( \"8\", \"\", \"\", null, null, this.createSelect, true, false);\n        this.addCtrlShortcut( \"9\", \"\", \"\",  null, null, this.createSelect,true, false);\n        this.addCtrlShortcutCode( 39, \"Documents\",  \"right arrow\", \"open sections in document\", null, [\".baseControl\",\"input\",\"textarea\",\"#commentDlg\"], this.toggleSections, true, false);\n        this.addCtrlShortcutCode( 37, \"Documents\",\"left arrow\", \"close sections in document\", null, [\".baseControl\",\"input\",\"textarea\",\"#commentDlg\"], this.toggleSections, true, false);\n        \n        this.addShortcutCode( 39, \"Documents\",  \"right arrow\", \"open current section\", null, [\".baseControl\",\"input\", \"textarea\", \"#commentDlg\"], this.toggleSection, true, false);\n        this.addShortcutCode( 38, \"Documents\",\"up arrow\", \"section up\",  null, [\".baseControl\",\"input\",\"textarea\", \"#commentDlg\"], this.toggleSection, true, false);\n        this.addShortcutCode( 37, \"Documents\",  \"left arrow\", \"close current section\",  null, [\".baseControl\",\"input\", \"textarea\",\"#commentDlg\"], this.toggleSection, true, false);\n        this.addShortcutCode( 40, \"Documents\",\"down arrow\", \"section down\", null, [\".baseControl\",\"input\", \"textarea\",\"#commentDlg\"], this.toggleSection, true, false);\n        \n       \n        this.addCtrlShortcutCode( 32, \"Documents\",\"space\", \"download document\", null, [\".baseControl\",\"input\", \"textarea\",\"#commentDlg\"], this.downloadDocument, false, true );\n        let ow = localStorage.getItem('shortcuts_ow');\n        if (ow ) {\n            let oow = <IShortCutOverWrite[]>JSON.parse(ow);\n            $.each(oow, function(oowidx, o) {\n                $.each(that.shortCuts, function( si,s) {\n                    if (s.key == o.orgKey && s.keyCode == o.orgKeyCode && s.withCtrl == o.orgCtrl)  {\n                        console.log(\"change key: \" + (s.withCtrl?\"ctrl-\":\"\") + (s.keyCode?s.keyCode:s.key) + \" to \"+ (o.newCtrl?\"ctrl-\":\"\") + (o.newKeyCode?o.newKeyCode:o.newKey));\n                        s.key = o.newKey;\n                        s.keyCode = o.newKeyCode;\n                        s.withCtrl = o.newCtrl;\n                    }\n                });\n            });\n        }\n    }\n    public print() {\n        $.each(this.shortCuts, function( si,s) {\n                console.log(s.help + \": \" + (s.withCtrl?\"ctrl-\":\"\") + (s.keyCode?s.keyCode:s.key) );\n        });\n    }\n    \n    public resetCustomKeys() {\n        localStorage.setItem('shortcuts_ow','');\n        console.log(\"Reset all key to default. F5 (refresh browser) to make effective\");\n    }\n    public setKey( orgCtrl:boolean,  newCtrl:boolean, orgKey:string, newKey:string) {\n        let ow = localStorage.getItem('shortcuts_ow');\n        let oow = <IShortCutOverWrite[]>(ow?JSON.parse(ow):[]);\n        oow.push({orgCtrl:orgCtrl, orgKey:orgKey, newCtrl:newCtrl, newKey:newKey, orgKeyCode:0, newKeyCode:0});\n        localStorage.setItem('shortcuts_ow', JSON.stringify(oow));\n        this.defineShortcuts(); \n        console.log(\"F5 (refresh browser) to make effective\");\n    }\n    public setKeyCode( orgCtrl:boolean,  newCtrl:boolean, orgKeyCode:number, newKeyCode:number) {\n        let ow = localStorage.getItem('shortcuts_ow');\n        let oow = <IShortCutOverWrite[]>(ow?JSON.parse(ow):[]);\n        oow.push({orgCtrl:orgCtrl, orgKey:'', newCtrl:newCtrl, newKey:'', orgKeyCode:orgKeyCode, newKeyCode:newKeyCode});\n        localStorage.setItem('shortcuts_ow', JSON.stringify(oow));\n        this.defineShortcuts(); \n        console.log(\"F5 (refresh browser) to make effective\");\n    }\n    public addCtrlShortcut( key:string, category:string, help:string, inElement:string[], notInElement:string[], fct:(event: JQueryEventObject, that?:KeyboardShortcuts) => void, disableEdge:boolean, disableSafari:boolean) {\n        this.shortCuts.push({ withCtrl:true, keyCode:0, category:category, key: key, help:help,inElement:inElement , notInElement:notInElement , fct:fct, disableEdge, disableSafari});\n    }\n    public addShortcut( key:string, category:string, help:string, inElement:string[], notInElement:string[], fct:(event: JQueryEventObject, that?:KeyboardShortcuts) => void, disableEdge:boolean, disableSafari:boolean ) {\n        this.shortCuts.push({ withCtrl:false, keyCode:0, category:category, key: key, help:help,inElement:inElement , notInElement:notInElement , fct:fct, disableEdge, disableSafari});\n    }\n    public addCtrlShortcutCode( keyCode:number, category:string, key:string, help:string,inElement:string[], notInElement:string[], fct:(event: JQueryEventObject, that?:KeyboardShortcuts) => void, disableEdge:boolean, disableSafari:boolean ) {\n        this.shortCuts.push({ withCtrl:true, keyCode:keyCode, category:category, key: key, help:help,inElement:inElement , notInElement:notInElement, fct:fct, disableEdge, disableSafari});\n    }\n    public addShortcutCode( keyCode:number, category:string, key:string, help:string,inElement:string[], notInElement:string[], fct:(event: JQueryEventObject, that?:KeyboardShortcuts) => void, disableEdge:boolean, disableSafari:boolean ) {\n        this.shortCuts.push({ withCtrl:false, keyCode:keyCode, category:category, key: key, help:help,inElement:inElement , notInElement:notInElement, fct:fct, disableEdge, disableSafari});\n    }\n    public init() {\n        let that = this;\n        \n        this.lastKeyDown = new Date();\n        const queryString = window.location.search;\n        const urlParams = new URLSearchParams(queryString);\n        let urlGlobalShiftDown = globalMatrix.globalShiftDown = urlParams.has('globalShiftDown');\n        let urlGlobalCtrltDown = globalMatrix.globalCtrlDown = urlParams.has('globalCtrltDown');\n\n        $(window).on('keydown', function(event:JQueryEventObject) {\n            \n            var continueEvent = true; \n            // console.log(\"key:\" + event.key + \" charCode: \" + event.charCode + \" keyCode:\" + event.keyCode + \" which:\" + event.which + \"ctrlKey: \" + event.ctrlKey + \"metaKey: \" + event.metaKey ); \n            \n            let notEdge = Modernizr.smil && !(/Edge/i.test(navigator.userAgent));\n            let notSafari = navigator.userAgent.indexOf(\"Safari\") == -1 || navigator.userAgent.indexOf('Chrome') > -1;\n\n            // shortcuts only work for reasonable browsers\n            // edge leads straight to hell MATRIX-1912\n            $.each (that.shortCuts, function( idx:number, shortcut:IShortcut) {\n                if ( (notEdge || !shortcut.disableEdge) && (notSafari || !shortcut.disableSafari)) { // CTRL (PC) or COMMAND (Mac) or background clicked\n                    if (event.ctrlKey || event.metaKey || !shortcut.withCtrl) { // CTRL (PC) or COMMAND (Mac) or background clicked\n                        if (shortcut.keyCode > 0 && event.which === shortcut.keyCode && that.isGoodTarget($(event.target), shortcut.inElement, shortcut.notInElement )) {\n                            shortcut.fct( event, that );\n                            //console.log(\"keyCode triggered\" ); \n                            if (event.preventDefault) event.preventDefault();\n                        }\n                        else if (event.key === shortcut.key && that.isGoodTarget($(event.target), shortcut.inElement, shortcut.notInElement )) {\n                            shortcut.fct( event, that );\n                            //console.log(\"key triggered\" ); \n                            if (event.preventDefault) event.preventDefault();\n                        }\n                    \n                    }\n                }\n            });\n           \n            if ( event.shiftKey || urlGlobalShiftDown) {\n                globalMatrix.globalShiftDown = true;\n                ml.UI.updateTooltip();\n            }\n            if (  event.ctrlKey|| urlGlobalCtrltDown) {\n                globalMatrix.globalCtrlDown = true;\n            }\n            // every minute (at most) check if the item on the server changed if so inform the user\n            // this also make sure that the system does not time out while someone is writing a big text\n            // also if someone writes something after he has been away a a login dialog will show \n            var newKeyDown = new Date();\n            if (newKeyDown.getTime() - that.lastKeyDown.getTime() > 60000) {\n                app.pingCurrentItem();\n                that.lastKeyDown = newKeyDown;\n            }\n\n            return continueEvent;\n        });\n        \n        $(window).blur(() => { globalMatrix.globalShiftDown = false; })\n\n        $(window).on('keyup', function(event) {\n            // shift does not actually fire an event of a specific key\n            if (event.keyCode === 16) {\n                globalMatrix.globalShiftDown = false;\n            }\n            if (event.keyCode === 17 || event.keyCode === 91) {\n                globalMatrix.globalCtrlDown = false;\n            }  \n            return true;\n        });\n    }\n\n    private  isGoodTarget(currentTarget:JQuery, inElement:string[], notInElement:string[] ) {\n        let isGood = true;\n        if (inElement) {\n            isGood = false;\n            $.each(inElement, function(eidx, el) {\n                if (currentTarget.closest(el).length > 0) {\n                    isGood = true;\n                }\n            });\n        }\n        if (!isGood) {\n            return false;\n        }\n        if (notInElement) {\n            \n             $.each(notInElement, function(eidx, el) {\n                if (currentTarget.closest(el).length > 0) {\n                    isGood = false;\n                }\n            });\n        }\n        return isGood;\n    }\n    private isDialogOpen( dialogSelector?:string) {\n        return KeyboardShortcuts.isDialogOpen(dialogSelector);\n    }\n    \n    private static isDialogOpen( dialogSelector?:string) {\n        try {\n            if ( dialogSelector ) {\n                if ($(dialogSelector).hasClass(\"ui-dialog-content\") && $(dialogSelector).is(\"isOpen\")) {\n                    return true;\n                } else if ($(dialogSelector).hasClass(\"modal\") && $(dialogSelector).css(\"display\")==\"block\") {\n                    return true;\n                }\n                \n                return false;\n            }\n            if($(\".ui-dialog\").is(\":visible\")) {\n                return true;\n            }\n            if ($('.modal.in').length > 0) { // test if any bootstrap dialog is open\n                return true;\n            }\n\n        } \n        catch(ex) {\n            return false;\n        }\n        return false;\n    }\n    \n    private showInReview(event: JQueryEventObject, that:KeyboardShortcuts) {\n        \n        // create / select dialog\n        if (event.preventDefault) {\n            event.preventDefault();\n        }\n        let itemId = app.getCurrentItemId();\n        if (itemId && !ml.Item.parseRef(itemId).isFolder) {\n            ReviewContextFrame.renderItem(itemId, 0, true);\n        }\n    }\n    private showZen(event: JQueryEventObject, that:KeyboardShortcuts) {\n       \n        if (event.preventDefault) {\n            event.preventDefault();\n        }\n        \n        if (!that.isDialogOpen() && matrixApplicationUI.lastMainItemForm) {\n            let currentPanel = matrixApplicationUI.currentPanel;\n            if (currentPanel.toggleZen) {\n                currentPanel.toggleZen();\n            }\n        }\n    }\n    private save(event: JQueryEventObject, that:KeyboardShortcuts) {\n        // create / select dialog\n        if (event.preventDefault) {\n            event.preventDefault();\n        }\n        KeyboardShortcuts.doSave();\n    }\n    static doSave() {\n        if (KeyboardShortcuts.isDialogOpen(\"#appPopup\")) {\n            var createBtn = $(\".btnDoIt:visible\", $(\"#appPopup\").next());\n            if (createBtn.length === 1 && !$(\".btnDoIt:visible\", $(\"#appPopup\").next()).prop(\"disabled\")) {\n                var text = $(\".btnDoIt:visible\", $(\"#appPopup\").next()).text();\n                if ( text === \"Create\" || text===\"Select\") {\n                    createBtn.click();\n                    return;\n                }\n            }\n        } else if (!KeyboardShortcuts.isDialogOpen() && app.getNeedsSave()) {\n            window.setTimeout(() => { matrixApplicationUI.saveSave(); }, 50);\n        }\n    }\n    private createSelect(event: JQueryEventObject, that:KeyboardShortcuts) {\n        \n        var createSelBtns = $(\".buttonCreateSelect:visible\");\n        if (createSelBtns.length + 1 >= Number(event.key) && !( $(createSelBtns[Number(event.key)-1]).prop(\"disabled\"))) {\n            $(createSelBtns[Number(event.key)-1]).click();\n        }\n    }\n    \n    private toggleSections(event: JQueryEventObject, that:KeyboardShortcuts) {\n        \n        if ( event.key === \"ArrowRight\") {\n            $(\".showHideAdmin:not(:checked)\").click();\n        }\n        if ( event.key === \"ArrowLeft\") {\n            $(\".showHideAdmin:checked\").click();\n        }\n    }\n    private delete(event: JQueryEventObject, that:KeyboardShortcuts) {\n        if (!that.isDialogOpen()) {\n            let btns = $(\".deleteItemBtn\");\n            if (btns.length === 1) {\n                $(btns[0]).click();\n            }\n        }\n    }\n    private initToggleSection(event: IItemViewEvent) {\n        let that = <KeyboardShortcuts>event.caller;\n        that.documentSectionIdx = -1;\n        if (!event.item || event.item.isFolder || !mDHF.isDocumentFormType(event.item.type)) {\n            return;\n        }\n        var sections = $(\"#itemDetails .cbimg\");\n        if ( sections.length > 0 ) {\n            that.documentSectionIdx = 0;\n            $(sections[that.documentSectionIdx]).next().css(\"text-decoration\",\"underline\")\n        }\n        \n    }\n    private toggleSection(event: JQueryEventObject, that:KeyboardShortcuts) {\n        if ( this.documentSectionIdx < 0) {\n            return;\n        }\n        var sections = $(\"#itemDetails .cbimg\");\n        if (that.documentSectionIdx < sections.length) {\n            let cb = $(sections[that.documentSectionIdx]).parent().prev();\n            if ( event.key === \"ArrowRight\" && !cb.is(\":checked\")) {\n                $(sections[that.documentSectionIdx]).click();\n            }\n            if ( event.key === \"ArrowLeft\" && cb.is(\":checked\")) {\n                $(sections[that.documentSectionIdx]).click();\n            }\n        }\n        if ( event.key === \"ArrowUp\" && that.documentSectionIdx > 0 ) {\n            that.documentSectionIdx--;\n        }\n        if (event.key === \"ArrowDown\" && that.documentSectionIdx < sections.length-1 ) {\n            that.documentSectionIdx++;\n        }\n        sections.next().css(\"text-decoration\", \"inherit\");\n        if (that.documentSectionIdx < sections.length) {\n            $(sections[that.documentSectionIdx]).next().css(\"text-decoration\",\"underline\")\n        }\n    }\n    \n    private downloadDocument(event: JQueryEventObject, that:KeyboardShortcuts) {\n        \n        $(\"#btnDownload\").click();\n    }\n\n    private focusSearch(event: JQueryEventObject, that:KeyboardShortcuts) {\n        \n        if ($(\"#appPopup [name=search]\").is(\":visible\")) {\n             $(\"#appPopup [name=search]\").focus();\n        } else {\n             $(\"#projectTree [name=search]\").focus();\n        }\n       \n        event.preventDefault();\n    }\n\n\n    private help(event: JQueryEventObject, that:KeyboardShortcuts) {\n        \n        if (app.dlgForm.html() !== \"\" && app.dlgForm.is(':visible')) {\n            return;\n        }\n        if ($(\"#helpModal\").length === 0) {\n            let globals = \"\";\n            let globalCategories:string[] = [];\n            $.each (that.shortCuts, function( idx:number, shortcut:IShortcut) {\n                if (shortcut.category !== \"\" && globalCategories.indexOf( shortcut.category) === -1) {\n                    globalCategories.push(shortcut.category);\n                }\n            });\n            \n            $.each(globalCategories, function(cidx, category) {\n                let right= true;\n                globals += '<div class=\"row\"><div class=\"col-sm-12\"><h1>'+ category+'</h1></div></div>';\n                globals += '<div class=\"row\">';\n\n                $.each (that.shortCuts, function( idx:number, shortcut:IShortcut) {\n                    if ( shortcut.help !== \"\" && shortcut.category === category) {\n                        right = !right;\n                        globals += '<div class=\"col-sm-2 key\">' + (shortcut.withCtrl?\"CMD-\":\"\") + shortcut.key + '</div>'; \n                        globals += '<div class=\"col-sm-4 command\">' + shortcut.help + '</div>';\n                        if (right && idx !== that.shortCuts.length-1) { // new row\n                           globals += '</div><div class=\"row\">';\n                        }\n                    }\n                });        \n                globals += '</div>';        \n            });\n\n           \n            let help : string = `\n\n                <div class=\"modal\" id=\"helpModal\" tabindex=\"-1\" role=\"dialog\" >\n                <div class=\"modal-dialog large\" role=\"document\">\n                  <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                      <h4 class=\"modal-title\" >Keyboard Shortcuts</h4>\n                    </div>\n                    <div class=\"modal-body scrollable-modal\">\n\n                    ${ globals }\n\n<div class=\"row\"><div class=\"col-sm-12\"><h1>Text Editor</h1></div></div>                    \n\n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">CMD-b</div><div class=\"col-sm-4 command\">bold</div>\n                              <div class=\"col-sm-2 key\">CMD-i</div><div class=\"col-sm-4 command\">italic</div>\n                    </div>\n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">CMD-u</div><div class=\"col-sm-4 command\">underline</div>\n                              <div class=\"col-sm-2 key\">CMD-k</div><div class=\"col-sm-4 command\">hyperlink</div>\n                    </div>\n                    \n                    \n                <div class=\"row\"><div class=\"col-sm-12\"><h1>Table Control</h1></div></div>\n              \n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">tab</div><div class=\"col-sm-4 command\">next cell (right)</div>\n                              <div class=\"col-sm-2 key\">SHIFT-tab</div><div class=\"col-sm-4 command\">previous cell (left)</div>\n                    </div>\n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">CMD-enter</div><div class=\"col-sm-4 command\">below cell (down)</div>\n                              <div class=\"col-sm-2 key\">SHIFT-enter</div><div class=\"col-sm-4 command\">open / close text editor</div>\n                    </div>\n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">esc</div><div class=\"col-sm-4 command\">cancel edit</div>\n                    </div>\n\n<div class=\"row\"><div class=\"col-sm-12\"><h1>Tree Navigation</h1></div></div>\n              \n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">arrow down</div><div class=\"col-sm-4 command\">down</div>\n                              <div class=\"col-sm-2 key\">arrow right</div><div class=\"col-sm-4 command\">open folder</div>\n                    </div>\n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">arrow up</div><div class=\"col-sm-4 command\">up</div>\n                              <div class=\"col-sm-2 key\">arrow left</div><div class=\"col-sm-4 command\">close folder</div>\n                    </div>\n                    <div class=\"row\">\n                              <div class=\"col-sm-2 key\">space</div><div class=\"col-sm-4 command\">select/show item</div>\n                              <div class=\"col-sm-2 key\"></div><div class=\"col-sm-4 command\"></div>\n                    </div>\n\n                    </div>\n                    <div class=\"modal-footer\">\n                      <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n                    </div>\n                  </div>\n                </div>\n              </div>`;\n            if ( navigator.appVersion.indexOf('Mac') > -1 ) {\n                help = help.replace(/CMD-/g, '<span class=\"short-ctrl\">\\u2318</span><span class=\"short-and\">-</span>'); \n                help = help.replace(/SHIFT-/g, '<span class=\"short-ctrl\">\\u21E7</span><span class=\"short-and\">-</span>'); \n            } else {\n                help = help.replace(/CMD-/g, '<span class=\"short-ctrl\">ctrl</span><span class=\"short-and\">-</span>'); \n                help = help.replace(/SHIFT-/g, '<span class=\"short-ctrl\">shift</span><span class=\"short-and\">-</span>'); \n            }\n            $(\"body\").append(help);\n            \n        }\n        $(\"#helpModal\").modal();\n    }\n}","import { IPlugin, IProjectPageParam, plugins } from \"../../common/businesslogic/index\";\nimport { ContextFrameManager } from \"../../common/businesslogic/index\";\nimport { ml } from \"../../common/matrixlib\";\nimport { IContextInformation } from \"../../common/matrixlib/MatrixLibInterfaces\";\nimport { ItemControl } from \"../../common/UI/Components/index\";\nimport { globalMatrix, app, IItem, matrixApplicationUI, ControlState } from \"../../globals\";\n\nimport { IContextPageConfigTab } from \"../../ProjectSettings\";\n\nexport { ReviewContextFrame };\nexport { initialize };\n\nclass ReviewContextFrame implements IPlugin {\n\n    static reviewContextFrame = \"reviewContextFrame\";\n    static lastDisplayedItemId = \"\";\n    constructor() {\n\n    }\n    onUpdate(ui: JQuery, config: IContextPageConfigTab, context: IContextInformation) {\n        ui.addClass(\"reviewContextFrame\");\n        ui.addClass(\"noRefresh\");\n\n        if (!ReviewContextFrame.lastDisplayedItemId){\n            ui.html( \"no pinned item (use ctrl-m or the item menu to pin an item here)\");\n        }\n    }\n\n    static lastRenderedItem:string;\n    static lastRenderedVersion:number;\n    static renderItem(itemId: string, version:number, showContextFrameIfNotVisible:boolean) {\n\n        ReviewContextFrame.lastDisplayedItemId = itemId;\n\n        // check if review context frame is configured\n        let cp = globalMatrix.ItemConfig.getContextPagesConfig();\n        if (!cp || !cp.tabs) return;\n        let cps = cp.tabs.filter( function(cpc) {return (<string>cpc.type) == ReviewContextFrame.reviewContextFrame;});\n        if (cps.length==0) return;\n\n        // make sure context frames are visible and tab is selected\n        let visible = ml.ContextFrames.showContextFrame( ReviewContextFrame.reviewContextFrame, showContextFrameIfNotVisible );\n        if (!visible) return;\n        // avoid getting same item again and again\n        if ( ReviewContextFrame.lastRenderedItem==itemId && ReviewContextFrame.lastRenderedVersion==version ) return;\n        app.getItemAsync(itemId, version ? version : undefined).done(async function (item: IItem) {\n\n            $(\".reviewContextFrame\").html(\"\");\n            if (item.title === undefined) {\n                matrixApplicationUI.renderErrorControl($(\".reviewContextFrame\"), \"The item \" + item.id + \" was deleted\", \"Ýou can find it in the deleted item log.\", true);\n            } else if (app.canViewItem(item)) {\n                var ctrl = new ItemControl({\n                    control: $(\".reviewContextFrame\"),\n                    controlState: ControlState.Tooltip,\n                    item: item,\n                    isItem: (typeof item.children === 'undefined')\n                });\n                await ctrl.load();\n\n                let bcs = app.getBreadcrumbs(item.id).filter(function (bc) {\n                    return bc != item.id;\n                });\n                let breadcrumb = bcs.reverse().map(function (bid: string) {\n                    return bid + \" \" + app.getItemTitle(bid);\n                }).join(\" > \");\n                let title = $(\".reviewContextFrame .itemTitle\").addClass(\"tooltipItem\").removeClass(\"pull-left\").removeClass(\"itemTitle\");\n                title.closest(\".itemTitleBarNoToolsNoEdit\").removeClass(\"itemTitleBarNoToolsNoEdit\");\n                $(\"<hr style='border-top-color: #aaa;margin-top: 10px;width: 100%;margin-bottom: 10px;'/>\").insertAfter(title);\n                $('<div style=\"font-size: smaller;\">').append($(\"<span class='inlineHelp'>\").html(breadcrumb)).insertAfter(title);\n\n            } else {\n                matrixApplicationUI.renderErrorControl($(\".reviewContextFrame\"), \"You have no rights to view \" + item.id + \"\", \"Talk to the project administrator.\", true);\n            }\n        });\n    }\n\n    private _item:IItem;\n\n    public isDefault = true;\n\n    initItem( item:IItem, jui:JQuery ) {\n        this._item = item;\n     }\n\n\n    initServerSettings() {}\n    initProject() {}\n    async getProjectPagesAsync():Promise<IProjectPageParam[]> {\n           return [];\n    }\n    updateMenu(ul:JQuery) {\n        let that = this;\n\n        let cp = globalMatrix.ItemConfig.getContextPagesConfig();\n        if (!cp || !cp.tabs) return;\n        let cps = cp.tabs.filter( function(cpc) {return (<string>cpc.type) == ReviewContextFrame.reviewContextFrame;});\n\n        if ( this._item.id &&  cps.length == 1 && !ml.Item.parseRef(this._item.id).isFolder) {\n\n            var dev = $('<li><span class=\"toolmenu\">Pin item in review pane</span></li>').appendTo(ul);\n            dev.click(function() {\n                ReviewContextFrame.renderItem(that._item.id, 0, true);\n            });\n        }\n    }\n    supportsControl() {\n        return  false;\n    }\n\n\n}\n\nfunction initialize() {\n    let reviewContextFrame = new ReviewContextFrame();\n\n    ContextFrameManager.register({\n        id: \"reviewContextFrame\",\n        title: \"Review Pane\",\n        adminOption: \"allows to pin items for review\",\n        onUpdate: function (ui: JQuery, config: IContextPageConfigTab, context: IContextInformation) {\n            reviewContextFrame.onUpdate(ui, config, context);\n        }\n    });\n\n    plugins.register(reviewContextFrame);\n}\n","import { XCPostExecuteXtc } from \"../../RestCalls\"\nimport { IItemControlOptions, ItemControl, IUIMap, IProjectPanelControlOptions, SelectMode } from \"../UI/Components/index\"\nimport { IDB, DBCache } from \"./DBCache\"\nimport { XRFieldTypeAnnotated } from \"./ItemConfiguration\"\nimport { RestDB } from \"./RestDB\"\nimport { ml } from \"./../matrixlib\";\nimport { refLinkStyle, refLinkTooltip } from \"../UI/Parts/RefLinkDefines\"\nimport { ItemCreationTools } from \"../UI/Tools/ItemCreationView\"\nimport { ITestRule, ITestConfigTablesColumns } from \"../../ProjectSettings\"\nimport { XRGetProject_Needle_TrimNeedle, XRPostProject_ExecuteXtc_FolderAnswer } from \"../../RestResult\"\nimport { IItem, IReference, IGenericMap, matrixSession, app, INumberStringMap, globalMatrix, IControlDefinition, ControlState, restConnection } from \"../../globals\"\nimport {FieldDescriptions} from \"./FieldDescriptions\";\nimport { ITestStepsResultsConfig, ITestStepsResultOption, TestManagerConfiguration, ITestFieldParam } from \"./TestManagerConfiguration\";\n\nexport type {\n    ITestWizardParams, ITestWizardParamsPreset, IFieldMapping,\n    ITestStepsResult, ITestResultInfo, ITestRuleResult\n};\nexport {\n    TestManager, mTM\n};\nexport { InitializeTestManager };\n\ninterface ITestWizardParams {\n    single?:number,\n    input?:string[],\n    output?:string,\n    parentFolder?:string,\n    filter?:string[],\n    itemPresets?:ITestWizardParamsPreset[],\n    itemFieldMapping?:IFieldMapping[],\n    reason?:string\n\n}\ninterface ITestWizardParamsPreset {\n    field:number,\n    value:string\n}\ninterface IFieldMapping {\n    fromId:number,\n    toId:number\n}\ninterface ITestStepsResult {\n    result:string\n}\ninterface ITestResultInfo {\n    automatic:boolean,\n    label:string\n}\n\ninterface ITestRuleResult extends ITestRule {\n    result:string, // the actial result  coce\n}\n\n\nclass TestManager {\n    // configuration for per project\n    private testConfig: TestManagerConfiguration;\n\n    private lookup: IGenericMap;\n\n    public isDefault = true;\n\n    constructor() {\n        this.testConfig = new TestManagerConfiguration();\n    }\n\n    getConfiguration(): TestManagerConfiguration {\n        return this.testConfig;\n    }\n\n    public UpdateFolderMenu(ul: JQuery, item: IItem) {\n        let that = this;\n\n        if (!matrixSession.isEditor()) {\n            return;\n        }\n\n        if (!item || app.isFolder(item.id)) {\n            if (this.testConfig.XTCconfig && this.testConfig.XTCconfig.reExecute && this.isXTC(item.type)) {\n\n                var miReExecute = $('<li><a href=\"javascript:void(0)\" id=\"toolXtcRedo\">Redo failed tests</a></li>').click(function () {\n\n                    that.redoFailed(item);\n                }).appendTo(ul);\n\n            }\n            return;\n        }\n\n\n        if (this.testConfig.isCloneSource(item.type)) {\n            $('<li><a href=\"javascript:void(0)\" id=\"toolXtc\">Prepare for test run</a></li>').click(function () {\n                app.canNavigateAwayAsync().done(function () {\n                    that.ConvertAll(null, item.id);\n                }).fail(function () {\n                });\n            }).appendTo(ul);\n        }\n    }\n\n    public InitializeProject() {\n        this.testConfig.initialize(globalMatrix.ItemConfig);\n    }\n\n    // this function is executed before an executed test case is saved.\n    // it allows set the test result (\"test_result\" field) from test steps results\n    // in the test table (\"test_steps_result\" field) if it is set to automatic\n    public async PreSaveHook(isItem: boolean, item: IItem, type: string, controls: IControlDefinition[]) {\n        if (isItem && type === this.testConfig.XTCconfig.xtcType &&\n            this.testConfig.XTCconfig.automatic && this.testConfig.XTCconfig.automatic.length > 0) {\n            await this.computeOverallResult(controls);\n        }\n        this.createHumanValues(item, controls);\n    }\n\n    public RenderActionButtons(options: IItemControlOptions, body: JQuery) {\n        let that = this;\n\n        if (!this.isXTC(options.type)) {\n            return false;\n        }\n\n        if (!options.isItem && options.item && options.controlState === ControlState.FormEdit) {\n            // render controls for a folder\n\n            body.append($(\"<span class='baseControlHelp'>Tools</span>\"));\n            var folderEdit = $(\"<div class='hidden-print baseControl'></div>\");\n            body.append(folderEdit);\n            var createTools = new ItemCreationTools();\n            createTools.renderButtons({\n                parent: options.item.id,\n                dontOpenNewItem: false,\n                control: folderEdit,\n                linkTypes: [\n                    { type: options.item.type, name: \"Test Run Folder\", folder: true }]\n            });\n\n            var testCreateUI = $(\"<div  class='hidden-print'></div>\");\n            body.append(testCreateUI);\n            testCreateUI.append(\"<hr/>\");\n            testCreateUI.append('<span class=\"baseControlHelp\">Select Test and Use Cases to Run</span>');\n            testCreateUI.append(\"<br/>\");\n            testCreateUI.append(\"<br/>\");\n            var _createTestRun = $('<button class=\"buttonCreateSelect btn btn-success sel_create_TestForms\">Create <b>Test Forms</b></button>').click(\n                function () {\n                    that.ConvertAll(options.item.id);\n                });\n            testCreateUI.append(_createTestRun);\n        }\n\n        return true;\n    }\n\n\n    // **********************\n    // public functions\n    // **********************\n\n    // check if the category is an executed test case (usually this will mean category type XTC)\n    isXTC(type:string):boolean {\n        return this.testConfig.isXTC(type);\n    }\n\n    // check if this is a test case, use case, or something else which can be converted to a TC\n    isTC(type:string):boolean {\n        return this.testConfig.isTC(type);\n    }\n\n    // return the executed test case category type, (usually this will mean type XTC)\n    getXTCType() {\n        return this.testConfig.getXTCType();\n    }\n    // return a simple array of all categories which can be converted to XTC\n    getCloneSources( ) {\n        return this.testConfig.getCloneSources();\n    }\n\n    private redoFailed(folderItem: IItem) {\n        let that = this;\n        const fromFolder = folderItem.id;\n        // get all failed tests\n        app.getNeedlesAsync(that.testConfig.XTCconfig.reExecute, true,false,\"\",false).done( (needles) => {\n            let tcs:string[] = [];\n\n            // get all tests in selected folder\n            let xtcs = app.getChildrenIdsRec(fromFolder);\n\n            $.each( needles , function( idx, needle) {\n                // for all failed tests in selected folder\n                let xtcId = needle.id;\n                if (xtcs.indexOf( xtcId ) !=-1) {\n                    $.each(needle.upLinkList, function(uidx,ul) {\n                        // get all uplinks which are tests - if there are more than one only use the one in the title\n                        // this can happen if a TC includes others\n                        let ulItem = ml.Item.parseRef(ul.itemRef);\n                        if (that.testConfig.isCloneSource(ulItem.type) && (needle.upLinkList.length == 1 || needle.title.indexOf(\"(\" + ulItem.id + \")\") != -1) && tcs.indexOf(ulItem.id) == -1) {\n                            tcs.push(ulItem.id);\n                        }\n                    });\n                }\n            });\n\n            if (tcs.length == 0 ) {\n                ml.UI.showSuccess(\"All tests passed in this folder\");\n            } else {\n                that.ConvertAll(\"F-\" + folderItem.type + \"-1\", null, tcs);\n            }\n        }).fail(function () {\n        });\n    }\n    // target folder is a folder or an item (TC) which should be converted to XTC\n    // if sourceTC is set to a TC it is executed without letting the user choose a TC in the dialog and no parent folder is created\n\n    private ConvertAll(targetFolderId:string, sourceTC?:string, preselectTC?:string[]) {\n        let that = this;\n\n        let okButton:JQuery;\n        let exeParams:ITestWizardParams = {};\n        let tree:JQuery;\n        let wizardStep = 0;\n        let niceSize = ml.UI.getNiceDialogSize(730, 480);\n\n        // decide which fields to map from use cases and test cases to XTC\n        this.prepareMapping();\n\n        // prepare dialog (wizard step 1)\n        ml.Search.searchInDialog();\n\n        // reading values from step one and preparation of step 2\n        async function convertAllNext() {\n            // change wizard button, start phase 2\n\n            var hasUserChoice = false;\n            wizardStep++;\n            okButton.html('<span class=\"ui-button-text\">Finish</span>');\n\n            // prepare parameter\n            exeParams = {};\n\n            if (sourceTC) {\n                exeParams.single = 1;\n                exeParams.input = [sourceTC];\n                exeParams.output = that.testConfig.XTCconfig.xtcType;\n                exeParams.parentFolder = \"F-\" + that.testConfig.XTCconfig.xtcType + \"-1\"; // root folder of category\n            } else {\n                // get values step 1, clean ui\n                var newSelection = <IReference[]>await tree.getController().getValueAsync();\n                var ul = $(\"<ul>\");\n                var inputItems: string[] = [];\n                for (var idx = 0; idx < newSelection.length; idx++) {\n                    inputItems.push(newSelection[idx].to);\n                    let link = $(\"<div>\").refLink({\n                        folder: false,\n                        id: newSelection[idx].to,\n                        title: newSelection[idx].title,\n                        style: refLinkStyle.link,\n                        tooltip: refLinkTooltip.html,\n                        callback: function () {\n                        }\n                    });\n\n                    ul.append($(\"<li>\").append(link));\n                }\n                $(\".fancytree-icontext\", ul).remove();\n                exeParams.input = inputItems;\n                exeParams.output = that.testConfig.XTCconfig.xtcType;\n                exeParams.parentFolder = (preselectTC && preselectTC.length > 0) ? \"F-\" + that.testConfig.XTCconfig.xtcType + \"-1\" : targetFolderId;\n                tree.hide();\n            }\n\n            // prepare step 2 UI\n            app.dlgForm.addClass(\"dlg-v-scroll\").removeClass(\"dlg-no-scroll\");\n            var scrollPanel = $('<div class=\"layoutContainerScroll\"></div>');\n            app.dlgForm.append(scrollPanel);\n            // selected items\n            if (!sourceTC) {\n                let ulContainer = $('<div class=\"controlContainer\" ><span class=\"baseControlHelp\">Items to convert</span></div>');\n                ulContainer.append(ul);\n\n                scrollPanel.append(ulContainer);\n\n                // filter options\n                var relevant_labels = ml.LabelTools.getLabelDefinitions(that.testConfig.XTCconfig.cloneSources); // labels of UC, TC, ...\n\n                if (relevant_labels.length > 0) {\n                    hasUserChoice = true;\n                    // filtering execution by label\n                    var filters = ml.LabelTools.getFilter().split(\",\"); // currently selected filter\n                    exeParams.filter = [];\n                    let labelContainer = $('<div class=\"controlContainer\" ><span class=\"baseControlHelp\">Convert only items with all of these labels</span></div>');\n\n                    scrollPanel.append(labelContainer);\n                    var useFilters: IUIMap = {};\n                    $.each(relevant_labels, function (index, rl) {\n                        var set = filters.indexOf(rl.label) > -1;\n                        if (set) {\n                            exeParams.filter.push(rl.label);\n                        }\n                        var useFilter = $(\"<div>\");\n                        var name = rl.reportName;\n                        if (rl.style && rl.style.filter && rl.style.filter.on && rl.style.filter.on.displayName) {\n                            name = rl.style.filter.on.displayName;\n                        }\n                        useFilter.checkBox({\n                            controlState: ControlState.FormEdit,\n                            canEdit: true,\n                            fieldValue: set ? \"true\" : \"false\",\n                            help: name,\n                            valueChanged: async  () => {\n                                exeParams.filter = [];\n                                for(let ufid of Object.keys(useFilters)) {\n                                    let uf = useFilters[ufid];\n                                    if (await uf.getController().getValueAsync() === true) {\n                                        exeParams.filter.push(ufid);\n                                    }\n                                }\n                            }\n                        });\n\n                        // make list more compact, but skipping the last element\n                        if (index !== relevant_labels.length - 1) {\n                            useFilter.css(\"margin-bottom\", \"-8px\");\n                        }\n\n                        useFilters[rl.label] = useFilter;\n                        labelContainer.append(useFilter);\n                    });\n                }\n            }\n\n            var fieldList = globalMatrix.ItemConfig.getItemConfiguration(that.testConfig.XTCconfig.xtcType).fieldList;\n            // preset field options\n            exeParams.itemPresets = [];\n            var defaultTestResult = that.testConfig.XTCconfig.defaultTestResultResult ? that.testConfig.XTCconfig.defaultTestResultResult : \"\";\n            var testResultFieldId = 0;\n\n            for (var tfi = 0; tfi < fieldList.length; tfi++) {\n                if (fieldList[tfi].fieldType === FieldDescriptions.Field_test_result) {\n                    testResultFieldId = fieldList[tfi].id;\n                }\n            }\n            if (testResultFieldId && defaultTestResult) {\n                exeParams.itemPresets.push({field: testResultFieldId, value: defaultTestResult});\n            }\n\n            var presetFields: number[] = [];\n            if (that.testConfig.XTCconfig.presetFields) {\n\n                var inputCtrls = $(\"<div>\");\n                var ctrl: ItemControl;\n                ctrl = new ItemControl({\n                    control: inputCtrls,\n                    controlState: ControlState.DialogCreate,\n                    parent: \"\",\n                    type: that.testConfig.XTCconfig.xtcType,\n                    isItem: true,\n                    changed: async function () {\n                        if (ctrl) {\n                            var val = await ctrl.getValues({});\n                            // reset defaults\n                            exeParams.itemPresets = [];\n                            // set default result\n                            if (testResultFieldId && defaultTestResult) {\n                                exeParams.itemPresets.push({field: testResultFieldId, value: defaultTestResult});\n                            }\n                            // set defaults of entered values\n                            $.each(presetFields, function (pfidx, pf) {\n                                exeParams.itemPresets.push({field: pf, value: (<IGenericMap>val)[pf]});\n                            });\n                        }\n                    }\n                });\n                await ctrl.load();\n                scrollPanel.append(inputCtrls);\n                $(\".panel-body-v-scroll\", inputCtrls).removeClass(\"panel-body-v-scroll\");\n\n                // hide all ctrls by default\n                hasUserChoice = showOnlyWantedFields(ctrl, inputCtrls, fieldList, presetFields);\n            }\n            return hasUserChoice;\n        }\n\n        function showOnlyWantedFields(ctrl:ItemControl, inputCtrls:JQuery,fieldList:XRFieldTypeAnnotated[],presetFields:number[] ) {\n            let hasUserChoice = false;\n\n            $(\".itemTitleBarNoTools\", ctrl).hide();\n            $(\".baseControlHelp\", inputCtrls).parent().hide();\n\n            $.each( ctrl.getControls(), function( cidx,c) {\n                c.getController().disableDelayedShow = true;\n            });\n\n            $.each( fieldList, function(tfi, tf) {\n\n                $.each(that.testConfig.XTCconfig.presetFields, function (csi, preset) {\n                    var preset = that.testConfig.XTCconfig.presetFields[csi];\n\n                    if ((preset.field.toLowerCase() === \"name\" && tf.label.toLowerCase() === preset.value.toLowerCase()) ||\n                        (preset.field.toLowerCase() === \"meaning\" && tf.parameterJson && (<ITestFieldParam>tf.parameterJson).fieldMeaning && (<ITestFieldParam>tf.parameterJson).fieldMeaning.toLowerCase() === preset.value.toLowerCase())    ) {\n\n                        $.each($(\".baseControlHelp\", inputCtrls), function (bchidx, bch) {\n                            if ($(bch).html().toLowerCase() === tf.label.toLowerCase() ||\n                             (bch.firstChild && bch.firstChild.textContent && bch.firstChild.textContent.toLowerCase() == tf.label.toLowerCase()) ) {\n                                $(bch).parent().show();\n                                presetFields.push(tf.id);\n                                hasUserChoice = true;\n                            }\n                        });\n                    }\n                });\n            });\n            return hasUserChoice;\n        }\n        function convertFinish() {\n            exeParams.itemFieldMapping = that.getMappingItems();\n\n            matrixSession.getCommentAsync().done(function (comment) {\n                exeParams.reason = comment;\n\n                ml.UI.setEnabled($(\"button\", app.dlgForm.parent()), false);\n\n                restConnection.postProject(\"execute\", <XCPostExecuteXtc><any>exeParams, true).done(function (newXTC: XRPostProject_ExecuteXtc_FolderAnswer) {\n\n                    if (newXTC.xtcInError && newXTC.xtcInError.length > 0 ) {\n                        let issues = \"\";\n                        $.each( newXTC.xtcInError, function(eidx, err) {\n                            issues += `<b>${err.key}</b><br><ul style=\"text-align:left\">`;\n                            $.each(err.errors, function(edidx, errd) {\n                                issues += `<li>${errd}</li>`;\n                            });\n                            issues += \"</ul>\";\n                        });\n                        if ( newXTC.folder != \" -- \" ) ml.UI.showAck(-1, issues, \"Warning: issues during XTC generation\");\n                    }\n                    if ( newXTC.folder == \" -- \" ) {\n                        // after removing all the ugly things nothing left to create\n                        ml.UI.showError(\"No XTCs were created\", \"None of the selected tests had all the selected labels, therefore no XTCs have been created\");\n\n                        app.dlgForm.html(\"\");\n                        app.dlgForm.dialog(\"close\");\n                        return;\n                    }\n                    restConnection.getProject(\"tree?fancy\").done(async function (result: IDB[]) {\n                        var pdb = new DBCache();\n                        result = RestDB.filterLegacyReportCat(result);\n                        await pdb.initMatrixTree(result, false);\n                        if (exeParams.single) {\n                            // find new items in folder and copy them into F-XTC-1\n                            var current = app.getChildrenIds(newXTC.folder);\n                            var newItem = \"\";\n                            $.each(pdb.getChildrenIds(newXTC.folder), function (cidx, cid) {\n                                if (current.indexOf(cid) === -1) {\n                                    app.copyFrom(exeParams.parentFolder, pdb.getItemFromCache(cid));\n                                    newItem = cid;\n                                }\n                            });\n                            app.canNavigateAwayAsync().done(function () {\n                                app.treeSelectionChangeAsync(newItem);\n                            }).fail(function () {\n                            });\n                        } else {\n                            // copy the new tree in the folder\n                            var newFolder = pdb.getItemFromCache(newXTC.folder);\n                            // insert stuff in folder\n                            app.copyFrom(exeParams.parentFolder, newFolder);\n                            // show folder if you can navigate away...\n                            app.canNavigateAwayAsync().done(function () {\n                                app.treeSelectionChangeAsync(newXTC.folder);\n                            }).fail(function () {\n                            });\n                        }\n                    });\n                    ml.UI.showSuccess(\"Test \" + (sourceTC?\"form was\":\"forms were\") + \" generated\");\n\n                    ml.UI.setEnabled($(\"button\", app.dlgForm.parent()), true);\n                    app.dlgForm.html(\"\");\n                    app.dlgForm.dialog(\"close\");\n\n                }).fail(function (jqxhr, textStatus, error) {\n                    ml.UI.showError(\"Error\", \"Status:\" + textStatus + \"<br/>Error was:\" + error);\n                    ml.UI.setEnabled($(\"button\", app.dlgForm.parent()), true);\n                    app.dlgForm.html(\"\");\n                    app.dlgForm.dialog(\"close\");\n                });\n            });\n\n        }\n        // show dialog\n        function updateOkButton(enabled:boolean) {\n            if (okButton) {\n                okButton.prop(\"disabled\", !enabled);\n                if (enabled) {\n                    okButton.removeClass(\"ui-state-disabled\");\n                } else {\n                    okButton.addClass(\"ui-state-disabled\");\n                }\n            }\n        }\n\n\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-v-scroll\");\n        app.dlgForm.addClass(\"dlg-no-scroll\");\n\n\n        if ( !sourceTC ) {\n            let treeConfig = <IProjectPanelControlOptions>{\n                tree: app.getTree(this.testConfig.XTCconfig.cloneSources),\n                controlState: ControlState.DialogCreate,\n                canSelectItems: true,\n                selectMode: SelectMode.auto,\n                collectionChanged: function (count) {\n                    updateOkButton(count > 0);\n                }\n            };\n            if ( preselectTC) {\n                treeConfig.selectedItems = preselectTC.map( function(tc) {return {to:tc,title:\"\"}});\n            }\n            tree = $(\"<div style='display: flex;flex-direction: column;max-height: 100%;'>\").projectView(treeConfig);\n\n            app.dlgForm.append(tree);\n        }\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Create Test Form\" + (sourceTC?\"\":\"s\"),\n            height: niceSize.height\n            ,\n            width: niceSize.width,\n            modal: true,\n            close: function () {\n                app.dlgForm.parent().html('');\n                app.dlgForm.css('display', \"none\");\n                // dlg is gone, remove highlights and back to global highlighting\n                ml.Search.endSearchInDialog();\n            },\n            resizeStop: function () {\n                app.dlgForm.resizeDlgContent([tree]);\n            },\n            open: function () {\n                okButton = $(\".ui-dialog-buttonpane button:contains('Next')\", app.dlgForm.parent());\n\n                if (sourceTC) {\n                    // skip step 0;\n                    var hasUserInput = convertAllNext();\n                    updateOkButton(true);\n                    if ( !hasUserInput) {\n                        // no need to wait  / ask the user for more\n                        convertFinish();\n                    }\n                } else {\n                    // wait for user to select item (unless something was from pre-selection)\n                    updateOkButton(preselectTC && preselectTC.length > 0);\n                }\n            },\n            buttons: [{\n                text: 'Next',\n                class: 'btnDoIt',\n                click:function () {\n                    if (wizardStep === 0 ) {\n                        var hasUserInput = convertAllNext();\n                        updateOkButton(true);\n                        if ( !hasUserInput) {\n                            // no need to wait / ask the user for more\n                            convertFinish();\n                        }\n                     } else {\n                        convertFinish();\n                     }\n                 },\n             },{\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    matrixSession.stopCommitTransaction();\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent(tree?[tree]:[], false);\n\n    }\n\n    // get the configuration for a test definition table (e.g. test actions and expected results)\n    public getTestStepsConfig(category: string): ITestConfigTablesColumns {\n        return this.testConfig.getTestStepsConfig(category);\n    }\n\n    // get definition for a test execution table (e.g. including columns with results/comments)\n    public getTestStepsResultsConfig(): ITestStepsResultsConfig {\n        return this.testConfig.getTestStepsResultsConfig();\n    }\n\n    // returns possible values for the drop down of the completed test case\n    public getTestRunResultOptions(): ITestStepsResultOption[] {\n        return this.testConfig.getTestRunResultOptions();\n    }\n\n    // returns place holder text if no value is selected\n    public getTestRunResultPlaceholder(value: string): string {\n        return this.testConfig.getTestRunResultPlaceholder(value);\n    }\n\n    // creates a search expression needed to find XTCs with state new,progress,ok,error,warning\n    getSearchExpression(resultType:string, notEqual:boolean):string {\n        let fields = globalMatrix.ItemConfig.getFieldsOfType(\"test_result\");\n        let compare = notEqual?'!=':'=';\n\n        if (fields.length != 1) {\n            return \"\"; // there needs to be exactly one XTC type with on test result field\n        }\n        // test result field with quotes around\n        let fieldName = '\"' + fields[0].field.label + '\"';\n\n        // all searches are \"fieldname\"=\"expression\" or \"fieldname\"!=\"expression\" -> sb + expression + sa\n        let sb = fieldName + compare + '\"';\n        let sa = '\"';\n\n        let opts:string[] = [];\n        // collect different possible results\n\n        if (resultType == \"new\") {\n            opts.push(sb + this.testConfig.XTCconfig.defaultTestResultResult + sa);\n            opts.push( sb +  \"r\" + sa ); // r = special code: reset -> not executed not started\n\n        } else if (resultType == \"progress\") {\n            if (this.testConfig.XTCconfig.automatic.length) {\n                // by default the last means automatic  means, undecided = in progress\n                let autoProgress = this.testConfig.XTCconfig.automatic[this.testConfig.XTCconfig.automatic.length - 1];\n                opts.push(sb + autoProgress.code + \"|\" + autoProgress.render + \"|\" + autoProgress.human + sa);\n            }\n            opts.push( sb +  \"i\" + sa ); // i = special code: in progress\n        } else {\n            for (let result of this.testConfig.XTCconfig.automatic) {\n                if (result.render == resultType) {\n                    opts.push(sb + result.code + \"|\" + result.render + \"|\" + result.human + sa);\n                }\n            }\n            for (let result of this.testConfig.XTCconfig.manual) {\n                if (result.render == resultType) {\n                    opts.push(sb + result.code + sa);\n                }\n            }\n        }\n        // combine with and or or\n        return \" (\" + (notEqual?opts.join(\" and \"):opts.join(\" or \")) + \") \";\n\n    }\n    // **********************\n    // helper functions to convert test case to executed test cases\n    // this could happen on the server\n\n    // create an automatic mapping of properties to be copied\n    // the mapping is done\n    // - if the items fields have the same label (e.g. Description to Description)\n    // - from field_type \"test_steps\" to \"test_steps_result\"\n    // - NOT from JIRA and maybe other items\n\n    private prepareMapping():IGenericMap {\n\n        var fieldList = globalMatrix.ItemConfig.getItemConfiguration(this.testConfig.XTCconfig.xtcType).fieldList;\n        this.lookup = {};\n\n        for (var csi = 0; csi < this.testConfig.XTCconfig.cloneSources.length; csi++) {\n            var cs = globalMatrix.ItemConfig.getItemConfiguration(this.testConfig.XTCconfig.cloneSources[csi]).fieldList;\n            for (var csfi = 0; csfi < cs.length; csfi++) {\n                var csf = cs[csfi];\n                for (var tfi = 0; tfi < fieldList.length; tfi++) {\n                    var tf = fieldList[tfi];\n                    if (tf.label.toLowerCase() !== \"jira\") {\n                        if ((tf.fieldType === FieldDescriptions.Field_test_steps_result && csf.fieldType === FieldDescriptions.Field_test_steps) ||\n                                (tf.label === csf.label)) {\n                            this.lookup[csf.id] = tf.id;\n                        }\n                    }\n                }\n            }\n        }\n        return this.lookup;\n    }\n    public getMappingItems():IFieldMapping[] {\n        this.prepareMapping();\n        var mapping:IFieldMapping[] = [];\n        $.each( this.lookup, function (lidx,l){\n            if (l) {\n                mapping.push({fromId:lidx, toId:l});\n            }\n        });\n        return mapping ;\n    }\n\n    // **********************\n    // helper functions to compute the values of the overall \"test_result\" field from\n    // in the test table (\"test_steps_result\" field)\n    // **********************\n\n    private getResultInfo(val:string):ITestResultInfo {\n        if (val === \"a\") {\n            return {automatic: true, label: \"automatic\"}; // automatic never changed\n        }\n        for (var idx = 0; idx < this.testConfig.XTCconfig.automatic.length; idx++) {\n            if (this.testConfig.XTCconfig.automatic[idx].code === val) {\n                return { automatic: true, label: this.testConfig.XTCconfig.automatic[idx].human };\n            }\n        }\n        for (var idx = 0; idx < this.testConfig.XTCconfig.manual.length; idx++) {\n            if (this.testConfig.XTCconfig.manual[idx].code === val) {\n                return { automatic: false, label: this.testConfig.XTCconfig.manual[idx].human };\n            }\n        }\n        return {automatic: false, label: \"please select result\"};\n    }\n    private async allTestSteps(controls: IControlDefinition[], code: string) {\n        for (var idx = 0; idx < controls.length; idx++) {\n            if (controls[idx].fieldType === FieldDescriptions.Field_test_steps_result) {\n                var val = await (controls[idx].control as any).getController().getValueAsync();\n                var v: ITestStepsResult[] = JSON.parse(val);\n                for (var step = 0; step < v.length; step++) {\n                    if (v[step].result !== code) {\n                        return false;\n                    }\n                }\n            }\n        }\n        return true;\n    }\n    private async oneTestStep(controls: IControlDefinition[], code: string) {\n        for (var idx = 0; idx < controls.length; idx++) {\n            if (controls[idx].fieldType === FieldDescriptions.Field_test_steps_result) {\n                var val = await (controls[idx].control as any).getController().getValueAsync();\n                var v: ITestStepsResult[] = JSON.parse(val);\n                for (var step = 0; step < v.length; step++) {\n                    if (v[step].result === code) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n\n    private async computeOverallResult(controls: IControlDefinition[]) {\n        // this should only happen if the value is not set to a manual\n        for (var cidx = 0; cidx < controls.length; cidx++) {\n            if (controls[cidx].fieldType === FieldDescriptions.Field_test_result) {\n                var resultInfo = this.getResultInfo((<any>controls[cidx].control).getController().getValueRaw());\n                if (resultInfo.automatic) {\n                    // apply rules to find a value\n                    for (var r = 0; r < this.testConfig.XTCconfig.automatic.length; r++) {\n                        var rule = this.testConfig.XTCconfig.automatic[r];\n                        // rule: {human:\"not started\", code:\"an\", render:\"warning\", rule:\"all\", param:\"\"},\n                        // no specifc rule... default\n                        if (rule.rule === \"\") {\n                            (<any>controls[cidx].control).getController().setValue(rule.code, true);\n                            return;\n                        }\n                        // all: check if it applies: all elements need to be set to a value\n                        if (rule.rule === \"all\" && await this.allTestSteps(controls, rule.param)) {\n                            (<any>controls[cidx].control).getController().setValue(rule.code, true);\n                            return;\n                        }\n                        // one: check if it applies: at least one need to be set to a value\n                        if (rule.rule === \"one\" && await this.oneTestStep(controls, rule.param)) {\n                            (<any>controls[cidx].control).getController().setValue(rule.code, true);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    // create for each test step a column human which has the test result as human readable string\n    private async createHumanValues(item: IItem, controls: IControlDefinition[]) {\n        for (var ci = 0; ci < controls.length; ci++) {\n            if (controls[ci].fieldType === FieldDescriptions.Field_test_steps_result) {\n                var val = await (<any>controls[ci].control).getController().getValueAsync();\n                var tsr: ITestRuleResult[] = JSON.parse(val);\n                for (var step = 0; step < tsr.length; step++) {\n                    for (var idx = 0; idx < this.testConfig.XTCconfig.perStep.length; idx++) {\n                        if (this.testConfig.XTCconfig.perStep[idx].code === tsr[step].result) {\n                            tsr[step].human = this.testConfig.XTCconfig.perStep[idx].human;\n                            tsr[step].render = this.testConfig.XTCconfig.perStep[idx].render;\n                        }\n                    }\n                }\n                (<any>controls[ci].control).getController().setValue(JSON.stringify(tsr));\n            } else if (controls[ci].fieldType === FieldDescriptions.Field_test_result) {\n                var tr: string = (<any> await controls[ci].control).getController().getValueAsync();\n                for (var idx = 0; idx < this.testConfig.XTCconfig.automatic.length; idx++) {\n                    if (this.testConfig.XTCconfig.automatic[idx].code === tr) {\n                        (<any>controls[ci].control).getController().setValue(tr + \"|\" + this.testConfig.XTCconfig.automatic[idx].render + \"|\" + this.testConfig.XTCconfig.automatic[idx].human, true);\n                    }\n                }\n                for (var idx = 0; idx < this.testConfig.XTCconfig.manual.length; idx++) {\n                    if (this.testConfig.XTCconfig.manual[idx].code === tr) {\n                        (<any>controls[ci].control).getController().setValue(tr + \"|\" + this.testConfig.XTCconfig.manual[idx].render + \"|\" + this.testConfig.XTCconfig.manual[idx].human);\n                    }\n                }\n\n            } else if (this.testConfig.XTCconfig.autoFillTester && controls[ci].fieldType === FieldDescriptions.Field_user) {\n                // set the test to the first user saving it\n                let tester: string = await (<any>controls[ci].control).getController().getValueAsync();\n                let config = globalMatrix.ItemConfig.getFieldById(\"XTC\", controls[ci].fieldId);\n                if (config && config.parameterJson && config.parameterJson.fieldMeaning == \"tester\") {\n\n                    if ((this.testConfig.XTCconfig.autoFillTester == \"first\" && item.history.length == 1 &&  // first version\n                        (tester == (<INumberStringMap>item)[config.id] || //  and the field is still the preset (from the creation)\n                            !tester) // or the field is still empty\n                    ) || this.testConfig.XTCconfig.autoFillTester == \"last\") { // last\n                        controls[ci].control.getController().setValue(matrixSession.getUser());\n                    }\n                }\n            }\n        }\n    }\n}\n\nvar mTM: TestManager;\n\nfunction InitializeTestManager() {\n    mTM = new TestManager();\n}\n","import { ITestConfig, ITestConfigTablesColumn, ITestConfigTablesColumns, ITestRuleStep } from \"../../ProjectSettings\";\nimport { ItemConfiguration, XRFieldTypeAnnotatedParamJson } from \"./ItemConfiguration\";\n\nexport type { ITestFieldParam, ITestStepsResultOption, ITestConfig15, ITestStepsResultsConfig };\nexport { TestManagerConfiguration };\n\ninterface ITestFieldParam extends XRFieldTypeAnnotatedParamJson {\n    fieldMeaning: string\n}\ninterface ITestStepsResultOption {\n    id: string,\n    label: string\n}\n\ninterface ITestConfig15 {\n    columnsStepsResult: ITestConfigTablesColumn[],\n    columnsSteps: ITestConfigTablesColumn[]\n}\n\ninterface ITestStepsResultsConfig {\n    canBeModified: boolean,\n    columns: ITestConfigTablesColumn[],\n    passFailEditorConfig: ITestRuleStep[]\n}\n\nclass TestManagerConfiguration {\n    // configuration for per project\n    public XTCconfig: ITestConfig;\n\n    constructor() {\n        this.XTCconfig = <ITestConfig><any>{};\n    }\n\n    initialize(itemConfig: ItemConfiguration) {\n        this.XTCconfig = itemConfig.getTestConfig();\n\n        if (!this.XTCconfig) {\n            // default until 1.3\n            this.XTCconfig = <any>{\n                \"xtcType\": \"XTC\",\n                \"cloneSources\": [\"TC\", \"UC\"],\n                \"columnsSteps\": [{ \"name\": \"Action\", \"field\": \"action\", \"editor\": \"text\" },\n                { \"name\": \"Expected Result\", \"field\": \"expected\", \"editor\": \"text\" }],\n                \"columnsStepsResult\": [{ \"name\": \"Action\", \"field\": \"action\", \"editor\": \"none\" },\n                { \"name\": \"Expected Result\", \"field\": \"expected\", \"editor\": \"none\" },\n                { \"name\": \"Passed/Failed\", \"field\": \"result\", \"editor\": \"result\" },\n                { \"name\": \"Comment\", \"field\": \"comment\", \"editor\": \"text\" }],\n                \"automatic\": [],\n                \"manual\": [\n                    { \"human\": \"passed\", \"command\": \"passed\", \"render\": \"ok\", \"code\": \"p\" },\n                    { \"human\": \"failed\", \"command\": \"failed\", \"render\": \"error\", \"code\": \"f\" },\n                    { \"human\": \"\", \"command\": \"not executed\", \"render\": \"warning\", \"code\": \"\" }\n                ],\n                \"perStep\": [\n                    { \"human\": \"passed\", \"command\": \"passed\", \"render\": \"ok\", \"code\": \"p\", \"key\": \"p\", \"image\": \"success.png\" },\n                    { \"human\": \"failed\", \"command\": \"failed\", \"render\": \"error\", \"code\": \"f\", \"key\": \"f\", \"image\": \"fail.png\" },\n                    { \"human\": \"\", \"command\": \"not executed\", \"render\": \"warning\", \"code\": \"\", \"key\": \"r\", \"image\": \"\" }\n                ]\n            };\n        }\n    }\n\n    // returns possible values for the drop down of the completed test case\n    public getTestRunResultOptions(): ITestStepsResultOption[] {\n\n        var opts: ITestStepsResultOption[] = [];\n        if (this.XTCconfig.automatic && this.XTCconfig.automatic.length > 0) {\n            opts.push({ id: \"a\", label: \"automatic\" });\n        }\n        for (var idx = 0; idx < this.XTCconfig.manual.length; idx++) {\n            opts.push({ id: this.XTCconfig.manual[idx].code, label: this.XTCconfig.manual[idx].command });\n        }\n        return opts;\n    }\n\n    // get the configuration for a test definition table (e.g. test actions and expected results)\n    public getTestStepsConfig(category: string): ITestConfigTablesColumns {\n        if (this.XTCconfig.render && this.XTCconfig.render[category]) {\n            return this.XTCconfig.render[category];\n        }\n        // this is actually a fallback for project created with version 1.5 or before\n        // these project can be upgraded by just replacing the xtc_config with the latest version\n        // UNLESS column names have been changed (which never happend)....\n        return {\n            columns: (category === this.XTCconfig.xtcType) ? (<ITestConfig15><any>this.XTCconfig).columnsStepsResult : (<ITestConfig15><any>this.XTCconfig).columnsSteps\n        };\n    }\n\n    // get definition for a test execution table (e.g. including columns with results/comments)\n    public getTestStepsResultsConfig(): ITestStepsResultsConfig {\n\n        return {\n            canBeModified: false,\n            columns: this.getTestStepsConfig(this.XTCconfig.xtcType).columns,\n            passFailEditorConfig: this.XTCconfig.perStep\n        };\n    }\n\n    // check if the category is an executed test case (usually this will mean category type XTC)\n    isXTC(type: string): boolean {\n        return this.XTCconfig.xtcType && this.XTCconfig.xtcType.toLowerCase() === type.toLowerCase();\n    }\n\n    // check if this is a test case, use case, or something else which can be converted to a TC\n    isTC(type: string): boolean {\n        return this.isCloneSource(type);\n    }\n\n    // return the executed test case category type, (usually this will mean type XTC)\n    getXTCType() {\n        return this.XTCconfig.xtcType;\n    }\n    // return a simple array of all categories which can be converted to XTC\n    getCloneSources() {\n        return this.XTCconfig.cloneSources;\n    }\n\n    // returns place holder text if no value is selected\n    public getTestRunResultPlaceholder(value: string): string {\n\n        var code = value ? (value.split(\"|\")[0]) : \"\";\n        if (this.XTCconfig.automatic && this.XTCconfig.automatic.length > 0) {\n            for (var idx = 0; idx < this.XTCconfig.automatic.length; idx++) {\n                if (this.XTCconfig.automatic[idx].code === code) {\n                    return \"automatic - was '\" + this.XTCconfig.automatic[idx].human + \"' when last saved\";\n                }\n            }\n        }\n        return \"select test result\";\n    }\n\n\n    public isCloneSource(category: string): boolean {\n        if (!this.XTCconfig.cloneSources) {\n            return false;\n        }\n        for (var csi = 0; csi < this.XTCconfig.cloneSources.length; csi++) {\n            if (this.XTCconfig.cloneSources[csi] === category) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n","import { app, globalMatrix, matrixSession } from \"../../../globals\";\nimport { IPrintCustomFormatter, IPrintFormatterTop, IPrintFormatter } from \"../../../printinterface/PrintFormatter\";\nimport { IPrintBaseFunction } from \"../../../printinterface/PrintFunction\";\nimport { ICustomSection, globalPrintConfig } from \"../../../printinterface/PrintProcessorInterfaces\";\nimport { XRPostProject_LaunchReport_CreateReportJobAck, XRGetProject_JobStatus_JobsStatusWithUrl } from \"../../../RestResult\";\nimport { ml } from \"../../matrixlib\";\nimport { IReportOptions, UIToolsConstants } from \"../../matrixlib/MatrixLibInterfaces\";\nimport { JsonEditor } from \"../JsonEditor\";\nimport {ICustomSectionOptions} from \"../../businesslogic/FieldHandlers/Document/CustomDocFieldHandler\";\n\nexport { Layouter };\n\nclass Layouter {\n\n    private itemId:string;\n    private mf:JQuery;\n    private sectionConfig:ICustomSection;\n    private fromSelection:string;\n    private toSelection:string;\n    private isLandScape:boolean;\n    private displayStyle:{width:string};\n\n    constructor( ) {\n\n    }\n\n    // show editor dialog\n\n    show( itemId:string, fieldId:number, sectionConfig:ICustomSectionOptions, fromSelection:string, toSelection:string, labelFilter:string, onUpdate: ( code:string ) => void, previewOnly = false, previewDiv?:JQuery ) {\n        let that = this;\n        this.itemId = itemId;\n        this.sectionConfig = (sectionConfig && sectionConfig.options)?sectionConfig.options:<ICustomSection>{};\n        // TODO(modules): property landscape not found on ICustomSectionOptions.\n        this.isLandScape = sectionConfig && sectionConfig.landscape;\n\n        this.toSelection = toSelection;\n        this.fromSelection = fromSelection;\n\n        let ui = $(\"<div style='width:100%'>\");\n        ui.append(ml.UI.getSpinningWait(\"retrieving data...\"));\n\n        //MATRIX-6029: Hack to call a specific report for print with only 1 level of downlinks. For that we need to specify the reportNameOverride in the reportOptions\n        let reportOptions:IReportOptions = { format: \"mf\", reportNameOverride:\"dhf_generic_print\"};\n        if (labelFilter && labelFilter.length > 0) {\n            reportOptions.filter = JSON.parse(labelFilter).join(\",\");\n        }\n        let start1 = new Date().getTime();\n        app.startCreateDocumentAsync(this.itemId, reportOptions).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n            that.waitForJob(result.jobId).done( function( iXML:number ) { // , oXML:number) {\n                let start2 = new Date().getTime();\n                console.log( \"time to create filter[s]: \" + (start2-start1)/1000 );\n                app.downloadInMemory(result.jobId, iXML.toString(), \"text\").done(function (iDown: string) {\n                    let start3 = new Date().getTime();\n                    console.log( \"time to download filter[s]: \" + (start3-start2)/1000 );\n                    that.mf = <any>$.parseXML(iDown);\n                    let start4 = new Date().getTime();\n                    console.log( \"time to create dom[s]: \" + (start4-start3)/1000 );\n                    app.readSettingCustomerJSONAsync(\"PrintProcessor\").done(function (formatters: IPrintCustomFormatter) {\n                        if( ! previewOnly)\n                            that.initEditor(formatters, ui);\n                        else\n                            that.displayPreview(previewDiv);\n                    });\n                });\n            });\n        });\n        // show dialog\n        if( !previewOnly)\n        {\n            let dlg = $(\"<div class=''>\").appendTo($(\"body\"));\n            ml.UI.showDialog(dlg, \"Section Layout\", ui, $(document).width() * 0.9, app.itemForm.height() * 0.9, [{\n                    text: 'Save',\n                    class: 'btnDoIt',\n                    click: function () {\n                        onUpdate( JSON.stringify(that.sectionConfig) );\n                        $(\"#layoutR\").html(\"\");\n                        dlg.dialog(\"close\");\n                    }\n                },{\n                    text: 'Cancel',\n                    class: 'btnCancelIt',\n                    click: function () {\n                        $(\"#layoutR\").html(\"\");\n                        dlg.dialog(\"close\");\n                    }\n                }], UIToolsConstants.Scroll.None, true, true, () => { dlg.remove(); }, () => { }, () => {\n                    $(\"#layoutR\").height( dlg.height() );\n                    dlg.resizeDlgContent([]);}\n                );\n        }\n    }\n\n    // show the layout editor\n    private initEditor(formatters:IPrintCustomFormatter, ui:JQuery) {\n\n\n        var sidebar = localStorage.getItem('layout_sidebar');\n        if (!sidebar) {\n            sidebar = '200px';\n        }\n\n        let layoutC = $(`<div id=\"layoutC\" style=\"overflow:auto;width:${sidebar};padding-right:12px;float:left;height: 100%;margin-right: 6px;\">`);\n        let dragbar = $(`<div style=\"background-color:var(--Grey6);height: 100%;float:left;width: 5px;cursor: col-resize;\">`);\n        let layoutR = $(`<div id=\"layoutR\" style=\"overflow:auto;padding-left:12px;height: 100%;\">`);\n\n        ui.html(\"\").append(layoutC).append(dragbar).append(layoutR).css(\"height\", \"100%\");\n\n        const leftContainer = $(`<div class=\"layouter-left-container\">`).appendTo(layoutC);\n\n        // dropdown  to select width\n        this.displayStyle = { width:this.isLandScape?\"26.7cm\":\"18cm\" };\n        ml.UI.addDropdownToValue( leftContainer, \"page size & orientation (preview)\", this.displayStyle, \"width\", [\n            {id:\"18cm\", label:\"Portrait (A4)\"},\n            {id:\"18.6cm\", label:\"Portrait (Letter)\"},\n            {id:\"26.6cm\", label:\"Portrait (A3)\"},\n            {id:\"26.7cm\", label:\"Landscape (A4)\"},\n            {id:\"24.9cm\", label:\"Landscape (Letter)\"},\n            {id:\"39cm\", label:\"Landscape (A3)\"},\n            {id:\"100%\", label:\"Full width\"},\n            {id:\"EXCEL\", label:\"Excel (Plaintext)\"}\n        ], false, false, () => this.displayPreview(), null, { width:\"100%\"});\n\n        const textOptionDiv = $(\"<div style='margin: -12px 0 0 -12px;'>\").appendTo(leftContainer);\n        $(\"<button class='btn btn-link'>Set introductory text</button>\").click( () => this.introOptions()).appendTo( textOptionDiv );\n        $(\"<button class='btn btn-link'>Set advanced options</button>\").click( () => this.advancedOptions()).appendTo( textOptionDiv );\n\n        let filter = $('<input type=\"text\" style=\"margin-bottom:10px;padding: 6px 12px;\" placeholder=\"filter...\" class=\"form-control\">').on(\"keyup\", function (e) {\n            let filterVal = filter.val().toLowerCase();\n            $(\".formatter-item\").each( (idx, fi) => {\n                (filterVal && $(fi).text().toLowerCase().indexOf(filterVal)==-1)?$(fi).hide():$(fi).show();\n            });\n        }).appendTo(leftContainer);\n\n        this.formatterList(formatters).appendTo(leftContainer);\n\n        dragbar.mousedown(function (e) {\n            if (e.preventDefault)\n                e.preventDefault();\n            $(document).mousemove(function (e) {\n                let maxWidth = ui.width() - 100;\n                let mousePos = e.pageX - layoutC.offset().left; // mousepos relative to left border of layoutC\n                if (mousePos > 100 && mousePos < maxWidth) {\n                    localStorage.setItem('layout_sidebar', (mousePos - 15) + \"px\");\n                    layoutC.width(mousePos - 15 );\n                }\n            });\n        });\n\n        if (!this.sectionConfig.formatter || this.sectionConfig.formatter.trim() == \"\" || !formatters.items[this.sectionConfig.formatter]) {\n\n            layoutR.append(`<div style=\"padding: 16px;\"><em>Please choose a layout!</em></div>`);\n        } else {\n            this.displayPreview();\n        }\n    }\n\n    private formatterList(formatters: IPrintCustomFormatter):JQuery {\n        const createFormatter = (formatter:IPrintFormatterTop) => {\n            const selected = this.sectionConfig.formatter === formatter.uid ? \"selected\" : \"\";\n            const id = `formatter-item-${formatter.uid}`;\n            let help = formatter.help;\n            if (help == null || help.trim() == \"\") {\n               help = \"<i>No description provided</i>\";\n            }\n            return $(`<div class=\"formatter-item ${selected}\" id=\"${id}\" title=\"${formatter.path?formatter.path:\"\"}\"><div class=\"formatter-title\"><span class=\"formatter-id\">${formatter.uid}</span> ${formatter.name}</div><div class=\"formatter-help\">${help}</div></div>`)\n                .click(() => {\n                    this.sectionConfig.formatter = formatter.uid;\n                    this.displayPreview();\n                    $(\".formatter-item.selected\").removeClass(\"selected\");\n                    $(\"#\"+id).addClass(\"selected\");\n                });\n        }\n        const sectionTitle = (title:string) => {\n            return $(`<div class=\"list-section-title\">${title}</div>`);\n        }\n\n        const formatterList = $(`<div class=\"formatter-list\">`);\n        const scroller = () => {\n            const id = `#formatter-item-${this.sectionConfig.formatter}`;\n            const offsetElement = $(id);\n            if (offsetElement.length > 0) {\n                const me = offsetElement[0];\n                const myOffset = me.offsetTop;\n                const parentOffset = me.parentElement.offsetTop;\n                formatterList.scrollTop(myOffset - parentOffset);\n            }\n        };\n\n        sectionTitle(\"Lists\").appendTo(formatterList);\n        const topLevelLists = Layouter.filterTopLevelFormatters(formatters.items, \"SEQUENTIAL\");\n        const topLevelTables = Layouter.filterTopLevelFormatters(formatters.items, \"TABLE\");\n        Object.keys(topLevelLists).sort(Layouter.sortItems).forEach(id => {\n            const formatter = <IPrintFormatterTop><unknown>formatters.items[id];\n            createFormatter(formatter).appendTo(formatterList);\n        });\n        sectionTitle(\"Tables\").appendTo(formatterList);\n        Object.keys(topLevelTables).sort(Layouter.sortItems).forEach(id => {\n            const formatter = <IPrintFormatterTop><unknown>formatters.items[id];\n            createFormatter(formatter).appendTo(formatterList);\n        });\n        window.setTimeout(scroller, 100);\n        return formatterList;\n    }\n\n    private displayPreview(previewDiv?:JQuery) {\n       let width = \"100%\";\n        if( previewDiv == null){\n            previewDiv = $(\"#layoutR\") ;\n            width = this.displayStyle.width;\n        }\n        Layouter.convert( this.sectionConfig, this.fromSelection, this.toSelection, width, this.mf,previewDiv );\n    }\n\n    private introOptions() {\n        const dlg = $(\"<div>\").appendTo($(\"body\"));\n        const ui = $(\"<div style='height:100%;width:100%'>\");\n        ml.UI.addRichTextInput( ui, {width:\"100%\"}, \"intro\",\n            this.sectionConfig, \"description\",\n            () => {}, () => {} );\n        ml.UI.addRichTextInput( ui, {width:\"100%\"}, \"intro only if there are items selected\",\n            this.sectionConfig, \"descriptionContent\",\n            () => {}, () => {} );\n        ml.UI.addRichTextInput( ui, {width:\"100%\"}, \"intro if there are no items selected\",\n            this.sectionConfig, \"descriptionNoContent\",\n            () => {}, () => {} );\n        ml.UI.showDialog(dlg, \"Set introductory text\", ui,\n            $(document).width() * 0.90, app.itemForm.height() * 0.90,\n            [{\n                text: \"Close\",\n                \"class\": \"btnDoIt\",\n                click: () => {\n                    dlg.dialog(\"close\");\n                }\n            }],\n            UIToolsConstants.Scroll.Vertical, true, true, () => { dlg.remove(); this.displayPreview() });\n    }\n\n    private advancedOptions() {\n        let current = this.sectionConfig.functionDefaults?this.sectionConfig.functionDefaults:{};\n        let je = new JsonEditor();\n        let apiHelp =\n\n`<h1>Section options</h1>\n<p>The content is rendered using functions specified in the PRINT project. Each function has some parameters with some default values.</p>\n<p>The default parameters of functions can be overwritten globally (for all projects), in the PRINT project itself, for the project itself or for each section</p>\n<p>These are the section settings with the following syntax</p>\n<pre>\n{\n    \"debug\":number // default:0. if set to 1 or more some debugging information is printed.\n    \"FUNCTION_1_ID\": { // the id of the function (see below a list of all functions)\n        \"FUNCTION_PARAM_1\":value1 // the name of a parameter and it's value\n        \"FUNCTION_PARAM_2\":value2\n        ...\n    },\n    \"FUNCTION_2_ID\": {\n        ...\n    }\n}\n</pre>\n<p>The following functions exist:</p>`;\n\n        $.each( globalPrintConfig.getAllFunctions(), function(uid:string, fct:IPrintBaseFunction) {\n            apiHelp += fct.getHelp(true).replace(\"<pre>\", `<pre>\"${uid}\":{` ).replace(\"</pre>\",\"}</pre>\");\n        });\n\n        let currentCode = ml.JSON.unEscapeJson ( JSON.stringify(current));\n        je.showDialog(\"Advanced Options\", currentCode, (newValue:string) => {\n            this.sectionConfig.functionDefaults = JSON.parse(ml.JSON.escapeJson(newValue));\n            this.displayPreview();\n        }, {apiHelp:apiHelp});\n    }\n\n    private static sortItems(a:string,b:string) : number {\n        const aRef = ml.Item.parseRef(a);\n        const bRef = ml.Item.parseRef(b);\n        return aRef.number - bRef.number;\n    }\n\n    private static filterTopLevelFormatters(formatters:{[key:string]:IPrintFormatter}, category:string) : {[key:string]:IPrintFormatterTop} {\n        const result:{[key:string]:IPrintFormatterTop} = {}\n        Object.keys(formatters).forEach(key => {\n            if ( key.indexOf(category + \"-\")==0 && !(<IPrintFormatterTop><unknown>formatters[key]).deleted && (<IPrintFormatterTop><unknown>formatters[key]).topLevelTemplate ) {\n                result[key] = <IPrintFormatterTop>formatters[key]\n            }\n        })\n        return result\n    }\n\n    // wait until a document has been created\n    private waitForJob(jobId: number) {\n        let that = this;\n        let res=$.Deferred();\n        app.getReportDetails(jobId).done(function (progress: XRGetProject_JobStatus_JobsStatusWithUrl) {\n\n            if (progress.status === \"Error\" || progress.status.indexOf(\"Report generation error\") === 0) {\n                ml.UI.showError(\"Error creating document\", \"\");\n            }\n            else if (progress.status !== \"Done\" || progress.progress < 100) {\n                window.setTimeout(function () {\n                    that.waitForJob( jobId ).done( function( iXML, oXML) {\n                        res.resolve(iXML,oXML);\n                    });\n                }, 500);\n            } else {\n                let filters = progress.jobFile.filter( jobFile => jobFile.visibleName == \"filter.xml\");\n                // let mos = progress.jobFile.filter( (jobFile) => { return jobFile.visibleName != \"filter.xml\" && jobFile.mimeType == \"text/xml\"});\n\n                res.resolve(filters[0].jobFileId); //, mos[0].jobFileId);\n            }\n        });\n        return res;\n    }\n\n    static  convert(customSectionConfig:ICustomSection, customSectionFroms:string, customSectionTo:string, paperWidth:string, mf:JQuery, container:JQuery ) {\n        let pp = globalPrintConfig.getPrintProcessor();\n        var format = \"html\";\n        if (paperWidth === \"EXCEL\") {\n            format = \"xlsx\";\n        }\n        let startPrepare = new Date().getTime();\n        pp.prepareProcessing( mf, (message) => {\n            ml.UI.showError(\"processing error\", message);\n        }, format);\n        let timer = new Date().getTime()-startPrepare;\n        console.log(\"report preparation time [s]:\" + timer/1000);\n\n        container.html(\"\").append(ml.UI.getSpinningWait(\"creating preview...\"));\n\n        app.readSettingCustomerJSONAsync(\"PrintProcessor\").done(async function  (formatters: IPrintCustomFormatter) {\n            // put newest into cache\n            matrixSession.setCustomerSettingJSON(\"PrintProcessor\", formatters);\n\n            let projectSettings = globalMatrix.ItemConfig.getDHFConfig();\n            let projectFunctionDefaults = projectSettings && projectSettings.functionDefaults?projectSettings.functionDefaults:{debug:0};\n\n            let startDate = new Date().getTime();\n            let rendered = await pp.processSection( formatters, customSectionConfig, projectFunctionDefaults, customSectionFroms?customSectionFroms.split(\",\"):[],customSectionTo?customSectionTo.split(\",\"):[]);\n            let timer = new Date().getTime()-startDate;\n            console.log(\"report generation time [s]:\" + timer/1000);\n            console.log(pp.globals.count);\n            let iframe = $(`<iframe frameborder='0' style='width:${paperWidth}'>`);\n            container.html(\"\");\n\n            container.append(iframe);\n            let doc = ( (<any>iframe[0]).contentWindow || (<any>iframe[0]).contentDocument).document;\n            const ppStylingKey = \"new_element_custom_style\";\n            let ppStyling:string = \"\";\n            if (globalMatrix.ItemConfig.getSetting(ppStylingKey)) {\n                ppStyling += globalMatrix.ItemConfig.getSetting(ppStylingKey) + \"\\n\";\n            }\n            ppStyling += pp.getCustomStylesheet();\n            doc.write(`<!doctype html>\n            <html>\n                <head>\n                <link href=\"/static/css/print.css\" rel=\"stylesheet\" type=\"text/css\" />\n                <link href=\"/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n                <style>\n                    ${ppStyling}\n                </style>\n                </head>\n                <body>\n                    ${rendered.html}\n                </body>\n            </html>`);\n            doc.close();\n            $(\"a\", doc.body).attr(\"target\",\"_blank\");\n\n            iframe.width( paperWidth==\"100%\"?( (<any>iframe[0]).contentWindow.document.body.scrollWidth - 10 ):iframe.width()+50);\n            iframe.height((<any>iframe[0]).contentWindow.document.body.scrollHeight + 50);\n            window.setTimeout( () => {\n                iframe.height((<any>iframe[0]).contentWindow.document.body.scrollHeight + 50);\n            },1);\n        });\n    }\n\n\n\n}\n\n\n","import { IStringJQueryMap, IStringStringArrayMap, IStringMap } from \"../globals\"\nimport { IDropdownOption, IRiskConfig } from \"../ProjectSettings\"\nimport { IPrintCustomFormatter } from \"./PrintFormatter\"\nimport { IPrintFunctionParamsOverwrites, IPrintBaseFunctionMap } from \"./PrintFunction\"\nimport { IPrintFieldInfo } from \"./PrintIterators\"\nimport { IPrintSorterMap } from \"./PrintSorter\"\n\nexport type {\n    ICustomSection, IPrintProcessorOptions, IProcessResult, IPrintProcessor,\n    IPrintConfig, IStringRiskConfigMap, IFieldCache,\n    IPrintGlobals\n};\n\nexport {\n    PrintFindAllScriptsRegex, globalPrintConfig, setGlobalPrintConfig\n};\n\n/************************************** Main section definition  ********************************************/\ninterface ICustomSection {\n    //title: string // the section title\n    //depth?: number // optional heading depth for title, default is <H1>\n    description?: string // a rich text description\n    descriptionContent?: string // a rich text description if there are kids\n    descriptionNoContent?: string // a rich text description if there are no kids\n    formatter:string // either a list or table formatter id\n    functionDefaults?:IPrintFunctionParamsOverwrites // possible to overwrite defaults for functions\n}\n\n// saved in customer, project or section\ninterface IPrintProcessorOptions {\n    headers?:{\n        maxDepth?:number // can be used to limit the <H2>, <H3> headings to a certain depth (0: no restriction, 1 no headers, 2: one level <h2>)\n        altBefore?:string // can be used to define an alternative if depth is bigger than max, e.g. \"<div style='text-decoration:underline' class='myheading_depth_'>\"\n        altAfter?:string // closes the above tag </div>\n    }\n}\n\ninterface IProcessResult {\n    /** generated html */\n    html:string\n    /** primary list of items from selection + first level interators */\n    redlining:string[]\n}\n\ninterface IPrintProcessor {\n    prepareProcessing(  mf:JQuery, onError:(message:string) => void, format:string);\n    processSection( formatter:IPrintCustomFormatter, section:ICustomSection, projectOverwrites: IPrintFunctionParamsOverwrites,\n                    selection:string[], possibleTargets:string[]):Promise<IProcessResult>;\n    getCustomStylesheet():string;\n\n    /**\n     * This can be used by render functions to get a table and process its data,\n     * for example for a row count\n     * @param tableId The (sub)table to render\n     * @param selection The selection to use as the root\n     */\n    getTableData(tableId:string, selection:string[]):Promise<string>;\n\n    globals:IPrintGlobals;\n}\n\nconst PrintFindAllScriptsRegex = /\\$\\[.*?\\]\\$/g\n\ninterface IPrintConfig {\n    getPrintProcessor():IPrintProcessor;\n    getFieldAndLabelsIteratorsDropdown():IDropdownOption[];\n    getItemIteratorsDropdown( items:boolean, folders:boolean, allowNoIterator:boolean );\n    getItemConditionDropdown();\n    showOptionsEditor( fctName:string, currentValue:string, onUpdate:(newValue:string) => void );\n    editFunctionOptions(currentValue:string, onUpdate:( newOptions:string ) => void );\n    editStyle( wrap:JQuery );\n    functionHasOptions( functionUid:string );\n    getFunctions( group:string );\n    getItemSorters():IPrintSorterMap;\n    getAllFunctions():IPrintBaseFunctionMap;\n    getAllIterators():IPrintBaseFunctionMap;\n}\n\nvar globalPrintConfig: IPrintConfig;\nfunction setGlobalPrintConfig(config: IPrintConfig) {\n    globalPrintConfig = config;\n}\n// let globalPrintConfig =  (window as any).__GLOBAL_PRINT_CONFIG__ as IPrintConfig;\ninterface IStringRiskConfigMap { [key: string]: IRiskConfig };\ninterface IFieldCache { [key: string]: IPrintFieldInfo };\ninterface IPrintGlobals {\n    itemMap:IStringJQueryMap;\n    riskControlCategories:IStringStringArrayMap;\n    categories:IStringJQueryMap;\n    fieldsPerCategory:IStringJQueryMap; // the field definitions\n    fieldIdByLabel:IStringMap; // note: label to id is not necessarily unique\n    fieldDefById:IStringJQueryMap; //  for a combination of category and field id -> caches the specs of the field\n    riskConfigs:IStringRiskConfigMap;\n    down:IStringStringArrayMap;\n    up:IStringStringArrayMap;\n    children:IStringStringArrayMap;\n    count:number,\n    lastItem:string // cache last retrieved item\n    lastFields: IFieldCache  // cache last retrieved fields\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { JsonEditorValidation } from \"../../../jsonvalidation/JsonValidator\";\nimport { app, ControlState, globalMatrix } from \"../../globals\";\nimport { ml } from \"../matrixlib\";\nimport { UIToolsConstants } from \"../matrixlib/MatrixLibInterfaces\";\n\nexport type { IValidationSpec };\nexport { JsonEditor };\n\ninterface IValidationSpec {\n    validationFunction?: JsonEditorValidation|null | any,\n    schema?: string,\n    apiHelp?: string,\n}\n\nclass JsonEditor {\n    constructor() {};\n    showDialog( title:string, value:string, onOk:(update:string) => void, semanticValidate:IValidationSpec = {}) {\n\n        let dlg = $(\"<div>\").appendTo(\"body\");\n\n         dlg.html(\"\");\n\n         dlg.addClass(\"dlg-v-scroll\");\n         dlg.removeClass(\"dlg-no-scroll\");\n\n        const container = $(\"<div id='jsonEditorContainer' class='jsonEditorContainer'>\");\n        // const containerContainer = $(\"<div id='jsonEditorContainerContainer'>\");\n        const editor = $(\"<div class='theeditor'>\").appendTo(container);\n        // container.append(containerContainer);\n        // dlg.append(container);\n\n        ml.UI.showDialog(\n            dlg, title, container, $(document).width() * 0.9, app.itemForm.height() * 0.9, [\n                {\n                    text: 'Ok',\n                    class: 'btnDoIt',\n                    click: async function (event: JQueryMouseEventObject) {\n                        let value = await editor.getController().getValueAsync();\n                        try {\n                            let escapedJsonStr = ml.JSON.escapeJson(value)\n                            jsl.parser.parse(escapedJsonStr);\n                            let json = JSON.parse(escapedJsonStr);\n                            const callback = (error: string) => {\n                                const submit = () => {\n                                    onOk(value);\n                                    dlg.dialog(\"close\");\n                                };\n\n                                if (error) {\n                                    if (event.shiftKey) {\n                                        console.error(\"Validation error suppressed\", error);\n                                        submit();\n                                        return;\n                                    }\n                                    ml.UI.showError(\"JSON Validation error\",\n                                        `<div style='font-weight: bold'>You can still save if you press the Shift key while clicking OK.</div><div>${error}</div>`);\n                                    // ignore OK\n                                    event.preventDefault();\n                                    //return false;\n                                } else {\n                                    submit();\n                                }\n                            };\n                            if (semanticValidate.validationFunction) {\n                                semanticValidate.validationFunction(json)\n                                    .then(callback)\n                                    .catch((err) => console.log(\"error\", err));\n                            } else if (semanticValidate.schema) {\n                                globalMatrix.jsonValidator.validateType(json, semanticValidate.schema)\n                                    .then(errors => callback(globalMatrix.jsonValidator.errorString(errors)))\n                                    .catch((err) => console.log(\"error\", err));\n                            } else {\n                                onOk(value);\n                                dlg.dialog(\"close\");\n                            }\n                        } catch (parseException) {\n                            if (typeof parseException === \"object\" && \"message\" in parseException) {\n                                alert(parseException.message);\n                            }\n                        }\n                    }\n                },{\n                    text: 'Cancel',\n                    class: 'btnCancelIt',\n                    click: function () {\n                        dlg.dialog(\"close\");\n                    }\n                }\n        ], UIToolsConstants.Scroll.None, false, true,\n            () => { // close\n                dlg.remove();\n            },\n            () => { // open\n                editor.html(\"\").plainText({\n                    id: \"\",\n                    help: \"&nbsp;\",\n                    controlState: ControlState.DialogCreate,\n                    valueChanged: function() {},\n                    isFolder: true,\n                    canEdit: true,\n                    fieldValue: value,\n                    parameter: {\n                        code: 'json',\n                        height:  0,\n                        autoFormat: true,\n                        showJSONFormat:true,\n                        apiHelp:semanticValidate.apiHelp,\n                        hideFullscreen:true\n                    }});\n                if (semanticValidate.schema) {\n                    globalMatrix.jsonValidator.schemaView(semanticValidate.schema).then(view => {\n                        editor.addClass(\"split\")\n                        let drag = $(\"<div id='codeDrag'>\");\n                        container.append( drag );\n                        let help = $(view.render());\n                        help.addClass(\"editorHelp\");\n                        container.append(help);\n                        drag.mousedown(function (e) {\n\n                            if (e.preventDefault) e.preventDefault();\n\n                            let mi = container.offset().left;\n                            let ma = container.width() + mi;\n\n                            $(document).mousemove(function (e) {\n\n                                if ( e.pageX > mi + 100 && e.pageX < ma - 100 ) {\n                                    let per = 100 * ( e.pageX - mi ) / container.width();\n                                    editor.css( \"width\", per + \"%\");\n                                    help.css( \"width\", (100-per) + \"%\");\n\n                                }\n                            });\n                        });\n\n                        }).catch( (err) => console.log( \"error\", err));\n                } else {\n                    editor.css(\"width\",\"100%\");\n                }\n            },\n            () => { // resize\n                $(\".CodeMirror\", dlg).height($(\".apiEdit\", dlg).height()-50);\n            }, false);\n    }\n}\n","import { FieldDescriptions } from \"../../common/businesslogic/FieldDescriptions\";\nimport { IDB, IDBParent, IDHFPasteBuffer, IDHFPasteBufferValue } from \"../../common/businesslogic/index\";\nimport { IPlugin, IProjectPageParam, IPluginPanelOptions, plugins } from \"../../common/businesslogic/index\";\nimport { mDHF } from \"../../common/businesslogic/index\";\nimport { RestDB } from \"../../common/businesslogic/index\";\nimport { ml } from \"../../common/matrixlib\";\nimport { HTMLCleaner } from \"../../common/matrixlib/index\";\nimport { UIToolsConstants } from \"../../common/matrixlib/MatrixLibInterfaces\";\nimport { ItemControl } from \"../../common/UI/Components\";\nimport { HistoryTools } from \"../../common/UI/Tools/ItemHistoryView\";\nimport { IItem, app, globalMatrix, restConnection, IBooleanMap, ControlState, matrixSession, IGenericMap, IItemPut } from \"../../globals\";\n\nimport { XCPostCompareHtml } from \"../../RestCalls\";\nimport { XRPostProject_LaunchReport_CreateReportJobAck, XRPostProject_CompareHtml_HtmlCompareResult, XRItemSimpleType, XRGetProject_ItemList_GetItemListAck } from \"../../RestResult\";\n\nexport type { ISection, ISectionPair };\nexport { Redlining };\nexport { initialize };\n\ninterface ISection {\n    html:JQuery,\n    title:string,\n    type:string\n}\n\ninterface ISectionPair {\n    left:ISection|null\n    right:ISection|null\n    dynamic:boolean // whether it renders items\n}\n\ninterface IDiffDocumentConfig{\n    doc:string,\n    diffSection:string,\n    addedSection:string,\n    removedSection:string,\n    sameSection:string,\n    targetFolder:string\n}\ninterface IDiffDocumentContent {\n    diffText:string,\n    addedText:string,\n    removedText:string,\n    sameText:string\n    diffSection:IDHFPasteBufferValue,\n    addedSection:IDHFPasteBufferValue,\n    removedSection:IDHFPasteBufferValue,\n    sameSection:IDHFPasteBufferValue\n}\nclass Redlining implements IPlugin {\n    private _item:IItem;\n    private _jui:JQuery;\n    public isDefault = true;\n    private panel:JQuery;\n    private selectedOnly:string[] = null;\n    private documentCompareCanceled = false;\n\n    initItem( item:IItem, jui:JQuery ) {\n        this._item = item;\n        this._jui = jui;\n    }\n\n    initServerSettings() {}\n    initProject() {}\n    supportsControl() {\n        return  false;\n    }\n\n    updateMenu(ul:JQuery) {\n        let that = this;\n    }\n\n\n    getProjectPagesAsync():Promise<IProjectPageParam[]> {\n        return new Promise((resolve, reject) => {\n            let that = this;\n            let pages:IProjectPageParam[] = [];\n            pages.push({ id: \"REDLINE\", title:  \"Redlining\", folder:\"AUDIT\", order:3000,  icon:\"fal fa-stream\", usesFilters:false, render: (options: IPluginPanelOptions) => that.renderProjectPage(options)});\n            resolve(pages);\n        })\n    }\n\n    compareDocuments(report:JQuery, leftId:string, rightId:string) {\n        let that = this;\n\n        this.documentCompareCanceled = false;\n\n        app.getItemAsync(leftId).done((leftItem) => {\n            if ( that.documentCompareCanceled ) return;\n            app.getItemAsync(rightId).done((rightItem) => {\n                if ( that.documentCompareCanceled ) return;\n                let leftDate = ml.Item.parseRef( leftId ).type == \"DOC\"?new Date().toISOString():leftItem.history[leftItem.history.length-1].date;\n                let rightDate = ml.Item.parseRef( rightId ).type == \"DOC\"?new Date().toISOString():rightItem.history[rightItem.history.length-1].date;\n                let leftFilter = that.getFilterOfDoc( leftId, leftItem );\n                let rightFilter = that.getFilterOfDoc( rightId, rightItem );\n\n                that.compareDocumentsDetail( report, leftId, rightId, leftDate, rightDate, leftFilter, rightFilter);\n            });\n        });\n\n    }\n\n    cancelCompare() {\n        this.documentCompareCanceled = true;\n    }\n\n    compareDocumentsDetail(report:JQuery, leftId:string, rightId:string, leftCreationDate:string, rightCreationDate:string, leftFilter:string, rightFilter:string ) {\n        let that = this;\n\n        this.selectedOnly = null;\n\n        report.html( \"\" );\n\n        let containerDetailsSections = $(\"<div>\").appendTo(report);\n        let containerDetailsItems = $(\"<div>\").appendTo(report);\n\n        let step1 = ml.UI.getSpinningWait( \"Retrieving documents - please wait\");\n        containerDetailsSections.append( step1 );\n\n        let leftParams = { format: \"html\" };\n        if (leftFilter) leftParams[\"filter\"] = leftFilter;\n        let rightParams = { format: \"html\" };\n        if (rightFilter) leftParams[\"filter\"] = rightFilter;\n\n        app.startCreateDocumentAsync(leftId, leftParams).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n            if ( that.documentCompareCanceled ) return;\n            mDHF.loadDocument(result.jobId, function ( leftHTML: any) {\n                if ( that.documentCompareCanceled ) return;\n\n                app.startCreateDocumentAsync(rightId, rightParams).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n                    if ( that.documentCompareCanceled ) return;\n\n                    mDHF.loadDocument(result.jobId, function ( rightHTML: any) {\n                        if ( that.documentCompareCanceled ) return;\n\n                        if ( new Date(leftCreationDate) < new Date(rightCreationDate)) {\n                            that.showDetailedSectionChanges( containerDetailsSections, leftId, rightId, leftHTML, rightHTML);\n                            that.showDetailedItemChanges( containerDetailsItems, leftId, rightId, leftCreationDate, rightCreationDate, leftHTML, rightHTML);\n                        } else {\n                            that.showDetailedSectionChanges( containerDetailsSections, rightId, leftId, rightHTML, leftHTML);\n                            that.showDetailedItemChanges( containerDetailsItems, rightId, leftId, rightCreationDate, leftCreationDate, rightHTML, leftHTML);\n                        }\n                    });\n                });\n            });\n        });\n    }\n\n    destroy() {\n\n    }\n\n    private getFilterOfDoc(id:string, item:IItem ) {\n\n        if (ml.Item.parseRef(id).type != \"DOC\") {\n            return \"\"; // only interested in filter of DOC items\n        }\n\n        let filterFieldIds = globalMatrix.ItemConfig.getFieldsOfType(\"docFilter\", \"DOC\");\n        if (filterFieldIds.length == 0) {\n            return \"\"; // no filter field\n        }\n\n        // get filter id\n        let filterFieldId = filterFieldIds[0].field.id;\n\n        // get filter from item\n        let filter = item[filterFieldId];\n        if (!filter) {\n            return \"\";\n        }\n        return JSON.parse( filter).join(\",\");\n\n    }\n    // shows pure text changes for each section\n    private showDetailedSectionChanges( container:JQuery, leftId:string, rightId:string, leftHTML: any, rightHTML: any ) {\n        let that = this;\n\n        container.html('<h1>Document sections</h1>');\n\n        let dynamicSections = mDHF.getSections( true );\n        let staticSections = mDHF.getSections( false );\n        let allSections = dynamicSections.concat(staticSections);\n\n        // get all the right sections as 'baseline'\n        let left23:boolean = false;\n        let right23:boolean = false;\n\n        let pairs:ISectionPair[] = [];\n        $(\".subchapter,.subsubchapter,.checksection\", $(rightHTML)).each( (idx, section) => {\n            let type = that.getTypeFromClass( $(section).attr(\"class\"), allSections);\n            if (type) right23 = true;\n            pairs.push( {right:{\n                html:that.getHtmlFromSection( $(section) ),\n                title:that.getTitleFromSection( $(section) ),\n                type:type\n            }, left:null,\n            dynamic:dynamicSections.indexOf(type)!=-1});\n\n        });\n        // add the left sections to the matching right or at end\n        // get all the left sections\n        $(\".subchapter,.subsubchapter,.checksection\", $(leftHTML)).each( (idx, section) => {\n            let type = that.getTypeFromClass( $(section).attr(\"class\"), allSections);\n            if (type) left23 = true;\n        });\n\n        let only23 = left23 && right23;\n\n        $(\".subchapter,.subsubchapter,.checksection\", $(leftHTML)).each( (idx, section) => {\n            let type = that.getTypeFromClass( $(section).attr(\"class\"), allSections);\n            if (type) left23 = true;\n            let left:ISection = {\n                html:that.getHtmlFromSection( $(section) ),\n                title:that.getTitleFromSection( $(section) ),\n                type:type\n            };\n            let added = false;\n            for (let pair of pairs) {\n                // if both are 2.3 generated documents, go by section type and title - if not only title\n                if (!added && !pair.left && pair.right.title == left.title && (!only23 || pair.right.type == left.type)) {\n                    pair.left = left;\n                    added = true;\n                }\n            }\n            if (!added) {\n                // no match\n                pairs.push( { left:left, right:null, dynamic:dynamicSections.indexOf(type)!=-1 });\n            }\n\n        });\n        // now the pairs is a list of matching section pairs\n\n        let table = $(`<table class=\"table table-bordered\">\n            <thead><tr><th style='width:50%'>${leftId}!</th><th style='width:50%'>${rightId}!</th></tr></thead>\n            <tbody></tbody>\n        </table>`).appendTo( container ).highlightReferences();\n\n\n        for (let pair of pairs) {\n\n            let sectionItems = `${pair.dynamic?\" - see item differences below\":\"\"}`;\n\n            if (pair.left && pair.right) {\n                if (pair.left.html.html() == pair.right.html.html()) {\n                    $(`<tr><td colspan=2><b>${pair.left.title}</b> did not change${sectionItems} <span class=\"viewHtml\">(view rendered text)</span>.</td></tr>`)\n                    .appendTo( $(\"tbody\", table))\n                    .data( \"single\", pair.left);\n                } else {\n                    $(`<tr><td colspan=2><b>${pair.left.title}</b> has changed${sectionItems} <span class=\"compareHtml\">(compare rendered text)</span>.</td></tr>`)\n                    .appendTo( $(\"tbody\", table))\n                    .data( \"pair\", pair);\n                }\n            } else if (pair.left) {\n                $(`<tr><td><b>${pair.left.title}</b> does not exist in other${sectionItems} <span class=\"viewHtml\">(view rendered text)</span>.</td><td>n/a</td></tr>`)\n                .appendTo( $(\"tbody\", table))\n                .data( \"single\", pair.left);\n            } else  {\n                $(`<tr><td>n/a</td><td><b>${pair.right.title}</b> does not exist in other${sectionItems} <span class=\"viewHtml\">(view rendered text)</span>.</td></tr>`)\n                .appendTo( $(\"tbody\", table))\n                .data( \"single\", pair.right);\n            }\n        }\n\n        $(\".compareHtml\").click( (event) => {\n            that.compareHtmlSection( event, leftId, rightId );\n        });\n\n        $(\".viewHtml\").click( (event) => {\n           that.viewHtmlSection( event );\n        });\n    }\n\n    // goes from \".subchapter,.subsubchapter\" and takes all until end or next  \".subchapter,.subsubchapter\",\n    private getHtmlFromSection( section:JQuery) {\n        if ( section.hasClass(\"checksection\") ) {\n            return section.clone();\n        }\n        let div = $(\"<div>\");\n        let next = section.next();\n        while (next && next.length) {\n            if ( next.hasClass(\"subchapter\") || next.hasClass(\"subsubchapter\")  || next.hasClass(\"checksection\") ) {\n                next = null;\n            } else {\n                let after = next.next();\n                if (next[0].nodeName != \"HR\") { // there are some HRs in the html rendering between sections to make it pretty\n                    div.append( next.clone() );\n                }\n                next = after.length?after:null;\n            }\n        }\n        return div;\n    }\n    private getTitleFromSection( section:JQuery) {\n\n        if ( section.hasClass(\"checksection\") ) {\n            return $(\"b\", section).text();\n        } else {\n            return section.text();\n        }\n\n    }\n    // view a rendered html section\n    private compareHtmlSection( event:JQueryEventObject, leftId:string, rightId:string) {\n        let btn = $(event.delegateTarget);\n        let pair = <ISectionPair>btn.closest(\"tr\").data(\"pair\");\n\n        let left = new HTMLCleaner( pair.left.html.html(), false).getClean(HTMLCleaner.CleanLevel.Strict, true);\n        let right = new HTMLCleaner(pair.right.html.html(), false).getClean(HTMLCleaner.CleanLevel.Strict, true);\n         let param:XCPostCompareHtml =  {\n            arg: JSON.stringify({ versions:[left, right]})\n        }\n\n        app.compareHTML(param).done(function (result: XRPostProject_CompareHtml_HtmlCompareResult) {\n\n            let dlg = $(\"<div>\").appendTo($(\"body\"));\n\n            let content = $(`<table class=\"table table-bordered\">\n                <thead><tr></tr></thead>\n                <tbody></tbody>\n            </table>`);\n\n            $(\"thead tr\", content).append( $(\"<th style='width:50%'>\").append( ml.Item.renderLink( leftId, null, true)));\n            $(\"thead tr\", content).append( $(\"<th style='width:50%'>\").append( ml.Item.renderLink( rightId, null, true)));\n\n            $(`<tr><td>${result.html[0]}</td><td>${result.html[1]}</td></tr>`)\n            .appendTo( $(\"tbody\", content))\n\n            ml.UI.showDialog(dlg, \"Section Compare\", content, $(document).width() * 0.85, app.itemForm.height() * 0.85,\n                [{\n                    text: \"Ok\",\n                    class: 'btnDoIt',\n                    click: function () {\n                        dlg.dialog(\"close\");\n                    }\n                }],\n                UIToolsConstants.Scroll.Vertical,\n                true,\n                true,\n                () => { dlg.remove(); },\n                () => { },\n                () => { }\n            );\n        });\n    }\n\n    // view a rendered html section\n    private viewHtmlSection( event:JQueryEventObject) {\n        let btn = $(event.delegateTarget);\n        let single = <ISection>btn.closest(\"tr\").data(\"single\");\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n        let content = $(\"<div>\").append($(\"<div class='redlineView'>\").append(single.html));\n        ml.UI.showDialog(dlg, \"Section Content '\" + single.title + \"'\", content, 800, app.itemForm.height() * 0.90,\n            [{\n                text: \"Ok\",\n                class: 'btnDoIt',\n                click: function () {\n                    dlg.dialog(\"close\");\n                }\n            }],\n            UIToolsConstants.Scroll.Vertical,\n            true,\n            true,\n            () => { dlg.remove(); },\n            () => { },\n            () => { }\n        );\n    }\n    // returns a section type of a document section\n    private getTypeFromClass( css:string, allSections:string[] ) {\n        // here I could remove other classes...\n        if (!css) return \"\";\n        let classes = css.split(\" \");\n        for (let cls of classes) {\n            if ( allSections.indexOf(cls)!=-1) {\n                return cls;\n            }\n        }\n        // no known section\n        return \"\";\n    }\n\n    // show a list of items side by side\n    private showDetailedItemChanges( container:JQuery, leftId:string, rightId:string, leftCreationDate:string, rightCreationDate:string, leftHTML: any, rightHTML: any ) {\n        let that = this;\n\n        let step3 = ml.UI.getSpinningWait( \"Retrieving all changed items\");\n        container.append( step3 );\n        restConnection.getProject(\"tree?fancy&atDate=\" + new Date(leftCreationDate).toISOString()).done(function (leftTree: IDB[]) {\n            if ( that.documentCompareCanceled ) return;\n\n            restConnection.getProject(\"tree?fancy&atDate=\" + new Date(rightCreationDate).toISOString()).done(function (rightTree: IDB[]) {\n            if ( that.documentCompareCanceled ) return;\n\n                // this are all the link ids in any of the documents + some which might be false positives\n                let leftLinks = that.extractLinks( leftHTML );\n                let rightLinks = that.extractLinks( rightHTML );\n\n                // let step3 = ml.UI.getSpinningWait( \"1/4 Getting details \" + rightId);\n                // report.append( step2 );\n                let leftVersions:XRItemSimpleType[] = [];\n                let rightVersions:XRItemSimpleType[] = [];\n\n                that.createItemsFromTree(leftTree, leftVersions);\n                that.createItemsFromTree(rightTree, rightVersions);\n\n                // filter the items from a certain time by those in the actual documents\n                leftVersions = leftVersions.filter( version => leftLinks[version.ref]);\n                rightVersions = rightVersions.filter( version => rightLinks[version.ref]);\n\n                let leftDisplay = leftId + \"! (\" + ml.UI.DateTime.renderHumanDate(new Date(leftCreationDate), false) + \")\";\n                let rightDisplay = rightId + \"! (\" + ml.UI.DateTime.renderHumanDate(new Date(rightCreationDate), false) + \")\";\n\n                container.html('<h1>Referenced items</h1>');\n\n                let warning = $(\"<div>\").appendTo( container );\n                if (leftVersions.length == 0 && rightVersions.length == 0) {\n                    warning.html(\"Neither document contains any items.\");\n                    return;\n                }\n\n                that.addFilters( container, leftId, rightId );\n\n                let diffTable = $(\"<div>\").appendTo( container );\n\n                that.showDifferences(diffTable, leftVersions, rightVersions, leftDisplay, rightDisplay);\n\n                that.hideShow();\n            });\n        });\n    }\n\n    // gets all the potential hyperlinks in a <a>XXX-YY</a>\n    private extractLinks( html:string):IBooleanMap {\n        let links:IBooleanMap = {}\n        $.each( $( \"a,.smartreplace\", $(html)), (idx,item) => {\n            let linkText=$(item).text();\n\n            if (linkText) {\n                let beforeSpace = linkText.split( \" \")[0];\n                if ( !beforeSpace.match( /[^A-Z0-9\\-]/) ) {\n                    // potential link only letters, digits and -\n                    links[beforeSpace] = true;\n                }\n            }\n        });\n        return links;\n    }\n\n\n    // retrieve a list of included items\n    getIncludedItems( leftId:string, rightId:string) {\n        let that = this;\n        let res = $.Deferred();\n\n\n        restConnection.getProject(\"itemlist/\" + leftId).done(function (leftItems: XRGetProject_ItemList_GetItemListAck) {\n            if ( that.documentCompareCanceled ) return;\n            restConnection.getProject(\"itemlist/\" + rightId).done(function (rightItems: XRGetProject_ItemList_GetItemListAck) {\n            if ( that.documentCompareCanceled ) return;\n\n                // the list might have some duplicates...\n                that.selectedOnly =  rightItems.items.map( item => item.ref ).concat( leftItems.items.map( item => item.ref ));\n                res.resolve();\n            });\n        });\n        return res;\n    }\n\n    // project pages show in the top in Projects, Reports and Documents\n    private renderProjectPage(options:IPluginPanelOptions) {\n        let that = this;\n\n        if (options.controlState === ControlState.Print) {\n            return;\n        }\n\n        document.title = \"Redline - \" + matrixSession.getProject();\n\n        options.control.html(\"\");\n\n        options.control.prepend(ml.UI.getPageTitle(\"Change between two dates\"));\n        if (ml.UI.DateTime.requiresTimeZoneWarning()) {\n             $(\".toolbarButtons .buttonCTA\").remove();\n            $(\".toolbarButtons\").append(ml.UI.DateTime.getTimeZoneCTA());\n        }\n\n        this.panel = $('<div class=\"panel-body-v-scroll fillHeight\" style=\"padding: 0 12px;\">').appendTo(options.control);\n\n        if (globalMatrix.ItemConfig.getTimeWarp()) {\n            $(\"<h2>Browse tree to find changes done after: \" + ml.UI.DateTime.renderCustomerHumanDate(new Date(globalMatrix.ItemConfig.getTimeWarp()), false) + \"</h2>\").appendTo(this.panel);\n            $(\"<div>The tree shows items in red if they changed after the above date</div>\").appendTo(this.panel);\n            $(\"<div>History of items shows the last change before the date in red, versions after in grey.</div>\").appendTo(this.panel);\n\n            return;\n        }\n        let report = $(\"<div>\");\n\n        this.showDateSelection( report );\n        this.panel.append(report);\n    }\n\n    private addFilters( report:JQuery, leftId?:string, rightId?:string) {\n        let that = this;\n\n        let filters = $(\"<div class='hideCopy'>\").appendTo(report);\n        $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"checkboxFilter\" data-hide=\"unchanged\" >show identical</label></div></div>').appendTo(filters);\n        $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"checkboxFilter\" data-hide=\"column1_not_included\" checked >show added</label></div></div>').appendTo(filters);\n        $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"checkboxFilter\" data-hide=\"column2_not_included\" checked >show removed</label></div></div>').appendTo(filters);\n        $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input type=\"checkbox\" class=\"checkboxFilter\" data-hide=\"changed\" checked >show changed</label></div></div>').appendTo(filters);\n        if (leftId && rightId) {\n            $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input disabled type=\"checkbox\" class=\"selectedOnly\">selected items only</label></div></div>').appendTo(filters);\n            this.getIncludedItems( leftId, rightId).done( () => {\n                ml.UI.setEnabled( $(\".selectedOnly\"), true);\n            });\n        }\n        $(\"input\", report).change( function() {\n            that.hideShow();\n        });\n        ml.UI.copyBuffer( filters, \"copy to clipboard\", report, this.panel, null, \"copy overview\");\n\n        this.addDiffDownload(filters);\n    }\n\n    private diffCancelled:boolean;\n\n    private addDiffDownload(filters:JQuery) {\n        let that = this;\n\n        let diffConfig = <IDiffDocumentConfig>globalMatrix.ItemConfig.getSettingJSON( \"downloadDiff\");\n        if (diffConfig && diffConfig.doc && app.getItemTitle(diffConfig.doc ) ) {\n\n            $('<i class=\"fal fa-file-download\" aria-hidden=\"true\" style=\"padding-left:12px;cursor:pointer\" data-original-title=\"create DOC\"> create DOC</i>').appendTo(filters).click( () => {\n\n                let dlg = $(\"<div id='progressDlg' style='z-index:2001'>\").appendTo(\"body\")\n                let content = $(\"<div id='progressDetails'>\");\n                ml.UI.showDialog( dlg, \"Creating Redline Document\", content, 900, 600, [{\n                    text: 'Cancel',\n                    class: 'btnCancel btnCancelStop',\n                    click: function () {\n                        dlg.dialog(\"close\");\n                    }\n                },],  UIToolsConstants.Scroll.Vertical, false, true, () => { that.diffCancelled = true; dlg.remove(); })\n\n                that.diffCancelled = false;\n                // copy the template\n                mDHF.preparePasteBuffer(null);\n                mDHF.copyTemplate([ diffConfig.doc], 0, true).done(async () => {\n\n                    content.append(`<p>Prepared document</p>`);\n\n                    // prepare the differencing\n                    let diff = that.prepareDiffSections( diffConfig );\n\n                    // build the data\n                    await that.createDiffContent(content, diff);\n\n                    if ( that.diffCancelled){\n                        ml.UI.showSuccess(\"Cancelled Redlining Document\");\n                    } else {\n                    // create the document\n                        that.createDiffDoc(diffConfig, diff).done( (result) => {\n                            ml.UI.showSuccess(\"Created Redlining Document\");\n                            $(\".btnCancelStop\").html(\"OK\");\n                            content.append(`<p>Finalized document ${ml.Item.renderLink( result.item.id, result.item.title, true).html()}</p>`);\n                        });\n                    }\n                });\n            }).tooltip();\n        }\n    }\n\n\n    /** This method creates the content for the diff doc, going through all displayed lines in the table */\n    private async createDiffContent( progressDlg:JQuery, diff:IDiffDocumentContent):Promise<IDiffDocumentContent> {\n        let that = this;\n\n        async function getHTMLForDoc(itemData: IItem, v: number) {\n            let itemControl = $(\"<div>\");\n            // render it\n            let itemC = new ItemControl({\n                control: itemControl,\n                controlState: ControlState.HistoryView,\n                isHistory: v,\n                item: itemData,\n                isItem: !itemData.children,\n                parameter: {manualTableHeights: true, reviewMode: true}\n            });\n            await itemC.load();\n            // prepare the object to be compared later\n\n            let diffBase = $(\"<div>\");\n            let versionInfo = itemData.history[itemData.history.length - v];\n            diffBase.append(`<div class=\"diffInfo\"><div class=\"diffTitle\"><span>${itemData.id}</span> <span>${versionInfo.title}</span></div><div class=\"diffVersionInfo\">diffVersionInfodiffVersionInfo</div></div>`);\n            $.each($(itemControl).children(\".panel-body-v-scroll\").children(\".dialog-body\").children(), (idx, field) => {\n                diffBase.append(field);\n            });\n\n            // prepare for printing (remove replace inputs with texts etc)\n            ml.SmartText.prepareForReadReadRender($(diffBase));\n\n            // prepare for diffing (add markup)\n            $(\"textarea,pre\", diffBase).each(function (idx, select) {\n                $(select).replaceWith(\"<div>\" + $(select).html().replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') + \"</div>\");\n            });\n            $(\".fal.fa-square\", diffBase).each((idx, elem) => {\n                $(elem).parent().addClass(\"history-unchecked\");\n                $(elem).replaceWith(\"<span>&#10004; </span>\");\n            });\n            $(\".fal.fa-check-square\", diffBase).each((idx, elem) => {\n                $(elem).parent().addClass(\"history-checked\");\n                $(elem).replaceWith(\"<span>&#x25a2; </span>\");\n            });\n\n            // remove markup for rendering in UI\n            $(\".refIdHyper\", diffBase).each((idx, rih) => {\n                $(rih).parent().replaceWith($(rih).text() + \" \")\n            });\n            $(\".baseControlHelp\", diffBase).removeClass(\"baseControlHelp\");\n\n            // get the code\n            return diffBase[0].outerHTML.replace(/pull-left/g, \"\");\n        }\n        function getHeader( itemData:IItem, v:number ) {\n            let versionInfo = itemData.history[itemData.history.length-v];\n            return ` <div class=\"diffRevision\"><span class=\"diffAttribute\">Revision:</span> <span class=\"diffValue\">${v}</span></div>\n                     <div class=\"diffAuthor\"><span class=\"diffAttribute\">Author:</span> <span class=\"diffValue\">${versionInfo.user}</span></div>\n                     <div class=\"diffDate\"><span class=\"diffAttribute\">Date:</span> <span class=\"diffValue\">${versionInfo.date}</span></div>\n                     <div class=\"diffAction\"><span class=\"diffAttribute\">Action:</span> <span class=\"diffValue\">${versionInfo.action}</span></div>\n                     <div class=\"diffComment\"><span class=\"diffAttribute\">Comment:</span> <span class=\"diffValue\">${versionInfo.comment}</span></div>`;\n        }\n        async function compareTwoRevisions( itemId:string,  v0:number, v1:number ) {\n\n            let ht = new HistoryTools();\n            let versions:string[] = [];\n            let headers:string[] = [];\n\n            for (let v of [v0, v1]) {\n                let itemData =  await app.getItemAsync(itemId, v);\n\n                versions.push( await getHTMLForDoc( itemData, v ));\n                headers.push( getHeader(itemData, v));\n            }\n            let splittedVersions = ht.splitVersions( versions );\n\n            let compareParams: XCPostCompareHtml = {\n                arg: JSON.stringify(splittedVersions?{versionsMultiple:splittedVersions}:{ versions: versions })\n            }\n            // call compare\n            let compareResults = await app.compareHTML(compareParams);\n\n            if (splittedVersions) {\n                for (let assemble =0; assemble<compareResults.htmlMultiple.length; assemble++ ) {\n                    let left = compareResults.htmlMultiple[assemble][0].replace(\"diffVersionInfodiffVersionInfo\", headers[0]);\n                    let right = compareResults.htmlMultiple[assemble][1].replace(\"diffVersionInfodiffVersionInfo\", headers[1]);\n                    if ($(left).text() || $(right).text() ) {\n                        diff.diffText += `<tr><td>${left}</td><td>${right}</td></tr>`;\n                    }\n                }\n            } else {\n                let left = compareResults.html[0].replace(\"diffVersionInfodiffVersionInfo\", headers[0]);\n                let right = compareResults.html[1].replace(\"diffVersionInfodiffVersionInfo\", headers[1]);\n                if ($(left).text() || $(right).text() ) {\n                    diff.diffText += `<tr><td>${left}</td><td>${right}</td></tr>`;\n                }\n            }\n        }\n\n        async function showRevision( itemId:string,  vVersion:string ) {\n\n            let v = Number(vVersion.replace(\"v\",\"\"));\n            let itemData =  await app.getItemAsync(itemId, v);\n\n            let item = await getHTMLForDoc( itemData, v );\n            let header =  getHeader(itemData, v);\n\n            return item.replace(\"diffVersionInfodiffVersionInfo\", header);\n        }\n\n        async function renderRow( itemId, row ) {\n            let compareResult =  $($(\"td\", row)[3]).text();\n\n\n            if (compareResult==\"compare versions\" && diff.diffSection)  {\n                let sm = $(\"span\", $(\"td\", row)[3]);\n                await compareTwoRevisions( itemId, $(sm).data(\"v0\"), $(sm).data(\"v1\") );\n            } else if (compareResult==\"added/included\" && diff.addedSection)  {\n                diff.addedText += await showRevision( itemId, $($(\"td\", row)[2]).text() );\n            } else if (compareResult==\"deleted/excluded\" && diff.removedSection)  {\n                diff.removedText += await showRevision( itemId, $($(\"td\", row)[1]).text() );\n            } else if (compareResult==\"no changes\" && diff.sameSection)  {\n                diff.sameText += await showRevision( itemId, $($(\"td\", row)[1]).text() );\n            }\n        }\n\n        let table = $(\".diffTable\");\n        if (!table.length) {\n            // for < 2.4\n            table = $(\".compareItem\").closest(\"table\");\n        }\n        let  headers = $(\"thead > tr > th\", table);\n\n        diff.diffText = diff.diffSection?`<table class=\"table table-bordered diffSection\"><thead><tr><th>${$(headers[1]).html()}</th><th>${$(headers[2]).html()}</th></tr></thead><tbody>`:\"\";\n        diff.addedText = diff.addedSection?\"<div class='addedSection'>\":\"\";\n        diff.removedText = diff.removedSection?\"<div class='removedSection'>\":\"\";\n        diff.sameText = diff.sameSection?\"<div class='sameSection'>\":\"\";\n\n        // all visible rows\n        let rows = table.children(\"tbody\").children(\"tr:visible\");\n        let count = rows.length;\n\n        // prepare a visible todo list showing all items in table\n        let progress:JQuery[] = [];\n        let ul = $(`<p>`).appendTo(progressDlg);\n        for ( let idx=0; idx<count; idx++) {\n            let row = rows[idx];\n            let p = $(`<div><i class=\"fal fa-square\"> ${$(row).data(\"ci\")} ${app.getItemTitle($(row).data(\"ci\"))}</div>`).appendTo(ul);\n            progress.push(p);\n        }\n\n        // process one item after the other and show progress\n        for ( let idx=0; idx<count && !that.diffCancelled; idx++ ) {\n            let row = rows[idx];\n            $(\".versionpane\").remove();\n            await renderRow( $(row).data(\"ci\"),$(row) );\n            $(\"i\", progress[idx]).removeClass(\"fa-square\").addClass(\"fa-check\");\n        }\n\n        if (that.diffCancelled) {\n            diff.diffText =\"\";\n            diff.addedText =\"\";\n            diff.removedText =\"\";\n            diff.sameText =\"\";\n        } else {\n            diff.diffText += diff.diffSection?`</tbody></table>`:\"\";\n            diff.addedText += diff.addedSection?\"</div>\":\"\";\n            diff.removedText += diff.removedSection?\"</div>\":\"\";\n            diff.sameText += diff.sameSection?\"</div>\":\"\";\n        }\n\n        return diff;\n    }\n\n    /** This method fills DOC based on the differences computed  */\n    private createDiffDoc(  diffConfig:IDiffDocumentConfig, diff:IDiffDocumentContent ):JQueryDeferred<IDBParent> {\n        let res:JQueryDeferred<IDBParent> = $.Deferred();\n\n        let that = this;\n\n        let folderId = diffConfig.targetFolder ? diffConfig.targetFolder: \"F-DOC-1\"\n        let currentBufferString = localStorage.getItem(mDHF.COPY_PASTE_BUFFER);\n        let pasteBuffer = (<IDHFPasteBuffer>JSON.parse(currentBufferString)).items[0];\n\n        let sourceref = 0;\n        let srfs = globalMatrix.ItemConfig.getFieldsOfType(\"sourceref\", \"DOC\");\n        if (srfs.length) {\n            sourceref = srfs.length ? srfs[0].field.id : 0;\n        }\n\n        // prepare the item to be created\n        let itemJson: IItemPut = {};\n\n        itemJson.title = pasteBuffer.title + \" \" + app.getCurrentItemId();\n        if (sourceref) {\n            (<IGenericMap>itemJson)[sourceref] = pasteBuffer.sourceProject + \"/\" + pasteBuffer.sourceItem;\n        }\n        let fields = globalMatrix.ItemConfig.getItemConfiguration(\"DOC\").fieldList;\n\n        $.each(fields, function (fidx, f) {\n            for (var idx = 0; idx < pasteBuffer.item.length; idx++) {\n                if (pasteBuffer.item[idx].def.label === f.label && sourceref != f.id) {\n                    (<IGenericMap>itemJson)[f.id] = pasteBuffer.item[idx].val;\n                }\n            }\n        });\n\n        // fill in diff section: items which differ between the two timelines\n\n        if (diff.diffSection) {\n            let val = JSON.parse(diff.diffSection.val);\n            val.fieldValue = diff.diffText;\n            itemJson[diff.diffSection.def.id] = JSON.stringify(val);\n        }\n\n        // fill in added section: items which have been added\n        if (diff.addedSection) {\n            let val = JSON.parse(diff.addedSection.val);\n            val.fieldValue = diff.addedText;\n            itemJson[diff.addedSection.def.id] = JSON.stringify(val);\n        }\n\n        // fill in added section: items which have been removed\n        if (diff.removedSection) {\n            let val = JSON.parse(diff.removedSection.val);\n            val.fieldValue = diff.removedText;\n            itemJson[diff.removedSection.def.id] = JSON.stringify(val);\n        }\n\n        // fill in unchanged section: items which are identical\n        if (diff.sameSection) {\n            let val = JSON.parse(diff.sameSection.val);\n            val.fieldValue = diff.sameText;\n            itemJson[diff.sameSection.def.id] = JSON.stringify(val);\n        }\n\n        app.createItemOfTypeAsync(\"DOC\", itemJson, \"redlining\", folderId).done(function (result) {\n            console.log(result);\n            res.resolve( result );\n        }).fail(function (error) {\n\n        });\n\n        return res;\n    };\n\n    /** This method figures out what needs to go into the redlining diff document, depending on the configuration and the actual template */\n    private prepareDiffSections( diffConfig:IDiffDocumentConfig ):IDiffDocumentContent {\n        // to collect results\n        let diff: IDiffDocumentContent = {\n            diffText:\"\",\n            addedText:\"\",\n            removedText:\"\",\n            sameText:\"\",\n            diffSection:null,\n            addedSection:null,\n            removedSection:null,\n            sameSection:null\n        }\n\n        // get the info from the template document\n        let currentBufferString = localStorage.getItem(mDHF.COPY_PASTE_BUFFER);\n        let pasteBuffer = (<IDHFPasteBuffer>JSON.parse(currentBufferString)).items[0];\n\n        // if there's a section define in the config, check if the same section is in the template\n        if (diffConfig.diffSection) {\n            let diffTextFields = pasteBuffer.item.filter(f => f.def.fieldType == FieldDescriptions.Field_dhf && f.val && JSON.parse(f.val) && JSON.parse(f.val).name.toLowerCase() == diffConfig.diffSection.toLowerCase());\n            if (diffTextFields.length == 1) {\n                diff.diffSection = diffTextFields[0];\n            } else {\n                console.log( `Warning diffSection=\"${diffConfig.diffSection}\" property in config does not exist in template document`);\n            }\n        }\n        if (diffConfig.addedSection) {\n            let addedTextFields = pasteBuffer.item.filter(f => f.def.fieldType == FieldDescriptions.Field_dhf && f.val && JSON.parse(f.val) && JSON.parse(f.val).name.toLowerCase() == diffConfig.addedSection.toLowerCase());\n            if (addedTextFields.length == 1) {\n                diff.addedSection = addedTextFields[0];\n            } else {\n                console.log( `Warning addedSection=\"${diffConfig.addedSection}\" property in config does not exist in template document`);\n            }\n        }\n        if (diffConfig.removedSection) {\n            let removedTextFields = pasteBuffer.item.filter(f => f.def.fieldType == FieldDescriptions.Field_dhf && f.val && JSON.parse(f.val) && JSON.parse(f.val).name.toLowerCase() == diffConfig.removedSection.toLowerCase());\n            if (removedTextFields.length == 1) {\n                diff.removedSection = removedTextFields[0];\n            } else {\n                console.log( `Warning removedSection=\"${diffConfig.removedSection}\" property in config does not exist in template document`);\n            }\n        }\n        if (diffConfig.sameSection) {\n            let sameTextFields = pasteBuffer.item.filter(f => f.def.fieldType == FieldDescriptions.Field_dhf && f.val && JSON.parse(f.val) && JSON.parse(f.val).name.toLowerCase() == diffConfig.sameSection.toLowerCase());\n            if (sameTextFields.length == 1) {\n                diff.sameSection = sameTextFields[0];\n            }  else {\n                console.log( `Warning sameSection=\"${diffConfig.sameSection}\" property in config does not exist in template document`);\n            }\n        }\n\n        return diff;\n    }\n\n    private hideShow() {\n        let that = this;\n        $( \"tr\", this.panel).show();\n        // by default show all\n        $(\".compareItem\").show().removeClass(\"hideCopy\");\n\n        $.each( $( \".checkboxFilter\", this.panel), function(idx, input) {\n            if ( $(input).data(\"hide\")) {\n                let sh = $( \".\" + $(input).data(\"hide\"), that.panel);\n                if ($(input).prop(\"checked\")) {\n                    sh.show();\n                    sh.removeClass(\"hideCopy\");\n                } else {\n                    sh.hide();\n                    sh.addClass(\"hideCopy\");\n                }\n            }\n        });\n\n        if ($(\".selectedOnly\").prop(\"checked\")) {\n            $(\".compareItem\").each( (idx, ci) => {\n                if (that.selectedOnly.indexOf( $(ci).data(\"ci\")) ==-1) {\n                    $(ci).hide().addClass(\"hideCopy\");\n                }\n            });\n        }\n    }\n\n    private showDateSelection( report:JQuery) {\n        let that = this;\n\n        let bc = $('<div class=\"baseControl controlContainer\">').appendTo(this.panel);\n        let p = $(\"<p>\").appendTo(bc);\n        $('<span class=\"\">From </span>').appendTo(p);\n        let fromDate = $(\"<input type='text' class='form-control redlineDates'>\").appendTo(p);\n        $('<span class=\"\"> to </span>').appendTo(p);\n        let toDate = $(\"<input type='text' class='form-control redlineDates'>\").appendTo(p);\n        let goButton = $('<button style=\"margin-left: 12px\" type=\"button\" class=\"btn btn-success\">Compare</button>').appendTo(p);\n        let timeWarp = $('<span>').appendTo(p);\n\n        fromDate.datetimepicker({format:ml.UI.DateTime.getSimpleDateTimeFormatMoment()});\n        toDate.datetimepicker({\n            defaultDate: new Date(),\n            useCurrent: false, //Important!\n            format:ml.UI.DateTime.getSimpleDateTimeFormatMoment()\n        });\n        ml.UI.setEnabled( goButton, fromDate.data(\"DateTimePicker\").date() &&  toDate.data(\"DateTimePicker\").date() );\n        timeWarp.hide();\n        fromDate.on(\"dp.change\", function (e:any) {\n            toDate.data(\"DateTimePicker\").minDate(e.date);\n            ml.UI.setEnabled( goButton, fromDate.data(\"DateTimePicker\").date() &&  toDate.data(\"DateTimePicker\").date() );\n            if (fromDate.data(\"DateTimePicker\").date()) {\n                timeWarp.html(\"<a style='margin-left: 12px' type='button' class='showMore' >Time warp</a>: show project as it was at \" + ml.UI.DateTime.renderCustomerHumanDate( new Date(fromDate.data(\"DateTimePicker\").date()), false) );\n                timeWarp.show();\n            } else  {\n                timeWarp.hide();\n            }\n        });\n        toDate.on(\"dp.change\", function (e:any) {\n            fromDate.data(\"DateTimePicker\").maxDate(e.date);\n            ml.UI.setEnabled( goButton, fromDate.data(\"DateTimePicker\").date() &&  toDate.data(\"DateTimePicker\").date() );\n        });\n\n        goButton.click( function() {\n            that.createRedLineDates(  report, fromDate.data(\"DateTimePicker\").date(),  toDate.data(\"DateTimePicker\").date() );\n        });\n        timeWarp.click( function() {\n            let win = window.open(globalMatrix.matrixBaseUrl + \"/\" + matrixSession.getProject() + \"?atDate=\" + fromDate.data(\"DateTimePicker\").date().toISOString(), '_blank');\n            if (win) {\n                //Browser has allowed it to be opened\n                win.focus();\n            } else {\n                //Browser has blocked it\n                alert('Please allow popups for this site');\n            }\n\n        });\n    }\n\n    private createRedLineDates(  report:JQuery, fromDate:Date, toDate:Date) {\n        let that = this;\n        report.html( \"\" );\n        report.append( ml.UI.getSpinningWait(\"retrieving changes between the dates\") );\n\n        // get the tree at both dates\n        restConnection.getProject(\"tree?fancy&atDate=\" + fromDate.toISOString()).done(function (fromTree: IDB[]) {\n            restConnection.getProject(\"tree?fancy&atDate=\" + toDate.toISOString()).done(function (toTree: IDB[]) {\n\n                fromTree = RestDB.filterLegacyReportCat(fromTree);\n                toTree = RestDB.filterLegacyReportCat(toTree);\n                report.html( \"\" );\n                that.addFilters(  report );\n\n                let diffTable = $(\"<div>\").appendTo( report );\n                let fromItems:XRItemSimpleType[] = [];\n                let toItems:XRItemSimpleType[] = [];\n\n                that.createItemsFromTree(fromTree, fromItems);\n                that.createItemsFromTree(toTree, toItems);\n\n                that.showDifferences(diffTable, fromItems, toItems, ml.UI.DateTime.renderHumanDate(new Date(fromDate.toISOString()), false), ml.UI.DateTime.renderHumanDate(new Date(toDate.toISOString()), false));\n                that.hideShow();\n            });\n        });\n    }\n\n    private createItemsFromTree(tree:IDB[] , items:XRItemSimpleType[] ) {\n        let that = this;\n        $.each( tree, function(idx, node) {\n            if (node.children) {\n                // this is a folder\n                that.createItemsFromTree(node.children , items );\n            } else {\n                // this is a leaf\n                items.push( {\n                    author:\"\"\n                    ,birth:\"\"\n                    ,ref:node.id\n                    ,title:node.title\n                    ,version:(node.version?Number(node.version.split(\"/\")[0]):0)\n                });\n            }\n        });\n    }\n\n    private showDifferences(diffTable:JQuery, fromItems:XRItemSimpleType[], toItems:XRItemSimpleType[], fromText:string, toText:string) {\n        let fromIds = fromItems.map(function (item) { return item.ref; }).sort(function (a, b) { return ml.Item.sort(a, b); });\n        let toIds = toItems.map(function (item) { return item.ref; }).sort(function (a, b) { return ml.Item.sort(a, b); });\n\n        // create a sorted list of ids (every id only once)\n        let fromToIdsAll = fromIds.concat(toIds);\n        let fromToIds:string[] = [];\n        $.each( fromToIdsAll, function( ftidx,ft) {\n            if (fromToIds.indexOf(ft)==-1) fromToIds.push(ft);\n        });\n        fromToIds = fromToIds.sort(function (a, b) { return ml.Item.sort(a, b); });\n\n        // build table header\n        let table = $(\"<table class='table table-bordered'>\").appendTo( diffTable );\n        let head = $(\"<thead>\").appendTo( table );\n        let trh = $(\"<tr>\").appendTo( head );\n        $(\"<th>\").html(\"Item\").appendTo(trh);\n\n        // build table body\n        let tbody = $(\"<tbody>\").appendTo( table );\n\n        $(\"<th>\").html(fromText).appendTo(trh);\n        $(\"<th>\").html(toText).appendTo(trh);\n        this.addItems( tbody, fromToIds, fromItems, toItems );\n\n        $(\"<th class='hideCopy'>\").html(\"Changes\").appendTo(trh);\n\n        $(\".showMore\", table).click( function(event:JQueryEventObject) {\n            var ht = new HistoryTools();\n            let link = $(event.delegateTarget);\n            ht.compareVersions( link.data(\"item\"), link.data(\"v0\"), link.data(\"v1\"));\n\n        });\n        table.highlightReferences();\n    }\n    private addItems( tbody:JQuery, fromToRefs:string[], fromRefs:XRItemSimpleType[], toRefs:XRItemSimpleType[] ) {\n        let that = this;\n\n        $.each(fromToRefs, function(ftIdx, ft) {\n            // left column / first doc\n            let fromDetails = fromRefs.filter( function(ref ) { return ref.ref == ft;});\n            // right column / second doc\n            let toDetails = toRefs.filter( function(ref ) { return ref.ref == ft;});\n\n            // check which version is in which column (if included)\n            let both = 0;\n            let afterIdx = 0;\n            let beforeIdx = 0;\n            let existsInFirst = false;\n            let tr = $(`<tr class=\"compareItem\" data-ci=\"${ft}\">`).appendTo(tbody);\n            let itemColumn = $(\"<td>\").appendTo(tr);\n            itemColumn.append($(\"<span class='hideCopy'>\").html(ft + \"!\"));\n            itemColumn.append($(\"<span class='replaceCopy'>\").data(\"with\", ft + \"!\"));\n\n            if (fromDetails.length != 1) {\n                $(\"<td>\").html(\"not included\").appendTo(tr);\n                tr.addClass(\"column1_not_included\");\n            } else {\n                existsInFirst = true;\n                both++;\n                beforeIdx = fromDetails[0].version;\n                $(\"<td>\").html( \"v\" + beforeIdx ).appendTo(tr);\n            }\n\n            if (toDetails.length != 1) {\n                $(\"<td>\").html(\"not included\").appendTo(tr);\n                tr.addClass(\"column2_not_included\");\n            } else {\n                both++;\n                afterIdx = toDetails[0].version;\n                $(\"<td>\").html( \"v\" + afterIdx ).appendTo(tr);\n            }\n            // add changes column\n            let td=$(\"<td class='hideCopy'>\").appendTo(tr);\n            if ( both != 2) {\n                // not included in both docs - no need to show changes between\n                if (existsInFirst) {\n                    td.html( \"deleted/excluded\" );\n                } else {\n                    td.html( \"added/included\" );\n                }\n            } else if ( afterIdx != beforeIdx) {\n                let compare = $(\"<span class='showMore' data-item='\"+ft+\"' data-v0=\"+beforeIdx+\" data-v1=\"+afterIdx+\">compare versions</span>\");\n                tr.addClass(\"changed\");\n                td.append(compare);\n\n            } else {\n                td.html( \"no changes\" );\n                tr.addClass(\"unchanged\");\n            }\n        });\n\n    }\n\n}\n\n\nfunction initialize() {\n    plugins.register(new Redlining());\n}\n\n","import {\n    IDHFSection,\n    IDHFControlDefinition,\n    IDHFSectionOptions,\n    DocumentSectionType\n} from \"../../../common/businesslogic/index\";\nimport { IBaseControlOptions } from \"../../../common/UI/Controls/BaseControl\";\nimport {IDocFieldHandler} from \"../../../common/businesslogic/FieldHandlers/Document/IDocFieldHandler\";\nimport {BaseDHFSection} from \"./BaseDHFSection\";\nimport {GenericFieldHandler} from \"../../../common/businesslogic/FieldHandlers/GenericFieldHandler\";\nimport {SectionDescriptions} from \"../../../common/businesslogic/FieldHandlers/Document/SectionDescriptions\";\nimport {GenericDocFieldHandler} from \"../../../common/businesslogic/FieldHandlers/Document/GenericDocFieldHandler\";\n\nexport { Hidden };\n\nclass Hidden extends BaseDHFSection<IDHFSectionOptions> implements IDHFSection {\n\n    renderControl(ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions){ ctrl.control.hidden(ctrlParameter); }\n\n    showSpecificSettings(ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions, custom:JQuery){}\n    async saveSpecificSettingsAsync(ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions, custom:JQuery){return false}\n    async verifyContentAsync(ctrl: IDHFControlDefinition) {}\n}\n","import {IDHFControlDefinition} from \"../../../common/businesslogic\";\nimport {IBaseControlOptions} from \"../../../common/UI/Controls/BaseControl\";\nimport {IDocFieldHandler} from \"../../../common/businesslogic/FieldHandlers/Document/IDocFieldHandler\";\n\nexport class BaseDHFSection<T> {\n\n    fieldHandler: IDocFieldHandler;\n\n    getFieldHandler(): IDocFieldHandler {\n        return  this.fieldHandler\n    }\n    renderControl(ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions) {\n        ctrl.control.checkBox(ctrlParameter);\n    }\n\n    setFieldHandler(fieldHandler: IDocFieldHandler): void {\n        this.fieldHandler = fieldHandler;\n    }\n\n\n\n    getConfig(ctrl: IDHFControlDefinition): T {\n        let controllerConfig = this.fieldHandler.dhfFieldConfig;\n        if (!controllerConfig) {\n            controllerConfig = this.fieldHandler.getDefaultConfig()\n        }\n        return <T>controllerConfig;\n    }\n\n\n}\n","/**\n * Matrix stores data for each item field in a serialized, structured format defined\n * by the type of field. A FieldHandler is a class that allows safe creation and\n * manipulation of these structured types.\n */\nimport {FieldDescriptions} from \"./../FieldDescriptions\";\nimport {EmptyFieldHandler} from \"./EmptyFieldHandler\";\nimport {RichtextFieldHandler} from \"./RichtextFieldHandler\";\nimport {TextlineFieldHandler} from \"./TextlineFieldHandler\";\nimport {CheckboxFieldHandler} from \"./CheckboxFieldHandler\";\nimport {initialize as initializeSteplist, SteplistFieldHandler} from \"./SteplistFieldHandler\";\nimport { ItemConfiguration, XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {GenericFieldHandler} from \"./GenericFieldHandler\";\nimport {DropdownFieldHandler, IBaseDropdownFieldParams} from \"./DropdownFieldHandler\";\nimport {TestStepsFieldHandler} from \"./TestStepsFieldHandler\";\nimport {TestStepsResultFieldHandler} from \"./TestStepsResultFieldHandler\";\nimport {TestResultFieldHandler} from \"./TestResultFieldHandler\";\nimport { UserFieldHandler } from \"./UserFieldHandler\";\nimport {DateFieldHandler} from \"./DateFieldHandler\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nimport {GateFieldHandler, IBaseGateOptions} from \"./GateFieldHandler\";\nimport { ITableControlBaseParams } from \"./BaseTableFieldHandler\";\nimport { ITestFieldParam, TestManagerConfiguration } from \"../TestManagerConfiguration\";\nimport { HyperlinkFieldHandler } from \"./HyperlinkFieldHandler\";\nimport { CrosslinksFieldHandler } from \"./CrosslinksFieldHandler\";\nimport {DHFFieldHandler} from \"./DHFFieldHandler\";\nimport {IDHFControlDefinition} from \"../DHFInterfaces\";\n\nexport * from \"./BaseTableFieldHandler\";\nexport * from \"./BaseValidatedTableFieldHandler\";\nexport * from \"./CheckboxFieldHandler\";\nexport * from \"./DHFFieldHandler\";\nexport * from \"./DropdownFieldHandler\";\nexport * from \"./EmptyFieldHandler\";\nexport * from \"./GenericFieldHandler\";\nexport * from \"./SteplistFieldHandler\";\nexport * from \"./TextlineFieldHandler\";\nexport * from \"./TestStepsFieldHandler\";\nexport * from \"./TestStepsResultFieldHandler\";\nexport * from \"./TestResultFieldHandler\";\nexport * from \"./UserFieldHandler\";\nexport * from \"./DateFieldHandler\";\nexport * from \"./ItemSelectionFieldHandler\";\nexport * from \"./CrosslinksFieldHandler\";\nexport * from \"./HyperlinkFieldHandler\";\nexport * from \"./RichtextFieldHandler\";\n\nexport function InitializeFieldHandlers() {\n    initializeSteplist();\n}\n\n\n// TODO(modules): At the moment, handling of structured data is spread all over the client\n// code base. We'd like to get all the data manipulation into these classes, separating\n// that code from say, UI code.\n\n\nexport class FieldHandlerFactory {\n    public static UpdateFieldConfig(itemConfig: ItemConfiguration, testConfig: TestManagerConfiguration, fieldType: string, itemType: string, fieldValue: string, config: XRFieldTypeAnnotatedParamJson) {\n        switch (fieldType) {\n            case FieldDescriptions.Field_test_steps:\n                TestStepsFieldHandler.UpdateFieldConfig(config, itemType, testConfig);\n                break;\n            case FieldDescriptions.Field_test_steps_result:\n                TestStepsResultFieldHandler.UpdateFieldConfig(config, testConfig);\n                break;\n            case FieldDescriptions.Field_test_result:\n                TestResultFieldHandler.UpdateFieldConfig(<IBaseDropdownFieldParams>config, testConfig);\n                break;\n            case FieldDescriptions.Field_user:\n                UserFieldHandler.UpdateFieldConfig(<ITestFieldParam>config, fieldValue, itemConfig);\n                break;\n            case FieldDescriptions.Field_crosslinks:\n                CrosslinksFieldHandler.UpdateFieldConfig(config);\n                break;\n            default:\n                break;\n        }\n    }\n\n    public static CreateHandler(itemConfig: ItemConfiguration, fieldType: string, config: XRFieldTypeAnnotatedParamJson): IFieldHandler {\n        const description = FieldDescriptions.findById(fieldType);\n        if (!description) {\n            // Do not throw an error here, because this is called for every field on every item...\n            // see MATRIX-5683 for discussion on this issue. Some installations may contains\n            // plugins that implement field handlers, but we don't have that information here.\n            // User changes the data (string/json/etc) at their own risk.\n            return new GenericFieldHandler(fieldType, config);\n        }\n        switch (description.id) {\n            case FieldDescriptions.Field_tasksControl:\n            case FieldDescriptions.Field_section:\n            case FieldDescriptions.Field_links:\n            case FieldDescriptions.Field_uplinkinfo:\n            case FieldDescriptions.Field_labels:\n            case FieldDescriptions.Field_workflow:\n            case FieldDescriptions.Field_syncStatus:\n            case FieldDescriptions.Field_syncSourceInfo:\n                return new EmptyFieldHandler(description.id, config);\n\n            case FieldDescriptions.Field_textline:\n                return new TextlineFieldHandler(config);\n\n            case FieldDescriptions.Field_richtext:\n                return new RichtextFieldHandler(config);\n\n            case FieldDescriptions.Field_checkbox:\n                return new CheckboxFieldHandler(config);\n\n            // Table-like handlers\n            case FieldDescriptions.Field_steplist:\n                return new SteplistFieldHandler(<ITableControlBaseParams>config);\n            case FieldDescriptions.Field_test_steps:\n                return new TestStepsFieldHandler(<ITableControlBaseParams>config);\n            case FieldDescriptions.Field_test_steps_result:\n                return new TestStepsResultFieldHandler(<ITableControlBaseParams>config);\n\n            // Dropdown-like field handlers\n            case FieldDescriptions.Field_dropdown:\n                return new DropdownFieldHandler(<IBaseDropdownFieldParams> config );\n            case FieldDescriptions.Field_user:\n                return new UserFieldHandler(<IBaseDropdownFieldParams>config);\n            case FieldDescriptions.Field_test_result:\n                return new TestResultFieldHandler(<IBaseDropdownFieldParams>config);\n            case FieldDescriptions.Field_date:\n                return new DateFieldHandler(config);\n            case FieldDescriptions.Field_gateControl:\n                return new GateFieldHandler(<IBaseGateOptions>config);\n            case FieldDescriptions.Field_crosslinks:\n                return new CrosslinksFieldHandler(config);\n            case FieldDescriptions.Field_hyperlink:\n                return new HyperlinkFieldHandler(config);\n            case FieldDescriptions.Field_dummy:\n                return new EmptyFieldHandler(fieldType, config);\n            case FieldDescriptions.Field_dhf:\n                return new DHFFieldHandler(itemConfig, <IDHFControlDefinition>config);\n            case FieldDescriptions.Field_colorPicker:\n            case FieldDescriptions.Field_sourceref:\n            case FieldDescriptions.Field_markAsTemplate:\n            case FieldDescriptions.Field_docFilter:\n            case FieldDescriptions.Field_text:\n            case FieldDescriptions.Field_fileManager:\n            case FieldDescriptions.Field_risk2:\n            case FieldDescriptions.Field_report:\n            case FieldDescriptions.Field_cascadingSelect:\n            case FieldDescriptions.Field_reportId:\n            case FieldDescriptions.Field_filter_file:\n            case FieldDescriptions.Field_signature:\n            case FieldDescriptions.Field_signatureControl:\n            case FieldDescriptions.Field_publishedContent:\n            case FieldDescriptions.Field_reviewControl:\n            default:\n                return new GenericFieldHandler(fieldType, config);\n        }\n    }\n\n}\nexport {ItemSelectionFieldHandlerFromTo} from \"./ItemSelectionFieldHandlerFromTo\";\n","import { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nexport { EmptyFieldHandler };\n\nclass EmptyFieldHandler implements IFieldHandler {\n    private fieldType: string;\n    private config: XRFieldTypeAnnotatedParamJson;\n\n    constructor(fieldTypeIn: string, configIn: XRFieldTypeAnnotatedParamJson) {\n        this.fieldType = fieldTypeIn;\n        this.config = configIn;\n    }\n\n    getFieldType(): string { return this.fieldType; }\n\n    initData(serializedFieldData: string) { }\n    getData(): string { return \"\"; }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nexport { RichtextFieldHandler };\n\nclass RichtextFieldHandler implements IFieldHandler {\n    private data: string = \"\";\n    private config: XRFieldTypeAnnotatedParamJson;\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson) {\n        this.config = configIn;\n    }\n\n    getFieldType(): string { return FieldDescriptions.Field_richtext; }\n\n    // TODO: is there more to richtext than just an html string?\n    initData(serializedFieldData: string) { this.data = serializedFieldData; }\n    getData(): string { return this.data; }\n    getHtml(): string { return this.data; }\n    setHtml(str: string): RichtextFieldHandler {\n        this.data = str;\n        return this;\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nexport { TextlineFieldHandler };\n\nclass TextlineFieldHandler implements IFieldHandler {\n    private data = \"\";\n    private config: XRFieldTypeAnnotatedParamJson;\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson) {\n        this.config = configIn;\n    }\n\n    getFieldType(): string { return FieldDescriptions.Field_textline; }\n\n    initData(serializedFieldData: string) { this.data = serializedFieldData; }\n    getData(): string { return this.data; }\n\n    getText(): string { return this.data; }\n    setText(str: string) {\n        // make sure there are no newlines.\n        this.data = str.replace(\"\\n\", \"\");\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nexport { CheckboxFieldHandler };\n\nclass CheckboxFieldHandler implements IFieldHandler {\n    private data: string;\n    private config: XRFieldTypeAnnotatedParamJson;\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson) {\n        this.config = configIn;\n    }\n\n    getFieldType(): string { return FieldDescriptions.Field_checkbox; }\n\n    initData(serializedFieldData: string) {\n        this.data = serializedFieldData;\n    }\n\n    getData(): string {\n        return this.data;\n    }\n\n    getValue(): boolean | undefined {\n        if (this.data) {\n            if (this.data == \"1\" || this.data == \"true\") {\n                return true;\n            } else if (this.data == \"0\" || this.data == \"false\") {\n                return false;\n            }\n        }\n        return undefined;\n    }\n\n    setValue(value: boolean) {\n        if (value !== undefined) {\n            this.data = value ? \"true\" : \"false\";\n        } else {\n            this.data = undefined;\n        }\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {  ITableControlBaseParams } from \"./BaseTableFieldHandler\";\nimport {BaseValidatedTableFieldHandler} from \"./BaseValidatedTableFieldHandler\";\n\nexport { initialize, SteplistFieldHandler };\n\nclass SteplistFieldHandler extends BaseValidatedTableFieldHandler {\n    constructor(configIn: ITableControlBaseParams) {\n        super(configIn);\n    }\n}\n\nfunction validateTableControlParams(json: ITableControlBaseParams): Promise<string | null> {\n    return new Promise((resolve) => {\n        if (!json.columns || json.columns.length == 0) {\n            resolve(\"There are no columns defined. You need at least one column!\");\n        }\n        const validXmlRegex = /^([_a-z][\\w]?|[a-w_yz][\\w]{2,}|[_a-z][a-l_n-z\\d][\\w]+|[_a-z][\\w][a-k_m-z\\d][\\w]*)$/i;\n        // check for bad column field properties\n        let badFields: string[] = [];\n        json.columns.forEach(function (column, idx) {\n            if (!column.field) {\n                badFields.push(\"Column \" + (idx + 1) + \" needs a field property\");\n            } else if (!column.field.match(validXmlRegex)) {\n                badFields.push(\"The field of column \" + (idx + 1) + \": ' \" + column.field + \"' needs to be a valid XML element name.\");\n            }\n            if (column.options) {\n                for (let option in column.options) {\n                    if (!option.match(validXmlRegex)) {\n                        badFields.push(\"The option '\" + option + \"' of field of column \" + (idx + 1) + \": ' \" + column.field + \"' needs to be a valid XML element name.\");\n                    }\n                }\n            }\n        });\n\n        if (badFields.length) {\n            resolve(badFields.join(\"<br>\"));\n        }\n\n        resolve(null);\n    });\n}\n\nfunction initialize() {\n    FieldDescriptions.setValidationFunction(FieldDescriptions.Field_steplist,\n        validateTableControlParams);\n}\n","// A field handler base implementation for field types that ultimately are displayed\n// by the table control.\n\nimport { IDropdownOption } from \"../../../ProjectSettings\";\nimport { FieldDescriptions } from \"../FieldDescriptions\";\nimport {BaseTableFieldHandler, ITableControlBaseParams} from \"./BaseTableFieldHandler\";\nimport {IFieldHandler} from \"./IFieldHandler\";\n\nexport {  BaseValidatedTableFieldHandler };\n\n class BaseValidatedTableFieldHandler extends  BaseTableFieldHandler {\n\n    constructor(configIn: ITableControlBaseParams) {\n        super(configIn);\n    }\n\n\n    validate() {\n        // Data should be an array.\n        if (typeof this.data.length == 'undefined') {\n            throw new Error(\"data is not an array of rows\");\n        }\n\n        for (let row of this.data) {\n            // Each row has a property name for each column.\n            for (const fieldId in row) {\n                let colDetails = this.getColumnByField(fieldId)\n                if (!colDetails) {\n                    throw new Error(`Unable to find definition for column with field id ${fieldId}`);\n                }\n                // TODO: validate the type of the field data.\n            }\n        }\n    }\n\n    setData(dataIn: any[],fixData=false) {\n        const oldData = this.data;\n        if( fixData ) {\n            for (let row of this.data) {\n                // Each row has a property name for each column.\n                for (const colId in row) {\n                    let colDetails = this.getColumnByField(colId)\n                    if (!colDetails) {\n                       delete row[colId];\n                    }\n                }\n            }\n        }\n        this.data = dataIn;\n        this.validate()\n    }\n}\n","// A field handler base implementation for field types that ultimately are displayed\n// by the table control.\n\nimport { IDropdownOption } from \"../../../ProjectSettings\";\nimport { FieldDescriptions } from \"../FieldDescriptions\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nimport {IAnyMap} from \"../../../globals\";\nimport {ITableRow} from \"../../UI/Controls/tableCtrl\";\n\nexport { ColumnEditor, BaseTableFieldHandler };\nexport type { ITableControlOptionsColumn, ITableControlBaseParams };\n\n// A steplist has a table with different column types. They are defined here and interpreted in the table\n// control and field configuration options.\nenum ColumnEditor {\n    none = \"none\",\n    number = \"number\",\n    textline = \"textline\",\n    select = \"select\",\n    commentlog = \"commentlog\",\n    colorPicker = \"colorPicker\",\n    category = \"category\",\n    readonly = \"readonly\",\n    selectIcon = \"selectIcon\",\n    text = \"text\",\n    date_today = \"date_today\",\n    date = \"date\",\n    today = \"today\",\n    current_version = \"current_version\",\n    versionletter = \"versionletter\",\n    signaturemeaning = \"signaturemeaning\",\n    user = \"user\",\n    user_self = \"user_self\",\n    self = \"self\",\n    group = \"group\",\n    revision = \"revision\",\n    result = \"result\",\n    design = \"design\",\n    uprules = \"uprules\",\n    downrules = \"downrules\",\n    ecocapa = \"ecocapa\",\n    eco = \"eco\",\n    uid = \"uid\",\n    rules = \"rules\",\n}\n\ninterface ITableControlOptionsColumn {\n    name: string, //the name of the column shown in the table header\n    field: string, //the id in the column / of the this.data\n    editor: ColumnEditor, //  (optional) 'text','result' (if and how to edit the cell). , ...\n    options?: { [key: string]: string } | IDropdownOption[] // for select editor\n    relativeWidth?: number // can be used to start with unevenly spaced columns (default is 350)\n    headerCssClass?: string // Accepts a string as a class name, applies that class to the cell for the column header.\n    cssClass?: string // Accepts a string as a class name, applies that class to every row cell in the column.\n}\n\ninterface ITableControlBaseParams {\n    columns?: ITableControlOptionsColumn[], // columns to be added [{name, field, editor, values}], list of column definitions:\n}\n\nclass BaseTableFieldHandler implements IFieldHandler {\n    protected data: any[] = [];\n    protected tableConfig: ITableControlBaseParams;\n\n    constructor(configIn: ITableControlBaseParams) {\n        this.tableConfig = <ITableControlBaseParams>configIn;\n    }\n\n    getFieldType(): string {\n        return FieldDescriptions.Field_steplist;\n    }\n\n    protected getColumnByField(fieldId: string): ITableControlOptionsColumn | undefined {\n        if( this.tableConfig.columns){\n            const cols = this.tableConfig.columns.filter((col) => col.field == fieldId);\n            if (cols.length >= 1) {\n                return cols[0];\n            }\n        }\n        return undefined;\n    }\n\n    columnNumberToFieldId(columnNumber: number): string {\n        if (columnNumber >= this.tableConfig.columns.length) {\n            throw new Error(`${columnNumber} is outside the range [0..${this.tableConfig.columns.length}]`);\n        }\n        return this.tableConfig.columns[columnNumber].field;\n    }\n\n    validate() {\n        // No validation by default\n    }\n\n    initData(serializedFieldData: string) {\n        if (!serializedFieldData) {\n            this.data = [];\n        } else {\n            // This requirement to remove <div> tags comes from the table control implementation.\n            this.data = JSON.parse(serializedFieldData.replace(\"<div/>\", \"\"));\n        }\n    }\n\n    getData(): string {\n        return JSON.stringify(this.data);\n    }\n\n    setData(dataIn: any[],fixData=false) {\n        this.data = dataIn;\n    }\n\n    getRowCount(): number {\n        return this.data.length;\n    }\n\n    deleteRow(rowNumber: number) {\n        if (rowNumber >= this.data.length) {\n            throw new Error(`Row ${rowNumber} not found`);\n        }\n        this.data.splice(rowNumber, 1);\n        this.validate();\n    }\n\n    insertRow(rowNumber: number, columnData: Array<any>) {\n        // Construct a row object from the column data\n        let o = {};\n        columnData.forEach((v, i) => {\n            o[this.columnNumberToFieldId(i)] = v;\n        });\n        this.data.splice(rowNumber, 0, o);\n        this.validate();\n    }\n\n    clear() {\n        this.data = [];\n    }\n\n    getColumnCount(): number {\n        let columnCount = 0;\n        if (this.tableConfig.columns) {\n            columnCount = this.tableConfig.columns.length;\n        }\n        return columnCount;\n    }\n\n    /**\n     * Set data for a particular cell in the table given by a row number and\n     * a column name.\n     * @param row the zero-based row number.\n     * @param columnId the column name.\n     * @param data\n     */\n    setColumnData(row: number, columnId: string, data: any) {\n        // Create rows if necessary.\n        if (this.data.length <= row) {\n            for (let i = this.data.length; i <= row; i++) {\n                this.data.push({});\n            }\n        }\n        // TODO: there should be a switch statement here on type. Complex types may\n        // be JSON objects and should be parsed.\n        this.data[row][columnId] = data;\n    }\n\n    getColumnData(row: number, columnId: string): any {\n        // TODO: there should be a switch statement here on type. Complex types may\n        // be JSON objects and should be parsed.\n        return this.data[row][columnId];\n    }\n\n    getRowData(row: number): Array<any> {\n        let result = [];\n        for (let i = 0; i < this.getColumnCount(); i++) {\n            const columnId = this.columnNumberToFieldId(i);\n            result[i] = this.getColumnData(row, columnId);\n        }\n        return result;\n    }\n}\n","import { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nexport { GenericFieldHandler };\n\nclass GenericFieldHandler implements IFieldHandler {\n    protected fieldType: string;\n    protected data: string;\n    private config: XRFieldTypeAnnotatedParamJson;\n\n    constructor(fieldTypeIn: string, configIn: XRFieldTypeAnnotatedParamJson) {\n        this.fieldType = fieldTypeIn;\n        this.config = configIn;\n    }\n\n    getFieldType(): string { return this.fieldType; }\n\n    initData(serializedFieldData: string) { this.data = serializedFieldData; }\n    getData(): string { return this.data; }\n}\n","import {FieldDescriptions} from \"../FieldDescriptions\";\nimport {IDropdownOption} from \"../../../ProjectSettings\";\nimport {IFieldHandler} from \"./IFieldHandler\";\n\nexport interface IBaseDropdownFieldParams{\n    splitHuman?: boolean;\n    maxItems?: number,\n    create?: boolean, // true if values can be added\n    options?: IDropdownOption[] // list of options to choose from\n    optionSetting?: string, // can be name of project setting with options and groups\n}\nexport class DropdownFieldHandler implements IFieldHandler {\n    private rawData = \"\";\n    private human = \"\";\n\n    protected params: IBaseDropdownFieldParams;\n    getData(): string {\n        return this.rawData;\n    }\n\n    constructor (params: IBaseDropdownFieldParams, initialValue?:string){\n        this.params = params;\n       this.initData(initialValue);\n    }\n    getFieldType(): string {\n        return FieldDescriptions.Field_dropdown;\n    }\n\n    initData(serializedFieldData: string) {\n        this.rawData = serializedFieldData;\n        let that = this;\n        if (typeof serializedFieldData === 'undefined') {\n            serializedFieldData = \"\";\n        }\n        if (this.params && this.params.splitHuman) {\n            let split = serializedFieldData.split(\"|\");\n            this.rawData = split[0];\n            this.human = split[split.length - 1];\n        } else {\n            this.rawData = serializedFieldData;\n            if( this.params && this.params.options) {\n                const data = that.getData();\n                for (let value of this.params.options) {\n                    if (data && value.id === data) {\n                        that.human = value.label;\n                    }\n                }\n            }\n        }\n    }\n\n\n    /**\n     * Retrieve the current value of the field, formatted as an array.\n     * If there are N current values, the array will have N items.\n     * @param filterOnOptions true if you only want to get back values that show up\n     *     in the options list.\n     * @returns an array. Empty if there is no current value.\n     */\n    getValues(filterOnOptions = true): string[] {\n        if (this.rawData != undefined || this.rawData!= null) {\n            let values = this.rawData.split(\",\");\n            if (filterOnOptions && this.params && !this.params.create ) {\n                return values.filter((value) => {\n                    return this.params.options.some((option) => {\n                        return option.id === value;\n                    });\n                });\n            } else {\n                // When creating new values, we don't want to return empty value like this : [\"\"] but []\n                if( this.params && this.params.create && this.rawData === \"\")\n                    return [];\n                else\n                    return values;\n            }\n        }\n\n        return [];\n    }\n    getHuman() {\n        return this.human;\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport { TestManagerConfiguration } from \"../TestManagerConfiguration\";\nimport {  ITableControlBaseParams } from \"./BaseTableFieldHandler\";\nimport {BaseValidatedTableFieldHandler} from \"./BaseValidatedTableFieldHandler\";\n\nexport { TestStepsFieldHandler };\n\nclass TestStepsFieldHandler extends BaseValidatedTableFieldHandler {\n\n    public static UpdateFieldConfig(options: XRFieldTypeAnnotatedParamJson, itemType: string, testConfig: TestManagerConfiguration) {\n        // This field handler gets it's configuration options from the test manager.\n        // Ignore input options completely.\n        const rconfig = testConfig.getTestStepsConfig(itemType);\n        for (let name in rconfig) {\n            options[name] = rconfig[name];\n        }\n    }\n\n    constructor(options: ITableControlBaseParams) {\n        super(options);\n    }\n\n    getFieldType(): string {\n        return FieldDescriptions.Field_test_steps;\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport { TestManagerConfiguration } from \"../TestManagerConfiguration\";\nimport {  ITableControlBaseParams } from \"./BaseTableFieldHandler\";\nimport {BaseValidatedTableFieldHandler} from \"./BaseValidatedTableFieldHandler\";\n\nexport { TestStepsResultFieldHandler };\n\nclass TestStepsResultFieldHandler extends BaseValidatedTableFieldHandler {\n    public static UpdateFieldConfig(options: XRFieldTypeAnnotatedParamJson, testConfig: TestManagerConfiguration) {\n        // This field handler gets it's configuration options from the test manager.\n        const rconfig = testConfig.getTestStepsResultsConfig();\n        for (let name in rconfig) {\n            options[name] = rconfig[name];\n        }\n    }\n\n    constructor(options: ITableControlBaseParams) {\n        super(options);\n    }\n\n    getFieldType(): string {\n        return FieldDescriptions.Field_test_steps_result;\n    }\n\n    validate() {\n        // TODO: validation for this kind of table is more difficult.\n        // There is a property \"passFailEditorConfig\" on the options that needs to\n        // be looked at.\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { TestManagerConfiguration } from \"../TestManagerConfiguration\";\nimport { IBaseDropdownFieldParams } from \"./DropdownFieldHandler\";\nimport {IFieldHandler} from \"./IFieldHandler\";\n\nexport { TestResultFieldHandler };\n\n// TODO: This is configuring a dropdown control. It should be possible to combine this code\n// with the DropdownFieldHandler code.\nclass TestResultFieldHandler implements IFieldHandler {\n    private rawData = \"\";\n    private human = \"\";\n    private params: IBaseDropdownFieldParams;\n\n\n    public static UpdateFieldConfig(params: IBaseDropdownFieldParams, testConfig: TestManagerConfiguration) {\n        // There are default params for dropdown for test results\n\n        params.maxItems = 1 // maxItems which can be selected\n        params.options = [], // options in dropdown  [{id:..., label: ...}]\n        params.create = false, // true if values can be added\n        params.splitHuman = true // if human values differ from real values (e.g. for XTCs which are passed|ok|p (only the fist part is interesting).\n\n\n        // This field handler gets its configuration options from the test manager.\n        params.options = testConfig.getTestRunResultOptions();\n    }\n\n    constructor(params: IBaseDropdownFieldParams, initialValue?: string) {\n        this.params = params;\n        this.initData(initialValue);\n    }\n\n    getFieldType(): string {\n        return FieldDescriptions.Field_test_result;\n    }\n\n    getData(): string {\n        return this.rawData;\n    }\n\n    initData(serializedFieldData: string) {\n        this.rawData = serializedFieldData;\n        let that = this;\n        if (typeof serializedFieldData === 'undefined') {\n            serializedFieldData = \"\";\n        }\n        if (this.params.splitHuman) {\n            let split = serializedFieldData.split(\"|\");\n            this.rawData = split[0];\n            this.human = split[split.length - 1];\n        } else {\n            this.rawData = serializedFieldData;\n            const data = that.getData();\n            for (let value of this.params.options) {\n                if (value.id === data) {\n                    that.human = value.label;\n                }\n            }\n        }\n    }\n\n    getValues(filterOnOptions = true): string[] {\n        if (this.rawData) {\n            let values = this.rawData.split(\",\");\n            if (filterOnOptions && !this.params.create) {\n                return values.filter((value) => {\n                    return this.params.options.some((option) => {\n                        return option.id === value;\n                    });\n                });\n            } else {\n                return values;\n            }\n        }\n\n        return [];\n    }\n\n    getHuman() {\n        return this.human;\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { IBaseDropdownFieldParams } from \"./DropdownFieldHandler\";\nimport { ItemConfiguration, XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\n\nimport {IFieldHandler} from \"./IFieldHandler\";\nimport { BasicFunctions } from \"../BasicFunctions\";\nimport { ITestFieldParam } from \"../TestManagerConfiguration\";\n\n// TODO: UserFieldHandler is a lot like DropdownFieldHandler. Combine them somehow.\nexport class UserFieldHandler implements IFieldHandler {\n\n    // TODO: IDropdownParams is too broad. Use a narrower type\n    public static UpdateFieldConfig(params: ITestFieldParam, fieldValue: string, itemConfig: ItemConfiguration) {\n\n        let userDropdown = itemConfig.getValidUserOptions(\n            !BasicFunctions.isFalse(params.showUsers), // by default show users, if not specified\n            BasicFunctions.isTrue(params.showGroups),  // by default do not show groups\n            undefined,\n            fieldValue);                           // special treatment for deleted users\n\n        params.create = false;\n\n        // TODO: WARNING ! ERROR ! BUG ! This is altering the params object stored in the item configuration\n        // where it was originally retrieved from. We need a clone operation by the caller to stop doing this, however,\n        // I'm wondering if we have code that relies on these things being updated.\n\n        params.options = userDropdown;\n        params.maxItems = params.maxItems ? params.maxItems : 1;\n    }\n\n    private rawData = \"\";\n    private human = \"\";\n\n    private params: IBaseDropdownFieldParams;\n    getData(): string {\n        return this.rawData;\n    }\n\n    constructor(params: IBaseDropdownFieldParams, initialValue?: string) {\n        this.params = params;\n        this.initData(initialValue);\n    }\n    getFieldType(): string {\n        return FieldDescriptions.Field_user;\n    }\n\n    initData(serializedFieldData: string) {\n        if (typeof serializedFieldData === 'undefined') {\n            serializedFieldData = \"\";\n        }\n        if (this.params.splitHuman) {\n            let split = serializedFieldData.split(\"|\");\n            this.rawData = split[0];\n            this.human = split[split.length - 1];\n        } else {\n            this.rawData = serializedFieldData;\n            const data = this.getData();\n            for (let value of this.params.options) {\n                if (value.id === data) {\n                    // TODO: what to do about \"human\" when there are multiple values?\n                    this.human = value.label;\n                }\n            }\n        }\n    }\n\n    getValues(filterOnOptions = true): string[] {\n        if (this.rawData) {\n            let values = this.rawData.split(\",\");\n            if (filterOnOptions && !this.params.create) {\n                return values.filter((value) => {\n                    return this.params.options.some((option) => {\n                        return option.id === value;\n                    });\n                });\n            } else {\n                return values;\n            }\n        }\n\n        return [];\n    }\n\n    private getMaxItems(): number | undefined {\n        if (this.params.maxItems) {\n            return Number(this.params.maxItems);\n        }\n        return undefined;\n    }\n\n    setValues(values: string[]) {\n        const maxItems = this.getMaxItems();\n\n        if (maxItems && maxItems < values.length) {\n            throw new Error(`The field may only store ${maxItems} items`);\n        }\n\n        if (!this.params.create) {\n            // Validate against the existing options.\n            // TODO: validation should probably be in a central method checked by\n            // setData().\n            for (let value of values) {\n                if (!this.params.options.some(o => o.id === value)) {\n                    throw new Error(`Value ${value} not found in accepted options`);\n                }\n            }\n        }\n        this.initData(values.join());\n    }\n\n    getHuman() {\n        return this.human;\n    }\n}\n","/**\n * Basic Functions can be referred to by other businesslogic modules and elsewhere,\n * however it should only import the absolute minimum necessary dependencies.\n * It supports the Matrix SDK, which runs in non-web environments.\n */\nexport { BasicFunctions };\nclass BasicFunctions {\n    static isTrue(obj: undefined | null | boolean | string | number): boolean {\n        if (obj && (obj.toString().toLowerCase() === \"true\" || obj.toString() === \"1\")) {\n            return true;\n        }\n        return false;\n    }\n\n    static isFalse(obj: undefined | null | boolean | string | number): boolean {\n        if (typeof obj == \"undefined\") {\n            return false;\n        }\n        if (obj == false || obj == 0 || obj.toString().toLowerCase() === \"false\" || obj.toString() === \"0\") {\n            return true;\n        }\n        return false;\n    }\n}\n","import {IAnyMap} from \"../../../globals\";\nimport {IFieldHandler} from \"./IFieldHandler\";\nimport {FieldDescriptions} from \"../FieldDescriptions\";\n\nexport interface IDateSelectParamsBase {\n    minDate?: Date;\n}\nexport class DateFieldHandler implements IFieldHandler {\n    private date: Date;\n    constructor(config: IAnyMap) {\n        this.date = undefined;\n    }\n\n    getData(): string {\n        if(!this.date) {\n            return \"\";\n        }\n        return this.date.getFullYear() + \"/\" + (this.date.getMonth() + 1) + \"/\" + this.date.getDate();\n    }\n\n    getFieldType(): string {\n        return FieldDescriptions.Field_date;\n    }\n\n    initData(serializedFieldData: string) {\n            if (!serializedFieldData)\n                return;\n            let date = DateFieldHandler.getDateFromString( serializedFieldData );\n            if (date) {\n                this.date = date;\n            } else {\n                this.date = undefined;\n            }\n    }\n    static getDateFromString( dateStr :string ) {\n        if (dateStr) {\n            let split: string[] = (dateStr).split(\"/\");\n            if (split.length === 3 && split[0] !== \"NaN\") {\n                let date = new Date(parseInt(split[0]), parseInt(split[1]) - 1, parseInt(split[2]));\n                return date;\n            }\n        }\n        return null;\n    }\n\n    setDate(date: Date) {\n        this.date = date;\n    }\n    getDate(): Date {\n        return this.date;\n    }\n}\n","import {IFieldHandler} from \"./IFieldHandler\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../ItemConfiguration\";\nimport {FieldDescriptions} from \"../FieldDescriptions\";\n\nexport interface IBaseGateOptions{\n    /** define different reviews/approvals which need to be made for gate to pass */\n    lines:IGateLineBase[],\n}\nexport interface  IGateLineBase {\n    /** a unique id for the line */\n    id:string, // unique id of line\n    /** define which users can approve */\n    users:string[],\n}\n\n\n// save status of gate programmable and searchable\nexport interface IGateStatus {\n    passed:boolean, // all lines passed\n    failed:boolean, // 1+ failed\n    lines:IGateStatusLine[],\n    search:string /*\n        _passed_ (all lines passed)\n        _failed_ (one line failed)\n        _todo_ (needs some action)\n        _pass_userId_ (a user passed it)\n        _fail_userId_ (a user failed it)\n        _todo_userId_ (a user needs to do something)\n\n    */\n}\n\nexport interface IGateStatusLine {\n    id:string, // same id as in IGateLine\n    passed:boolean, // last user (see below) passed\n    failed:boolean, // last user (see below) failed\n    user:string, // last user action\n    date:string, // last user date (in utc)\n    dateUser:string, // last user date (in server formatting)\n    comment:string // text\n}\n\nexport class GateFieldHandler implements IFieldHandler {\n    private config: IBaseGateOptions;\n    private allPassed: boolean;\n    private currentValue: IGateStatus;\n    constructor(config: IBaseGateOptions) {\n        // TODO: implement\n        this.config = config;\n    }\n\n    getData(): string {\n        return JSON.stringify(this.currentValue);\n    }\n\n    getFieldType(): string {\n        return FieldDescriptions.Field_gateControl;\n    }\n\n    initData(serializedFieldData: string) {\n        this.currentValue = this.parseFieldValue( serializedFieldData );\n    }\n    private defautValue:IGateStatus = {\n        passed:false,\n        failed:false,\n        lines:[],\n        search:\"\",\n    }\n    // the field value is saved as json object\n    parseFieldValue( stored:string ):IGateStatus {\n        // default\n        let state= { ...this.defautValue};\n        // if something was saved before, use it\n        if (stored) {\n            state = JSON.parse(stored);\n        }\n\n        // remove lines which do not exist anymore (might happen if config changes)\n        let lineIds = this.config.lines.map( (lineDef) => {return lineDef.id;});\n        state.lines = state.lines.filter( (line) => { return lineIds.indexOf(line.id)!=-1;});\n\n        // add missing lines\n        let existsIds = state.lines.map( (lineValue)  => {return lineValue.id;});\n        let newLines = this.config.lines.map( (lineDef):IGateStatusLine =>  { return { // create default lines\n            id:lineDef.id,\n            passed:false,\n            failed:false,\n            user: \"\",\n            comment: \"\",\n            date:\"\",\n            dateUser:\"\"\n        }\n        }).filter( (defaultLine)=> { // filter out lines which ecist already\n            return existsIds.indexOf(defaultLine.id)==-1;\n        });\n        state.lines = state.lines.concat( newLines);\n        // update overall status and text\n        this.updateOverallStatusInternal( state );\n\n        return state;\n    }\n    updateOverallStatus(){\n        this.updateOverallStatusInternal( this.currentValue );\n    }\n   private updateOverallStatusInternal( status:IGateStatus ) {\n        let that = this;\n\n        this.allPassed = false;\n\n        status.passed = false;\n        // if one line is failed, the whole status is failed\n        status.failed = status.lines.filter( (line)=>  { return line.failed; }).length > 0;\n        if (!status.failed) {\n            // if all lines passed, the status is passed\n            status.passed = status.lines.filter( (line) =>  { return line.passed; }).length == status.lines.length;\n        }\n        // build searchable string\n        /*\n            _passed_ (all lines passed)\n            _failed_ (one line failed)\n            _todo_ (needs some action)\n            _pass_userId_ (a user passed it)\n            _fail_userId_ (a user failed it)\n            _todo_userId_ (a user needs to do something)\n        */\n\n        status.search = \"\";\n\n        if ( status.passed ) {\n            status.search += \"_passed_\";\n            this.allPassed = true;\n        } else if ( status.failed ) {\n            status.search += \"_failed_\";\n        } else {\n            status.search += \"_todo_\";\n        }\n        for(let state of status.lines) {\n            if (state.passed) {\n                status.search += \"_pass_\" + state.user + \"_\";\n            } else if (state.failed) {\n                status.search += \"_fail_\" + state.user + \"_\";\n            } else {\n                for(let lineDef of that.config.lines) {\n                    if (lineDef.id == state.id) {\n                        for(let user of lineDef.users) {\n                            status.search += \"_todo_\" + user + \"_\";\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    getGateValue() {\n        return this.currentValue;\n    }\n    setGateValue(gateValue:IGateStatus) {\n        if(!gateValue)\n            gateValue = { ...this.defautValue};\n        this.currentValue = gateValue;\n\n    }\n}\n","import { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport { IFieldHandler } from \"./IFieldHandler\";\nexport { HyperlinkFieldHandler };\n\nclass HyperlinkFieldHandler implements IFieldHandler {\n    private data: string;\n    private config: XRFieldTypeAnnotatedParamJson;\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson) {\n        this.config = configIn;\n    }\n\n    getFieldType(): string { return FieldDescriptions.Field_hyperlink; }\n\n    initData(serializedFieldData: string) {\n        this.data = serializedFieldData;\n    }\n\n    getData(): string {\n        return this.data;\n    }\n\n    getValue(): boolean | undefined {\n        if (this.data) {\n            if (this.data == \"1\" || this.data == \"true\") {\n                return true;\n            } else if (this.data == \"0\" || this.data == \"false\") {\n                return false;\n            }\n        }\n        return undefined;\n    }\n\n    setValue(value: boolean) {\n        if (value !== undefined) {\n            this.data = value ? \"true\" : \"false\";\n        } else {\n            this.data = undefined;\n        }\n    }\n}\n","import { IReference } from \"../../../globals\";\nimport { FieldDescriptions } from \"../FieldDescriptions\";\nimport { XRFieldTypeAnnotatedParamJson } from \"../ItemConfiguration\";\nimport { ItemSelectionFieldHandler } from \"./ItemSelectionFieldHandler\";\nexport { CrosslinksFieldHandler };\n\nclass CrosslinksFieldHandler extends ItemSelectionFieldHandler {\n\n    public static UpdateFieldConfig(params: XRFieldTypeAnnotatedParamJson) {\n        params.crossProject = true;\n        if (params.linkTypes == undefined) {\n            params.linkTypes = [];\n        }\n        if (params.prefix == undefined) {\n            params.prefix = \"Links\";\n        }\n    }\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson) {\n        super(configIn, FieldDescriptions.Field_crosslinks);\n    }\n\n    /**\n     * Add an item to the list at the given position\n     * @param position\n     * @param item\n     * @returns the field handler\n     * @throws Error in case a projectShortLabel doesn't exist in the item.\n     */\n    insertItem(position: number, item: IReference): CrosslinksFieldHandler {\n        if (!item.projectShortLabel) {\n            throw new Error(\"item must be a cross project link\");\n        }\n        return super.insertItem(position, item);\n    }\n\n    /**\n     * Append the given item to the end of the list of items.\n     * @param item\n     * @returns the field handler.\n     * @throws Error in case a projectShort label doesn't exist in the item.\n     */\n    appendItem(item: IReference): CrosslinksFieldHandler {\n        if (!item.projectShortLabel) {\n            throw new Error(\"item must be a cross project link\");\n        }\n        return super.appendItem(item);\n    }\n}","// A field handler base implementation for field types that ultimately are displayed\n// by the item selection control\n\nimport {IReference} from \"../../../globals\";\nimport {FieldDescriptions} from \"../FieldDescriptions\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../ItemConfiguration\";\nimport {IFieldHandler} from \"./IFieldHandler\";\n\nexport { ItemSelectionFieldHandler };\n\nclass ItemSelectionFieldHandler implements IFieldHandler {\n    protected fieldType: string;\n    protected data: string;\n    protected config: XRFieldTypeAnnotatedParamJson;\n    protected  items: IReference[];\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson, fieldTypeIn?: string) {\n        this.config = configIn;\n        if (fieldTypeIn) {\n            this.fieldType = fieldTypeIn;\n        } else {\n            // Field_links is a kind of default. This field handler is often used\n            // in cases that don't map to an item field, just to a control used\n            // to display a UI. In those cases, no one cares about the field type.\n            this.fieldType = FieldDescriptions.Field_links;\n        }\n    }\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n    getFieldType(): string { return this.fieldType; }\n\n    initData(serializedFieldData: string) {\n        this.data = serializedFieldData;\n        if( serializedFieldData)\n            this.items = JSON.parse(serializedFieldData);\n        else\n            this.items = [];\n    }\n\n    getData(): string {\n        return JSON.stringify(this.items);\n    }\n\n    getItems(): IReference[] {\n        return this.items;\n    }\n\n    getItemCount(): number {\n        return this.getItems().length;\n    }\n\n    hasItems(): boolean {\n        return this.getItemCount() > 0;\n    }\n\n    hasItem(itemId: string, projectShortLabel?: string): boolean {\n        for (let item of this.getItems()) {\n            if (item.to == itemId && item.projectShortLabel == projectShortLabel) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    insertItem(position: number, item: IReference): ItemSelectionFieldHandler {\n        if (this.hasItem(item.to, item.projectShortLabel)) {\n            const label = item.projectShortLabel ? (item.projectShortLabel + \"/\") : \"\";\n            throw new Error(`Item ${label}${item.to} is already included`);\n        }\n        let items = this.getItems();\n        items.splice(position, 0, item);\n        this.data = JSON.stringify(items);\n        return this;\n    }\n\n    appendItem(item: IReference): ItemSelectionFieldHandler {\n        const position = this.getItemCount();\n        return this.insertItem(position, item);\n    }\n\n    removeItem(position: number): ItemSelectionFieldHandler {\n        let items = this.getItems();\n        items.splice(position, 1);\n        this.data = JSON.stringify(items);\n        return this;\n    }\n\n    clear(): ItemSelectionFieldHandler {\n        let items: IReference[] = [];\n        this.data = JSON.stringify(items);\n        return this;\n    }\n\n    setItems(selectedItems: IReference[]) {\n        if(!selectedItems )\n            selectedItems = [];\n       this.items = selectedItems;\n    }\n\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n\n}\n\n","import { sanitize } from 'isomorphic-dompurify';\nimport {IDocFieldHandler} from \"./Document/IDocFieldHandler\";\nimport {GenericFieldHandler} from \"./GenericFieldHandler\";\nimport {globalMatrix, IControlDefinition} from \"../../../globals\";\nimport {FieldDescriptions} from \"../FieldDescriptions\";\nimport {GenericDocFieldHandler} from \"./Document/GenericDocFieldHandler\";\nimport {SectionDescriptions} from \"./Document/SectionDescriptions\";\nimport {DocFieldHandlerFactory} from \"./Document\";\nimport { IDHFControlDefinitionValue, IDHFSectionOptions, IDHFXMLOptions} from \"../DHFInterfaces\";\nimport {ItemConfiguration} from \"../ItemConfiguration\";\nimport {ITableRow} from \"../../UI/Controls/tableCtrl\";\nimport {extend} from \"../../matrixlib/JQueryExtendReplacement\";\n\n\n\ninterface IDHFControlDefinition extends IControlDefinition {\n    dhfValue?: IDHFControlDefinitionValue,\n    configTouched?: boolean\n}\n\nexport class DHFFieldHandler extends GenericFieldHandler {\n\n    innerDataHandler:IDocFieldHandler\n\n    constructor(private itemConfig: ItemConfiguration, private fieldConfig: IDHFControlDefinition) {\n        super(FieldDescriptions.Field_dhf, fieldConfig);\n        this.innerDataHandler = new GenericDocFieldHandler(SectionDescriptions.section_hidden,{},\"\");\n    }\n    getData(): string {\n\n        if (this.innerDataHandler == undefined || this.innerDataHandler.getFieldType() == SectionDescriptions.section_hidden) {\n            return undefined;\n        }\n        let dhfValue = {\n            type: this.innerDataHandler.getFieldType(),\n            name: this.innerDataHandler.getFieldName(),\n            fieldValueXML: \"\",\n            fieldValue: \"\"\n        };\n\n        // create the controller\n        let fieldHandler = this.innerDataHandler;\n\n        // udpate the controller values\n        dhfValue.fieldValue = fieldHandler.getData();\n        // define global options\n        let controllerConfig = extend(fieldHandler.dhfFieldConfig, fieldHandler.getDefaultConfig());\n\n        let global: IDHFSectionOptions = {\n            globalOptions: true,\n            page_break: controllerConfig['page_break'],\n            sub_section: controllerConfig['sub_section'],\n            landscape: controllerConfig['landscape'],\n            show_section_title: controllerConfig['show_section_title'],\n            automation: controllerConfig['automation']\n        };\n\n        // get specific options of control and add global as a row\n        let options: IDHFXMLOptions[] = JSON.parse(fieldHandler.getXmlValue());\n        options.push(global);\n\n        // update the xml dump\n        dhfValue.fieldValueXML = JSON.stringify(options);\n\n        dhfValue['ctrlConfig'] = controllerConfig;\n        dhfValue.name = (sanitize(dhfValue.name) + '');\n        dhfValue.name = dhfValue.name.replace(/&lt;/g, \"<\");\n\n        return JSON.stringify(dhfValue);\n\n    }\n\n    initData(fieldValue: string) {\n\n        if( fieldValue && fieldValue.length > 0 && this.itemConfig) {\n            try{\n                this.fieldConfig.dhfValue = <IDHFControlDefinitionValue>JSON.parse(fieldValue);\n            } catch (e) {\n                console.error(\"Error parsing dhfValue. Defaulting to empty\", e);\n                this.fieldConfig.dhfValue = {};\n            }\n\n\n            this.fieldConfig.dhfValue.ctrlConfig = DocFieldHandlerFactory.GetDHFFieldConfig(this.itemConfig,this.fieldConfig.dhfValue.type, this.fieldConfig.dhfValue.ctrlConfig);\n            this.setInnerFieldHandler(DocFieldHandlerFactory.createHandler( this.itemConfig, this.fieldConfig.dhfValue));\n        }\n    }\n    setInnerFieldHandler(docFieldHandler:IDocFieldHandler ){\n        this.innerDataHandler = docFieldHandler;\n\n    }\n\n}\n","module.exports = window.DOMPurify || (window.DOMPurify = require('dompurify').default || require('dompurify'));","/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.DOMPurify = factory());\n})(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    }, _typeof(obj);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (_isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var hasOwnProperty = Object.hasOwnProperty,\n      setPrototypeOf = Object.setPrototypeOf,\n      isFrozen = Object.isFrozen,\n      getPrototypeOf = Object.getPrototypeOf,\n      getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n  var freeze = Object.freeze,\n      seal = Object.seal,\n      create = Object.create; // eslint-disable-line import/no-mutable-exports\n\n  var _ref = typeof Reflect !== 'undefined' && Reflect,\n      apply = _ref.apply,\n      construct = _ref.construct;\n\n  if (!apply) {\n    apply = function apply(fun, thisValue, args) {\n      return fun.apply(thisValue, args);\n    };\n  }\n\n  if (!freeze) {\n    freeze = function freeze(x) {\n      return x;\n    };\n  }\n\n  if (!seal) {\n    seal = function seal(x) {\n      return x;\n    };\n  }\n\n  if (!construct) {\n    construct = function construct(Func, args) {\n      return _construct(Func, _toConsumableArray(args));\n    };\n  }\n\n  var arrayForEach = unapply(Array.prototype.forEach);\n  var arrayPop = unapply(Array.prototype.pop);\n  var arrayPush = unapply(Array.prototype.push);\n  var stringToLowerCase = unapply(String.prototype.toLowerCase);\n  var stringToString = unapply(String.prototype.toString);\n  var stringMatch = unapply(String.prototype.match);\n  var stringReplace = unapply(String.prototype.replace);\n  var stringIndexOf = unapply(String.prototype.indexOf);\n  var stringTrim = unapply(String.prototype.trim);\n  var regExpTest = unapply(RegExp.prototype.test);\n  var typeErrorCreate = unconstruct(TypeError);\n  function unapply(func) {\n    return function (thisArg) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return apply(func, thisArg, args);\n    };\n  }\n  function unconstruct(func) {\n    return function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return construct(func, args);\n    };\n  }\n  /* Add properties to a lookup table */\n\n  function addToSet(set, array, transformCaseFunc) {\n    var _transformCaseFunc;\n\n    transformCaseFunc = (_transformCaseFunc = transformCaseFunc) !== null && _transformCaseFunc !== void 0 ? _transformCaseFunc : stringToLowerCase;\n\n    if (setPrototypeOf) {\n      // Make 'in' and truthy checks like Boolean(set.constructor)\n      // independent of any properties defined on Object.prototype.\n      // Prevent prototype setters from intercepting set as a this value.\n      setPrototypeOf(set, null);\n    }\n\n    var l = array.length;\n\n    while (l--) {\n      var element = array[l];\n\n      if (typeof element === 'string') {\n        var lcElement = transformCaseFunc(element);\n\n        if (lcElement !== element) {\n          // Config presets (e.g. tags.js, attrs.js) are immutable.\n          if (!isFrozen(array)) {\n            array[l] = lcElement;\n          }\n\n          element = lcElement;\n        }\n      }\n\n      set[element] = true;\n    }\n\n    return set;\n  }\n  /* Shallow clone an object */\n\n  function clone(object) {\n    var newObject = create(null);\n    var property;\n\n    for (property in object) {\n      if (apply(hasOwnProperty, object, [property]) === true) {\n        newObject[property] = object[property];\n      }\n    }\n\n    return newObject;\n  }\n  /* IE10 doesn't support __lookupGetter__ so lets'\n   * simulate it. It also automatically checks\n   * if the prop is function or getter and behaves\n   * accordingly. */\n\n  function lookupGetter(object, prop) {\n    while (object !== null) {\n      var desc = getOwnPropertyDescriptor(object, prop);\n\n      if (desc) {\n        if (desc.get) {\n          return unapply(desc.get);\n        }\n\n        if (typeof desc.value === 'function') {\n          return unapply(desc.value);\n        }\n      }\n\n      object = getPrototypeOf(object);\n    }\n\n    function fallbackValue(element) {\n      console.warn('fallback value for', element);\n      return null;\n    }\n\n    return fallbackValue;\n  }\n\n  var html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']); // SVG\n\n  var svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\n  var svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']); // List of SVG elements that are disallowed by default.\n  // We still need to know them so that we can do namespace\n  // checks properly in case one wants to add them to\n  // allow-list.\n\n  var svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'fedropshadow', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\n  var mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover']); // Similarly to SVG, we want to know all MathML elements,\n  // even those that we disallow by default.\n\n  var mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\n  var text = freeze(['#text']);\n\n  var html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'xmlns', 'slot']);\n  var svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\n  var mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\n  var xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n  var MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\n\n  var ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\n  var TMPLIT_EXPR = seal(/\\${[\\w\\W]*}/gm);\n  var DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\n\n  var ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\n\n  var IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n  );\n  var IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\n  var ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n  );\n  var DOCTYPE_NAME = seal(/^html$/i);\n\n  var getGlobal = function getGlobal() {\n    return typeof window === 'undefined' ? null : window;\n  };\n  /**\n   * Creates a no-op policy for internal use only.\n   * Don't export this function outside this module!\n   * @param {?TrustedTypePolicyFactory} trustedTypes The policy factory.\n   * @param {Document} document The document object (to determine policy name suffix)\n   * @return {?TrustedTypePolicy} The policy created (or null, if Trusted Types\n   * are not supported).\n   */\n\n\n  var _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, document) {\n    if (_typeof(trustedTypes) !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n      return null;\n    } // Allow the callers to control the unique policy name\n    // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n    // Policy creation with duplicate names throws in Trusted Types.\n\n\n    var suffix = null;\n    var ATTR_NAME = 'data-tt-policy-suffix';\n\n    if (document.currentScript && document.currentScript.hasAttribute(ATTR_NAME)) {\n      suffix = document.currentScript.getAttribute(ATTR_NAME);\n    }\n\n    var policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n    try {\n      return trustedTypes.createPolicy(policyName, {\n        createHTML: function createHTML(html) {\n          return html;\n        },\n        createScriptURL: function createScriptURL(scriptUrl) {\n          return scriptUrl;\n        }\n      });\n    } catch (_) {\n      // Policy creation failed (most likely another DOMPurify script has\n      // already run). Skip creating the policy, as this will only cause errors\n      // if TT are enforced.\n      console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n      return null;\n    }\n  };\n\n  function createDOMPurify() {\n    var window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n\n    var DOMPurify = function DOMPurify(root) {\n      return createDOMPurify(root);\n    };\n    /**\n     * Version label, exposed for easier checks\n     * if DOMPurify is up to date or not\n     */\n\n\n    DOMPurify.version = '2.4.7';\n    /**\n     * Array of elements that DOMPurify removed during sanitation.\n     * Empty if nothing was removed.\n     */\n\n    DOMPurify.removed = [];\n\n    if (!window || !window.document || window.document.nodeType !== 9) {\n      // Not running in a browser, provide a factory function\n      // so that you can pass your own Window\n      DOMPurify.isSupported = false;\n      return DOMPurify;\n    }\n\n    var originalDocument = window.document;\n    var document = window.document;\n    var DocumentFragment = window.DocumentFragment,\n        HTMLTemplateElement = window.HTMLTemplateElement,\n        Node = window.Node,\n        Element = window.Element,\n        NodeFilter = window.NodeFilter,\n        _window$NamedNodeMap = window.NamedNodeMap,\n        NamedNodeMap = _window$NamedNodeMap === void 0 ? window.NamedNodeMap || window.MozNamedAttrMap : _window$NamedNodeMap,\n        HTMLFormElement = window.HTMLFormElement,\n        DOMParser = window.DOMParser,\n        trustedTypes = window.trustedTypes;\n    var ElementPrototype = Element.prototype;\n    var cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n    var getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n    var getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n    var getParentNode = lookupGetter(ElementPrototype, 'parentNode'); // As per issue #47, the web-components registry is inherited by a\n    // new document created via createHTMLDocument. As per the spec\n    // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n    // a new empty registry is used when creating a template contents owner\n    // document, so we use that as our parent document to ensure nothing\n    // is inherited.\n\n    if (typeof HTMLTemplateElement === 'function') {\n      var template = document.createElement('template');\n\n      if (template.content && template.content.ownerDocument) {\n        document = template.content.ownerDocument;\n      }\n    }\n\n    var trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, originalDocument);\n\n    var emptyHTML = trustedTypesPolicy ? trustedTypesPolicy.createHTML('') : '';\n    var _document = document,\n        implementation = _document.implementation,\n        createNodeIterator = _document.createNodeIterator,\n        createDocumentFragment = _document.createDocumentFragment,\n        getElementsByTagName = _document.getElementsByTagName;\n    var importNode = originalDocument.importNode;\n    var documentMode = {};\n\n    try {\n      documentMode = clone(document).documentMode ? document.documentMode : {};\n    } catch (_) {}\n\n    var hooks = {};\n    /**\n     * Expose whether this browser supports running the full DOMPurify.\n     */\n\n    DOMPurify.isSupported = typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined && documentMode !== 9;\n    var MUSTACHE_EXPR$1 = MUSTACHE_EXPR,\n        ERB_EXPR$1 = ERB_EXPR,\n        TMPLIT_EXPR$1 = TMPLIT_EXPR,\n        DATA_ATTR$1 = DATA_ATTR,\n        ARIA_ATTR$1 = ARIA_ATTR,\n        IS_SCRIPT_OR_DATA$1 = IS_SCRIPT_OR_DATA,\n        ATTR_WHITESPACE$1 = ATTR_WHITESPACE;\n    var IS_ALLOWED_URI$1 = IS_ALLOWED_URI;\n    /**\n     * We consider the elements and attributes below to be safe. Ideally\n     * don't add any new ones but feel free to remove unwanted ones.\n     */\n\n    /* allowed element names */\n\n    var ALLOWED_TAGS = null;\n    var DEFAULT_ALLOWED_TAGS = addToSet({}, [].concat(_toConsumableArray(html$1), _toConsumableArray(svg$1), _toConsumableArray(svgFilters), _toConsumableArray(mathMl$1), _toConsumableArray(text)));\n    /* Allowed attribute names */\n\n    var ALLOWED_ATTR = null;\n    var DEFAULT_ALLOWED_ATTR = addToSet({}, [].concat(_toConsumableArray(html), _toConsumableArray(svg), _toConsumableArray(mathMl), _toConsumableArray(xml)));\n    /*\n     * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.\n     * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n     * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n     * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n     */\n\n    var CUSTOM_ELEMENT_HANDLING = Object.seal(Object.create(null, {\n      tagNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null\n      },\n      attributeNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null\n      },\n      allowCustomizedBuiltInElements: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: false\n      }\n    }));\n    /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n\n    var FORBID_TAGS = null;\n    /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n\n    var FORBID_ATTR = null;\n    /* Decide if ARIA attributes are okay */\n\n    var ALLOW_ARIA_ATTR = true;\n    /* Decide if custom data attributes are okay */\n\n    var ALLOW_DATA_ATTR = true;\n    /* Decide if unknown protocols are okay */\n\n    var ALLOW_UNKNOWN_PROTOCOLS = false;\n    /* Decide if self-closing tags in attributes are allowed.\n     * Usually removed due to a mXSS issue in jQuery 3.0 */\n\n    var ALLOW_SELF_CLOSE_IN_ATTR = true;\n    /* Output should be safe for common template engines.\n     * This means, DOMPurify removes data attributes, mustaches and ERB\n     */\n\n    var SAFE_FOR_TEMPLATES = false;\n    /* Decide if document with <html>... should be returned */\n\n    var WHOLE_DOCUMENT = false;\n    /* Track whether config is already set on this instance of DOMPurify. */\n\n    var SET_CONFIG = false;\n    /* Decide if all elements (e.g. style, script) must be children of\n     * document.body. By default, browsers might move them to document.head */\n\n    var FORCE_BODY = false;\n    /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n     * string (or a TrustedHTML object if Trusted Types are supported).\n     * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n     */\n\n    var RETURN_DOM = false;\n    /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n     * string  (or a TrustedHTML object if Trusted Types are supported) */\n\n    var RETURN_DOM_FRAGMENT = false;\n    /* Try to return a Trusted Type object instead of a string, return a string in\n     * case Trusted Types are not supported  */\n\n    var RETURN_TRUSTED_TYPE = false;\n    /* Output should be free from DOM clobbering attacks?\n     * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n     */\n\n    var SANITIZE_DOM = true;\n    /* Achieve full DOM Clobbering protection by isolating the namespace of named\n     * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n     *\n     * HTML/DOM spec rules that enable DOM Clobbering:\n     *   - Named Access on Window (§7.3.3)\n     *   - DOM Tree Accessors (§3.1.5)\n     *   - Form Element Parent-Child Relations (§4.10.3)\n     *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n     *   - HTMLCollection (§4.2.10.2)\n     *\n     * Namespace isolation is implemented by prefixing `id` and `name` attributes\n     * with a constant string, i.e., `user-content-`\n     */\n\n    var SANITIZE_NAMED_PROPS = false;\n    var SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n    /* Keep element content when removing element? */\n\n    var KEEP_CONTENT = true;\n    /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n     * of importing it into a new Document and returning a sanitized copy */\n\n    var IN_PLACE = false;\n    /* Allow usage of profiles like html, svg and mathMl */\n\n    var USE_PROFILES = {};\n    /* Tags to ignore content of when KEEP_CONTENT is true */\n\n    var FORBID_CONTENTS = null;\n    var DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n    /* Tags that are safe for data: URIs */\n\n    var DATA_URI_TAGS = null;\n    var DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n    /* Attributes safe for values like \"javascript:\" */\n\n    var URI_SAFE_ATTRIBUTES = null;\n    var DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n    var MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n    var SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n    var HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n    /* Document namespace */\n\n    var NAMESPACE = HTML_NAMESPACE;\n    var IS_EMPTY_INPUT = false;\n    /* Allowed XHTML+XML namespaces */\n\n    var ALLOWED_NAMESPACES = null;\n    var DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n    /* Parsing of strict XHTML documents */\n\n    var PARSER_MEDIA_TYPE;\n    var SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n    var DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n    var transformCaseFunc;\n    /* Keep a reference to config to pass to hooks */\n\n    var CONFIG = null;\n    /* Ideally, do not touch anything below this line */\n\n    /* ______________________________________________ */\n\n    var formElement = document.createElement('form');\n\n    var isRegexOrFunction = function isRegexOrFunction(testValue) {\n      return testValue instanceof RegExp || testValue instanceof Function;\n    };\n    /**\n     * _parseConfig\n     *\n     * @param  {Object} cfg optional config literal\n     */\n    // eslint-disable-next-line complexity\n\n\n    var _parseConfig = function _parseConfig(cfg) {\n      if (CONFIG && CONFIG === cfg) {\n        return;\n      }\n      /* Shield configuration object from tampering */\n\n\n      if (!cfg || _typeof(cfg) !== 'object') {\n        cfg = {};\n      }\n      /* Shield configuration object from prototype pollution */\n\n\n      cfg = clone(cfg);\n      PARSER_MEDIA_TYPE = // eslint-disable-next-line unicorn/prefer-includes\n      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? PARSER_MEDIA_TYPE = DEFAULT_PARSER_MEDIA_TYPE : PARSER_MEDIA_TYPE = cfg.PARSER_MEDIA_TYPE; // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n\n      transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n      /* Set configuration parameters */\n\n      ALLOWED_TAGS = 'ALLOWED_TAGS' in cfg ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n      ALLOWED_ATTR = 'ALLOWED_ATTR' in cfg ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n      ALLOWED_NAMESPACES = 'ALLOWED_NAMESPACES' in cfg ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n      URI_SAFE_ATTRIBUTES = 'ADD_URI_SAFE_ATTR' in cfg ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), // eslint-disable-line indent\n      cfg.ADD_URI_SAFE_ATTR, // eslint-disable-line indent\n      transformCaseFunc // eslint-disable-line indent\n      ) // eslint-disable-line indent\n      : DEFAULT_URI_SAFE_ATTRIBUTES;\n      DATA_URI_TAGS = 'ADD_DATA_URI_TAGS' in cfg ? addToSet(clone(DEFAULT_DATA_URI_TAGS), // eslint-disable-line indent\n      cfg.ADD_DATA_URI_TAGS, // eslint-disable-line indent\n      transformCaseFunc // eslint-disable-line indent\n      ) // eslint-disable-line indent\n      : DEFAULT_DATA_URI_TAGS;\n      FORBID_CONTENTS = 'FORBID_CONTENTS' in cfg ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n      FORBID_TAGS = 'FORBID_TAGS' in cfg ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};\n      FORBID_ATTR = 'FORBID_ATTR' in cfg ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};\n      USE_PROFILES = 'USE_PROFILES' in cfg ? cfg.USE_PROFILES : false;\n      ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n\n      ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n\n      ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n\n      ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n\n      SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n\n      WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n\n      RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n\n      RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n\n      RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n\n      FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n\n      SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n\n      SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n\n      KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n\n      IN_PLACE = cfg.IN_PLACE || false; // Default false\n\n      IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI$1;\n      NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n      CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n\n      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n        CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n      }\n\n      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n        CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n      }\n\n      if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n        CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n      }\n\n      if (SAFE_FOR_TEMPLATES) {\n        ALLOW_DATA_ATTR = false;\n      }\n\n      if (RETURN_DOM_FRAGMENT) {\n        RETURN_DOM = true;\n      }\n      /* Parse profile info */\n\n\n      if (USE_PROFILES) {\n        ALLOWED_TAGS = addToSet({}, _toConsumableArray(text));\n        ALLOWED_ATTR = [];\n\n        if (USE_PROFILES.html === true) {\n          addToSet(ALLOWED_TAGS, html$1);\n          addToSet(ALLOWED_ATTR, html);\n        }\n\n        if (USE_PROFILES.svg === true) {\n          addToSet(ALLOWED_TAGS, svg$1);\n          addToSet(ALLOWED_ATTR, svg);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n\n        if (USE_PROFILES.svgFilters === true) {\n          addToSet(ALLOWED_TAGS, svgFilters);\n          addToSet(ALLOWED_ATTR, svg);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n\n        if (USE_PROFILES.mathMl === true) {\n          addToSet(ALLOWED_TAGS, mathMl$1);\n          addToSet(ALLOWED_ATTR, mathMl);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n      }\n      /* Merge configuration parameters */\n\n\n      if (cfg.ADD_TAGS) {\n        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n          ALLOWED_TAGS = clone(ALLOWED_TAGS);\n        }\n\n        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n      }\n\n      if (cfg.ADD_ATTR) {\n        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n          ALLOWED_ATTR = clone(ALLOWED_ATTR);\n        }\n\n        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n      }\n\n      if (cfg.ADD_URI_SAFE_ATTR) {\n        addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n      }\n\n      if (cfg.FORBID_CONTENTS) {\n        if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n          FORBID_CONTENTS = clone(FORBID_CONTENTS);\n        }\n\n        addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n      }\n      /* Add #text in case KEEP_CONTENT is set to true */\n\n\n      if (KEEP_CONTENT) {\n        ALLOWED_TAGS['#text'] = true;\n      }\n      /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n\n\n      if (WHOLE_DOCUMENT) {\n        addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n      }\n      /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n\n\n      if (ALLOWED_TAGS.table) {\n        addToSet(ALLOWED_TAGS, ['tbody']);\n        delete FORBID_TAGS.tbody;\n      } // Prevent further manipulation of configuration.\n      // Not available in IE8, Safari 5, etc.\n\n\n      if (freeze) {\n        freeze(cfg);\n      }\n\n      CONFIG = cfg;\n    };\n\n    var MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n    var HTML_INTEGRATION_POINTS = addToSet({}, ['foreignobject', 'desc', 'title', 'annotation-xml']); // Certain elements are allowed in both SVG and HTML\n    // namespace. We need to specify them explicitly\n    // so that they don't get erroneously deleted from\n    // HTML namespace.\n\n    var COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n    /* Keep track of all possible SVG and MathML tags\n     * so that we can perform the namespace checks\n     * correctly. */\n\n    var ALL_SVG_TAGS = addToSet({}, svg$1);\n    addToSet(ALL_SVG_TAGS, svgFilters);\n    addToSet(ALL_SVG_TAGS, svgDisallowed);\n    var ALL_MATHML_TAGS = addToSet({}, mathMl$1);\n    addToSet(ALL_MATHML_TAGS, mathMlDisallowed);\n    /**\n     *\n     *\n     * @param  {Element} element a DOM element whose namespace is being checked\n     * @returns {boolean} Return false if the element has a\n     *  namespace that a spec-compliant parser would never\n     *  return. Return true otherwise.\n     */\n\n    var _checkValidNamespace = function _checkValidNamespace(element) {\n      var parent = getParentNode(element); // In JSDOM, if we're inside shadow DOM, then parentNode\n      // can be null. We just simulate parent in this case.\n\n      if (!parent || !parent.tagName) {\n        parent = {\n          namespaceURI: NAMESPACE,\n          tagName: 'template'\n        };\n      }\n\n      var tagName = stringToLowerCase(element.tagName);\n      var parentTagName = stringToLowerCase(parent.tagName);\n\n      if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n        return false;\n      }\n\n      if (element.namespaceURI === SVG_NAMESPACE) {\n        // The only way to switch from HTML namespace to SVG\n        // is via <svg>. If it happens via any other tag, then\n        // it should be killed.\n        if (parent.namespaceURI === HTML_NAMESPACE) {\n          return tagName === 'svg';\n        } // The only way to switch from MathML to SVG is via`\n        // svg if parent is either <annotation-xml> or MathML\n        // text integration points.\n\n\n        if (parent.namespaceURI === MATHML_NAMESPACE) {\n          return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n        } // We only allow elements that are defined in SVG\n        // spec. All others are disallowed in SVG namespace.\n\n\n        return Boolean(ALL_SVG_TAGS[tagName]);\n      }\n\n      if (element.namespaceURI === MATHML_NAMESPACE) {\n        // The only way to switch from HTML namespace to MathML\n        // is via <math>. If it happens via any other tag, then\n        // it should be killed.\n        if (parent.namespaceURI === HTML_NAMESPACE) {\n          return tagName === 'math';\n        } // The only way to switch from SVG to MathML is via\n        // <math> and HTML integration points\n\n\n        if (parent.namespaceURI === SVG_NAMESPACE) {\n          return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n        } // We only allow elements that are defined in MathML\n        // spec. All others are disallowed in MathML namespace.\n\n\n        return Boolean(ALL_MATHML_TAGS[tagName]);\n      }\n\n      if (element.namespaceURI === HTML_NAMESPACE) {\n        // The only way to switch from SVG to HTML is via\n        // HTML integration points, and from MathML to HTML\n        // is via MathML text integration points\n        if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n          return false;\n        }\n\n        if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n          return false;\n        } // We disallow tags that are specific for MathML\n        // or SVG and should never appear in HTML namespace\n\n\n        return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n      } // For XHTML and XML documents that support custom namespaces\n\n\n      if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n        return true;\n      } // The code should never reach this place (this means\n      // that the element somehow got namespace that is not\n      // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n      // Return false just in case.\n\n\n      return false;\n    };\n    /**\n     * _forceRemove\n     *\n     * @param  {Node} node a DOM node\n     */\n\n\n    var _forceRemove = function _forceRemove(node) {\n      arrayPush(DOMPurify.removed, {\n        element: node\n      });\n\n      try {\n        // eslint-disable-next-line unicorn/prefer-dom-node-remove\n        node.parentNode.removeChild(node);\n      } catch (_) {\n        try {\n          node.outerHTML = emptyHTML;\n        } catch (_) {\n          node.remove();\n        }\n      }\n    };\n    /**\n     * _removeAttribute\n     *\n     * @param  {String} name an Attribute name\n     * @param  {Node} node a DOM node\n     */\n\n\n    var _removeAttribute = function _removeAttribute(name, node) {\n      try {\n        arrayPush(DOMPurify.removed, {\n          attribute: node.getAttributeNode(name),\n          from: node\n        });\n      } catch (_) {\n        arrayPush(DOMPurify.removed, {\n          attribute: null,\n          from: node\n        });\n      }\n\n      node.removeAttribute(name); // We void attribute values for unremovable \"is\"\" attributes\n\n      if (name === 'is' && !ALLOWED_ATTR[name]) {\n        if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n          try {\n            _forceRemove(node);\n          } catch (_) {}\n        } else {\n          try {\n            node.setAttribute(name, '');\n          } catch (_) {}\n        }\n      }\n    };\n    /**\n     * _initDocument\n     *\n     * @param  {String} dirty a string of dirty markup\n     * @return {Document} a DOM, filled with the dirty markup\n     */\n\n\n    var _initDocument = function _initDocument(dirty) {\n      /* Create a HTML document */\n      var doc;\n      var leadingWhitespace;\n\n      if (FORCE_BODY) {\n        dirty = '<remove></remove>' + dirty;\n      } else {\n        /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n        var matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n        leadingWhitespace = matches && matches[0];\n      }\n\n      if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n        // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n        dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n      }\n\n      var dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      /*\n       * Use the DOMParser API by default, fallback later if needs be\n       * DOMParser not work for svg when has multiple root element.\n       */\n\n      if (NAMESPACE === HTML_NAMESPACE) {\n        try {\n          doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n        } catch (_) {}\n      }\n      /* Use createHTMLDocument in case DOMParser is not available */\n\n\n      if (!doc || !doc.documentElement) {\n        doc = implementation.createDocument(NAMESPACE, 'template', null);\n\n        try {\n          doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n        } catch (_) {// Syntax error if dirtyPayload is invalid xml\n        }\n      }\n\n      var body = doc.body || doc.documentElement;\n\n      if (dirty && leadingWhitespace) {\n        body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n      }\n      /* Work on whole document or just its body */\n\n\n      if (NAMESPACE === HTML_NAMESPACE) {\n        return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n      }\n\n      return WHOLE_DOCUMENT ? doc.documentElement : body;\n    };\n    /**\n     * _createIterator\n     *\n     * @param  {Document} root document/fragment to create iterator for\n     * @return {Iterator} iterator instance\n     */\n\n\n    var _createIterator = function _createIterator(root) {\n      return createNodeIterator.call(root.ownerDocument || root, root, // eslint-disable-next-line no-bitwise\n      NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT, null, false);\n    };\n    /**\n     * _isClobbered\n     *\n     * @param  {Node} elm element to check for clobbering attacks\n     * @return {Boolean} true if clobbered, false if safe\n     */\n\n\n    var _isClobbered = function _isClobbered(elm) {\n      return elm instanceof HTMLFormElement && (typeof elm.nodeName !== 'string' || typeof elm.textContent !== 'string' || typeof elm.removeChild !== 'function' || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== 'function' || typeof elm.setAttribute !== 'function' || typeof elm.namespaceURI !== 'string' || typeof elm.insertBefore !== 'function' || typeof elm.hasChildNodes !== 'function');\n    };\n    /**\n     * _isNode\n     *\n     * @param  {Node} obj object to check whether it's a DOM node\n     * @return {Boolean} true is object is a DOM node\n     */\n\n\n    var _isNode = function _isNode(object) {\n      return _typeof(Node) === 'object' ? object instanceof Node : object && _typeof(object) === 'object' && typeof object.nodeType === 'number' && typeof object.nodeName === 'string';\n    };\n    /**\n     * _executeHook\n     * Execute user configurable hooks\n     *\n     * @param  {String} entryPoint  Name of the hook's entry point\n     * @param  {Node} currentNode node to work on with the hook\n     * @param  {Object} data additional hook parameters\n     */\n\n\n    var _executeHook = function _executeHook(entryPoint, currentNode, data) {\n      if (!hooks[entryPoint]) {\n        return;\n      }\n\n      arrayForEach(hooks[entryPoint], function (hook) {\n        hook.call(DOMPurify, currentNode, data, CONFIG);\n      });\n    };\n    /**\n     * _sanitizeElements\n     *\n     * @protect nodeName\n     * @protect textContent\n     * @protect removeChild\n     *\n     * @param   {Node} currentNode to check for permission to exist\n     * @return  {Boolean} true if node was killed, false if left alive\n     */\n\n\n    var _sanitizeElements = function _sanitizeElements(currentNode) {\n      var content;\n      /* Execute a hook if present */\n\n      _executeHook('beforeSanitizeElements', currentNode, null);\n      /* Check if element is clobbered or can clobber */\n\n\n      if (_isClobbered(currentNode)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Check if tagname contains Unicode */\n\n\n      if (regExpTest(/[\\u0080-\\uFFFF]/, currentNode.nodeName)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Now let's check the element's type and name */\n\n\n      var tagName = transformCaseFunc(currentNode.nodeName);\n      /* Execute a hook if present */\n\n      _executeHook('uponSanitizeElement', currentNode, {\n        tagName: tagName,\n        allowedTags: ALLOWED_TAGS\n      });\n      /* Detect mXSS attempts abusing namespace confusion */\n\n\n      if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && (!_isNode(currentNode.content) || !_isNode(currentNode.content.firstElementChild)) && regExpTest(/<[/\\w]/g, currentNode.innerHTML) && regExpTest(/<[/\\w]/g, currentNode.textContent)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Mitigate a problem with templates inside select */\n\n\n      if (tagName === 'select' && regExpTest(/<template/i, currentNode.innerHTML)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Remove element if anything forbids its presence */\n\n\n      if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n        /* Check if we have a custom element to handle */\n        if (!FORBID_TAGS[tagName] && _basicCustomElementTest(tagName)) {\n          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) return false;\n          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) return false;\n        }\n        /* Keep content except for bad-listed elements */\n\n\n        if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n          var parentNode = getParentNode(currentNode) || currentNode.parentNode;\n          var childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n          if (childNodes && parentNode) {\n            var childCount = childNodes.length;\n\n            for (var i = childCount - 1; i >= 0; --i) {\n              parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));\n            }\n          }\n        }\n\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Check whether element has a valid namespace */\n\n\n      if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Make sure that older browsers don't get fallback-tag mXSS */\n\n\n      if ((tagName === 'noscript' || tagName === 'noembed' || tagName === 'noframes') && regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Sanitize element content to be template-safe */\n\n\n      if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n        /* Get the element's text content */\n        content = currentNode.textContent;\n        content = stringReplace(content, MUSTACHE_EXPR$1, ' ');\n        content = stringReplace(content, ERB_EXPR$1, ' ');\n        content = stringReplace(content, TMPLIT_EXPR$1, ' ');\n\n        if (currentNode.textContent !== content) {\n          arrayPush(DOMPurify.removed, {\n            element: currentNode.cloneNode()\n          });\n          currentNode.textContent = content;\n        }\n      }\n      /* Execute a hook if present */\n\n\n      _executeHook('afterSanitizeElements', currentNode, null);\n\n      return false;\n    };\n    /**\n     * _isValidAttribute\n     *\n     * @param  {string} lcTag Lowercase tag name of containing element.\n     * @param  {string} lcName Lowercase attribute name.\n     * @param  {string} value Attribute value.\n     * @return {Boolean} Returns true if `value` is valid, otherwise false.\n     */\n    // eslint-disable-next-line complexity\n\n\n    var _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n      /* Make sure attribute cannot clobber */\n      if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n        return false;\n      }\n      /* Allow valid data-* attributes: At least one character after \"-\"\n          (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n          XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n          We don't need to check the value; it's always URI safe. */\n\n\n      if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR$1, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR$1, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n        if ( // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n        // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n        _basicCustomElementTest(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) || // Alternative, second condition checks if it's an `is`-attribute, AND\n        // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n          return false;\n        }\n        /* Check value is safe. First, is attr inert? If so, is safe */\n\n      } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE$1, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA$1, stringReplace(value, ATTR_WHITESPACE$1, ''))) ; else if (value) {\n        return false;\n      } else ;\n\n      return true;\n    };\n    /**\n     * _basicCustomElementCheck\n     * checks if at least one dash is included in tagName, and it's not the first char\n     * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n     * @param {string} tagName name of the tag of the node to sanitize\n     */\n\n\n    var _basicCustomElementTest = function _basicCustomElementTest(tagName) {\n      return tagName.indexOf('-') > 0;\n    };\n    /**\n     * _sanitizeAttributes\n     *\n     * @protect attributes\n     * @protect nodeName\n     * @protect removeAttribute\n     * @protect setAttribute\n     *\n     * @param  {Node} currentNode to sanitize\n     */\n\n\n    var _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n      var attr;\n      var value;\n      var lcName;\n      var l;\n      /* Execute a hook if present */\n\n      _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n      var attributes = currentNode.attributes;\n      /* Check if we have attributes; if not we might have a text node */\n\n      if (!attributes) {\n        return;\n      }\n\n      var hookEvent = {\n        attrName: '',\n        attrValue: '',\n        keepAttr: true,\n        allowedAttributes: ALLOWED_ATTR\n      };\n      l = attributes.length;\n      /* Go backwards over all attributes; safely remove bad ones */\n\n      while (l--) {\n        attr = attributes[l];\n        var _attr = attr,\n            name = _attr.name,\n            namespaceURI = _attr.namespaceURI;\n        value = name === 'value' ? attr.value : stringTrim(attr.value);\n        lcName = transformCaseFunc(name);\n        /* Execute a hook if present */\n\n        hookEvent.attrName = lcName;\n        hookEvent.attrValue = value;\n        hookEvent.keepAttr = true;\n        hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n\n        _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n\n        value = hookEvent.attrValue;\n        /* Did the hooks approve of the attribute? */\n\n        if (hookEvent.forceKeepAttr) {\n          continue;\n        }\n        /* Remove attribute */\n\n\n        _removeAttribute(name, currentNode);\n        /* Did the hooks approve of the attribute? */\n\n\n        if (!hookEvent.keepAttr) {\n          continue;\n        }\n        /* Work around a security issue in jQuery 3.0 */\n\n\n        if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n          _removeAttribute(name, currentNode);\n\n          continue;\n        }\n        /* Sanitize attribute content to be template-safe */\n\n\n        if (SAFE_FOR_TEMPLATES) {\n          value = stringReplace(value, MUSTACHE_EXPR$1, ' ');\n          value = stringReplace(value, ERB_EXPR$1, ' ');\n          value = stringReplace(value, TMPLIT_EXPR$1, ' ');\n        }\n        /* Is `value` valid for this attribute? */\n\n\n        var lcTag = transformCaseFunc(currentNode.nodeName);\n\n        if (!_isValidAttribute(lcTag, lcName, value)) {\n          continue;\n        }\n        /* Full DOM Clobbering protection via namespace isolation,\n         * Prefix id and name attributes with `user-content-`\n         */\n\n\n        if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n          // Remove the attribute with this value\n          _removeAttribute(name, currentNode); // Prefix the value and later re-create the attribute with the sanitized value\n\n\n          value = SANITIZE_NAMED_PROPS_PREFIX + value;\n        }\n        /* Handle attributes that require Trusted Types */\n\n\n        if (trustedTypesPolicy && _typeof(trustedTypes) === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n          if (namespaceURI) ; else {\n            switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n              case 'TrustedHTML':\n                {\n                  value = trustedTypesPolicy.createHTML(value);\n                  break;\n                }\n\n              case 'TrustedScriptURL':\n                {\n                  value = trustedTypesPolicy.createScriptURL(value);\n                  break;\n                }\n            }\n          }\n        }\n        /* Handle invalid data-* attribute set by try-catching it */\n\n\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n\n          arrayPop(DOMPurify.removed);\n        } catch (_) {}\n      }\n      /* Execute a hook if present */\n\n\n      _executeHook('afterSanitizeAttributes', currentNode, null);\n    };\n    /**\n     * _sanitizeShadowDOM\n     *\n     * @param  {DocumentFragment} fragment to iterate over recursively\n     */\n\n\n    var _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n      var shadowNode;\n\n      var shadowIterator = _createIterator(fragment);\n      /* Execute a hook if present */\n\n\n      _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n      while (shadowNode = shadowIterator.nextNode()) {\n        /* Execute a hook if present */\n        _executeHook('uponSanitizeShadowNode', shadowNode, null);\n        /* Sanitize tags and elements */\n\n\n        if (_sanitizeElements(shadowNode)) {\n          continue;\n        }\n        /* Deep shadow DOM detected */\n\n\n        if (shadowNode.content instanceof DocumentFragment) {\n          _sanitizeShadowDOM(shadowNode.content);\n        }\n        /* Check attributes, sanitize if necessary */\n\n\n        _sanitizeAttributes(shadowNode);\n      }\n      /* Execute a hook if present */\n\n\n      _executeHook('afterSanitizeShadowDOM', fragment, null);\n    };\n    /**\n     * Sanitize\n     * Public method providing core sanitation functionality\n     *\n     * @param {String|Node} dirty string or DOM node\n     * @param {Object} configuration object\n     */\n    // eslint-disable-next-line complexity\n\n\n    DOMPurify.sanitize = function (dirty) {\n      var cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var body;\n      var importedNode;\n      var currentNode;\n      var oldNode;\n      var returnNode;\n      /* Make sure we have a string to sanitize.\n        DO NOT return early, as this will return the wrong type if\n        the user has requested a DOM object rather than a string */\n\n      IS_EMPTY_INPUT = !dirty;\n\n      if (IS_EMPTY_INPUT) {\n        dirty = '<!-->';\n      }\n      /* Stringify, in case dirty is an object */\n\n\n      if (typeof dirty !== 'string' && !_isNode(dirty)) {\n        if (typeof dirty.toString === 'function') {\n          dirty = dirty.toString();\n\n          if (typeof dirty !== 'string') {\n            throw typeErrorCreate('dirty is not a string, aborting');\n          }\n        } else {\n          throw typeErrorCreate('toString is not a function');\n        }\n      }\n      /* Check we can run. Otherwise fall back or ignore */\n\n\n      if (!DOMPurify.isSupported) {\n        if (_typeof(window.toStaticHTML) === 'object' || typeof window.toStaticHTML === 'function') {\n          if (typeof dirty === 'string') {\n            return window.toStaticHTML(dirty);\n          }\n\n          if (_isNode(dirty)) {\n            return window.toStaticHTML(dirty.outerHTML);\n          }\n        }\n\n        return dirty;\n      }\n      /* Assign config vars */\n\n\n      if (!SET_CONFIG) {\n        _parseConfig(cfg);\n      }\n      /* Clean up removed elements */\n\n\n      DOMPurify.removed = [];\n      /* Check if dirty is correctly typed for IN_PLACE */\n\n      if (typeof dirty === 'string') {\n        IN_PLACE = false;\n      }\n\n      if (IN_PLACE) {\n        /* Do some early pre-sanitization to avoid unsafe root nodes */\n        if (dirty.nodeName) {\n          var tagName = transformCaseFunc(dirty.nodeName);\n\n          if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n            throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n          }\n        }\n      } else if (dirty instanceof Node) {\n        /* If dirty is a DOM element, append to an empty document to avoid\n           elements being stripped by the parser */\n        body = _initDocument('<!---->');\n        importedNode = body.ownerDocument.importNode(dirty, true);\n\n        if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n          /* Node is already a body, use as is */\n          body = importedNode;\n        } else if (importedNode.nodeName === 'HTML') {\n          body = importedNode;\n        } else {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          body.appendChild(importedNode);\n        }\n      } else {\n        /* Exit directly if we have nothing to do */\n        if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT && // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1) {\n          return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n        }\n        /* Initialize the document to work on */\n\n\n        body = _initDocument(dirty);\n        /* Check we have a DOM node from the data */\n\n        if (!body) {\n          return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n        }\n      }\n      /* Remove first element node (ours) if FORCE_BODY is set */\n\n\n      if (body && FORCE_BODY) {\n        _forceRemove(body.firstChild);\n      }\n      /* Get node iterator */\n\n\n      var nodeIterator = _createIterator(IN_PLACE ? dirty : body);\n      /* Now start iterating over the created document */\n\n\n      while (currentNode = nodeIterator.nextNode()) {\n        /* Fix IE's strange behavior with manipulated textNodes #89 */\n        if (currentNode.nodeType === 3 && currentNode === oldNode) {\n          continue;\n        }\n        /* Sanitize tags and elements */\n\n\n        if (_sanitizeElements(currentNode)) {\n          continue;\n        }\n        /* Shadow DOM detected, sanitize it */\n\n\n        if (currentNode.content instanceof DocumentFragment) {\n          _sanitizeShadowDOM(currentNode.content);\n        }\n        /* Check attributes, sanitize if necessary */\n\n\n        _sanitizeAttributes(currentNode);\n\n        oldNode = currentNode;\n      }\n\n      oldNode = null;\n      /* If we sanitized `dirty` in-place, return it. */\n\n      if (IN_PLACE) {\n        return dirty;\n      }\n      /* Return sanitized string or DOM */\n\n\n      if (RETURN_DOM) {\n        if (RETURN_DOM_FRAGMENT) {\n          returnNode = createDocumentFragment.call(body.ownerDocument);\n\n          while (body.firstChild) {\n            // eslint-disable-next-line unicorn/prefer-dom-node-append\n            returnNode.appendChild(body.firstChild);\n          }\n        } else {\n          returnNode = body;\n        }\n\n        if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmod) {\n          /*\n            AdoptNode() is not used because internal state is not reset\n            (e.g. the past names map of a HTMLFormElement), this is safe\n            in theory but we would rather not risk another attack vector.\n            The state that is cloned by importNode() is explicitly defined\n            by the specs.\n          */\n          returnNode = importNode.call(originalDocument, returnNode, true);\n        }\n\n        return returnNode;\n      }\n\n      var serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n      /* Serialize doctype if allowed */\n\n      if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n        serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n      }\n      /* Sanitize final string template-safe */\n\n\n      if (SAFE_FOR_TEMPLATES) {\n        serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR$1, ' ');\n        serializedHTML = stringReplace(serializedHTML, ERB_EXPR$1, ' ');\n        serializedHTML = stringReplace(serializedHTML, TMPLIT_EXPR$1, ' ');\n      }\n\n      return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n    };\n    /**\n     * Public method to set the configuration once\n     * setConfig\n     *\n     * @param {Object} cfg configuration object\n     */\n\n\n    DOMPurify.setConfig = function (cfg) {\n      _parseConfig(cfg);\n\n      SET_CONFIG = true;\n    };\n    /**\n     * Public method to remove the configuration\n     * clearConfig\n     *\n     */\n\n\n    DOMPurify.clearConfig = function () {\n      CONFIG = null;\n      SET_CONFIG = false;\n    };\n    /**\n     * Public method to check if an attribute value is valid.\n     * Uses last set config, if any. Otherwise, uses config defaults.\n     * isValidAttribute\n     *\n     * @param  {string} tag Tag name of containing element.\n     * @param  {string} attr Attribute name.\n     * @param  {string} value Attribute value.\n     * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n     */\n\n\n    DOMPurify.isValidAttribute = function (tag, attr, value) {\n      /* Initialize shared config vars if necessary. */\n      if (!CONFIG) {\n        _parseConfig({});\n      }\n\n      var lcTag = transformCaseFunc(tag);\n      var lcName = transformCaseFunc(attr);\n      return _isValidAttribute(lcTag, lcName, value);\n    };\n    /**\n     * AddHook\n     * Public method to add DOMPurify hooks\n     *\n     * @param {String} entryPoint entry point for the hook to add\n     * @param {Function} hookFunction function to execute\n     */\n\n\n    DOMPurify.addHook = function (entryPoint, hookFunction) {\n      if (typeof hookFunction !== 'function') {\n        return;\n      }\n\n      hooks[entryPoint] = hooks[entryPoint] || [];\n      arrayPush(hooks[entryPoint], hookFunction);\n    };\n    /**\n     * RemoveHook\n     * Public method to remove a DOMPurify hook at a given entryPoint\n     * (pops it from the stack of hooks if more are present)\n     *\n     * @param {String} entryPoint entry point for the hook to remove\n     * @return {Function} removed(popped) hook\n     */\n\n\n    DOMPurify.removeHook = function (entryPoint) {\n      if (hooks[entryPoint]) {\n        return arrayPop(hooks[entryPoint]);\n      }\n    };\n    /**\n     * RemoveHooks\n     * Public method to remove all DOMPurify hooks at a given entryPoint\n     *\n     * @param  {String} entryPoint entry point for the hooks to remove\n     */\n\n\n    DOMPurify.removeHooks = function (entryPoint) {\n      if (hooks[entryPoint]) {\n        hooks[entryPoint] = [];\n      }\n    };\n    /**\n     * RemoveAllHooks\n     * Public method to remove all DOMPurify hooks\n     *\n     */\n\n\n    DOMPurify.removeAllHooks = function () {\n      hooks = {};\n    };\n\n    return DOMPurify;\n  }\n\n  var purify = createDOMPurify();\n\n  return purify;\n\n}));\n//# sourceMappingURL=purify.js.map\n","import {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\n\nexport class GenericDocFieldHandler extends GenericDocAbstractFieldHandler {\n    getDefaultConfig(): any {\n        return {};\n    }\n\n    getXmlValue(): string {\n        return JSON.stringify([(this.rawValue ?? \"\")]);\n    }\n\n    addSignatures(signatures: string[], includeAll?: boolean) {}\n}\n\n\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../../ItemConfiguration\";\n\nexport abstract class GenericDocAbstractFieldHandler implements IDocFieldHandler {\n    private sectionType: string;\n     dhfFieldConfig: IAnyMap;\n\n    constructor(sectionType: string, config: XRFieldTypeAnnotatedParamJson, fieldValue: string) {\n        if(!config)\n            config = this.getDefaultConfig()\n        this.dhfFieldConfig = config;\n        this.sectionType = sectionType;\n        this.rawValue = fieldValue;\n    }\n\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n\n    rawValue: string;\n\n    getData(): string {\n        return this.rawValue;\n    }\n\n    getFieldType(): string {\n        return this.sectionType;\n    }\n\n    initData(serializedFieldData: string) {\n        this.rawValue = serializedFieldData;\n    }\n\n    abstract getXmlValue():string;\n\n    abstract getDefaultConfig(): any;\n\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n}\n\n","export { SectionDescriptions };\n\nclass SectionDescriptions{\n    static section_Checkbox = \"Checkbox\"\n    static section_Custom = \"Custom\"\n    static section_derivedfrom = \"derivedfrom\"\n    static section_dashboard = \"dashboard\"\n    static section_designreviews = \"designreviews\"\n    static section_audittrail = \"audittrail\"\n    static section_signatures = \"signatures\"\n    static section_responsibilities = \"responsibilities\"\n    static section_genericTable = \"genericTable\"\n    static section_dhf_table = \"dhf_table\"\n    static section_document_options = \"document_options\"\n    static section_Date = \"Date\"\n    static section_item_index = \"item_index\"\n    static section_itemlist = \"itemlist\"\n    static section_package = \"package\"\n    static section_items = \"items\"\n    static section_itemtable = \"itemtable\"\n    static section_linklist = \"linklist\"\n    static section_figures_tables = \"figures_tables\"\n    static section_multiselect = \"multiselect\"\n    static section_remarks = \"remarks\"\n    static section_richtext = \"richtext\"\n    static section_riskstats = \"riskstats\"\n    static section_terms_abbreviations = \"terms_abbreviations\"\n    static section_table_of_content = \"table_of_content\"\n    static section_testresults = \"testresults\"\n    static section_textline = \"textline\"\n    static section_tracematrix = \"tracematrix\"\n    static section_downtraces = \"downtraces\"\n    static section_uptraces = \"uptraces\"\n    static section_duedate= \"duedate\";\n    static section_templateapproval= \"templateapproval\";\n    static section_signaturebox= \"signaturebox\";\n    static section_CustomSection = \"CustomSection\";\n    static section_checkbox = \"checkbox\";\n    static section_hidden= \"hidden\";\n}\n","import {ItemConfiguration} from \"../../ItemConfiguration\";\nimport {SectionDescriptions} from \"./SectionDescriptions\";\nimport {GenericDocFieldHandler} from \"./GenericDocFieldHandler\";\nimport {GenericTableDocHandler} from \"./GenericTableDocHandler\";\nimport {IDHFControlDefinitionValue} from \"../../PluginManagerDocuments\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {DateDocHandler} from \"./DateDocHandler\";\nimport {IBaseDropdownFieldParams} from \"../DropdownFieldHandler\";\nimport {CustomDocFieldHandler} from \"./CustomDocFieldHandler\";\nimport {RemarksDocFieldHandler} from \"./RemarksDocFieldHandler\";\nimport {CheckBoxDocFieldHandler} from \"./CheckBoxDocFieldHandler\";\nimport {DesignReviewDocFieldHandler} from \"./DesignReviewDocFieldHandler\";\nimport {ItemIndexDocFieldHander} from \"./ItemIndexDocFieldHander\";\nimport {ItemListDocFieldHandler} from \"./ItemListDocFieldHandler\";\nimport {LinkListDocFieldHandler} from \"./LinkListDocFieldHandler\";\nimport {ItemTableDocFieldHandler} from \"./ItemTableDocFieldHandler\";\nimport {RiskStatsDocFieldHandler} from \"./RiskStatsDocFieldHandler\";\nimport {ItemRefDocFieldHandler} from \"./ItemRefDocFieldHandler\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {ListOfFiguresDocFieldHandler} from \"./ListOfFiguresDocFieldHandler\";\nimport {SmartTextDocFieldHandler} from \"./SmartTextDocFieldHandler\";\nimport {TableOfContentDocFieldHandler} from \"./TableOfContentDocFieldHandler\";\nimport {TestResultsDocFieldHandler} from \"./testResultsDocFieldHandler\";\nimport {DerivedFromDocFieldHandler} from \"./DerivedFromDocFieldHandler\";\nimport {DocumentOptionsFieldHandler} from \"./DocumentOptionsFieldHandler\";\nimport {TextLineDocFieldHandler} from \"./TextLineDocFieldHandler\";\nimport {TraceMatrixDocFieldHandler} from \"./TraceMatrixDocFieldHandler\";\nimport {TraceDocFieldHandler} from \"./TraceDocFieldHandler\";\nimport {MultiSelectDocFieldHandler} from \"./DropdownDocFieldHandler\";\nimport {RichTextDocFieldHandler} from \"./RichTextDocFieldHandler\";\nimport {DashboardDocFieldHandler} from \"./DashboardDocFieldHandler\";\nimport { IDashboardParams } from \"../../../../client/plugins/DocumentSections/Dashboard\";\n\nexport class DocFieldHandlerFactory {\n\n    public static GetDHFFieldConfig(itemConfig: ItemConfiguration, fieldType: string, config: IAnyMap):IAnyMap {\n        let dhfConfig = itemConfig.getDHFConfig();\n        let foundConfig = undefined;\n        // special case for signatures\n        if( fieldType == SectionDescriptions.section_signaturebox || fieldType == SectionDescriptions.section_templateapproval)\n                fieldType = \"signatures\";\n\n        if (dhfConfig && dhfConfig[fieldType]) {\n            foundConfig = dhfConfig[fieldType];\n        }\n        if( foundConfig != undefined)\n            return {...foundConfig, ...(config || {}) } ;\n        return config;\n    }\n\n\n\n    static createHandler(itemConfig: ItemConfiguration, dhfValue: IDHFControlDefinitionValue): IDocFieldHandler {\n\n        let returnedFieldHandler: IDocFieldHandler = undefined;\n\n        switch (dhfValue.type) {\n            case SectionDescriptions.section_audittrail :\n            case SectionDescriptions.section_signatures :\n            case SectionDescriptions.section_signaturebox:\n            case SectionDescriptions.section_responsibilities :\n            case SectionDescriptions.section_genericTable :\n            case SectionDescriptions.section_templateapproval:\n            case SectionDescriptions.section_dhf_table :\n                returnedFieldHandler = new GenericTableDocHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue );\n                break;\n            case SectionDescriptions.section_Date :\n            case SectionDescriptions.section_duedate :\n                returnedFieldHandler = new DateDocHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_remarks :\n                returnedFieldHandler = new RemarksDocFieldHandler(itemConfig, dhfValue.type, <IBaseDropdownFieldParams>dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_multiselect :\n                returnedFieldHandler =  new MultiSelectDocFieldHandler(itemConfig,dhfValue.type, <IBaseDropdownFieldParams>dhfValue.ctrlConfig, dhfValue.fieldValue)\n                break;\n            case SectionDescriptions.section_downtraces :\n            case SectionDescriptions.section_uptraces :\n                returnedFieldHandler = new TraceDocFieldHandler(itemConfig,dhfValue.type, <IBaseDropdownFieldParams>dhfValue.ctrlConfig,dhfValue.fieldValue );\n                break;\n\n            case SectionDescriptions.section_dashboard:\n                returnedFieldHandler = new DashboardDocFieldHandler(dhfValue.type, <IDashboardParams> dhfValue.ctrlConfig , dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_designreviews:\n                returnedFieldHandler = new DesignReviewDocFieldHandler(dhfValue.type,dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n\n\n\n            case SectionDescriptions.section_package:\n            case SectionDescriptions.section_itemlist:\n                returnedFieldHandler = new ItemRefDocFieldHandler(dhfValue.type,dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_riskstats:\n                returnedFieldHandler = new RiskStatsDocFieldHandler(dhfValue.type,dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_linklist:\n                returnedFieldHandler = new LinkListDocFieldHandler(dhfValue.type,dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_itemtable:\n                returnedFieldHandler = new ItemTableDocFieldHandler(dhfValue.type,dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n\n\n            case SectionDescriptions.section_items:\n                returnedFieldHandler = new ItemListDocFieldHandler(dhfValue.type,dhfValue.ctrlConfig, dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_Checkbox : // Legacy\n            case SectionDescriptions.section_checkbox:\n                returnedFieldHandler =  new CheckBoxDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_Custom :   // Legacy\n            case SectionDescriptions.section_CustomSection :\n                returnedFieldHandler =  new CustomDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n\n            case SectionDescriptions.section_item_index :\n                returnedFieldHandler =  new ItemIndexDocFieldHander(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_figures_tables :\n                returnedFieldHandler =  new ListOfFiguresDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_terms_abbreviations :\n                returnedFieldHandler =  new SmartTextDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_table_of_content :\n                returnedFieldHandler =  new TableOfContentDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_testresults :\n                returnedFieldHandler =  new TestResultsDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_derivedfrom:\n                returnedFieldHandler =  new DerivedFromDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n            case SectionDescriptions.section_document_options :\n                returnedFieldHandler =  new DocumentOptionsFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_richtext:\n                returnedFieldHandler =  new RichTextDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_textline :\n                returnedFieldHandler =  new TextLineDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n\n            case SectionDescriptions.section_tracematrix :\n                returnedFieldHandler =  new TraceMatrixDocFieldHandler(dhfValue.type, dhfValue.ctrlConfig,dhfValue.fieldValue);\n                break;\n            default:\n                returnedFieldHandler = new GenericDocFieldHandler(dhfValue.type , dhfValue.ctrlConfig,dhfValue.fieldValue);\n        }\n\n        if( dhfValue.name){\n            returnedFieldHandler.setFieldName(dhfValue.name);\n        }\n\n        return  returnedFieldHandler;\n\n    }\n}\n","import { BaseTableFieldHandler, ITableControlBaseParams } from \"../BaseTableFieldHandler\";\nimport {IDHFControlDefinition, IDHFSection, IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {IDHFConfigTableColumn, IDropdownOption} from \"../../../../ProjectSettings\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap, IGenericMap} from \"../../../../globals\";\nimport {ITableRow} from \"../../../UI/Controls/tableCtrl\";\n\nexport interface ITableDHFConfig{\n    default:{ columns: IDHFConfigTableColumn[] }\n}\nexport interface ITableDHFSection{\n    config:ITableDHFConfig;\n}\n\n\nexport type { ITableConfig, IDhfTableOptions, ITableConfigColumn };\ninterface ITableConfig {\n    default: IDhfTableOptions\n}\n\ninterface IDhfTableOptions extends IDHFSectionOptions {\n    columns:ITableConfigColumn[],\n}\ninterface ITableConfigColumn extends IDHFSectionOptions {\n    columnType:string,\n    field:string,\n    pos:number,\n    editor: string,\n    name: string,\n    options: IDropdownOption[]\n}\n\n\nexport class GenericTableDocHandler extends BaseTableFieldHandler implements  IDocFieldHandler{\n    private controller: ITableDHFSection\n    public dhfFieldConfig: IAnyMap;\n    constructor(private sectionType:string, config: IDHFSectionOptions, fieldValue:string){\n        // The IDHFSectionOptions config parameter is really a ITableControlBaseParams.\n        super(<ITableControlBaseParams>config);\n        this.dhfFieldConfig = config;\n        this.initData(fieldValue);\n\n    }\n    validate() {\n        super.validate();\n    }\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n    getFieldType(): string {\n        return this.sectionType;\n    }\n\n    protected GetColumnCount(controllerConfig:ITableControlBaseParams) {\n        return controllerConfig.columns?controllerConfig.columns.length:0;\n    }\n\n    getXmlValue(): string {\n\n        let controllerConfig = this.dhfFieldConfig;\n\n        // get data entered into table\n        let table: IGenericMap[] = [];\n        let fieldValue = this.getData()\n        if (fieldValue) {\n            table = JSON.parse(fieldValue);\n        }\n        // add some extras for the xml dump: table header, sorting and colum type\n        const col_order: IGenericMap = {sortedtable: 1};\n        const col_types: IGenericMap = {columnTypes: 1};\n        const col_header: IGenericMap = {};\n\n        const colSorter :{name:string,order:number} [] = [];\n        let idx = 0;\n        //There might be no columns defined\n        let columns = controllerConfig.columns || [];\n\n        for (let columnConfig of columns) {\n\n            let castedColumnConfig = columnConfig as ITableConfigColumn;\n\n            colSorter.push( {name:castedColumnConfig.field, order:castedColumnConfig.pos} );\n            col_types[castedColumnConfig.field] = castedColumnConfig.columnType;\n            col_header[castedColumnConfig.field] = castedColumnConfig.name;\n\n            // fix custom drop down values\n            let colOpts = this.getColumnByField(controllerConfig.columns[idx].field );\n            if (colOpts) {\n                for(let row=0;row<table.length;row++) {\n                    if ( table[row][\"col\"+idx] && colOpts[table[row][\"col\"+idx]]) {\n                        // replace value with human readable value\n                        table[row][\"col\"+idx]  = colOpts[table[row][\"col\"+idx]];\n                    }\n                }\n            }\n            idx++;\n        }\n        // make sure col indexes start at 0\n        colSorter.sort(function (a, b) {\n            return a.order - b.order;\n        });\n        let colIdx = 0 ;\n        for(let s of colSorter){\n            col_order[s.name] = colIdx;\n            colIdx++ ;\n        }\n\n        table.splice(0, 0, col_header);\n        table.splice(0, 0, col_types);\n        table.splice(0, 0, col_order);\n\n        // return the xml dump\n        return JSON.stringify(table);\n    }\n\n    getDefaultConfig(): any {\n        // Default is empty as it's configured from itemConfig.getDHFConfig();\n        return {};\n    }\n\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n    addSignatures(signatures: string[], includeAll?: boolean) {\n\n        let controllerConfig = this.dhfFieldConfig;\n        let signatureNameColumn:string;\n        let eSign = false;\n        for (let col = 0; col < this.getColumnCount(); col++) {\n            if (controllerConfig.columns[col].columnType === \"type4\") {\n                // drop down with user names\n                signatureNameColumn = controllerConfig.columns[col].field;\n            } else if (controllerConfig.columns[col].columnType === \"type10\") {\n                // drop down with user names\n                signatureNameColumn = controllerConfig.columns[col].field;\n            } else if (controllerConfig.columns[col].columnType === \"type3\") {\n                // empty field to add signature image and token\n                eSign = true;\n            }\n        }\n\n        if (!eSign && !signatureNameColumn) {\n            return;\n        }\n\n        if (!eSign) {\n            return;\n        }\n        if (!signatureNameColumn) {\n            return;\n        }\n\n        // get data entered into table\n        let table: ITableRow[] = [];\n        table = JSON.parse(this.getData());\n\n        for (let row = 0; row < table.length; row++) {\n            let userId = <string>table[row][signatureNameColumn];\n            if ((includeAll || userId) && signatures.indexOf(userId) === -1) {\n                signatures.push(userId);\n            }\n        }\n    }\n\n}\n\n\n\n\n\n","import {DateFieldHandler} from \"../DateFieldHandler\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {ml} from \"../../../matrixlib\";\nimport {DateTimeBL} from \"../../DateTimeBL\";\n\nexport type { IDueDateOptions, IDHFDueDateConfig };\n\ninterface IDueDateOptions extends IDHFSectionOptions {\n}\n\ninterface IDHFDueDateConfig {\n    default:IDueDateOptions\n}\n\nexport class DateDocHandler extends DateFieldHandler implements  IDocFieldHandler{\n    private type: string;\n\n    constructor(type:string, config: IAnyMap, fieldValue:string) {\n        if( config ==undefined)\n            config = DateDocHandler.default_config;\n        super(config);\n        this.type = type;\n        this.dhfFieldConfig = config;\n\n        this.initData(fieldValue);\n    }\n\n    static default_config:IDHFDueDateConfig = {\n        default: {}\n    };\n    getFieldType(): string {\n        return this.type;\n    }\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n    getXmlValue(): string {\n        let xmlval:any[] = [];\n        let yyyymmdd = this.getDate();\n            // new Date take mm-1\n         let dateStr = DateTimeBL.getInstance().renderCustomerHumanDate(\n                 yyyymmdd,\n                 true);\n        xmlval.push( { \"date\":dateStr });\n\n        return JSON.stringify(xmlval);\n    }\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n    dhfFieldConfig: IAnyMap;\n\n    getDefaultConfig(): any {\n        return {};\n    }\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n}\n","import {IGetProjectResultDateInfo} from \"./index\";\nimport {matrixSession, restConnection} from \"../../globals\";\n\nexport  class DateTimeBL {\n    // formatter (always for the user)\n    public simpleDateTimeFormat: SimpleDateFormat;\n    public simpleDateFormat: SimpleDateFormat;\n    // formatter for the customer\n    public simpleCustomerDateTimeFormat: SimpleDateFormat;\n    public simpleCustomerDateFormat: SimpleDateFormat;\n\n\n    // *******************************************************\n    // these are setting of the currently logged in user\n    // as well as the current server settings\n    // they are updated when initDateTimeSettings() is called\n    // *******************************************************\n    public userDateTimeFormat: string;\n    public userDateOnlyFormat: string;\n    public userTimezone: string;\n    // server formatting for user\n    public dateIso8601FromServer: string;\n    public dateUserFromServer: string;\n    // server settings\n    public serverDateTimeFormat: string;\n    public serverDateOnlyFormat: string;\n    public serverTimezone: string;\n\n    static instance: DateTimeBL;\n\n    static getInstance(): DateTimeBL {\n        if (DateTimeBL.instance == null) {\n            DateTimeBL.instance = new DateTimeBL();\n        }\n        return DateTimeBL.instance;\n    }\n\n     private constructor() {\n        this.userDateTimeFormat = \"yyyy/MM/dd HH:mm:ss\";\n        this.userDateOnlyFormat = \"yyyy/MM/dd\";\n        this.userTimezone = \"UTC\";\n        this.simpleDateTimeFormat = new SimpleDateFormat(this.userDateTimeFormat);\n        this.simpleDateFormat = new SimpleDateFormat(this.userDateOnlyFormat);\n        this.dateIso8601FromServer = \"\";\n        this.dateUserFromServer = \"\";\n        this.serverDateTimeFormat = \"yyyy/MM/dd HH:mm:ss\";\n        this.serverDateOnlyFormat = \"yyyy/MM/dd\";\n        this.serverTimezone = \"UTC\";\n        this.simpleCustomerDateTimeFormat = new SimpleDateFormat(this.userDateTimeFormat);\n        this.simpleCustomerDateFormat = new SimpleDateFormat(this.userDateOnlyFormat);\n    }\n\n    // isValidateDate(new Date(\"ccccc\")) -> false\n    private isValidDate(d: Date): boolean {\n        if (Object.prototype.toString.call(d) === \"[object Date]\") {\n            return !isNaN(d.getTime());\n        }\n        return false;\n    }\n\n    // render a human date and time in the user's preferred style\n    renderHumanDate(date: Date, dateOnly?: boolean): string {\n\n        if (!this.isValidDate(date)) {\n            return \"\";\n        }\n\n        if (dateOnly) {\n            return this.simpleDateFormat.format(date);\n        }\n        return this.simpleDateTimeFormat.format(date);\n    }\n\n    // render a human date and time in the user's preferred style\n    renderCustomerHumanDate(date: Date, dateOnly?: boolean): string {\n\n        if (!this.isValidDate(date)) {\n            return \"\";\n        }\n\n        if (dateOnly) {\n            return this.simpleCustomerDateFormat.format(date);\n        }\n        return this.simpleCustomerDateTimeFormat.format(date);\n    }\n\n    // render a date 3 letter abbreviation (e.g. for calendars)\n    renderHumanMonth(dateObj: Date): string {\n        let dateFormat = new SimpleDateFormat(\"MMM\");\n        return dateFormat.format(dateObj);\n    }\n\n    renderDashFormat(dateObj: Date): string {\n        let dateFormat = new SimpleDateFormat(\"yyyy-MM-dd\");\n        return dateFormat.format(dateObj);\n    }\n\n\n\n    // return the simple date format for controls\n    getSimpleDateFormat(): string {\n        return this.userDateOnlyFormat;\n    }\n\n    private toMoment(format: string): string {\n        // see https://www.angularfaces.net/cheatsheet/\n        return format\n            .replace(\"a\", \"A\")\n            .replace(\"DDD\", \"DDDD\")\n            .replace(\"D\", \"DDD\")\n            .replace(\"dd\", \"DD\")\n            .replace(\"d\", \"D\")\n            .replace(\"EEEE\", \"dddd\")\n            .replace(\"EEE\", \"ddd\")\n            .replace(\"EE\", \"dd\")\n            .replace(\"E\", \"d\")\n            .replace(\"u\", \"E\")\n            .replace(\"w\", \"W\")\n            .replace(\"ww\", \"WW\")\n            .replace(\"xxx\", \"Z\")\n            .replace(\"xx\", \"ZZ\")\n            .replace(\"YYYY\", \"gggg\")\n            .replace(\"YY\", \"gg\")\n            .replace(\"yyyy\", \"YYYY\")\n            .replace(\"yyy\", \"YYY\")\n            .replace(\"yy\", \"YY\")\n            .replace(\"y\", \"Y\")\n            .replace(\"Z\", \"ZZ\")\n    }\n\n    getSimpleDateFormatMoment() {\n        return this.toMoment(this.userDateOnlyFormat)\n    }\n\n    getSimpleDateTimeFormatMoment() {\n        return this.toMoment(this.userDateTimeFormat)\n    }\n    async initDateTimeSettings(update?: boolean): Promise<void> {\n        let dateSettings: IGetProjectResultDateInfo;\n        let that = this;\n\n        function updateSettings() {\n            that.userDateTimeFormat = dateSettings.timeformat;\n            that.userDateOnlyFormat = dateSettings.dateformat;\n            that.userTimezone = dateSettings.timeZone;\n            that.serverDateOnlyFormat = dateSettings.customerDateformat;\n            that.serverDateTimeFormat = dateSettings.customerTimeformat;\n            that.serverTimezone = dateSettings.customerTimezone;\n            // create formatting strings\n            that.simpleCustomerDateTimeFormat = new SimpleDateFormat(that.serverDateTimeFormat);\n            that.simpleCustomerDateFormat = new SimpleDateFormat(that.serverDateOnlyFormat);\n            // remember the date time settings as the server thinks it should be\n            that.dateIso8601FromServer = dateSettings.dateIso8601;\n            that.dateUserFromServer = dateSettings.timeUserFormat;\n            // create formatting strings\n            that.simpleDateTimeFormat = new SimpleDateFormat(that.userDateTimeFormat);\n            that.simpleDateFormat = new SimpleDateFormat(that.userDateOnlyFormat);\n        }\n\n        if (update) {\n            await restConnection.getServer(\"all/date\").done(function (ds: IGetProjectResultDateInfo) {\n                dateSettings = ds;\n                updateSettings();\n            });\n        } else {\n            dateSettings = matrixSession.getDateInfo();\n            updateSettings();\n        }\n\n        return;\n    }\n\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IGenericMap} from \"../../../../globals\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {ICustomSection} from \"../../../../printinterface/PrintProcessorInterfaces\";\nimport {ItemSelectionFromToAbstractDocFieldHandler} from \"./ItemSelectionFromToAbstractDocFieldHandler\";\n\n\nexport type { ICustomSectionOptions, IDHFCustomSectionOptions };\n\ninterface ICustomSectionOptions extends IDHFSectionOptions {\n    includeInToc:boolean,\n    options: ICustomSection,\n    landscape: boolean\n}\n\ninterface IDHFCustomSectionOptions {\n    default:ICustomSectionOptions\n}\n\n\n\nexport class CustomDocFieldHandler extends ItemSelectionFromToAbstractDocFieldHandler implements IDocFieldHandler {\n     static default_config:IDHFCustomSectionOptions = {\n        default: {\n            includeInToc: false, landscape: false, options: {\n                description:\"\",\n                descriptionContent: \"\",\n                descriptionNoContent: \"<p>not applicable</p>\",\n                formatter:\"\"\n            }}\n    }\n\n\n    getDefaultConfig() {\n        return CustomDocFieldHandler.default_config.default;\n    }\n\n    public getXmlValue(): string {\n\n        let controllerConfig = this.dhfFieldConfig;\n\n        // get lists\n        let reflist = this.getSelectedItems();\n\n        let td: IGenericMap[] = [];\n        let r0: IGenericMap = {};\n        for (let idx = 0; idx < reflist.from.length; idx++) {\n            r0[\"from\" + idx] = reflist.from[idx].to;\n        }\n        td.push(r0);\n\n        let r1: IGenericMap = {};\n        for (let idx = 0; idx < reflist.to.length; idx++) {\n            r1[\"to\" + idx] = reflist.to[idx].to;\n        }\n        td.push(r1);\n\n        // copy parameters\n\n        let r2: IGenericMap = {};\n        r2[\"SETTINGS\"] = JSON.stringify(controllerConfig.options);\n\n        td.push(r2);\n\n        // return the xml dump\n        return JSON.stringify(td);\n    }\n\n\n}\n","import {ItemSelectionFieldHandlerFromTo} from \"../ItemSelectionFieldHandlerFromTo\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {IDHFControlDefinition} from \"../../DHFInterfaces\";\n\nexport abstract class ItemSelectionFromToAbstractDocFieldHandler extends ItemSelectionFieldHandlerFromTo implements IDocFieldHandler {\n    dhfFieldConfig: IAnyMap;\n\n    constructor(fielType: string, config: IAnyMap, fieldValue: string) {\n        super(config, fielType);\n\n        if (!config)\n            config = this.getDefaultConfig()\n        this.dhfFieldConfig = config;\n\n        this.initData(fieldValue);\n    }\n\n    setDHFConfig(config: IAnyMap): void {\n        this.dhfFieldConfig = config;\n    }\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n    abstract getDefaultConfig(): any ;\n\n    abstract  getXmlValue(): string;\n\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n\n}\n\n\n","import {IFieldHandler} from \"./IFieldHandler\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../ItemConfiguration\";\nimport {IFromToSelection} from \"../../UI/Controls/itemSelectionFromTo\";\nimport {IAnyMap, IReference} from \"../../../globals\";\n\nexport class ItemSelectionFieldHandlerFromTo implements IFieldHandler {\n    protected config: XRFieldTypeAnnotatedParamJson;\n    private fieldType: string;\n\n    private selectedItems: IFromToSelection;\n    private defaultSelection: IReference[] = [];\n\n\n    constructor(configIn: XRFieldTypeAnnotatedParamJson, fieldTypeIn?: string) {\n        this.config = configIn;\n        this.fieldType = fieldTypeIn;\n        // initialize object\n        this.selectedItems = {from: [], to: []};\n    }\n\n\n    getData(): string {\n        return JSON.stringify(this.selectedItems);\n    }\n\n    getFieldType(): string {\n        return this.fieldType;\n    }\n\n    initData(serializedFieldData: string) {\n        this.selectedItems = {from: [], to: []};\n        if (serializedFieldData && serializedFieldData !== 'undefined' && serializedFieldData !== \"\") {\n            this.selectedItems = JSON.parse(serializedFieldData);\n        } else if (this.config && this.config.parameter &&  this.config.parameter.allTo) {\n            this.selectedItems.to = this.defaultSelection;\n        }\n    }\n\n    getSelectedItems() {\n        return this.selectedItems;\n    }\n\n    setSelectedItems(data: IFromToSelection) {\n        this.selectedItems = data;\n    }\n\n    setFromSelectiont(newSelection: IReference[]) {\n        this.selectedItems.from = newSelection;\n    }\n\n    setToSelectiont(newSelection: IReference[]) {\n        this.selectedItems.to = newSelection;\n    }\n\n    isDefaultSelection() {\n        if (this.defaultSelection.length !== this.selectedItems.to.length) {\n            return false;\n        }\n        const notInDefault = this.selectedItems.to.filter((d: IReference) => {\n            return this.defaultSelection.reduce((prev, item) => {\n                if (item.to === d.to) {\n                    return false;\n                } else {\n                    return prev;\n                }\n            }, true);\n        })\n        return notInDefault.length === 0;\n    }\n\n    setDefaultSelection(map: IReference[]) {\n        this.defaultSelection = map;\n    }\n\n    setConfig(config: IAnyMap) {\n        this.config = config;\n\n    }\n}\n","import {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {DropdownAbstractDocFieldHandler} from \"./DropdownAbstractDocFieldHandler\";\n\n\nexport type { IRemarkOptions, IDHFRemarksConfig };\n\ninterface IRemarkOptions extends IDHFSectionOptions {\n\n}\n\ninterface IDHFRemarksConfig {\n    default:object\n}\n\nexport class RemarksDocFieldHandler extends DropdownAbstractDocFieldHandler {\n\n    static default_config:IDHFRemarksConfig = {\n        default:{}\n    };\n    getXmlValue(): string {\n        let tt: { lines: string }[] = [];\n        tt.push({lines: this.getData()});\n        return JSON.stringify(tt);\n    }\n\n    getDefaultConfig(): any {\n        return RemarksDocFieldHandler.default_config.default;\n    }\n}\n","import {DropdownFieldHandler, IBaseDropdownFieldParams} from \"../DropdownFieldHandler\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {ItemConfiguration} from \"../../ItemConfiguration\";\n\nexport abstract class DropdownAbstractDocFieldHandler extends DropdownFieldHandler implements IDocFieldHandler {\n\n    private sectionType: string;\n    dhfFieldConfig: IAnyMap;\n\n\n    constructor(protected itemConfig: ItemConfiguration, type: string, config: IBaseDropdownFieldParams, initialValue?: string) {\n        super(config, initialValue);\n        if (!config)\n            config = this.getDefaultConfig()\n        this.dhfFieldConfig = config;\n        this.sectionType = type;\n\n    }\n    getFieldType(): string {\n        return this.sectionType;\n    }\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n    abstract getDefaultConfig(): any;\n\n    abstract  getXmlValue(): string;\n\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n\n}\n","import {CheckboxFieldHandler} from \"../CheckboxFieldHandler\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../../ItemConfiguration\";\nimport {IAnyMap, IGenericMap} from \"../../../../globals\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\n\n\nexport type {ICheckboxOptions, IDHFCheckboxConfig};\n\ninterface ICheckboxOptions extends IDHFSectionOptions {\n\n}\n\ninterface IDHFCheckboxConfig {\n    default: object\n}\n\nexport class CheckBoxDocFieldHandler extends CheckboxFieldHandler implements IDocFieldHandler {\n\n    private sectionType: string;\n\n    constructor(sectionType: string, config: XRFieldTypeAnnotatedParamJson, fieldValue: string) {\n        super(config);\n        this.sectionType = sectionType;\n        if(!config)\n            config = this.getDefaultConfig()\n        this.dhfFieldConfig = config;\n        this.initData(fieldValue);\n    }\n    getFieldType(): string {\n        return this.sectionType;\n    }\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n    static  default_config: IDHFCheckboxConfig = {\n        default: {}\n    };\n    dhfFieldConfig: IAnyMap;\n    getDefaultConfig() {\n        return CheckBoxDocFieldHandler.default_config.default;\n    }\n\n    setDHFConfig(config: IAnyMap): void {\n        this.dhfFieldConfig = config;\n    }\n    getXmlValue(): string {\n        let xmlval: IGenericMap[] = [];\n        let val = this.getValue();\n        xmlval.push({\"checked\": val ? \"true\" : \"false\"});\n        return JSON.stringify(xmlval);\n    }\n\n    protected  name = \"\";\n    getFieldName(): string {\n        return this.name;\n    }\n\n    setFieldName(value: string): void {\n        this.name = value;\n    }\n}\n","import {ItemSelectionFieldHandler} from \"../ItemSelectionFieldHandler\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap, IGenericMap} from \"../../../../globals\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../../ItemConfiguration\";\nimport {extend} from \"../../../matrixlib/JQueryExtendReplacement\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\n\n\nexport type { IDesignReviewsOptions, IDHFDesignReviewsConfig };\n\ninterface IDesignReviewsOptions extends IDHFSectionOptions {\n    reviews:string[],\n    user:boolean,\n    date: boolean,\n    revision: boolean,\n    comment: boolean,\n    includeInToc: boolean,\n    numericalOrder: boolean,\n    search?:string\n}\n\ninterface IDHFDesignReviewsConfig {\n    default:IDesignReviewsOptions\n}\nexport class DesignReviewDocFieldHandler extends ItemSelectionFieldHandler implements  IDocFieldHandler{\n     dhfFieldConfig: IAnyMap;\n\n\n    constructor(sectionType: string,  config: XRFieldTypeAnnotatedParamJson,fieldValue:string){\n        super(config, sectionType);\n        if(!config)\n            config = this.getDefaultConfig()\n        this.dhfFieldConfig = config;\n        this.initData(fieldValue);\n    }\n    static defaut_config:IDHFDesignReviewsConfig = {\n        default: { reviews:[], user:false, date:false, revision:false, comment:false, includeInToc:false, numericalOrder:false}\n    };\n    getDefaultConfig() {\n        return DesignReviewDocFieldHandler.defaut_config.default;\n    }\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n    getXmlValue(): string {\n\n        let js = this.getItems();\n\n        if (!js) {\n             return  JSON.stringify({});\n        }\n\n        let controllerConfig =this. dhfFieldConfig;\n\n        let reviews = {\n            user:controllerConfig.user,\n            date:controllerConfig.date,\n            revision:controllerConfig.revision,\n            comment:controllerConfig.comment,\n            includeInToc:controllerConfig.includeInToc,\n            numericalOrder:controllerConfig.numericalOrder\n        };\n\n        for(let review of controllerConfig.reviews) {\n            (<IGenericMap>reviews)[review] = '1';\n        }\n\n        for (let row = 0; row < js.length; row++) {\n            extend(true, js[row], reviews);\n        }\n\n        return   JSON.stringify(js);\n\n    }\n\n\n\n}\n","export { extend };\n\n// This is ported from the JQuery 3.5.1 codebase. It is tough to get a recursive extend function\n// exactly right. Safest option is to keep the implementation we've used for years, and eliminate\n// the JQuery dependency.\n\nfunction isFunction(obj) {\n    // Support: Chrome <=57, Firefox <=52\n    // In some browsers, typeof returns \"function\" for HTML <object> elements\n    // (i.e., `typeof document.createElement( \"object\" ) === \"function\"`).\n    // We don't want to classify *any* DOM node as a function.\n    return typeof obj === \"function\" && typeof obj.nodeType !== \"number\";\n}\n\nvar class2type = {};\nconst hasOwn = class2type.hasOwnProperty;\nconst fnToString = hasOwn.toString;\nconst ObjectFunctionString = fnToString.call(Object);\n\nfunction isPlainObject(obj) {\n    var proto, Ctor;\n\n    // Detect obvious negatives\n    // Use toString instead of jQuery.type to catch host objects\n    if (!obj || toString.call(obj) !== \"[object Object]\") {\n        return false;\n    }\n\n    proto = Object.getPrototypeOf(obj);\n\n    // Objects with no prototype (e.g., `Object.create( null )`) are plain\n    if (!proto) {\n        return true;\n    }\n\n    // Objects with prototype are plain iff they were constructed by a global Object function\n    Ctor = hasOwn.call(proto, \"constructor\") && proto.constructor;\n    return typeof Ctor === \"function\" && fnToString.call(Ctor) === ObjectFunctionString;\n}\n\nfunction extend(...args: any[]): any {\n    var options, name, src, copy, copyIsArray, clone,\n        target = arguments[0] || {},\n        i = 1,\n        length = arguments.length,\n        deep = false;\n\n    // Handle a deep copy situation\n    if (typeof target === \"boolean\") {\n        deep = target;\n\n        // Skip the boolean and the target\n        target = arguments[i] || {};\n        i++;\n    }\n\n    // Handle case when target is a string or something (possible in deep copy)\n    if (typeof target !== \"object\" && !isFunction(target)) {\n        target = {};\n    }\n\n    // Extend jQuery itself if only one argument is passed\n    if (i === length) {\n        target = this;\n        i--;\n    }\n\n    for (; i < length; i++) {\n\n        // Only deal with non-null/undefined values\n        if ((options = arguments[i]) != null) {\n\n            // Extend the base object\n            for (name in options) {\n                copy = options[name];\n\n                // Prevent Object.prototype pollution\n                // Prevent never-ending loop\n                if (name === \"__proto__\" || target === copy) {\n                    continue;\n                }\n\n                // Recurse if we're merging plain objects or arrays\n                if (deep && copy && (isPlainObject(copy) ||\n                    (copyIsArray = Array.isArray(copy)))) {\n                    src = target[name];\n\n                    // Ensure proper type for the source value\n                    if (copyIsArray && !Array.isArray(src)) {\n                        clone = [];\n                    } else if (!copyIsArray && !isPlainObject(src)) {\n                        clone = {};\n                    } else {\n                        clone = src;\n                    }\n                    copyIsArray = false;\n\n                    // Never move original objects, clone them\n                    target[name] = extend(deep, clone, copy);\n\n                    // Don't bring in undefined values\n                } else if (copy !== undefined) {\n                    target[name] = copy;\n                }\n            }\n        }\n    }\n\n    // Return the modified object\n    return target;\n}\n\n\nvar initCalled: boolean = false;\nfunction init() {\n    if (initCalled) return;\n    initCalled = true;\n\n    const typeStrings = [\"Boolean\", \"Number\", \"String\", \"Function\", \"Array\", \"Date\", \"RegExp\", \"Object\", \"Error\", \"Symbol\"];\n    typeStrings.forEach((t) => {\n        class2type[\"[object \" + t + \"]\"] = t.toLowerCase();\n    });\n}\n\ninit();","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {ITableOfContentOptions} from \"./TableOfContentDocFieldHandler\";\nimport {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\n\nexport type { IItemIndexOptions, IDHFItemIndexConfig };\n\ninterface IItemIndexOptions extends IDHFSectionOptions {\n    format:string\n}\ninterface IDHFItemIndexConfig {\n    default:IItemIndexOptions\n}\n\n\n\n\nexport class ItemIndexDocFieldHander extends GenericDocAbstractFieldHandler implements IDocFieldHandler {\n\n    dhfFieldConfig: IAnyMap;\n    static defaultConfig:IDHFItemIndexConfig = {default:{ format:'\\\\e \"\\\\t\" \\\\c \"1\"'}}\n\n    getXmlValue(): string {\n\n        let controllerConfig = this.dhfFieldConfig;\n        if( this.dhfFieldConfig == undefined)\n            controllerConfig = ItemIndexDocFieldHander.defaultConfig;\n        let options: ITableOfContentOptions = {format: controllerConfig.format};\n        return  JSON.stringify([options]);\n    }\n\n\n    getDefaultConfig(): any {\n        return ItemIndexDocFieldHander.defaultConfig.default;\n    }\n\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap, IReference} from \"../../../../globals\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {extend} from \"../../../matrixlib/JQueryExtendReplacement\";\nimport {IItemsFromConfig, IItemsOptions, ItemSelectionAbstractDocFieldHandler} from \"./ItemSelectionAbstractDocFieldHandler\";\n\nexport interface IItemListOptions extends IDHFSectionOptions {\n    recursive: boolean, tree:boolean, refdocs:boolean, hideEmptyFolders:boolean, showParentFolders:boolean, includeInToc:boolean, sortedList:boolean, search?:string\n}\n\nexport interface IDHFItemListConfig {\n    default:IItemListOptions\n    defaultPackage:IItemListOptions\n}\n\nexport class ItemListDocFieldHandler extends ItemSelectionAbstractDocFieldHandler implements IDocFieldHandler {\n    getDefaultConfig() {\n        return ItemListDocFieldHandler.default_config.default;\n    }\n    static default_config: IItemsFromConfig = {\n        default: {\n            breadcrumb: true,\n            folderDetails: '',\n            extracolumn: '',\n            showlinks: true,\n            showUpOnly: false,\n            showDownOnly: false,\n            showDeeplinks: false,\n            showExternal: 0,\n            dateoptions: '',\n            refdocs: false,\n            hideLinkErrors: false,\n            hideLabels: false,\n            showAllParentFolders: false,\n            hideEmptyFolders: false,\n            includeInToc: false,\n            breakAfterItems: false\n        }\n    };\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n\n    getXmlValue(): string {\n\n        let js = <IReference[]>this.getItems();\n\n        // add params (parameter: \"showbreadcrumb:true,extracolumn:EX\") to each row\n        let controllerConfig = this.dhfFieldConfig;\n\n        for (let row = 0; row < js.length; row++) {\n            extend(true, js[row], controllerConfig);\n        }\n        return JSON.stringify(js);\n    }\n\n}\n","import {ItemSelectionFieldHandler} from \"../ItemSelectionFieldHandler\";\nimport {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IAnyMap} from \"../../../../globals\";\nimport {XRFieldTypeAnnotatedParamJson} from \"../../ItemConfiguration\";\n\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\n\nexport type { IItemsOptions, IItemsFromConfig };\n\ninterface IItemsOptions extends IDHFSectionOptions {\n    folderDetails:string, extracolumn:string, showlinks:boolean, showUpOnly:boolean, showDownOnly:boolean,\n    showDeeplinks:boolean, breadcrumb:boolean,    showExternal:number,\n    dateoptions:string,refdocs:boolean, hideLinkErrors:boolean, hideLabels:boolean,\n    hideEmptyFolders:boolean, showAllParentFolders:boolean, includeInToc:boolean, search?:string,\n    breakAfterItems:boolean\n\n}\n\ninterface IItemsFromConfig {\n    default:IItemsOptions\n}\n\n\nexport abstract class ItemSelectionAbstractDocFieldHandler extends ItemSelectionFieldHandler implements IDocFieldHandler {\n    dhfFieldConfig: IAnyMap;\n\n    abstract getDefaultConfig(): any;\n    addSignatures (signatures: string[],includeAll:boolean ) {\n        //Nothing to do here\n    }\n    constructor(sectionType: string, config: XRFieldTypeAnnotatedParamJson, fieldValue: string) {\n        super(config, sectionType);\n        if (!config)\n            config = this.getDefaultConfig()\n        this.dhfFieldConfig = config;\n\n        this.initData(fieldValue);\n    }\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n\n    abstract getXmlValue();\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {IReference} from \"../../../../globals\";\nimport {IItemListOptions} from \"./ItemListDocFieldHandler\";\nimport {ItemSelectionAbstractDocFieldHandler} from \"./ItemSelectionAbstractDocFieldHandler\";\n\n\n\nexport type { ILinkListOptions, IDHFLinkListConfig };\n\ninterface ILinkListOptions extends IDHFSectionOptions {\n    showExternal: number, includeInToc:boolean, search?:string\n}\n\ninterface IDHFLinkListConfig {\n    default:ILinkListOptions\n}\n\nexport class LinkListDocFieldHandler extends ItemSelectionAbstractDocFieldHandler implements IDocFieldHandler {\n\n    getDefaultConfig() {\n        return LinkListDocFieldHandler.default_config.default;\n    }\n\n    static default_config:IDHFLinkListConfig = {default:{showExternal: 1, includeInToc:false}}\n    getXmlValue(): string {\n        let reflist = <IReference[]> this.getItems();\n        for (let idx = 0; idx < reflist.length; idx++) {\n            (<ILinkListOptions><any>reflist[idx])['showExternal'] = this.dhfFieldConfig.showExternal;\n            (<IItemListOptions><any>reflist[idx])['includeInToc'] = this.dhfFieldConfig.includeInToc;\n        }\n        return  JSON.stringify(reflist);\n    }\n\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {IAnyMap, IReference} from \"../../../../globals\";\nimport {ItemSelectionAbstractDocFieldHandler} from \"./ItemSelectionAbstractDocFieldHandler\";\n\n\nexport type { IItemTableOptions, IDHFItemTableConfig };\n\ninterface IItemTableOptions extends IDHFSectionOptions {\n    includeInToc:boolean, sortedList:boolean, includeFolders:boolean, columns:string, search?:string\n}\n\ninterface IDHFItemTableConfig {\n    default:IItemTableOptions\n}\nexport class ItemTableDocFieldHandler extends ItemSelectionAbstractDocFieldHandler implements IDocFieldHandler {\n    getDefaultConfig() {\n        return ItemTableDocFieldHandler.default_config.default;\n    }\n    static default_config: IDHFItemTableConfig = {\n        default: {includeInToc: false, sortedList: false, includeFolders: false, columns: \"item,labels,down\"}\n    };\n\n    getXmlValue(): string {\n\n        let reflist = <IReference[]>this.getItems();\n        for (let idx = 0; idx < reflist.length; idx++) {\n            (<IItemTableOptions><any>reflist[idx])['includeInToc'] = this.dhfFieldConfig.includeInToc;\n            (<IItemTableOptions><any>reflist[idx])['includeFolders'] =this.dhfFieldConfig.includeFolders;\n            (<IItemTableOptions><any>reflist[idx])['sortedList'] =this.dhfFieldConfig.sortedList;\n            (<IItemTableOptions><any>reflist[idx])['columns'] = this.dhfFieldConfig.columns;\n        }\n        return  JSON.stringify(reflist);\n\n    }\n\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {IReference} from \"../../../../globals\";\nimport {extend} from \"../../../matrixlib/JQueryExtendReplacement\";\nimport {ItemSelectionAbstractDocFieldHandler} from \"./ItemSelectionAbstractDocFieldHandler\";\n\n\nexport type { IRiskStatsOptions, IDHFRiskStatsConfig };\n\ninterface IRiskStatsOptions extends IDHFSectionOptions {\n    includeInToc:boolean,\n    table:string,\n    rbm:string,\n    ram:string,\n    noTest:string,\n    mustReduce:string,\n    noBenefits:string,\n    riskNoTest:string,\n    riskAfterByZone:string,\n    riskBeforeByZone:string,\n    mitNoTest:string,\n    traceMitTest:string,\n    search?:string\n}\n\ninterface IDHFRiskStatsConfig {\n    default:IRiskStatsOptions\n}\nexport class RiskStatsDocFieldHandler extends ItemSelectionAbstractDocFieldHandler implements IDocFieldHandler {\n    getDefaultConfig() {\n     return RiskStatsDocFieldHandler.default_config.default ;\n    }\n\n    static default_config: IDHFRiskStatsConfig = {\n        default: {\n            includeInToc: false,\n            table: \"Risk table\",\n            rbm: \"Risk levels before controls\",\n            ram: \"Risk levels after controls\",\n            noTest: \"Test coverage overview\",\n            mustReduce: \"Risks which need to be further reduced\",\n            noBenefits: \"Risks which are not justified by benefits\",\n            riskAfterByZone: \"Risks by zone after control\",\n            riskBeforeByZone: \"Risks by zone before control\",\n            riskNoTest: \"Risks without tests\",\n            mitNoTest: \"Risk controls without tests\",\n            traceMitTest: \"Traces from risks to tests\"\n        }\n    };\n\n    getXmlValue(): string {\n        let reflist = <IReference[]>this.getItems();\n        for (let idx = 0; idx < reflist.length; idx++) {\n            extend(true, reflist[idx], this.dhfFieldConfig);\n        }\n        return  JSON.stringify(reflist);\n    }\n\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {SectionDescriptions} from \"./SectionDescriptions\";\nimport {IAnyMap, IReference} from \"../../../../globals\";\nimport {IDHFItemListConfig, IItemListOptions} from \"./ItemListDocFieldHandler\";\nimport {ItemSelectionAbstractDocFieldHandler} from \"./ItemSelectionAbstractDocFieldHandler\";\n\nexport class ItemRefDocFieldHandler extends ItemSelectionAbstractDocFieldHandler implements IDocFieldHandler {\n    static default_configs: IDHFItemListConfig = {\n        default: {\n            recursive: true,\n            tree: true,\n            refdocs: false,\n            hideEmptyFolders: false,\n            includeInToc: false,\n            sortedList: false,\n            showParentFolders: false\n        },\n        defaultPackage: {\n            recursive: false,\n            tree: false,\n            refdocs: false,\n            hideEmptyFolders: false,\n            includeInToc: false,\n            sortedList: true,\n            showParentFolders: false\n        }\n    };\n    setDHFConfig(config: IAnyMap) {\n        this.dhfFieldConfig = config;\n    }\n\n    getDefaultConfig() {\n        if (this.fieldType == SectionDescriptions.section_itemlist)\n            return ItemRefDocFieldHandler.default_configs.default;\n        else\n            return ItemRefDocFieldHandler.default_configs.defaultPackage;\n    }\n\n    constructor(type: string, ctrlConfig: IAnyMap, fieldValue: string) {\n        super(type, ctrlConfig, fieldValue);\n        this.initData(fieldValue);\n    }\n\n    getXmlValue(): string {\n        let reflist = this.getItems();\n\n        for (let ref of reflist) {\n            let refOption = <IItemListOptions><any>ref;\n            refOption['recursive'] = this.dhfFieldConfig.recursive;\n            refOption['tree'] = this.dhfFieldConfig.tree;\n            refOption['hideEmptyFolders'] = this.dhfFieldConfig.hideEmptyFolders;\n            refOption['showParentFolders'] = this.dhfFieldConfig.showParentFolders;\n            refOption['includeInToc'] = this.dhfFieldConfig.includeInToc;\n            refOption['sortedList'] = this.dhfFieldConfig.sortedList;\n        }\n        return JSON.stringify(reflist);\n    }\n\n\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\n\nexport interface IListOfFiguresOptions extends IDHFSectionOptions {\n    figures?:boolean,\n    tables?:boolean\n}\n\nexport  interface IListOfFiguresConfig {\n    default:IListOfFiguresOptions\n}\n\nexport  class ListOfFiguresDocFieldHandler extends GenericDocAbstractFieldHandler implements IDocFieldHandler {\n\n    static default_config: IListOfFiguresConfig = {\n        default: {\n            figures: true, tables: true\n        }\n    };\n\n    getXmlValue(): string {\n        return JSON.stringify([this.dhfFieldConfig])\n    }\n\n    getDefaultConfig() {\n        return ListOfFiguresDocFieldHandler.default_config.default\n    }\n}\n","import {GenericDocFieldHandler} from \"./GenericDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\n\n\n\nexport type { ISmartTextOptions, IDHFSmartTextConfig };\n\ninterface ISmartTextOptions extends IDHFSectionOptions {\n    plaintext?:boolean, richtext?:boolean, abbreviations?:boolean, terms?:boolean, customerTags?:boolean, projectTags?:boolean, includeAll?:boolean,\n    firstColumnName:string, secondColumnName:string\n}\n\ninterface IDHFSmartTextConfig {\n    default:ISmartTextOptions\n}\n\n\n\nexport class SmartTextDocFieldHandler extends GenericDocAbstractFieldHandler {\n    static default_config:IDHFSmartTextConfig = {default:{\n            plaintext:false, richtext:false, abbreviations:true, terms:true, customerTags:true, projectTags:true, includeAll:false,\n            firstColumnName:\"\", secondColumnName:\"\"\n        }};\n    getDefaultConfig() {\n        return SmartTextDocFieldHandler.default_config.default;\n    }\n    getXmlValue(): string {\n        let options:ISmartTextOptions = {\n            abbreviations: this.dhfFieldConfig.abbreviations,\n            terms:this.dhfFieldConfig.terms,\n            richtext:this.dhfFieldConfig.richtext,\n            plaintext: this.dhfFieldConfig.plaintext,\n            includeAll: this.dhfFieldConfig.includeAll,\n            customerTags: true,\n            projectTags: true,\n            firstColumnName:this.dhfFieldConfig.firstColumnName?this.dhfFieldConfig.firstColumnName:\"\",\n            secondColumnName:this.dhfFieldConfig.secondColumnName?this.dhfFieldConfig.secondColumnName:\"\"\n        }\n        return JSON.stringify([options]);\n\n    }\n\n}\n","import {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nexport type { ITableOfContentOptions, IDHFTableOfContentConfig };\n\ninterface ITableOfContentOptions extends IDHFSectionOptions {\n    format:string, render_toc?:boolean\n}\n\ninterface IDHFTableOfContentConfig {\n    default:ITableOfContentOptions\n}\nexport class TableOfContentDocFieldHandler extends GenericDocAbstractFieldHandler {\n\n    static  default_config:IDHFTableOfContentConfig = { default: { format:\"\\\\o \\\"1-3\\\" \\\\h \\\\z \\\\u \\\\f\"}}\n\n    getDefaultConfig(): any {\n        return TableOfContentDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n        let options:ITableOfContentOptions = { format : this.dhfFieldConfig.format };\n        return JSON.stringify([options]);\n    }\n}\n","import {IDocFieldHandler} from \"./IDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\nimport {IFromToSelection} from \"../../../UI/Controls/itemSelectionFromTo\";\nimport {IGenericMap} from \"../../../../globals\";\nimport {CustomDocFieldHandler} from \"./CustomDocFieldHandler\";\nimport {ItemSelectionFromToAbstractDocFieldHandler} from \"./ItemSelectionFromToAbstractDocFieldHandler\";\n\nexport type { ITestResultsOptions, IDHFTestResultsConfig };\n\ninterface ITestResultsOptions extends IDHFSectionOptions {\n    lastOnly:boolean, lastCreatedOnly:boolean, completeTree:boolean, failedOnly:boolean, dateoptions:string,\n    includeInToc:boolean, numericalOrder:boolean, searchFrom?:string, searchTo?:string\n}\n\ninterface IDHFTestResultsConfig {\n    default:ITestResultsOptions\n}\n\n\n\nexport class TestResultsDocFieldHandler extends ItemSelectionFromToAbstractDocFieldHandler implements IDocFieldHandler{\n\n    static default_config:IDHFTestResultsConfig = {default: {lastOnly:true, lastCreatedOnly:false, completeTree:false, failedOnly:false, dateoptions:'', includeInToc:false, numericalOrder:false}}\n\n    getDefaultConfig(): any {\n        return TestResultsDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n\n        let  controllerConfig = this.dhfFieldConfig;\n\n        // get lists\n        let reflist = <IFromToSelection> this.getSelectedItems();\n        let td:IGenericMap[] = [];\n        let r0:IGenericMap = {};\n        for (let idx = 0; idx < reflist.from.length; idx++) {\n            r0[\"from\" + idx] = reflist.from[idx].to;\n        }\n        td.push(r0);\n\n        let r1:IGenericMap = {};\n        for (let idx = 0; idx < reflist.to.length; idx++) {\n            r1[\"to\" + idx] = reflist.to[idx].to;\n        }\n        td.push(r1);\n\n        td.push({lastOnly:controllerConfig.lastOnly});\n        td.push({lastCreatedOnly:controllerConfig.lastCreatedOnly});\n        td.push({completeTree:controllerConfig.completeTree});\n        td.push({failedOnly:controllerConfig.failedOnly});\n        td.push({includeInToc:controllerConfig.includeInToc});\n        td.push({numericalOrder:controllerConfig.numericalOrder});\n\n        td.push({dateoptions:controllerConfig.dateoptions});\n        return JSON.stringify(td);\n    }\n\n}\n","import {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {ItemSelectionFieldHandler} from \"../ItemSelectionFieldHandler\";\nimport {ItemSelectionFromToAbstractDocFieldHandler} from \"./ItemSelectionFromToAbstractDocFieldHandler\";\nimport {IFromToSelection} from \"../../../UI/Controls/itemSelectionFromTo\";\nimport {IGenericMap} from \"../../../../globals\";\n\nexport type { IDerivedFromOptions, IDHFDerivedFromConfig };\n\ninterface IDerivedFromOptions extends IDHFSectionOptions {\n    render:string,\n    includeInToc:boolean,\n    numericalOrder:boolean,\n    noHitMessage:string,\n    searchFrom?:string,\n    searchTo?:string\n}\n\ninterface IDHFDerivedFromConfig {\n    default:IDerivedFromOptions\n}\n\nexport class DerivedFromDocFieldHandler extends ItemSelectionFromToAbstractDocFieldHandler {\n    static  default_config:IDHFDerivedFromConfig = {\n        default: {render:'items', includeInToc:false, numericalOrder:false, noHitMessage:\"\"} // list, items, tree, table\n    };\n\n    getDefaultConfig(): any {\n        return DerivedFromDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n        let reflist = this.getSelectedItems();\n        let td: IGenericMap[] = [];\n        let r0: IGenericMap = {};\n        for (let idx = 0; idx < reflist.from.length; idx++) {\n            r0[\"from\" + idx] = reflist.from[idx].to;\n        }\n        td.push(r0);\n\n        let r1: IGenericMap = {};\n        for (let idx = 0; idx < reflist.to.length; idx++) {\n            r1[\"to\" + idx] = reflist.to[idx].to;\n        }\n        td.push(r1);\n\n        // copy parameters\n\n        let r2: IGenericMap = {...this.dhfFieldConfig};\n        td.push(r2);\n        // update the xml dump\n       return JSON.stringify(td);\n    }\n}\n","import {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\n\n\nexport type { IDocumentOptionsOptions };\n\ninterface IDocumentOptionsOptions extends IDHFSectionOptions {\n    auto_number?:boolean,\n    omit_title?:boolean,\n    internal_links?:boolean,\n    no_folder_ids?:boolean,\n    hide_links?:boolean // if true does not show boxes with cross project and file links\n}\n\n\n\nexport class DocumentOptionsFieldHandler extends GenericDocAbstractFieldHandler {\n    static default_config =   {\n        default: { auto_number:true, omit_title:true, internal_links:false}\n    };\n\n    getDefaultConfig(): any {\n        return DocumentOptionsFieldHandler.default_config.default;\n    }\n\n    setDHFConfig(config: IDocumentOptionsOptions): void {\n        this.dhfFieldConfig = config;\n    }\n\n    getXmlValue(): string {\n        let controllerConfig =  this.dhfFieldConfig;\n\n        let options:IDocumentOptionsOptions = {};\n        options.auto_number = controllerConfig.auto_number || false ;\n        options.omit_title = controllerConfig.omit_title || false ;\n        options.internal_links = controllerConfig.internal_links || false ;\n        options.no_folder_ids = controllerConfig.no_folder_ids|| false ;\n        options.hide_links = controllerConfig.hide_links || false ;\n\n        return  JSON.stringify([options]);\n    }\n\n}\n\n","import {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\nimport {RichTextDocFieldHandler} from \"./RichTextDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\n\nexport type { ITextLineOptions, IDHFTextLineConfig };\n\ninterface ITextLineOptions extends IDHFSectionOptions {\n}\n\ninterface IDHFTextLineConfig {\n    default:ITextLineOptions\n}\nexport class TextLineDocFieldHandler extends GenericDocAbstractFieldHandler {\n    static default_config = {\n        default: {}\n    };\n\n    getDefaultConfig(): any {\n        return RichTextDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n        return JSON.stringify([]);\n    }\n\n}\n","import {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\n\n\nexport type { IRichTextOptions, IDHFRichTextConfig };\n\ninterface IRichTextOptions extends IDHFSectionOptions {\n}\n\ninterface IDHFRichTextConfig {\n    default:IRichTextOptions\n}\n\n\nexport class RichTextDocFieldHandler extends GenericDocAbstractFieldHandler {\n    static default_config = {\n        default: {}\n    };\n\n    getDefaultConfig(): any {\n        return RichTextDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n        return JSON.stringify([]);\n    }\n\n}\n\n\n","import {ItemSelectionFromToAbstractDocFieldHandler} from \"./ItemSelectionFromToAbstractDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {IFromToSelection} from \"../../../UI/Controls/itemSelectionFromTo\";\nimport {IGenericMap} from \"../../../../globals\";\n\n\nexport type { ITraceMatrixOptions, IDHFTraceMatrixConfig };\ninterface ITraceMatrixOptions extends IDHFSectionOptions {\n    includeInToc:boolean,\n    numericalOrder:boolean,\n    showIdOnly:boolean,\n    searchFrom?:string,\n    searchTo?:string,\n    columnDef?:string\n}\n\ninterface IDHFTraceMatrixConfig {\n    default:ITraceMatrixOptions\n}\nexport class TraceMatrixDocFieldHandler extends ItemSelectionFromToAbstractDocFieldHandler {\n\n\n    static default_config:IDHFTraceMatrixConfig =  {\n        default: {includeInToc:false, numericalOrder:false, showIdOnly:false, columnDef:\"\"}\n    };\n\n\n    getDefaultConfig(): any {\n        return TraceMatrixDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n\n        let controllerConfig = this.dhfFieldConfig;\n        // get lists\n        let reflist = <IFromToSelection>this.getSelectedItems();\n\n        let td: IGenericMap[] = [];\n        let r0: IGenericMap = {};\n        for (let idx = 0; idx < reflist.from.length; idx++) {\n            r0[\"from\" + idx] = reflist.from[idx].to;\n        }\n        td.push(r0);\n\n        let r1: IGenericMap = {};\n        for (let idx = 0; idx < reflist.to.length; idx++) {\n            r1[\"to\" + idx] = reflist.to[idx].to;\n        }\n        td.push(r1);\n\n        // copy parameters\n\n        let r2: IGenericMap = {...this.dhfFieldConfig};\n\n        td.push(r2);\n\n        // update the xml dump\n        return   JSON.stringify(td);\n    }\n}\n","import {DropdownAbstractDocFieldHandler} from \"./DropdownAbstractDocFieldHandler\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\n\n\nexport type { ITracesOptions, IDHFTracesConfig, ITracesValue };\n\ninterface ITracesOptions extends IDHFSectionOptions {\n    strict?: boolean, dateoptions?:string, includeInToc?:boolean, numericalOrder?:boolean\n}\n\ninterface IDHFTracesConfig {\n    default:ITracesOptions\n}\n\ninterface ITracesValue extends ITracesOptions {\n    from?:string, to?:string\n}\n\n\n\n\nexport class TraceDocFieldHandler extends DropdownAbstractDocFieldHandler {\n\n    static default_config:IDHFTracesConfig = {default:\n            {strict: true, dateoptions:'', includeInToc:false, numericalOrder:false}\n    }\n    getDefaultConfig(): any {\n        return TraceDocFieldHandler.default_config.default;\n    }\n\n    getXmlValue(): string {\n        let data = this.getData();\n        let traces:ITracesValue = {};\n        if (data) {\n            let sel = data.split('|');\n            traces.from = sel[0];\n            traces.to = sel[1].split(\"+\").join(\",\");\n        }\n        traces.strict = this.dhfFieldConfig.strict;\n        traces.dateoptions = this.dhfFieldConfig.dateoptions;\n        traces.includeInToc = this.dhfFieldConfig.includeInToc;\n        traces.numericalOrder = this.dhfFieldConfig.numericalOrder;\n\n        return JSON.stringify([traces]);\n    }\n}\n","import {IDropDownConfig, IDropdownOption} from \"../../../../ProjectSettings\";\nimport {IDHFSectionOptions} from \"../../PluginManagerDocuments\";\nimport {DropdownAbstractDocFieldHandler} from \"./DropdownAbstractDocFieldHandler\";\n\n\nexport type { IMultiSelectOptions, IDHFMultiSelectConfig };\n\ninterface IMultiSelectOptions extends IDHFSectionOptions {\n    maxItems: number, create:boolean, sort:boolean, optionSetting:string;\n}\n\ninterface IDHFMultiSelectConfig {\n    default:IMultiSelectOptions\n}\n\n\nexport class MultiSelectDocFieldHandler extends DropdownAbstractDocFieldHandler{\n    static default_config:IDHFMultiSelectConfig = {\n        default: {maxItems: 1, create:false, sort:false, optionSetting:\"\"}\n    };\n\n    getXmlValue(): string {\n\n        let selectionIds = this.getValues(false);\n\n        // convert to values\n        let selectionLabels: IDropdownOption[] = [];\n        let dropdownOptions = <IDropDownConfig>this.itemConfig.getSettingJSON(this.dhfFieldConfig.optionSetting);\n        if (dropdownOptions) {\n\n            for (let id of selectionIds) {\n                let label = id;\n                for(let option of dropdownOptions.options){\n                    if(option.id == id){\n                        label = option.label;\n                    }\n                }\n                selectionLabels.push({label: label, id: id});\n            }\n            selectionLabels.push(<any>{optionSetting: this.dhfFieldConfig.optionSetting});\n        }\n        return JSON.stringify(selectionLabels);\n    }\n\n    getDefaultConfig(): any {\n        return MultiSelectDocFieldHandler.default_config.default;\n    }\n\n}\n\n","import {GenericDocAbstractFieldHandler} from \"./GenericDocAbstractFieldHandler\";\nimport {IDashboardParams} from \"../../../../client/plugins/DocumentSections/Dashboard\";\nimport { IPluginCoreForDashboard, IPluginFieldValueBase, plugins } from \"../../PluginManager\";\nimport { IDashboardParametersBase } from \"./IDashboardParametersBase\";\n\nexport interface IDashboardDocFieldValue extends IPluginFieldValueBase{\n    value: IDashboardParams\n}\nexport class DashboardDocFieldHandler extends GenericDocAbstractFieldHandler {\n    getDefaultConfig(): any {\n        return {};\n    }\n    constructor(sectionType: string, config: IDashboardParams, fieldValue: string) {\n        super(sectionType, config, fieldValue);\n        this.dashboardParams = config;\n    }\n    dashboardParams:IDashboardParams;\n\n    getXmlValue(): string {\n        return this.getData();\n    }\n\n    getData(): string {\n        // A dashboard doesn't *really* have a value. But it has a cached html version of the\n        // last time we saved based on the given configuration. So the html is the part that\n        // matters.\n        return  JSON.stringify({value: \"\", html: this.getHtmlValue()});\n    }\n\n    getHtmlValue(): string {\n        // Note it calls *super*.getData(), where the cached html is stored.\n        return super.getData();\n    }\n\n    /**\n     * If you need to re-render the cached html, call this. \n     * @returns valid html\n     */\n    async getNewHtmlValue(): Promise<string> {\n        let pluginsList = plugins.getPlugins();\n        for (let p of pluginsList) {\n            if (\"Plugin\" in p) {\n                let plugin = <IPluginCoreForDashboard<IDashboardParametersBase>>p[\"Plugin\"]\n                if (plugin.getDashboardAsync) {\n                    let dashboard =  await plugin.getDashboardAsync();\n                    if (dashboard.renderProjectPageWithParams) {\n                        let config = this.dhfFieldConfig as IDashboardParams;\n                        if (config && config.dashboardID && config.dashboardID == plugin.getConfig().dashboard.id) {\n                            // We have a match\n                            if ( config.dashboardParams ) {\n                                let html = await dashboard.renderProjectPageWithParams(config.dashboardParams,false);\n                                return html.html() ;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    // TODO:\n    // What is the difference between getValue() and getData()? So a dashboard doc has a \"value\" and a \"data\".\n    // The value is dashboardParams, and the data is something like { value: \"\"; html: <cached html or empty string?> }\n    getValue(): IDashboardParams {\n        return this.dashboardParams;\n    }\n    initData(serializedFieldData: string) {\n        if( serializedFieldData)\n            this.dashboardParams = JSON.parse(serializedFieldData);\n        else\n            this.dashboardParams = {dashboardID:\"\", dashboardParams:{}  };\n    }\n    setDashboardID(newValue) {\n        if( ! this.dashboardParams ){\n            this.dashboardParams = {dashboardID:\"\", dashboardParams:{}  };\n\n        }\n        this.dashboardParams.dashboardID = newValue;\n        console.log(\"Settings dahboard ID!!!\");\n    }\n\n    setDashboardParams(newValue: IDashboardParametersBase) {\n        if( ! this.dashboardParams ){\n            this.dashboardParams = {dashboardID:\"\", dashboardParams:{}  };\n        }\n        this.dashboardParams.dashboardParams = newValue;\n\n    }\n}\n","import {ISimpleTree} from \"./MatrixReq\";\nimport {XRFieldTypeAnnotated} from \"./ItemConfiguration\";\nimport {IDHFConfig} from \"../../ProjectSettings\";\nimport {IControlDefinition} from \"../../globals\";\nimport {IBaseControlOptions} from \"../UI/Controls/BaseControl\";\nimport {IDocFieldHandler} from \"./FieldHandlers/Document/IDocFieldHandler\";\n\nexport interface IDHFSectionOptions {\n    globalOptions?: boolean,\n    show_section_title?: string,\n    automation?: string,\n    page_break?: string,\n    landscape?: boolean,\n    sub_section?: string,\n\n}\n\nexport interface IDHFFieldParameter {\n    autoHide?: boolean,\n    // legacy?\n    perItemVisibility?: boolean,\n}\n\nexport interface IDHFFieldValue {\n    type: string,\n}\n\n\nexport interface IDHFXMLOptions {\n}\n\nexport interface IDHFPasteBuffer {\n    tree: ISimpleTree,\n    items: IDHFPasteBufferItem[]\n}\n\nexport interface IDHFPasteBufferItem {\n    sourceItem: string,\n    sourceProject: string,\n    pasteSource: string,\n    title: string,\n    item: IDHFPasteBufferValue[]\n}\n\nexport interface IDHFPasteBufferValue {\n    def: XRFieldTypeAnnotated,\n    val: string\n}\n\nexport interface IDHFReorder {\n    idx: number, id: string, name: string, type: string\n}\n\nexport interface IDHFFileOption {\n    name: string, click: Function,\n}\n\nexport interface IDHFGuidOid {\n    guid: string,\n    oid: string\n}\n\nexport interface IDHFWizardData {\n    dhfItems: any[],\n    dhfNumber: string,\n    dhfGUID: string,\n    dhfName: string,\n    template?:string\n}\n\nexport interface IDHFFactory {\n    [key: string]: (config: IDHFConfig) => IDHFSection\n}\n\nexport interface ISectionInfo {\n    sectionName: string,\n    sectionType: DocumentSectionType,\n    hidden:boolean,\n    dynamic:boolean // true for sections which render items\n}\n\nexport enum DocumentSectionType {\n    Static = 1,\n    Database = 2,\n    Table = 3,\n    Technical = 4,\n    CustomTable = 5\n}\n\nexport interface IGrandMother {\n    id: string,\n    version: number,\n    fullId: string,\n    title: string\n}\nexport interface ISectionMap { [key: string]: ISectionInfo }\n\nexport interface ItemSortInfo {\n    itemId: string;\n    item: JQuery;\n    existsInBoth: boolean\n}\n\n\n\nexport interface IPluginDocumentSection {\n\n}\nexport interface IDHFFieldListItem {\n    id: string, label: string\n}\nexport interface IDHFField {\n    type: string, name: string\n}\n\nexport interface IDHFControlDefinition extends IControlDefinition {\n    dhfValue?: IDHFControlDefinitionValue,\n    configTouched?: boolean\n}\n\nexport interface IDHFControlDefinitionValue {\n    fieldValue?: string,\n    fieldValueXML?: string,\n    name?: string,\n    type?: string,\n    ctrlConfig?: IDHFSectionOptions\n}\n\nexport interface IDHFSection {\n    renderControl: (ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions) => void,\n    setFieldHandler: (fieldHandler: IDocFieldHandler) => void,\n    getFieldHandler: () => IDocFieldHandler,\n    getConfig: (ctrl: IDHFControlDefinition) => IDHFSectionOptions,\n    showSpecificSettings: (ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions, custom: JQuery) => void,\n    saveSpecificSettingsAsync: (ctrl: IDHFControlDefinition, ctrlParameter: IBaseControlOptions, custom: JQuery) => Promise<boolean>,\n    hasSearch?: (ctrl: IDHFControlDefinition) => boolean // return true if section supports search expressions for input and has them defined\n    executeSearch?: (ctrl: IDHFControlDefinition) => void// if search expressions are defined for input parameters they can be executed using this function\n    verifySearchAsync?: (ctrl: IDHFControlDefinition) => Promise<void> // check if after load item selection needs to be changed\n    verifyContentAsync: (ctrl: IDHFControlDefinition) => Promise<void> // check if some/all required content exists\n}\n","import { ITableParams } from \"../UI/Controls/BaseControl\";\n\nexport type { ITableDataRow, ITableFunction, ITableFunctions };\nexport { TableMath, tableMath };\nexport { InitializePluginManagerFormulas };\n\ninterface ITableDataRow { [key: string]: number | string }\ninterface ITableFunction { (table: ITableDataRow[], parameterJson: ITableParams): string }\n\ninterface ITableFunctions { [key: string]: ITableFunction }\n\n\nclass TableMath {\n\n    protected functions:ITableFunctions = {};\n\n    /** allow to add new functions:  */\n    registerFunction( functionId:string, execute:ITableFunction) {\n        this.functions[functionId] = execute;\n    }\n   \n    /** executes function on a table */\n    execute( functionId:string, table:ITableDataRow[], parameterJson:ITableParams) {\n        if (!this.functions[functionId]) {\n            return `called function \"${functionId}\" does not exist!`;\n        }\n        return this.functions[functionId](table,parameterJson);\n\n    }\n}\n\nvar tableMath: TableMath;\n\nfunction InitializePluginManagerFormulas() {\n    tableMath = new TableMath(); \n\n    tableMath.registerFunction(\"percent\", (table: ITableDataRow[], parameterJson: ITableParams) => {\n        for (let row of table) {\n            if (row.y == 0) return `The value in fy cannot be 0!`;\n            row.z = Math.round(100 * Number(row.x) / Number(row.y));\n        }\n        return \"\";\n    });\n}","import { SelectMode } from \"../UI/Components/ProjectViewDefines\";\nimport { IBaseControlOptions } from \"../UI/Controls/BaseControl\";\nimport { TasksControlImpl } from \"../UI/Controls/tasksControl\";\nimport { IDB } from \"./DBCache\";\nimport { MR1, IItemChangeEvent } from \"./MatrixRequirementsAPI\";\nimport { IPlugin, IProjectPageParam, IPluginPanelOptions, plugins, pluginHooks } from \"./PluginManager\";\nimport { IJcxhr } from \"./RestConnector\";\nimport { ml } from \"./../matrixlib\";\nimport { ItemSelectionTools, IItemSelectDialogOptions } from \"../UI/Tools/ItemSelectionView\";\nimport { XRGetProject_StartupInfo_ListProjectAndSettings, XRPluginSetting } from \"../../RestResult\";\nimport { mTM } from \"./TestManager\";\nimport {\n    IStringMap,\n    IItem,\n    app,\n    matrixSession,\n    globalMatrix,\n    IControlDefinition,\n    ControlState,\n    IReference,\n    matrixApplicationUI,\n} from \"../../globals\";\nimport { FieldDescriptions } from \"./FieldDescriptions\";\n\nexport type {\n    ITasksConfiguration,\n    FolderItem,\n    Folder,\n    IPFExternalField,\n    ICatFieldMapping,\n    ITaskConfiguration,\n    ITaskTaskDescription,\n    IOne2OneMapping,\n    IOne2OneMappingStatus,\n    ITaskRenderInfo,\n    ITaskSearch,\n    ITaksProjects,\n    ITaskType,\n    ISmartTask,\n    ISmartUrls,\n    IWltItemWithLinks,\n    IWltMatrixItem,\n    IExternalItem,\n    IMoreInfo,\n    ISearchResults,\n    ITaskDetails,\n    XTCTableRow,\n};\nexport { Tasks, mTasks };\nexport { InitializeTasks };\n\n/*** config\n *\n */\ninterface ITasksConfiguration {\n    config: ITaskConfiguration[]; // one for each server plugin\n}\n\ntype FolderItem = Folder | IWltItemWithLinks;\ntype Folder = { name: string; id: string; children: FolderItem[] };\n\ninterface IPFExternalField {\n    /**  Jira field id something like custom_... or assignee or ...*/\n    extFieldId: string;\n    /** converter which specified how to convert matrix field into jira field */\n    converter: string;\n    /** mapping for drop down from Matrix to Jira drop downs  */\n    ddMapping?: IStringMap;\n    [key: string]: any;\n}\n\ninterface ICatFieldMapping {\n    /** map from category to the fields in the category. The matrixFieldName is the name of the field in Matrix  */\n    [key: string]: { [matrixFieldName: string]: IPFExternalField };\n}\ninterface IExternalMeta {\n    issueType: string;\n    status: string;\n}\ninterface ITaskConfiguration {\n    /** defaultSearches: can be used to define default search expressions, (e.g. shortcuts to search task changed in last x hours, server plugin must understand these...) */\n    defaultSearches?: ITaskSearch[];\n    /** one2OneMapping: #\n     * requires one2one capability. defines how external items are shown\n     * the first search in the list will be executed automatically when the dialog is opened\n     * in order not to run an automatic search define first element in array with name=\"\"\n     */\n    one2OneMapping?: IOne2OneMapping;\n    /** allowEmptySearches: can be set to true if plugin can handle it */\n    allowEmptySearches?: boolean;\n    /** searchHelp: can be an url to any website to explain search options (e.g. jql https://..atlassian.. /jql) */\n    searchHelp?: string;\n    /** autoSearch: can be set to true to start default search (when opening dialog)*/\n    autoSearch?: boolean;\n    /** smartLinks: a set of rules to automatically show hyperlinks to items -> note these are available only in the client, in documents the same rules will not be applied! */\n    smartLinks?: ISmartTask[];\n    /** smartUrls: a set of rules to automatically detect dropped links*/\n    smartUrls?: ISmartUrls[];\n    /** projectsCreate: there must be at least one default project in which tasks can be created */\n    projectsCreate: ITaksProjects[];\n    /** projectFilter: filter for projects of which items are displayed in workflow control, if not set all tasks are shown */\n    projectFilter?: string[];\n\n    /** useAsDescription: defines if and what to use as default description -> default is empty (an empty description box) */\n    useAsDescription?: ITaskTaskDescription;\n    /** useEmptyTitle: by default the title of new task is the current item title, true leaves it empty */\n    useEmptyTitle?: boolean;\n    /** requireCommitTicket: set to true if saving should requires a task id (requires smartLinks to be configured)*/\n    requireCommitTicket?: boolean;\n\n    /** catFieldMapping: mapping from Matrix fields to jira fields per category  */\n    catFieldMapping?: ICatFieldMapping;\n    /** userMapping: mapping from Matrix users to jira users  */\n    userMapping?: IStringMap;\n    /** defaultComment: when updating the matrix item this comment is added to the linked jira tickets as prefix to the details of which item was changed */\n    defaultComment?: string;\n    /** if autoAddCommentOnSave is to true it adds a comment to all linked items*/\n    autoAddCommentOnSave?: boolean;\n\n    /** showStatus: if set to true it will request from server the meta info for each linked ticket. If there's a status property in the meta it's displayed a string*/\n    showStatus?: boolean;\n\n    // these can be used to overwrite the plugins's default (e.g. if the plugins says they are possible, but the UI should disable the feature)\n\n    /** pluginName: as shown in UI e.g. JIRA, GitHub, ...*/\n    pluginName?: string;\n    /** pluginLongName: as shown in UI e.g. JIRA Server Plugin, GitHub Plugin, ... */\n    pluginLongName?: string;\n\n    /** hideCreateTask: overwrites canCreate capability*/\n    hideCreateTask?: boolean; //\n    /** hideSearchTasks: overwrites canFind capability */\n    hideSearchTasks?: boolean;\n    /** handleAsLink: should not be changed - if true links are treated like URLs*/\n    handleAsLink?: boolean;\n\n    /** hasMeta: should not be changed - if true external items have a description and a status*/\n    hasMeta?: boolean; //\n\n    // server computed settings they could also be overwritten - but normally that's not needed\n\n    /** nativeCreateUrl: overwrites nativeCreateUrl*/\n    nativeCreateUrl?: string;\n    /** nativeCreateSearch:  overwrites nativeCreateSearch*/\n    nativeCreateSearch?: string;\n    /** pluginId: 'internal id provided by server'*/\n    pluginId?: number;\n\n    // obsolete / not implemented?\n    //createBacklinks?:boolean // if set to false overwrites the option to canCreateBacklinks capability\n}\n\ntype ITaskTaskDescription = \"hide\" | \"empty\" | \"text\"; // later we could support html editors - not now though |\"html\"\n\ninterface IOne2OneMapping {\n    // configures 1-1 mapping\n    projectId: string; // id communicated to server to indicate in which project to create tickets\n    taskTypeId: string; // id communicated to server to indicate what type\n    showId?: boolean; // shows external item's id in title\n    statusOverwrites: IOne2OneMappingStatus[];\n}\ninterface IOne2OneMappingStatus extends ITaskRenderInfo {\n    externalStatusName: string; // name of external status\n    text: string; // text to show\n}\n\ninterface ITaskRenderInfo {\n    text: string; // one to one mapping will show this text\n    color?: string; // in this color\n    background?: string; // with bg color\n    strikethrough?: boolean; // optional strikethrough\n}\n\ninterface ITaskSearch {\n    name: string; // name of search to show in UI\n    expression: string; // expression to be send to server\n}\ninterface ITaksProjects {\n    projectId: string; // id communicated to server (can be \"\" if there is no concept of a project in server plugin)\n    projectName: string; // name communicated to user\n    taskTypes: ITaskType[]; // there must be at least one default task type per project\n}\n\ninterface ITaskType {\n    taskTypeId: string; // id communicated to server (can be \"\" if there is no concept of a different task types in server plugin)\n    taskTypeName: string; // name communicated to user\n    iconUrl?: string; // can be an url of an icon to display\n    iconClass?: string; // can be an class of an icon to display\n}\n\ninterface ISmartTask {\n    regex: string; // regex which needs to match, e.g. (github)(-)([0-9]*) would match \"github-12\" with three groups, \"github\", \"-\" and \"12\" as $0,$1 and $2\n    issueProjectId: string; // a template which creates the project information for a matched issue (uses the same replacement as above), eg. $0 for github\n    issueId: string; // a template which creates the issue information for a matched issue (uses the same replacement as above) e.g. $2 for 12\n    title: string; // url template for a title (can be empty)\n    url?: string; // url template which needs to be created for the hyperlink, e.g. \"https://myissue.com/myticket/ticke-$2/details\" would replace the $2 with the second  group (like \"12\" above)\n}\ninterface ISmartUrls {\n    regex: string; // regex which needs to match, e.g. (github-)([0-9]*) would match \"github-12\" with two groups, \"github-\" and 12\n    issueProjectId: string; // a template which creates the project information for a matched issue (uses the same replacement as above)\n    issueId: string; // a template which creates the issue information for a matched issue (uses the same replacement as above)\n    title: string; // url template for a title (can be empty)\n    priority?: number; // if there are several matches the highest priority will win\n}\n\n/*** wlt interface\n *\n */\n\ninterface IWltItemWithLinks {\n    matrixItem: IWltMatrixItem;\n    links: IExternalItem[];\n}\ninterface IWltMatrixItem {\n    itemId: number;\n    projectId: number;\n    title: string;\n    matrixItem: string;\n    project: string;\n}\n\ninterface IExternalItem {\n    externalItemId: string;\n    externalItemTitle: string;\n    externalItemUrl: string;\n    externalDescription: string;\n    externalDone: boolean;\n    externalUser?: string; // if user is returned with external item it's displayed in UI\n    externalProject?: string;\n    externalType?: string; // for jira use...\n    externalMeta?: string;\n    plugin: number;\n    more?: IMoreInfo[];\n}\n\ninterface IMoreInfo {\n    key: string;\n    value: string;\n}\n\n/* internal helper interface\n *\n *\n */\n\ninterface ISearchResults {\n    startAt: number; // first number of hits\n    maxResults: number; // which have been possibly returned\n    tasks: IExternalItem[];\n}\n\ninterface ITaskDetails extends IExternalItem {\n    matrixItemIds?: string[]; // server provides list of linked items\n}\n\ninterface XTCTableRow {\n    comment: string;\n}\n\nclass Tasks implements IPlugin {\n    private item: IItem;\n    private jui: JQuery;\n    static tasksConfiguration: ITaskConfiguration[];\n\n    //\n    // ****************************************\n    // standard plugin interface\n    // ****************************************\n\n    public isDefault = true;\n    constructor() {}\n    initItem(_item: IItem, _jui: JQuery) {\n        this.item = _item;\n        this.jui = _jui;\n    }\n\n    reset() {\n        this.item = null;\n        this.jui = null;\n    }\n\n    initServerSettings(serverSettings: XRGetProject_StartupInfo_ListProjectAndSettings) {}\n\n    updateMenu(ul: JQuery, hook: number) {\n        let that = this;\n\n        if (hook !== pluginHooks.shares) {\n            return;\n        }\n\n        if (!this.item || app.isFolder(this.item.id)) {\n            return; // do not show tasks for folders\n        }\n\n        if (!matrixSession.isEditor() || !Tasks.tasksConfiguration || Tasks.tasksConfiguration.length == 0) {\n            return;\n        }\n\n        let miDivider = $('<li class=\"divider\"></li>');\n        ul.append(miDivider);\n\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            if (config.catFieldMapping && config.catFieldMapping[that.item.type]) {\n                $($(`<li><span class=\"toolmenu\">Push to ${config.pluginName}</span></li>`))\n                    .click(() => {\n                        that.pushIssueDlg(config);\n                    })\n                    .appendTo(ul);\n            }\n\n            if (!config.hideCreateTask) {\n                if (config.handleAsLink) {\n                    $(`<li><span class=\"toolmenu\">Add web link</span></li>`)\n                        .appendTo(ul)\n                        .data(\"config\", config)\n                        .click(function (event: JQueryMouseEventObject) {\n                            Tasks.createAndLinkWebDlg(\n                                $(event.delegateTarget).data(\"config\"),\n                                null,\n                                function (linkTitle: string, linkUrl: string) {\n                                    let extItem: IExternalItem = {\n                                        externalItemId: \"\" + new Date().getTime(),\n                                        externalItemTitle: linkTitle,\n                                        externalItemUrl: linkUrl,\n                                        externalDescription: \"\",\n                                        externalDone: false,\n                                        plugin: config.pluginId,\n                                    };\n                                    Tasks.postCreateLinks(that.item.id, [extItem]).done(function (allITems) {\n                                        that.updateUI(allITems);\n                                        that.jui.dialog(\"close\");\n                                    });\n                                },\n                            );\n                        });\n                } else {\n                    $(`<li><span class=\"toolmenu\">Create and link ${config.pluginName} task</span></li>`)\n                        .appendTo(ul)\n                        .data(\"config\", config)\n                        .click(function (event: JQueryMouseEventObject) {\n                            that.createAndLinkIssueDlg($(event.delegateTarget).data(\"config\"));\n                        });\n                }\n            }\n\n            if (config.nativeCreateUrl && config.nativeCreateSearch) {\n                var dev = $(`<li><span class=\"toolmenu\">Open ${config.pluginName} create page</span></li>`)\n                    .appendTo(ul)\n                    .data(\"config\", config)\n                    .click(function (event: JQueryMouseEventObject) {\n                        that.createSearchAndLinkIssueDlg($(event.delegateTarget).data(\"config\"));\n                    });\n            }\n\n            if (!config.hideSearchTasks && !config.handleAsLink) {\n                var dev = $(`<li><span class=\"toolmenu\">Link to existing ${config.pluginName} task</span></li>`)\n                    .appendTo(ul)\n                    .data(\"config\", config)\n                    .click(function (event: JQueryMouseEventObject) {\n                        that.searchAndLinkIssueDlg($(event.delegateTarget).data(\"config\"));\n                    });\n            }\n        });\n        return;\n    }\n\n    supportsControl(fieldType: string): boolean {\n        return fieldType === FieldDescriptions.Field_tasksControl;\n    }\n\n    createControl(ctrl: JQuery, options: IBaseControlOptions) {\n        ctrl.tasksControl(options);\n    }\n\n    initProject() {\n        Tasks.tasksConfiguration = [];\n        let pluginSettings = globalMatrix.ItemConfig.getPluginSettings();\n        // setup highlight rules\n        $.each(pluginSettings, function (tidx, plugin) {\n            if (plugin.pluginId > 200) {\n                let a: XRPluginSetting;\n                // version 2 plugin\n                let clientConfig: ITaskConfiguration = <ITaskConfiguration>{};\n                let enabled = false;\n                // get client config setting and find out if enabled\n                $.each(plugin.settings, function (idx, setting) {\n                    if (setting.setting === \"clientConfig\" && setting.value) {\n                        clientConfig = JSON.parse(setting.value);\n                    } else if (setting.setting === \"clientEnabled\") {\n                        enabled = ml.JSON.isTrue(setting.value);\n                    }\n                });\n                if (enabled) {\n                    clientConfig.pluginId = plugin.pluginId;\n                    $.each(clientConfig.smartLinks, function (idx, smartLink) {\n                        // in case there are some hypelinks configured\n                        addHighlightRegex(smartLink.regex, smartLink.url);\n                    });\n                    // unless names are defined, use server's default\n                    if (!clientConfig.pluginLongName) {\n                        clientConfig.pluginLongName = plugin.pluginLongName;\n                    }\n                    if (!clientConfig.pluginName) {\n                        clientConfig.pluginName = plugin.pluginShortName;\n                    }\n\n                    if (typeof clientConfig.handleAsLink == \"undefined\") {\n                        clientConfig.handleAsLink = plugin.capabilities.handleAsLink;\n                    }\n\n                    if (typeof clientConfig.hideCreateTask == \"undefined\") {\n                        clientConfig.hideCreateTask = !plugin.capabilities.canCreate && !clientConfig.handleAsLink;\n                    }\n\n                    if (typeof clientConfig.hideSearchTasks == \"undefined\") {\n                        clientConfig.hideSearchTasks = !plugin.capabilities.canFind;\n                    }\n\n                    /*if ( typeof clientConfig.createBacklinks == 'undefined') {\n                       clientConfig.createBacklinks = plugin.capabilities.canCreateBacklinks;\n                    }\n                    */\n                    // need to run again though settings\n                    $.each(plugin.settings, function (idx, setting) {\n                        if (setting.setting === \"projectFilter\") {\n                            clientConfig.projectFilter = setting.value ? setting.value.split(\",\") : [];\n                        }\n                    });\n\n                    if (typeof clientConfig.hasMeta == \"undefined\") {\n                        clientConfig.hasMeta = plugin.capabilities.hasMeta;\n                    }\n                    $.each(plugin.computedSettings, function (idx, setting) {\n                        if (setting.setting === \"nativeCreateUrl\" && !clientConfig.nativeCreateUrl) {\n                            // client does not overwrite capability, so take default from server\n                            clientConfig.nativeCreateUrl = setting.value;\n                        }\n                        if (setting.setting === \"nativeCreateSearch\" && !clientConfig.nativeCreateSearch) {\n                            // client does not overwrite capability, so take default from server\n                            clientConfig.nativeCreateSearch = setting.value;\n                        }\n                    });\n                    Tasks.tasksConfiguration.push(clientConfig);\n                }\n            }\n        });\n    }\n\n    getProjectPagesAsync(): Promise<IProjectPageParam[]> {\n        return new Promise((resolve, reject) => {\n            let that = this;\n            let pages: IProjectPageParam[] = [];\n\n            if (globalMatrix.ItemConfig.getTimeWarp()) {\n                // remove the pages - too complicated\n                resolve(pages);\n                return;\n            }\n            $.each(Tasks.tasksConfiguration, function (idx, conf) {\n                pages.push({\n                    id: \"TASKS\" + conf.pluginId,\n                    title: conf.pluginName + \" addon\",\n                    folder: \"ADDONS\",\n                    order: 1000 + conf.pluginId,\n                    icon: \"fal fa-external-link-square\",\n                    usesFilters: false,\n                    render: (options: IPluginPanelOptions) => that.renderProjectPage(options),\n                });\n            });\n\n            resolve(pages);\n            return;\n        });\n    }\n    // this function goes through all tests steps and applies all smartlink rules to find hyperlinks to issues\n    async preSaveHookAsync(isItem: boolean, type: string, controls: IControlDefinition[]): Promise<unknown> {\n        let that = this;\n        return new Promise(async (resolve, reject) => {\n            if (isItem && mTM.isXTC(type)) {\n                let linksToBeCreated: string[] = []; // array of matches\n\n                for (let idx = 0; idx < controls.length; idx++) {\n                    if (controls[idx].fieldType === FieldDescriptions.Field_test_steps_result) {\n                        let val = await (controls[idx].control as any).getController().getValueAsync();\n                        let v: XTCTableRow[] = JSON.parse(val);\n                        for (let step = 0; step < v.length; step++) {\n                            var comment = v[step].comment;\n                            if (comment && comment !== \"\") {\n                                // find matches\n                                $.each(Tasks.tasksConfiguration, function (tidx, config) {\n                                    $.each(config.smartLinks, function (idx, smartLink) {\n                                        let re = new RegExp(smartLink.regex, \"g\");\n                                        let hits = comment.match(re);\n                                        if (hits) {\n                                            $.each(hits, function (hidx, hit) {\n                                                if (linksToBeCreated.indexOf(hit) === -1) {\n                                                    linksToBeCreated.push(hit);\n                                                }\n                                            });\n                                        }\n                                    });\n                                });\n                            }\n                        }\n                    }\n                }\n\n                if (linksToBeCreated.length > 0) {\n                    that.createLinksAsync(linksToBeCreated)\n                        .done(function () {\n                            resolve({});\n                        })\n                        .fail(function () {\n                            reject();\n                        });\n                } else {\n                    resolve({});\n                }\n            } else {\n                resolve({});\n            }\n        });\n    }\n\n    // ****************************************\n    // Misc functions for jiraPlugin (running inside JIRA)\n    // ****************************************\n\n    isPluginEnabled(pluginId: number) {\n        let enabled = false;\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            if (config.pluginId == pluginId) {\n                enabled = true;\n            }\n        });\n        return enabled;\n    }\n\n    // ****************************************\n    // Misc functions for matrixreq and others\n    // ****************************************\n\n    // verifies if a save comment has all required task id's if not\n    evaluateTaskIds(comment: string): string[] {\n        let issues: string[] = [];\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            if (config.requireCommitTicket) {\n                let hasId = false;\n                $.each(config.smartLinks, function (sidx, smartLink) {\n                    let re = new RegExp(smartLink.regex, \"g\");\n                    let hits = comment.match(re);\n                    if (hits) {\n                        hasId = true;\n                    }\n                });\n\n                if (!hasId) {\n                    issues.push(`missing task id for ${config.pluginName}`);\n                }\n            }\n        });\n        return issues;\n    }\n\n    // test if a dropped URL is a link to an issue -> if so convert it to externalitem struct\n    static externalItemFromUrl(url: string): IExternalItem {\n        let matches: IExternalItem = null;\n        let priority = 0;\n\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            $.each(config.smartUrls, function (sidx, smartUrl) {\n                if (!matches || priority < (smartUrl.priority ? smartUrl.priority : 0)) {\n                    let re = new RegExp(smartUrl.regex);\n                    let ma = url.match(re);\n                    if (ma) {\n                        // it matches: replace all palceholders, $0, $1, $2, with matching groups\n                        let issueId = smartUrl.issueId;\n                        let issueProjectId = smartUrl.issueProjectId;\n                        let title = smartUrl.title ? smartUrl.title : \"\";\n                        for (let i = 0; i < Math.min(ma.length, 10); i++) {\n                            let rep = new RegExp(\"\\\\$\" + i, \"g\");\n                            issueProjectId = issueProjectId.replace(rep, ma[i]);\n                            issueId = issueId.replace(rep, ma[i]);\n                            title = title.replace(rep, ma[i]);\n                        }\n                        priority = smartUrl.priority ? smartUrl.priority : 0;\n                        matches = {\n                            plugin: config.pluginId,\n                            externalProject: issueProjectId,\n                            externalItemId: issueId,\n                            externalItemUrl: url,\n                            externalDescription: \"\",\n                            externalItemTitle: title,\n                            externalDone: false,\n                            externalType: \"\",\n                        };\n                    }\n                }\n            });\n        });\n        return matches;\n    }\n\n    private async addCommentToAllLinkedIssues(\n        config: ITaskConfiguration,\n        comment?: string,\n        whatChanged?: string,\n        version?: number,\n    ) {\n        let that = this;\n        let versionStr = version ? `to version v${version}` : \"\";\n        if (comment == undefined) {\n            comment = \"\";\n            if (Tasks.getConfig(config.pluginId).defaultComment != undefined) {\n                comment = Tasks.getConfig(config.pluginId).defaultComment;\n            }\n            comment += `*${app.getCurrentItemId()} -  ${(\n                await app.getCurrentTitle()\n            ).trim()}*  has been updated ${versionStr}\\n *See :* ${\n                globalMatrix.matrixBaseUrl\n            }/${matrixSession.getProject()}/${app.getCurrentItemId()} \\n----`;\n        }\n        if (whatChanged != undefined) comment += \"\\n\" + whatChanged;\n\n        Tasks.getTasks(that.item.id, [config.pluginId]).then((externalItems) => {\n            externalItems.forEach((externalItem) => {\n                let job = {\n                    pluginId: config.pluginId,\n                    action: \"AddComment\",\n                    matrixItem: {\n                        project: matrixSession.getProject(),\n                    },\n                    externalItem: {\n                        externalItemId: externalItem.externalItemId,\n                    },\n                    more: [{ key: \"comment\", value: comment }],\n                };\n\n                globalMatrix.wfgwConnection\n                    .postServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }), job, true)\n                    .done(() => {\n                        console.log(\"Comment added! \");\n                    })\n                    .fail(function (jqxhr, textStatus, error) {\n                        Tasks.showError(\"AddComment failed\", jqxhr, textStatus, error);\n                    });\n            });\n        });\n    }\n\n    /** this creates a new item and jira and sets the define fields with values coming from Matrix */\n    private pushIssueDlg(config: ITaskConfiguration) {\n        let that = this;\n\n        let options = \"\";\n        // create project / type drop down menu\n        $.each(config.projectsCreate, function (i, project) {\n            $.each(project.taskTypes, function (j, taskType) {\n                let oName: string[] = [];\n                if (project.projectName) oName.push(project.projectName);\n                if (taskType.taskTypeName) oName.push(taskType.taskTypeName);\n                options +=\n                    \"<option value='\" +\n                    project.projectId +\n                    \"|\" +\n                    taskType.taskTypeId +\n                    \"' \" +\n                    (i + j == 0 ? \"selected\" : \"\") +\n                    \">\" +\n                    oName.join(\" / \") +\n                    \"</option>\";\n            });\n        });\n\n        let form = $(`<div class=\"container\" style=\"width:100%;height:100%\">\n                        <div class=\"row optionsSelectRow\" style=\"margin-top:4px;margin-bottom:6px\">\n                            <div class=\"col-md-2\" style=\"margin-top: 6px;\"><label style=\"white-space: nowrap\" for=\"inputType\"\n                                    class=\"control-label\">Issue Type:</label></div>\n                            <div class=\"col-md-10\"><select class=\"form-control inputType\" style=\"width:100%;height:32px\" id=\"inputType\">\n                                    ${options}\n                                </select></div>\n                        </div>\n                    </div>`);\n\n        this.jui.html(\"\");\n        this.jui.removeClass(\"dlg-v-scroll\");\n        this.jui.addClass(\"dlg-no-scroll\");\n        this.jui.append(form);\n\n        this.jui.dialog({\n            autoOpen: true,\n            title: \"Create linked task\",\n            height: 200,\n            width: 600,\n            modal: true,\n            open: function () {},\n            close: function () {},\n            buttons: [\n                {\n                    text: \"Ok\",\n                    class: \"btnDoIt\",\n                    click: async function () {\n                        let title = await app.getCurrentTitle();\n                        let type = <string>$(\".inputType\", that.jui).val();\n                        let where = type.split(\"|\");\n\n                        Tasks.postPushIssue(config.pluginId, that.item.id, title, \"\", where[0], where[1]).then(\n                            function (newTask) {\n                                that.updateUI(newTask);\n                            },\n                        );\n\n                        that.jui.dialog(\"close\");\n                    },\n                },\n                {\n                    text: \"Cancel\",\n                    class: \"btnCancelIt\",\n                    click: function () {\n                        that.jui.dialog(\"close\");\n                    },\n                },\n            ],\n        });\n    }\n\n    static postPushIssue(\n        pluginId: number,\n        itemId: string,\n        title: string,\n        description: string,\n        projectId: string,\n        taskTypeId: string,\n    ): Promise<IExternalItem[]> {\n        return new Promise(async (resolve, reject) => {\n            let project = matrixSession.getProject();\n\n            let job = {\n                pluginId: pluginId,\n                action: \"CreateIssue\",\n                matrixItem: {\n                    project: project,\n                    matrixItem: itemId,\n                },\n                externalItem: { externalItemTitle: title, externalDescription: description },\n                more: [\n                    { key: \"project\", value: projectId },\n                    { key: \"issueType\", value: taskTypeId },\n                ],\n            };\n\n            let cat = ml.Item.parseRef(itemId).type;\n            if (Tasks.getConfig(pluginId).catFieldMapping) {\n                let fm = Tasks.getConfig(pluginId).catFieldMapping[cat];\n\n                if (fm) {\n                    let uMap = Tasks.getConfig(pluginId).userMapping;\n                    for (let key of Object.keys(fm)) {\n                        let field = globalMatrix.ItemConfig.getFieldByName(cat, key);\n                        let value = undefined;\n                        if (field && field.id) {\n                            value = await app.getFieldValueAsync(field.id);\n                        }\n                        // current User is gotten from session\n                        if (!value && fm[key].converter == \"currentUser\") {\n                            if (!uMap[matrixSession.getUser()]) {\n                                ml.UI.showError(\n                                    `No user mapped for user '${matrixSession.getUser()}'`,\n                                    \"Please ask your administrator to check that your user ID is correclty mapped in Jira Cloud extension configuration.\",\n                                );\n                                reject(\"current user is not mapped in Jira\");\n                                return;\n                            }\n                            value = JSON.stringify({ accountId: uMap[matrixSession.getUser()] });\n                        }\n\n                        if (value) {\n                            switch (fm[key].converter) {\n                                case \"plaintext\":\n                                    value = $(\"<div>\").html(value).text();\n                                    break;\n                                case \"dropdown\":\n                                    if (fm[key].ddMapping && fm[key].ddMapping[value])\n                                        value = JSON.stringify({ id: fm[key].ddMapping[value] });\n                                    else {\n                                        console.info(\"Cannot convert \" + value + \" to dropdown value\");\n                                        value = undefined;\n                                    }\n                                    break;\n\n                                case \"tags\":\n                                    value = JSON.stringify(value.replace(\" \", \"_\").split(\",\"));\n                                    break;\n\n                                case \"labels\": // converter something to jira tags\n                                    let labelList: string[] = JSON.parse(value);\n                                    if (labelList && labelList.length > 0) {\n                                        // whatever it is jira tags cannot have spaces\n                                        value = JSON.stringify(labelList.map((l) => l.replace(\" \", \"_\")));\n                                    }\n\n                                    break;\n\n                                case \"multiselect\":\n                                    let values: any[] = value.split(\",\");\n                                    if (fm[key].ddMapping) {\n                                        let valuesMapped = values.map((v) => {\n                                            return { id: fm[key].ddMapping[v] };\n                                        });\n                                        if (\n                                            value.filter((v) => {\n                                                return v.id == null || v.id == undefined;\n                                            }).length == 0\n                                        ) {\n                                            value = JSON.stringify(valuesMapped);\n                                        } else {\n                                            // there's at least one missing mapping\n                                            console.info(\n                                                `Cannot convert '${value}' to dropdown value -> there is a missing mapping`,\n                                            );\n                                            value = undefined;\n                                        }\n                                    } else {\n                                        console.info(\"Cannot convert \" + value + \" to dropdown value\");\n                                        value = undefined;\n                                    }\n\n                                    break;\n                                case \"currentUser\":\n                                    // handled before switch statement\n                                    break;\n\n                                case \"user\":\n                                    if (uMap && uMap[value]) {\n                                        value = JSON.stringify({ accountId: uMap[value] });\n                                    } else {\n                                        console.info(\"Cannot convert \" + value + \" to mapped user\");\n                                        value = undefined;\n                                    }\n                                    break;\n                            }\n                        }\n                        if (value != undefined) {\n                            job.more.push({ key: fm[key].extFieldId, value: value });\n                        }\n                    }\n                }\n            }\n\n            globalMatrix.wfgwConnection\n                .postServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }), job, true)\n                .done(function (task: IExternalItem[]) {\n                    resolve(task);\n                })\n                .fail(function (jqxhr, textStatus, error) {\n                    Tasks.showError(\"Creating issue failed\", jqxhr, textStatus, error);\n                    reject(error);\n                });\n        });\n    }\n\n    subscribe() {\n        let that = this;\n        MR1.onAfterSave().subscribe(<any>this, function (event: IItemChangeEvent) {\n            try {\n                that.afterSaveHookAddComment(event);\n            } catch (ex) {\n                console.log(\"failed to update the task:\");\n                console.log(ex);\n            }\n        });\n    }\n    afterSaveHookAddComment(event: IItemChangeEvent): void {\n        let that = this;\n        let message = \"\";\n\n        // message += \"-------------------------------------------------------------------------- \\n\";\n\n        if (event.before.title != event.after.title) {\n            message += `*Title has been updated*\n                            _Old value for title_\n                            {{${event.before.title}}}\n                            _New value for title_\n                            {{${event.before.title}}}\\n----\\n`;\n        }\n        // API is not symmetric so before and after are handled differently\n        let labelsBefore =\n            event.before.labels && event.before.labels.length > 0 ? event.before.labels.join(\",\") : \"[no labels set]\";\n        let labelsAfter = event.after.labels && event.before.labels.length > 0 ? event.after.labels : \"[no labels set]\";\n\n        if (labelsBefore != labelsAfter) {\n            message += `*Labels has been updated*\n                        _Old value for labels_\n                        {{${labelsBefore}}}\n                        _New value for labels_\n                        {{${labelsAfter}}}\\n----\\n`;\n        }\n\n        for (let key of Object.keys(event.after)) {\n            // in theory we need to check both before and after keys (to handle rollbacks...)\n            if (Number.isSafeInteger(parseInt(key))) {\n                // event after/before field values are strings or boolean (as far as we see...)\n                let valueBefore =\n                    event.before[key] != undefined && event.before[key].length > 0\n                        ? event.before[key]\n                        : \"[value not set]\";\n                let valueAfter =\n                    event.after[key] != undefined && event.after[key].length > 0 ? event.after[key] : \"[value not set]\";\n\n                if (valueBefore.toString() != valueAfter.toString()) {\n                    let ref = ml.Item.parseRef(that.item.id);\n                    if (!ref.isFolder) {\n                        let field = globalMatrix.ItemConfig.getFieldById(ref.type, parseInt(key));\n                        if (field != undefined) {\n                            message += `*Field '${field.label}' has been updated*\n                                    _Old value for ${field.label}_\n                                    {{${$(\"<div>\").html(valueBefore).text()}}}\n                                    _New value for ${field.label}_\n                                    {{${$(\"<div>\").html(valueAfter).text()}}}\\n----\\n`;\n                        }\n                    }\n                }\n            }\n        }\n\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            if (config.autoAddCommentOnSave) {\n                that.addCommentToAllLinkedIssues(config, undefined, message, event.after.maxVersion);\n            }\n        });\n    }\n\n    // convert url to linked external item\n    static createTaskFromUrl(itemId: string, url: string) {\n        let externalItem = Tasks.externalItemFromUrl(url);\n        if (externalItem) {\n            Tasks.postCreateLinks(itemId, [externalItem]).done(function (createdTasks) {\n                mTasks.updateUI(createdTasks);\n            });\n        }\n    }\n\n    // check if a string is an id of an external item\n    static isTaskId(someId: string) {\n        let isId = false;\n\n        $.each(Tasks.tasksConfiguration, function (tidx, config) {\n            $.each(config.smartLinks, function (idx, smartLink) {\n                let re = new RegExp(smartLink.regex, \"g\");\n                let hits = someId.match(re);\n                if (hits && hits[0] == someId) {\n                    isId = true;\n                    return;\n                }\n            });\n        });\n\n        return isId;\n    }\n\n    static getOne2OneTask(externalItemId: string): JQueryDeferred<IExternalItem> {\n        let res = $.Deferred();\n        let handled = false;\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            if (config.one2OneMapping) {\n                handled = true;\n                Tasks.getMeta(config.pluginId, externalItemId)\n                    .done(function (externalItem) {\n                        res.resolve(externalItem);\n                    })\n                    .fail(function () {\n                        res.reject(\"failed to retrieve one to one mapping status for \" + externalItemId);\n                    });\n                return;\n            }\n        });\n        if (!handled) {\n            res.reject(\"no one 2 one mapping configured\");\n        }\n        return <JQueryDeferred<IExternalItem>>res;\n    }\n    static createOne2OneTask(itemId: string): JQueryDeferred<IExternalItem> {\n        let res = $.Deferred();\n        let handled = false;\n        $.each(Tasks.tasksConfiguration, function (idx, config) {\n            if (config.one2OneMapping) {\n                handled = true;\n                let taskTitle = \"workflow status for \" + itemId;\n                let taskDescription = \"\";\n\n                Tasks.postPushIssue(\n                    config.pluginId,\n                    itemId,\n                    taskTitle,\n                    taskDescription,\n                    config.one2OneMapping.projectId,\n                    config.one2OneMapping.taskTypeId,\n                )\n                    .then(function (newTasks) {\n                        res.resolve(newTasks[0]);\n                    })\n                    .catch(function () {\n                        res.reject(\"failed to create task for one to one mapping\");\n                    });\n                return;\n            }\n        });\n        if (!handled) {\n            res.reject(\"no one 2 one mapping configured\");\n        }\n        return <JQueryDeferred<IExternalItem>>res;\n    }\n    static getOne2OneRenderInfo(task?: IExternalItem): ITaskRenderInfo {\n        let renderInfo: ITaskRenderInfo = {\n            text: \"click to link\",\n            color: \"grey\",\n            background: \"transparent\",\n            strikethrough: false,\n        };\n        if (task) {\n            renderInfo.text = task.externalItemId;\n            renderInfo.color = \"black\";\n            $.each(task.more, function (idx, val) {\n                if (val.key === \"status\") {\n                    $.each(Tasks.tasksConfiguration, function (idx2, config) {\n                        if (config.one2OneMapping) {\n                            $.each(config.one2OneMapping.statusOverwrites, function (idx3, statusOverwrite) {\n                                if (statusOverwrite.externalStatusName == val.value) {\n                                    renderInfo = ml.JSON.clone(statusOverwrite);\n                                    if (config.one2OneMapping.showId) {\n                                        renderInfo.text = task.externalItemId + \":\" + renderInfo.text;\n                                    }\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n        }\n        return renderInfo;\n    }\n    // ****************************************\n    // Misc functions called by task control\n    // to create / refresh UI components\n    // ****************************************\n\n    static showTasks(itemId: string, control: JQuery, canEdit: boolean, pluginFilter?: number[]) {\n        let that = this;\n        if (!Tasks.tasksConfiguration || Tasks.tasksConfiguration.length == 0) {\n            control.append('<div style=\"color: #bbb;font-size: 12px;\">no valid configuration</div>');\n            return;\n        }\n        Tasks.getTasks(itemId, pluginFilter)\n            .done(function (tasks: IExternalItem[]) {\n                Tasks.renderTasks(itemId, tasks, control, canEdit, false);\n            })\n            .fail(function (message) {\n                if (message) {\n                    ml.Logger.log(\"error\", \"Could not retrieve tasks for \" + itemId);\n                    ml.Logger.log(\"error\", \"Error was:\" + message);\n                }\n            });\n    }\n\n    // ****************************************\n    // private functions\n    // ****************************************\n\n    /*** UI\n     *\n     */\n\n    private async createAndLinkIssueDlg(config: ITaskConfiguration) {\n        let that = this;\n\n        let options = \"\";\n        let ocount = 0;\n        // create project / type drop down menu\n        $.each(config.projectsCreate, function (i, project) {\n            $.each(project.taskTypes, function (j, taskType) {\n                ocount++;\n                let oName: string[] = [];\n                if (project.projectName) oName.push(project.projectName);\n                if (taskType.taskTypeName) oName.push(taskType.taskTypeName);\n                options +=\n                    \"<option value='\" +\n                    project.projectId +\n                    \"|\" +\n                    taskType.taskTypeId +\n                    \"' \" +\n                    (i + j == 0 ? \"selected\" : \"\") +\n                    \">\" +\n                    oName.join(\" / \") +\n                    \"</option>\";\n            });\n        });\n\n        // define default title\n        let iTitle = config.useEmptyTitle ? \"\" : await app.getCurrentTitle();\n\n        // define default content\n        let iContent: string = \"\";\n        if (config.useAsDescription == \"text\") {\n            let descriptionFields = globalMatrix.ItemConfig.getFieldsOfType(\"richtext\", this.item.type);\n            if (descriptionFields.length > 0) {\n                let html = await app.getFieldValueAsync(descriptionFields[0].field.id);\n                let tempdiv = $(\"<div style='display:none'>\").html(html).appendTo(\"body\");\n                iContent = tempdiv.text();\n                tempdiv.remove();\n            }\n        }\n\n        let form = $(\n            '<div class=\"container\" style=\"width:100%;height:100%\">' +\n                '<div class=\"row optionsSelectRow\" style=\"margin-top:4px;margin-bottom:6px\">' +\n                '    <div class=\"col-md-2\" style=\"margin-top: 6px;\"><label style=\"white-space: nowrap\" for=\"inputType\" class=\"control-label\">Issue Type:</label></div>' +\n                '    <div class=\"col-md-10\"><select  class=\"form-control inputType\" style=\"width:100%;height:32px\" id=\"inputType\">' +\n                options +\n                \"        </select></div>\" +\n                \"  </div>\" +\n                '  <div class=\"row\">' +\n                '    <div class=\"col-md-2\" style=\"margin-top: 6px;\"><label style=\"white-space: nowrap\" for=\"inputTitle\" class=\"control-label\">Title:</label></div>' +\n                '    <div class=\"col-md-10\"><input autocomplete=\"off\" type=\"text\" class=\"form-control inputTitle\" id=\"inputTitle\" placeholder=\"enter title\"></div>' +\n                \"  </div>\" +\n                '<div class=\"row jira-description\">' +\n                '    <div class=\"col-md-12\"  style=\"height:100%\"><textarea class=\"jira-textarea inputComment\" placeholder=\"enter description\">' +\n                iContent +\n                \"</textarea></div>\" +\n                \"</div></div>\",\n        );\n\n        this.jui.html(\"\");\n        this.jui.removeClass(\"dlg-v-scroll\");\n        this.jui.addClass(\"dlg-no-scroll\");\n        this.jui.append(form);\n        $(\".inputTitle\", this.jui).val(iTitle);\n        let height = 500;\n        if (config.useAsDescription == \"hide\") {\n            $(\".jira-description\", this.jui).hide();\n            height -= 300;\n        }\n        if (ocount == 1) {\n            $(\".optionsSelectRow\", this.jui).hide();\n            height -= 30;\n        }\n        this.jui.dialog({\n            autoOpen: true,\n            title: \"Create linked task\",\n            height: height,\n            width: 600,\n            modal: true,\n            open: function () {},\n            close: function () {},\n            buttons: [\n                {\n                    text: \"Ok\",\n                    class: \"btnDoIt\",\n                    click: function () {\n                        let title = $(\"#inputTitle\", that.jui).val();\n                        let type = <string>$(\".inputType\", that.jui).val();\n                        let description = $(\".inputComment\", that.jui).val();\n\n                        let where = type.split(\"|\");\n\n                        Tasks.postCreateIssue(\n                            config.pluginId,\n                            that.item.id,\n                            title,\n                            description,\n                            where[0],\n                            where[1],\n                        ).done(function (newTask) {\n                            that.updateUI(newTask);\n                        });\n\n                        that.jui.dialog(\"close\");\n                    },\n                },\n                {\n                    text: \"Cancel\",\n                    class: \"btnCancelIt\",\n                    click: function () {\n                        that.jui.dialog(\"close\");\n                    },\n                },\n            ],\n        });\n    }\n\n    private static createAndLinkWebDlg(config: ITaskConfiguration, task: IExternalItem, changeFunction: Function) {\n        let form = $(\n            '<div class=\"container\" style=\"width:100%;height:100%;position:relative\">' +\n                '  <div class=\"row\"><br/>' +\n                \"  </div>\" +\n                '  <div class=\"row\">' +\n                '    <div style=\"padding:0\" class=\"col-md-1\"><label style=\"white-space: nowrap;padding-top:6px\" for=\"inputTitle\" class=\"control-label\">Text:</label></div>' +\n                '    <div class=\"col-md-11\"><input autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"inputTitle\" placeholder=\"enter text to display\"></div>' +\n                \"  </div>\" +\n                '  <div class=\"row\"><br/>' +\n                \"  </div>\" +\n                '  <div class=\"row\">' +\n                '    <div style=\"padding:0\" class=\"col-md-1\"><label style=\"white-space: nowrap;padding-top:6px\" for=\"inputUrl\" class=\"control-label\">Url:</label></div>' +\n                '    <div class=\"col-md-11\"><input autocomplete=\"off\" type=\"text\" class=\"form-control\" id=\"inputUrl\" placeholder=\"enter link address\"></div>' +\n                \"  </div>\" +\n                \"</div>\",\n        );\n\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-v-scroll\");\n        app.dlgForm.addClass(\"dlg-no-scroll\");\n        app.dlgForm.append(form);\n\n        let emptyTitle = !task || !task.externalItemTitle;\n\n        $(\"#inputTitle\").on(\"mouseup keyup mouseout\", function () {\n            emptyTitle = $(\"#inputTitle\").val() === \"\";\n        });\n\n        $(\"#inputUrl\").on(\"mouseup keyup mouseout\", function () {\n            if (emptyTitle) {\n                $(\"#inputTitle\").val($(\"#inputUrl\").val());\n            }\n            updateCanOK();\n        });\n\n        $(\"#doSearch\").prop(\"disabled\", true);\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Add web link\",\n            height: 250,\n            width: 600,\n            modal: true,\n            resizeStop: function () {},\n            buttons: [\n                {\n                    text: \"Ok\",\n                    class: \"btnDoIt\",\n                    click: function () {\n                        let newUrl = $(\"#inputUrl\").val();\n                        let newTitle = $(\"#inputTitle\").val() ? $(\"#inputTitle\").val() : newUrl;\n\n                        changeFunction(newTitle, newUrl);\n\n                        $(\"button\", app.dlgForm).prop(\"disabled\", true);\n                        window.setTimeout(function () {\n                            app.dlgForm.dialog(\"close\");\n                        }, 300);\n                    },\n                },\n                {\n                    text: \"Cancel\",\n                    class: \"btnCancelIt\",\n                    click: function () {\n                        app.dlgForm.dialog(\"close\");\n                    },\n                },\n            ],\n            open: function () {\n                if (task) {\n                    if (task.externalItemUrl) {\n                        $(\"#inputUrl\").val(task ? task.externalItemUrl : \"\");\n                    }\n                    if (task.externalItemTitle) {\n                        $(\"#inputTitle\").val(task ? task.externalItemTitle : \"\");\n                    }\n                }\n                updateCanOK();\n                $(\"#inputUrl\").focus();\n            },\n        });\n\n        function updateCanOK() {\n            let okButton = $(\".btnDoIt\", app.dlgForm.parent());\n            ml.UI.setEnabled(okButton, $(\"#inputUrl\").val() !== \"\");\n        }\n    }\n\n    private createSearchAndLinkIssueDlg(config: ITaskConfiguration) {\n        let that = this;\n\n        // open new page\n        let win = window.open(config.nativeCreateUrl);\n        this.waitForNewTaskOrWindowCloseActive = true;\n\n        // show wait dialog\n        let form = ml.UI.getSpinningWait(\n            \"Opened native create in other browser tab. Waiting for task to be created or tab to be closed.\",\n        );\n        this.jui.html(\"\");\n        this.jui.removeClass(\"dlg-v-scroll\");\n        this.jui.addClass(\"dlg-no-scroll\");\n        this.jui.append(form);\n\n        this.jui.dialog({\n            autoOpen: true,\n            title: \"Wait for new task from other tab\",\n            height: 300,\n            width: 600,\n            modal: true,\n            buttons: [\n                {\n                    text: \"Cancel\",\n                    class: \"btnCancelIt\",\n                    click: function () {\n                        that.waitForNewTaskOrWindowCloseActive = false;\n                        window.clearTimeout(that.waitForNewTaskOrWindowCloseTimer);\n                        that.jui.dialog(\"close\");\n                    },\n                },\n            ],\n            open: function () {},\n            close: function () {\n                ml.UI.setEnabled($(\".btnDoIt\", app.dlgForm.parent()), true);\n            },\n        });\n\n        // run the config.nativeCreateSearch to get a list of hits BEFORE user can create an issue\n        Tasks.getFindTasks(config.pluginId, config.nativeCreateSearch, 0).done(function (result: ISearchResults) {\n            that.waitForNewTaskOrWindowClose(config, win, result);\n        });\n    }\n\n    private waitForNewTaskOrWindowCloseActive: boolean;\n    private waitForNewTaskOrWindowCloseTimer: number;\n    private waitForNewTaskOrWindowClose(config: ITaskConfiguration, win: Window, taskSearchBefore: ISearchResults) {\n        let that = this;\n        if (!this.waitForNewTaskOrWindowCloseActive) {\n            // the wait has been handled, e.g. by closing the dialogs\n            return;\n        }\n        if (win.closed !== false) {\n            // !== is required for compatibility with Opera\n            this.waitForNewTaskOrWindowCloseActive = false;\n            window.clearTimeout(this.waitForNewTaskOrWindowCloseTimer);\n            that.jui.dialog(\"close\");\n            this.searchAndLinkIssueDlg(config, config.nativeCreateSearch);\n        } else {\n            Tasks.getFindTasks(config.pluginId, config.nativeCreateSearch, 0).done(function (result: ISearchResults) {\n                if (!that.waitForNewTaskOrWindowCloseActive) {\n                    // the wait has been handled, e.g. by closing the dialogs\n                    return;\n                }\n                if (\n                    result.tasks.length > taskSearchBefore.tasks.length ||\n                    (result.tasks.length > 0 &&\n                        result.tasks[0].externalItemId !== taskSearchBefore.tasks[0].externalItemId)\n                ) {\n                    that.waitForNewTaskOrWindowCloseActive = false;\n                    window.clearTimeout(that.waitForNewTaskOrWindowCloseTimer);\n                    that.jui.dialog(\"close\");\n                    that.searchAndLinkIssueDlg(config, config.nativeCreateSearch);\n                } else {\n                    that.waitForNewTaskOrWindowCloseTimer = window.setTimeout(function () {\n                        that.waitForNewTaskOrWindowClose(config, win, result);\n                    }, 300);\n                }\n            });\n        }\n    }\n\n    private searchAndLinkIssueDlg(config: ITaskConfiguration, showSearch?: string) {\n        let that = this;\n        // help jira: https://matrixreq.atlassian.net/wiki/x/AwD3\n        let jh = config.searchHelp\n            ? \"<a style='margin-left:10px' href='\" +\n              config.searchHelp +\n              \"' target='_blank'><span class='fal fa-info-circle'></span></a>\"\n            : \"\";\n        let defaultSearch =\n            config.defaultSearches && config.defaultSearches.length > 0 ? config.defaultSearches[0] : \"\";\n        if (showSearch) {\n            defaultSearch = { name: showSearch, expression: showSearch };\n        }\n        let form = $('<div style=\"width:100%;height:100%;position:relative\">').append(\n            this.getSearchField(config, refreshSearch),\n        );\n\n        let results = $('<div class=\"row taskFit\">').appendTo(form);\n\n        let moreInfo = $(\n            '<div class=\"moreTasks\" style=\"width: 100%;text-align: center;\"><br/>enter search term</div>',\n        ).appendTo(results);\n\n        this.jui.html(\"\");\n        this.jui.removeClass(\"dlg-v-scroll\");\n        this.jui.addClass(\"dlg-no-scroll\");\n        this.jui.append(form);\n\n        let start = 0;\n        let select: IExternalItem[] = [];\n\n        this.jui.dialog({\n            autoOpen: true,\n            title: \"Search tasks\",\n            height: 500,\n            width: 600,\n            modal: true,\n            buttons: [\n                {\n                    text: \"Ok\",\n                    class: \"btnDoIt\",\n                    click: function () {\n                        ml.UI.setEnabled($(\".btnDoIt\", app.dlgForm.parent()), false);\n\n                        Tasks.postCreateLinks(that.item.id, select).done(function () {\n                            that.updateUI(select);\n                            that.jui.dialog(\"close\");\n                        });\n\n                        results.html(\"\");\n                        results.append(ml.UI.getSpinningWait(\"creating links...\"));\n                        ml.UI.setEnabled($(\".ui-dialog-buttonset button\", that.jui.parent()), false);\n                        ml.UI.setEnabled($(\"#appPopup button\", that.jui.parent()), false);\n                    },\n                },\n                {\n                    text: \"Cancel\",\n                    class: \"btnCancelIt\",\n                    click: function () {\n                        that.jui.dialog(\"close\");\n                    },\n                },\n            ],\n            open: function () {\n                updateCanOK();\n                if (showSearch) {\n                    refreshSearch(showSearch, true);\n                } else if (config.defaultSearches && config.defaultSearches.length > 0 && config.autoSearch) {\n                    refreshSearch(config.defaultSearches[0].expression, true);\n                } else {\n                    $(\"#inputSearch\").focus();\n                }\n            },\n            close: function () {\n                ml.UI.setEnabled($(\".btnDoIt\", app.dlgForm.parent()), true);\n            },\n        });\n\n        function updateCanOK() {\n            ml.UI.setEnabled($(\".btnDoIt\", app.dlgForm.parent()), select.length > 0);\n        }\n        function refreshSearch(searchExpression: string, reset: boolean) {\n            select = [];\n            updateCanOK();\n\n            moreInfo.remove();\n\n            if (reset) {\n                // user launched a new search, need to get rid of previous results\n                start = 0;\n            }\n            if (start == 0) {\n                results.html(\"\").append(moreInfo);\n            }\n            moreInfo.html(\"\").append(ml.UI.getSpinningWait(\"searching...\")).appendTo(results);\n\n            Tasks.getFindTasks(config.pluginId, searchExpression, start)\n                .done(function (result: ISearchResults) {\n                    moreInfo.remove();\n\n                    if (result.tasks.length === 0) {\n                        results.append(\n                            '<br/><br/><div class=\"moreTasks\">no (more) results have been found</div><br/><br/>',\n                        );\n                        results.scrollTop(results[0].scrollHeight);\n                        return;\n                    }\n                    let more = result.tasks.length == result.maxResults;\n\n                    $.each(result.tasks, function (ridx, task) {\n                        let res = $(\"<div style='cursor:pointer'>\").append(\n                            Tasks.renderTask(that.item.id, task, false, true, true),\n                        );\n                        results.append(res);\n                        res.data(\"task\", task);\n                        res.dblclick(function (event: JQueryEventObject) {\n                            $(\".selectedIssue\").removeClass(\"selectedIssue\");\n                            select = [$(event.delegateTarget).data(\"task\")];\n                            $(event.delegateTarget).addClass(\"selectedIssue\");\n                            updateCanOK();\n                            $(\".ui-dialog-buttonpane button:contains('Ok')\", app.dlgForm.parent()).trigger(\"click\");\n                        }).click(function (event: JQueryEventObject) {\n                            // MATRIX-1367: attaching existing jira issues: allow multi select\n                            // $(\".selectedIssue\").removeClass(\"selectedIssue\");\n                            $(event.delegateTarget).toggleClass(\"selectedIssue\");\n                            select = [];\n                            $.each($(\".selectedIssue\"), function (idx, si) {\n                                select.push($(si).data(\"task\"));\n                            });\n                            updateCanOK();\n                        });\n                    });\n                    results.highlightReferences({ noExternals: true });\n                    if (more) {\n                        start += result.maxResults;\n                        let next = \"get more results...\";\n                        moreInfo = $(\"<div class='moreTasks' style='cursor:pointer'>\").html(next);\n                        moreInfo.appendTo(results).click(function (event) {\n                            moreInfo.html(\"\").append(ml.UI.getSpinningWait(\"searching...\"));\n                            refreshSearch(searchExpression, false);\n                        });\n                    }\n                    // dont scroll down to \"get more results...\" button:\n                    // results.scrollTop(results[0].scrollHeight);\n                })\n                .fail(function (result) {\n                    results.html(result);\n                });\n        }\n    }\n\n    static getConfig(pluginId: number) {\n        for (let idx = 0; idx < Tasks.tasksConfiguration.length; idx++) {\n            if (Tasks.tasksConfiguration[idx].pluginId == pluginId) {\n                return Tasks.tasksConfiguration[idx];\n            }\n        }\n        return null;\n    }\n    private renderProjectPage(options: IPluginPanelOptions) {\n        let that = this;\n\n        if (options.controlState === ControlState.Print) {\n            return;\n        }\n\n        let pluginId = Number(options.type.replace(\"_TASKS\", \"\"));\n\n        options.control.html(\"\").append(ml.UI.getSpinningWait(\"retrieving tasks\"));\n\n        // get all tasks for plugin\n        Tasks.getAllTasksProject(pluginId)\n            .done(function (alltasks) {\n                let selectedFolders: string[] = [];\n                let textFilter: string = \"\";\n                enum TaskStatus {\n                    All = \"All\",\n                    Open = \"Open\",\n                    Closed = \"Closed\",\n                }\n                let activeStatusFilter: TaskStatus = TaskStatus.All;\n\n                options.control.html(\"\");\n\n                if (alltasks.length === 0) {\n                    options.control.append(\"<b>There are no tasks for this project!</b>\");\n                    return;\n                }\n\n                const folderPlaceHolderText = \"Select folders to include\";\n\n                const removeLinksByStatus = (task: IWltItemWithLinks) => {\n                    if (activeStatusFilter === TaskStatus.All) {\n                        return task;\n                    }\n                    const copy: IWltItemWithLinks = JSON.parse(JSON.stringify(task));\n                    copy.links = copy.links.filter((link) => {\n                        switch (activeStatusFilter) {\n                            case TaskStatus.All:\n                                return true;\n                            case TaskStatus.Closed:\n                                return link.externalDone;\n                            case TaskStatus.Open:\n                                return !link.externalDone;\n                        }\n                    });\n                    return copy;\n                };\n                const removeItemsWithoutLinks = (task: IWltItemWithLinks) => task.links.length > 0;\n                const removeLinksByText = (task: IWltItemWithLinks) => {\n                    const loweredFilter = textFilter.toLowerCase();\n                    const matrixItemMatches =\n                        (task.matrixItem.title && task.matrixItem.title.toLowerCase().indexOf(loweredFilter) !== -1) ||\n                        (task.matrixItem.matrixItem &&\n                            task.matrixItem.matrixItem.toLowerCase().indexOf(loweredFilter) !== -1);\n                    if (matrixItemMatches) {\n                        // The matrix item matches, return all links\n                        return task;\n                    } else {\n                        const copy: IWltItemWithLinks = JSON.parse(JSON.stringify(task));\n                        copy.links = copy.links.filter(\n                            (link) =>\n                                (link.externalItemTitle &&\n                                    link.externalItemTitle.toLowerCase().indexOf(loweredFilter) !== -1) ||\n                                (link.externalDescription &&\n                                    link.externalDescription.toLowerCase().indexOf(loweredFilter) !== -1) ||\n                                (link.externalItemId &&\n                                    link.externalItemId.toLocaleLowerCase().indexOf(loweredFilter) !== -1),\n                        );\n                        return copy;\n                    }\n                };\n\n                let tableItem: JQuery = null;\n                const renderTable = () => {\n                    const buttonText = selectedFolders.length > 0 ? selectedFolders.join(\",\") : folderPlaceHolderText;\n                    folderSelectionButton.text(buttonText);\n                    if (tableItem) tableItem.remove();\n                    const filteredTasks = alltasks\n                        .map(removeLinksByStatus)\n                        .filter(removeItemsWithoutLinks)\n                        .map(removeLinksByText)\n                        .filter(removeItemsWithoutLinks);\n\n                    // console.log(\"Filtered tasks\", filteredTasks);\n\n                    tableItem = Tasks.renderTasksInTable(filteredTasks, selectedFolders, (folderAdd: Folder) => {\n                        if (selectedFolders.indexOf(folderAdd.id) === -1) {\n                            selectedFolders.push(folderAdd.id);\n                        }\n                        renderTable();\n                    });\n                    options.control.append(tableItem);\n                };\n\n                const filterToolbar = $(\"<div id='taskFilterToolbar' style='padding: 5px;display: flex;'>\");\n\n                const itemSelection = new ItemSelectionTools();\n                const categories = globalMatrix.ItemConfig.getCategories(true).map((cat) => ({ type: cat }));\n                const selectOptions: IItemSelectDialogOptions = {\n                    selectMode: SelectMode.folders,\n                    linkTypes: categories,\n                    focusOn: globalMatrix.ItemConfig.getCategories(true)[0],\n                    autoScroll: false,\n                    getSelectedItems: async () => selectedFolders.map((folder) => ({ to: folder, title: folder })), // is called before dialog is opened to get currently selected items\n                    selectionChange: (newSelection: IReference[]) => {\n                        // console.log(\"Selected items\", newSelection);\n                        selectedFolders = newSelection.map((selection) => selection.to);\n                        renderTable();\n                    },\n                };\n\n                const treeFilterGroup = $(\"<div class='btn-group' style='max-width: 75%; display: flex;'>\");\n                const folderSelectionButton = $(\n                    \"<button class='btn btn-default btn-xs' style='text-align: left; \" +\n                        \"overflow:hidden; text-overflow: ellipsis; min-width: 20em;'>\",\n                )\n                    .text(folderPlaceHolderText)\n                    .click(() => {\n                        itemSelection.showDialog(selectOptions);\n                    });\n                treeFilterGroup.append(folderSelectionButton);\n\n                const clearButton = $(\"<button class='btn btn-default btn-xs' style='flex-grow: 0; flex-shrink: 0;'>\")\n                    .text(\"Clear\")\n                    .click(() => {\n                        selectedFolders = [];\n                        renderTable();\n                    });\n                treeFilterGroup.append(clearButton);\n                filterToolbar.append(treeFilterGroup);\n\n                const selectStatus = $(\n                    \"<select class='form-control input-sm' style='height: 22px; width: 12em; margin: 0; margin-right: 5px;'>\",\n                ).change((ev) => {\n                    activeStatusFilter = $(ev.target).val();\n                    renderTable();\n                });\n                Object.keys(TaskStatus).forEach((value) =>\n                    selectStatus.append(`<option ${activeStatusFilter == value ? \"selected\" : \"\"}>${value}</option>`),\n                );\n                filterToolbar.append(selectStatus);\n\n                // From https://davidwalsh.name/javascript-debounce-function\n                function debounce(func: (...args: any[]) => void, wait: number, immediate: boolean = false) {\n                    let timeout: number;\n                    return function (this: any) {\n                        let context = this,\n                            args = arguments;\n                        let later = function () {\n                            timeout = null;\n                            // @ts-ignore\n                            if (!immediate) func.apply(context, args);\n                        };\n                        let callNow = immediate && !timeout;\n                        clearTimeout(timeout);\n                        timeout = window.setTimeout(later, wait);\n                        // @ts-ignore\n                        if (callNow) func.apply(context, args);\n                    };\n                }\n                const filterTextInput = $(\n                    \"<input type='text' class='form-control input-sm' placeholder='Filter by Title' \" +\n                        \"style='height: 22px;margin-top: 0px;'>\",\n                )\n                    .val(textFilter)\n                    .keyup(\n                        debounce(function (ev) {\n                            textFilter = $(ev.target).val();\n                            renderTable();\n                        }, 250),\n                    );\n                filterToolbar.append(filterTextInput);\n\n                options.control.append(filterToolbar);\n                renderTable();\n            })\n            .fail(function (errorMsg) {\n                options.control.html(\"\");\n\n                options.control.append(\"<b>Failed to retrieve tasks!</b><br>Error was:\" + errorMsg);\n            });\n    }\n\n    /* helper */\n    private updateUI(tasks: IExternalItem[]) {\n        let that = this;\n\n        let ctrls = matrixApplicationUI.lastMainItemForm.getControls(\"tasksControl\");\n        for (let idx = 0; idx < ctrls.length; idx++) {\n            let filter = (<TasksControlImpl>ctrls[idx].getController()).getPluginFilter();\n            let ul = $(\".ticket-list\", ctrls[idx]);\n            if (ul.length == 0) {\n                // list still empty\n                ul = $(\"<ul class='ticket-list baseControl'>\");\n                $(\"ul\", ctrls[idx]).replaceWith(ul);\n            }\n            $.each(tasks, function (idx, task) {\n                if (!filter || filter.length == 0 || filter.indexOf(task.plugin) !== -1) {\n                    // Check if the task is already displayed\n                    const matchingTasks = ul.children().filter((index, child: HTMLElement) => {\n                        const segments = child.innerText.split(\"\\n\");\n                        return segments.length > 0 && segments[0] == task.externalItemId;\n                    });\n                    if (matchingTasks.length == 0) {\n                        let item = $(\"<li class='taskDisplayContainer'>\").append(\n                            Tasks.renderTask(that.item.id, task, true, false),\n                        );\n                        ul.append(item);\n                    }\n                }\n            });\n        }\n    }\n\n    private static getTaskDefinition(task: IExternalItem): ITaskType {\n        let res: ITaskType;\n        $.each(Tasks.tasksConfiguration, function (tci, tc) {\n            $.each(tc.projectsCreate, function (i, project) {\n                if (project.projectId == task.externalProject) {\n                    $.each(project.taskTypes, function (j, taskType) {\n                        if (taskType.taskTypeId == task.externalType) {\n                            res = taskType;\n                        }\n                    });\n                }\n            });\n        });\n        return res;\n    }\n\n    // render a bunch of tasks in a list\n    static renderTasks(\n        itemId: string,\n        linkedTasks: IExternalItem[],\n        root: JQuery,\n        canEdit: boolean,\n        fullWidth: boolean,\n    ) {\n        if (linkedTasks.length > 0) {\n            var items = $(\"<ul class='ticket-list'></ul>\").addClass(\"baseControl\");\n            root.append(items);\n\n            for (let tidx = 0; tidx < linkedTasks.length; tidx++) {\n                let item = $(\"<li class='taskDisplayContainer'>\").append(\n                    Tasks.renderTask(itemId, linkedTasks[tidx], canEdit, fullWidth),\n                );\n                items.append(item);\n            }\n        } else {\n            var items = $(\"<ul style='margin-top:0px;margin-bottom:0px'></ul>\");\n            root.append(items);\n            items.append($(\"<li>\").append('<div style=\"color: #bbb;font-size: 12px;\">no tasks linked</div>'));\n        }\n    }\n\n    // From Tom Gruner @ http://stackoverflow.com/a/12034334/1660815\n    private static escapeHtml(source: string): string {\n        let entityMap: any = {\n            \"<\": \"&lt;\",\n            \">\": \"&gt;\",\n            '\"': \"&quot;\",\n            \"'\": \"&#39;\",\n            \"/\": \"&#x2F;\",\n        };\n        return String(source).replace(/[<>\"'\\/]/g, (s) => entityMap[s]);\n    }\n\n    // render a single task, maybe with option to unlink\n    static renderTask(\n        itemId: string,\n        task: IExternalItem,\n        unlink: boolean,\n        fullWidth: boolean,\n        tinyLink?: boolean,\n    ): JQuery {\n        function showDescription(id: JQuery, task: IExternalItem) {\n            let prefix = \"\";\n            if (task.externalProject) {\n                prefix = task.externalProject + \"-\";\n            }\n            ml.UI.showTaskAsTooltip(\n                prefix + task.externalItemId,\n                task.externalItemTitle,\n                task.externalItemUrl,\n                \"<div>\" + ml.UI.getSpinningWait(\"loading description...\").html() + \"</div>\",\n                id,\n            );\n\n            Tasks.getMeta(task.plugin, task.externalItemId).done(function (externalData: IExternalItem) {\n                let status = \"\";\n                if (task.externalMeta) {\n                    // \"{\"issueType\":\"Task\",\"status\":\"Backlog\"}\"\n                    let metaJson: IExternalMeta = JSON.parse(task.externalMeta);\n                    status = `<span class='taskStatus' >${metaJson.status}</span> `;\n                }\n                ml.UI.showTaskAsTooltip(\n                    prefix + task.externalItemId,\n                    task.externalItemTitle,\n                    task.externalItemUrl,\n                    `<div> ${externalData.externalDescription} </div><span style=\"position:absolute;top:6px;right:18px;\" >${status}</span>`,\n                    id,\n                );\n            });\n            return \"\";\n        }\n\n        let ret = $(\"<span class='taskDisplay'>\").data(\"externalItemId\", task.externalItemId);\n\n        let taskTypeDef = Tasks.getTaskDefinition(task);\n\n        let config = this.getConfig(task.plugin);\n\n        if (!config) {\n            return ret;\n        }\n        let hiddenStyle = \"\";\n        // there is no external project known here when showing external links from server... so let's not do anything\n        //if ( config.projectFilter && config.projectFilter.length > 0 && config.projectFilter.indexOf(task.externalProject) == -1) {\n        //    hiddenStyle = \"color:#ccc !important\";\n        //}\n        let isWebLink = config && config.handleAsLink;\n\n        let icon = '<i class=\"ticket-icon-icon fal fa-thumbtack\">';\n        if (isWebLink) {\n            let fixIcon = \"$(this).css('display','none').parent().addClass('fal fa-external-link')\";\n            icon = '<i class=\"ticket-icon-icon fal fa-external-link\">';\n            try {\n                icon =\n                    '<span><img class=\"\" src=\"https://www.google.com/s2/favicons?domain_url=' +\n                    encodeURIComponent(new URL(task.externalItemUrl).hostname) +\n                    '\" onerror=\"' +\n                    fixIcon +\n                    '\" /></span>';\n            } catch (e) {\n                // probably a bad URL\n            }\n        }\n        if (taskTypeDef && taskTypeDef.iconClass) {\n            icon = '<i class=\"ticket-icon-icon ' + taskTypeDef.iconClass + '\">';\n        } else if (taskTypeDef && taskTypeDef.iconUrl) {\n            icon = '<img class=\"ticket-icon-icon\" src=\"' + taskTypeDef.iconUrl + '\">';\n        }\n\n        ret.append(\"<span class='ticket-icon'>\" + icon + \"<span class='ticket-key'>\");\n        if (isWebLink) {\n            let id = $(\n                `<span title='${config.pluginName}' class='ticket-id'><b style='${\n                    task.externalDone ? \"text-decoration:line-through\" : \"\"\n                }'>${task.externalItemTitle}</b></span>`,\n            );\n            id.tooltip({ placement: \"bottom\", container: \"body\" });\n            ret.append(id);\n\n            if (task.externalItemUrl) {\n                id.data(\"url\", task.externalItemUrl).click(function (event) {\n                    window.open($(event.delegateTarget).data(\"url\"), \"_blank\");\n                });\n            }\n        } else {\n            let ttip = \"hold shift to see a preview\";\n            if (!config.hasMeta) {\n                ttip = \"click to follow link\";\n            }\n\n            // tiny links are used to have a selectable row in jira addon for example (when clicking on ticket it should not follow the link but select the row)\n            let id = tinyLink\n                ? $(\n                      `<span class='tinylinkc'><b style='${hiddenStyle};${\n                          task.externalDone ? \"text-decoration: line-through\" : \"\"\n                      }'>${\n                          task.externalItemId\n                      }</b><a class='ticket-id fas fa-arrow-to-right' data-original-title=\"${ttip}\" title=\"${ttip}\"></a></span>`,\n                  )\n                : $(\n                      `<a class='ticket-id' data-original-title=\"${ttip}\" title=\"${ttip}\"><b style='${hiddenStyle};${\n                          task.externalDone ? \"text-decoration: line-through\" : \"\"\n                      }'>${task.externalItemId}</b></a>`,\n                  );\n\n            id.tooltip({ placement: \"bottom\", container: \"body\" });\n\n            if (config.hasMeta) {\n                id.hover(\n                    () => {\n                        if (globalMatrix.globalShiftDown) showDescription(id, task);\n                    },\n                    () => {\n                        if (!globalMatrix.globalShiftDown) {\n                            setTimeout(() => {\n                                ml.UI.hideTooltip();\n                            }, 1000);\n                        }\n                    },\n                );\n            }\n\n            ret.append(id);\n\n            if (task.externalItemUrl) {\n                let clickHandler = tinyLink ? $(\"a\", id) : id;\n\n                clickHandler.data(\"url\", task.externalItemUrl).click(function (event) {\n                    window.open($(event.delegateTarget).data(\"url\"), \"_blank\");\n\n                    if (event.preventDefault) event.preventDefault();\n                    if (event.stopPropagation) event.stopPropagation();\n                });\n            }\n\n            ret.append(\n                \"<span class='ticket-title \" +\n                    (fullWidth ? \"ticket-title-full\" : \"\") +\n                    \"'>\" +\n                    Tasks.escapeHtml(task.externalItemTitle) +\n                    \"</span>\",\n            );\n            if (config.hasMeta && config.showStatus) {\n                if (task.externalMeta) {\n                    // \"{\"issueType\":\"Task\",\"status\":\"Backlog\"}\"\n                    let metaJson: IExternalMeta = JSON.parse(task.externalMeta);\n                    $(\".ticket-title\", ret).append(`<span class='taskStatus' >${metaJson.status}</span> `);\n                }\n            }\n        }\n\n        if (task.externalUser) {\n            ret.append(\"<span class='ticket-user'>(\" + task.externalUser + \")</span>\");\n        }\n\n        if (unlink) {\n            let ulb = $(\"<span style='padding-left:20px' title='remove link'><i class='fal fa-unlink'></i></span>\")\n                .click(function (event: JQueryEventObject) {\n                    let theButton = $(event.delegateTarget);\n                    let theRow = theButton.closest(\".taskDisplayContainer\");\n                    let theItem = theButton.data(\"itemId\");\n                    let theTask: IExternalItem = <IExternalItem>theButton.data(\"task\");\n                    ml.UI.showConfirm(\n                        3,\n                        {\n                            title: \"Remove link to '\" + theTask.externalItemId + \" \" + theTask.externalItemTitle + \"'?\",\n                            ok: \"Remove\",\n                        },\n                        function () {\n                            theButton.replaceWith($(\"<span class='fal fa-sync-alt refresh-animate'>\"));\n                            Tasks.deleteLink(theItem, theTask)\n                                .done(function () {\n                                    theRow.css(\"display\", \"none\");\n                                })\n                                .fail(function (message) {\n                                    ml.UI.showError(\"Cannot remove link: \", message);\n                                });\n                        },\n                        function () {\n                            // nothing to do...\n                        },\n                    );\n                })\n                .tooltip()\n                .data(\"task\", task)\n                .data(\"itemId\", itemId);\n\n            ret.append($(\"<span class='ticket-unlink'>\").append(ulb));\n\n            if (isWebLink) {\n                let editb = $(\"<span style='padding-left:20px' title='edit link'><i class='fal fa-pencil'></i></span>\")\n                    .click(function (event: JQueryEventObject) {\n                        let theButton = $(event.delegateTarget);\n                        let theRow = theButton.closest(\".taskDisplayContainer\");\n                        let theItem = theButton.data(\"itemId\");\n                        let theConfig = theButton.data(\"config\");\n                        let theTask: IExternalItem = <IExternalItem>theButton.data(\"task\");\n                        Tasks.createAndLinkWebDlg(theConfig, task, function (linkTitle: string, linkUrl: string) {\n                            // create a copy of the old task (to delete it later)\n                            let oldTask = ml.JSON.clone(theTask);\n                            // update the task\n                            theTask.externalItemId = \"\" + new Date().getTime();\n                            theTask.externalItemTitle = linkTitle;\n                            theTask.externalItemUrl = linkUrl;\n\n                            Tasks.postCreateLinks(theItem, [theTask]).done(function (results) {\n                                $.each(results, function (tidx, task) {\n                                    // overwrite the task with the data fromt he server (e.g. the plugin might change the done status)\n                                    if (task.externalItemId == theTask.externalItemId) {\n                                        theTask = task;\n                                    }\n                                });\n                                Tasks.deleteLink(theItem, oldTask).done(function () {\n                                    $(\".ticket-id\", theRow)\n                                        .data(\"url\", theTask.externalItemUrl)\n                                        .html(\n                                            \"<b style='\" +\n                                                (theTask.externalDone ? \"text-decoration: line-through\" : \"\") +\n                                                \"'>\" +\n                                                theTask.externalItemTitle +\n                                                \"</b></span>\",\n                                        );\n                                    theButton.data(\"task\", theTask);\n                                });\n                            });\n                        });\n                    })\n                    .tooltip()\n                    .data(\"config\", config)\n                    .data(\"task\", task)\n                    .data(\"itemId\", itemId);\n\n                ret.append($(\"<span class='ticket-unlink'>\").append(editb));\n            }\n        }\n\n        return ret;\n    }\n\n    private getSearchField(\n        config: ITaskConfiguration,\n        searchFunction: (searchExpression: string, reset: boolean) => any,\n    ): JQuery {\n        let that = this;\n\n        let inputSpace = $('<div class=\"input-group rowFlex rowFlexNoWrapNoGap\" >');\n        var textInput = $(\n            '<input autocomplete=\"off\" type=\"text\" autofocus=\"autofocus\" name=\"search\" placeholder=\"Search...\" class=\"form-control searchNoX\" style=\"height:36px\">',\n        )\n            .appendTo(inputSpace)\n            .on(\"mouseup keyup mouseout\", function () {\n                mir_btn.prop(\"disabled\", !config.allowEmptySearches && (<string>textInput.val()).length < 3);\n            })\n            .keypress(function (e) {\n                if (e.which == 13 && (config.allowEmptySearches === true || (<string>textInput.val()).length >= 3)) {\n                    mir_btn.trigger(\"click\");\n                }\n            });\n\n        var mir_btn = $(\n            '<button class=\"btn btn-item taskSearch\" type=\"button\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Search for tasks\"><i style=\"position:relative;top:4px;color:#bbb\" class=\"fal fa-file-alt\"></i><i style=\"position:relative;margin-left:-7px\" class=\"fal fa-search\"></button>',\n        )\n            .appendTo(inputSpace)\n            .click(function () {\n                searchFunction(textInput.val(), true);\n            })\n            .prop(\"disabled\", true);\n\n        let dropDown = $(\n            '<button class=\"btn btn-item taskDropdown\" type=\"button\" data-toggle=\"dropdown\"><span class=\"caret\"></span></button>',\n        );\n        let ul = $(' <ul class=\"dropdown-menu dropdown-menu-sub pull-right role=\"menu\"> ');\n\n        $.each(config.defaultSearches, function (idx, search) {\n            if (search.name) {\n                $(\n                    '<li title=\"Search for ' +\n                        search.expression +\n                        '\"><a href=\"javascript:void(0)\">' +\n                        search.name +\n                        \"</a></li>\",\n                )\n                    .appendTo(ul)\n                    .data(\"expression\", search.expression)\n                    .click(function (event: JQueryEventObject) {\n                        textInput.val($(event.delegateTarget).data(\"expression\"));\n                        mir_btn.trigger(\"click\");\n                    });\n            }\n        });\n\n        if (config.defaultSearches && config.defaultSearches.length > 0 && config.defaultSearches[0].name) {\n            textInput.val(config.defaultSearches[0].expression);\n        }\n\n        if (config.searchHelp) {\n            let help = $(\n                '<li title=\"Search help\" ><a class=\"documentationLink\" href=\"javascript:void(0)\">Search Help</a></li>',\n            );\n            ul.append(help);\n            help.click(function () {\n                window.open(config.searchHelp);\n            });\n        }\n\n        if (ul.children().length > 0) {\n            inputSpace.append($(\"<div class='taskSearchAddon taskDropDownGroup'>\").append(dropDown).append(ul));\n        }\n\n        return inputSpace;\n    }\n\n    // this function receives a list of smart links to tasks as defined by the user in test results\n    // it must take these tasks and create something the server can link to\n    private createLinksAsync(linksToBeCreated: string[]): JQueryDeferred<{}> {\n        let that = this;\n\n        let linkJobs: IExternalItem[] = [];\n\n        // build a list of link job tupels, which plugin and with which 'command'\n        $.each(Tasks.tasksConfiguration, function (tidx, config) {\n            $.each(config.smartLinks, function (sidx, smartLink) {\n                $.each(linksToBeCreated, function (idx, ltc) {\n                    let re = new RegExp(smartLink.regex);\n                    let ma = ltc.match(re);\n                    if (ma) {\n                        // it matches: replace all placeholders, $0, $1, $2, with matching groups\n                        let issueProjectId = smartLink.issueProjectId;\n                        let issueId = smartLink.issueId;\n                        let url = smartLink.url;\n                        let title = smartLink.title;\n                        for (let i = 0; i < Math.min(ma.length, 10); i++) {\n                            let rep = new RegExp(\"\\\\$\" + i, \"g\");\n                            issueProjectId = issueProjectId.replace(rep, ma[i]);\n                            issueId = issueId.replace(rep, ma[i]);\n                            url = url.replace(rep, ma[i]);\n                            title = title.replace(rep, ma[i]);\n                        }\n                        linkJobs.push({\n                            plugin: config.pluginId,\n                            externalProject: issueProjectId,\n                            externalItemId: issueId,\n                            externalItemUrl: url,\n                            externalDescription: \"\",\n                            externalItemTitle: title,\n                            externalDone: false,\n                            externalType: \"\",\n                        });\n                    }\n                });\n            });\n        });\n\n        return Tasks.postCreateLinks(this.item.id, linkJobs).done(function (createdTasks) {\n            that.updateUI(createdTasks);\n        });\n    }\n\n    /** rest api */\n\n    // this links one matrix item to multiple issues in multiple plugins\n    // not private: used by jiraPlugin.js\n    static postCreateLinks(itemId: string, tasksToLink: IExternalItem[]): JQueryDeferred<IExternalItem[]> {\n        let res = $.Deferred();\n\n        let project = matrixSession.getProject();\n        $.each(tasksToLink, function (tidx, task) {\n            if (!task.externalItemId || task.externalItemId == \" \") {\n                task.externalItemId = \"\" + new Date().getTime();\n            }\n        });\n        let job = {\n            action: \"CreateLinks\",\n            matrixItem: {\n                project: project,\n                matrixItem: itemId,\n            },\n            externalItems: tasksToLink,\n        };\n\n        globalMatrix.wfgwConnection\n            .postServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }, true))\n            .done(function (results) {\n                let nt: ITaskDetails[] = [];\n                $.each(tasksToLink, function (idx: number, link: IExternalItem) {\n                    (<ITaskDetails>link).matrixItemIds = [itemId];\n                    nt.push(<ITaskDetails>link);\n                });\n                res.resolve(nt);\n            })\n            .fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                Tasks.showError(\"Creating link(s) to issue(s) failed\", jqxhr, textStatus, error);\n                res.reject(jqxhr);\n            });\n\n        return <JQueryDeferred<IExternalItem[]>>res;\n    }\n\n    // this creates an issue in a specified plugin and links it to the item\n    static postCreateIssue(\n        pluginId: number,\n        itemId: string,\n        title: string,\n        description: string,\n        projectId: string,\n        taskTypeId: string,\n    ): JQueryDeferred<IExternalItem[]> {\n        let res = $.Deferred();\n        let project = matrixSession.getProject();\n        // Tasks.getConfig(pluginId).createBacklinks;\n\n        let job = {\n            pluginId: pluginId,\n            action: \"CreateIssue\",\n            matrixItem: {\n                project: project,\n                matrixItem: itemId,\n            },\n            externalItem: { externalItemTitle: title, externalDescription: description },\n            more: [\n                { key: \"project\", value: projectId },\n                { key: \"issueType\", value: taskTypeId },\n            ],\n        };\n        globalMatrix.wfgwConnection\n            .postServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }), job, true)\n            .done(function (task: IExternalItem[]) {\n                res.resolve(task);\n            })\n            .fail(function (jqxhr, textStatus, error) {\n                Tasks.showError(\"Creating issue failed\", jqxhr, textStatus, error);\n            });\n\n        return <JQueryDeferred<IExternalItem[]>>res;\n    }\n\n    // this gets linked tasks of a matrix item from multiple plugins. if no item is specified it gets all tasks...\n    // not private: used by jiraPlugin.js\n    static getTasks(itemId?: string, pluginFilter?: number[]): JQueryDeferred<IExternalItem[]> {\n        let res = $.Deferred();\n\n        let project = matrixSession.getProject();\n\n        let job = {\n            action: \"GetIssues\",\n            matrixItem: {\n                project: project,\n                matrixItem: itemId,\n            },\n        };\n\n        let nt: IExternalItem[] = [];\n\n        globalMatrix.wfgwConnection\n            .getServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }, true))\n            .done(function (links: IWltItemWithLinks[]) {\n                $.each(links, function (idx, hit) {\n                    $.each(hit.links, function (jdx, link) {\n                        if (!pluginFilter || pluginFilter.length == 0 || pluginFilter.indexOf(link.plugin) != -1) {\n                            nt.push(link);\n                        }\n                    });\n                });\n                res.resolve(nt);\n            })\n            .fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                Tasks.showError(\"Getting issues failed\", jqxhr, textStatus, error);\n            });\n\n        return <JQueryDeferred<IExternalItem[]>>res;\n    }\n\n    static getAllTasksProject(plugin: number): JQueryDeferred<IWltItemWithLinks[]> {\n        let res = $.Deferred();\n\n        let project = matrixSession.getProject();\n\n        let job = {\n            pluginId: plugin,\n            action: \"GetIssues\",\n            matrixItem: {\n                project: project,\n            },\n        };\n\n        globalMatrix.wfgwConnection\n            .getServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }, true))\n            .done(function (links: IWltItemWithLinks[]) {\n                res.resolve(links);\n            })\n            .fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                Tasks.showError(\"Getting all issues failed\", jqxhr, textStatus, error);\n            });\n\n        return <JQueryDeferred<IWltItemWithLinks[]>>res;\n    }\n\n    // this finds tasks in one plugin\n\n    private static getFindTasks(pluginId: number, search: string, startAt: number): JQueryDeferred<ISearchResults> {\n        let res = $.Deferred();\n\n        let project = matrixSession.getProject();\n\n        let job = {\n            pluginId: pluginId,\n            action: \"FindIssues\",\n            matrixItem: {\n                project: project,\n            },\n            startAt: startAt,\n            searchTerm: search,\n        };\n\n        globalMatrix.wfgwConnection\n            .getServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }, true))\n            .done(function (results: IExternalItem[]) {\n                res.resolve({ startAt: startAt, maxResults: 50, tasks: results });\n            })\n            .fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                Tasks.showError(\"Search failed\", jqxhr, textStatus, error);\n            });\n\n        return <JQueryDeferred<ISearchResults>>res;\n    }\n    static showError(text: string, jqxhr: IJcxhr, textStatus: string, error: string) {\n        let details = ml.UI.getDisplayError(jqxhr, textStatus, error);\n        if (details) {\n            ml.UI.showError(text, details);\n        } else {\n            ml.UI.showError(text, jqxhr ? jqxhr.statusText : \"Server error\");\n        }\n    }\n\n    static deleteLink(itemId: string, task: IExternalItem): JQueryDeferred<{}> {\n        let res = $.Deferred();\n\n        let project = matrixSession.getProject();\n\n        let job = {\n            pluginId: task.plugin,\n            action: \"BreakLinks\",\n            matrixItem: {\n                project: project,\n                matrixItem: itemId,\n            },\n            externalItems: [task],\n        };\n\n        globalMatrix.wfgwConnection\n            .deleteServerAsync(\"\", job, true)\n            .done(function () {\n                res.resolve();\n            })\n            .fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                Tasks.showError(\"Removing link failed\", jqxhr, textStatus, error);\n            });\n\n        return res;\n    }\n\n    static getMeta(pluginId: number, externalItemId: string): JQueryDeferred<IExternalItem> {\n        let res = $.Deferred();\n\n        let project = matrixSession.getProject();\n\n        let job = {\n            pluginId: pluginId,\n            action: \"GetMeta\",\n            matrixItem: {\n                project: project,\n            },\n            externalItem: {\n                externalItemId: externalItemId,\n            },\n        };\n\n        globalMatrix.wfgwConnection\n            .getServer(\"?\" + jQuery.param({ payload: JSON.stringify(job) }, true))\n            .done(function (result: IExternalItem) {\n                res.resolve(result);\n            })\n            .fail(function (jqxhr: IJcxhr, textStatus: string, error: string) {\n                Tasks.showError(\"Getting meta info of issue failed\", jqxhr, textStatus, error);\n            });\n\n        return <JQueryDeferred<IExternalItem>>res;\n    }\n\n    static fillTree(tree: IDB[], alltasks: IWltItemWithLinks[]): FolderItem[] {\n        return tree.reduce<FolderItem[]>((accumulator: FolderItem[], item: IDB): FolderItem[] => {\n            if (item.id.indexOf(\"_\") === 0) {\n                // Ingore these\n            } else if (item.id && item.id.indexOf(\"F-\") === 0) {\n                const children = Tasks.fillTree(item.children, alltasks);\n                if (children.length > 0) {\n                    accumulator.push({\n                        name: item.title,\n                        id: item.id,\n                        children: children,\n                    });\n                }\n            } else {\n                const issues = alltasks.filter((taskItem) => taskItem.matrixItem.matrixItem === item.id);\n                if (issues.length > 0) {\n                    if (issues.length !== 1) {\n                        console.error(\"Filter by ID returned more than 1 result. Check!!!\", item.id);\n                    }\n                    const issueItem = issues[0];\n                    accumulator.push(issueItem);\n                }\n            }\n            return accumulator;\n        }, []);\n    }\n\n    static isFolder(item: FolderItem): item is Folder {\n        return item.hasOwnProperty(\"name\");\n    }\n\n    static appendIssueItems(\n        parentElement: JQuery,\n        folderItems: FolderItem[],\n        selectedFolders: string[],\n        folderChangeCallback: (folder: Folder) => void,\n        folders: Folder[] = [],\n    ): void {\n        folderItems.forEach((item: FolderItem) => {\n            if (Tasks.isFolder(item)) {\n                Tasks.appendIssueItems(\n                    parentElement,\n                    item.children,\n                    selectedFolders,\n                    folderChangeCallback,\n                    folders.concat(item),\n                );\n            } else {\n                $.each(item.links, function (midx, task) {\n                    const tr = $(\"<tr class='taskDisplayContainer'>\");\n                    const folderColumn = $(\"<td>\");\n                    const previousFolders: Folder[] = [];\n                    folders.forEach((folder) => {\n                        if (previousFolders.length !== 0) {\n                            folderColumn.append($(\"<span>/</span>\"));\n                        }\n                        previousFolders.push(folder);\n                        const folderLink = $(\n                            \"<span style='cursor: pointer; color: var(--BlueLink);font-weight: 700;font-size: 14px;'>\",\n                        )\n                            .text(folder.name)\n                            .click((ev) => {\n                                // console.log(\"Click on folder\", previousFolders.join(\"/\"));\n                                folderChangeCallback(folder);\n                            });\n                        folderColumn.append(folderLink);\n                    });\n                    const matrix = $(\"<td>\").append(\n                        ml.Item.renderLink(item.matrixItem.matrixItem, item.matrixItem.title),\n                    );\n                    const link = $(\"<td>\").append(Tasks.renderTask(item.matrixItem.matrixItem, task, true, false));\n                    const thisFolderPath = previousFolders.map((f) => f.id).join(\"/\");\n                    if (Tasks.thisFolderPathIsInSelection(thisFolderPath, selectedFolders)) {\n                        parentElement.append(tr.append(folderColumn).append(matrix).append(link));\n                    }\n                });\n            }\n        });\n    }\n\n    private static renderTasksInTable(\n        alltasks: IWltItemWithLinks[],\n        selectedFolders: string[],\n        folderChangeCallback: (folder: Folder) => void,\n    ): JQuery {\n        const tableContainer = $(\n            \"<div id='tablecontainer' style='height: 100%; overflow: hidden; padding-bottom: 15px;'>\",\n        );\n        let table = $(\n            \"<table class='table'><thead><tr><th>Folder</th><th>Matrix Item</th><th>Task</th><th></th></tr></thead></table>\",\n        );\n        let items = $(\"<tbody>\");\n        table.append(items);\n\n        const expandedFolders = Tasks.expandFolders(app.getTree(), selectedFolders, []);\n        // console.log(\"Expanded Folders\", expandedFolders);\n\n        let folderItems: FolderItem[] = Tasks.fillTree(app.getTree(), alltasks);\n        // console.log(\"Item Tree:\", folderItems);\n\n        Tasks.appendIssueItems(items, folderItems, expandedFolders, folderChangeCallback);\n\n        let scroller = $(\"<div class='panel-body-v-scroll' style='height:100%'>\");\n        tableContainer.append(scroller.append(table));\n        table.tablesorter({\n            sortList: [\n                [0, 0],\n                [1, 0],\n                [2, 0],\n            ],\n        });\n        return tableContainer;\n    }\n\n    private static expandFolders(tree: IDB[], selectedFolders: string[], prefix: string[]): string[] {\n        const folders: string[] = [];\n        tree.forEach((treeitem) => {\n            if (treeitem.id.indexOf(\"F-\") === 0) {\n                const newPrefix = prefix.concat(treeitem.id);\n                if (selectedFolders.indexOf(treeitem.id) !== -1) {\n                    folders.push(newPrefix.join(\"/\"));\n                }\n                folders.push(...Tasks.expandFolders(treeitem.children, selectedFolders, newPrefix));\n            }\n        });\n        return folders;\n    }\n\n    private static thisFolderPathIsInSelection(thisFolderPath: string, selectedFolders: string[]): boolean {\n        if (selectedFolders.length === 0) {\n            return true;\n        }\n        const matchingFolders = selectedFolders.filter((folder) => thisFolderPath.indexOf(folder) === 0);\n        return matchingFolders.length > 0;\n    }\n}\n\nlet mTasks: Tasks;\n\nfunction InitializeTasks() {\n    mTasks = new Tasks();\n    globalThis.Tasks = mTasks;\n    // register the engine as plugin\n    plugins.register(mTasks);\n    mTasks.subscribe();\n}\n","import type { IContextPageConfigTab } from \"../../ProjectSettings\";\nimport { IContextInformation } from \"../matrixlib/MatrixLibInterfaces\";\n\nexport type { IContextFramePlugin };\nexport { ContextFrameManager };\nexport { InitializeTrainingManager };\n\ninterface IContextFramePlugin {\n    id:string // an identifier for panel\n    title:string // name for tab and admin ui\n    adminOption:string // help for admin ui\n    onUpdate: (ui:JQuery,config:IContextPageConfigTab, context:IContextInformation) => void // function to render page, if context == null, it is the initial drawing \n}\n\nclass ContextFrameManagerImpl {\n    private pages:IContextFramePlugin [] = [];\n\n    constructor() {\n\n    }\n\n    getPages() {\n        return this.pages;\n    }\n\n    // register a plugin providing  a context page\n    register(plugin:IContextFramePlugin) {\n        this.pages.push( plugin );\n    }\n\n    // check if a context page is supplied by plugin \n    implements(id:string):boolean {\n        return !!this.getPlugin(id);\n    }\n\n    renderTab(panel:JQuery, id:string, config:IContextPageConfigTab, context:IContextInformation) {\n        let p = this.getPlugin(id);\n        p.onUpdate(panel, config, context);\n    }\n\n    // return a context page plugin of a given type\n    private getPlugin(id:string):IContextFramePlugin {\n        for( var idx=0;idx<this.pages.length;idx++){\n            if (this.pages[idx].id == id) {\n                return this.pages[idx];\n            }\n        }\n        return null;\n    }\n\n\n   \n}\n\nvar ContextFrameManager: ContextFrameManagerImpl;\n\nfunction InitializeTrainingManager() {\n    ContextFrameManager = new ContextFrameManagerImpl();\n}\n","import { XRMergeAction, XRMergeItem } from \"../../RestResult\";\nimport { ILink } from \"../../globals\";\nimport { ml } from \"../matrixlib\";\n\nexport type {\n    IBranchInfo, IFieldMergeMapping, IMergeResults,\n    IMergeDetails, IMergeLookup, ILastMerges, ILastMerge, IMove, IMergeCommand,\n    IMergeCommandTarget, IImportMergeItem\n};\n\nexport {\n    EMergeChangeStatus, EItemChangeState,\n    EMergeActionChoice,\n    EMergeType, BranchingConstants, BranchingHelper\n};\n\nclass BranchingConstants {\n    static BRANCH_INFO_SETTING = \"branch_info_02\";\n}\n\n/**this is the information about a branch (including the merge history) */\ninterface IBranchInfo {\n    /** tag set in mainline and branch just after the creation of the branch */\n    branchTag: string,\n    /** UTC date / time when the branch was created */\n    branchDate: string,\n    /** if of the mainline project */\n    sourceProject: string,\n    /** mapping of fields between mainline and branch */\n    fieldMapping: IFieldMergeMapping[],\n    /** allows you to not merge some categories, if not set it defaults to [\"REPORT\", FOLDER\"] */\n    dontMerge?: string[]\n    /** these labels are set in new /updated items in mainline (if they exist in the given category) */\n    setLabels?: string[]\n    /** these labels are reset in new /updated items in mainline (if they exist in the given category) */\n    resetLabels?: string[]\n    /**  these labels are not copied in case they changed in the branch */\n    ignoreLabels?: string[]\n    /**  these labels are set (next to set labels) if there was a conflict and the user decided to mark the conflicts */\n    conflictLabels?: string[]\n    /** user ids of user who can merge branch back into main */\n    branchMasters?: string[]\n}\n\n// this indicated how items changed between the last sync point and now\nenum EMergeChangeStatus {\n    deleted = 0 // item was deleted since last merge/branching off\n    , created = 1 // item was created (or restored) since last merge/branching off\n    , changed = 2 // item was changed since last merge/branching off\n    , unchanged = 3 // item was not changed since last merge/branching off\n    , notExist = 4 // item did not and is not existing nor and at last merge/branching off\n\n}\n// mapping between fields ids of identical field - will be created during creation of branch \ninterface IFieldMergeMapping {\n    /** field id in mainline project */\n    mainline: number\n    /** field id of same field in branch project */\n    branch: number\n}\n\n// this is the result of one merge activity\ninterface IMergeResults {\n    // meta info\n    utcDate: string; // when the merge was performed\n    user: string; // by whom\n    comment: string; // optional comment\n    tag: string; // auto? created tag\n\n    // merge actions which related to two items are documented in here\n    results: IMergeDetails[];\n}\n\nenum EItemChangeState {\n    never = 0, // did not exist in past not now\n    notNow = 1, // existed in past but not now\n    now = 2 // exists now\n}\n// that's is the user decision on how to handle a situation\nenum EMergeActionChoice {\n    noActionNeeded = -1 // if there's no action needed\n    , undecided = 0 // if there's no default suggested action (this cannot be the final choice though!)\n    , ignore = 1 // don't merge a difference from the branch to the mainline\n    , add_restore = 2 // add an item from the branch to the mainline. there it might be a deleted (to be restored) or a new item (to be created with) with the same id\n    , replace = 3 // update the mainline item to match the branch\n    , delete = 4 // delete the mainline item to match the delete in the branch\n}\n\n\n// that is the result from a merge decision take by the user\ninterface IMergeDetails {\n    id: string, // id of the item or folder\n    mV: number,  // revision mainline after merge (or 0 if it was deleted)\n    bV: number,  // revision branch  after merge (or 0 if it was deleted)\n    a: EMergeActionChoice,\n    np: string // new parent id if an item was moved in the mainline, or \"\" otherwise\n    l: string[] // new links created \n    u: string // links removed\n}\n\n\n// lookup table to quickly get items by id\ninterface IMergeLookup { [key: string]: XRMergeItem }\n\n\n// this is a setting of the mainline, used to record timing of merge actions from multiple branches \n/*\n{\n  \"WHEELY_LABELS_BRANCH\":{\n    \"timeGetChanges\":3,\n    \"timeGetLinks\":1\n  }\n}\n*/\ninterface ILastMerges { [key: string]: ILastMerge }\ninterface ILastMerge { [key: string]: number }\ninterface IMove { id: string, parent: string }\n\ninterface IMergeCommand {\n    copy: string[], // items to copy, restore, or create in mainline to match the branch -> if a specific version needs to exist it should be REQ-5-v4 instead of REQ-5 (meaning that REQ-5 does not exist)\n    conflicted: string[], // subset from copy, to indicate that there was a conflict. This allows to set additional labels \n    delete: string[], // items to delete\n    add_links: ILink[], // links to add\n    remove_links: ILink[],  // links to remove\n    move: IMove[] // items to move\n    push?: number // if set to 1 it copes \n}\n\ninterface IMergeCommandTarget {\n    id: string,\n    m: number // mainline revision: 0 if in item in mainline is deleted or does not yet exist\n}\n\ninterface IImportMergeItem {\n    instance?: string, // in case it's in another instance\n    project?: string, // in case it's in another project\n    id: string,\n    revision: number,\n    description: string // explain what the item is\n}\n\nenum EMergeType {\n    undefined = 0\n    , merge = 1\n    , push = 2\n}\n\n// Helper functions used by UI that expose branching.\nclass BranchingHelper {\n    static addMergeDetail(ul: JQuery, detail: XRMergeAction, targetProject: string, isFromBranch: boolean) {\n        if (detail.error) {\n            if (detail.error.indexOf(\"doesn't exist\") != -1) {\n                $(\"<li>\").appendTo(ul).html(`Not updated (strict mode) request was: ${detail.request}`);\n            } else {\n                $(\"<li>\").appendTo(ul).html(`Error ${detail.action}: ${detail.error}`);\n            }\n            return;\n        }\n\n        let fromWhere = isFromBranch ? \"branch\" : \"mainline\";\n\n        try {\n            switch (detail.action) {\n                case \"created\":\n                    ul.append($(\"<li>\").html(`${detail.action} ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} based on ${fromWhere} revision ${ml.Item.parseRef(detail.branchItem).version}`));\n                    break;\n                case \"deleted\":\n                    ul.append($(\"<li>\").html(`${detail.action} ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} revision ${ml.Item.parseRef(detail.mainlineItem).version}`));\n                    break;\n                case \"moved\":\n                    ul.append($(\"<li>\").html(`${detail.action} ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} to ${BranchingHelper.renderItemLink(detail.mainlineFolder, targetProject)}`));\n                    break;\n                case \"merge_restore\":\n                    ul.append($(\"<li>\").html(`restored ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} revision ${ml.Item.parseRef(detail.mainlineItem).version} based on ${fromWhere} revision ${ml.Item.parseRef(detail.branchItem).version}`));\n                    break;\n                case \"merge_update\":\n                    ul.append($(\"<li>\").html(`updated ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} to revision ${ml.Item.parseRef(detail.mainlineItem).version} based on ${fromWhere} revision ${ml.Item.parseRef(detail.branchItem).version}`));\n                    break;\n                case \"link_added\":\n                    ul.append($(\"<li>\").html(`added link from ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} to  ${BranchingHelper.renderItemLink(ml.Item.parseRef(detail.mainlineItem2).id, targetProject)}`));\n                    break;\n                case \"link_removed\":\n                    ul.append($(\"<li>\").html(`removed link from ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} to  ${BranchingHelper.renderItemLink(ml.Item.parseRef(detail.mainlineItem2).id, targetProject)}`));\n                    break;\n                default:\n                    ul.append($(\"<li>\").html(`${detail.action} ${BranchingHelper.renderItemLink(detail.mainlineItem, targetProject)} revision ${ml.Item.parseRef(detail.mainlineItem).version} based on ${fromWhere} revision ${ml.Item.parseRef(detail.branchItem).version}`));\n                    break;\n            }\n        } catch (e) {\n            console.log(\"Merge/Push Error\");\n            console.log(detail);\n            $(\"<li>\").appendTo(ul).html(`Request ${detail.request ? detail.request : \"\"}`);\n        }\n    }\n\n    static renderItemLink(fullItem: string, otherProject?: string) {\n        // this item is in the project the user is looking at\n        if (!otherProject) return ml.Item.parseRef(fullItem).id;\n        // or in the other project\n        return \"#\" + otherProject + \"/\" + ml.Item.parseRef(fullItem).id + \"#\";\n    }\n}","import { ILinkInfo } from \"./MatrixReq\";\nimport { IStringStringArrayMap, globalMatrix } from \"./../../globals\";\nimport { INavigationBar } from \"../UI/Components/index\";\nimport { ITasksConfiguration } from \"./Tasks\";\nimport { IRiskParameter } from \"../UI/Controls/riskCtrl2\";\nimport { IFieldParameter, IDropDownConfig, IDHFConfig, IExtras, ILabelsConfig, IQMSConfig, qmsDefaultConfig, IPublishLegacy, IRiskConfig, ICategoryGroups, IACL, ACL_SETTING, ITraceConfig, IContextPageConfig, IMailConfig, ISearchConfig, ILabelLockConfig, ITestConfig, ISmartTextConfig, ICategorySetting, ITraceConfigRule, ICleanup, ITraceConfigDetails, ITestRuleAuto, ITestRuleManual, ITestConfigTablesColumn, smartTextConfigSetting, mailConfigSetting, IImportConfig, IDropdownOption } from \"../../ProjectSettings\";\nimport { XRFieldType, XRUserPermissionType, XRGetProject_ProjectInfo_ProjectInfo, XRGroupPermissionType, XRGetProject_ProjectSettingAll_GetSettingAck, XRSettingType, XRCategoryAndSettingListType, XRGetProject_CategoryList_GetProjectStructAck, XRCategoryExtendedType, XRPluginSetting, XRUserType } from \"../../RestResult\";\nimport { IJSONTools, ILoggerTools } from \"../matrixlib/MatrixLibInterfaces\";\nimport {FieldDescriptions} from \"./FieldDescriptions\";\n\nexport type {\n    ISettingMapString, ISettingMapStringArray, ISettingMapJSON, ICategoryConfig, ICategoryConfigMap,\n    XRFieldTypeAnnotated, XRFieldTypeAnnotatedParamJson, XRFieldTypeAnnotatedParamJsonLinkType,\n    IFieldsOfType, IDropDownInfo\n};\nexport {\n    ItemConfiguration\n};\n\ninterface ISettingMapString { [key: string]: string }\ninterface ISettingMapStringArray { [key: string]: string[] }\ninterface ISettingMapJSON { [key: string]: {} }\n\ninterface ICategoryConfig {\n    fieldList: XRFieldTypeAnnotated[],\n    label: string,\n    downLinksRequired: string[],\n    downLinksOptional: string[],\n    enable: string[]\n}\ninterface ICategoryConfigMap { [key: string]: ICategoryConfig }\n\ninterface XRFieldTypeAnnotated extends XRFieldType { parameterJson?: XRFieldTypeAnnotatedParamJson }\ninterface XRFieldTypeAnnotatedParamJson extends IFieldParameter { \n    linkTypes?:XRFieldTypeAnnotatedParamJsonLinkType[],\n}\n    \ninterface XRFieldTypeAnnotatedParamJsonLinkType { required: boolean, type: string }\ninterface IFieldsOfType { category: string, field: XRFieldTypeAnnotated }\n\ninterface IDropDownInfo {\n    id:string\n    label:string\n    value:IDropDownConfig\n}\n\nclass ItemConfiguration {\n    // TODO: it seems that we have category information in configuration and also in variable\n    // settings, with SLIGHTLY DIFFERENT FIELDS, WHAT THE HECK?\n    // (one has shortLabel, the other doesnt).\n    private configuration:ICategoryConfigMap = {};\n    private settings:XRGetProject_ProjectInfo_ProjectInfo;\n    private settingsString:ISettingMapString = {};\n    private settingsJSON:ISettingMapJSON = {};\n\n    private users: XRUserPermissionType[] = []; // server\n    private userList: XRUserPermissionType[] = []; // cleaned up\n    private userGroups: XRGroupPermissionType[] = []; \n\n    private timewarpDate:string;\n\n    private logger: ILoggerTools;\n    private json: IJSONTools;\n\n    constructor(logger: ILoggerTools, json: IJSONTools) {\n        this.logger = logger;\n        this.json = json;\n    }\n\n    public isConfigured(): boolean {\n        return this.getCategories() && this.getCategories().length>0;\n    }\n    \n    public addUsers(userPermission: XRUserPermissionType[], groupPermission: XRGroupPermissionType[]): void {\n        this.userGroups = groupPermission;\n        this.users = userPermission;\n        this.userList = [];\n        if (userPermission) {\n            for (var idx = 0; idx < this.users.length; idx++) {\n\n                var ignore = false;\n                if (this.users[idx].permission === 3) {\n                    // 3 is an admin without write write access\n                    ignore = true;\n                }\n                for (var ex = 0; !ignore && ex < this.userList.length; ex++) {\n                    if (this.userList[ex].login.toLowerCase() === this.users[idx].login.toLowerCase() || this.userList[ex].id === this.users[idx].id) {\n                        // somethings wrong here...\n                        this.logger.log(\"warning\", \"Ignoring duplicate user... login:\" + this.userList[ex].id + \" ID:\" + this.users[idx].login);\n                        ignore = true;\n                    }\n                }\n                if (!ignore) {\n                    this.userList.push({\n                        id: this.users[idx].id,\n                        login: this.users[idx].login.toLowerCase(),\n                        email: this.users[idx].email,\n                        permission: this.users[idx].permission,\n                        firstName:this.users[idx].firstName,\n                        lastName:this.users[idx].lastName\n                    });\n                }\n            }\n        }\n    }\n    \n    public getUserInfo(login: string): XRUserPermissionType {\n        let theUser:XRUserPermissionType = null;\n        \n        for (let user of this.getUserNames()) {\n            if (user.login.toLowerCase() === login.toLowerCase()) {\n                theUser = user;\n            }\n        }\n           \n        return theUser;\n    }\n\n    public getCombinedName(user: XRUserPermissionType | XRUserType) {\n        let name = (user.firstName ? user.firstName : \"\") + \" \" + (user.lastName ? user.lastName : \"\");\n        return user.login + (name == \" \" ? \"\" : (\" - \") + name);\n    }\n\n    public getFullName(login: string) {\n        let user = this.getUserInfo(login);\n        if (user === null) {\n            return login;\n        }\n        return this.getCombinedName(user);\n    }\n\n    public groupIdToName(groupId: number): string {\n        return `g_${groupId}_g`;\n    }\n\n    public hasGroupInfo(group: string): boolean {\n        return this.getUserGroups().findIndex((g) => { return this.groupIdToName(g.groupId) === group.toLowerCase() }) > -1;\n    }\n\n    // {login} may have been deleted or doesn't exist.\n    public hasUserInfo(login: string): boolean {\n        return this.getUserInfo(login) !== null;\n    }\n\n    public getUserIds(): string[] {\n        \n        return this.getUserNames().map( function(user) {return user.login});\n    }\n    \n    public getEmail(user: string): string {\n        let email = \"\";\n\n        for (let otherUser of this.getUserNames()) {\n            if (otherUser.login.toLowerCase() === user.toLowerCase()) {\n                email = otherUser.email;\n            }\n        }\n\n        return email;\n    }\n    \n    public activateTimewarp(date: string) {\n        this.timewarpDate = date;\n    }\n    public getTimeWarp() {\n        return this.timewarpDate;\n    }\n    public isAfterTimeWarp(date: string) {\n        return this.timewarpDate &&  new Date(date)  > new Date(this.timewarpDate) ;\n    }\n\n    public hasWriteAccess(user: string): boolean {\n        if (!user ||  this.timewarpDate ) {\n            return false;\n        }\n\n        let permission = this.getPermission(user);\n\n        // -1 super admin, 2 read write, 3 admin\n        return permission == -1 || permission == 2 || permission == 3;\n    }\n    \n    private getPermission(user: string): number {\n        let permission:number = -1; // (in case the user does not exists, it's a super admin)\n        // get permission directly for user\n        for (var idx = 0; idx < this.users.length; idx++) {\n            if (this.users[idx].login.toLowerCase() === user.toLowerCase()) {\n                permission = this.users[idx].permission;\n            }\n        }\n\n        // now go through all groups, maybe it's better\n        for (let ug of this.getUserGroups()) {\n            if (ug.membership.map(member => member.login.toLowerCase()).indexOf(user.toLowerCase()) != -1) {\n                // user is in this group, let's see if we can bump him up\n                if (ug.permission==3) permission=3;\n                if (ug.permission==2 && permission!=3) permission=2;\n                if (ug.permission==1 && permission<=0) permission=1;\n            }\n        }\n        return permission;\n    }\n\n    public getUserNames(sorted?: boolean): XRUserPermissionType[] {\n\n        let users = <XRUserPermissionType[]>this.json.clone(this.userList);\n        // add users from user groups if they are not directly in\n        for (let ug of this.getUserGroups()) {\n            for (let m of ug.membership) {\n                if (users.map(user => user.login).indexOf(m.login) == -1) {\n                    users.push({\n                        id:-1\n                        ,login: m.login\n                        ,email:m.email\n                        ,permission:-1\n                        ,firstName:m.firstName\n                        ,lastName:m.lastName\n                    });\n                }\n            }\n        }\n        if (sorted) {\n            users.sort( function( a,b) { if (a.login<b.login) return -1; else return 1;});\n        }\n        return users;\n    }\n\n    public getUserGroups(): XRGroupPermissionType[] {\n        return this.userGroups;\n    }\n\n    /**\n     * getValidUserOptions returns an array of option values that describe\n     * the users and groups available as values for a user field in the\n     * database (fields of type {@link FieldDescriptions.Field_user}).\n     * \n     * @param showUsers - pass true to include users\n     * @param showGroups - pass true to include groups \n     * @param preSelectedUsers - if present, the list of users will be limited\n     *     to this subset and the full user list will not be consulted to\n     *     construct the return value.\n     * @param possiblyDeletedUserGroupNames - if present, a comma-separated\n     *     list of user and group names. The returned options will include\n     *     these values, and mark deleted user and groups as disabled.\n     * @returns An array of {@link IDropdownOptions} configured according to\n     *     the input parameters and the users and groups of the current project.\n     */\n    getValidUserOptions(showUsers: boolean, showGroups: boolean,\n        preSelectedUsers?: XRUserPermissionType[], possiblyDeletedUserGroupNames?: string): IDropdownOption[] {\n\n        let that = this;\n        let options: IDropdownOption[] = [];\n        let users: XRUserPermissionType[] = preSelectedUsers\n            ? preSelectedUsers\n            : this.getUserNames();\n        let groups = this.getUserGroups().sort((a, b) => {\n            return a.groupName < b.groupName ? -1 : 1;\n        });\n\n        // if {possiblyDeletedUsernames} are not found in {users}, we want to add them.\n        const isGroup = /g_([0-9])+_g/;\n        let names = possiblyDeletedUserGroupNames ? possiblyDeletedUserGroupNames.split(',') : [];\n        names.forEach(name => {\n            if (!this.hasUserInfo(name)) {\n                if (!isGroup.test(name)) {\n                    users.push(<any>{\n                        id: 0,\n                        login: name,\n                        email: \"unknown\",\n                        permission: 0,\n                        firstName: \"\",\n                        lastName: \"\",\n                        deleted: true\n                    });\n                } else if (!this.hasGroupInfo(name)) {\n                    // We know match found a group because isGroup.test(name) returned true.\n                    const groupId = parseInt(name.match(isGroup)[1]);\n                    groups.push(<any>{\n                        groupName: name,\n                        permission: 0,\n                        groupId: groupId,\n                        membership: [],\n                        deleted: true\n                    });\n                }\n            }\n        });\n\n        if (showUsers) {\n            // sort users alphabetically\n            users = users.sort((a, b) => {\n                return a.login < b.login ? -1 : 1;\n            });\n\n            // add to user select\n            users.forEach((user) => {\n                // Deleted users have strikethrough text, and are disabled from selection.\n                // We only display their login, not their full name.\n                const deletedUser = (<any>user).deleted === true;\n                const labelText = deletedUser ? user.login : this.getCombinedName(user);\n                options.push({\n                    id: user.login, label: labelText, class: \"users\",\n                    disabled: deletedUser,\n                    strikethrough: deletedUser\n                });\n            });\n        }\n        if (showGroups) {\n            groups.forEach((group) => {\n                const deletedGroup = (<any>group).deleted === true;\n                let groupName = group.groupName;\n                let groupId = deletedGroup ? groupName : that.groupIdToName(group.groupId);\n                options.push({\n                    id: groupId, label: groupName, class: \"groups\",\n                    disabled: deletedGroup,\n                    strikethrough: deletedGroup\n                });\n            });\n        }\n        return options;\n    }\n\n\n    // TODO(modules): This is a performance hack. Better if private.\n    public addGroupMember(gid: number, user: string) {\n        let gs = this.userGroups.filter( g => g.groupId == gid && g.membership.map(u=>u.login).indexOf(user)==-1);\n        if (gs.length) {\n            gs[0].membership.push( <any>{ login:user } );\n        }\n    }\n    // TODO(modules): This is a performance hack. Better if private.\n    public removeGroupMember(gid: number, user: string) {\n        let gs = this.userGroups.filter( g => g.groupId == gid && g.membership.map(u=>u.login).indexOf(user)!=-1);\n        if (gs.length) {\n            gs[0].membership = gs[0].membership.filter( m => m.login != user );\n        }\n    }\n\n    // TODO(modules): This is a performance hack. Better if private.\n    public addSettings(s: XRGetProject_ProjectInfo_ProjectInfo | XRGetProject_ProjectSettingAll_GetSettingAck): void {\n        let that = this;\n        \n        this.settings = <XRGetProject_ProjectInfo_ProjectInfo>s;\n        this.settingsString = {};\n        this.settingsJSON = {};\n        if (s.settingList) {\n            for (let setting of s.settingList) {\n                that.settingsString[setting.key] = setting.value;\n                if (setting.value && setting.value.indexOf('{') !== -1 && setting.value.indexOf('<') !== 0) {\n                    // assume it a json\n                    var val = this.json.fromString(setting.value);\n                    if (val.status === \"ok\") {\n                        that.settingsJSON[setting.key] = val.value;\n                    }\n                }\n            }\n        }\n    }\n    public getSettings(): XRSettingType[] {\n        return this.settings.settingList;\n    }\n    public getSetting(s: string): string {\n        return this.settingsString[s];\n    }\n\n    public getSettingJSON(s: string, def?: {}): {} {\n        return this.settingsJSON[s]?this.settingsJSON[s]:def;\n    }\n    public getDropDowns(dropdownId?: string): IDropDownInfo[] {\n\n        let that = this;\n        let dropdowns:IDropDownInfo[] = [];\n\n        for (let key of Object.keys(this.settingsJSON)) {\n            let setting = <IDropDownConfig> that.settingsJSON[key];\n            if (setting.options && (!dropdownId || dropdownId == key)  ) {\n                dropdowns.push({\n                    id:key,\n                    label:key,\n                    value:setting\n                });\n            }\n        }\n    \n        return dropdowns;\n    }\n\n    public getTasksConfig() {\n        return <ITasksConfiguration>this.getSettingJSON(\"task_config\");\n    }\n    \n    public getDHFConfig() {\n        return <IDHFConfig>this.getSettingJSON(\"dhf_config\");\n    }\n    \n    public getExtrasConfig() {\n        let extras = this.getSettingJSON(\"extras\");\n        return <IExtras>(extras?extras:{});\n    }\n    public getLabelsConfig() {\n        return <ILabelsConfig>this.getSettingJSON(\"labels\");\n    }\n    getIncludeConfig() {\n        let conf = this.getSettingJSON(\"compose\");\n        return <IImportConfig>(conf?conf:{\n            copies:{\n                importMasters:[],\n                lockLabel:\"\"\n            }, includes: {\n                importMasters:[],\n                lockLabel:\"\"\n            }\n        });\n    }\n    public getQMSConfig() {\n        // get qms config (as project setting, handle 2.1 and earlier setting in category setting)\n        let setting = <IQMSConfig>this.getSettingJSON(\"qms_config\");\n        if (!setting) {\n            setting=qmsDefaultConfig; // as in 2.1 and earlier\n        }\n        for (let p of setting.publications) {\n            if (p.publisher==\"_\") {\n                let legacy = <IPublishLegacy>this.getCategorySetting(p.toCategory, \"publish\");\n                p.publisher = legacy ? legacy.publisher : \"\";\n            }\n        }\n\n        return setting;\n    }\n  \n    public getRiskConfig() {\n        return <IRiskConfig>this.getSettingJSON(\"risk_config\");\n    }\n    public getCategoryGroupConfig() {\n        return <ICategoryGroups>this.getSettingJSON(\"category_groups\");\n    }\n    public getACLConfig() {\n        return <IACL>this.getSettingJSON(ACL_SETTING);\n    }\n    public getTraceConfig() {\n        return <ITraceConfig>this.getSettingJSON(\"trace_config\");\n    }\n\n    public getNavigationBarConfig() {\n        return <INavigationBar>this.getSettingJSON(\"nav_config\");\n    }\n\n    public getContextPagesConfig() {\n        return <IContextPageConfig>this.getSettingJSON(\"project_help\");\n    }\n    public getMailConfig(): IMailConfig {\n        return <IMailConfig>this.getSettingJSON(mailConfigSetting);\n    }\n    public getSearchConfig() {\n        return <ISearchConfig>this.getSettingJSON(\"search_config\");\n    }\n    public getLabelLockConfig() {\n        return <ILabelLockConfig>this.getSettingJSON(\"lockingLabels\");\n    }\n    public getTestConfig() {\n        return <ITestConfig>this.getSettingJSON(\"xtc_config\");\n    }\n    \n    public setSettingJSON(key: string, valueJSON: {}): void {\n        this.settingsString[key] = JSON.stringify(valueJSON);\n        this.settingsJSON[key] = valueJSON;\n    }\n    public getSmartText() {\n        return <ISmartTextConfig>this.getSettingJSON(smartTextConfigSetting);\n    }\n   \n    public addCategorySetting(categorySetting: XRCategoryAndSettingListType): void {\n        if (!this.settings || !this.settings.categorySettingList) {\n            return;\n        }\n        this.settings.categorySettingList.push(categorySetting);\n    }\n\n    public getCategorySettings(category: string): XRSettingType[] {\n        if (!this.settings || !this.settings.categorySettingList) {\n            return [];\n        }\n        for (var idx = 0; idx < this.settings.categorySettingList.length; idx++) {\n            if (this.settings.categorySettingList[idx].categoryShort === category && this.settings.categorySettingList[idx].settingList) {\n                return this.settings.categorySettingList[idx].settingList;\n            }\n        }\n        return [];\n    }\n    \n    // return the setting for a plugin or null if plugin or setting does not exist\n    // TODO(modules): is this ever called?\n    public getPluginSetting(pluginId: number, setting: string): string {\n        /*\n         * pluginSettingsList: [\n            {\n                pluginId: 101,\n                settings: [ {\n                    setting: \"serverType\",\n                    value: \"medical\",\n                    encrypted: false\n                }, {\n                setting: \"baseUrl\",\n                    value: \"https://matrixtest.atlassian.net\",\n                    encrypted: false\n                } ]\n            }\n        ]\n         */\n        if (!this.settings || !this.settings.pluginSettingsList) {\n            return null;\n        }\n        \n        for ( var idx=0; idx < this.settings.pluginSettingsList.length; idx++) {\n            var ps = this.settings.pluginSettingsList[idx];                \n            if ( ps.pluginId == pluginId ) {\n                for ( var jdx=0; jdx < ps.settings.length; jdx++) {\n                    if ( ps.settings[jdx].setting === setting ) {\n                        return ps.settings[jdx].value;\n                    }\n                }\n            }\n        }\n        return null;\n    }\n    \n    public getPluginSettings(): XRPluginSetting[] {\n        return this.settings.pluginSettingsList;\n    }\n    // return tuples {category, field} of all categories which use a type\n    // used for tisk traceability in DHF\n    public getFieldsOfType(fieldType: string, categoryType?: string): IFieldsOfType[] {\n        var hits:IFieldsOfType[] = [];\n        if (!this.settings) {\n            return hits;\n        }\n        for (var idx = 0; idx < this.settings.categorySettingList.length; idx++) {\n\n            var category = this.settings.categorySettingList[idx].categoryShort;\n            if (!categoryType || categoryType === category) {\n                var cc = this.getItemConfiguration(category);\n                if (cc) {\n                    var fields = cc.fieldList;\n                    for (var fdx = 0; fdx < fields.length; fdx++) {\n                        if (fields[fdx].fieldType === fieldType) {\n\n                            //    var jconfig = this.json.fromString(fields[fdx].parameter);\n                            hits.push({category: category, field: fields[fdx]});\n                        }\n                    }\n                }\n            }\n        }\n        return hits;\n    }\n\n    public getCategorySetting(category: string, setting: string): ICategorySetting {\n        var catSettings = this.getCategorySettings(category);\n        for (var idx = 0; idx < catSettings.length; idx++) {\n            if (catSettings[idx].key === setting) {\n\n                var jconfig = this.json.fromString(catSettings[idx].value);\n\n                if (jconfig.status === 'ok') {\n                    // apparently parsing went well\n                } else if (jconfig.status === 'error') {\n                    this.logger.log(\"error\", \"The category setting '\" + catSettings[idx].key + \"' has an invalid value. Ignoring it.\");\n                } else {\n                    this.logger.log(\"warning\", \"The category setting '\" + catSettings[idx].key + \"' is empty.\");\n                }\n                return jconfig.value;\n            }\n        }\n        return null;\n    }\n    \n    public getCategories(noFolders?: boolean): string[] {\n        let catgories = Object.keys(this.configuration);\n        if ( noFolders ) {\n            catgories.splice(catgories.indexOf(\"FOLDER\"), 1);\n        }\n        return catgories;\n    }\n    \n    public getCategoryLabel(category: string): string {\n        if (this.configuration[category]) {\n            return this.configuration[category].label;\n        }\n        return \"\";\n    }\n\n    public getCategoryId(category: string): string {\n        let cd = this.settings.categoryList.categoryExtended.filter(function(cat) {return cat.category.shortLabel==category;});\n        if (cd.length==1) {\n            return \"\"+cd[0].category.id;\n        }\n\n        return \"\";\n    }\n    \n    \n    // links for 1.5 and earlier (configured as category setting)\n    public getDownLinkTypes(category: string, required: boolean) {\n\n        if (required) {\n            return this.configuration[category].downLinksRequired;\n        }\n        return this.configuration[category].downLinksOptional;\n    }\n    \n    // links for 1.5 and earlier (configured as category setting)\n    public getUpLinkTypes(category: string, required: boolean) {\n\n        var up: string[] = [];\n        for (var key in this.configuration) {\n            if (key && key != category && this.configuration[key]) {\n                if (required && this.configuration[key].downLinksRequired.indexOf(category) != -1) {\n                    up.push(key);\n                }\n                if (!required && this.configuration[key].downLinksOptional.indexOf(category) != -1) {\n                    up.push(key);\n                }\n            }\n        }\n        return up;\n    }\n    \n    public addCategories(config: XRGetProject_ProjectInfo_ProjectInfo | XRGetProject_CategoryList_GetProjectStructAck) {\n        for (var idx = 0; config.categoryList.categoryExtended != undefined && idx < config.categoryList.categoryExtended.length; idx++) {\n            this.addCategory(config.categoryList.categoryExtended[idx]);\n        }\n    }\n\n    public init(config: XRGetProject_ProjectInfo_ProjectInfo) {\n        this.addCategories( config );\n        this.addSettings(config);\n        this.addUsers(config.userPermission, config.groupPermission);\n    }\n\n    public canEdit(category: string) {\n        return this.canDo(category, \"edit\");\n    }\n    public canEditTitle(category: string) {\n        return this.canDo(category, \"rename\");\n    }\n    public canMove(category: string) {\n        return this.canDo(category, \"move\");\n    }\n    public canCreate(category: string) {\n        return this.canDo(category, \"create\");\n    }\n    public canDelete(category: string) {\n        return this.canDo(category, \"delete\");\n    }\n    public canModifyLabels(category: string) {\n        return this.canDo(category, \"label\");\n    }\n    public canSign(category: string) {\n        return this.canDo(category, \"sign\");\n    }\n    public canReport(category: string) {\n        return this.canDo(category, \"report\");\n    }\n\n    private canDo(category:string, task:string) {\n        if (!this.configuration[category]) return false;\n        if (!this.configuration[category].enable) return true; // no limitation specified for this user\n        if (this.configuration[category].enable.indexOf(task)!=-1) return true; \n        \n        return false;\n    }\n\n    private addCategory(config: XRCategoryExtendedType):void {\n        this.configuration[config.category.shortLabel] = {\n            fieldList: [],\n            label: config.category.label,\n            downLinksRequired: [],\n            downLinksOptional: [],\n            enable:config.enable\n        };\n\n        var fieldList = <XRFieldTypeAnnotated[]> config.fieldList.field;\n        if (!fieldList) {\n            fieldList = [];\n        }\n\n        for (var idx = 0; idx < fieldList.length; idx++) {\n            var jconfig = this.json.fromString(fieldList[idx].parameter);\n\n            if (jconfig.status === 'ok') {\n                // apparently parsing went well\n            } else if (jconfig.status === 'error') {\n                this.logger.log(\"error\", \"The field with id '\" + fieldList[idx].id + \"' has an invalid value. Ignoring it.\");\n            } else {\n                // quite normal\n            }\n\n            fieldList[idx].parameterJson = <XRFieldTypeAnnotatedParamJson>jconfig.value;\n\n            this.configuration[config.category.shortLabel].fieldList.push(fieldList[idx]);\n            if (fieldList[idx].fieldType === FieldDescriptions.Field_links) {\n                if (fieldList[idx].parameterJson && fieldList[idx].parameterJson.linkTypes) {\n                    for (var l = 0; l < fieldList[idx].parameterJson.linkTypes.length; l++) {\n                        var dl = fieldList[idx].parameterJson.linkTypes[l];\n\n                        if (this.json.isTrue(dl.required)) {\n                            this.configuration[config.category.shortLabel].downLinksRequired.push(dl.type);\n                        } else {\n                            this.configuration[config.category.shortLabel].downLinksOptional.push(dl.type);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    public getItemConfiguration(category: string): ICategoryConfig {\n        return this.configuration[category];\n    }\n    \n    public getFieldId(category: string, fieldLabel: string): number {\n        var cc = this.getItemConfiguration(category);\n        if (!cc) {\n            return 0;\n        }\n        var fields = cc.fieldList;\n        for (var idx = 0; idx < fields.length; idx++) {\n            if (fields[idx].label.toLowerCase() === fieldLabel.toLowerCase()) {\n                return fields[idx].id;\n            }\n        }\n        return 0;\n    }\n    \n    public getFields(category: string) {\n        var cc = this.getItemConfiguration(category);\n        if (!cc) {\n            return null;\n        }\n        return cc.fieldList;\n    }\n\n    public getFieldByName(category: string, name: string): XRFieldTypeAnnotated {\n        let fields = this.getFields(category).filter(function (field) { return field.label && field.label.toLowerCase() == name.toLowerCase(); })\n        if (fields.length == 1)\n            return fields[0];\n        return undefined;\n    }\n\n    public getFieldById(category: string, fieldId: number) {\n        var cc = this.getItemConfiguration(category);\n        if (!cc) {\n            return null;\n        }\n        let fields =  cc.fieldList.filter( function(field) {return field.id==fieldId;});\n        return fields.length?fields[0]:null;\n    }\n\n    public getFieldConfig(fieldId: number): XRFieldTypeAnnotatedParamJson {\n        // The fieldId is unique across categories, therefore this code works properly.\n        for ( let category of this.getCategories() ) {\n            let field = this.getFieldById(category, fieldId );\n            if (field) {\n                return field.parameterJson;\n            }\n        }\n        return null;\n    }\n\n    public getFieldName(fieldId: number) {\n        for ( let category of this.getCategories() ) {\n            let field = this.getFieldById(category, fieldId );\n            if (field) {\n                return field.label;\n            }\n        }\n        return \"\";\n    }\n\n    public getFieldType(category: string, fieldId: number): string {\n        var cc = this.getItemConfiguration(category);\n        if (!cc) {\n            return null;\n        }\n        var fields = cc.fieldList;\n        for (var idx = 0; idx < fields.length; idx++) {\n            // note this is ==: sometimes it is an int sometimes a string \n            if (fields[idx].id == fieldId) {\n                return fields[idx].fieldType;\n            }\n        }\n        return null;\n    }\n    \n    // gets required or optional up or downlink categories for a given category\n    // it uses the project setting for the trace configuration if existing,\n    // the category setting (1.5 and earlier) otherwise\n    public getLinkTypes(category: string, down: boolean, required: boolean): string[] {\n\n        var tc = <ITraceConfig>this.getTraceConfig();\n        if (!tc) {\n            // use 1.5 and before rules\n            if (down) {\n                return this.getDownLinkTypes(category, required);\n            } else {\n                return this.getUpLinkTypes(category, required);\n            }\n        }\n\n        // get the up/down rule from project setting\n        var updown:ITraceConfigRule[];\n        for (let rule of tc.rules) {\n            if (rule.category === category) {\n                updown = down ? rule.down_rules : rule.up_rules;\n            }\n        }\n\n        if (!updown) {\n            // no rules.. \n            return [];\n        }\n        var result:string[] = [];\n\n        // rules exist get all required or option links\n        for (let updownRule of updown) {\n            if (updownRule.rule === \"must_have\" && updownRule.any_of && required) {\n                for (let any of updownRule.any_of) {\n                    // add to must have\n                    if (result.indexOf(any) === -1) {\n                        result.push(any);\n                    }\n                }\n            } else if (updownRule.rule === \"can_have\" && updownRule.any_of && !required) {\n                for (let any of updownRule.any_of) {\n                    // add to can have\n                    if (result.indexOf(any) === -1) {\n                        result.push(any);\n                    }\n                }\n            }\n        }\n\n        return result;\n    }\n    \n    \n    // gets required or optional up or downlink categories for a given category\n    // including reason why they should / could exist\n    // it uses the project setting for the trace configuration if existing,\n    // the category setting (1.5 and earlier) otherwise\n    public getLinkInfo(category: string, down: boolean, required: boolean, groupByRule: boolean): ILinkInfo[] {\n\n        var tc = <ITraceConfig>this.getTraceConfig();\n        if (!tc) {\n            var links:string[] = [];\n            // use 1.5 and before rules\n            if (down) {\n                links = this.getDownLinkTypes(category, required);\n            } else {\n                links = this.getUpLinkTypes(category, required);\n            }\n            var result:ILinkInfo[] = [];\n            for (var idx = 0; idx < links.length; idx++) {\n                result.push({category: links[idx], reason: (required ? \"required\" : \"optional\")});\n            }\n            return result;\n        }\n\n        // get the up/down rule from project setting\n        var updown: ITraceConfigRule[];\n        for (let rule of tc.rules) {\n            if (rule.category === category) {\n                updown = down ? rule.down_rules : rule.up_rules;\n            }\n        }\n\n        if (!updown) {\n            // no rules.. \n            return [];\n        }\n        var linkInfo:ILinkInfo[] = [];\n\n        // rules exist get all required or optional links\n        for (let updownRule of updown) {\n            if (updownRule.rule === \"must_have\" && updownRule.any_of && required) {\n                if ( groupByRule ) {\n                    linkInfo.push({category: updownRule.any_of, reason: updownRule.name});\n                } else {\n                    for (let anys of updownRule.any_of) {\n                        // add to must have\n                        linkInfo.push({category: anys, reason: updownRule.name});\n                    }\n                }\n            } else if (updownRule.rule === \"can_have\" && updownRule.any_of && !required) {\n                if ( groupByRule ) {\n                    linkInfo.push({category: updownRule.any_of, reason: updownRule.name});\n                } else {\n                    for (let anys of updownRule.any_of) {\n                        // add to can have\n                        linkInfo.push({ category: anys, reason: updownRule.name });\n                    }\n                }\n            }\n        }\n\n        return linkInfo;\n    }\n\n    public getMitigations(): IStringStringArrayMap {\n\n        let risk_config = <IRiskConfig>this.getRiskConfig();\n\n        // get the mitigations from the project setting\n        let global:string[] = [];\n        if ( risk_config && risk_config.mitigationTypes) {\n            global = risk_config.mitigationTypes.map( function( mt ) { return mt.type;});\n        }\n        // for each field, check if there's a field setting, if not use the global setting\n        let mitCats:IStringStringArrayMap = {};\n        for (let riskFieldInfo of this.getFieldsOfType(\"risk2\")) {\n            mitCats[riskFieldInfo.category] = [];\n            let fieldConfig = <IRiskParameter>riskFieldInfo.field.parameterJson;\n            if (fieldConfig && fieldConfig.riskConfig) {\n                mitCats[riskFieldInfo.category] =\n                    fieldConfig.riskConfig.mitigationTypes.map(mt => mt.type);\n            } else {\n                mitCats[riskFieldInfo.category] = global;\n            }\n        }\n        \n        return mitCats;\n    }\n\n\n    /** return cleanup rules, if there's a project setting that wins, if there's no rules or it's disabled it returns -1 */\n    public getCleanupRules(): ICleanup {\n        return <ICleanup>this.getSettingJSON(\"htmlCleanup\");\n    }\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { RestDB, IRestoreItemResult, ISearchResult, IUpdateCache } from \"./RestDB\";\nimport { ItemConfiguration } from \"./ItemConfiguration\";\nimport { DBCache, IDB, IDBParent } from \"./DBCache\";\nimport { IStringMap, IItemPut, IReferenceChange, IItemGet, IItem, globalMatrix, app, matrixApplicationUI, matrixSession, setIC, IRestResult } from \"./../../globals\";\nimport { LabelTools } from \"./../matrixlib/index\";\nimport { XCPostCompareHtml, XCGetProjectAudit } from \"./../../RestCalls\";\nimport { IItemWatched } from \"./PushMessages\";\nimport { IFileParam, IFileUploadProgress } from \"./RestConnector\";\nimport { ILinkCollectionOptions, ILinkCategories } from \"../UI/Controls/linkCollection\";\nimport { ml } from \"./../matrixlib\";\nimport { NavigationPanel } from \"../UI/MainTree/MainTree\";\nimport { ISearchConfig, ITraceConfigRule } from \"../../ProjectSettings\";\nimport {\n    XRCrossProjectLink,\n    XRTag,\n    XRTrimNeedleItem,\n    XRTrimAudit,\n    XRCategoryExtendedType,\n    XRGetProject_AllJob_JobsWithUrl,\n    XRGetProject_JobStatus_JobsStatusWithUrl,\n    XRGetProject_Reports_GetReportsAck,\n    XRGetProject_ProjectAudit_TrimAuditList,\n    XRPostProject_AddFile_AddFileAck,\n    XRPostProject_LaunchReport_CreateReportJobAck,\n    XRPostProject_SignItem_SignItemAck,\n    XRPostProject_CompareHtml_HtmlCompareResult,\n    XRProjectInfo\n} from \"../../RestResult\";\nimport { plugins } from \"./PluginManager\";\nimport { mDHF } from \"./PluginManagerDocuments\";\nimport { UIToolsConstants, IReportOptions, IApp } from \"../matrixlib/MatrixLibInterfaces\";\nimport { mTasks } from \"./Tasks\";\nimport { NavBar } from \"../UI/Components\";\nimport { EImportMode } from \"../../common/businesslogic/ComponentImport\"\nimport { LabelSwitches } from \"../UI/Parts/LabelSwitches\";\nimport { NotificationsBL } from \"./NotificationsBL\";\n\nexport type { ITraceRules, ILinkInfo, IVersionDetails, XRTrimNeedleItemJob, ILogoConfig, IReferenceUpdate, ISimpleTree, ISetField };\nexport { MatrixReq };\n\ninterface ITraceRules {\n    valid: boolean, // in case any must_have rule is not followed this is false\n    mustHaveCategories: string[], // all categories which are in a must have rule\n    canHaveCategories: string[], // all categories which are in a can have rule\n    exstingCategories: string[], // all categories which are currently linked to item\n    missingMustHaveCategories: string[], // all categories which must be linked but are not\n    missingCanHaveCategories: string[], // all categories which can be linked but are not\n    outdatedReferences: string[]\n}\n\ninterface ILinkInfo { category: string | string[], reason: string }\ninterface IVersionDetails {\n    action: string, id: string, title: string, user: string, date: string, dateUserFormat: string, job?: number, reason?: string,\n    comment: string, version: number, fullVersion: string, auditId: number, tags: XRTag[]}interface INewItem {  parent: string, position:number, item:IItem }\n\ninterface XRTrimNeedleItemJob extends XRTrimNeedleItem { job?: number }\n// logo setting\ninterface ILogoConfig {\n    fileId?:string,\n    logoId?:string\n }\n\ninterface IReferenceUpdate {\n    added:boolean,\n    fromId:string,\n    toId:string,\n    date:string,\n    dateUserFormat: string,\n    comment:string,\n    user:string\n}\n\ninterface ISimpleTree {\n    itemId:string,\n    title:string,\n    children?:ISimpleTree[]\n}\n\ninterface ISetField {\n    fieldName:string\n    value:string\n}\n\n\n\nclass MatrixReq implements IApp {\n\n    private dbConnection:RestDB;\n    private _itemId = \"\"; //currently selected item id. this should come from URL\n    public _needsSave = false; // the current status of the rendered item\n    private forceUIRefreshTimer:number;\n    private lastState = \"\";\n    private freezeDuringSave:boolean; // set to true when saving while navigating the tree\n\n    mainApp = true;\n\n    public itemForm = $(\"#itemDetails\");\n    printForm = $(\"#appPrint\");\n    dlgForm = $(\"#appPopup\");\n\n    public mainTreeLoaded = false;\n\n\n    constructor(dataSource:RestDB) {\n        this.dbConnection = dataSource\n    }\n    // allow to overwrite cache (for JIRA cloud plugin)\n    setCache( externalCache:DBCache ):void {\n        this.dbConnection.setCache(externalCache);\n    }\n\n\n    // store the project of this session\n    loadProject(project:string, item:string): Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n\n\n\n        let that = this;\n\n        if (item && item == \"null\") {\n            item = null;\n        }\n\n        // reset to avoid ping to non existing item\n        this._itemId = \"\";\n\n        setIC(new ItemConfiguration(ml.Logger, ml.JSON));\n\n        // make the database to load the project\n\n        matrixApplicationUI.destroyOldControls();\n        NavigationPanel.destroy();\n\n        // this will show the tree and select the item\n        // if the user logs in / is logged in\n       this.loadTreeAndItem(project, item).done(function ( result: { item:IItem, tree:IDB[], project:XRProjectInfo } ) {\n           let itemToShow = result?.item;\n            // show a logo if there is any\n           let logo = globalMatrix.matrixBaseUrl + \"/static/img/\" + globalMatrix.matrixProduct + \".png\";\n           let logoSetting: string = globalMatrix.ItemConfig.getSetting(\"projectLogo\");\n            if (logoSetting ) {\n                if (logoSetting.indexOf(\"{\") !== -1) {\n\n                    var rjs = ml.JSON.fromString(logoSetting);\n                    if (rjs.status === 'ok') {\n                        if ((<ILogoConfig>rjs.value).fileId) {\n                            logo = globalMatrix.matrixRestUrl + \"/\" + project + \"/file/\" + ((<ILogoConfig>rjs.value).fileId);\n                        }\n                    }\n                } else { // legacy\n                    logo = logoSetting;\n                }\n            }\n\n           NotificationsBL.NoticationCache.setNotifications(result.project.todos.filter(function (todo) { return todo.login == matrixSession.getUser(); }));\n\n\n           $(\".brandLogo\").attr(\"src\",logo);\n            that.updateFavicon( project, false);\n\n            // render the item and the reduced tree\n            that.showTree(item, itemToShow);\n\n            // find a place to add a progress\n            let loadTreeProgress = $(\"<div id='treeLoadWait'>\").append($(\"<div>\").append(ml.UI.getSpinningWait(\" \")));\n            $(\"#projectTree .listContent\").after(loadTreeProgress);\n\n            // render the full tree and color some items by executing searches\n            window.setTimeout( () => {\n                that.loadTreeWithSearches(item).always( () => {\n                    // configure highlighting of links in rich text boxes\n                    var cats = globalMatrix.ItemConfig.getCategories();\n                    for (var idx = 0; idx < cats.length; idx++) {\n                        addHighlightLink(cats[idx], globalMatrix.matrixBaseUrl + \"/\" + project + \"/\");\n                    }\n                    matrixApplicationUI.refreshLinks();\n                    loadTreeProgress.remove();\n                    resolve();\n                });\n            }, 1);\n\n        }).fail( function() {\n           ml.UI.hideSuccess();\n        });\n        });\n    }\n\n    loadTree(project:string):JQueryDeferred<{}>  {\n        this.dbConnection.setProject(project);\n        return this.dbConnection.retrieveTreeAsync();\n    }\n\n    // load item and the tree for the item\n    loadTreeAndItem(project:string, item:string):JQueryDeferred<IItem>  {\n        this.dbConnection.setProject(project);\n        return this.dbConnection.retrieveTreeAndItem(item);\n    }\n\n    updateFavicon(project: string, notification: boolean): void{\n        // get the base icon (default or from project setting)\n\n        let iconPath = globalMatrix.matrixBaseUrl + \"/favicon_medical.ico\";\n        let logoSetting: string = globalMatrix.ItemConfig.getSetting(\"projectLogo\");\n\n        let customPath = MatrixReq.getProjectIcon(logoSetting);\n\n        if (customPath) {\n            iconPath = globalMatrix.matrixRestUrl + \"/\" + project + \"/file/\" + customPath;\n        }\n        let iconNode = $(\"link[rel*='icon']\");\n\n        iconNode.attr(\"href\", iconPath);\n\n        // if there's neither a notification or a custom path I am done\n        if (!notification &&  customPath) {\n            return;\n        }\n\n        let canvas = document.createElement('canvas');\n        if (canvas.getContext) {\n\n            let img = document.createElement('img');\n\n            img.onload = function () { // once the image has loaded\n\n                canvas.height = img.height;\n                canvas.width = img.width;\n\n                let radius = img.width / 6;\n                let boxHeight = img.width / 10;\n                let boxIndent =  img.width / 10;\n\n                let ctx = canvas.getContext('2d');\n                ctx.drawImage(img, 0, 0);\n\n                if (notification) {\n\n                    ctx.fillStyle = UIToolsConstants.CIColors.RedPersimmon.color;\n                    ctx.beginPath();\n                    ctx.arc( img.width-2*radius+3, radius-1, radius, 0, 2 * Math.PI);\n                    ctx.fill();\n                }\n\n                if (!customPath) {\n                    // draw a box with project colors\n                    let color = matrixSession.getProjectColor(project);\n                    ctx.fillStyle = color;\n                    ctx.beginPath();\n                    ctx.rect(0 + boxIndent, img.height-boxHeight-1, img.width-1-2*boxIndent, boxHeight);\n                    ctx.fill();\n                }\n\n                iconNode.attr(\"href\", canvas.toDataURL('image/png'));\n            };\n            img.src = iconPath;\n          }\n    }\n    waitForMainTree(callback: () => void) :void {\n        if (callback) {\n            if (app.mainTreeLoaded) {\n                callback()\n            } else {\n                document.addEventListener(\"mainTreeLoaded\", () => {\n                    callback();\n                });\n            }\n        }\n    }\n\n    // load the full tree and colors items with search results if some are defined\n    public loadTreeWithSearches(item:string): JQueryDeferred<unknown> {\n        let that = this;\n        const mainTreeLoadedEvent = new Event('mainTreeLoaded');\n\n        let res = $.Deferred();\n\n        that.dbConnection.retrieveTreeAsync().done(function (result:{tree:IDB[], project:XRProjectInfo } ) {\n            that.colorBySearches(item, 0).done( () => {\n                NavigationPanel.render();\n                NavBar.init();\n                NavigationPanel.select(item);\n                res.resolve();\n                //Raise an event when the tree is loaded\n                that.mainTreeLoaded = true;\n                document.dispatchEvent(mainTreeLoadedEvent);\n                matrixApplicationUI.highlightReferences();\n                NotificationsBL.NoticationCache.setNotifications(result.project.todos.filter(function (todo) { return todo.login == matrixSession.getUser(); }));\n\n            });\n        });\n        return res;\n    }\n\n    private colorBySearches( item:string, idx:number ) : JQueryDeferred<unknown>{\n        let that = this;\n        let res = $.Deferred();\n\n        let search: ISearchConfig = globalMatrix.ItemConfig.getSearchConfig();\n\n        // Fix failed tests query (MATRIX-3926)\n        if( search != undefined && search.searches != undefined ){\n            let index = search.searches.findIndex((s => {return s.name == \"failed tests\" && s.expr == \"mrql:'testResult'='error'\"}));\n            if( index >=0){\n                search.searches[index].expr = 'mrql:\"test run result\"~\"error\"' ;\n            }\n        }\n        // no more searches defined: time to return and to render the tree\n        if (!search || !search.init || search.init.length <= idx) {\n            res.resolve();\n            return res;\n        }\n        // run the next search, color the tree and continue\n        app.searchAsyncMinimalOutput(search.init[idx].expr).done(function (items) {\n            app.setStyle(items, search.init[idx].style, search.init[idx].computeFolder);\n            that.colorBySearches( item, idx+1 ).always( () => {\n                res.resolve();\n            });\n        }).fail( function() {\n            res.resolve();\n        });\n\n        return res;\n    }\n    // render the tree\n    private showTree(item: string, cached?: IItem):void {\n        let that = this;\n\n        // render the selected item, if there is any\n        NavigationPanel.render();\n        NavBar.init();\n\n        if (item) {\n            if (this.dbConnection.doesExist(item)) {\n                this._itemId = item;\n                if (typeof globalMatrix.mobileApp !== \"undefined\") {\n                    globalMatrix.mobileApp.ShowMobileUI();\n                } else {\n                    NavigationPanel.select(item);\n                    this.renderItem(cached);\n                }\n            } else {\n                globalMatrix.projectStorage.setItem('SessionLastItem', \"\");\n                if (typeof globalMatrix.mobileApp !== \"undefined\") {\n                    globalMatrix.mobileApp.ShowMobileUI();\n                }\n                this.getItemAsync(item).done(function (_data) {\n                    matrixApplicationUI.renderErrorControl(that.itemForm, \"Item \" + item + \" does not exist anymore\", \"It was deleted, check the 'CHANGES Dashboard' or 'Deleted Items' if you are interested in when or why it was deleted.\");\n                }).fail(function () {\n                    matrixApplicationUI.renderErrorControl(that.itemForm, \"Item \" + item + \" does not exist\", \"Incorrect item id.\");\n                });\n            }\n        }\n    }\n    // *********************************************\n    // calls from item AND Tree\n    // *********************************************\n\n    getTree(subtreeFilter?:string[]):IDB[] {\n        return this.dbConnection.getTree(subtreeFilter);\n    }\n\n    // api get a simple tree structure of item ids\n    getSubTree(itemId:string):ISimpleTree {\n        let that = this;\n        let tree:ISimpleTree = { itemId:itemId, title:this.getItemTitle(itemId) };\n\t\tif ( ml.Item.parseRef(itemId).isFolder) {\n\t\t\ttree.children  = [];\n            $.each(app.getChildrenIds(itemId), function (idx, id) {\n\t\t\t\ttree.children.push( that.getSubTree(id));\n\t\t\t});\n\t\t\treturn tree;\n\t\t}\n\t\telse  {\n\t\t\treturn tree;\n\t\t}\n\t}\n\n    // *********************************************\n    // calls from item\n    // *********************************************\n\n    getAuditDetailsAsync(auditId?:number, ignoreErrors?:boolean):JQueryDeferred<XRTrimAudit> {\n        return this.dbConnection.getAuditDetailsAsync(auditId);\n    }\n    getItemAsync(itemId:string, version?:number, ignoreErrors?:boolean, noHistory?:boolean):JQueryDeferred<IItem> {\n        let that = this;\n        var res = $.Deferred();\n\n        if (typeof version !== 'undefined') {\n            this.dbConnection.getVersionAsync(itemId, version, !noHistory).done(function (result) {\n\n            res.resolve(result);\n            });\n        } else {\n            this.dbConnection.getItemAsync(itemId, ignoreErrors, !noHistory).done(function (result:IItem) {\n                that.setHiddenLink(itemId, result.isUnselected);\n                res.resolve(result);\n            }).fail(function (error) {\n                res.reject(error);\n            });\n        }\n\n        return res;\n    }\n\n    /** get the source of an item */\n    getImportSource( item:IItemGet ):XRCrossProjectLink {\n        if (!item) return null;\n        if (!item.crossLinks) return null;\n        let clones = item.crossLinks.filter( cl => cl.upItem.projectShort == matrixSession.getProject()) ;\n        if (clones.length==0) return null;\n        if (clones.length!=1) {\n            console.log(\"Warning: more than one import sources\");\n            console.log(clones);\n        }\n\n        // return the clone info\n        return clones[0];\n    }\n\n    /** return true if item is included */\n    isIncluded(item: IItemGet) {\n        let source = this.getImportSource(item);\n        if (!source) {\n            // not from import\n            return false;\n        }\n\n        return (source.relation == EImportMode.Include || source.relation == EImportMode.IncludeRoot);\n    }\n\n    /** get the source of an item */\n    getUsedBy( item:IItemGet ):XRCrossProjectLink[] {\n            if (!item) return null;\n            if (!item.crossLinks) return null;\n            let clones = item.crossLinks.filter( cl => cl.downItem.projectShort == matrixSession.getProject()) ;\n            if (clones.length==0) return null;\n\n            // return the clone info\n            return clones;\n        }\n\n    getNeedlesAsync(searchExpr:string, up?:boolean, down?:boolean, fields?:string, labels?:boolean, ignoreFilters?:boolean):JQueryDeferred<IItem[]>  {\n        return this.dbConnection.getNeedlesAsync(searchExpr, up, down, fields, labels, ignoreFilters);\n    }\n\n    getItemProjectAsync(project:string, itemId:string, ignoreErrors?:boolean):JQueryDeferred<IItem> {\n        let that = this;\n        var res = $.Deferred();\n\n        this.dbConnection.getItemProjectAsync(project, itemId, ignoreErrors, true).done(function (result:IItem) {\n            that.setHiddenLink(itemId, result.isUnselected);\n            res.resolve(result);\n        }).fail(function (error) {\n            res.reject(error);\n        });\n\n        return res;\n    }\n\n    getProjectItemAsync(project:string, itemId:string, version?:number, includeHistory?:boolean):JQueryDeferred<IItem> {\n        let that = this;\n        var res = $.Deferred();\n\n        if (typeof version !== 'undefined') {\n            this.dbConnection.getProjectVersionAsync(project, itemId, version, includeHistory).done(function (result) {\n                res.resolve(result);\n            });\n        } else {\n            this.dbConnection.getProjectItemAsync(project, itemId, true).done(function (result:IItem) {\n                res.resolve(result);\n            }).fail(function (error) {\n                res.reject(error);\n            });\n        }\n\n        return res;\n    }\n    getProjectCatFields(project: string): JQueryDeferred<XRCategoryExtendedType[]> {\n        var res = $.Deferred();\n\n        this.dbConnection.getProjectCat(project).done(function (result) {\n            let found = false;\n            res.resolve( result.categoryList.categoryExtended);\n        }).fail(function (error) {\n            res.reject(error);\n        });\n\n        return <any>res;\n    }\n\n    getItemFromTree(itemId:string):IDB {\n        return this.dbConnection.getItemFromTree(itemId);\n    }\n\n    // get children Ids\n    getChildrenIds(parentId:string):string[] {\n        return this.dbConnection.getChildrenIds(parentId);\n    }\n\n    getChildrenIdsRec(itemId:string):string[] {\n        let that = this;\n\n\t\tif ( ml.Item.parseRef(itemId).isFolder) {\n            let treeFlat:string[] = [];\n            $.each(app.getChildrenIds(itemId), function (idx, id) {\n\t\t\t\ttreeFlat = treeFlat.concat( that.getChildrenIdsRec(id));\n\t\t\t});\n\t\t\treturn treeFlat;\n\t\t}\n\t\telse  {\n\t\t\treturn [itemId];\n\t\t}\n    }\n\n    getParentId(itemId:string):string {\n        return this.dbConnection.getParentId(itemId);\n    }\n\n\n    // return a list of item, parent of item, parent of parent of item...\n    getCategoryBreadcrumbs(category:string):string[] {\n        return this.dbConnection.getCategoryBreadcrumbs(category);\n    }\n\n    // return a list of item, parent of item, parent of parent of item...\n    getBreadcrumbs(itemId:string):string[] {\n        return this.dbConnection.getBreadcrumbs(itemId);\n    }\n\n    /* set style of item / folder\n        computeFolder: 0=look (folder style from lookup)\n        computeFolder: 1=all (all children in folder have style: folder has style)\n        computeFolder: 2=any (any of the children has style: folder has style) */\n    setStyle( itemIds:string[], style:string, computeFolder:number) : void {\n        return this.dbConnection.setStyle( itemIds, style, computeFolder);\n    }\n\n    getRootOfType(category:string):string {\n        return this.dbConnection.getRootOfType(category);\n    }\n\n    startReportAsync(itemId: string, reportOptions: IReportOptions):JQueryDeferred<{}> {\n        return this.dbConnection.startReportAsync(itemId, reportOptions);\n    }\n\n    canLaunchReport():JQueryDeferred<boolean> {\n         var res = $.Deferred();\n         this.dbConnection.canLaunchReport().done(function(result:XRGetProject_AllJob_JobsWithUrl) {\n            res.resolve(result.runningJobs <=  result.maxRunningJobs);\n         }).fail( function() {\n             res.resolve(false);\n         });\n         return <any>res;\n    }\n\n    startCreateDocumentAsync(itemId: string, reportOptions: IReportOptions): JQueryDeferred<XRPostProject_LaunchReport_CreateReportJobAck> {\n        return this.dbConnection.startCreateDocumentAsync(itemId, reportOptions);\n    }\n\n    getReportDetails(jobId: number):JQueryDeferred<XRGetProject_JobStatus_JobsStatusWithUrl> {\n        return this.dbConnection.getReportDetails(jobId);\n    }\n\n    compareHTML( compareParams:XCPostCompareHtml ):JQueryDeferred<XRPostProject_CompareHtml_HtmlCompareResult> {\n        return this.dbConnection.compareHTML(compareParams);\n    }\n\n    isFolder(itemId:string):boolean {\n        return this.dbConnection.isFolder(itemId);\n    }\n\n    getItemTitle(itemId:string, display?:boolean):string {\n        let title = this.dbConnection.getItemTitle(itemId)\n        return display?ml.UI.lt.forUI(title,0):title;\n    }\n\n    download(jobId: number, file: number, param?:string[]) : void {\n        this.dbConnection.download(jobId, file, param);\n    }\n    downloadFromUrl(url:string, param?:IStringMap) : void {\n        this.dbConnection.downloadFromUrl(url, param);\n    }\n\n    downloadInMemory(jobId:number, file:string, dataType?:string):JQueryDeferred<string> {\n        return this.dbConnection.downloadInMemory(jobId, file, dataType);\n    }\n    downloadInMemoryFromUrl(url:string):JQueryDeferred<string> {\n        return this.dbConnection.downloadInMemoryFromUrl(url);\n    }\n\n\n    searchAsync(term:string, filter?:string, ignoreFilters?:boolean, fieldList?:string, crossProject?:string, labels?:boolean, down?:boolean, up?:boolean, treeOrder?:boolean):JQueryDeferred<ISearchResult[]> {\n        return this.dbConnection.searchAsync(term, filter, ignoreFilters,fieldList, crossProject, labels, down, up, treeOrder);\n    }\n\n    searchAsyncMinimalOutput(term: string, filter?: string, ignoreFilters?: boolean,crossProject?:string) : JQueryDeferred<string[]> {\n        return this.dbConnection.searchAsyncMinimalOutput(term, filter, ignoreFilters,crossProject);\n    }\n\n    updateItemInDBAsync(itemJson:IItemPut, auditAction:string, requireVersion?:number):JQueryDeferred<IItemGet> {\n        let that = this;\n        var res = $.Deferred();\n\n        matrixSession.getCommentAsync().done(function (comment: string) {\n            that.dbConnection.updateItemAsync(itemJson, comment, auditAction, requireVersion).done(function (result) {\n                NavigationPanel.update(itemJson);\n                res.resolve(result);\n            }).fail(function () {\n                // MATRIX-3815\n                res.reject(\"saving failed\");\n            });\n        }).fail(function () {\n            // rien a fair\n            res.reject(\"user cancelled\");\n        });\n\n        return res;\n    }\n\n\n    async getItemFromDBAsync( itemId:string ): Promise<IItem> {\n        let type = ml.Item.parseRef(itemId).type;\n        if (!type || globalMatrix.ItemConfig.getCategories(true).indexOf(type) == -1) {\n            ml.Logger.error(`This is not possibly an item in this project: \"${itemId}\"!`);\n            return;\n        }\n        return await this.getItemAsync( itemId );\n    }\n\n    async getFieldFromDBAsync( itemId:string, fieldName:string): Promise<any> {\n        let type = ml.Item.parseRef(itemId).type;\n        if (!type || globalMatrix.ItemConfig.getCategories(true).indexOf(type) == -1) {\n            ml.Logger.error(`This is not possibly an item in this project: \"${itemId}\"!`);\n            return;\n        }\n        let fieldId = globalMatrix.ItemConfig.getFieldId(type, fieldName);\n        if (!fieldId){\n            ml.Logger.error(`\"${fieldName}\" is not a field of this item \"${itemId}\"!`);\n            return;\n        }\n        let item:IItem = await this.getItemAsync( itemId );\n        return item[fieldId];\n    }\n\n    async setFieldInDBAsync( itemId:string, fieldName:string, value:string) : Promise<any> {\n        return this.setFieldsInDBAsync( itemId, [ {fieldName:fieldName,  value:value }]);\n    }\n    async setFieldsInDBAsync( itemId:string, data:ISetField[] ) {\n        let res = $.Deferred();\n        let update= {\n            id:itemId,\n            onlyThoseFields:1,\n            onlyThoseLabels:1\n        }\n        let type = ml.Item.parseRef(itemId).type;\n        if (!type){\n            ml.Logger.error(`This is not possibly an item in this project: \"${itemId}\"!`);\n            res.reject();\n            return res;\n        }\n        for (let s of data) {\n            let fieldId = globalMatrix.ItemConfig.getFieldId(type, s.fieldName);\n            if (!fieldId){\n                ml.Logger.error(`\"${s.fieldName}\" is not a field of this item \"${itemId}\"!`);\n                res.reject();\n                return res;\n            }\n            update[ \"fx\" + fieldId] = s.value;\n        }\n\n        return app.updateItemInDBAsync(update, \"edit\");\n    }\n    createItemOfTypeAsync(category:string, itemJson:IItemPut, actions:string, parentId:string, dontFailOnCleanup?:boolean):JQueryDeferred<IDBParent> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        itemJson.type = category;\n\n        matrixSession.getCommentAsync().done(function (comment: string) {\n            that.dbConnection.createItemAsync(itemJson, comment, actions, parentId, dontFailOnCleanup).done(function (result:IDBParent) {\n                // verify if new item needs to be filtered in tree\n                if (ml.CreateNewLabelTools().isFiltered(category, itemJson.labels)) {\n                    that.dbConnection.setHiddenLink(result.item.id, 1);\n                }\n                // show it in tree\n                that.insertInTree(result);\n                res.resolve(result);\n            });\n        }).fail(function () {\n            // rien a fair\n            res.reject(\"user cancelled\");\n        });\n\n        return <JQueryDeferred<IDBParent>>res;\n    }\n\n\n    restoreItemAsync(itemId:string, title:string, version:number):JQueryDeferred<IRestoreItemResult> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        matrixSession.getCommentAsync().done(function (comment) {\n            that.dbConnection.restoreItemAsync(itemId, title, version, comment).done(function (result:IRestoreItemResult) {\n                if (result) {\n                    var itemJson:IItem = {\n                        id: itemId,\n                        title: title,\n                        type: ml.Item.parseRef(itemId).type\n                    };\n\n                    var newItem: IDBParent = {\n                        parent: result.response.newParent,\n                        position: result.response.newOrder,\n                        item: <IItem>itemJson\n                    };\n\n                    if (result.version) {\n                        NavigationPanel.update(itemJson);\n                        that.renderItem();\n                    }\n                    else {\n                        that.insertInTree(newItem);\n                    }\n                }\n                res.resolve(result);\n            });\n        }).fail(function () {\n            // rien a fair\n            res.reject();\n        });\n\n        return <any>res;\n    }\n\n    deleteItem(itemId:string):JQueryDeferred<{}> {\n        let res = $.Deferred();\n\n        let that = this;\n\n        if (this.dbConnection.hasChildren(itemId)) {\n            // MATRIX-920 Allow to delete non-empty folders\n\n\n            this.verifyNoLockedItems( itemId ).done( function() {\n                window.setTimeout(function () {\n                    ml.UI.showConfirm(7, {title: \"The folder is not empty! <b>Delete anyway?</b>\", ok: \"Delete\"}, function () {\n                        matrixSession.getCommentAsync().done(function (comment) {\n                            that.dbConnection.deleteItemAsync(itemId, comment, true).done(function (parent) {\n                                that.removedFromTree(itemId, parent);\n\n                                res.resolve();\n                            }).fail(function () {\n                                res.reject();\n                            });\n                        }).fail(function () {\n                            res.reject();\n                            // rien a fair\n                        });\n                    }, function () {\n                        res.reject();\n                    });\n                }, 1000);\n            }).fail( function() {\n                res.reject();\n            });\n\n            return res;\n        }\n\n        if (matrixApplicationUI.lastMainItemForm && this._needsSave) {\n            ml.UI.showError(\"Item was modifed.\", \"Save item first or cancel changes.\");\n            res.reject();\n            return res;\n        }\n\n        matrixSession.getCommentAsync().done(function (comment) {\n            that.dbConnection.deleteItemAsync(itemId, comment, false).done(function (parent) {\n                that.removedFromTree(itemId, parent);\n                res.resolve();\n            }).fail(function () {\n                res.reject();\n            });\n        }).fail(function () {\n            res.reject();\n        });\n\n        return res;\n    }\n\n    private verifyNoLockedItems(folderId:string):JQueryDeferred<{}> {\n        let res= $.Deferred();\n\n        // check if there are any locks\n        let ll = globalMatrix.ItemConfig.getLabelLockConfig();\n        if (!ll || !ll.locks ||ll.locks.length==0) {\n            res.resolve();\n            return res;\n        }\n\n        // create a list of locking labels\n        let locks = ll.locks.map( function(lock) { return lock.label; });\n\n\n        this.getNeedlesAsync(\"folderm=\"+folderId, false, false, \"\", true, true).done( function( results:IItemGet[]) {\n            let itemsWithLocks:string[] = [];\n\n            $.each(results, function(idx, result) {\n                if ( result.labels.filter( function(label) { return locks.indexOf(label)!=-1;}).length>0) {\n                    itemsWithLocks.push( result.id );\n                }\n            });\n            if (itemsWithLocks.length) {\n                ml.UI.showError(\"Deleted failed\", \"Some of the items are locked. Please unlock before deleting. Item(s) with locks: \" + itemsWithLocks.join(\",\"));\n                res.reject();\n            } else {\n                res.resolve();\n            }\n        }).fail( function() {\n            res.reject();\n        });\n        return res;\n    }\n    uploadFileProjectAsync(file: IFileParam, progress:(p:IFileUploadProgress) =>  void):JQueryDeferred<{}> {\n        return <any>this.dbConnection.uploadFileProjectAsync(file, progress);\n    }\n\n    fetchFileAsync( url:string, progress:(p:IFileUploadProgress) =>  void):JQueryDeferred<XRPostProject_AddFile_AddFileAck> {\n        return <any>this.dbConnection.fetchFileAsync(url, progress);\n    }\n    resizeItem( force?:boolean ):void {\n        if (matrixApplicationUI.lastMainItemForm) {\n            matrixApplicationUI.lastMainItemForm.resizeItem(force);\n        }\n    }\n\n    itemChanged(needsSave: boolean): void {\n        this._needsSave = needsSave;\n        this.resizeItem();\n        matrixApplicationUI.updateMainUI();\n    }\n\n    // this is called after an item has been reloaded and the rendering must be updated\n    updateItem(newItem:IItem) : void {\n        if (matrixApplicationUI.lastMainItemForm) {\n            matrixApplicationUI.lastMainItemForm.updateItem(newItem);\n        }\n    }\n\n    // sets a value of a field, the field must exist and have a setValue function\n    setFieldValue(fieldId:number, newValue:string) : void {\n        matrixApplicationUI.lastMainItemForm.setFieldValue(fieldId, newValue);\n    }\n    // get value from current UI\n    async getFieldValueAsync(fieldId:number) {\n        return await matrixApplicationUI.lastMainItemForm.getFieldValue(fieldId);\n    }\n    async getCurrentTitle() {\n        return matrixApplicationUI.lastMainItemForm.getCurrentTitle();\n    }\n    isConfigApp() {\n        return false;\n    }\n\n    addDownLinkAsync(fromId:string, toId:string):JQueryDeferred<{}> {\n        let that = this;\n        var res = $.Deferred();\n\n        matrixSession.getCommentAsync().done(function (comment) {\n            that.dbConnection.addDownLinkAsync(fromId, toId, comment).done(function () {\n                that.refreshUIAsync(fromId, toId);\n                res.resolve();\n            }).fail(function (jqxhr, textStatus, error) {\n                if (jqxhr.responseText.indexOf(\"This link already exists\") > -1) {\n                    // not really a failure so ignore\n                    res.resolve();\n                } else {\n                    res.reject(jqxhr, textStatus, error);\n                }\n            });\n        }).fail(function () {\n            res.reject(\"user cancelled\");\n        });\n        return res;\n    }\n\n    removeDownLinkAsync(fromId:string, toId:string):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        matrixSession.getCommentAsync().done(function (comment) {\n            that.dbConnection.removeDownLinkAsync(fromId, toId, comment).done(function () {\n                that.refreshUIAsync(fromId, toId);\n                res.resolve();\n                /*\n                WorkflowEngine.applyCommentAsync(fromId, \"removedownlink|\" + toId, comment);\n                */\n            }).fail(function () {\n                res.reject();\n            });\n        }).fail(function () {\n            // rien a fair\n            res.reject(\"user cancelled\");\n        });\n        return res;\n    }\n\n    setSettingJSON(key:string, valueJSON:{}) :JQueryDeferred<{}> {\n        return this.dbConnection.setSettingJSON(key, valueJSON);\n    }\n\n    readSettingJSONAsync(key:string, otherProject?:string, noRetry?:boolean):JQueryDeferred<{}> {\n        return this.dbConnection.readSettingJSONAsync(key, otherProject, noRetry);\n    }\n    setSettingCustomerJSON(key:string, valueJSON:{}):JQueryDeferred<unknown> {\n        return this.dbConnection.setSettingCustomerJSON(key, valueJSON);\n    }\n\n    readSettingCustomerJSONAsync(key:string):JQueryDeferred<{}> {\n        return this.dbConnection.readSettingCustomerJSONAsync(key);\n    }\n\n\n    // *********************************************\n    // manage references either from up to 1.6 category params\n    // or 1.6 and later json setting\n    //\n    //\n    /*  \"rules\": [\n     {\"category\": \"MREQ\",\n     \"down_rules\": [\n     {\n     \"rule\":\"must_have\",\n     \"any_of\": [ \"FREQ\", \"TREQ\" ]\n     },\n     {\n     \"rule\":\"can_have\",\n     \"any_of\": [ \"UC\" ]\n     },\n     {\n     \"rule\":\"can_have\",\n     \"any_of\": [ \"TC\" ]\n     }]\n     */\n    // *********************************************\n\n    getMissingUpLinks(item:IItem):string[] {\n        var upMissing:string[] = [];\n        var ulTypes = globalMatrix.ItemConfig.getLinkTypes(item.type, false, true);\n        for (var ulidx = 0; ulidx < ulTypes.length; ulidx++) {\n            var missing = true;\n            for (var idx = 0; idx < item.upLinks.length; idx++) {\n                if (item.upLinks[idx].to.indexOf(ulTypes[ulidx] + \"-\") === 0) {\n                    missing = false;\n                }\n            }\n            if (missing) {\n                upMissing.push(ulTypes[ulidx]);\n            }\n        }\n        return upMissing;\n    }\n\n    // check is a required uplink is missing\n    isUpLinkMissing(item:IItem):boolean {\n\n        var result = this.evaluateTraceRule(item, false);\n        if (result) {\n            return !result.valid;\n        }\n\n        return this.getMissingUpLinks(item).length > 0;\n    }\n\n    getMissingDownLinks(item:IItem):string[] {\n\n        var result = this.evaluateTraceRule(item, true);\n        if (result) {\n            return result.missingMustHaveCategories;\n        }\n\n        var downMissing:string[] = [];\n        var dlTypes = globalMatrix.ItemConfig.getDownLinkTypes(item.type, true);\n        for (var dlidx = 0; dlidx < dlTypes.length; dlidx++) {\n            var missing = true;\n            for (var idx = 0; idx < item.downLinks.length; idx++) {\n                if (item.downLinks[idx].to.indexOf(dlTypes[dlidx] + \"-\") === 0) {\n                    missing = false;\n                }\n            }\n            if (missing) {\n                downMissing.push(dlTypes[dlidx]);\n            }\n        }\n        return downMissing;\n    }\n\n    // return a list of required and optional downlinks\n    getLinkCategories(item:IItem, ctrlParameter:ILinkCollectionOptions):ILinkCategories[] {\n\n        var result = this.evaluateTraceRule(item, true);\n        if (result) {\n            var resultLinks:ILinkCategories[] = [];\n            var links:string[] = [];\n            $.each(result.mustHaveCategories, function (catIdx, cat) {\n                if (links.indexOf(cat) === -1) {\n                    links.push(cat);\n                    resultLinks.push({\n                        name: globalMatrix.ItemConfig.getCategoryLabel(cat),\n                        required: true,\n                        type: cat\n                    });\n                }\n            });\n\n            $.each(result.canHaveCategories, function (catIdx, cat) {\n                if (links.indexOf(cat) === -1) {\n                    links.push(cat);\n                    resultLinks.push({\n                        name: globalMatrix.ItemConfig.getCategoryLabel(cat),\n                        required: false,\n                        type: cat\n                    });\n                }\n            });\n            return resultLinks;\n        }\n\n        // legacy\n        return ctrlParameter.parameter.linkTypes ? ctrlParameter.parameter.linkTypes : [];\n    }\n\n    isDownLinkMissing(item:IItem):boolean {\n        var result = this.evaluateTraceRule(item, true);\n        if (result) {\n            return !result.valid;\n        }\n\n        return this.getMissingDownLinks(item).length > 0;\n    }\n\n    // returns true if any down or uplink is outdated\n    isAnyLinkOutdated(item:IItem):boolean {\n\n        var resultDown = this.evaluateTraceRule(item, true);\n        if (resultDown) {\n            var resultUp = this.evaluateTraceRule(item, false);\n            return resultDown.outdatedReferences.length + resultUp.outdatedReferences.length > 0;\n        }\n\n\n        var itemDate = new Date(item.modDate);\n        for (var idx = 0; idx < item.downLinks.length; idx++) {\n            var refDate = new Date(item.downLinks[idx].modDate);\n            if (itemDate > refDate) {\n                return true;\n            }\n        }\n        for (var idx = 0; idx < item.upLinks.length; idx++) {\n            var refDate = new Date(item.upLinks[idx].modDate);\n            if (itemDate < refDate) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n\n    hasLinks(item:IItem):boolean {\n        var result = this.evaluateTraceRule(item, false);\n        if (result) {\n            if (result.canHaveCategories.length > 0)\n                return true;\n            if (result.mustHaveCategories.length > 0)\n                return true;\n            result = this.evaluateTraceRule(item, true);\n            if (result.canHaveCategories.length > 0)\n                return true;\n            if (result.mustHaveCategories.length > 0)\n                return true;\n            // todo ... maybe manage in\n            if (item.type === \"XTC\" || (mDHF && mDHF.isSignedType(item.type))) {\n                // special case\n                return true;\n            }\n            return false;\n        }\n        if (globalMatrix.ItemConfig.getDownLinkTypes(item.type, false).length > 0) {\n            return true;\n        }\n        if (globalMatrix.ItemConfig.getDownLinkTypes(item.type, true).length > 0) {\n            return true;\n        }\n        if (globalMatrix.ItemConfig.getUpLinkTypes(item.type, false).length > 0) {\n            return true;\n        }\n        if (globalMatrix.ItemConfig.getUpLinkTypes(item.type, true).length > 0) {\n            return true;\n        }\n        if (item.type === \"XTC\" || (mDHF && mDHF.isSignedType(item.type))) {\n            // special case\n            return true;\n        }\n        return  false;\n    }\n\n    isHiddenLink(itemId:string) {\n        return this.dbConnection.isHiddenLink(itemId);\n    }\n\n    setHiddenLink(itemId:string, hidden:number):void {\n        if (globalMatrix.ItemConfig.getTimeWarp()) return;\n        this.dbConnection.setHiddenLink(itemId, hidden);\n        NavigationPanel.updateItemIsUnselected(itemId, hidden!==0);\n    }\n    // *********************************************\n    // calls from outer UI\n    // *********************************************\n\n    saveAsync(sendUnEdit:boolean ):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        if (matrixApplicationUI.lastMainItemForm) {\n            matrixSession.updateWatchItemVersion(app.getCurrentItemId(), -1);\n            matrixApplicationUI.lastMainItemForm.saveAsync(null, null).then(function (result: IItem) {\n\n                matrixSession.updateWatchItemVersion(result.id, result.maxVersion);\n\n                if (sendUnEdit) {\n                    matrixSession.pushMessages.unEditItem();\n                }\n                that.setHiddenLink(result.id, result.isUnselected);\n                // that will send a new watching message after the unEdit above\n                that.renderItem(result);\n                res.resolve();\n            }).catch(function () {\n                res.reject();\n            });\n        } else {\n            res.resolve();\n        }\n        return res;\n    }\n\n    // this is brutal, it just cancels all edits and set's the item to readonly\n    // happens at start of download\n    forceReadonly( itemId:string ) : void {\n\n        if (matrixApplicationUI.lastMainItemForm) {\n            this._needsSave = false;\n            matrixApplicationUI.forceReadonly(itemId);\n        }\n    }\n    cancel() : void  {\n        if (matrixApplicationUI.lastMainItemForm) {\n            this.renderItem(null);\n        }\n    }\n\n    // this is called if two users watches the same item, one edits and saves it...\n    someOneElseChanged()  : void  {\n        let that = this;\n        if (this.waitingForEditRights) {\n            ml.UI.closeConfirmSpinningWait();\n        }\n        if (matrixApplicationUI.lastMainItemForm) {\n            if (this.needsSave()) {\n                ml.UI.showConfirm( -1, { title:\"Someone just changed the item.\", ok:\"Update to latest\", nok:\"Ignore and merge later\"},  () => {\n                    // reload the item\n                    that.renderItem(null);\n                },  () => {\n                    // do nothing... user will pay the price later\n                });\n            } else  {\n                // the item changed, time to reload the new version\n                this.renderItem(null);\n            }\n        }\n    }\n\n    private waitingForEditRights:boolean;\n\n    someOneIsChangingTheItem(): void {\n        let that = this;\n        if (matrixApplicationUI.lastMainItemForm && !this.waitingForEditRights) {\n            if (this.needsSave()) {\n                ml.UI.showConfirm( -1, { title:\"Someone else is changing this item.\", ok:\"Update to latest\", nok:\"Wait and merge\"},  () => {\n                    // reload the item\n                    that.renderItem(null);\n                },  () => {\n                    that.waitForEditRights();\n                });\n            } else  {\n                // the item changed, time to reload the new version\n                this.renderItem(null);\n            }\n        }\n    }\n\n    waitForEditRights() : void {\n        let that = this;\n\n        this.waitingForEditRights = true;\n        ml.UI.showConfirm( -1, { title: ml.UI.getSpinningWait( \"Waiting for other user to stop editing\").html(),\n            ok:\"Cancel\"},  () => {\n                // reload the item\n                that.waitingForEditRights = false;\n                that.renderItem(null);\n            },\n            () => {}\n        );\n    }\n    // someone else started to change\n    someOneElseIsChanging(watcherInfo:IItemWatched) : void {\n        let that = this;\n        if (matrixApplicationUI.lastMainItemForm) {\n            if (this.needsSave()) {\n                // this should not happen\n                ml.UI.showConfirm( -1, { title:watcherInfo.editor.user + \" started editing the item\", ok:\"Cancel my Edit\", nok:\"Edit and merge later\"},  () => {\n                    // reload the item\n                    that.updateItemDisplay(watcherInfo);\n                },  () => {\n                    // do nothing... user will pay the price later\n                });\n            } else  {\n                // someone else started to edit the item, make it readonly for this user to avoid conflicts\n                this.updateItemDisplay(watcherInfo);\n            }\n        }\n    }\n    someOneElseWasChanging(watcherInfo:IItemWatched) : void {\n        let that = this;\n        if (matrixApplicationUI.lastMainItemForm) {\n            if (this.needsSave()) {\n                if ( that.freezeDuringSave) {\n                    // this is a race condition we can live with\n                    return;\n                }\n                // this should not happen\n                ml.UI.showConfirm( -1, { title :\" Someone else changed the item in the meantime. You won't be able to save!\", ok:\"Load updated item\", nok:\"Do not yet update\"},  () => {\n                    // reload the item\n                    that.cancel();\n                },  () => {\n                    // do nothing... user will pay the price later\n                });\n            } else  {\n                // someone else started to edit the item, make it readonly for this user to avoid conflicts\n                this.updateItemDisplay(watcherInfo);\n            }\n        }\n    }\n\n    // someone else stopped editing the same item, but apparently canceled the edit, or session timed out\n    someOneElseStoppedEditing(watcherInfo:IItemWatched, previousWatcherInfo:IItemWatched) : void  {\n        ml.Logger.log(\"info\", previousWatcherInfo.editor.user + \" stopped editing\");\n        if (matrixApplicationUI.lastMainItemForm) {\n            if (this.needsSave()) {\n                ml.Logger.log(\"info\", \"user was also editing nothing I can do\");\n                // just let the user do it thing it might cause issues to save later\n                // but nothing we can do\n            } else  {\n                // reload the latest version of the item, and make sure it writeable (if user has write access)\n                // this is not really necessary, since the item should not have changed, so we could also just switch the user from\n                // readonly to write (if needed)\n                this.updateItemDisplay(watcherInfo);\n            }\n        }\n    }\n\n    // just update the list of items\n    updateItemViewers(watcherInfo:IItemWatched):void {\n        if (matrixApplicationUI.lastMainItemForm) {\n            this.updateItemDisplay(watcherInfo);\n        }\n    }\n\n    protected updateItemDisplay(watcherInfo:IItemWatched):void {\n        matrixApplicationUI.updateControl(watcherInfo, this.itemChanged.bind(this));\n    }\n\n\n    getVersion():string {\n        return $(\"meta[name='mx-version']\").attr('content');\n    }\n\n    getVersionQualifier():string {\n        return $(\"meta[name='mx-version-qualifier']\").attr('content');\n    }\n\n    getNeedsSave():boolean {\n        return this._needsSave;\n    }\n\n    getType(itemId:string) : string {\n        return this.dbConnection.getType(itemId);\n    }\n\n    getAvailableReportsAsync():JQueryDeferred<XRGetProject_Reports_GetReportsAck> {\n        return this.dbConnection.getAvailableReportsAsync( );\n    }\n\n    getDeletedItemsAsync(insertInList: (item:IVersionDetails)=> void, progress:(p:number)=>void, deleteLog?:IVersionDetails[], startAt?:number):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        if (typeof startAt === 'undefined') {\n            startAt = 0;\n        }\n\n        if (typeof deleteLog === 'undefined') {\n            deleteLog = [];\n        }\n\n        var cats = globalMatrix.ItemConfig.getCategories();\n\n        this.dbConnection.getAuditLogAsync(startAt, 1000, { deleteOnly: \"yes\" }).done(function(result: XRGetProject_ProjectAudit_TrimAuditList) {\n\n            progress.apply(that, [(startAt + result.audit.length) * 100 / result.totalResults]);\n\n            if (result) {\n                for (var idx = 0; idx < result.audit.length; idx++) {\n                    if (result.audit[idx].action === \"delete\" && result.audit[idx].itemBefore) {\n\n                        var ir = ml.Item.parseRef(result.audit[idx].itemBefore.itemOrFolderRef);\n                        var itemId = ir.id;\n                        var version = ir.version;\n                        if (!ir.isFolder && cats.indexOf(ir.type) !== -1) {\n                            // verify that the id is not in the current project (as it was undeleted) or already in the list of deleted objects\n                            var found = false;\n                            for (var di = 0; di < deleteLog.length; di++) {\n                                if (deleteLog[di].id == itemId) {\n                                    found = true;\n                                }\n                            }\n                            found = found || that.dbConnection.doesExist(itemId);\n                            if (!found) {\n                                var item:IVersionDetails = {\n                                    action: 'delete',\n                                    id: itemId,\n                                    title: result.audit[idx].itemBefore.title,\n                                    user: result.audit[idx].userLogin,\n                                    date: result.audit[idx].dateTime,\n                                    dateUserFormat: result.audit[idx].dateTimeUserFormat,\n                                    comment: result.audit[idx].reason,\n                                    version: version,\n                                    fullVersion: result.audit[idx].itemBefore.itemOrFolderRef,\n                                    auditId: result.audit[idx].auditId,\n                                    tags: result.audit[idx].tags\n                                };\n                                insertInList.apply(that, [item]);\n                                deleteLog.push(item);\n                            }\n                        }\n                    }\n                    if (result.audit[idx].action === \"merge\" && result.audit[idx].itemsDeletedByMerge) {\n\n                        for ( let idbm of result.audit[idx].itemsDeletedByMerge) {\n                            var ir = ml.Item.parseRef(idbm.ref);\n                            var itemId = ir.id;\n                            var version = ir.version;\n                            if (!ir.isFolder && cats.indexOf(ir.type) !== -1) {\n                                // verify that the id is not in the current project (as it was undeleted) or already in the list of deleted objects\n                                var found = false;\n                                for (var di = 0; di < deleteLog.length; di++) {\n                                    if (deleteLog[di].id == itemId) {\n                                        found = true;\n                                    }\n                                }\n                                found = found || that.dbConnection.doesExist(itemId);\n                                if (!found) {\n                                    var item:IVersionDetails = {\n                                        action: 'delete',\n                                        id: itemId,\n                                        title: idbm.title,\n                                        user: result.audit[idx].userLogin,\n                                        date: result.audit[idx].dateTime,\n                                        dateUserFormat: result.audit[idx].dateTimeUserFormat,\n                                        comment: result.audit[idx].reason,\n                                        version: version,\n                                        fullVersion: idbm.ref,\n                                        auditId: result.audit[idx].auditId,\n                                        tags: result.audit[idx].tags\n                                    };\n                                    insertInList.apply(that, [item]);\n                                    deleteLog.push(item);\n                                }\n                            }\n                        }\n                    }\n                }\n                if (result.totalResults > startAt + result.audit.length) {\n                    that.getDeletedItemsAsync(insertInList, progress, deleteLog, startAt + result.audit.length).done(function (recResult) {\n                        res.resolve();\n                    });\n                } else {\n                    res.resolve();\n                }\n            }\n            else {\n                res.resolve();\n            }\n        });\n\n        return res;\n    }\n\n\n\n    getActivityAsync(insertInList: (item:IVersionDetails, first?:number, last?:number, referenceChange?:IReferenceUpdate) => void, startAt?:number, count?:number, auditIdMin?:number, auditIdMax?:number):JQueryDeferred<number> {\n        let that = this;\n\n        var res = $.Deferred();\n        var cats = globalMatrix.ItemConfig.getCategories();\n        var param: XCGetProjectAudit = {};\n        if (auditIdMin) {\n            param.auditIdMin = auditIdMin;\n        }\n        if (auditIdMax) {\n            param.auditIdMax = auditIdMax;\n        }\n        param.include = globalMatrix.historyFilter;\n        this.dbConnection.getAuditLogAsync(startAt, count, param).done(function(result: XRGetProject_ProjectAudit_TrimAuditList) {\n            for (var idx = 0; idx < result.audit.length; idx++) {\n                var itemDetails: XRTrimNeedleItemJob = null;\n                var addedLink:string = null;\n                var removedLink:string = null;\n\n                switch (result.audit[idx].action) {\n                    case \"delete\":\n                        if (result.audit[idx].entity === \"item_link\") {\n                            removedLink = result.audit[idx].itemDown.itemOrFolderRef;\n                        } else {\n                            itemDetails = result.audit[idx].itemBefore;\n                        }\n                        break;\n                    case \"add\":\n                        if (result.audit[idx].entity === \"item_link\") {\n                            if ( !result.audit[idx].itemDown ) {\n                                ml.Logger.log(\"warning\", \"add item_link but no details\" );\n                                break;\n                            }\n                            addedLink = result.audit[idx].itemDown.itemOrFolderRef;\n                        } else {\n                            itemDetails = result.audit[idx].itemAfter;\n                        }\n                        break;\n                    case \"undelete\":\n                    case \"edit\":\n                    case \"reviewed\": // reviewed is used by review labels\n                    case \"execute\":\n                    case \"signature\":\n                    case \"touch\":\n                        itemDetails = result.audit[idx].itemAfter;\n                        break;\n                    case \"report\":\n                        // we simulate the ItemAfter object for print jobs, that is not generated by the API anymore\n                        itemDetails = <XRTrimNeedleItem>new Object();\n                        itemDetails['job'] = result.audit[idx].reportJobId;\n                        itemDetails['itemOrFolderRef'] = result.audit[idx].reportRef + \"-v0\";\n                        itemDetails['title'] = result.audit[idx].reportTitle;\n                        break;\n                    case \"move\":\n                        // drag and drop of item\n                        // I don't get the before / after so I just ignore it\n                        break;\n                    case \"merge\":\n                        // branch was merged\n                        if ( result.audit[idx].entity == \"begin_merge\") {\n                            // that's a \"fake\" change just before the merge\n                        } else {\n                            let merge:IVersionDetails = {\n                                action: result.audit[idx].action,\n                                id: null,\n                                title: null,\n                                user: result.audit[idx].userLogin,\n                                date: result.audit[idx].dateTime,\n                                dateUserFormat: result.audit[idx].dateTimeUserFormat,\n                                comment: result.audit[idx].reason,\n                                version: null,\n                                fullVersion: null,\n                                job: null,\n                                reason:  result.audit[idx].reason,\n                                tags: result.audit[idx].tags,\n                                auditId: result.audit[idx].auditId\n\n                            };\n                            insertInList.apply(that, [merge]);\n                        }\n                        break;\n                    case \"report udpate\":\n                        // this is a change to a doc's structure: changed in 1.9 to use just normal edit\n                        //we just ignore it\n                        break;\n                    case \"udpate\":\n                        // this is a change to a project setting\n                        //we just ignore it\n                        break;\n                    default:\n                        ml.Logger.log(\"warning\", \"ACTIVITY: \" + result.audit[idx].action);\n                }\n                if (itemDetails) {\n                    let ir = ml.Item.parseRef(itemDetails.itemOrFolderRef);\n                    if (cats.indexOf(ir.type) !== -1) {\n                        let item:IVersionDetails = {\n                            action: result.audit[idx].action,\n                            id: ir.id,\n                            title: itemDetails.title,\n                            user: result.audit[idx].userLogin,\n                            date: result.audit[idx].dateTime,\n                            dateUserFormat: result.audit[idx].dateTimeUserFormat,\n                            comment: result.audit[idx].reason,\n                            version: ir.version,\n                            fullVersion: itemDetails.itemOrFolderRef,\n                            job: itemDetails['job'],\n                            reason:  result.audit[idx].reason,\n                            tags: result.audit[idx].tags,\n                            auditId: result.audit[idx].auditId\n                        };\n                        insertInList.apply(that, [item]);\n                    }\n                } else if (addedLink) {\n                    insertInList.apply(that, [null, null, null, <IReferenceUpdate>{\n                        added:true,\n                        fromId: result.audit[idx].itemUp.itemOrFolderRef,\n                        toId:addedLink,\n                        date: result.audit[idx].dateTime,\n                        dateUserFormat: result.audit[idx].dateTimeUserFormat,\n                        comment: result.audit[idx].reason,\n                        user:result.audit[idx].userLogin\n                    }]);\n                } else if (removedLink) {\n                    insertInList.apply(that, [null, null, null, <IReferenceUpdate>{\n                        added:false,\n                        fromId: result.audit[idx].itemUp.itemOrFolderRef,\n                        toId:removedLink,\n                        date: result.audit[idx].dateTime,\n                        dateUserFormat: result.audit[idx].dateTimeUserFormat,\n                        comment: result.audit[idx].reason,\n                        user:result.audit[idx].userLogin\n                    }]);\n                }\n\n            }\n            res.resolve(result.totalResults);\n        });\n\n        return <any>res;\n    };\n\n    // *********************************************\n    // calls from tree\n    // *********************************************\n\n    canNavigateAwayAsync( ):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        if (matrixApplicationUI.lastMainItemForm && this._needsSave) {\n            // get errors is comment needs ticked id\n            var commentNeedsTicket:string[] = [];\n\n            commentNeedsTicket = mTasks ? mTasks.evaluateTaskIds(matrixSession.getComment()) : [];\n\n            if (localStorage.getItem('idAutoCommit') === 'true' &&\n                !(this.commentRequired() && matrixSession.getComment() == \"\") && commentNeedsTicket.length === 0) {\n                that.freezeDuringSave = true;\n                matrixApplicationUI.lastMainItemForm.saveAsync(null, null).then(function (result: IItem) {\n                    that.setHiddenLink(result.id, result.isUnselected);\n                    that._needsSave = false;\n                    that.freezeDuringSave = false;\n                    res.resolve(); // no problem, changes were saved automatically\n                }).catch(function (error:string) {\n                    ml.UI.showError(\"Save failed!\", error);\n                    res.reject();\n                    that.freezeDuringSave = false;\n                });\n            }\n            else {\n                if (localStorage.getItem('idAutoCommit') === 'true') {\n                    if (  commentNeedsTicket.length>0 ) {\n                        ml.UI.showError(\"You need to save first! Enter a session comment with a ticket id\" , commentNeedsTicket.join(\" \") );\n                    } else  {\n                        ml.UI.showError(\"You need to save first!\" , \"Enter a session comment to use autosave\");\n                    }\n                } else {\n                    ml.UI.showError(\"You need to save first!\", \"Tip: enable autosave\");\n                }\n                res.reject();\n            }\n        } else {\n            res.resolve(); // no changes -> no problem\n        }\n        return res;\n    };\n\n    treeSelectionChangeAsync(newItemId:string):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        if ( this.freezeDuringSave ) {\n            // we are saving... just ignore the click\n            res.reject();\n            return res;\n        }\n        this.canNavigateAwayAsync().done(function () {\n            that._itemId = newItemId;\n            that.renderItem();\n            that._needsSave = false;\n            // select in tree but do not trigger a reload\n            NavigationPanel.select(newItemId);\n\n            // Automatically switch to item when mobileLayout\n            let mobileLayout =localStorage.getItem( \"mobileLayout\");\n            if( mobileLayout && mobileLayout != \"\" &&  that._itemId.indexOf(\"F-\") != 0)\n            {\n                localStorage.setItem( \"mobileLayout\",\"0\");\n                (window as any).applyResponsiveView();\n            }\n\n            res.resolve();\n        }).fail(function () {\n            // select in tree but do not trigger a reload\n            window.setTimeout(function() {\n                NavigationPanel.select(that.getCurrentItemId());\n            },1)\n            res.reject();\n        });\n\n        return res;\n    };\n\n    moveItemsAsync(itemIds:string, newFolder:string, newPosition?:number, useComment?:string):JQueryDeferred<{}> {\n        let that = this;\n        var res = $.Deferred();\n        if (useComment) {\n            that.dbConnection.moveItemsAsync(itemIds, newFolder, newPosition, useComment).done(function (result) {\n                that.updateMaxVersion(itemIds).always( function() {\n                    res.resolve();\n                });\n            }).fail(function () {\n                res.reject();\n            });\n        } else {\n            matrixSession.getCommentAsync().done(function (comment) {\n                that.dbConnection.moveItemsAsync(itemIds, newFolder, newPosition, comment).done(function (result) {\n                    that.updateMaxVersion(itemIds).always( function() {\n                        res.resolve();\n                    });\n                }).fail(function () {\n                    res.reject();\n                });\n            }).fail(function () {\n                res.reject();\n            });\n        }\n        return res;\n    };\n\n    // MATRIX-3728 e.g. after an item move, the item's history count might be increased\n    // let's update it to avoid merge dialog when editing after\n    updateMaxVersion( itemId:string ):JQueryDeferred<{}> {\n        let res = $.Deferred();\n        if (app.getCurrentItemId() != itemId) {\n            // nothing to do\n            res.reject();\n            return res;\n        }\n        app.getItemAsync(itemId, undefined, true, true).done(function (updatedItem) {\n            matrixSession.updateWatchItemVersion(itemId, updatedItem.maxVersion);\n            res.resolve( );\n        }).fail( function() {\n            // nothing i wan't to do...\n            res.reject();\n        });\n        return res;\n    }\n\n    // *********************************************\n    // calls from database to update tree or item\n    // *********************************************\n\n    removedFromTree(itemId:string, parentId:string) : void  {\n        // called after an item has been deleted\n\n        // make sure trees get informed (and remove it)\n        NavigationPanel.remove(itemId);\n        // select the parent\n        if (this._itemId === itemId) {\n            this._itemId = parentId;\n            this.treeSelectionChangeAsync(this._itemId).done(function () {\n            }).fail(function () {\n\n        });\n        }\n    }\n\n    insertInTree(newItem:IDBParent) : void  {\n        if (newItem.item.children) {\n            // 'inherit' folder icon from parent\n            newItem.item.icon = this.dbConnection.getIcon(newItem.parent);\n        }\n\n        // make sure trees get informed)\n        NavigationPanel.insertInTree(newItem);\n    }\n\n    // replaces the target, a child inside the target or creates a new child with source\n    copyFrom(target:string, source:IDB):void {\n\n        if (this.dbConnection.copyFrom(target, source)) {\n            // make sure trees get informed\n            NavigationPanel.insertUpdateTreeRec(target, source);\n        }\n    }\n\n\n    updateCache(newItem: IUpdateCache):void {\n        this.dbConnection.updateCache(newItem);\n    }\n\n    // *********************************************\n    // helper functions\n    // *********************************************\n\n    createItemUrl(itemId?:string, crossProject?:string):string {\n\n        return globalMatrix.matrixBaseUrl + \"/\" + (crossProject ? crossProject : matrixSession.getProject()) + (itemId ? (\"/\" + itemId) : \"\") + window.location.search;\n    }\n\n    renderItem(cachedItem?:IItem):void {\n\n        if (!matrixSession.duringBrowserNavigation && this.lastState !== this._itemId) {\n            this.lastState = this._itemId;\n            window.history.pushState(null, null, this.createItemUrl(this._itemId));\n        }\n\n        globalMatrix.projectStorage.setItem('SessionLastItem', this._itemId);\n        var folderType = this.dbConnection.getType(this._itemId);\n\n        matrixApplicationUI.createControl(folderType, this._itemId, this.itemChanged.bind(this), cachedItem);\n    }\n\n    print():void {\n        window.print();\n    }\n\n    touchAsync(itemOrFolderId:string, depth:number):JQueryDeferred<string> {\n        let that = this;\n\n        var res = $.Deferred();\n        matrixSession.getCommentAsync().done(function (comment) {\n\n            that.dbConnection.touchAsync(itemOrFolderId, depth, comment).done(function (result) {\n                that.renderItem();\n                res.resolve(result);\n            }).fail( function (error){\n                res.reject(error);\n            });\n        }).fail( function (error){\n            res.reject(error);\n        });\n        return <any>res;\n    }\n    // saves item, but instead of getting labels from ui, it uses the passed on values\n    setLabels(newLabels:IItemGet):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        if (matrixApplicationUI.lastMainItemForm) {\n            matrixApplicationUI.lastMainItemForm.saveAsync(null, \"reviewed\", newLabels).then(function (result: IItem) {\n                that.setHiddenLink(result.id, result.isUnselected);\n                that.renderItem(result);\n                res.resolve();\n            }).catch(function () {\n                res.reject();\n            });\n        } else {\n            res.resolve();\n        }\n        return res;\n    }\n\n    needsSave():boolean{\n        return this._needsSave;\n    }\n\n\n    signItemAsync(itemId:string, password:string, meaning?:string ):JQueryDeferred<XRPostProject_SignItem_SignItemAck> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        matrixSession.getCommentAsync().done(function (comment) {\n\n            that.dbConnection.signItemAsync(itemId, password, comment, meaning).done(function (result) {\n                res.resolve(result);\n            }).fail( function (error){\n                res.reject(error);\n            });\n        }).fail( function (error){\n            res.reject(error);\n        });\n\n        return <any>res;\n    }\n\n    checkPassword(password: string): JQueryDeferred<IRestResult> {\n        return this.dbConnection.checkPassword(password);\n    }\n\n    convertDocAsync(fileNo:number, targetDocumentFolder?:string, useOriginal?:boolean):JQueryDeferred<string> {\n        let that = this;\n\n        var res = $.Deferred();\n\n\n        that.dbConnection.convertDocAsync(fileNo, \"import for conversion\", targetDocumentFolder, useOriginal).done(function (result) {\n            res.resolve(result);\n\n        }).fail( function (error){\n            res.reject(error);\n        });\n\n        return <any>res;\n    }\n\n    pingCurrentItem():void {\n        let that = this;\n\n        // do not ping special items like -1,-2,-3 (virtual folders)\n        if (this._itemId && this._itemId.indexOf(\"-\") !== 0 && ! ml.UI.widgetPluginsContainer.visible) {\n            var type = this.dbConnection.getType(this._itemId);\n            if (type[0] !== \"_\") {\n                // in case the type is a valid category get this setting (if not it will just return null, which is fine to)\n                let concurrentEdit = <any>globalMatrix.ItemConfig.getCategorySetting(type, \"concurrentEdit\");\n                if (concurrentEdit && concurrentEdit.disabled) {\n                    // if concurrent editing is possible (warning the flag is kind of negated) no need to do something\n                    return;\n                }\n                // don't ping special meta folders like _PROJECT\n                this.getItemAsync(this._itemId).done(function (item) {\n                    that.updateItem(item);\n                });\n            }\n        }\n    }\n\n    getCurrentItemId() :string {\n        return this._itemId;\n    };\n\n    /** sessions */\n\n    commitChangeListAsync(changeList: IReferenceChange[]):JQueryDeferred<{}> {\n        var res = $.Deferred();\n        matrixSession.startCommitTransaction();\n        this.commitChangeListRec(changeList, 0).done(function () {\n            matrixSession.stopCommitTransaction();\n            res.resolve();\n        }).fail(function (error, stepsDone) {\n            matrixSession.stopCommitTransaction();\n            res.reject(error, stepsDone);\n        });\n        return res;\n    }\n\n    /**\n     *  product variations\n     * */\n\n    isMedical(strict?:boolean):boolean {\n        if (globalMatrix.matrixProduct.toLowerCase() === \"medical\") {\n            return true;\n        }\n        if (strict) {\n            return false;\n        }\n        return globalMatrix.matrixProduct.toLowerCase() === \"tachyscp\";\n    }\n\n    commentRequired( ):boolean {\n        return this.isMedical();\n    }\n    touchToolAvailable(item:IItem):boolean {\n        if (item.cloneSource) return false;\n        return this.canEditItem(item) && this.isMedical();\n    }\n    auditTrailAvailable( ):boolean {\n        return this.isMedical();\n    }\n\n    mailToolAvailable( ):boolean {\n        return this.isMedical();\n    }\n\n    postLogin( user:string ) : void  {}\n\n    canDeleteItem(item:IItem):boolean {\n        if (!matrixSession.isEditor() || !globalMatrix.ItemConfig.canDelete(item.type)) {\n            return false;\n        }\n\n        if (this.isIncluded(item)) {\n            return false;\n        }\n\n        return true;\n    }\n\n    canViewItem(item:IItem):boolean  {\n\n        return true;\n    }\n\n    canEditItem(item:IItem ):boolean  {\n        if (!matrixSession.isEditor() || !globalMatrix.ItemConfig.canEdit(item.type)) {\n            return false;\n        }\n        return true;\n    }\n\n    canCreateItemType(category:string, folder?:boolean):boolean {\n        if (!matrixSession.isEditor() && !globalMatrix.ItemConfig.canCreate(category)) {\n            return false;\n        }\n\n        return true;\n    }\n\n    canDragDrop(category:string, id:string):boolean {\n        if (!matrixSession.isEditor() || !globalMatrix.ItemConfig.canMove(category)) {\n            return false;\n        }\n\n        return true;\n    }\n    // to overwrite default drag and drop\n    dragEnter?:(dragged:Fancytree.FancytreeNode, target:Fancytree.FancytreeNode) => string[]|boolean;\n\n    canSeeField(category:string, field:number):boolean {\n        return true;\n    }\n\n    canEditField(category:string, field:number):boolean {\n\n        return true;\n    }\n\n    private refreshUIAsync(fromId:string, toId?:string):void {\n        let that = this;\n\n        clearTimeout(this.forceUIRefreshTimer);\n        this.forceUIRefreshTimer = window.setTimeout(function () {\n            // refresh - but only if an item is still selected...\n            if ( that._itemId  === fromId ||  (toId && that._itemId  === toId )) {\n\n                that.getItemAsync(that._itemId).done(function (result:IItem) {\n                    that.updateItem(result);\n                    plugins.updateItem(result);\n                });\n            }\n        }, 1000);\n    }\n    // return null if there is no project trace_config setting (project before 1.5, not upgraded)\n    // if not return an jsob object with all trace information for the item\n    evaluateTraceRule(item:IItem, checkDownRule:boolean):ITraceRules {\n\n        var tc = globalMatrix.ItemConfig.getTraceConfig();\n        if (!tc) {\n            return null;\n        }\n\n        var result:ITraceRules = {\n            valid: true, // in case any must_have rule is not followed this is false\n            mustHaveCategories: [], // all categories which are in a must have rule\n            canHaveCategories: [], // all categories which are in a can have rule\n            exstingCategories: [], // all categories which are curently linked to item\n            missingMustHaveCategories: [], // all categories which must be linked but are not\n            missingCanHaveCategories: [], // all categories which can be linked but are not\n            outdatedReferences: []\n        };\n\n        if (!item || !item.modDate) {\n            // this can happen during item creation... no worries, we cannot create links\n            return result;\n        }\n\n        var itemDate = new Date(item.modDate);\n        // build a list of all existing up or downlink categories\n        // and a list of all out dated references\n        var existing = checkDownRule ? item.downLinks : item.upLinks;\n        if (existing) {\n            $.each(existing, function (idx, link) {\n                // list of existing categories\n                var cat = ml.Item.parseRef(link.to).type;\n                if (result.exstingCategories.indexOf(cat) === -1) {\n                    result.exstingCategories.push(cat);\n                }\n                // list of outdated links\n                var refDate = new Date(link.modDate);\n                if ((checkDownRule && itemDate > refDate) || (!checkDownRule && itemDate < refDate)) {\n                    result.outdatedReferences.push(link.to);\n                }\n            });\n        }\n\n        // get the up/down rule from project setting\n        var updown:ITraceConfigRule[];\n        $.each(tc.rules, function (ruleIdx, rule) {\n            if (rule.category === item.type) {\n                updown = checkDownRule ? rule.down_rules : rule.up_rules;\n            }\n        });\n\n        if (!updown) {\n            // no rules.. results are complete: no mustHaveCategories, no canHaveCategories, missingCategories\n            return result;\n        }\n\n        $.each(updown, function (updownIdx:number, updownRule:ITraceConfigRule) {\n            if (updownRule.rule === \"must_have\" && updownRule.any_of) {\n                var hasMustHave = false;\n                $.each(updownRule.any_of, function (anyIdx:number, anyOf:string) {\n                    // add to must have\n                    if (result.mustHaveCategories.indexOf(anyOf) === -1) {\n                        result.mustHaveCategories.push(anyOf);\n                    }\n                    // check if rule is followed\n                    if (result.exstingCategories.indexOf(anyOf) !== -1) {\n                        hasMustHave = true;\n                    }\n                });\n                if (!hasMustHave) {\n                    // problem: a must have rules is not followed\n                    // add categories to missing categoires\n                    $.each(updownRule.any_of, function (anyIdx, any) {\n                        if (result.missingMustHaveCategories.indexOf(any) === -1) {\n                            result.missingMustHaveCategories.push(any);\n                        }\n                    });\n                    result.valid = false;\n                }\n            }\n            if (updownRule.rule === \"can_have\" && updownRule.any_of) {\n                var hasCanHave = false;\n                $.each(updownRule.any_of, function (anyIdx:number, anyOf:string) {\n                    // add to can have\n                    if (result.canHaveCategories.indexOf(anyOf) === -1) {\n                        result.canHaveCategories.push(anyOf);\n                    }\n                    // check if rule is followed\n                    if (result.exstingCategories.indexOf(anyOf) !== -1) {\n                        hasCanHave = true;\n                    }\n                });\n                if (!hasCanHave) {\n                    // problem: a must have rules is not followed\n                    // add categories to missing categoires\n                    $.each(updownRule.any_of, function (anyIdx:number, anyOf:string) {\n                        if (result.missingCanHaveCategories.indexOf(anyOf) === -1) {\n                            result.missingCanHaveCategories.push(anyOf);\n                        }\n                    });\n                }\n            }\n        });\n\n        return result;\n\n    }\n\n    private commitChangeListRec(changeList: IReferenceChange[], todo:number):JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n        if (todo >= changeList.length) {\n            // all done!\n            res.resolve(null, todo);\n        } else {\n            if (changeList[todo].action === 'removeLink') {\n                this.removeDownLinkAsync(changeList[todo].fromId, changeList[todo].toId).done(function () {\n                    that.commitChangeListRec(changeList, todo + 1).done(function () {\n                        res.resolve();\n                    }).fail(function (error, done) {\n                        res.reject(error, done);\n                    });\n                }).fail(function () {\n                    res.reject(\"Could not remove link from \" + changeList[todo].fromId + \" to \" + changeList[todo].toId, todo);\n                });\n            } else if (changeList[todo].action === 'addLink') {\n                this.addDownLinkAsync(changeList[todo].fromId, changeList[todo].toId).done(function () {\n                    that.commitChangeListRec(changeList, todo + 1).done(function () {\n                        res.resolve();\n                    }).fail(function (error, done) {\n                        res.reject(error, done);\n                    });\n                }).fail(function (jqxhr, textStatus, error) {\n                    res.reject(\"Could not add link from \" + changeList[todo].fromId + \" to \" + changeList[todo].toId, todo);\n                });\n            }\n        }\n        return res;\n    }\n    public static getProjectIcon(customLogo:string , alternateValue=\"\")\n    {\n        if( customLogo && customLogo.indexOf(\"{\") !== -1)\n        {\n            var rjs = ml.JSON.fromString(customLogo);\n            if (rjs.status === 'ok') {\n            \treturn (<any>rjs).value.logoId?(<any>rjs).value.logoId:alternateValue;\n            }\n        }\n        return alternateValue;\n\n    }\n\n    public static getProjectLogo(customLogo:string)\n    {\n        var rjs = ml.JSON.fromString(customLogo);\n        if (rjs.status === 'ok') {\n            return  (<any>rjs).value.fileId?(<any>rjs).value.fileId:\"\";\n        } else {\n           return customLogo; // legacy\n        }\n    }\n\n\n}\n\n","import { IDBParent } from \"./DBCache\";\n\nimport { ProjectStorage } from \"../../client/ProjectStorage\";\nimport { PushMessages, IItemWatched } from \"./PushMessages\";\nimport { ml } from \"./../matrixlib\";\nimport { NavigationPanel } from \"../UI/MainTree/MainTree\";\nimport { TokenControl } from \"../UI/Parts/TokenControl\";\nimport { userControls, ITokenConfig } from \"../UI/Parts/UserControl\";\nimport { IProjectGroups, INotificationConfig, notificationSetting, defaultNotificationConfig, IDeletedProjects, IMailConfig, mailConfigSetting } from \"../../ProjectSettings\";\nimport { XRProjectType, XRUserPermissionType, XRGetProject_StartupInfo_ListProjectAndSettings, XRTodoCount, XRTodo, XRMainAndBranch } from \"../../RestResult\";\nimport { NotificationList } from \"../../client/plugins/Notifications\";\nimport { ProjectStorageMobile } from \"../../mobile/ProjectStorageMobile\";\nimport { IDashboardConfig } from \"../../WidgetDashboard/WidgetPluginsContainer\";\nimport { plugins } from \"./PluginManager\";\nimport { UIToolsConstants } from \"../matrixlib/MatrixLibInterfaces\";\nimport { mTasks } from \"./Tasks\";\nimport { IStringMap, globalMatrix, matrixApplicationUI, matrixSession, IAnyMap, app, restConnection, IItem } from \"../../globals\";\nimport { ItemConfiguration } from \"./ItemConfiguration\";\nimport { mTM } from \"./TestManager\";\nimport { NotificationsBL } from \"./NotificationsBL\";\n\nexport type {\n    IGetProjectResult, IGetProjectResultSetting, IGetProjectResultDateInfo, IGetProjectResultDateInfos,\n    ICustomerSettingString, ICustomerSettingJSON, IPostLoginResult, IPostLoginResultUserDetail, ICompanyUISettings,\n    ICompanyTiny, ICompanyTinyMenuMap, ICompanyTinyMenu\n};\nexport { MatrixSession };\n\ninterface IGetProjectResult { settings: IGetProjectResultSetting[], currentUser: string, customerAdmin: number, superAdmin: number, dateInfo: IGetProjectResultDateInfo, customerSettings: IGetProjectResultSetting[], project: XRProjectType[] }\ninterface IGetProjectResultSetting { key: string, value: string }\ninterface IGetProjectResultDateInfo { timeformat: string, dateformat: string, timeZone: string, customerDateformat: string, customerTimeformat: string, customerTimezone: string, dateIso8601: string, timeUserFormat: string }\ninterface IGetProjectResultDateInfos { key: string, value: string }\ninterface ICustomerSettingString { [key: string]: string }\ninterface ICustomerSettingJSON { [key: string]: {} }\ninterface IPostLoginResult { actualLogin: string, userId: number, userDetails: IPostLoginResultUserDetail, maxAge: number }\ninterface IPostLoginResultUserDetail {\n    id: number, login: string,\nemail:string,firstName:string,lastName:string,signatureImage:number,customerAdmin:number,\npasswordAgeInDays:number,badLogins:number,badLoginsBefore:number,superAdmin:number,\nuserSettingsList:IGetProjectResultSetting[]}\n\ninterface ICompanyUISettings {\n    /** allow to add links to locked items */\n    allowAddLinkToLocked?:boolean\n    /** if true the save button is always on the left */\n    saveLeft?:boolean\n    /** if set to true, auto clean the input of text fields */\n    purify?:boolean\n    /** editor setting */\n    tiny?:ICompanyTiny // tinymce settings\n    /** always use new editor (also for old projects) */\n    tinyAsDefault?: boolean // true if tiny editor should be used as default\n    /** true if user should be able to switch from editor to tiny per field */\n    tinyUpgradeOption?: boolean\n    /** how many items to show in list view (after running searches, default 200) */\n    maxHits?:number,\n    /** bigger scale = sharper drawio images in PDF, default is 3 */\n    drawIOScale?:boolean\n    /** @experimental: Enable the widget dashboard on instance root */\n    widgetDashboardOption?:boolean\n    /** internal: url of draw io editor */\n    drawioURL?: string // can be used to overwrite the default drawio url (on their server)\n    /** @experimental: if set to anything > 0 the fields in a form are rendered in a non blocking way if there are more than largeFormRender fields */\n    largeFormRender?:number\n    /** @internal beta - do not auto select parents if single item is selected for DOC */\n    preciseDocSelect?:boolean\n    /** @internal obsolete */\n    legacyPrint?:boolean, // allows viewing print preview\n    /** @internal obsolete */\n    legacyUserDropdown?:number // show normal user drop down in user select in table\n    /** @internal obsolete */\n    legacyKeepFolder?:boolean  // don't select a created folder after creation\n\n\n}\ninterface ICompanyTiny { // tinymce settings\n    /** true if browser context menu should be used as default */\n    tinyHideMenu?: boolean\n    /** enable or disable editor plugins */\n    plugins?:string [] // list of plugins to use\n    /*  plugins to add to (default) list  */\n    extraPlugins?:string []\n    /** toolbar definition */\n    toolbar?: string, // toolbar\n    /** menubar definition  default: edit view insert format table matrix */\n    menubar?: string // menu bar\n    /** menu entries can be used to change default menus or add details of new menu bar */\n    menu?: ICompanyTinyMenuMap // menu bar\n    /** allows to overwrite any default setting (e.g. misc: { \"table_toolbar\": \"\"} )  to hide table toolbar */\n    misc?: any\n    /** html entities to accept in text */\n    extended_valid_elements?: string\n    /**  optional: formats in Paragraph menu (for docs) */\n    block_formats_doc?:any\n    /** optional: rules for formats (for docs) */\n    apply_formats_doc?:any\n    /** optional: formats in style menu (for docs) */\n    style_formats_doc?:any\n    /** optional: formats in Paragraph menu (for items) */\n    block_formats?:any\n    /** optional: rules for formats (for items)  */\n    apply_formats?:any\n    /** optional: formats in style menu (for items) */\n    style_formats?:any\n    /** elements which don't need content (e.g. a TD cell can be empty, needs to be the complete list) */\n    short_ended_elements?: string\n    /** a custom css name/path */\n    css?: string,\n    /** if true it used dom purify to super clean the html */\n    dompurify?: boolean\n    /** requires textpattern plugin! see https://www.tiny.cloud/docs/plugins/opensource/textpattern/ */\n    textpattern_patterns? : any[]\n}\n\n\ninterface ICompanyTinyMenuMap { [key: string]: ICompanyTinyMenu }\n\ninterface ICompanyTinyMenu {\n    /** display name of menu */\n    title: string,\n    /** items to show */\n    items: string\n}\n\nclass MatrixSession {\n\n\n\n\n    private CurrentUser = \"\";\n    private CurrentProject:string;\n    private CurrentComment:string;\n    private customerAdmin:boolean = false;\n    private superAdmin:boolean = false;\n    private dateInfo:IGetProjectResultDateInfo;\n    private customerSettingsString:ICustomerSettingString;\n    private customerSettingsJSON:ICustomerSettingJSON;\n    private ProjectList: XRProjectType[];\n    private CommitTransaction:boolean;\n    private CommitTransactionComment:string;\n    private CommitTransactionCancelled:boolean;\n    private postConnect:any;\n    public duringBrowserNavigation:boolean = false;\n    private userPermissions: XRUserPermissionType[];\n    private licensedModules:string[];\n    public lastManualComment:string = \"\";\n    public serverConfig:XRGetProject_StartupInfo_ListProjectAndSettings;\n\n    public pushMessages:PushMessages;\n    private customParams: IStringMap = {};\n    private branches:XRMainAndBranch[];\n\n    quiet ():boolean {\n        return typeof globalMatrix.jiraPlugin !== \"undefined\"\n    }\n\n    constructor() {\n\n        console.log(\"Matrix session constructor\");\n        let that = this;\n\n        window.addEventListener(\"message\", this.receiveMessage, false);\n\n        this.licensedModules=[];\n        matrixApplicationUI.updateMainUI(true);\n\n        $.ajaxPrefilter(function(options:{beforeSend:Function}){\n            if (!options.beforeSend) {\n                options.beforeSend = function (xhr:JQueryXHR ) {\n                    var csrfToken = that.getCsrfCookie();\n                    xhr.setRequestHeader('x-csrf', csrfToken);\n                };\n            }\n        });\n        this.tryReconnect().done(function () {\n            // a session exists (e.g. F5 was pressed or a new url entered)\n            // a list of project from this server is known and stored in ProjectList\n            // the comment is the last one shown in the UI, should be reused in other tabs\n\n            that.CurrentComment = localStorage.getItem(\"CurrentComment\");\n            that.updateUI(false );\n        });\n\n    }\n\n    public getCsrfCookie(): string {\n        var csrfToken = (<any>($)).cookie(\"csrf\"); // i put that in the call to get the latest cookie with each request (see B below)\n        return csrfToken;\n    }\n\n    startCommitTransaction() {\n        this.CommitTransaction = true;\n        this.CommitTransactionComment = \"\";\n        this.CommitTransactionCancelled = false;\n    }\n\n    stopCommitTransaction() {\n        this.CommitTransaction = false;\n        this.CommitTransactionComment = \"\";\n        this.CommitTransactionCancelled = false;\n    }\n\n    getUser() {\n        return this.CurrentUser;\n    }\n\n    setUser(login:string) {\n        this.CurrentUser = login ? login.toLowerCase() : \"\";\n    }\n\n    private setDateInfo( di:IGetProjectResultDateInfo ) {\n        this.dateInfo = di;\n        ml.UI.DateTime.initDateTimeSettings();\n    }\n\n    getDateInfo():IGetProjectResultDateInfo {\n        return this.dateInfo;\n    }\n\n    private setCustomerSettings(customerSettings:IGetProjectResultSetting[]) {\n        let that = this;\n        this.customerSettingsString = {};\n        this.customerSettingsJSON = {};\n        if (customerSettings) {\n            $.each(customerSettings, function (idx:number, setting:IGetProjectResultSetting) {\n                that.customerSettingsString[setting.key] = setting.value;\n                if (setting.key !== \"js_plugins\" &&  setting.value && setting.value.indexOf('{') !== -1) {\n                    // assume it a json\n                    var val = ml.JSON.fromString(setting.value);\n                    if (val.status === \"ok\") {\n                        that.customerSettingsJSON[setting.key] = val.value;\n                    }\n                }\n            });\n        }\n    }\n\n    setCustomerSettingJSON(s:string, setting:{}) {\n        this.customerSettingsJSON[s] = setting;\n    }\n\n\n    getCustomerSetting(s:string):string {\n        return this.customerSettingsString[s];\n    }\n\n    getCustomerSettingJSON(s:string, defaultValue?:{}):any {\n        return this.customerSettingsJSON[s]?this.customerSettingsJSON[s]:defaultValue;\n    }\n\n    getMailSettings(): IMailConfig {\n        let projectMailConfig = globalMatrix.ItemConfig.getMailConfig();\n\n        let serverMailConfig: IMailConfig = this.getCustomerSettingJSON(mailConfigSetting, { canned: {} });\n\n        if (projectMailConfig != undefined && projectMailConfig.canned != undefined) {\n            for (let key in projectMailConfig.canned) {\n                serverMailConfig.canned[key] = projectMailConfig.canned[key];\n            }\n        }\n\n        if (projectMailConfig != undefined && projectMailConfig.defaultCC != undefined) {\n            serverMailConfig.defaultCC = projectMailConfig.defaultCC;\n        }\n\n        return serverMailConfig;\n    }\n\n    getUISettings(defaultValues?:{}):ICompanyUISettings {\n        let ui: ICompanyUISettings = <ICompanyUISettings>matrixSession.getCustomerSettingJSON(\"ui\", {});\n        if (defaultValues) {\n\n            $.each(defaultValues, function( key, defaultValue) {\n                if ((<IAnyMap>ui)[key] == undefined)    {\n                    (<IAnyMap>ui)[key]=defaultValue;\n                }\n            });\n        }\n        return ui;\n    }\n\n    setUISetting(setting:string, value:any) {\n        let that = this;\n\n        let ui = <IAnyMap>matrixSession.getCustomerSettingJSON(\"ui\", {});\n        ui[setting] = value;\n\n        app.setSettingCustomerJSON(\"ui\", ui).done(function () {\n            console.log(\"New setting\");\n            console.log(ui);\n            that.customerSettingsJSON[setting] = ui;\n        }).fail( function() {\n            console.log(\"Error applying setting\");\n        })\n    }\n    showUISettings() {\n        let ui = matrixSession.getCustomerSettingJSON(\"ui\", {});\n        console.log(ui);\n    }\n    isEditor():boolean {\n        return globalMatrix.ItemConfig.hasWriteAccess(this.getUser());\n    }\n\n    isCustomerAdmin():boolean {\n        return this.customerAdmin;\n    }\n\n\n\n    isSuperAdmin():boolean {\n        return this.superAdmin;\n    }\n    // super admin or customer admin\n    isAdmin():boolean {\n        return this.isCustomerAdmin() || this.isSuperAdmin();\n    }\n    getProject():string {\n        return this.CurrentProject;\n    }\n    setProject(projectId:string) {\n        // this should (only be used by JIRA plugin)\n        this.CurrentProject = projectId;\n    }\n\n    getCommentAsync():JQueryDeferred<string> {\n        let that = this;\n        var res = $.Deferred();\n        // get errors is comment needs ticked id\n        var commentNeedsTicket: string[] = mTasks ? mTasks.evaluateTaskIds(matrixSession.getComment()) : [];\n\n        if (this.CurrentComment && commentNeedsTicket.length === 0) {\n            res.resolve(this.CurrentComment);\n        } else if (this.CommitTransaction && this.CommitTransactionComment) {\n            res.resolve(this.CommitTransactionComment);\n        } else if (!app.commentRequired()) {\n            res.resolve(\"no comment specified\");\n        } else {\n            if ( commentNeedsTicket.length > 0 ) {\n                ml.UI.showError(\"You need a comment with a ticket id!\" , commentNeedsTicket.join(\" \") );\n            }\n            let oked = false;\n\n\n            ml.UI.showDialogDes( {\n                container:$(\"#saveDlg\"),\n                minMaxHeight: -350,\n                minMaxWidth:-500,\n                buttons: [{\n                    text:'Save',\n                    class:'btnDoIt',\n                    click:function () {\n                        oked = true;\n                        var comment = $(\"#commentDlgTextSave\").val().replace(/</g,\"&lt;\");\n                        // remember for automation\n                        that.lastManualComment = comment;\n\n                        commentNeedsTicket = mTasks?mTasks.evaluateTaskIds(comment):[];\n\n                        if (!comment && app.commentRequired()) {\n                            ml.UI.showError(\"Comment required!\", \"\");\n                        } else  if ( commentNeedsTicket.length > 0 ) {\n                            ml.UI.showError(\"You need a comment with a ticket id!\" , commentNeedsTicket.join(\" \") );\n                        } else  {\n                           if ($(\"#idSessionComment\").prop('checked')) {\n                                that.setComment($(\"#commentDlgTextSave\").val().replace(/</g,\"&lt;\"));\n                            }\n                            if (that.CommitTransaction) {\n                                that.CommitTransactionComment = $(\"#commentDlgTextSave\").val().replace(/</g,\"&lt;\");\n                            }\n                            $(\"#saveDlg\").dialog(\"close\");\n                            res.resolve($(\"#commentDlgTextSave\").val().replace(/</g,\"&lt;\"));\n                        }\n                    }\n                },{\n                    text:'Cancel',\n                    class:'btnCancelIt',\n                    click:function () {\n                        $(\"#saveDlg\").dialog(\"close\");\n                    }\n                }],\n                title:\"Enter a change comment to save\",\n                onOpen: () =>  {\n                    let dl = $(\"#saveDlg\").closest(\".ui-dialog\").addClass(\"saveDlg\");\n                    dl[0].style.setProperty( 'z-index', '20000', 'important' );\n                    $(\"#commentDlgTextSave\").val(that.getComment().replace(/&lt;/g,\"<\")).focus();\n                },\n                onClose: () => {\n                    if (!oked) {\n                        if (that.CommitTransaction) {\n                            that.CommitTransactionCancelled = true;\n                        }\n                        res.reject(that.CommitTransactionCancelled);\n                    }\n                },\n                onResize: () => {\n                    $(\"#saveDlg\").css(\"width\",\"100%\");\n                }\n            });\n\n        }\n\n        return <any>res;\n    }\n\n    getComment():string {\n        var comment = this.CurrentComment ? this.CurrentComment : \"\";\n        return comment;\n    }\n\n    private makeTeaser(comment?:string):string {\n        if (!comment || comment.length < 30)\n        {\n            return comment;//.replace(/</g,\"&lt;\");\n        }\n        return (comment.substring(0, 30 - 3) + \"...\");//.replace(/</g,\"&lt;\");\n    }\n\n    getCommentTeaser():string {\n        return this.makeTeaser(this.getComment());\n    }\n\n    setComment(comment?:string, internal?:boolean) {\n        this.CurrentComment = comment ? comment : \"\";\n        $(\"#comment\").val(this.getComment().replace(/&lt;/g,\"<\"));\n\n        if (!this.isConfigClient()) {\n            localStorage.setItem(\"CurrentComment\", this.CurrentComment);\n        }\n\n        if (comment && !internal) {\n            var newComments:string[] = [];\n            newComments.push(comment);\n            var lastComments = this.getLastComments();\n            for (var idx = 0; idx < lastComments.length && idx < 9; idx++) {\n                var exists = false;\n                for (var ni = 0; ni < newComments.length; ni++) {\n                    exists = exists || (newComments[ni] === lastComments[idx]);\n                }\n                if (!exists) {\n                    newComments.push(lastComments[idx]);\n                }\n            }\n            globalMatrix.serverStorage.setItem(\"lastComments\", JSON.stringify(newComments));\n        }\n        $(\"#comment\").change();\n    }\n\n    isGroup() {\n        return this.licensedModules.indexOf( \"qms\") != -1 || this.licensedModules.indexOf( \"acl\") != -1|| this.licensedModules.indexOf( \"groups\") != -1;\n    }\n\n    isQMS() {\n        return this.licensedModules.indexOf( \"qms\") != -1;\n    }\n    isCompose() {\n        return this.licensedModules.indexOf(\"resync\") != -1;\n    }\n    isUnique() {\n        return globalMatrix.matrixUniqueSerial == \"true\";\n    }\n    isMerge() {\n        return this.licensedModules.indexOf( \"merge\") != -1;\n    }\n    isReview() {\n        return this.licensedModules.indexOf( \"review\") != -1;\n    }\n    isACL() {\n        return this.licensedModules.indexOf( \"acl\") != -1;\n    }\n    isQMSProject(project?:string) {\n        if (!project) {\n            project = this.getProject();\n        }\n        for (var idx=0;idx<this.ProjectList.length;idx++) {\n            if (this.ProjectList[idx].shortLabel == project) return this.ProjectList[idx].qmsProject;\n        }\n        return false;\n    }\n    limitAdmin() {\n        return this.licensedModules.indexOf( \"limitadmin\") == -1;\n    }\n    hasRisks() {\n        return this.licensedModules.indexOf( \"risk\") != -1;\n    }\n    hasVariants() {\n        return this.licensedModules.indexOf( \"labels\") != -1;\n    }\n    hasDocs() {\n        return this.licensedModules.indexOf( \"doc\") != -1;\n    }\n    hasAgileSync() {\n        return this.licensedModules.indexOf( \"agilerocks\") != -1;\n    }\n\n    private setModules(startupInfo:XRGetProject_StartupInfo_ListProjectAndSettings) {\n        this.licensedModules = startupInfo.license.options;\n    }\n    private getLastComments():string[] {\n        var lastComments = globalMatrix.serverStorage.getItem(\"lastComments\");\n        if (!lastComments) {\n            return [];\n        }\n        else {\n            return JSON.parse(lastComments);\n        }\n    }\n\n    tryReconnect():JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        this.updateSettings().done( function() {\n            res.resolve();\n        }).fail( function() {\n            plugins.initServerSettings();\n            that.requestLogin(res);\n        });\n        return res;\n    }\n    signInAfterTimeout():JQueryDeferred<{}> {\n        let that = this;\n        var res = $.Deferred();\n        this.requestLogin(res);\n        return res;\n    };\n\n    triggerLoginWithDialog() {\n        let that = this;\n        app.canNavigateAwayAsync().done(function () {\n            let res = $.Deferred();\n            res.done( function( ) {\n                if ( that.isConfigClient() ) {\n                    app.postLogin(that.getUser());\n                } else {\n                    that.updateUI();\n                    that.loadProject(null, location.href);\n                }\n            });\n            that.requestLogin(res);\n        }).fail(function () {\n            ml.UI.showError(\"You have unsaved changes.\", \"Save or cancel before signing out.\");\n        });\n    };\n\n    changePassword() {\n        userControls.editUserDetails(\"useredit\", this.getUser(), function () {\n        }, function () {\n\n        });\n    }\n\n    getProjectList(readOrWriteOnly:boolean) {\n        return readOrWriteOnly?this.ProjectList.filter(function(project) {return project.accessType==\"write\"||project.accessType==\"read\";}):this.ProjectList;\n    }\n\n    // return true if a user has access to a given project\n    canSeeProject(project:string) {\n        let rw = this.getProjectList(true);\n        for (var idx = 0; idx < rw.length; idx++) {\n            if (rw[idx].shortLabel === project) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    private changeToken() {\n\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n        let ui = $(\"<div style='height:100%;width:100%'>\");\n        let currentToken =  $(\"<div>\").appendTo(ui);\n        TokenControl.showUserTokens(currentToken, matrixSession.getUser());\n        ml.UI.showDialog(dlg, \"Access Tokens\", ui, $(document).width() * 0.9, app.itemForm.height() * 0.9,\n        [{\n            text: 'OK',\n            class: 'btnDoIt',\n            click: function () {\n                dlg.dialog(\"close\");\n            }\n            }], UIToolsConstants.Scroll.Vertical, true, true, () => { dlg.remove(); }, () => { }, () => { }\n        );\n    }\n\n    public setProjectColor(projectShort:string, color:string)\n    {\n       let projectColors = <IStringMap> this.getCustomerSettingJSON(\"projectColors\", {});\n       projectColors[projectShort] = color;\n       this.setCustomerSettingJSON(\"projectColors\",projectColors)\n    }\n    public getProjectColor(projectShort:string)\n    {\n         let projectColors = <IStringMap> this.getCustomerSettingJSON(\"projectColors\", {});\n         if( projectColors[projectShort] != undefined )\n            return projectColors[projectShort];\n        else\n            return   ml.UI.calculateColorFrom(projectShort).color\n\n    }\n\n    public getImgFromProject(pRef:string,offsetTop=7):string\n    {\n        let that = this;\n        let color = that.getProjectColor(pRef);\n        let img = `<div class=\"project-icon\" style=\"background:${color};margin-top:${offsetTop}px; \"> <div></div></div>`\n        return img\n    }\n    private createProjectSelectLink(pRef:string,pName:string, branchParents:IStringMap, lastParent:string[]) {\n        let that = this;\n        let li = $(\"<li>\");\n        let img = that.getImgFromProject(pRef,2);\n        var link = $(\"<span class='mainmenu'>\" + pRef + \" - \" + pName + \"</span>\");\n        li.click(function(e: JQueryEventObject) {\n\n            $(\".navbar-collapse.in\").removeClass(\"in\").addClass(\"collapse\"); // for phones, hide menu\n            var project = $(e.delegateTarget).data(\"projectid\");\n              app.canNavigateAwayAsync().done(function () {\n                if(  ml.UI.widgetPluginsContainer &&  ml.UI.widgetPluginsContainer.visible)\n                    ml.UI.widgetPluginsContainer.exit(globalMatrix.matrixBaseUrl + \"/\" + project);\n\n                that.loadProject(project);\n\n            }).fail(function () {\n\n            });\n        }).data(\"projectid\", pRef);\n\n        if (branchParents[pRef]) {\n            if (lastParent.length && lastParent[0] == branchParents[pRef]) {\n                li.css(\"padding-left\", \"58px\");\n                li.find(\".project-icon\").css(\"left\", \"44px\");\n                //li.append($(`<span class=\"fal fa-code-merge\">`));\n            }\n        } else {\n            lastParent.splice( 0, 0, pRef);\n        }\n        li.append($(img));\n        li.append(link);\n        return li;\n\n    }\n\n    public amIAllowedUser(limitedTo: string[]) {\n        let all = limitedTo ? limitedTo : [];\n        if (all.length == 0) {\n            // no limits\n            return true;\n        }\n\n        if (this.isSuperAdmin()) {\n            return true;\n        }\n\n        if (all.indexOf(this.getUser()) != -1) {\n            // I am a explicitly named user!\n            return true;\n        }\n\n        let userCanDo = false;\n        for (let userGroup of globalMatrix.ItemConfig.getUserGroups()) {\n            if (all.indexOf(ml.UI.SelectUserOrGroup.getGroupId(userGroup)) != -1 &&\n                userGroup.membership.map(member => member.login).indexOf(this.getUser()) != -1) {\n                userCanDo = true;\n            }\n        }\n\n        return userCanDo;\n    }\n\n    public updateUI(afterTimeout?:boolean) {\n        let that = this;\n\n        if (this.quiet()) {\n            if ( this.getProject()) {\n                plugins.initProject(this.getProject())\n                mTM.InitializeProject();\n            }\n\n            return;\n        }\n        //  set logged in user\n        this.showUserMenu();\n        (window as any).applyResponsiveView();\n\n        if (afterTimeout) {\n            // we do not want to update the item tree / selected item otherwise\n            // we loose the last edits\n            if (this.getProject() && globalMatrix.ItemConfig.isConfigured()) {\n                plugins.initProject(this.getProject())\n                mTM.InitializeProject();\n            }\n            return;\n        }\n        let height = Math.max(200,$(\"#main\").height())\n        // set project list\n        $(\"#idProjectList\").html(\"\").css(\"max-height\",height +\"px\" );\n\n\n        //Show/enable help button\n        if ($('#helpBtn').length == 0) {\n            that.addHelpButton();\n        }\n        ml.UI.setEnabled($(\".bottomNavHelp\"),true);\n\n        // admin / config client, hand over control\n        if (globalMatrix.matrixProduct === \"Admin\" || this.isConfigClient()) {\n            app.postLogin(this.getUser());\n            //By default save save in on the left\n            if (matrixSession.getUISettings({ saveLeft: true }).saveLeft) {\n                $(\"#btnCancel\").insertAfter($(\"#btnSave\"));\n            }\n            else\n            {\n                $(\"#btnCancel\").insertBefore(\"#btnSave\");\n            }\n            return;\n        }\n\n        // MATRIX-1892 - swap save / cancel button in UI\n        if (matrixSession.getUISettings({ saveLeft: true }).saveLeft) {\n          //By default save save in on the left\n          $(\"#btnCancel\").insertBefore(\"#btnSave\");\n        }\n        else\n        {\n            $(\"#btnCancel\").insertAfter(\"#btnSave\");\n        }\n\n        // retrieve and prepare project groups and start render tree\n        var project_groups = <IProjectGroups>matrixSession.getCustomerSettingJSON(\"project_groups\");\n\n\n\n        let branchParents = {};\n\n        for(let branch_info of this.branches?this.branches:[]) {\n            branchParents[branch_info.branch] = branch_info.mainline;\n        }\n\n        // in the top: add the QMS project or QMS projects group (if there's one)\n        let groupCount =  that.addLiveQMSProjects();\n\n        // get the define project groups\n        let groups = (project_groups && project_groups.groups)?project_groups.groups:[];\n\n        // build a menu with project groups\n        if ( groupCount || groups.length ) {\n            $(\"#idProjectList\").css(\"overflow-y\",\"inherit\");\n            groups.push( {name:\"All Projects\", projects:[]});\n\n            $.each( groups, function ( gird, group) {\n                let all = $('<ul class=\"dropdown-menu dropdown-menu-sub\">');\n                let count = 0;\n                let projects = that.getProjectList(true);\n                let lastParent:string[] = [];\n                for (var idx = 0; idx < projects.length; idx++) {\n                    var pRef = projects[idx].shortLabel;\n                    var pName = projects[idx].label;\n                    if (pRef != \"EMPTY\"||that.isSuperAdmin())  {\n                        if (!group.projects || group.projects.length === 0 || group.projects.indexOf(pRef) !== -1) {\n\n                            all.append(that.createProjectSelectLink(pRef,pName, branchParents, lastParent));\n                            count++;\n                        }\n                    }\n                }\n                if (count>0) {\n                    $(\"#idProjectList\").append( $('<li class=\"dropdown-submenu\">').\n                        append('<a href=\"javascript:void(0)\">' + group.name + '</a>').append(all));\n\n                    groupCount++;\n                }\n                all.css(\"max-height\", $(\"#main\").height() - gird* 26 - 26);\n            });\n        }\n\n        // there's actually only one group (that means max one qms project)\n        // so we want to render a flat list of projects\n        if ( groupCount < 2 ) {\n            $(\"#idProjectList\").css(\"overflow-y\",\"auto\").html(\"\");\n            that.addLiveQMSProjects();\n            let projects = this.getProjectList(true);\n            let lastParent:string[] = [];\n            for (var idx = 0; idx < projects.length; idx++) {\n                var pRef = projects[idx].shortLabel;\n                var pName = projects[idx].label;\n                if (pRef != \"EMPTY\"||this.isSuperAdmin())  {\n                    $(\"#idProjectList\").append(this.createProjectSelectLink(pRef,pName, branchParents, lastParent));\n                }\n            }\n        }\n        // Let hooks plugin in there\n        let menusFromPlugin = plugins.getProjectMenuItems();\n        if (menusFromPlugin && menusFromPlugin.length > 0) {\n            $(\"#idProjectList\").append($(\"<li class='divider'></li>\"))\n\n            for( let menu of menusFromPlugin) {\n                let img = $('<i class=\"fal fa-external-link class menu-icon\"  > </i>');\n                if( menu.icon){\n                    img = $(\"<i class=\\\"fal \" + menu.icon +  \" class menu-icon\\\"  > </i>\")\n                }\n                let link = $(\"<span class='mainmenu'>\" + menu.title + \"</span>\");\n                let li = $(\"<li>\");\n                li.click(function(e: JQueryEventObject) {\n                    menu.action();\n                });\n                li.append(img);\n                li.append(link);\n                $(\"#idProjectList\").append(li);\n            }\n        }\n        // default off\n        let cbAutoCommit =  $(\"#idAutoCommit\");\n        let commentTb = $(\"#comment\");\n\n\n        cbAutoCommit.prop('checked', (localStorage.getItem('idAutoCommit') === 'true')).change(function() {\n            localStorage.setItem('idAutoCommit', cbAutoCommit.prop('checked'));\n        });\n\n\n       that.updateCommentCheckboxBoxVisibility();\n        commentTb.change((evt)=>{\n            that.updateCommentCheckboxBoxVisibility();\n        });\n\n        if (globalMatrix.matrixProduct === \"Launch\") {\n            // nothing to do\n        } else {\n            this.loadProject(null, location.href,false);\n        }\n\n    }\n    // if there is one QMS project just add a link... if there's multiple add a menu and 'increase' the sub menu counter by one\n    public addLiveQMSProjects() {\n        let projects = matrixSession.getProjectList(false).filter(project => { return project.qmsProject; });\n        if( projects.length > 1 ) {\n            let all = $('<ul class=\"dropdown-menu dropdown-menu-sub\"> </ul>');\n            projects.forEach((project) =>{\n                let that = this;\n                let color = that.getProjectColor(project.shortLabel);\n                let img = $('<i class=\"fal fa-external-link class menu-icon\" style=\"color:'+ color +  '\" > </i>');\n                let link = $(\"<span class='mainmenu'>\" + project.shortLabel + \" - \" + project.label + \"</span>\");\n\n                let li = $(\"<li>\");\n                li.click(function(e: JQueryEventObject) {\n                    $(\".navbar-collapse.in\").removeClass(\"in\").addClass(\"collapse\"); // for phones, hide menu\n                    window.open(globalMatrix.matrixBaseUrl + \"/pub/\" + project.shortLabel);\n                });\n\n                li.append(img);\n                li.append(link);\n                all.append(li);\n            });\n            $(\"#idProjectList\").append( $('<li class=\"dropdown-submenu\"></li>').append($('<a href=\"javascript:void(0)\">' + \"My QMS \" + ' <i class=\"fal fa-external-link my-qms-icon\" style=\"\" \"></i></a> ')).append(all));\n            return 1;\n        } else if (projects.length == 1) {\n            let color = this.getProjectColor(projects[0].shortLabel);\n            let img = $('<i class=\"fal fa-external-link menu-icon\" style=\"font-size:13px; float:right; margin-left:5px;margin-top:4px;color:'+ color +  '\" > </i>');\n            let link = $(\"<span style='padding-left: 8px;' class='mainmenu'>\" + projects[0].shortLabel + \" - \" + projects[0].label + \"</span>\");\n            let li = $(\"<li>\").append(link.append(img));\n            li.click(function(e: JQueryEventObject) {\n                $(\".navbar-collapse.in\").removeClass(\"in\").addClass(\"collapse\"); // for phones, hide menu\n                window.open(globalMatrix.matrixBaseUrl + \"/pub/\" + projects[0].shortLabel);\n            });\n            $(\"#idProjectList\").append(li);\n            return 0;\n        }\n\n        return 0;\n\n    }\n    public updateCommentCheckboxBoxVisibility(): any {\n        let commentTb = $(\"#comment\");\n        let cbAutoCommit =  $(\".autoSave\");\n\n        if(commentTb.val() ===\"\")\n        {\n            cbAutoCommit.hide();\n        }\n        else\n        {\n            cbAutoCommit.show();\n        }\n    }\n\n    loadProject(projectId:string, projectURL?:string, setAsProjectUrl?:boolean) {\n        // if called from menu the projectURL is null\n        // if called after page load, the projectID is null\n        // if called after Sign in menu , the projectID is null\n\n        if( projectURL == null)\n            $(\"#filterDialog\").remove();\n\n        matrixApplicationUI.updateMainUI(true);\n\n\n\n\n        //Add browser notification support\n        let notificationConfig = <INotificationConfig>matrixSession.getCustomerSettingJSON(notificationSetting, defaultNotificationConfig);\n\n        if( notificationConfig.browserNotificationDisabled == undefined || notificationConfig.browserNotificationDisabled == false)\n        {\n            if (window.Notification && window.Notification.permission !== 'granted')\n                window.Notification.requestPermission();\n\n        }\n\n\n        let parsedUrl = ml.URL.parseUrl(location.href);\n        if(parsedUrl.project == \"\" )\n        {\n            if(parsedUrl.params[\"dashboard\"] != null )\n            {\n                let  d =parsedUrl.params[\"dashboard\"] ;\n                ml.UI.widgetPluginsContainer.render(d);\n                return;\n            }\n        }\n\n\n        // currently no link types are known for automatic highlighting\n        resetHighlightLinks();\n\n        this.CurrentProject = projectId;\n        // in case projectURL is known, it or the local storage should be used\n        if (projectURL) {\n            this.CurrentProject = this.getProjectFromUrlOrStorage(projectURL);\n        }\n\n        if (this.CurrentProject) {\n            // make sure it still exists\n            var stillOK = false;\n            let projects = this.getProjectList(true);\n            for (var idx = 0; idx < projects.length; idx++) {\n                if (this.CurrentProject === projects[idx].shortLabel) {\n                    stillOK = true;\n                    $(\"#sidebar\").show();\n                    $(\"#main\").show();\n                    $(\"#explainOuter\").hide();\n                }\n            }\n            if (!stillOK) {\n                this.showProjectSelectMessage();\n                $(\"#idProject\").html('<div class=\"btn btn-xs\" style=\"padding-top:6px\"><span>Select project </span><span class=\"caret\"></span></div>')\n                matrixApplicationUI.destroyOldControls();\n                NavigationPanel.destroy();\n                ml.UI.showError(\"Project does not exist!\", \"The project '\" + this.CurrentProject + \"' either does not exist or you have no read/write access to it.\");\n                setTimeout(function () {\n                    ml.UI.showSuccess(\"Select a another project\");\n                }, 3000);\n                return;\n            }\n        } else {\n\n                this.showProjectSelectMessage();\n\n                $(\"#idProject\").html('<div class=\"btn btn-xs\" style=\"padding-top:6px\"><span>Select project </span><span class=\"caret\"></span></div>')\n            matrixApplicationUI.destroyOldControls();\n                NavigationPanel.destroy();\n\n                ml.UI.showSuccess(\"select a project\");\n            return;\n        }\n\n        if (!projectURL) {\n            projectURL = app.createItemUrl();\n            history.pushState(null, null, projectURL);\n        } else if ( setAsProjectUrl ) {\n            history.pushState(null, null, globalMatrix.matrixBaseUrl + \"/\" + projectURL);\n        }\n\n        let projectName = matrixSession.getProject();\n        let foundProjects = matrixSession.getProjectList(false).filter(o => { o.shortLabel == projectName })\n\n        let  logoSetting:string = foundProjects!=undefined && foundProjects.length > 0 ? foundProjects[0].projectLogo : \"\";\n\n\n\n        var img = this.getImgFromProject(projectName,0);\n        let projectNameTitleCtrl =\n                `<div id=\"projectNameTitleContainer\" class=\"btn btn-xs\" >\n                   <div id=\"projectNameTitle\">\n                       ${img}\n                       <span> ${projectName}</span>\n                       <span class=\"caret\"/>\n                   </div>\n               </div>`\n\n        let color = matrixSession.getProjectColor(projectName);\n        if(! app.isConfigApp()){\n            $(\"header\").css(\"border-top\",\"solid 5px \" + color);\n        }\n        $(\"#tooltip_panel\").css(\"border\",\"solid 5px \" + color);\n\n        $(\"#scrollBarStyle\").remove();\n\n        $(\"#idProject\").html( projectNameTitleCtrl ); //://\"<i class='fas fa-book'></i>\");\n\n\n        globalMatrix.serverStorage.setItem('SessionLastProject', this.CurrentProject);\n        if (typeof globalMatrix.mobileApp !== \"undefined\") {\n            globalMatrix.projectStorage = new ProjectStorageMobile(this.CurrentProject);\n        } else {\n            globalMatrix.projectStorage = new ProjectStorage(this.CurrentProject, app.getVersion(),\n                globalMatrix.matrixBaseUrl, DOMPurify);\n        }\n        // if url specifies it use the item if not use last item from storage for project\n        var item = this.getItemFromUrlOrStorage(projectURL);\n        globalMatrix.projectStorage.setItem('SessionLastItem', item);\n\n        app.loadProject(this.CurrentProject, item);\n\n        // auto run search\n\n        function runSearch() {\n            $(\"#projectTree input[name=search]\").val(search);\n            $(\"#projectTree .btn-sssearch>i\").trigger(\"click\");\n        }\n        let search = ml.URL.parseUrl(projectURL).params.search;\n\n        if (search) {\n            app.waitForMainTree(runSearch);\n        }\n\n        // Store params for later use\n        this.customParams = ml.URL.parseUrl(projectURL).params;\n\n\n          // Automatically switch to item when mobileLayout\n          let mobileLayout =localStorage.getItem( \"mobileLayout\");\n\n          if( mobileLayout && mobileLayout != \"\" )\n          {\n              localStorage.setItem( \"mobileLayout\",\"1\");\n              (window as any).applyResponsiveView();\n          }\n\n\n    };\n\n    oAuthOnly() {\n        return globalMatrix.mxOauth ==\"mandatory\";\n    }\n    private showProjectSelectMessage( forceIntro?:boolean ) {\n\n\n        $(\"#sidebar\").hide();\n        $(\"#main\").hide();\n        $(\"#contextframe\").addClass(\"hidden\");\n        $(\"#contextframesizer\").addClass(\"hidden\");\n        $(\"#explainOuter\").show();\n        $(\"#explain\").html(\"\");\n        function showimg(img:string) {\n            $(\".explainimg\").html(\"<img src='\" + globalMatrix.matrixBaseUrl + \"/img/\" + img + \"'/>\");\n            $(\"#imgModal\").modal();\n        }\n        $(\"#explain\").height($(\"#explainOuter\").height());\n        let projectsRW = this.getProjectList(true);\n\n        if ( !projectsRW || projectsRW.length === 0 ) {\n            $(\"#explain\").append( \"<div class='explainh1'>Welcome to Matrix Requirements</div>\" );\n\n        // Get qms viewer only\n            var projectListQms = matrixSession.getProjectList(false).filter(item => item.accessType == \"qmsviewer\");\n           if( projectListQms.length >0)\n           {\n                 var ul = $(\"<ul class='explainMore'/>\");\n                 $(\"#explain\").append( \"<div class='explainh2'>You can access  to these projects as a QMS viewer</div>\" );\n                 $(\"#explain\").append(ul);\n                 projectListQms.forEach((item)=>\n                 {\n                     ul.append(\"<li class='explainmore'><a href='\" + globalMatrix.matrixBaseUrl + \"/pub/\" + item.shortLabel + \"'>\" + item.shortLabel + \" </a> - \" + item.label + \"</li>\")\n                 });\n\n           }\n           else\n           {\n                 $(\"#explain\").append( \"<div class='explainh2'>You do not have access to any projects. Please contact your Matrix Requirements administrator.</div>\" );\n           }\n\n        } else if (globalMatrix.matrixExpress || forceIntro) {\n\n\n\n            let projects = projectsRW.map( function( ple:XRProjectType){ return ple.shortLabel;});\n\n            $(\"#explain\").append( \"<div class='explainh1'>Welcome to Matrix Requirements</div>\" );\n            $(\"#explain\").append( \"<div class='explainh2'>Below are a few examples for project configurations. They have different item categories and traceability rules. Your actual project structure will most likely be different - Ask us, we help you to set it up quickly!</div>\" );\n            //$(\"#explain\").append( \"<div class='explainh3'>The item categories define what kind of items you can store in the database. The traceability rules define which up and downstream links between the categories can or must exist. This can be changed in the admin client, but before getting into that ask us </div>\" );\n\n            $(\"#explain\").append( \"<div class='explainh1'>MatrixALM - Design History Files and more</div>\" );\n            if(projects.indexOf(\"SIMPLEST\")==-1 && projects.indexOf(\"DEFAULT\")==-1 && projects.indexOf(\"MREQPROJ\")==-1 ) {\n                $(\"#explain\").append( \"<div class='explainh2'>The ALM module is not enabled - let us know if you want to get it!</div>\" );\n            } else {\n                var ul = $(\"<ul>\");\n                $(\"#explain\").append($(\"<div class='explainh2'>\").append(ul));\n                if(projects.indexOf(\"SIMPLEST\")!=-1) ul.append( $(\"<li class='explainmore'>SIMPLEST: covers requirements, specification, tests (<span class='explainImg' data-src='simplest.png' >show</span> - <span class='explainProject' data-src='SIMPLEST' >open project</span>)</li>\") );\n                if(projects.indexOf(\"DEFAULT\")!=-1) ul.append( $(\"<li class='explainmore'>DEFAULT: covers risks, requirements, specification, tests and use cases (<span class='explainImg' data-src='default.png' >show</span> - <span class='explainProject' data-src='DEFAULT' >open project</span>)</li>\"));\n                if(projects.indexOf(\"MREQPROJ\")!=-1) ul.append( $(\"<li class='explainmore'>MREQPROJ: covers risks, user and system requirements, specification, tests and use cases (<span class='explainImg' data-src='mreq.png' >show</span> - <span class='explainProject' data-src='MREQPROJ' >open project</span>)</li>\"));\n                $(\"#explain\").append( \"<div class='explainh3'>If you need more projects, different types of categories, input fields, traceability rules or risk formulas please do not hesitate to contact us.</div>\" );\n            }\n\n            $(\"#explain\").append( \"<div class='explainh1'>MatrixQMS - Quality System, CAPAs and more</div>\" );\n            if(projects.indexOf(\"QMS\")==-1 && projects.indexOf(\"CAPA\")==-1 && projects.indexOf(\"QMS_FILE\")==-1 && projects.indexOf(\"HR_FILE\")==-1 ) {\n                $(\"#explain\").append( \"<div class='explainh2'>The QMS module is not enabled - let us know if you want to get it!</div>\" );\n            } else {\n                var ul = $(\"<ul>\");\n                $(\"#explain\").append($(\"<div class='explainh2'>\").append(ul));\n                if(projects.indexOf(\"QMS\")!=-1) ul.append( $(\"<li class='explainmore'>QMS: all your standards, procedures, work instructions, procedural risks, etc ... (<span class='explainProject' data-src='QMS' >open project</span>)</li>\") );\n                if(projects.indexOf(\"CAPA\")!=-1) ul.append( $(\"<li class='explainmore'>CAPA: Corrective and preventive action forms (<span class='explainProject' data-src='CAPA' >open project</span>)</li>\"));\n                if(projects.indexOf(\"QMS_FILE\")!=-1) ul.append( $(\"<li class='explainmore'>QMS_FILE: the place for QMS records (<span class='explainProject' data-src='QMS_FILE' >open project</span>)</li>\"));\n                if(projects.indexOf(\"HR_FILE\")!=-1) ul.append( $(\"<li class='explainmore'>HR_FILE: human resource records (<span class='explainProject' data-src='HR_FILE' >open project</span>)</li>\"));\n            }\n\n\n            let modal =  `\n                <div class=\"modal fade  modal-lg\" id=\"imgModal\" tabindex=\"-1\" role=\"dialog\">\n                    <div class=\"modal-dialog   explain-modal\" role=\"document\">´\n                <div class=\"modal-content  explain-modal\">\n                <div class=\"modal-header\">\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                    <h4 class=\"modal-title\" id=\"myModalLabel\">Configuration Preview</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <div class='explainimg'></div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n                </div>\n                </div>\n            </div>\n            </div>`;\n            $(\"#explain\").append( modal );\n\n            $(\".explainImg\").click(function( event:JQueryEventObject) { showimg($(event.delegateTarget).data(\"src\"));});\n            $(\".explainProject\").click(function (event: JQueryEventObject) { window.open(globalMatrix.matrixBaseUrl + \"/\" + $(event.delegateTarget).data(\"src\"), \"_blank\"); });\n        } else {\n            $(\"#explain\").append( \"<div class='explainh1'>Welcome to Matrix Requirements</div>\" );\n            $(\"#explain\").append( \"<div class='explainh2' style='text-align: center;'>Please select a project from the project menu in the top.</div>\" );\n            $(\"#comment\").prop('disabled', false);\n        }\n    }\n\n\n    private filterProjects(projectList:XRProjectType[]):XRProjectType[] {\n        let dp = <IDeletedProjects>matrixSession.getCustomerSettingJSON(\"deleted_projects\");\n        if (!dp) {\n            return projectList;\n        }\n        // filter project by deleted ones\n        return projectList.filter( function( pli) { return dp.deleted.indexOf(pli.shortLabel)==-1;});\n    }\n\n    private getItemFromUrlOrStorage(projectURL:string):string {\n\n        if (!projectURL) {\n            return null;\n        }\n\n        let parsedUrl = ml.URL.parseUrl(projectURL);\n\n        if (parsedUrl.item) {\n            return parsedUrl.item;\n        }\n\n        return globalMatrix.projectStorage.getItem('SessionLastItem');\n    }\n\n    private getProjectFromUrlOrStorage(projectURL:string):string {\n\n        let project:string = null;\n\n        let parsedUrl = ml.URL.parseUrl(projectURL);\n\n        if (parsedUrl.project) {\n            project = parsedUrl.project;\n        } else  {\n            project = globalMatrix.serverStorage.getItem('SessionLastProject');\n        }\n\n        if (project == \"#\") {\n            project = null;\n            window.history.pushState(null, null, window.location.href.replace(\"#\",\"\"))\n        }\n\n        return project;\n    }\n\n    browserNavigation() {\n        var item = this.getItemFromUrlOrStorage(location.href);\n        var project = this.getProjectFromUrlOrStorage(location.href);\n\n\n\n\n\n        if (this.CurrentProject !== project) {\n            this.loadProject(null,location.href);\n            return;\n        }\n        this.duringBrowserNavigation = true;\n        app.treeSelectionChangeAsync(item);\n        this.duringBrowserNavigation = false;\n    }\n\n\n    signOut(requestAdminRights:boolean) {\n        let that = this;\n        app.canNavigateAwayAsync().done(function () {\n            $(\"#idProject\").html(\"\");\n            matrixApplicationUI.destroyOldControls();\n            $(\"#user\").html(\"\");\n            $(\"#mainUserMenu\").html(\"\");\n            NavigationPanel.destroy();\n            ml.UI.setEnabled($(\".bottomNavHelp\"),false);\n\n            restConnection.postServer(\"user/\" + that.getUser() + \"/logout\").done(function () {\n                var res=$.Deferred();\n                that.signOutCleanUp();\n                res.done(function(){\n                    that.updateUI();\n                });\n                that.requestLogin(res, requestAdminRights);\n            });\n\n\n        }).fail(function () {\n            ml.UI.showError(\"You have unsaved changes.\", \"Save or cancel before signing out.\");\n        });\n    }\n\n    editComment() {\n        let that = this;\n\n        var lastCommentsSession = this.getLastComments();\n        // dropdown select last comment\n        $(\"#recentCommentChange\").find(\"li\").remove();\n        for (var idx = 0; idx < lastCommentsSession.length; idx++) {\n            var option = $('<li><a data-target=\"#\">'+ this.makeTeaser(lastCommentsSession[idx])  + '</a></li>')\n                .click(function(e: JQueryEventObject) {\n                    $(\"#commentDlgText\").val($(e.delegateTarget).data(\"full\").replace(/&lt;/g,\"<\"));\n                })\n                .data(\"full\", lastCommentsSession[idx]);\n\n            $(\"#recentCommentChange\").append(option);\n        }\n\n        $(\"#commentDlgText\").val(this.getComment().replace(/&lt;/g,\"<\"));\n\n        ml.UI.showDialogDes( {\n            container:$(\"#commentDlg\"),\n            minMaxHeight: -400,\n            minMaxWidth:-550,\n            buttons: [{\n                text:'Save',\n                class:'btnDoIt',\n                click:function () {\n                    that.setComment($(\"#commentDlgText\").val().replace(/</g,\"&lt;\"));\n                    $(\"#commentDlg\").dialog(\"close\");\n                }\n            },{\n                text:'Cancel',\n                class:'btnCancelIt',\n                click:function () {\n                    $(\"#commentDlg\").dialog(\"close\");\n                }\n            }],\n            title:\"Enter comment used when saving\",\n            onOpen: () =>  {\n                window.setTimeout( function() {$(\"#commentDlgText\").select();}, 100);\n            },\n            onClose: () => {\n\n            },\n            onResize: () => {\n                $(\"#commentDlg\").css(\"width\",\"100%\");\n            }\n        });\n\n    }\n\n    public showLoginWindow() {\n\n        if(ml.UI.widgetPluginsContainer && ml.UI.widgetPluginsContainer.visible )\n        {\n            ml.UI.widgetPluginsContainer.exit(\"\");\n        }\n        const loginFrame = $(\"#loginFrame\");\n        const loginBox = loginFrame.contents().find(\".login-full-box\");\n        if (loginBox.length === 0) {\n            // Not loaded yet\n            console.info(\"LOGIN: Not ready yet, try again\");\n            window.setTimeout(() => this.showLoginWindow(), 100);\n            return;\n        }\n\n        if (loginFrame.is(\":visible\") && loginBox.is(\":visible\")) {\n            // nothing to do\n            console.info(\"LOGIN: Already visible, nothing to do\")\n            return;\n        }\n\n        loginFrame.show();\n        loginBox.show();\n    }\n\n    public hideLoginWindow() {\n        const loginFrame = $(\"#loginFrame\");\n        const loginBox = loginFrame.contents().find(\".login-full-box\");\n        if (loginBox.length === 0) {\n            // Not loaded yet\n            console.info(\"LOGIN: Not ready yet, try again\");\n            window.setTimeout(() => this.hideLoginWindow(), 100);\n            return;\n        }\n\n        if (loginFrame.is(\":hidden\") && loginBox.is(\":hidden\")) {\n            // nothing to do\n            console.info(\"LOGIN: Already hidden, nothing to do\")\n            return;\n        }\n\n        loginFrame.hide();\n        loginBox.hide();\n    }\n\n    private requestLogin( res:any, requestAdminRights?:boolean ) {\n        let that = this;\n        const loginFrame = $(\"#loginFrame\");\n        if (!loginFrame.length) return; // for unit tests\n\n        this.showLoginWindow();\n\n        that.postConnect = res;\n\n        (<any>loginFrame[0]).contentWindow.postMessage(\"activateUser\", window.location.origin);\n        if (requestAdminRights) {\n            window.setTimeout( function() {\n                // give the frame some time to load...\n                (<any>loginFrame[0]).contentWindow.postMessage(\"admin\", window.location.origin);\n            },1000);\n        }\n\n    }\n\n    private receiveMessage(event:any) {\n        let that = this;\n\n        if (event.origin == window.location.origin && event.data == \"login\") {\n            // login successful\n            $(\"#loginFrame\").hide();\n\n            // prepare next login ()\n            (<any>$(\"#loginFrame\")[0]).contentWindow.location.reload();\n            matrixSession.setComment(localStorage.getItem(globalMatrix.matrixBaseUrl + \"_useComment\"));\n            // if there is a specific point to continue.. go for it\n            matrixSession.updateSettings().done(function () {\n\n                matrixSession.showUserMenu();\n                // retrieved some settings, go back to start\n                if (matrixSession.postConnect) {\n                    matrixSession.postConnect.resolve();\n                }\n            }).fail( function() {\n                // this should not really happen (since we just logged in...)\n                matrixSession.requestLogin(matrixSession.postConnect);\n            });\n        } else if (event.origin == window.location.origin && event.data == \"login-failed\") {\n            ml.UI.showError(\"SSO Login failed\", \"Unable to login via external authentication system.\");\n        } else if  (event.origin == window.location.origin &&  event.data == \"loginDetails\") {\n            // test if something should be announced\n            if (  Number(localStorage.getItem( \"badLogins\" )) > 0 ) {\n                ml.UI.showSuccess(\"Before this successful login \" + localStorage.getItem( \"badLogins\" )  + \" unsuccessful login attempts have been done.\",4000);\n            }\n            let expire =  Number(localStorage.getItem( \"expiration\" ));\n            if (expire > -1 ) {\n                ml.UI.showError(\"Password will expire soon!\", \"Your password will expire in \" + expire + \" days.\",4000)\n            }\n        }\n\n    }\n\n    private addHelpButton() {\n        var dropDownHtml = '<div class=\"btn-group dropup navbarCtrl mainHelp\" style=\"float:right\">' +\n            '    <button type=\"button\" class=\"bottomNavHelp btn  btn-warning dropdown-toggle\" data-toggle=\"dropdown\">' +\n            '        <span id=\"helpBtn\">Help</span> <span class=\"caret\"></span>' +\n            '    </button>' +\n            this.getHelpButton() +\n            '</div>'\n        $('.navbar-fixed-bottom .navbar-right:has(#btnSave)').prepend(dropDownHtml);\n    }\n\n    getHelpButton() {\n        return '    <ul id=\"mainHelpBtnMenu\" class=\"dropdown-menu dropdown-menu-main usermenu\" role=\"menu\" id=\"helpUL\">' +\n        '    <li><a id=\"\" href=\"https://urlshort.matrixreq.com/d23/faq\" target=\"_blank\">FAQ</a></li>' +\n        '    <li><a id=\"\" href=\"https://urlshort.matrixreq.com/d23/manual\" target=\"_blank\">User guide</a></li>' +\n        '    <li><a id=\"\" href=\"https://urlshort.matrixreq.com/d23/admin\" target=\"_blank\">Administrative guide</a></li>' +\n        '    <li class=\"divider\"></li>' +\n        '    <li><a id=\"\" href=\"https://urlshort.matrixreq.com/contact\" target=\"_blank\">Contact us</a></li>' +\n        '    <li><a id=\"\" href=\"https://urlshort.matrixreq.com/helpdesk\" target=\"_blank\">Service desk</a></li>' +\n        '    </ul>' ;\n    }\n\n    private showUserMenu() {\n        let that = this;\n        var info=  that.getUser();\n        // display current user name\n        $(\"#user\").html(\"\");\n        $(\"#user\").append(ml.UI.getAvatar(info,32));\n\n        // fill user menu\n        $(\"#mainUserMenu\").html(\"\");\n\n        // add sign out\n        $('<li id=\"signoutcommand\"><span class=\"\">Sign out <i class=\"fal fa-sign-out-alt\" style=\"float: right;font-size: 17px;\"></i> </span></li>').appendTo($(\"#mainUserMenu\")).click( function() {\n            that.signOut(false);\n        });\n\n\n        if (!that.isConfigClient()) {\n\n           $('<li class=\"divider\" style=\"\"></li>').appendTo($(\"#mainUserMenu\"));\n           // add change user profile\n            if (globalMatrix.matrixBaseUrl.indexOf('demo.matrixreq.com') === -1 || that.getUser() != \"demo\") {\n                $('<li class=\"changepasswordmenu\"><span id=\"myprofile\" class=\"\">My Profile<i class=\"fal fa-user\" style=\"float: right;font-size: 17px;\"></i></span></li>').appendTo($(\"#mainUserMenu\")).click( function() {\n                    that.changePassword();\n                });\n            }\n\n            let settingsToken = <ITokenConfig>this.getCustomerSettingJSON(\"settingsToken\");\n            if (settingsToken && settingsToken.enabled && (settingsToken.users.length == 0 || settingsToken.users.indexOf(matrixSession.getUser()) != -1)) {\n                $('<li class=\"changetoke\"><span id=\"mytoken\" class=\"\">My Tokens<i class=\"fal fa-key\" style=\"float: right;font-size: 17px;\"></i></span></li>').appendTo($(\"#mainUserMenu\")).click( function() {\n                    that.changeToken();\n                });\n            }\n\n            if (matrixSession.getUISettings().widgetDashboardOption)\n            {\n                $('<li class=\"divider\" style=\"\"></li>').appendTo($(\"#mainUserMenu\"));\n                let dashboardList = <IDashboardConfig>matrixSession.getCustomerSettingJSON(\"dashboardSettings\");\n                if(dashboardList != null && dashboardList.dashboards != null )\n                {\n                 for(let d in  dashboardList.dashboards ){\n\n                    let icon = '<i class=\"fal fa-columns\" style=\"float: right;font-size: 17px;\"></i>';\n                    if(dashboardList.dashboards[d].icon != undefined)\n                      {\n                         icon = '<i class=\"'+dashboardList.dashboards[d].icon+'\" style=\"float: right;font-size: 17px;\"></i>';\n                      }\n                      let msg= \"<span class=''>\"+ dashboardList.dashboards[d].displayString  +  icon + \"</span> \";\n                     $('<li style=\"position: relative;\">' + msg + '</li>').appendTo($(\"#mainUserMenu\")).click( function(event:JQueryEventObject) {\n                         ml.UI.widgetPluginsContainer.render(d);\n                     })\n                 }\n                }\n            }\n            let userMenuItems = plugins.getUserMenuItems();\n            if (userMenuItems.length > 0) {\n                $('<li class=\"divider\" style=\"\"></li>').appendTo($(\"#mainUserMenu\"));\n                for (let menu of userMenuItems){\n                    let icon = '<i class=\"fal fa-columns\" style=\"float: right;font-size: 17px;\"></i>';\n                    if(menu.icon != undefined)\n                    {\n                        icon = '<i class=\"'+menu.icon+'\" style=\"float: right;font-size: 17px;\"></i>';\n                    }\n                    let msg= \"<span class=''>\"+ menu.title +  icon + \"</span> \";\n                    $('<li style=\"position: relative;\">' + msg + '</li>').appendTo($(\"#mainUserMenu\")).click( function(event:JQueryEventObject) {\n                        menu.action();\n                    })\n                }\n            }\n            // add admin client\n            if (this.isCustomerAdmin() || this.isSuperAdmin()) {\n                $('<li class=\"divider\" style=\"\"></li>').appendTo($(\"#mainUserMenu\"));\n                $('<li class=\"adminsettings\"><a id=\"serveradmin\" href=\"' + globalMatrix.matrixBaseUrl + '/adminConfig' + '\" target=\"_blank\">Server Administration <i class=\"fal fa-cog\" style=\"float: right;font-size: 17px;\"></i></a></li>').appendTo($(\"#mainUserMenu\"));\n                  $(\"#serveradmin\").click((evt)=>{\n                      if (globalMatrix.globalShiftDown && matrixSession.getProject())\n                      {\n                          window.open(globalMatrix.matrixBaseUrl + \"/adminConfig/\" + matrixSession.getProject(), \"_blank\");\n                          evt.preventDefault();\n                          return false;\n                      }\n                  })\n            }\n        } else {\n            let userMenuItems = plugins.getConfigUserMenuItems();\n            if (userMenuItems.length > 0) {\n                $('<li class=\"divider\" style=\"\"></li>').appendTo($(\"#mainUserMenu\"));\n                for (let menu of userMenuItems){\n                    let icon = '<i class=\"fal fa-columns\" style=\"float: right;font-size: 17px;\"></i>';\n                    if(menu.icon != undefined)\n                    {\n                        icon = '<i class=\"'+menu.icon+'\" style=\"float: right;font-size: 17px;\"></i>';\n                    }\n                    let msg= \"<span class=''>\"+ menu.title +  icon + \"</span> \";\n                    $('<li style=\"position: relative;\">' + msg + '</li>').appendTo($(\"#mainUserMenu\")).click( function(event:JQueryEventObject) {\n                        menu.action();\n                    })\n                }\n            }\n        }\n    }\n\n\n    initPushMessaging():JQueryDeferred<{}> {\n        let that = this;\n\n        let res = $.Deferred();\n\n        if (this.pushMessages) {\n            res.resolve();\n            this.pushMessages.newConnection();\n            return res;\n        }\n        this.pushMessages = new PushMessages(  );\n\n        this.pushMessages.newConnection(  ).always( function() {\n            res.resolve();\n            // handle todos\n            that.pushMessages.onTodoChanged(  async function () {\n                let projects = matrixSession.getProjectList(true).map(function(p) {\n                    return p.shortLabel;\n                });\n                let result = await NotificationsBL.NoticationCache.update(projects);\n                NotificationList.updateUI(result);\n            });\n            // handle item changes\n            that.pushMessages.onItemUpdated( function( changed ) {\n                // also update the tree, rename the item if needed\n                if (app.getItemTitle(changed.item)) {\n                    NavigationPanel.update(<IItem>{id:changed.item, title:changed.title});\n                    that.updateWatchItemVersion( changed.item, changed.version );\n                }\n            });\n\n            // handle new items\n            that.pushMessages.onItemCreated(function( changed ) {\n                let itemJson:IItem = {\n                    id: changed.item,\n                    title: changed.title,\n                    type: ml.Item.parseRef(changed.item).type\n                };\n                if ( ml.Item.parseRef(changed.item).isFolder ) {\n                    itemJson[\"children\"] = [];\n                }\n                let newItem: IDBParent = {\n                    parent: changed.parent,\n                    position: 10000,\n                    item: <IItem>itemJson\n                };\n\n                window.setTimeout( function() {\n                    // wait a bit more than a typical round trip to server before the update\n                    // maybe the item was already created by some other action (e.g. it's a XTC execution the user did himself)\n                    if (!app.getItemTitle(changed.item)) {\n                        app.insertInTree(newItem);\n                        app.updateCache(newItem);\n                    }\n\n                }, 500);\n            });\n\n            // handle deleting items\n            that.pushMessages.onItemDeleted( function( changed ) {\n                // we need to wait a bit, cause if I deleted it, it will go away by itself\n                window.setTimeout( function() {\n                    if (app.getItemTitle(changed.item)) {\n                        // otherwise I deleted it...\n                        NavigationPanel.remove(changed.item);\n                        if (app.getCurrentItemId() == changed.item) {\n                            ml.UI.showAck(-1, \"Someone just deleted the item you are looking at: \" + changed.item );\n                        }\n                    }\n                }, 1000);\n            });\n\n            // show people watching items\n            that.pushMessages.onItemWatched( function( watchInfo ) {\n                if (watchInfo.item == app.getCurrentItemId()) {\n\n                    if (watchInfo.editor && !watchInfo.editor.thisSocket) {\n                        // apparently someone else is editing the item...\n                        // make it readonly, maybe update it, indicate editor\n                        app.someOneElseIsChanging(watchInfo);\n                    } else if (watchInfo.editor  && watchInfo.editor.thisSocket) {\n                        // i got notified that I am editing an item, I don't care\n                        // unless someone else modified the item in the mean time\n                        if (that.lastWatchInfo &&  // I watch something (not very first item load)\n                            that.lastWatchInfo.item == app.getCurrentItemId() && // and what I watch is displayed (should always be the case)\n                            watchInfo.item == that.lastWatchInfo.item &&  // and the news is still for that item\n                            watchInfo.version != that.lastWatchInfo.version && // but the news is that the version is not what I displayed\n                            that.lastWatchInfo.version > 0  // this means it's not currently saving\n                            ) {\n                            // I got disconnected while editing (and someone else made a change before I logged on again)\n\n                            app.someOneElseWasChanging(watchInfo);\n                        } else {\n                            // all good  make sure list with editors / viewers is up-to-date\n                            app.updateItemViewers(watchInfo);\n                        }\n                    } else  {\n                        // no (more) editor\n                        if (that.lastWatchInfo && that.lastWatchInfo.editor ) {\n                            // someone was editing before\n                            if (that.lastWatchInfo.item == app.getCurrentItemId()) {\n                                // someone (else) stopped editing (e.g. by cancelling)\n                                if (that.lastWatchInfo.editor.thisSocket) {\n                                    // I stopped editing\n                                    if (app.needsSave()) {\n                                        // not actually true MATRIX-3211 - we just ignore this message\n                                        ml.Logger.log(\"warning\", \"received message as if I stopped editing, but not true, so I ignore it!\");\n                                    }\n                                    // in any case update viewers\n                                    app.updateItemViewers(watchInfo);\n                                } else {\n                                    app.someOneElseStoppedEditing(watchInfo, that.lastWatchInfo);\n                                }\n                            } else {\n                                // someone else stopped editing another item (e.g. by cancelling)\n                                // so we don't care about stopping something but we want to show the editors of this item\n                                app.updateItemViewers(watchInfo);\n                            }\n                        } else  {\n                            // nobody edits and edited before\n                            app.updateItemViewers(watchInfo);\n                        }\n                    }\n                    // remember last watchers\n                    if (! (that.lastWatchInfo && that.lastWatchInfo.item == watchInfo.item && Math.abs(that.lastWatchInfo.version) == watchInfo.version )) {\n                        // handle race conditions: keep negative version from saving\n                        that.lastWatchInfo = watchInfo;\n                    }\n                }\n\n            });\n        }).fail( function() {\n            res.reject();\n        });\n\n        return res;\n    }\n\n    private lastWatchInfo:IItemWatched;\n\n    updateWatchItemVersion( itemId:string, newVersion:number) {\n        if (this.lastWatchInfo && this.lastWatchInfo.item == itemId) {\n            if (newVersion==-1) {\n                newVersion = -Math.abs( this.lastWatchInfo.version);\n            }\n            this.lastWatchInfo.version = newVersion;\n        }\n    }\n    isConfigClient() {\n        return globalMatrix.matrixProduct == \"Configuration Client\";\n    }\n    private updateSettings():JQueryDeferred<{}> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        restConnection.getServer(\"?exclude=allUsers,allTodos\", true).done(function (result: XRGetProject_StartupInfo_ListProjectAndSettings) {\n\n            if ( result.license.maxReadWrite <  result.readWriteUsers.length ) {\n                ml.UI.showError(\"License Issue\", \"There are not enough write licenses.\");\n            }\n\n            that.setModules(result);\n            that.serverConfig = result;\n            plugins.initServerSettings(result);\n\n\n            that.setUser(result.currentUser);\n            that.setDateInfo( result.dateInfo );\n            that.setCustomerSettings( result.customerSettings );\n\n            let projects = result.project.map( function(pi) { return pi.shortLabel;});\n\n            NotificationsBL.NoticationCache.setNotificationCounts( result.todoCounts.filter( function( todoCount) { return projects.indexOf( todoCount.projectShort)!=-1;} ));\n            // a session is still active\n            that.ProjectList = that.filterProjects(result.project);\n\n\n            that.customerAdmin = result.customerAdmin === 1;\n            that.superAdmin = result.superAdmin === 1;\n\n            if ( that.isConfigClient() && !that.isAdmin() && !that.isSuperAdmin()) {\n                that.signOut(true);\n            } else if ( that.isConfigClient() ) {\n                res.resolve();\n            } else {\n                that.initPushMessaging().always( function() {\n                    // in any case, software will run without websockets\n                    res.resolve();\n                });\n            }\n\n            that.branches = result.branches;\n\n            if (matrixSession.getUISettings().widgetDashboardOption)\n            {\n                $(\"img.brandLogo\").css(\"cursor\",\"pointer\");\n                $(\"img.brandLogo\").off( \"click.toggleWidget\");\n                $(\"img.brandLogo\").on( \"click.toggleWidget\", ()=>{  ml.UI.widgetPluginsContainer.toggle() });\n\n\n\n\n\n            }\n\n        }).fail(function (jqxhr:{}, textStatus:string, error:string) {\n            res.reject();\n        });\n\n        return res;\n    }\n\n    getBranches( mainline:string, branch:string) {\n        if (!this.branches) return [];\n        return this.branches.filter( info => (!mainline || mainline == info.mainline) && (!branch || branch == info.branch));\n    }\n\n    private signOutCleanUp(){\n        this.customerAdmin = false;\n        this.superAdmin = false;\n        this.CurrentUser = \"\";\n    }\n\n    public getCustomParams() {\n        return this.customParams;\n    }\n    getDashboardConfig(): IDashboardConfig {\n        try {\n            let config = matrixSession.getCustomerSettingJSON(\"dashboardSettings\");\n            if( config &&<IDashboardConfig>config )\n                return <IDashboardConfig>config\n        } catch (error) {\n        }\n        return {dashboards:{default:{displayString:\"home\"}}};\n\n   }\n\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { IDataStorage } from \"../globals\";\n\nexport { ProjectStorage };\n\nclass ProjectStorage implements IDataStorage {\n    Project:string;\n    DOMPurify: any;\n\n    constructor(project: string, appVersion: string, matrixBaseUrl: string, dompurifylib: any) {\n        this.DOMPurify = dompurifylib;\n        var vs = appVersion.split(\".\");\n        var vo = vs[0] + \".\" + vs[1] + \".\" ;\n        if ( !localStorage.getItem(vo+\"cleanup\")) {\n            for(var x in localStorage) {\n                if (x.indexOf(\"remember_selection\") >0 && localStorage[x]===\"\" ) {\n                    localStorage.removeItem(x);\n                }\n                if (x.indexOf(matrixBaseUrl) === 0) {\n                    var y = x.replace(matrixBaseUrl, \"1.8.\");\n                    localStorage.setItem(y,localStorage.getItem(x));\n                    localStorage.removeItem(x);\n                }\n            }\n            localStorage.setItem(vo+\"cleanup\", \"done\"); \n        }    \n        this.Project = vo + \"_\" + project + \"_\";\n    }\n    \n    setItem(itemKey:string, itemVal:string,dontSanitize?:boolean) {\n        localStorage.setItem(this.Project + itemKey, dontSanitize ? itemVal : (this.DOMPurify.sanitize(itemVal) + ''));\n    }\n    \n    getItem(itemKey:string,dontSanitize?:boolean):string {\n        let val = localStorage.getItem(this.Project + itemKey);\n        return dontSanitize ? val : (this.DOMPurify.sanitize(val) + '');\n    }\n    getItemDefault(itemKey:string, defaultValue:string):string {\n        let val = localStorage.getItem(this.Project + itemKey);\n        if (!val) {\n            val = defaultValue;\n        }\n        return this.DOMPurify.sanitize(val) + '';\n    }\n}","import { EventDispatcher } from \"./MatrixRequirementsAPI\";\nimport { ml } from \"./../matrixlib\";\nimport { app, globalMatrix,  matrixApplicationUI, matrixSession, restConnection } from \"../../globals\";\n\nexport type {\n    IPushMessage, IItemEditor, IItemWatched, IItemUpdated, IItemCreated, IItemDeleted,\n    ITodoChanged\n};\nexport { PushMessages };\n\ninterface IPushMessage {\n    subject:string,\n    project:string,\n    item:string,\n    version:string,\n    users:string,\n    parent:string,\n    title:string\n    error?:string;\n}\n// message about editor\ninterface IItemEditor { user: string, thisSocket: boolean }\n// message send if someone looks at the watched item\ninterface IItemWatched { item: string, users: string[], editor: IItemEditor, version: number }\n// message send if some modified the watched item\ninterface IItemUpdated { item: string, version: number, title: string, thisSocket: boolean }\ninterface IItemCreated { item: string, parent: string, title: string }\ninterface IItemDeleted { item: string }\n// message if someone created or closed a todo for the user\ninterface ITodoChanged { }\n\nclass PushMessages {\n    private webSocket:WebSocket;\n    private itemWatched:EventDispatcher<IItemWatched> =  new EventDispatcher<IItemWatched>();\n    private itemUpdated:EventDispatcher<IItemUpdated> =  new EventDispatcher<IItemUpdated>();\n    private itemCreated:EventDispatcher<IItemCreated> =  new EventDispatcher<IItemCreated>();\n    private itemDeleted:EventDispatcher<IItemDeleted> =  new EventDispatcher<IItemDeleted>();\n    private todoChanged:EventDispatcher<ITodoChanged> =  new EventDispatcher<ITodoChanged>();\n    static socketId:number = new Date().getTime()\n    constructor(  ) {\n    }\n\n    newConnection():JQueryDeferred<{}> {\n       \n        // make sure there's nothing left of an old connection\n\n        if (this.webSocket && this.webSocket.readyState != WebSocket.CLOSED) {\n            this.webSocket.onclose = null;\n            this.webSocket.onerror = null;\n            this.webSocket.onmessage = null;\n            this.webSocket.close();\n        }\n        \n        this.webSocket = null;\n\n        // create a new one\n        return this.connect();\n    }\n\n    connect():JQueryDeferred<number> {\n        let that = this;\n        let res = <JQueryDeferred<number>>$.Deferred();\n\n        ml.Logger.log(\"info\", \"Connecting to websocket\");\n       \n        if( this.webSocket ) { \n            // something is in the bush, it tries to (re)connect \n            if (this.webSocket.readyState == WebSocket.CONNECTING) {\n                ml.Logger.log(\"warning\", \"WebSocket is in connecting state.\");\n                res.resolve( WebSocket.CONNECTING );\n               return res;\n            } else  if (this.webSocket.readyState == WebSocket.CLOSING) {\n                ml.Logger.log(\"warning\", \"WebSocket is in closing state.\");\n                res.resolve(WebSocket.CLOSING);\n                return res;\n            } else  if( this.webSocket.readyState == WebSocket.OPEN){\n                ml.Logger.log(\"warning\", \"WebSocket is already opened.\");\n                res.resolve(WebSocket.OPEN);\n                return res;\n            }\n        }\n\n        this.webSocket = new WebSocket(globalMatrix.matrixBaseUrl.replace(\"https:\", \"wss:\").replace(\"http:\", \"ws:\") + \"/websocket?\");\n          \n        /**\n         * Binds functions to the listeners for the websocket.\n         */\n\n        this.webSocket.onerror = function(event:any){\n            ml.Logger.log(\"info\", \"Error from websocket\");\n            ml.Logger.log(\"info\", event.data);\n            res.reject();\n        };\n\n        this.webSocket.onmessage = function(event){\n            if(event.data) {\n                let message = <IPushMessage>JSON.parse(event.data);\n                console.log( message ); \n                if (message && message.error  == \"Cannot set you as editor\") {\n                    // indicate at least that we are watching\n                    let itemId = app.getCurrentItemId();\n                    if (itemId && ml.Item.parseRef(itemId).number) {\n                        if (that.preventConcurrentEdit()) {\n                            app.someOneIsChangingTheItem();\n                            that.watchItem( itemId );\n                        }\n                    }\n                } else {\n                    that.trigger(message);\n                }\n            }\n        };\n     \n        this.webSocket.onclose = function(event){\n         \n            ml.Logger.log(\"info\", \"Stop listening to news from server: \" +  event.code);\n            // check if I need to reconnect\n            that.reconnectAfterCloseMessage(10);\n        \n        }\n\n        this.webSocket.onopen = function(event){\n            ml.Logger.log(\"info\", \"Listening to news from server\");\n\n            // say hello to the server\n            that.send( { verb:\"openedSocket\" }, 0);\n\n            // we got (re)connected, so the server won't know in which editing states we are \n            that.sendCurrentEditingStatus();\n\n            \n            res.resolve(WebSocket.OPEN);\n        };\n        return res;\n    }\n\n    // verify if there's a category setting allowing concurrent of items of this type\n    private preventConcurrentEdit() {\n\n        let itemId = app.getCurrentItemId();\n        if (!itemId) return true;\n\n        let category =  ml.Item.parseRef(itemId).type;\n        if (!category) return true;\n\n        let concurrentEditSetting = <any>globalMatrix.ItemConfig.getCategorySetting(ml.Item.parseRef(itemId).type, \"concurrentEdit\");\n        if (concurrentEditSetting && concurrentEditSetting.disabled ) {\n            return false;\n        }   \n\n        return true;\n    }\n\n    private reconnectAfterCloseMessage( waitForServerRestartSeconds:number ) {\n        let that = this;\n\n        ml.Logger.log(\"Info\", \"Waiting for new connection for \" + waitForServerRestartSeconds);\n        // get something from server, if connection is not ok, do not try to reconnect\n         //Matrix-5036: no need to get everything from /rest/1. Server version is enough.\n        restConnection.getServer(\"?output=serverVersion\", true).done(function () {\n\n            // connection is still ok -> re'init the web sockets and send information about current view/edit state of an item\n            that.connect().done( function( result ) {\n                if (result != WebSocket.OPEN) {\n                    // not normal\n                    window.setTimeout( function() {\n                        that.reconnectAfterCloseMessage(waitForServerRestartSeconds);\n                    }, 1000);\n                }\n            }).fail( function() {\n                // that's not normal...\n                window.setTimeout( function() {\n                    that.reconnectAfterCloseMessage(waitForServerRestartSeconds);\n                }, 1000);\n            });\n\n        }).fail( function() {\n            if (waitForServerRestartSeconds==0) {\n                // apparently server got really disconnected\n                console.log( \"Server also disconnected\");\n                matrixSession.tryReconnect().done(() => {\n                    // if itemDetails is empty.. this is 10 seconds after a log out, so we need a full refresh\n                    matrixSession.updateUI($(\"#itemDetails\").html() != \"\");\n                });\n            } else {\n                // maybe user logs on as other user\n                window.setTimeout( function() {\n                    that.reconnectAfterCloseMessage(waitForServerRestartSeconds - 1);\n                }, 1000);\n            }\n        });\n    }\n\n    trigger(message:any) {\n\n        if (message.subject != \"todo\" && message.project != matrixSession.getProject()) {\n            ml.Logger.log(\"info\", \"Message for previous project\");\n            return;\n        }\n\n        switch (message.subject) {\n            case \"todo\":\n                this.todoChanged.dispatch( <ITodoChanged>{});\n                break;\n            \n            case \"itemChanged\":\n                if (this.preventConcurrentEdit()) {\n                    // the user does not edit the item\n                    this.itemUpdated.dispatch( <IItemUpdated>message );\n                }\n                break;\n            case \"itemMoved\":\n                matrixApplicationUI.lastMainItemForm.addMove(message.item, message.version);\n                break;\n            case \"itemDeleted\":\n                this.itemDeleted.dispatch( <IItemDeleted>message);\n                break;\n            case \"itemCreated\":\n                this.itemCreated.dispatch( <IItemCreated>message);\n                break;\n            case \"folderCreated\":\n                    this.itemCreated.dispatch( <IItemCreated>message);\n                    break;\n            case \"watching\":\n                if (this.preventConcurrentEdit()) {\n                    this.itemWatched.dispatch( <IItemWatched>message);\n                    if ((<IItemWatched>message).item == app.getCurrentItemId() && app.needsSave() && !message.editor) {\n                        // workaround MATRIX-4428 workaround: user edits an item and has another tab open with same item, user closes other tab\n                        this.editItem(app.getCurrentItemId());\n                    }\n\n                }\n                break;\n            case \"folderCreated\":\n                    this.itemCreated.dispatch( <IItemCreated>message);\n                    break;\n        } \n    }\n\n    // if the user is watching or editing something, let the server know\n    private sendCurrentEditingStatus() {\n        let itemId = app.getCurrentItemId();\n        \n        if (itemId && ml.Item.parseRef(itemId).number) {\n            if (app.needsSave()) {\n                this.editItem( itemId );\n            } else {\n                this.watchItem( itemId );\n            }\n        }\n    }\n    \n\n    private retryTimer:number;\n    private send( message:any, retryCount:number ) {\n        let that = this;\n        \n        message[\"socketId\"] = \"\" + PushMessages.socketId;\n        // make sure no old messages will be send after this\n        window.clearTimeout(this.retryTimer);\n        \n        // make sure there's a good connection\n        if (!this.webSocket || this.webSocket.readyState != WebSocket.OPEN) {\n            // no good connection    \n            if (retryCount<10) {\n                ml.Logger.log(\"info\",\"Websocket disconnected try to reconnect\");\n                this.connect( ).done( function( status:number) {\n                    if (status==WebSocket.OPEN ) {\n                        // got a new socket! send\n                        ml.Logger.log(\"info\",\"Send (after reconnect) to watcher: \" + message.verb);\n                        try {\n                            that.webSocket.send(JSON.stringify(message));\n                        } catch(ex) {\n                            ml.Logger.log(\"error\",\"Failing to send\");\n                        }\n                    } else {\n                        that.retryTimer = window.setTimeout( function() {\n                            that.send( message, retryCount+1);\n                        }, 1000);\n                    }\n                }).fail( function() {\n                    \n                });\n            } else {\n                ml.Logger.log(\"info\",\"Websocket disconnected - giving up, trying to send\");\n            }\n            return;\n        }\n\n        ml.Logger.log(\"info\",\"Send to watcher: \" + message.verb);\n        try {\n            this.webSocket.send(JSON.stringify(message));\n        } catch(ex) {\n            ml.Logger.log(\"error\",\"Failing to send\");\n        }\n    }\n\n    // start watching for item viewers\n    watchItem( itemId:string ) {\n        this.send({ \n            verb:\"watchItem\",\n            project: matrixSession.getProject(),\n            item: itemId \n        },0);\n    }\n    // start watching for item viewers\n    unWatchItem( ) {\n        this.send({ \n            verb:\"unwatchItem\"\n        },0);\n    }\n\n    // start edit item (user can save)\n    editItem( itemId:string ) {\n        this.send({ \n            verb:\"editItem\",\n            project: matrixSession.getProject(),\n            item: itemId \n        },0);\n    }\n\n    // stop edit item (user dose not need to save anymore)\n    unEditItem( ) {\n        this.send({ \n            verb:\"uneditItem\"\n        },0);\n    }\n\n    // event listeners\n    onTodoChanged( fn: ( args: ITodoChanged) => void) {\n        this.todoChanged.subscribe(this, fn);\n    }\n\n    onItemUpdated( fn: ( args: IItemUpdated) => void) {\n        this.itemUpdated.subscribe(this, fn);\n    }\n    onItemCreated( fn: ( args: IItemCreated) => void) {\n        this.itemCreated.subscribe(this, fn);\n    }\n    onItemDeleted( fn: ( args: IItemDeleted) => void) {\n        this.itemDeleted.subscribe(this, fn);\n    }\n    onItemWatched( fn: ( args: IItemWatched) => void) {\n        this.itemWatched.subscribe(this, fn);\n    }\n}","import { ControlState, globalMatrix, restConnection } from \"../../../globals\";\nimport { XRGetUser_User_UserType, XRTokenType, XRUserType } from \"../../../RestResult\";\nimport { ml } from \"../../matrixlib\";\n\nexport { TokenControl };\n\nclass TokenControl {\n\n\n    static showUserTokens(container:JQuery, login:string) {\n        let table = $(\"<table class='table'><thead><tr><th>Purpose</th><th>Token</th><th>Valid Until</th><th>Description</th><th></th></tr></thead></table>\").appendTo(container);\n        let body = $(\"<tbody>\").appendTo(table);\n\n        restConnection.getServer(\"user/\" + login).done(function (user: XRGetUser_User_UserType) {\n            TokenControl.showTokenList( body, user.login, null, user.tokenList );\n            TokenControl.showTokenAdd( body, user.login, null, () => {\n                container.html(\"\");\n                TokenControl.showUserTokens(container, login);\n            });\n        });\n    }\n\n    static showTokenList( body:JQuery, createUser: string, displayUser:string, tokenList:XRTokenType[]) {\n\n        if (tokenList) {\n            $.each(tokenList, function(tidx, token) {\n                let row = $(\"<tr>\").appendTo(body);\n                if (displayUser) row.append(\"<td>\" + displayUser +\"</td>\");\n                row.append(\"<td>\" + token.purpose +\"</td>\");\n                row.append(\"<td>\" + token.value +\"</td>\");\n                row.append(\"<td>\" + token.validToUserFormat +\"</td>\");\n                row.append(\"<td>\" + (token.reason?token.reason:\"\") +\"</td>\");\n                let deleteToken = $(\"<i style='cursor:pointer' class='deleteToken fal fa-trash-alt' data-user='\"+ (displayUser?displayUser:createUser) + \"'data-token='\"+ token.value + \"'>\");\n                row.append( $(\"<td>\").append(deleteToken));\n\n                deleteToken.click( function( event:JQueryMouseEventObject) {\n                    let tokenDel = $(event.delegateTarget);\n\n                    restConnection.deleteServerAsync(\"user/\" + tokenDel.data(\"user\") + \"/token\", { value: tokenDel.data(\"token\") }).done(function () {\n                        tokenDel.closest(\"tr\").remove();\n                    });\n                });\n            });\n        }\n    }\n\n    static showTokenAdd( body:JQuery, user: string, allUsers:XRUserType[], onAdded: Function ) {\n\n            let row = $(\"<tr>\").appendTo(body);\n            let userSelect:JQuery;\n\n            if (!user) {\n                let options = allUsers.map( function(user) {return {id:user.login, label:user.login};});\n\n                userSelect = $(\"<div id='tokenUser'>\").mxDropdown({\n                    controlState: ControlState.FormEdit,\n                    canEdit: true,\n                    help: \" \",\n                    fieldValue:\"\",\n                    valueChanged: function () {\n                        if (userSelect) {\n                            TokenControl.updateCreate(user, userSelect);\n                        }\n                    },\n                    parameter: {\n                        placeholder: 'select user',\n                        maxItems: 1,\n                        options: options,\n                        groups: [],\n                        create: false,\n                        sort: true,\n                        splitHuman:false\n                    }\n                });\n                row.append($(\"<td id='to_user'>\").append( userSelect));\n            }\n\n            row.append(\"<td id='to_purpose'></td>\");\n            row.append(\"<td id='to_token'></td>\");\n\n            let endDate = $(\"<input id='endTimePicker' type='text' class='form-control'>\");\n            endDate.datetimepicker({format:ml.UI.DateTime.getSimpleDateTimeFormatMoment()});\n            row.append($(\"<td id='to_date'>\").append(endDate));\n            endDate.on(\"dp.change\", function (e:any) {\n                TokenControl.updateCreate(user, userSelect);\n            });\n            let reason = $(\"<input id='tokenReason' type='text' class='form-control'>\");\n            reason.on(\"change keyup paste\", function (event: JQueryEventObject) {\n                TokenControl.updateCreate( user, userSelect);\n            });\n            row.append( $(\"<td id='to_reason'>\").append(reason));\n            row.append(\"<td><button class='btn btn-normal' id='tokenCreate' disabled>create</button></td>\");\n\n\n            $(\"#tokenCreate\").click( function() {\n                TokenControl.createToken(onAdded);\n            });\n    }\n\n    // change status of create button\n    private static async updateCreate(defaultUser: string, userSelect: JQuery) {\n\n        let date = $(\"#endTimePicker\").data(\"DateTimePicker\").date();\n        let user = defaultUser ? defaultUser : await userSelect.getController().getValueAsync();\n        let reason = $(\"#tokenReason\").val();\n\n        let f = new Date(date);\n        let n = new Date();\n\n        $(\"#tokenCreate\").data(\"date\", date).data(\"user\", user).data(\"reason\", reason);\n        ml.UI.setEnabled($(\"#tokenCreate\"), !!reason && date && !!user && Math.ceil((f.getTime() - n.getTime()) / 3600000) > 0);\n    }\n\n    // create token\n    private static createToken( onAdded:Function) {\n\n        let date =  $(\"#tokenCreate\").data(\"date\");\n        let user =  $(\"#tokenCreate\").data(\"user\");\n        let reason =  $(\"#tokenCreate\").data(\"reason\");\n\n        let future = new Date(date);\n        let now = new Date();\n        let delta = Math.ceil((future.getTime()-now.getTime())/3600000);\n\n        restConnection.postServer(\"user/\" + user.toLowerCase() + \"/token\", {\n            purpose: \"oauth\",\n            validity:delta,\n            reason:reason\n        }).done(function (token:any) {\n            onAdded();\n        });\n    }\n}\n","import { globalMatrix, IDataStorage } from \"../globals\";\n\nexport { ProjectStorageMobile };\n\nclass ProjectStorageMobile implements IDataStorage {\n    private Project:string;\n    constructor(project:string) {\n        this.Project = globalMatrix.matrixBaseUrl + \"_\" + project + \"_\";\n    }\n    setItem(itemKey:string, itemVal:string) {\n        localStorage.setItem(this.Project + itemKey, itemVal);\n    }\n    \n    getItem(itemKey:string):string {\n         return localStorage.getItem(this.Project + itemKey);\n    }\n    getItemDefault(itemKey:string, defaultValue:string):string {\n        let v = localStorage.getItem(this.Project + itemKey);\n        return v?v:defaultValue;\n   }\n}\n","\nimport { IRestResult, globalMatrix, IRestParam, IStringMap, matrixSession, app } from \"../../globals\";\nimport { HistoryTools } from \"../UI/Tools/ItemHistoryView\";\nimport { ml } from \"./../matrixlib\";\nimport { EImportMode } from \"../../common/businesslogic/ComponentImport\"\n\nexport type {\n    IRestConfig, IRestTimer, IJcxhr, IResponseJson, IFileParam, IFileUploadProgress,\n    IFileUploadResult, IError224, IError224Field\n};\nexport {\n    RestConnector\n};\n\ninterface IRestConfig { server: string }\ninterface IRestTimer { start: number, end?: number, status?: number, command?: string, type?: string }\ninterface IJcxhr { status: number, responseText: string, responseJSON: IResponseJson, displayError: string, statusText?: string }\ninterface IResponseJson { category: string, detailsList: string[], displayError?: string, code?: string }\ninterface IFileParam { name: string }\ninterface IFileUploadProgress { position?: number, loaded?: number, totalSize?: number, total?: number }\ninterface IFileUploadResult { fileId: string, fileFullPath: string, key: string }\ninterface IError224 { fields: IError224Field[] }\ninterface IError224Field { fieldId: number, beforeCleanup: string, afterCleanup: string }\n\nclass RestConnector {\n\n    private restServer:string;\n    private restServerProject:string;\n    private timer:IRestTimer = {start: 0, end: 0, command:\"\", type:\"\"};\n    private keepAlive:number;\n\n    constructor(config:IRestConfig) {\n        this.restServer = config.server;\n    }\n\n    setProject (projectName:string):void {\n        this.restServerProject = this.restServer + \"/\" + projectName;\n    };\n\n    getProject (cmd:string, ignoreErrors?:boolean, ignoreFilters?:boolean):JQueryDeferred<IRestResult> {\n        var labelFilter = ml.LabelTools.getFilter();\n        if (!ignoreFilters && labelFilter && labelFilter.length > 0) {\n            var filter = \"?\";\n            if (cmd.indexOf(\"?\") !== -1) {\n                // there is already at least one parameter: so just add another\n                filter = \"&\";\n            }\n            filter += \"filter=\" + labelFilter;\n            cmd += filter;\n        }\n        if (globalMatrix.ItemConfig.getTimeWarp()) {\n            var timewarp = \"?\";\n            if (cmd.indexOf(\"?\") !== -1) {\n                // there is already at least one parameter: so just add another\n                timewarp = \"&\";\n            }\n            timewarp += \"atDate=\" + globalMatrix.ItemConfig.getTimeWarp();\n            cmd += timewarp;\n        }\n\n        return this.get(this.restServerProject + \"/\" + cmd, ignoreErrors);\n    }\n\n    getServer(cmd:string, noRetry?:boolean):JQueryDeferred<IRestResult> {\n        return this.get(this.restServer + \"/\" + cmd, noRetry);\n    }\n\n\n    postServer(cmd:string, param?:IRestParam, payload?:boolean):JQueryDeferred<IRestResult> {\n        return this.post(this.restServer + \"/\" + cmd, param, payload);\n    }\n\n    postProject(cmd:string, param:IRestParam, payload?:boolean, ):JQueryDeferred<IRestResult> {\n\n\n        return this.post(this.restServerProject + \"/\" + cmd, param, payload);\n    }\n\n    postProjectJson(cmd:string, data:unknown):JQueryDeferred<IRestResult> {\n        return this.postJson(this.restServerProject + \"/\" + cmd, data);\n    }\n\n    putServer(cmd:string, param:IRestParam, asPayload?:boolean):JQueryDeferred<IRestResult> {\n        return this.put(this.restServer + \"/\" + cmd, param, asPayload);\n    }\n\n    putProject(cmd:string, param:IRestParam, itemId?:string):JQueryDeferred<IRestResult> {\n\n        var labelFilter = ml.LabelTools.getFilter();\n        if (labelFilter && labelFilter.length > 0) {\n            param[\"filter\"] = labelFilter;\n        }\n\n        return this.put(this.restServerProject + \"/\" + cmd, param, null, itemId);\n    }\n\n    deleteProjectAsync(cmd:string, param:IRestParam, asString?:boolean):JQueryDeferred<IRestResult> {\n        return this.deleteRestAsync(this.restServerProject + \"/\" + cmd, param, asString);\n    }\n\n    deleteServerAsync(cmd:string, param:IRestParam, asString?:boolean):JQueryDeferred<IRestResult> {\n        return this.deleteRestAsync(this.restServer + \"/\" + cmd, param,asString);\n    }\n\n    // file up and download\n    download(cmd:string, params?:string[]|IStringMap):void {\n\n        ml.Logger.log(\"info\", \"Downloading: \" + this.restServerProject + \"/\" + cmd);\n\n        var iframe = $('<iframe width=1 height=1 frameborder=0 style=\"display:none\">');\n\n        iframe.appendTo('body');\n\n        var form = $('<form action=\"' + this.restServerProject + \"/\" + cmd + '\" method=\"get\"></form>');\n        if (params) {\n            $.each(params, function (index, value) {\n                form.append($(\"<input name='\" + index + \"'>\").val(value));\n            });\n        }\n        iframe.contents().find(\"body\").append(form);\n        form.submit();\n    }\n\n    getFile(cmd:string, dataType?:string):JQueryDeferred<IRestResult> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        ml.Logger.log(\"info\", \"GET FILE: \" + this.restServerProject + \"/\" + cmd);\n\n        $.ajaxSetup({cache: false}); // avoid IE to cache rest calls\n        $.ajax({type: 'get',\n            url: that.restServerProject + \"/\" + cmd,\n            dataType:dataType\n        }).done(function (data) {\n            ml.Logger.log(\"debug\", \"RESPONSE: \" + \"retrieved file from restServer...\");\n            res.resolve(data);\n        }).fail(function (jqxhr, textStatus, error) {\n            that.handleError(jqxhr, textStatus, error, \"GET FILE: \" + that.restServerProject + \"/\" + cmd).done(function () {\n                // user signed in again\n                $.ajax({type: 'get',\n                    url: that.restServerProject + \"/\" + cmd\n                }).done(function (data) {\n                    ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                    res.resolve(data);\n                }).fail(function (jqxhr, textStatus, error) {\n                    ml.UI.showError(\"Could not get file!\", ml.UI.getDisplayError(jqxhr, textStatus, error));\n                });\n            }).fail(function () {\n                res.reject();\n            });\n        });\n        $.ajaxSetup({cache: true});\n        return res;\n    }\n\n    uploadFileProjectAsync(file: IFileParam, progress: (p:IFileUploadProgress) =>  void): JQueryDeferred<IFileUploadResult> {\n        return this.uploadFileServerAsync(file, progress, this.restServerProject, null, \"/file\");\n    }\n\n    fetchFileAsync(url: string, progress: (p:IFileUploadProgress) =>  void): JQueryDeferred<IFileUploadResult> {\n         return this.uploadFileServerAsync(null, progress, this.restServerProject, {url:url}, \"/file\");\n    }\n\n    uploadFileCustomerAsync(file:IFileParam, progress:(p:IFileUploadProgress) =>  void):JQueryDeferred<IFileUploadResult> {\n        return this.uploadFileServerAsync(file, progress, this.restServer + \"/all\", null, \"/file\");\n    }\n\n    importProjectAsync(file:IFileParam, progress:(p:IFileUploadProgress) =>  void, params:{}):any {\n        return this.uploadFileServerAsync(file, progress, this.restServer + \"/\", params, \"\");\n    }\n\n    uploadFileServerAsync(file:IFileParam, progress:(p:IFileUploadProgress) =>  void, target:string, params:{}, urlSuffix:string):JQueryDeferred<IFileUploadResult> {\n        let that = this;\n\n        var formData = new FormData();\n        if (file) {\n            formData.append(\"file\", <any>file);\n        }\n        if (params) {\n            $.each(params, function(parName, parVal) {\n                formData.append(parName, parVal);\n            });\n        }\n        ml.Logger.log(\"info\", file?`upload FILE: ${file.name}`:`fetch ${JSON.stringify(params)}`);\n        var res = $.Deferred();\n        let url = target ? target + urlSuffix : globalMatrix.matrixRestUrl + \"/all\" + urlSuffix;\n\n        $.ajax({\n            url: url, //Server script to process data\n            type: 'POST',\n            xhr: function () {  // Custom XMLHttpRequest\n                var myXhr: JQueryXHR  = $.ajaxSettings.xhr();\n                if (myXhr.upload) { // Check if upload property exists\n                    myXhr.upload.addEventListener('progress', progress, false);\n                }\n                return myXhr;\n            },\n            success: function (data, textStatus, jqXHR) {\n                res.resolve(data);\n            },\n            error: function (jqxhr, textStatus, error) {\n                if (that.isTimeout(<any>jqxhr)) {\n                    ml.Logger.log(\"info\", \"Trying to reconnect...\");\n                    matrixSession.signInAfterTimeout().done(function () {\n                        that.uploadFileServerAsync(file, progress, target, params, urlSuffix).done( function( result ) {\n                            res.resolve( result );\n                        });\n                    }).fail(function () {\n                        let details = ( jqxhr && jqxhr.responseJSON && jqxhr.responseJSON.detailsList && jqxhr.responseJSON.detailsList.length> 0 && jqxhr.responseJSON.detailsList[0])?(\" Details \"+jqxhr.responseJSON.detailsList[0]):\"\";\n\n                        res.reject(\"Failed to reconnect. Status:\" + textStatus + \". Error was:\" + error + details);\n                    });\n                } else {\n                    let details = ( jqxhr && jqxhr.responseJSON && jqxhr.responseJSON.detailsList && jqxhr.responseJSON.detailsList.length> 0 && jqxhr.responseJSON.detailsList[0])?(\" Details \"+jqxhr.responseJSON.detailsList[0]):\"\";\n\n                    res.reject(\"Upload failed. Status:\" + textStatus + \". Error was:\" + error + details);\n                }\n            },\n            complete: function (response)\n            {\n                ml.Logger.log(\"info\", response.responseText);\n            },\n            // Form data\n            data: formData,\n            dataType: 'json',\n            //Options to tell jQuery not to process data or worry about content-type.\n            cache: false,\n            contentType: false,\n            processData: false\n        });\n        return <any>res;\n    }\n\n    convertExcelProjectAsync(file: IFileParam, progress: (p:IFileUploadProgress) =>  void): JQueryDeferred<string> {\n        return this.convertExcelServerAsync(file, progress);\n    }\n\n    convertExcelServerAsync(file:IFileParam, progress:(p:IFileUploadProgress) =>  void):JQueryDeferred<string> {\n        var formData = new FormData();\n        if (file) {\n            formData.append(\"file\", <any>file);\n        }\n\n        ml.Logger.log(\"info\", `convert FILE: ${  file.name}`);\n        var res = $.Deferred();\n        let url = this.restServerProject+\"/excelxml\";\n\n        $.ajax({\n            url: url, //Server script to process data\n            type: 'POST',\n            xhr: function () {  // Custom XMLHttpRequest\n                var myXhr: JQueryXHR  = $.ajaxSettings.xhr();\n                if (myXhr.upload) { // Check if upload property exists\n                    myXhr.upload.addEventListener('progress', progress, false);\n                }\n                return myXhr;\n            },\n            success: function (data, textStatus, jqXHR) {\n                res.resolve(data);\n            },\n            error: function (jqxhr, textStatus, error) {\n                let details = ( jqxhr && jqxhr.responseJSON && jqxhr.responseJSON.detailsList && jqxhr.responseJSON.detailsList.length> 0 && jqxhr.responseJSON.detailsList[0])?(\" Details \"+jqxhr.responseJSON.detailsList[0]):\"\";\n\n                res.reject(\"Upload failed. Status:\" + textStatus + \". Error was:\" + error + details);\n            },\n            complete: function (response)\n            {\n                ml.Logger.log(\"info\", \"completed conversion of excel\");\n            },\n            // Form data\n            data: formData,\n            dataType: 'text',\n            //Options to tell jQuery not to process data or worry about content-type.\n            cache: false,\n            contentType: false,\n            processData: false\n        });\n        return <any>res;\n    }\n\n    isTimeout(jqxhr: IJcxhr):boolean {\n        if (jqxhr.status !== 403) {\n            return false;\n        }\n        if (!jqxhr.responseText) {\n            return false;\n        }\n        if ( jqxhr.responseJSON && jqxhr.responseJSON.displayError == \"Unauthorized PUT without authentication for change\") {\n            // CSFR token missing\n            return true;\n        }\n        if ( jqxhr.responseJSON && jqxhr.responseJSON.displayError && jqxhr.responseJSON.displayError.indexOf(\"session is null\")==0) {\n            // CSFR token missing\n            return true;\n        }\n        if (jqxhr.responseText.indexOf(\"session is null, exception in authorization decoding session is null, no authorization header\") !== -1) {\n            // session expired\n            return true;\n        }\n        if (jqxhr.responseText.indexOf(\"session is null, exception in authorization decoding session is null, no authorization header\") !== -1) {\n            // google auth expired\n            return true;\n        }\n        return false;\n    }\n    isGatewayTimeout(jqxhr: IJcxhr):boolean {\n        if (jqxhr.status !== 504) {\n            return false;\n        }\n        if (!jqxhr.responseText) {\n            return false;\n        }\n        if (jqxhr.responseText.indexOf(\"Gateway Time-out\") !== -1) {\n            return true;\n        }\n        return false;\n    }\n    // error handling with automatic reconnect\n    handleError(jqxhr:IJcxhr, textStatus:string, error:string, cmd:string, param?:IRestParam, itemId?:string):JQueryDeferred<IRestResult>  {\n        let that = this;\n\n\n        var res = $.Deferred();\n           // sometimes error does not arrive as json but only as text\n        if (jqxhr.responseText && !jqxhr.responseJSON) {\n           try {\n                jqxhr.responseJSON = JSON.parse(jqxhr.responseText);\n           } catch (ex) {\n               // well this is no JSON\n           }\n        }\n\n        if ( jqxhr && jqxhr.status == 422 && jqxhr.responseJSON && (<IError224><unknown>jqxhr.responseJSON).fields) {\n            let errors:string[] = [];\n            for (let errorField of (<IError224><unknown>jqxhr.responseJSON).fields) {\n                console.log( JSON.stringify(errorField) );\n                let fieldName = globalMatrix.ItemConfig.getFieldName(errorField.fieldId);\n                errors.push( fieldName?fieldName:(''+errorField.fieldId));\n            }\n            ml.UI.showError(\"Some field(s) have invalid html tags\",  \"Fields with bad content: \" + errors.join(\",\"));\n            res.reject();\n            return res;\n        } else if (jqxhr && jqxhr.status == 500 && jqxhr.responseJSON && jqxhr.responseJSON.category) {\n\n            if ( jqxhr.responseJSON.displayError == \"This item has been modified\" ) {\n\n                if (itemId && app.getCurrentItemId() == itemId) {\n                    let ht = new HistoryTools();\n                    ht.diffAgainstLatest( param );\n                } else {\n                    // user double clicked in project and hell broke loose\n                    // (we just ignore)\n                }\n\n                res.reject();\n                return res;\n            } else if  (jqxhr.responseJSON.displayError == \"Last operation would overflow number of licenses (error in compute)\"){\n                ml.UI.showError(\"Licensing Error\", \"You cannot change the access. There are not enough write licenses\" );\n                res.reject();\n                return res;\n            }\n\n            if ( jqxhr.displayError ) {\n                ml.UI.showError(jqxhr.responseJSON.category, jqxhr.displayError );\n                res.reject();\n                return res;\n            }\n\n            if (jqxhr.responseJSON.category == \"Permission violation\") {\n                ml.UI.showError(jqxhr.responseJSON.category, jqxhr.responseJSON.detailsList && jqxhr.responseJSON.detailsList.length>3? jqxhr.responseJSON.detailsList[2]:\"\" );\n                res.reject();\n                return res;\n            } else if (jqxhr.responseJSON.displayError &&  jqxhr.responseJSON.displayError.indexOf(\"has no sufficient permission for this action on project\")!=-1) {\n                ml.UI.showError(\"Permission Violation\", \"You do not have access to this project\" );\n                res.reject();\n            } else {\n                ml.UI.showError(jqxhr.responseJSON.category, jqxhr.responseJSON.detailsList && jqxhr.responseJSON.detailsList.length>0? jqxhr.responseJSON.detailsList[0]:\"\" );\n                res.reject();\n                return res;\n            }\n        }\n\n        if (this.isTimeout(jqxhr)) {\n            ml.Logger.log(\"info\", \"Trying to reconnect...\");\n            // assume this ws a sign in problem.sign in quietly if possible and do it again\n            matrixSession.signInAfterTimeout().done(function () {\n                res.resolve();\n            }).fail(function () {\n                ml.UI.showError(\"Not signed in!\", ml.UI.getDisplayError(jqxhr, textStatus, error));\n                res.reject();\n            });\n        } else if (this.isGatewayTimeout(jqxhr)) {\n            ml.Logger.log(\"info\", \"gateway timeout...\");\n            // assume this ws a sign in problem.sign in quietly if possible and do it again\n            res.reject(\"gatewayTimeout\");\n        } else {\n            ml.Logger.log(\"error\", cmd);\n            ml.UI.showError(\"Server error.\",  ml.UI.getDisplayError(jqxhr, textStatus, error));\n            res.reject();\n        }\n        return res;\n    }\n\n    private get(url:string, noRetry?:boolean):JQueryDeferred<IRestResult> {\n        let that = this;\n\n        var res = $.Deferred();\n        ml.Logger.log(\"info\", \"GET: \" + url);\n        $.ajaxSetup({cache: false}); // avoid IE to cache rest calls\n        var lastTimer = ((url.indexOf(\"?\") !== -1) ? \"&\" : \"?\") + \"td=\" + (this.timer.end - this.timer.start);\n        let adminUI = (globalMatrix.matrixProduct == \"Configuration Client\") ? \"&adminUI=1\" : \"\";\n        this.timer = {\n            start: (new Date()).getTime(),\n            command: encodeURIComponent(url),\n            type: \"get\"\n        };\n        $.getJSON(url + lastTimer + adminUI).done(function (data:{}) {\n\n\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = 200;\n            ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n            res.resolve(data);\n        }).fail(function (jqxhr:IJcxhr, textStatus:string, error:string) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = jqxhr.status;\n            if (noRetry) {\n                res.reject(jqxhr, textStatus, error);\n            } else {\n                that.handleError(jqxhr, textStatus, error, \"GET: \" + url).done(function () {\n                    $.getJSON(url).done(function (data) {\n                        ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                        res.resolve(data);\n                    }).fail(function (jqxhr, textStatus, error) {\n                        ml.UI.showError(\"Failed to get item!\",  ml.UI.getDisplayError(jqxhr, textStatus, error));\n                    });\n                }).fail(function () {\n                    res.reject(jqxhr, textStatus, error);\n                });\n            }\n        });\n        $.ajaxSetup({cache: true});\n\n        return res;\n    }\n    private post(url:string, param?:IRestParam, asPayload?:boolean):JQueryDeferred<IRestResult> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        if (typeof param !== 'undefined') {\n            ml.Logger.log(\"info\", \"POST: \" + url );\n            param.td = (this.timer.end - this.timer.start);\n            this.timer = {\n                start: (new Date()).getTime(),\n                command: encodeURIComponent(url),\n                type: \"post\"\n            };\n            //Content-type should be application/json for payload.\n           $.post({\n                url: url,\n                data: asPayload ? JSON.stringify(param) : param,\n                dataType: asPayload?\"json\":\"\",\n                contentType: asPayload?\"application/json\":\"\"\n           }).done(function (data) {\n                that.timer.end = (new Date()).getTime();\n                that.timer.status = 200;\n                ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                res.resolve(data);\n            }).fail(function (jqxhr, textStatus, error) {\n                that.timer.end = (new Date()).getTime();\n                that.timer.status = jqxhr.status;\n\n                that.handleError(jqxhr, textStatus, error, \"POST: \" + url + \"?\" + jQuery.param(param, true)).done(function () {\n                    $.post(url, param).done(function (data) {\n                        ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                        res.resolve(data);\n                    }).fail(function (jqxhr, textStatus, error) {\n                        ml.UI.showError(\"Failed to post to server!\", ml.UI.getDisplayError(jqxhr, textStatus, error));\n                    });\n\n                }).fail(function () {\n                    res.reject(jqxhr, textStatus, error);\n                });\n\n            });\n        } else {\n            ml.Logger.log(\"debug\", \"POST: \" + url);\n            var lasttimer = {td: (this.timer.end - this.timer.start)};\n            this.timer = {\n                start: (new Date()).getTime(),\n                command: encodeURIComponent(url)\n            };\n            $.post(url, lasttimer).done(function (data) {\n                that.timer.end = (new Date()).getTime();\n                that.timer.status = 200;\n                ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                res.resolve(data);\n            }).fail(function (jqxhr, textStatus, error) {\n                that.timer.end = (new Date()).getTime();\n                that.timer.status = jqxhr.status;\n                if (url.indexOf(\"/logout\") == url.length-7) {\n                    // attempt of logout when there's no more session, that's fine\n                    res.resolve();\n                } else {\n                    that.handleError(jqxhr, textStatus, error, \"POST: \" + url).done(function () {\n\n                        $.post(url).done(function (data) {\n                            ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                            res.resolve(data);\n                        }).fail(function (jqxhr, textStatus, error) {\n                            ml.UI.showError(\"Failed to post to server!\", ml.UI.getDisplayError(jqxhr, textStatus, error));\n                        });\n\n                    }).fail(function () {\n                        res.reject(jqxhr, textStatus, error);\n                    });\n                }\n            });\n        }\n        return res;\n    }\n    private postJson(url:string, data:unknown):JQueryDeferred<IRestResult> {\n        var res = $.Deferred();\n        ml.Logger.log(\"info\", \"POST: \" + url );\n        this.timer = {\n            start: (new Date()).getTime(),\n            command: encodeURIComponent(url),\n            type: \"post\"\n        };\n        $.ajax(url,{\n            type:\"post\",\n            contentType:\"application/json\",\n            data:JSON.stringify(data)\n        }).done((result) => {\n            this.timer.end = (new Date()).getTime();\n            this.timer.status = 200;\n            ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n            res.resolve(result);\n        }).fail((jqxhr, textStatus, error) => {\n            this.timer.end = (new Date()).getTime();\n            this.timer.status = jqxhr.status;\n            res.reject(jqxhr, textStatus, error);\n        });\n        return res;\n    }\n\n    postSpecialServer(cmd:string, param:IRestParam):JQueryDeferred<IRestResult> {\n        return this.postSpecial(this.restServer + \"/\" + cmd, param);\n    }\n    private postSpecial(url:string, param:IRestParam):JQueryDeferred<IRestResult> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        ml.Logger.log(\"info\", \"POST: \" + url );\n        param.td = (this.timer.end - this.timer.start);\n        this.timer = {\n            start: (new Date()).getTime(),\n            command: encodeURIComponent(url),\n            type: \"post\"\n        };\n\n        //  post(url: string, data?: Object|string, success?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string): JQueryXHR;\n        $.ajax({url:url, type:\"POST\", data:JSON.stringify(param), contentType: \"application/json;charset=UTF-8\", dataType:\"json\"})\n        .done(function (data) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = 200;\n            ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n            res.resolve(data);\n        }).fail(function (jqxhr, textStatus, error) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = jqxhr.status;\n            that.handleError(jqxhr, textStatus, error, \"POST: \" + url + \"?\" + jQuery.param(param, true)).done(function () {\n                // try again after timeout\n                $.ajax({url:url, type:\"POST\", data:JSON.stringify(param), contentType: \"application/json;charset=UTF-8\", dataType:\"json\"}).done(function (data) {\n                    ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                    res.resolve(data);\n                }).fail(function (jqxhr, textStatus, error) {\n                    ml.UI.showError(\"Failed to post to server!\", ml.UI.getDisplayError(jqxhr, textStatus, error));\n                });\n\n            }).fail(function () {\n                res.reject(jqxhr, textStatus, error);\n            });\n        });\n\n        return res;\n    }\n    private put(url:string, param:IRestParam, asPayload?:boolean, itemId?:string):JQueryDeferred<IRestResult> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        ml.Logger.log(\"info\", \"PUT: \" + url );\n        param.td = (this.timer.end - this.timer.start);\n        this.timer = {\n            start: (new Date()).getTime(),\n            command: encodeURIComponent(url),\n            type: \"put\"\n        };\n        $.ajax({type: 'put',\n            url: url,\n            processData: false,\n            data: asPayload?JSON.stringify(param):jQuery.param(param, true),\n            contentType: asPayload?'application/json; charset=UTF-8':'application/x-www-form-urlencoded; charset=UTF-8',\n            dataType: 'json'\n        }).done(function (data) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = 200;\n            ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n            res.resolve(data);\n        }).fail(function(jqxhr: IJcxhr, textStatus:string, error:string) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = jqxhr.status;\n            that.handleError(jqxhr, textStatus, error, \"PUT: \" + url + \"?\" + jQuery.param(param, true), param, itemId).done(function () {\n\n                $.ajax({type: 'put',\n                    url: url,\n                    processData: false,\n                    data: jQuery.param(param, true),\n                    contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\n                    dataType: 'json'\n                }).done(function (data) {\n                    ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                    res.resolve(data);\n                }).fail(function (jqxhr, textStatus, error) {\n                    ml.UI.showError(\"Failed to modify item!\",  ml.UI.getDisplayError(jqxhr, textStatus, error));\n                });\n            }).fail(function (msg) {\n                res.reject(msg);\n            });\n        });\n\n        return res;\n    }\n    private deleteRestAsync(url: string, param: IRestParam, asString:boolean):JQueryDeferred<IRestResult> {\n        let that = this;\n\n        var res = $.Deferred();\n\n        ml.Logger.log(\"info\", \"DELETE: \" + url + \"?\" + jQuery.param(param, true));\n        param.td = (this.timer.end - this.timer.start);\n        this.timer = {\n            start: (new Date()).getTime(),\n            command: encodeURIComponent(url),\n            type: \"delete\"\n        };\n        $.ajax({type: 'delete',\n            url: url,\n            processData: false,\n            data: asString?JSON.stringify(param):jQuery.param(param, true),\n            contentType: 'application/text',\n            dataType: 'text'\n        }).done(function (data) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = 200;\n            ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n            res.resolve(data);\n        }).fail(function(jqxhr: IJcxhr, textStatus:string, error:string) {\n            that.timer.end = (new Date()).getTime();\n            that.timer.status = jqxhr.status;\n\n            that.handleError(jqxhr, textStatus, error, \"DELETE: \" + url + \"?\" + jQuery.param(param, true)).done(function () {\n\n                $.ajax({type: 'delete',\n                    url: url,\n                    processData: false,\n                    data: jQuery.param(param, true),\n                    contentType: 'application/text',\n                    dataType: 'text'\n                }).done(function (data) {\n                    ml.Logger.log(\"debug\", \"RESPONSE: \" + JSON.stringify(data));\n                    res.resolve(data);\n                }).fail(function () {\n                    res.reject();\n                });\n            }).fail(function () {\n                res.reject();\n            });\n        });\n\n        return res;\n    }\n\n}\n","import { IFileUploadProgress, IFileParam } from \"../businesslogic/index\";\nimport { ml } from \"./../matrixlib\";\nimport { globalMatrix, restConnection } from \"../../globals\";\nimport { IFileTools, IUploadedFileInfo, IBlockingProgressUITask } from \"./MatrixLibInterfaces\";\n\nexport { FileTools };\n\nclass FileTools implements IFileTools {\n    private uploadInfo:IUploadedFileInfo[];\n\n        private uploadFilesAsync(files:FileList|File[], idx:number):JQueryDeferred<IUploadedFileInfo[]> {\n            let that = this;\n            \n            var res:JQueryDeferred<IUploadedFileInfo[]> = $.Deferred();\n            if (!files || files.length <= idx) {\n                res.resolve(this.uploadInfo);\n                return res;\n            }\n\n            restConnection.uploadFileProjectAsync(files[idx], function (p: IFileUploadProgress) {\n                var done = p.position || p.loaded;\n                var total = p.totalSize || p.total;\n\n                ml.UI.BlockingProgress.SetProgress(idx, 99 * done / total);\n\n            }).done(function (result:{fileId:string,key:string}) {\n                ml.UI.BlockingProgress.SetProgress(idx, 100);\n                that.uploadInfo.push({\n                    fileName: files[idx].name,\n                    fileId: result.fileId + \"?key=\" + result.key,\n                    uploaded: true\n                });\n                that.uploadFilesAsync(files, idx + 1).done(function (fini) {\n                    res.resolve(fini);\n                }).fail(function (fini) {\n                    res.reject(fini);\n                });\n                ml.UI.BlockingProgress.SetProgress(idx, 100);\n            }).fail(function (error:any) {\n                ml.UI.BlockingProgress.SetProgressError(idx, \"Failed to upload file!\");\n                that.uploadInfo.push({\n                    fileName: files[idx].name,\n                    fileId: error,\n                    uploaded: false\n                });\n                res.reject(that.uploadInfo);\n            });\n            return res;\n        }\n\n        UploadFilesAsync (files:FileList|File[]):JQueryDeferred<IUploadedFileInfo[]> {\n            var tasks:IBlockingProgressUITask[] = [];\n            $.each(files, function (idx, file) {\n                tasks.push({name: file.name});\n            });\n            ml.UI.BlockingProgress.Init(tasks);\n            this.uploadInfo = [];\n            return this.uploadFilesAsync(files, 0);\n        };\n\n        UploadFileAsync (file:File):JQueryDeferred<IUploadedFileInfo[]> {\n            var tasks:IBlockingProgressUITask[] = [];\n           \n            tasks.push({name: file.name});\n            ml.UI.BlockingProgress.Init(tasks);\n            this.uploadInfo = [];\n            return this.uploadFilesAsync([file], 0);\n        };\n\n        \n        convertXLSXAsync(file:IFileParam):JQueryDeferred<string> {\n            let that = this;\n            \n            var res:JQueryDeferred<string> = $.Deferred();\n          \n            var tasks:IBlockingProgressUITask[] = [];\n            tasks.push({name: \"converting excel ...\"});\n            ml.UI.BlockingProgress.Init(tasks);\n            \n            restConnection.convertExcelProjectAsync(file, function (p: IFileUploadProgress) {\n                var done = p.position || p.loaded;\n                var total = p.totalSize || p.total;\n\n                ml.UI.BlockingProgress.SetProgress(0, 99 * done / total);\n\n            }).done(function (result:string) {\n                ml.UI.BlockingProgress.SetProgress(0, 100);\n                res.resolve(result);\n            }).fail(function (error:any) {\n                ml.UI.BlockingProgress.SetProgressError(0, \"Failed to upload file!\");\n                res.reject(\"\");\n            });\n            return res;\n        }\n\n}","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ICleanup } from \"../../ProjectSettings\";\nimport { globalMatrix, matrixSession, } from \"../../globals\";\n\nexport type { IHTMLClean, IHTMLReplacement, IHTMLWhiteList };\nexport { HTMLCleaner };\n\ninterface IHTMLClean {\n    whiteLists: {\n        styles: IHTMLWhiteList [ ],\n        classes: IHTMLWhiteList [ ],\n        properties: IHTMLWhiteList [ ],\n        data: IHTMLWhiteList [ ],\n    }, blackLists: {\n        removeTags:string[],\n        keepOnlyInside:string[],\n        removeEmpty:string[]\n    }, \n    tagReplacements: IHTMLReplacement[],\n    tagReplacementsDoc: IHTMLReplacement[]\n}\ninterface IHTMLReplacement {\n    what:string,\n    with:string\n}\ninterface IHTMLWhiteList {\n    tagName:string,\n    allowed:string[]\n}\n\n\nclass HTMLCleaner {\n    private autoEscape:boolean;\n    text:string;\n    cleanConfig : IHTMLClean = {\n        blackLists: {\n            removeTags : [\"HEAD\", \"FOOT\", \"STYLE\", \"SCRIPT\", \"IFRAME\", 'applet', 'embed', 'noframes', 'noscript', 'meta','link', 'template'\n            ],\n            keepOnlyInside: ['font','a:not([href])',\n            // u: word..\n            'u'],\n            removeEmpty: ['p','a'],    \n        }, whiteLists: {\n            styles: [{ tagName:\"SPAN\", allowed: [\n                \"font-weight:bold\", \n                \"font-style:italic\", \n                \"text-decoration:underline\",\n                \"text-align:right\",\n                \"text-align:left\",\n                \"text-align:center\",\n                \"margin-left:25px\",\n                \"margin-left:50px\",\n                \"margin-left:75px\",\n                \"margin-left:100px\",\n                \"margin-left:125px\",\n                \"line-height:1\",\n                \"line-height:1.2\",\n                \"line-height:1.4\",\n                \"line-height:1.6\",\n                \"line-height:1.8\",\n                \"line-height:2\",\n                \"line-height:3\"]  \n            }],\n             classes: [\n                 { tagName:\"SPAN\", allowed: [ \n                    \"captionDetails\",\"captionFix\",\"captionPre\",\"captionFig\",\"captionPost\",\"captionText\",\"referenceDetails\",\"referenceFix\",\"referencePre\",\"referenceFig\",\"referencePost\",\"referenceText\"\n                 ]},            \n                 { tagName:\"P\", allowed: [ \"h1\", \"h2\", \"h3\", \"h4\", \"caption\"]}\n            ],\n            properties: [\n                 { tagName:\"IMG\", allowed: [ \"src\" ]},            \n                 { tagName:\"A\", allowed: [ \"href\",\"target\"]},            \n                 { tagName:\"SPAN\", allowed: [ \"contenteditable\"]},\n                 { tagName:\"TD\", allowed: [ \"colspan\", \"rowspan\"]},\n                 { tagName:\"TH\", allowed: [ \"colspan\", \"rowspan\"]}\n                 \n            ],\n            data: [\n                 { tagName:\"SPAN\", allowed: [ \"mid\" ]}\n            ]\n            \n        },\n        tagReplacements:[\n            { what:\"H1\", with:\"<p class='h1'>\"},\n            { what:\"H2\", with:\"<p class='h2'>\"},\n            { what:\"H3\", with:\"<p class='h3'>\"},\n            { what:\"H4\", with:\"<p class='h4'>\"},\n            { what:\"H5\", with:\"<p class='h5'>\"},\n            { what:\"H6\", with:\"<p class='h6'>\"},\n            { what:\"H7\", with:\"<p style='font-weight:bold'>\"},\n            { what:\"H8\", with:\"<p style='font-weight:bold'>\"},\n            { what:\"I\", with:\"<span style='font-style:italic'>\"},\n            { what:\"EM\",with: \"<span style='font-style:italic'>\"},\n            { what:\"B\", with:\"<span style='font-weight:bold'>\"},\n            { what:\"STRONG\", with:\"<span style='font-weight:bold'>\"}\n        ],\n        tagReplacementsDoc:[\n            { what:\"H6\", with:\"<p style='font-weight:bold'>\"},\n            { what:\"H7\", with:\"<p style='font-weight:bold'>\"},\n            { what:\"H8\", with:\"<p style='font-weight:bold'>\"},\n            { what:\"H5\", with:\"<h6>\"},\n            { what:\"H4\", with:\"<h5>\"},\n            { what:\"H3\", with:\"<h4>\"},\n            { what:\"H2\", with:\"<h3>\"},\n            { what:\"H1\", with:\"<h2>\"},\n            { what:\"I\", with:\"<span style='font-style:italic'>\"},\n            { what:\"EM\",with: \"<span style='font-style:italic'>\"},\n            { what:\"B\", with:\"<span style='font-weight:bold'>\"},\n            { what:\"STRONG\", with:\"<span style='font-weight:bold'>\"}\n        ]\n    };\n\n    constructor(htmlCode:string, autoEscape?:boolean) {\n        this.autoEscape = autoEscape;\n        this.text = htmlCode;       \n    }\n    \n    getClean( cleaningLevel?:HTMLCleaner.CleanLevel, keepMatrix?:boolean) {\n\n        if (cleaningLevel == HTMLCleaner.CleanLevel.Server ) {\n            // use the server whitelists\n            this.applyServerCleaning();\n            return this.text;\n        }\n        // remove dangerous stuff (MATRIX-936 weird characters kill xml / doc generation) copy paste word\n        if ( keepMatrix ) {\n            // keep /n for table formatting...\n            this.text = this.text.replace(/[\\u0001-\\u0009]/g, ' ');\n            this.text = this.text.replace(/[\\u000B-\\u001F]/g, ' ');\n        } else {\n            this.text = this.text.replace(/[\\u0001-\\u001F]/g, ' ');\n        }\n\n        // remove some stuff which should definitely not be in like a <head>\n        if (cleaningLevel == HTMLCleaner.CleanLevel.BasicSafety) {\n            // meta and head need to stay to link word docs\n            this.cleanConfig.blackLists.removeTags = this.cleanConfig.blackLists.removeTags.filter( function(tag) {tag.toLowerCase()!=\"head\" && tag.toLowerCase()!=\"meta\"});\n        }\n        if (cleaningLevel != HTMLCleaner.CleanLevel.PurifyOnly) {\n            this.removeTags();\n        }\n        \n        if (cleaningLevel == HTMLCleaner.CleanLevel.Basic || cleaningLevel == HTMLCleaner.CleanLevel.BasicSafety ) {\n            return this.text;\n        }\n        \n        // always sanitize\n        this.text =  DOMPurify.sanitize( this.text );\n\n        if (cleaningLevel == HTMLCleaner.CleanLevel.PurifyOnly) {\n            return this.text;\n        }\n        \n        /*********** most code maintenance ***************/\n        this.replaceNoCount(\"\t\", \"\");\n        this.replaceNoCount(\"  \", \" \");\n        this.replaceNoCount(\" \\n\", \"\\n\");\n        this.replaceNoCount(\"\t\\n\", \"\\n\");\n        this.replaceNoCount(\"\\n\\n\", \"\\n\");\n        this.replaceNoCount(\"  \", \" \");\n        \n        // remove word specifc noise\n        var tagStripper = new RegExp('<(/)*(v:|\\\\?xml:|st1:|o:)(.*?)>', 'gi');\n        this.text = this.text.replace(tagStripper, '');\n \n        this.replaceNoCount(\"<>\", \" \");\n         \n        if (cleaningLevel != HTMLCleaner.CleanLevel.Soft) {\n            // handle word lists (needs to happen before unknown classes and comment are removed\n            this.handleWordLists();\n\n            // remove remaining comments\n            this.text = this.text.replace( /<!--[^>]*-->/g, \"\");\n\n            /*********** this might change the formatting ***************/\n\n            // some things might not be in but we want to keep the inside <font>\n            this.removeInsideTags();\n\n            // clean inline stlye, classes, properties etc. according to some white lists\n            \n            if (!keepMatrix) {\n                this.cleanInlineStyle();\n                this.cleanClasses();\n                this.cleanProperties();\n            }\n            \n        }\n        if (!keepMatrix) {\n            this.setMaxImageSize();\n            this.cleanData();\n        } \n        this.replaceNoCount(\"&nbsp;&nbsp;\", \" \");\n        this.replaceNoCount(\"&nbsp; \", \" \"),\n        this.replaceNoCount(\" &nbsp;\", \" \");\n        \n        if (cleaningLevel != HTMLCleaner.CleanLevel.Soft && !keepMatrix) {\n            this.replaceTags(cleaningLevel);\n        }\n        \n        this.replaceNoCount(\"> &nbsp;<\", \">&nbsp;<\");\n        this.replaceNoCount(\">&nbsp; <\", \">&nbsp;<\");\n        // not good this will actually remove sometimes needed spaces ... this.replaceNoCount(\"> <\", \"><\");\n        \n        this.replaceNoCount(\"> \\n\", \">\\n\");\n        let e=0;\n        do {\n            e = 0;\n            e += this.replaceCount(\"  \", \" \");\n            e += this.replaceCount(\" >\", \">\");\n            e += this.replaceCount(\"\t\", \"\");\n            e += this.replaceCount(\"  \", \" \");\n            e += this.replaceCount(\"&nbsp;\\n\", \"\\n\");\n            e += this.replaceCount(\" \\n\", \"\\n\");\n            e += this.replaceCount(\"\\n\\n\", \"\\n\");\n            e += this.replaceCount(\"</li></ul><ul><li>\", \"</li><li>\"); // make real lists\n            \n        } while (e > 0);\n        \n        this.removeUseLessStuff();\n        \n        return this.text;\n    }\n    \n\n    replaceWiki() {\n        if (localStorage.getItem(\"wiki\")!=\"on\" ) {\n            return this.text;\n        }\n\n        this.applyWiki();\n\n        return this.text;\n    }\n\n    private getCleanupSettings(): ICleanup {\n        let cleanup = globalMatrix.ItemConfig.getCleanupRules();\n        if (!cleanup) {\n            cleanup = matrixSession.getCustomerSettingJSON(\"htmlCleanup\");\n        }\n        if (!cleanup) {\n            return null;\n        } else if (!cleanup.cleanup) {\n            return null;\n        }\n        return cleanup;\n\n    }\n    // returns a list of problems\n    public checkServerCleaning() {\n        let cleaning = this.getCleanupSettings();\n        if (!cleaning) {\n            // the server does not care\n            return [];\n        }\n        let results:string[] = [];\n\n        let code =  $(\"<div>\").html( this.text );\n        $(\"*\", code).each( function(idx, node)  {\n            let name = node.nodeName.toLowerCase();\n            if ( cleaning.tags.indexOf( name ) == -1) {\n                results.push(`<b>${name}</b> is not a supported tag`);\n            } else {\n                let attrs = node.getAttributeNames();\n                \n                // check attributes\n\n                for (let attIdx = 0; attIdx < attrs.length; attIdx++) {\n                    let attr = attrs[attIdx].toLowerCase();\n                    if (( cleaning.attributes[\":all\"] && cleaning.attributes[\":all\"].indexOf( attr )!=-1) ||\n                        (cleaning.attributes[name] && cleaning.attributes[name].indexOf( attr )!=-1)  ||\n                        (cleaning.enforcedAttributes[name] && cleaning.enforcedAttributes[name].indexOf( attr )!=-1)) {\n                        \n                        if (cleaning.protocolAttributes)  {\n                            for (let protocolAttribute of cleaning.protocolAttributes.filter( p => p.element == name && p.attribute == attr )) {\n                                let supportedProtocols = protocolAttribute.protocols;\n                                let actualValue = node.getAttribute( attr );\n                                let actualProtocol = actualValue?actualValue.split(\":\")[0]:\"unspecified\";\n                                if (supportedProtocols.indexOf( actualProtocol )==-1) {\n                                    results.push(`<b>${attr}</b> of <b>${name}</b> uses an unsupported protocol: <b>${actualProtocol}</b> ` );\n                                }\n                            }\n                        }\n                    } else {\n                        results.push(`<b>${attr}</b> is not a supported attribute of <b>${name}</b>` );\n                    }\n                }\n            }\n\n            \n        });\n\n        return results;\n    }\n\n    public applyServerCleaning() {\n        let that = this;\n        let cleaning = this.getCleanupSettings();\n        if (!cleaning) {\n            // the server does not care\n            return this.text;\n        }\n        \n        this.text = DOMPurify.sanitize(this.text, {ALLOWED_TAGS: cleaning.tags});\n\n        let code =  $(\"<div>\").html( this.text );\n        $.each(this.cleanConfig.blackLists.removeTags, function(csidx:number, tag: string) {\n            $(tag, code).each(function(idx, cb) { $(cb).remove(); })\n        });\n        this.text = code.html();\n        $(\"*\", code).each( function(idx, node)  {\n            let name = node.nodeName.toLowerCase();\n\n            let attrs = node.getAttributeNames();\n            \n            // check attributes\n\n            for (let attIdx = 0; attIdx < attrs.length; attIdx++) {\n                let attr = attrs[attIdx].toLowerCase();\n                if (( cleaning.attributes[\":all\"] && cleaning.attributes[\":all\"].indexOf( attr )!=-1) ||\n                        (cleaning.attributes[name] && cleaning.attributes[name].indexOf( attr )!=-1) ||\n                        (cleaning.enforcedAttributes[name] && cleaning.enforcedAttributes[name].indexOf( attr )!=-1)) {\n                        \n                        if (cleaning.protocolAttributes)  {\n                            for (let protocolAttribute of cleaning.protocolAttributes.filter( p => p.element == name && p.attribute == attr )) {\n                                let supportedProtocols = protocolAttribute.protocols;\n                                let actualValue = node.getAttribute( attr );\n                                let actualProtocol = actualValue?actualValue.split(\":\")[0]:\"unspecified\";\n                                if (supportedProtocols.indexOf( actualProtocol )==-1) {\n                                    node.removeAttribute( attr );\n                                }\n                            }\n                        }\n                    } else {\n                        node.removeAttribute( attr );\n                    }\n            }\n\n        });\n\n        this.text = code.html();\n\n    }\n\n    private applyWiki( ){\n        let that = this;\n        \n        this.replaceCode();\n        this.replaceList( \"*\", \"<ul>\",  \"</ul>\");\n        this.replaceList( \"#\", \"<ol>\",  \"</ol>\");\n        this.replaceList( \"?\", \"<ol type='A'>\", \"</ol>\");\n        this.replaceTable();\n        \n    }\n\n    private replaceCode(  ) {\n        let that = this;\n        \n        let content =  $(\"<div>\").html( this.text );\n        \n        let listLevel = 0;\n        let newHTML = \"\";\n        \n        let inCode = false;\n        let firstCodeLine = false;\n\n        $.each( content[0].childNodes, function(childIdx, child) {\n            let html = child.outerHTML?child.outerHTML:child.textContent;\n            let text = child.textContent;\n         \n            if ( !inCode &&  text.indexOf(\"{{{\") == 0 ) {\n                newHTML+= \"<pre>\";\n                inCode = true;\n                firstCodeLine = true;\n            } else if ( inCode  &&  text.indexOf(\"}}}\") == 0 ) {\n\n                newHTML+= \"</pre>\";\n                inCode = false;\n            } else if ( inCode ) {\n                if (!firstCodeLine) {\n                    newHTML+= \"\\n\" ;\n                } else {\n                    firstCodeLine=false;\n                }\n                    \n                newHTML+= text ;\n            } else {\n                newHTML+= html ;\n            }\n        });\n        // in case table did not end in text\n        if (inCode) {\n            newHTML += \"</pre>\";\n        }\n\n        this.text = newHTML;\n    }\n     private replaceTable(  ) {\n        let that = this;\n        \n        let content =  $(\"<div>\").html( this.text );\n        \n        let listLevel = 0;\n        let newHTML = \"\";\n        \n        let inTable = false;\n\n        $.each( content[0].childNodes, function(childIdx, child) {\n           \n            let html = child.outerHTML?child.outerHTML:child.textContent;\n            let text = child.textContent;\n            \n            let isTableLine = text.indexOf(\"|\") == 0 && text.split(\"|\").length > 2; // at least 2 | one of them in first pos\n            let isTableLineHeader  = text.indexOf(\"||\") == 0 && text.split(\"||\").length > 2; // at least 2 | one of them in first pos\n            if (child.nodeName==\"PRE\") {\n                isTableLine = false;\n                isTableLineHeader = false;\n            }\n            else if ( inTable &&  !isTableLine ) {\n                newHTML+= \"</table>\";\n                newHTML+= html ;\n                inTable = false;\n            } else if ( !inTable && isTableLine ) {\n                newHTML+= \"<table class='table table-bordered'>\";\n                inTable = true;\n            }\n\n            if ( isTableLineHeader ){\n                 newHTML+= \"<tr>\";\n                 $.each( text.split(\"||\"), function( idx, part ) {\n                     if (idx!=0 && ( idx != text.split(\"||\").length-1 || part!=\"\")) {\n                        newHTML+= \"<td><b>\" + part + \"</b></td>\";\n                     }\n                 });\n                 newHTML+= \"</tr>\";\n            } else if ( isTableLine ){\n                 newHTML+= \"<tr>\";\n                  $.each( text.split(\"|\"), function( idx, part ) {\n                     if (idx!=0 && ( idx != text.split(\"|\").length-1 || part!=\"\")) {\n                         newHTML+= \"<td>\" + part + \"</td>\";\n                     }\n                 });\n                 newHTML+= \"</tr>\";\n            } else {\n                newHTML+= html ;\n            }\n        });\n        // in case table did not end in text\n        if (inTable) {\n            newHTML += \"</table>\";\n            inTable = false;\n        }\n\n        this.text = newHTML;\n    }\n    \n    private replaceList( bullet:string, ul:string, eul:string) {\n        let that = this;\n        \n        let content =  $(\"<div>\").html( this.text );\n        \n        let listLevel = 0;\n        let newHTML = \"\";\n        \n        $.each( content[0].childNodes, function(childIdx, child) {\n            \n            let html = child.outerHTML?child.outerHTML:child.textContent;\n            let text = child.textContent;\n            let inner = child.innerHTML?child.innerHTML:child.textContent;\n           \n            let lineListLevel = that.getListLevel( text, bullet );\n            if (child.nodeName==\"PRE\") {\n                newHTML += html;\n                lineListLevel = 0;\n            }\n            else if ( lineListLevel > 0 ) {\n                // insert ul's\n                for( var ill=0; ill<lineListLevel-listLevel;ill++) {\n                    newHTML += ul;\n                }\n                // or close\n                for( var ill=0; ill<listLevel-lineListLevel;ill++) {\n                    newHTML += eul;\n                }\n\n                // ignore the <p> and remove first lineListLevel *s\n                for( let llidx=0;llidx<lineListLevel;llidx++) {\n                   inner = inner.replace(bullet,\"\");\n                }\n                newHTML+= \"<li>\"+ inner + \"</li>\";\n            } else {\n                // insert end ul's\n                for( var ill=0; ill<listLevel-lineListLevel;ill++) {\n                    newHTML += eul;\n                }\n                newHTML+= html ;\n            }\n            \n            // store current list level\n            listLevel = lineListLevel;\n            \n        });\n        // in case list did not end in text\n        for( var ill=0; ill<listLevel;ill++) {\n            newHTML += eul;\n        }\n\n        this.text = newHTML;\n    }\n    private getListLevel( text:string, bullet:string):number {\n        if (!text) return 0;\n        let idx=0;\n        while( text.length>idx && text[idx]==bullet) {\n            idx++;\n        }\n        return idx;\n    }\n\n\n    public getText() {\n        return this.text;\n    }\n    private setMaxImageSize() {\n        let code =  $(\"<div>\").html( this.text );\n        $(\"img\", code).each( function( idx, img) {\n            $(img).css(\"max-width\", \"604px\"); // 16 cm\n            $(img).css(\"max-height\", \"800px\"); // 22 cm            \n        });\n        \n         this.text = code.html();\n    }\n    private replaceCount(what:string, wth:string):number {\n        let replaced = this.text.indexOf(what) != -1;\n        this.replaceNoCount(what,wth);\n\n        return replaced?1:0;\n    }\n    \n    private replaceNoCount(what:string, wth:string) {\n        this.text = this.text.replace(new RegExp(what, 'g'), wth);\n    }\n    public replaceTags(cleaningLevel: HTMLCleaner.CleanLevel): number {\n        \n        let code =  $(\"<div>\").html( this.text );\n        \n        let count = 0;\n        $.each( (cleaningLevel==HTMLCleaner.CleanLevel.StrictDoc)?this.cleanConfig.tagReplacementsDoc:this.cleanConfig.tagReplacements, function(tgidx, tr) {\n            let replaced = false;\n            do {\n                replaced = false;\n                $(tr.what, code).each( function( idx, x) {\n                    let y = $(tr.with).html($(x).html());\n                    $(x).replaceWith( y );\n                    replaced = true;\n                    count++;\n                });\n            } while (replaced);\n        });\n        this.text = code.html();\n        return count;\n    }\n       \n    public removeTags() {\n        let code =  this.autoEscape?$(\"<div>\").text( this.text ):$(\"<div>\").html( this.text ); // text escapes < \n        $.each(this.cleanConfig.blackLists.removeTags, function(csidx:number, tag: string) {\n            $(tag, code).each(function(idx, cb) { $(cb).remove(); })\n        });\n        this.text = code.html();\n    }\n    \n    public removeInsideTags() {\n        let that = this;\n        let code = $(\"<div>\").html( this.text );\n        \n        $.each(this.cleanConfig.blackLists.keepOnlyInside, function(csidx:number, tag: string) {\n            $(tag, code).contents().unwrap();\n        });\n        this.text = code.html();\n    }\n   \n    // clean inline style: allow only stuff which can be created with the editor\n    public cleanInlineStyle() {\n        let that = this;\n        let code =  $(\"<div>\").html( this.text );\n        $(\"*\", code).each( function(idx, node)  {\n            let newStyle:string[] = [];\n            let style = $(node).attr(\"style\");\n            if ( style ) {\n                let sns = style.replace(/ /g,\"\"); // note this could cause problems with font names with spaces, but these are removed anyway\n                $.each(that.cleanConfig.whiteLists.styles, function(csidx:number, conf: IHTMLWhiteList) {\n                    if (conf.tagName === \"*\" || conf.tagName === $(node).prop(\"tagName\")) {\n                        $.each(conf.allowed, function(id, ks) {\n                            if (sns.indexOf(ks) !== -1) {\n                                newStyle.push(ks);\n                            }\n                        });\n                    }\n                });\n                let padded = \";\"+sns+\";\";\n                // background and foreground colors\n                if ( $(node).prop(\"tagName\") === \"SPAN\") {\n                    let bc = padded.match(/;background-color[^;]+/);\n                    if (bc && bc.length>0) {\n                        newStyle.push(bc[bc.length - 1].substr(1));\n                    }\n                    let fc = padded.match(/;color[^;]+/);\n                    if (fc && fc.length>0) {\n                        newStyle.push(fc[fc.length-1].substr(1));\n                    }\n                }\n                // width and height of images\n                if ($(node).prop(\"tagName\") === \"IMG\" ) {\n                    let iw = padded.match(/;width[^;]+/);\n                    if (iw && iw.length>0) {\n                        newStyle.push(iw[iw.length-1].substr(1));\n                    }\n                    let ih = padded.match(/;height[^;]+/);\n                    if (ih && ih.length>0) {\n                        newStyle.push(ih[ih.length-1].substr(1));\n                    }\n                }\n                if (newStyle.length > 0) {\n                    $(node).attr(\"style\", newStyle.join(\";\"));\n                } else {\n                    $(node).removeAttr(\"style\");\n                }\n            }\n        });\n        this.text = code.html();\n    }\n    \n    // clean classes: only some classes are meaningful\n    public cleanClasses() {\n        let that = this;\n           \n        let code =  $(\"<div>\").html( this.text );\n        $(\"*\", code).each( function(idx, node)  {\n            let newClasses:string[] = [];\n            let cs = $(node).attr(\"class\");\n            if ( cs ) {\n                let classes = cs.split(\" \");\n                \n                $.each(that.cleanConfig.whiteLists.classes, function(csidx:number, conf: IHTMLWhiteList) {\n                    if (conf.tagName === \"*\" || conf.tagName === $(node).prop(\"tagName\")) {\n                        $.each(conf.allowed, function(id, ks) {\n                            if (classes.indexOf(ks) !== -1) {\n                                newClasses.push(ks);\n                            }\n                        });\n                    }\n                });\n            }\n            // always make nice bordered tables with full width\n            if ($(node).prop(\"tagName\") === \"TABLE\" ) {\n                newClasses.push(\"table\");\n                newClasses.push(\"table-bordered\");\n            }\n\n            $(node).removeAttr(\"class\");\n            if (newClasses.length>0) {\n                $(node).attr(\"class\", newClasses.join(\" \"));\n            }\n        });\n        this.text = code.html();\n    }\n    \n    // clean properties: only some properites can exist\n    private removeProps(node:JQuery, whiteList:string[]) {\n        let attributes = node[0].attributes;\n        let i = attributes.length;\n        while( i-- ) {\n            var attr = attributes[i];\n            if (whiteList.indexOf(attr.name) == -1 && attr.name.indexOf( \"data-\") !== 0 && attr.name != \"class\" && attr.name != \"style\") {\n                node.removeAttr(attr.name);\n            }\n        }\n    }\n    \n    public cleanProperties() {\n        let that = this;\n        \n        let code =  $(\"<div>\").html( this.text );\n        $(\"*\", code).each( function(idx, node)  {\n            let hasRule = false;\n            $.each(that.cleanConfig.whiteLists.properties, function(csidx:number, conf: IHTMLWhiteList) {\n                if ( conf.tagName === $(node).prop(\"tagName\")) {\n                    hasRule = true;\n                    that.removeProps($(node), conf.allowed );\n                } \n            });\n            if (!hasRule) {\n                that.removeProps($(node), [] );\n            };\n          \n        });\n        this.text = code.html();\n    }\n    \n    public cleanData() {\n        let that = this;\n        \n        let code =  $(\"<div>\").html( this.text );\n        $(\"*\", code).each( function(idx, node)  {\n            // node jquery getAttr(does not work for stuff like data-vr-xxxx, it will return the attribute name vrXxxx instead of vr-xxxx\n            let toRemove:string[] = [];\n            $.each(node.attributes, function (key:Number, attr:Attr) {\n                if ( attr.name.indexOf(\"data-\") === 0) {\n                    let attrName = attr.name.replace(\"data-\",\"\"); \n                    let isWhiteListed = false;\n                \n                    $.each(that.cleanConfig.whiteLists.data, function(csidx:number, conf: IHTMLWhiteList) {\n\n                        if ( conf.tagName === $(node).prop(\"tagName\") && conf.allowed.indexOf(attrName) !== -1) {\n                            isWhiteListed = true;\n                        }\n                    });\n                    if (!isWhiteListed) {\n                        toRemove.push( attrName );\n                    }\n                    \n                }\n            });\n            $.each(toRemove, function(ridx,remove) {\n                node.removeAttribute(\"data-\" + remove);\n            });\n        });\n        this.text = code.html();\n    }\n    \n    public removeUseLessStuff() {\n        \n        let keepGoing = true;\n        while (keepGoing) {\n            let code =  $(\"<div>\").html( this.text );\n            keepGoing = this.removeSpansWithoutStyle(code);\n            keepGoing = keepGoing || this.removeEmpty(code);\n            keepGoing = keepGoing || this.unwrapEmptyStuff( code, \"div\",\"DIV\");\n            keepGoing = keepGoing || this.unwrapEmptyStuff( code, \"div\",\"P\");\n            // removing the fiv with a span inside is bad, the div make a paragraph\n            // keepGoing = keepGoing || this.unwrapEmptyStuff( code, \"div\",\"SPAN\");\n            keepGoing = keepGoing || this.unwrapEmptyStuff( code, \"div\",\"UL\");\n            this.text = code.html();\n            keepGoing = keepGoing || this.removeDivDiv();\n        }\n    }\n    public handleWordLists() {\n        let that = this;\n        /*\n         * \n         * <p class=\"MsoListParagraphCxSpFirst\" style=\"....\">\n         * <!--[if !supportLists]--><span style=\"..;\">...</span><!--[endif]-->      QMS: this is the core of the quality management system, it will contain all your SOPs, quality work instructions, forms and templates, etc.<o:p></o:p></p>\n         * \n         * <ul><li>QMS...</li>\n  <p class=\"MsoListParagraphCxSpMiddle\" style=\"text-indent:-.25in;mso-list:l0 level1 lfo1\"><!--[if !supportLists]--><span style=\"font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family: Symbol\">·<span style=\"font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: &quot;Times New Roman&quot;;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->sadasdada<o:p></o:p></p>\n  <p class=\"MsoListParagraphCxSpMiddle\" style=\"text-indent:-.25in;mso-list:l0 level1 lfo1\"><!--[if !supportLists]--><span style=\"font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family: Symbol\">·<span style=\"font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: &quot;Times New Roman&quot;;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->QMS-FILE: this project will contain the plans, reports and records of your application of the quality system, e.g. audit plans and reports, management review minutes, etc.<o:p></o:p></p>\n  <p class=\"MsoListParagraphCxSpLast\" style=\"text-indent:-.25in;mso-list:l0 level1 lfo1\"><!--[if !supportLists]--><span style=\"font-famil\n         * \n         * \n         */\n        \n        // replace the funny points\n        this.text = this.text.replace( /<!--\\[if !supportLists]-->.*?<!--\\[endif]-->/g, \"\" );\n        let code =  $(\"<div>\").html( this.text );\n        $.each( $(\"[class$='CxSpFirst']\", code), function (idx, li) { \n            let next = $(li).next();\n            let lstart = $(\"<ul>\").append($(\"<li>\").append(($(li).html())));\n            $(li).replaceWith(lstart);\n            let level = 0;\n            let levelStack:JQuery[] = [lstart];\n            while (next && next.length>0) {\n                let x = next.next();\n                if (next.is(\"[class$='CxSpMiddle']\") || next.is(\"[class$='CxSpLast']\")) {\n                    let nextLevel = level;\n                    let nextStyle = next.attr(\"style\");\n                    if (!nextStyle || nextStyle.indexOf(\"level1\")!=-1) nextLevel = 0;\n                    else if (nextStyle.indexOf(\"level2\")!=-1) nextLevel = 1;\n                    else if (nextStyle.indexOf(\"level3\")!=-1) nextLevel = 2;\n                    else if (nextStyle.indexOf(\"level4\")!=-1) nextLevel = 3;\n                    else if (nextStyle.indexOf(\"level5\")!=-1) nextLevel = 4;\n                    else if (nextStyle.indexOf(\"level6\")!=-1) nextLevel = 5;\n                    \n                    if (nextLevel === level) {\n                        lstart.append($(\"<li>\").append(  $(next).html() ));\n                    } else if (nextLevel > level ) {\n                        // indent\n                        let newStart = $(\"<ul>\").append($(\"<li>\").append(($(next).html())));\n                        levelStack.push(newStart);\n                        lstart.append(newStart);\n                        lstart = newStart;\n                    } else {\n                        // outdent\n                        if (nextLevel < levelStack.length) {\n                            lstart = levelStack[nextLevel]; // go back to good level and remove other lists\n                            levelStack.splice( nextLevel+1, 100);\n                        } else {\n                            // doesn't make sense really\n                            lstart = $(\"<ul>\").append($(\"<li>\").append(($(li).html())));\n                            levelStack.push(lstart);\n                        }\n                        lstart.append($(\"<li>\").append(  $(next).html() ));\n                    }\n                   \n                    level = nextLevel;\n                    $(next).remove();\n                }\n                next = x;\n            }\n        });\n        this.text = code.html();\n        \n    }\n    \n    \n    // <span>a<span> -> a\n    // <span>a<span>b</span><span> -> b\n    // <span>a<span style='c'>b</span><span> -> <span style='c'>b</span>\n    \n    private removeSpansWithoutStyle(node:JQuery) {\n        let replaced = false;\n        $.each($(\"span\", node), function(idx, span) {\n            \n            let hasMeta = $(span).attr(\"style\") || $(span).attr(\"class\") || $(span).attr(\"data\");\n            if ( !hasMeta ) {\n                replaced = true;\n                $(span).replaceWith( $(span).html());\n            }\n        });\n        return replaced;\n    }\n    private removeEmpty(node:JQuery) {\n        let replaced = false;\n        $.each(this.cleanConfig.blackLists.removeEmpty, function(idx, re) {\n            $.each($(re, node), function(idx, p) {\n\n                if ( $(p).html() === \"\" ) {\n                    replaced = true;\n                    $(p).remove();\n                }\n            });\n        });\n        return replaced;\n    }\n    private unwrapEmptyStuff(node:JQuery, outer:string, inner:string ) {\n        let unwraped = false;\n        $(outer, node).each(function(idx, out) {\n            let hasMeta = $(out).attr(\"style\") || $(out).attr(\"class\") || $(out).attr(\"data\");\n            if (!hasMeta && out.children.length == 1 && (<HTMLElement>out.children[0]).tagName ===inner  &&  out.innerHTML == (<HTMLElement>out.children[0]).outerHTML) {\n                //console.log( out.tagName + \": \" + out.innerHTML )\n                unwraped = true;\n                $(out).contents().unwrap();\n            }\n        });\n        return unwraped;\n    }\n    private removeDivDiv() {\n        let replaced = this.text;\n        this.text =  this.text.replace(/<div><\\/div><div>/g,\"<div>\");\n  \n        //if(replaced != this.text) console.log( \"removed <div></div><div></div>\");\n         \n        return replaced != this.text;\n    }\n    \n}\n\n\nnamespace HTMLCleaner\n{\n    export enum CleanLevel\n    {\n        PurifyOnly,\n        Basic,\n        Soft,\n        Strict,\n        BasicSafety,\n        StrictDoc, \n        Server // server like cleaning -> remove all but a whitelist\n    } \n};\n\n/*\n\nknown tags\n----------\nHR, A, SPAN, BR, TABLE, IMG, P, DIV, TR,TD, UL, OL, LI, blockquote, PRE\n\n\ndata\n----\nSPAN  data-mid=\"1489062317559\"\n\n*/","import type { IBaseControlOptions } from \"../UI/Controls/BaseControl\";\n\n// To keep dependencies to a minimum, BasicFunctions is directly imported so\n// we don't have all of the business logic libs.\nimport { BasicFunctions } from \"../businesslogic/BasicFunctions\";\n\nimport type { IJSONTools, ILoggerTools } from \"./MatrixLibInterfaces\";\nimport { extend } from \"./JQueryExtendReplacement\";\n\nexport { JSONTools };\n\n\nclass JSONTools implements IJSONTools {\n\n    private logger: ILoggerTools;\n    constructor(logger: ILoggerTools) {\n        this.logger = logger;\n    }\n\n    private cloner2(src:any) {\n        return extend(true, {}, { x: src }).x;\n    }\n\n    mergeOptions(defaultOptions:IBaseControlOptions, options:IBaseControlOptions):IBaseControlOptions {\n        let newOptions:IBaseControlOptions = this.clone(defaultOptions);\n        // make sure there is a parameter object\n        if (!newOptions.parameter) {\n            newOptions['parameter'] = {};\n        }\n        // copy parameters one by one\n        if (options.parameter) {\n            for (var name in options.parameter) {\n                newOptions.parameter[name] = options.parameter[name];\n            }\n        }\n        // copy other values\n        for (var name in options) {\n            if (name != 'parameter') {\n                newOptions[name] = options[name];\n            }\n        }\n        // use parameters to overwrite some default values\n        if (this.isTrue(newOptions.parameter.readonly)) {\n            newOptions.canEdit = false;\n        }\n        return newOptions;\n    }\n    \n    // overwrite default options\n    setOptions(newOptions:IBaseControlOptions, options:IBaseControlOptions):IBaseControlOptions {\n        // make sure there is a parameter object\n        if (!newOptions.parameter) {\n            newOptions['parameter'] = {};\n        }\n        // copy parameters one by one\n        if (options.parameter) {\n            for (var name in options.parameter) {\n                newOptions.parameter[name] = options.parameter[name];\n            }\n        }\n        // copy other values\n        for (var name in options) {\n            if (name != 'parameter') {\n                newOptions[name] = options[name];\n            }\n        }\n        // use parameters to overwrite some default values\n        if (this.isTrue(newOptions.parameter.readonly)) {\n            newOptions.canEdit = false;\n        }\n        // handle readonly for ACLs\n        if (this.isTrue(newOptions.parameter.readonlyACL)) {\n            newOptions.canEdit = false;\n        }\n        return newOptions;\n    }\n\n    isTrue(obj:undefined|null|boolean|string|number):boolean {\n        return BasicFunctions.isTrue(obj);\n    }\n\n    isFalse(obj:undefined|null|boolean|string|number):boolean {\n        return BasicFunctions.isFalse(obj);\n    }\n\n    fromString(str:null|string):{status: string, value: {}} {\n        var result = {status: 'empty', value: {}};\n        if (str && str !== \"\") {\n            // first replace all single quotes outside of double quotes with \"\n            var strp = str.replace(/(')(?=(?:[^\"]|\"[^\"]*\")*$)/g, '\"').replace(/(\\r\\n|\\n|\\r)/gm, \"\");\n            try {\n                result.value = JSON.parse(strp);\n                result.status = 'ok';\n            }\n            catch (err) {\n                try {\n                    result.value = JSON.parse(str);\n                    result.status = 'ok';\n                }\n                catch (err) {\n                    this.logger.log(\"error\", \"Error trying to parse configuration parameter: \" + str);\n                    this.logger.log(\"error\", \"Error was:\" + err);\n                    result.status = 'error';\n                }\n            }\n        }\n        return result;\n    }\n\n    clone(src:any):any {\n        var b =this.cloner2(src);\n        return b;\n    }\n\n    \n    /** json lint and JSON.parse( ) don't handle backslashes ( \"a\":\"\\s\" )*/\n    escapeJson( code:string ) {\n        return code.replace( /\\\\/g, \"\\\\\\\\\");\n    }\n\n    /** json lint and JSON.parse( ) don't handle backslashes ( \"a\":\"\\s\" )*/\n    unEscapeJson( code:string ) {\n        return code.replace( /\\\\\\\\/g, \"\\\\\");\n    }\n};\n   ","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ILoggerTools } from \"./MatrixLibInterfaces\";\n\nexport { SERVER_LOG_LEVEL, LoggerTools };\n\nenum SERVER_LOG_LEVEL {\n    WEIRD_STATE = \"WEIRD_STATE\",\n    BROKEN_STATE = \"BROKEN_STATE\"\n}\n\ntype FunctionRenderHumanDate = (date: Date) => string;\ntype FunctionSanitize = (data: string) => string;\n\nclass LoggerTools implements ILoggerTools {\n    private verbose:boolean = false;\n    private lastLogMsg:string = \"none\";\n    private logData:string[] = [ ];\n    private logIdx:number = 0;\n    private logSize: number = 50;\n    private functionRenderHumanDate: FunctionRenderHumanDate;\n    private functionSanitize: FunctionSanitize;\n\n    constructor(functionRenderHumanDate: FunctionRenderHumanDate, sanitize?: FunctionSanitize) {\n        this.functionRenderHumanDate = functionRenderHumanDate;\n        this.functionSanitize = (sanitize) ? sanitize : (d) => { return DOMPurify.sanitize(d); };\n    }\n\n    log(id:string, msg:string) {\n        if (!this.verbose && id === \"debug\") {\n            return;\n        }\n        msg = this.functionSanitize(msg) + '';\n        if (!msg) {\n            return;\n        }\n\n        console.log(id + \":\" + msg);\n\n        if (this.lastLogMsg === msg) {\n            this.logData[this.logIdx] = this.logData[this.logIdx] + \".\";\n        } else {\n            this.logIdx++;\n            if (this.logIdx===this.logSize) {\n                this.logIdx =0;\n            }\n            // this.logData[this.logIdx] = ml.UI.DateTime.renderHumanDate(new Date()) + \" [\" + id + \"]: \" + msg;\n            this.logData[this.logIdx] = this.functionRenderHumanDate(new Date()) + \" [\" + id + \"]: \" + msg;\n            this.lastLogMsg = msg;   \n        }\n    }\n\n    debug(message:string):void {\n        this.log(\"debug\", message)\n    }\n\n    info(message:string):void {\n        this.log(\"info\", message)\n    }\n\n    warning(message:string):void {\n        this.log(\"warning\", message)\n    }\n\n    error(message:string):void {\n        this.log(\"error\", message)\n    }\n\n    getLog():string {\n        var msg = \"\";\n        for ( var idx = this.logIdx +1; idx < this.logIdx + this.logSize +1; idx++) {\n            if (this.logData[idx % this.logSize]) {\n                msg += this.logData[idx % this.logSize] + \"\\n\";\n            }\n        }\n        return msg;\n    }\n}","import { restConnection, app, globalMatrix, matrixSession, ControlState } from \"../../globals\";\nimport { IMailConfigCanned } from \"../../ProjectSettings\";\nimport { XRUserPermissionType } from \"../../RestResult\";\n\nimport { XCPostSendMail } from \"./../../RestCalls\";\nimport { ml } from \"./../matrixlib\";\nimport { IMailTools, IUserLookup } from \"./MatrixLibInterfaces\";\n\nexport { MailTools };\n\nclass MailTools implements IMailTools {\n    sendMail( to:string, cc:string, bcc:string, subject:string, body:string, systemMail?:number, noSuccess?:boolean,noReply?:number):JQueryDeferred<{}> {\n        let that = this;\n        var res = $.Deferred();\n        var text = $(\"<div class='controlContainer'>\").html(body);\n        $(\"br\",text).replaceWith(\"\\n\");\n\n        var tol = to?to.split(\",\"):[];\n        var ccl = cc?cc.split(\",\"):[];\n        var bccl = bcc?bcc.split(\",\"):[];\n\n        let sendMailParm: XCPostSendMail = {\n                to: tol,\n                cc: ccl,\n                bcc: bccl,\n                subject: subject,\n                htmlbody: body,\n                textbody: text.text(),\n                system: systemMail,\n                noreply:noReply\n            };\n        let queryString = \"?\"+(systemMail!=undefined?\"system=\"+systemMail + \"&\":\"\") + (noReply!=undefined?\"noreply=\"+noReply:\"\" );\n\n        restConnection.postSpecialServer(\"all/sendmail\" + queryString, sendMailParm).done(function () {\n            if (!systemMail && !noSuccess) {\n                ml.UI.showSuccess(\"Mail sent successfully.\");\n            }\n            res.resolve();\n        }).fail(function (jqxhr:{}, textStatus:string, error:string) {\n            if (!systemMail ) {\n                ml.UI.showError(\"Error sending mail!\", \"Status:\" + textStatus + \"<br/>Error was:\" + error);\n            }\n            res.reject();\n        });\n        return res;\n    }\n\n    sendMailDlg(sendTo: string, preSelectedUsers: XRUserPermissionType[], subject:string, body:string, sendCc:string):void {\n\n        let that = this;\n\n        async function updateSend() {\n            var sendButton = $(\".ui-dialog-buttonpane button:contains('Send')\", app.dlgForm.parent());\n            var enabled = sendTo.length && subj && await subj.getController().getValueAsync() !== \"\";\n            sendButton.prop(\"disabled\", !enabled);\n            if (enabled) {\n                sendButton.removeClass(\"ui-state-disabled\");\n            } else {\n                sendButton.addClass(\"ui-state-disabled\");\n            }\n        }\n\n\n        var cc:string[] = sendCc?sendCc.split(\",\"):[];\n        let mailConf = matrixSession.getMailSettings();\n        if (mailConf && mailConf.defaultCC && mailConf.defaultCC.length) {\n            cc = cc.concat(mailConf.defaultCC.filter(function (userOrGroup) { return ml.UI.SelectUserOrGroup.exists(userOrGroup); }));\n        }\n\n        if (sendTo.split(\",\").indexOf(matrixSession.getUser()) === -1 && matrixSession.getUser() !== \"matrixadmin\") {\n            // the user himself is always on cc - by default\n            cc.push(matrixSession.getUser());\n        }\n\n         // get distinct names\n         cc =  cc.filter(function(elem, pos,arr) { return arr.indexOf(elem) == pos;});\n\n\n        let usel = $(\"<div class='controlContainer'>\");\n        let ccl = $(\"<div class='controlContainer'>\");\n\n        if ( preSelectedUsers && preSelectedUsers.length ) {\n            // take user list from parameter (no groups possible)\n            ml.UI.SelectUserOrGroup.showMultiUserSelect(usel, \"To\", (sendTo ? sendTo.split(\",\") : []), \"Select To Users\", \"\", \"\", true, false, (selection: string[]) => {\n                sendTo = selection.join(\",\");\n                updateSend();\n            }, preSelectedUsers);\n\n            ml.UI.SelectUserOrGroup.showMultiUserSelect(ccl, \"Cc\", cc, \"Select Cc Users\", \"\", \"\", true, false, (selection: string[]) => {\n                cc = ml.JSON.clone(selection);\n                updateSend();\n            }, preSelectedUsers);\n        } else {\n            // take users from current project\n            ml.UI.SelectUserOrGroup.showMultiUserSelect(usel, \"To\", (sendTo ? sendTo.split(\",\") : []), \"Select To Users / Groups\", \"\", \"\", true, true, (selection: string[]) => {\n                sendTo = selection.join(\",\");\n                updateSend();\n            });\n\n            ml.UI.SelectUserOrGroup.showMultiUserSelect(ccl, \"Cc\", cc, \"Select Cc Users / Groups\", \"\", \"\", true, true, (selection: string[]) => {\n                cc = ml.JSON.clone(selection);\n                updateSend();\n            });\n        }\n\n        var subj = $(\"<div class='controlContainer'>\").plainText({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help:\"Subject\",\n            fieldValue:subject,\n            valueChanged: function () {\n                updateSend();\n            }, // callback to call if value changes\n            parameter: {\n                rows: 1,\n                allowResize: false}\n        });\n        var cont:JQuery = $(\"<div class='controlContainer'>\");\n\n        cont.richText({controlState: ControlState.FormEdit,canEdit: true, help:\"Message\",fieldValue:body,valueChanged: function () {}, parameter: {tiny:true}});\n\n        app.dlgForm.hide();\n        app.dlgForm.html(\"\");\n\n        app.dlgForm.append(usel);\n\n        app.dlgForm.append(ccl);\n        // workaround for MATRIX-995 cannot edit links in sendmail\n        // somehow that thing gets a focus event out of nowhere\n\n        app.dlgForm.append(subj);\n        app.dlgForm.append(cont);\n        app.dlgForm.addClass(\"dlg-no-scroll\");\n        app.dlgForm.removeClass(\"dlg-v-scroll\");\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Send Mail\",\n            width: 730,\n            height: 720,\n            modal: true,\n            resizeStop: function () {},\n            open: function () {\n                window.setTimeout( function() {\n                    $(\"input\", subj).focus();}, 1);\n                updateSend();\n            },\n            buttons: [{\n                    text: 'Send',\n                    class: 'btnDoIt',\n                    click: async function () {\n\n                        that.sendMail(sendTo, cc.join(\",\"), \"\", await subj.getController().getValueAsync(), await cont.getController().getValueAsync());\n                        app.dlgForm.dialog(\"close\");\n                    }\n                }, {\n                    text: 'Cancel',\n                    class: 'btnCancelIt',\n                    click: function () {\n                        app.dlgForm.dialog(\"close\");\n                    }\n                }]\n\n        });\n    }\n\n    replacePlaceholders(  template:string, itemId:string,  rejectComment:string, reviewers:string[], readers:string[], trainers:string[], trainees:string[] ):string {\n        let msg = ml.Mail.getCannedMessage(\"\", \"\", itemId, template);\n        msg = msg.replace(new RegExp(\"_reject_\", 'g'), rejectComment?rejectComment:\"\");\n        msg = msg.replace(new RegExp(\"_reviewers_\", 'g'), reviewers?reviewers.join():\"\");\n        msg = msg.replace(new RegExp(\"_readers_\", 'g'), readers?readers.join():\"\");\n        msg = msg.replace(new RegExp(\"_trainers_\", 'g'), trainers?trainers.join():\"\");\n        msg = msg.replace(new RegExp(\"_trainees_\", 'g'), trainees?trainees.join():\"\");\n        return msg;\n    }\n\n    getCannedMessage( messageId:string, to:string, itemId:string, custom?:string , body =\"\"):string {\n        var message = custom;\n        let mailConf = matrixSession.getMailSettings();\n        if (!custom && mailConf && mailConf.canned && (mailConf.canned)[messageId]) {\n            message = (mailConf.canned)[messageId];\n        } else if (messageId === \"link\") {\n            message =  \"Hello<br/><br/>please have a look at <b>_link_ _title_</b>.<br/><br/>_me.firstName_\";\n        } else if (messageId === \"please_sign\") {\n            message =  \"Hello,<br/><br/>please review and sign the following document <b>_link_ _title_</b><br/><br/>_me.firstName_\";\n        } else if (messageId === \"new_user\") {\n            message =  \"Hello _to.firstName_,<br/><br/>Here is your access to Matrix.<br/><br/>_userinfo_<br/><br/>You have access to these projects:<br/><br/>_projectlist_<br/>_me.firstName_\";\n        } else if (messageId === \"reset_pwd\") {\n            message =  \"Hello _to.firstName_,<br/><br/>Please change your password.<br/><br/>_userinfo_<br/>\";\n        } else if (messageId === \"release_note\"){\n            message =  \"Hello,<br/><br/>the document <b>_link_ _title_</b> has been released!<br/><br/>_me.firstName_\";\n        } else if (messageId === \"approve_note\"){\n            message =  \"Hello ,<br/><br/>the template <b>_link_ _title_</b> waits for approval!<br/><br/>_me.firstName_\";\n        }else if (messageId === \"training_reminder\"){\n            message =  \"Hello _to.firstName_,<br/><br/> You need to do the following training:<br/>_body_<br/>_me.firstName_\";\n        }else if (messageId === \"review_reminder\"){\n            message =  \"Hello _to.firstName_,<br/><br/> You need to review the following :<br/>_body_<br/>_me.firstName_\";\n        }else if (messageId === \"qms_published\"){\n            message =  \"Hello,<br/>_body_<br/>_me.firstName_\";\n        }else if (messageId === \"gate_passed\"){\n            message =   `Hello _to.firstName_,<br/><br/>_me.firstName_ passed the gate _body_ for <b>_link_ _title_</b>.<br/><br/>`;\n        }  else if (messageId === \"empty_message\"){\n            message =   ``;\n        }\n\n\n        if( body != undefined)\n           message =  message.replace(\"_body_\",body);\n\n\n        // address the user eg by firstName: a) get the correct user info\n        var users = globalMatrix.ItemConfig.getUserNames();\n        var user: IUserLookup;\n        var me:IUserLookup;\n\n        let toUsers = to.split(\",\");\n        let toFirst:string[]=[];\n        let toLast:string[]=[];\n        let toLogin:string[]=[];\n\n        $.each( users, function (uidx, u) {\n           if (u.login === to) {\n               user = <IUserLookup>u;\n           }\n           if ( toUsers.indexOf(u.login)!=-1) {\n               toFirst.push(u.firstName);\n               toLast.push(u.lastName);\n               toLogin.push(u.login);\n           }\n            if (u.login === matrixSession.getUser()) {\n               me = <IUserLookup>u;\n           }\n        });\n\n\n        // address the user eg by firstName: b) replace all existing keys for to\n        if (user) {\n            $.each(Object.keys(user), function(kidx:number,key:string) {\n                message= message.replace(new RegExp(\"_to.\" + key + \"_\", 'g'), <string>user[key]);\n            });\n        } else {\n            message= message.replace(new RegExp(\"_to_\", 'g'), to);\n        }\n\n        message = message.replace(new RegExp(\"_to.firstName_\", 'g'), toFirst.join(\",\"));\n        message = message.replace(new RegExp(\"_to.lastName_\", 'g'), toLast.join(\",\"));\n        message = message.replace(new RegExp(\"_to.login_\", 'g'), toLogin.join(\",\"));\n\n        // address the user eg by firstName: c) replace all existing keys for sender\n        if (me) {\n            $.each(Object.keys(me), function(kidx,key) {\n                message= message.replace(new RegExp(\"_me.\" + key + \"_\", 'g'), <string>me[key]);\n            });\n        } else {\n            message = message.replace(/_me.*_/g, \"\");\n        }\n\n        // replace other stuff\n        if (itemId ){\n            message= message.replace(new RegExp(\"_id_\", 'g'), itemId);\n            message = message.replace(new RegExp(\"_project_\", 'g'), matrixSession.getProject());\n            message = message.replace(new RegExp(\"_url_\", 'g'), ml.Item.parseRef(itemId).url);\n            message = message.replace(new RegExp(\"_link_\", 'g'), ml.Item.parseRef(itemId).link);\n            message = message.replace(new RegExp(\"_linkv_\", 'g'), ml.Item.parseRef(itemId).linkv);\n            var title = app.getItemTitle(itemId);\n            message= message.replace(new RegExp(\"_title_\", 'g'), title);\n        }\n        return message;\n    }\n\n    sendMails( sendTos:string[], subject:string, messages:string[]) {\n        if (sendTos.length>2) {\n            ml.UI.Progress.Init(\"sending mails\");\n        }\n        let mailConf = matrixSession.getMailSettings();\n        let cc = \"\";\n        if (mailConf && mailConf.defaultCC && mailConf.defaultCC.length) {\n            cc = mailConf.defaultCC.filter(function (userOrGroup) { return ml.UI.SelectUserOrGroup.exists(userOrGroup); }).join(\",\");\n        }\n        this.sendMailsRec( sendTos, cc, subject, messages, 0)\n    }\n    private sendMailsRec( sendTos:string[], cc:string, subject:string, messages:string[], idx:number) {\n        let that = this;\n\n        if (sendTos.length>2) {\n            ml.UI.Progress.Update(idx * 100 / sendTos.length);\n        }\n        if (idx>=sendTos.length) {\n            if (sendTos.length>2) {\n                ml.UI.Progress.SuccessHide(\"Done sending mails\", 1000);\n            } else {\n                ml.UI.showSuccess(\"Done sending mails\", 1000);\n            }\n            return;\n        }\n        this.sendMail( sendTos[idx], cc, \"\", subject, messages[idx], 0, true).done( function() {\n            that.sendMailsRec( sendTos, cc, subject, messages, idx+1);\n        });\n    }\n\n}\n","import { SelectMode } from \"../UI/Components/ProjectViewDefines\";\nimport { ItemSelectionTools } from \"../UI/Tools/ItemSelectionView\";\nimport { IRestParam, IReference, IItem, IItemGet, globalMatrix, app, matrixSession, matrixApplicationUI } from \"./../../globals\";\nimport { MR1 } from \"./../businesslogic/index\";\nimport { ml } from \"./../matrixlib\";\nimport { IReportGeneratorTools, IJobList, IReportOptions, IPostCreateSignOrDocResult, IGetReportProgressResult, IReportTransferField, IGetReportProgressJobFileResult, IReportInput } from \"./MatrixLibInterfaces\";\n\nexport { ReportGeneratorTools };\n\nclass ReportGeneratorTools implements IReportGeneratorTools {\n    private reportJoblist:IJobList = {allGood: true, tasks: [], doneBatch:0};\n    private reportProc:number;\n    lastReportXMLs:string[] = [];\n\n    public SaveAndCreate(itemId:string, reportOptions:IReportOptions, progressInfo:string, postCreateCallback:Function, postFailCallback?:Function, postProgressCallback?:Function):void {\n        let that = this;\n\n        if (app.getNeedsSave()) {\n            app.saveAsync(false).done(function () {\n                window.setTimeout(function () {\n                    that.StartReportEngine(itemId, reportOptions, progressInfo, postCreateCallback, postFailCallback, postProgressCallback);\n                }, 1000);\n            });\n        } else {\n            this.StartReportEngine(itemId, reportOptions, progressInfo, postCreateCallback, postFailCallback, postProgressCallback);\n        }\n    }\n\n    private StartReportEngine(reportId:string, reportOptions:IReportOptions, progressInfo:string, postCreateCallback:Function, postFailCallback?:Function, postProgressCallback?:Function):void {\n        let that = this;\n        app.canLaunchReport().done(function (canLaunch: boolean) {\n            if (canLaunch) {\n                that.StartReportEngineLaunch(reportId, reportOptions, progressInfo, postCreateCallback, postFailCallback, postProgressCallback);\n            } else {\n                ml.UI.showConfirm(1, { title: \"Report engine busy. Please wait a while and try again...\", ok: \"Try Again\" }, function () {\n                    window.setTimeout( function() {\n                        that.StartReportEngine(reportId, reportOptions, progressInfo, postCreateCallback, postFailCallback, postProgressCallback);\n                    }, 400);\n                }, function () {\n                });\n            }\n        });\n    }\n\n    private StartReportEngineLaunch(reportId:string, reportOptions:IReportOptions, progressInfo:string, postCreateCallback:Function, postFailCallback?:Function, postProgressCallback?:Function):void {\n        let that = this;\n        ml.Logger.log('debug', \"starting report: \" + progressInfo);\n        ml.Logger.log('lastReportJobId', \"\");\n        ml.Logger.log('lastReportFileId', \"\");\n        ml.Logger.log('lastReportJobXML', \"\");\n\n        app.startReportAsync(reportId, reportOptions).done(function (jobId: IPostCreateSignOrDocResult) {\n\n            ml.Logger.log('lastReportJobId', jobId.jobId.toString());\n            that.reportJoblist.tasks.push(\n                    {jobId: jobId.jobId,\n                        progress: 0,\n                        reportId: reportId,\n                        reportOptions: reportOptions,\n                        postCreateCallback: postCreateCallback,\n                        postFailCallback: postFailCallback,\n                        postProgressCallback:postProgressCallback\n                    });\n\n            let labels = reportOptions.filter?(\" (\" + reportOptions.filter + \")\"):\"\";\n            if (that.reportJoblist.tasks.length === 1) {\n                ml.UI.Progress.Init(progressInfo + labels, !!reportOptions.filter);\n                that.reportJoblist.allGood = true;\n                that.reportJoblist.doneBatch = 0;\n                clearTimeout(that.reportProc);\n                that.reportProc = window.setTimeout(function () {\n                    that.waitForReports(0);\n                }, 500);\n            }\n        });\n    }\n\n    private waitForReports(rid:number):void {\n        let that = this;\n        if ( this.reportJoblist.tasks.length <= rid) {\n            ml.UI.Progress.ErrorHide(\"Error retrieving report status\", 2000);\n            return;\n        }\n        app.getReportDetails(this.reportJoblist.tasks[rid].jobId).done(function (progress: IGetReportProgressResult) {\n\n            let status = that.getProgressStatus(progress.status);\n\n            if (status === \"Error\" || progress.progress > 100) {\n\n                let details = (status && status!=\"Error\")?that.getError( status ):\"\";\n\n                ml.UI.showError(\"Error\", \"Failed to create \" + that.reportJoblist.tasks[rid].reportId + (details ? (\"<br>Error was: \" + details) : \"\"));\n                if (that.reportJoblist.tasks[rid].postFailCallback) {\n                    that.reportJoblist.tasks[rid].postFailCallback(\"Failed to create \" + that.reportJoblist.tasks[rid].reportId + (details?(\"<br>Error was: \" + details):\"\"));\n                }\n                that.reportJoblist.tasks.splice(rid, 1);\n                that.reportJoblist.allGood = false;\n                that.reportJoblist.doneBatch++;\n\n                rid -= 1;\n\n            } else if (progress.progress < 100) {\n\n                if (status && status.itemsProgress) {\n                    console.log( JSON.stringify(status.itemsProgress, null, 2));\n                }\n\n                if (that.reportJoblist.tasks[rid].postProgressCallback) {\n                    that.reportJoblist.tasks[rid].postProgressCallback(progress.progress);\n                }\n\n                that.reportJoblist.tasks[rid].progress = progress.progress;\n                var progressTotal = 100 * that.reportJoblist.doneBatch;\n                for (var idx = 0; idx < that.reportJoblist.tasks.length; idx++) {\n                    progressTotal += that.reportJoblist.tasks[idx].progress;\n                }\n                ml.UI.Progress.Update(progressTotal / (that.reportJoblist.tasks.length + that.reportJoblist.doneBatch));\n            } else { // done with at least one\n\n                var lastCreatedObject = progress.jobFile[progress.jobFile.length - 1];\n                ml.Logger.log('lastReportFileId', lastCreatedObject.jobFileId.toString());\n                that.lastReportXMLs.push( \"/job/\" + that.reportJoblist.tasks[rid].jobId + \"/\" + progress.jobFile[0].jobFileId);\n                ml.Logger.log('lastReportJobXML', globalMatrix.matrixRestUrl + \"/\" + matrixSession.getProject() + \"/job/\" + that.reportJoblist.tasks[rid].jobId + \"/\" + progress.jobFile[0].jobFileId);\n\n                if (that.reportJoblist.tasks[rid].postCreateCallback) {\n                    that.reportJoblist.tasks[rid].postCreateCallback(lastCreatedObject, globalMatrix.matrixRestUrl + \"/\" + matrixSession.getProject() + \"/job/\" + that.reportJoblist.tasks[rid].jobId + \"/\" + lastCreatedObject.jobFileId);\n                } else {\n                    app.download(that.reportJoblist.tasks[rid].jobId, lastCreatedObject.jobFileId);\n                    that.updateAfterCreatingCache( that.reportJoblist.tasks[rid].reportId );\n                }\n\n                that.reportJoblist.doneBatch++;\n                that.reportJoblist.tasks.splice(rid, 1);\n                rid -= 1;\n            }\n\n            if (that.reportJoblist.tasks.length > 0) {\n                that.reportProc = window.setTimeout(function () {\n                    that.waitForReports((rid + 1) % that.reportJoblist.tasks.length);\n                }, 500);\n                return;\n            } else if (that.reportJoblist.allGood) {\n                ml.UI.Progress.SuccessHide(\"Finished creating report/document\", 2000);\n            } else {\n                ml.UI.Progress.ErrorHide(\"Error creating report/document\", 2000);\n            }\n        }).fail( function() {\n            ml.UI.Progress.ErrorHide(\"Error retrieving report status\", 2000);\n        });\n    }\n\n    // this method checks if a signCache has been created during download of an item if so it updates it (without asking questions...)\n    private updateAfterCreatingCache( itemId:string ) {\n        // MATRIX-3721 if a signed has been downloaded, a cache has been created\n        // if the same SIGN is being displayed, we need to load and display the new item, we do this as a second protection by cancelling the edits\n\n        if (itemId && ml.Item.parseRef(itemId).type == \"SIGN\" && matrixApplicationUI.lastMainItemForm && app.getCurrentItemId() == itemId) {\n\n            app.cancel();\n            // and we force a get the latest\n            matrixSession.pushMessages.watchItem(itemId);\n        }\n    }\n    private getProgressStatus( text:string ):any {\n        if (!text || text[0] != \"{\") {\n            return text;\n        }\n        let isJson = ml.JSON.fromString(text);\n        if (isJson.status==\"ok\") {\n            return isJson.value;\n        }\n        return \"\";\n    }\n\n    private getError( error:any ) {\n        if (!error.itemsProgress || error.itemsProgress.length==0) {\n            return error.errorMessage?error.errorMessage:\"\";\n        }\n        for( let idx=0; idx<error.itemsProgress.length;idx++) {\n            if (error.itemsProgress[idx].progress==200) {\n                // that's an error\n                return error.itemsProgress[idx].documentRef + \": \" + error.itemsProgress[idx].message;\n            }\n        }\n        return \"unknown error\";\n    }\n\n    CreateSignedDoc(docId: string, signatures: string[], signedDocumentsControl: JQuery, labelFilter:string, signName:string, transferFields:IReportTransferField[], defaultLabels:string[],\n        docUpdateCb:(createdDocumentId:string) => void):void {\n        let that = this;\n        if (app.getNeedsSave()) {\n            ml.UI.showError(\"You must save document\", \"Save document before archiving it!\");\n            return;\n        }\n        let useDefaultFolder = globalMatrix.globalShiftDown;\n\n        matrixSession.getCommentAsync().done(function (comment: string) {\n            // get the last used folders\n            let signTarget = globalMatrix.projectStorage.getItem(\"SignTarget\") ? globalMatrix.projectStorage.getItem(\"SignTarget\") : \"F-SIGN-1\";\n\n           // shift pressed - use default folder\n            if ( useDefaultFolder ) {\n                that.createSIGN( signTarget, comment, docId, signatures, signedDocumentsControl, labelFilter, signName, transferFields, defaultLabels, docUpdateCb);\n            } else {\n                var st = new ItemSelectionTools();\n                st.showDialog({\n                    selectMode: SelectMode.singleFolder,\n                    linkTypes: [{type: \"SIGN\"}],\n                    selectionChange: function (newSelection:IReference[]) {\n                        if (!newSelection.length) {\n                            newSelection = [{to:\"F-SIGN-1\",title:\"\"}];\n                        }\n                        signTarget = newSelection[0].to;\n                        globalMatrix.projectStorage.setItem(\"SignTarget\", signTarget);\n\n                        // finally\n                        that.createSIGN( signTarget, comment, docId, signatures, signedDocumentsControl, labelFilter, signName, transferFields, defaultLabels, docUpdateCb);\n                    },\n                    getSelectedItems: async function () {\n                        return [{to:signTarget, title:\"\"}];\n                    },\n                    dialogTitle:\"Select target folder\",\n                    focusOn:signTarget\n                });\n            }\n\n        });\n    }\n\n    createSIGN(target:string, comment:string, docId: string, signatures: string[], signedDocumentsControl: JQuery, labelFilter:string, signName:string, transferFields:IReportTransferField[], defaultLabels:string[],\n        docUpdateCb:(createdDocumentId:string) => void):void {\n\n        let that = this;\n\n        var reportOptions:IReportOptions = { reason: comment };\n\n        if (labelFilter && labelFilter.length > 0) {\n            reportOptions.filter = labelFilter;\n        }\n\n        if (!signatures || signatures.length === 0) {\n            reportOptions[\"isSignedReport\"] = true;\n            reportOptions[\"includeSignatures\"] = \"\";\n        } else {\n            reportOptions[\"isSignedReport\"] = true;\n            reportOptions[\"includeSignatures\"] = signatures.join(',');\n        }\n        reportOptions[\"newTitle\"] = signName;\n        if (transferFields) {\n            var trv = \"\";\n            $.each(transferFields, function (tfIdx, tfv) {\n                if (trv !== \"\") {\n                    trv += \";\";\n                }\n                trv += \"(\" + tfv.fromId + \",\" + tfv.toId + \")\";\n            });\n            if (trv !== \"\") {\n                reportOptions[\"copyFields\"] = trv;\n            }\n        }\n\n        that.StartReportEngine(docId, reportOptions, \"Creating SIGNed Document\", function (lastCreatedObject:IGetReportProgressJobFileResult) {\n\n            var newId = lastCreatedObject.visibleName;\n            docUpdateCb(newId);\n            // the new SIGN item id (newId) was created on the server, create the link and udpate the client\n            app.getItemAsync(newId).done(function (itemdetails: IItem) {\n\n                MR1.triggerAfterCreateSign(itemdetails);\n                if (defaultLabels.length > 0) {\n                    app.updateItemInDBAsync({ id: itemdetails.id, onlyThoseFields: 1, onlyThoseLabels: 1, labels: defaultLabels.join(\",\") }, \"edit\").done(function (updatedItem) {\n                    that.addSignToTree(target, comment, updatedItem, signedDocumentsControl);\n                    });\n                } else {\n                    that.addSignToTree(target, comment, itemdetails, signedDocumentsControl);\n                }\n\n            }).fail(function () {\n                ml.UI.showError(\"Could not create SIGN document!\", \"\");\n            });\n\n        });\n\n    }\n\n    protected async addSignToTree(target: string, comment: string, itemdetails: IItemGet, signedDocumentsControl: JQuery) {\n\n        if (target != \"F-SIGN-1\") {\n            // move it to target on server\n            app.moveItemsAsync(itemdetails.id, target, 10000, comment);\n        }\n\n        // in the meantime update the tree\n        var itemJson = {\n            id: itemdetails.id,\n            title: itemdetails.title,\n            type: itemdetails.type\n        };\n        var newItem = {\n            parent: target,\n            position: 100000,\n            item: itemJson\n        };\n\n        app.insertInTree(newItem);\n        app.updateCache(newItem);\n\n        // and add it to the list of downlinks\n        if (signedDocumentsControl) {\n            var refs = <IReference[]> await signedDocumentsControl.getController().getValueAsync();\n            if (!refs) {\n                refs = [];\n            }\n            refs.push({\n                to: itemdetails.id,\n                title: itemdetails.title\n            });\n            signedDocumentsControl.getController().setValue(refs);\n\n            ml.UI.showSuccess(\"Signed document \" + itemdetails.id + \" was created\");\n        }\n\n    }\n\n    CreateDoc(docId: string, format: IReportOptions, labelFilter:string):void {\n\n        var reportOptions:IReportOptions = format ? format : <IReportOptions>{};\n        if (labelFilter && labelFilter.length > 0) {\n            reportOptions.filter = labelFilter;\n        }\n        this.SaveAndCreate(docId, reportOptions, \"Downloading Document\", null);\n    }\n\n    CreateReport(reportId: string, format: IReportOptions, inputItems?:IReportInput[], requiredItems?:IReportInput[]):void {\n\n        var reportOptions: IReportOptions = format ? format : <IReportOptions>{};\n\n        var labelFilter = ml.LabelTools.getFilter();\n\n        if (labelFilter && labelFilter.length > 0) {\n            reportOptions.filter = labelFilter;\n        }\n\n        // only use the selected / required input\n        var list:string[] = [];\n        if (inputItems) {\n            for (var idx = 0; idx < inputItems.length; idx++) {\n                list.push(inputItems[idx].to);\n            }\n        }\n\n        if (requiredItems) {\n            for (var idx = 0; idx < requiredItems.length; idx++) {\n                list.push(requiredItems[idx].to);\n            }\n        }\n        if (list.length > 0) {\n            reportOptions[\"itemList\"] = list.join(\",\");\n        }\n\n        this.SaveAndCreate(reportId, reportOptions, \"Downloading Report\", null);\n    }\n\n    DownloadSignedDoc(signedId:string, format:IReportOptions) {\n        let that = this;\n        ml.Logger.log('debug', \"starting signed report\");\n        ml.Logger.log('lastReportJobId', \"\");\n        ml.Logger.log('lastReportFileId', \"\");\n        ml.Logger.log('lastReportJobXML', \"\");\n\n        app.startCreateDocumentAsync(signedId, format).done(function (jobId: IPostCreateSignOrDocResult) {\n\n           var reportOptions: IReportOptions = format ? format : <IReportOptions>{};\n            ml.Logger.log('lastReportJobId', jobId.jobId.toString());\n\n           that.reportJoblist.tasks.push({\n               jobId: jobId.jobId,\n               progress: 0,\n               reportId: signedId,\n               reportOptions: reportOptions,\n               postCreateCallback: null\n           });\n\n           if (that.reportJoblist.tasks.length === 1) {\n               ml.UI.Progress.Init(\"Downloading Document\");\n               that.reportJoblist.allGood = true;\n               that.reportJoblist.doneBatch = 0;\n               clearTimeout(that.reportProc);\n               that.reportProc = window.setTimeout(function () {\n                   that.waitForReports(0);\n               }, 500);\n           }\n       });\n   }\n\n}\n","import { globalMatrix, app, ControlState, matrixSession, restConnection } from \"../../globals\";\nimport { ICaption, ISmartTextConfigReplacement, IDropdownOption, ISmartTextConfig, smartTextConfigSetting } from \"../../ProjectSettings\";\nimport { XRGetProject_ProjectInfo_ProjectInfo } from \"../../RestResult\";\n\nimport { ml } from \"./../matrixlib\";\nimport { ISmartTextTools, ICaptionFormat } from \"./MatrixLibInterfaces\";\n\nexport { SmartTextTools };\n\nclass SmartTextTools implements ISmartTextTools {\n    private figureDef: ICaptionFormat = { preNo: \"Figure \", postNo: \": \", captionDetails: \"captionDetailsFig\", captionClass: \"captionFig\", referenceClassNo: \"referenceFig\" };\n    private tableDef: ICaptionFormat = { preNo: \"Table \", postNo: \": \", captionDetails: \"captionDetailsTab\", captionClass: \"captionTab\", referenceClassNo: \"referenceTab\" };\n\n    //****************************************\n    // LEGACY summernote functions\n    //***************************************\n\n    /* summernote create menu to enter edit macros\n    * docMode is true if editor/menu is a document -> in that case we support table and figure captions\n    * tableMode is true if editor/menu is for a table cell  -> in that case we do not support smart text\n    */\n    createMenu(docMode: boolean, tableMode: boolean): void {\n\n        var hasTags = false;\n        var list = '';\n        var config = this.getCurrentConfig();\n        let dhf_config = globalMatrix.ItemConfig.getDHFConfig();\n\n        // (set (default texts)\n        if (dhf_config && dhf_config.captions) {\n            if (dhf_config.captions.figure) {\n                this.figureDef.preNo = dhf_config.captions.figure.preNo ? dhf_config.captions.figure.preNo : this.figureDef.preNo;\n                this.figureDef.postNo = dhf_config.captions.figure.postNo ? dhf_config.captions.figure.postNo : this.figureDef.postNo;\n            }\n            if (dhf_config.captions.table) {\n                this.tableDef.preNo = dhf_config.captions.table.preNo ? dhf_config.captions.table.preNo : this.tableDef.preNo;\n                this.tableDef.postNo = dhf_config.captions.table.postNo ? dhf_config.captions.table.postNo : this.tableDef.postNo;\n            }\n        }\n        var isInDialog = $(\".smarttaglist\").closest(\".dialog-body\").length > 0;\n\n        // group them by tag type\n        var groups: ISmartTextConfigReplacement[][] = [];\n        var gc = 0;\n        $.each(config.replacements, function (optIdx, opt) {\n            var tt = opt.tagType ? opt.tagType : (opt.plain ? 1 : 2);\n            if (!groups[tt]) {\n                gc++;\n                groups[tt] = [];\n            }\n            groups[tt].push(opt);\n        });\n        // insert smart references\n        list += '<li class=\"selectSmartTextGroup dropdown-submenu\"><a tabindex=\"-1\" href=\"javascript:void(0)\">' +\n            'Insert References to</a><ul style=\"min-width:150px;\" class=\"dropdown-menu\">';\n\n        list += '<li class=\"\">' +\n            '<a class=\"selectSmartText smarttextblock\" data-event=\"selectSmartLink\" href=\"#\" ' +\n            '\" data-toggle=\"tooltip\"><span style=\"margin:0 80px 0 0\">Item(s) in this project</span></a>' + '</li>';\n        list += '<li class=\"\">' +\n            '<a class=\"selectSmartText smarttextblock\" data-event=\"selectCrossLink\" href=\"#\" ' +\n            '\" data-toggle=\"tooltip\"><span style=\"margin:0 80px 0 0\">Item(s) in another project</span></a>' + '</li>';\n\n        list += '</ul></li>';\n\n        // insert smart text blocks\n        for (var gidx = 0; !tableMode && gidx < groups.length; gidx++) {\n            var group = groups[gidx];\n            if (group) {\n\n                list += `\n                <li class=\"selectSmartTextGroup dropdown-submenu\">\n                    <a tabindex=\"-1\" href=\"javascript:void(0)\">Insert ${this.getTooltipType(group[0])}</a>\n                    <ul style=\"min-width:150px;\" class=\"stsm dropdown-menu\">\n                        <li class=\"filterListList\"><input autocomplete=\"off\" placeholder=\"filter list\" class=\"filterList\" type=\"text\"></li>`\n\n\n                $.each(group, function (optIdx, opt) {\n                    list += `\n                    <li class=\"\">\n                        <a class=\"selectSmartText smarttextblock\" data-event=\"selectSmartText\" href=\"#\" name=\"${opt.what}\" data-value=\"${opt.what}\" data-toggle=\"tooltip\">\n                           <span style=\"margin:0 80px 0 0\">${opt.what}</span>\n                           <i class=\"deleteSmartText fal fa-trash-alt\"></i>\n                           <i class=\"editSmartText fal fa-edit\"></i>\n                        </a>\n                    </li>`;\n\n                    hasTags = true;\n                });\n\n                list += '</ul></li>';\n            }\n        }\n\n        // insert figures / tables\n        if (!tableMode && dhf_config && dhf_config.captions) {\n\n            if ($(\"#itemDetails .\" + this.figureDef.captionDetails).length > 0) {\n                list += '<li class=\"selectSmartTextGroup dropdown-submenu\"><a tabindex=\"-1\" href=\"javascript:void(0)\">' +\n                    'Insert Figure Reference</a><ul style=\"min-width:400px;max-width:450px;\" class=\"dropdown-menu\">';\n\n                $.each($(\"#itemDetails .\" + this.figureDef.captionDetails), function (captIdx, caption) {\n                    list += '<li class=\"\">' +\n                        '<a class=\"selectSmartText smarttextblock\" data-event=\"insertFigReference\" href=\"#\" name=\"' + \"figure\" +\n                        '\" data-value=\"' + $(caption).data(\"mid\") +\n                        '\" data-toggle=\"tooltip\"><span style=\"white-space:normal;margin:0 80px 0 0\">' + $(caption).text();\n                    list += '</a>' + '</li>';\n                    hasTags = true;\n                });\n\n                list += '</ul></li>';\n            }\n            if ($(\"#itemDetails .\" + this.tableDef.captionDetails).length > 0) {\n                list += '<li class=\"selectSmartTextGroup dropdown-submenu\"><a tabindex=\"-1\" href=\"javascript:void(0)\">' +\n                    'Insert Table Reference</a><ul style=\"min-width:400px;max-width:450px;\" class=\"dropdown-menu\">';\n\n                $.each($(\"#itemDetails .\" + this.tableDef.captionDetails), function (captIdx, caption) {\n                    list += '<li class=\"\">' +\n                        '<a class=\"selectSmartText smarttextblock\" data-event=\"insertTabReference\" href=\"#\" name=\"' + \"table\" +\n                        '\" data-value=\"' + $(caption).data(\"mid\") +\n                        '\" data-toggle=\"tooltip\"><span style=\"white-space:normal;margin:0 80px 0 0\">' + $(caption).text();\n                    list += '</a>' + '</li>';\n                    hasTags = true;\n                });\n\n                list += '</ul></li>';\n            }\n\n        }\n\n        if (globalMatrix.serverStorage.getItem(\"copyBuffer\")) {\n            list += '<li><a title=\"paste copy buffer\" data-event=\"pasteBuffer\" href=\"#\" data-value=\"\">Paste ' + '</a></li>';\n        }\n\n        if (!tableMode) {\n            // add menu to create new tags\n            if (!hasTags) {\n                list += '<li><a href=\"https://urlshort.matrixreq.com/d23/manual/macros\" target=\"_blank\" class=\"documentationLink\" >Smart Text Help</a></li>';\n            }\n            list += '<li><hr style=\"margin:0px\" /></li>';\n\n            list += '<li><a title=\"can only be used in rich text fields\" data-event=\"createSmartText\" href=\"#\" data-value=\"\">Define rich text tag ' + '</a></li>';\n            list += '<li><a title=\"can be used in rich text fields and document properties\" data-event=\"createPlainText\" href=\"#\" data-value=\"\">Define plain text tag ' + '</a></li>';\n            list += '<li><a title=\"can be used to build a dictionary of terms\" data-event=\"createTermText\" href=\"#\" data-value=\"\">Define term ' + '</a></li>';\n            list += '<li><a title=\"can be used to build a dictionary of abbreviation\" data-event=\"createAbbreviationText\" href=\"#\" data-value=\"\">Define abbreviation ' + '</a></li>';\n\n            if (dhf_config && dhf_config.captions) {\n                list += '<li><a title=\"can be used to insert a caption for a figure\" data-event=\"createFigureCaption\" href=\"#\" data-value=\"\">Define figure caption ' + '</a></li>';\n                list += '<li><a title=\"can be used to insert a caption for a table\" data-event=\"createTableCaption\" href=\"#\" data-value=\"\">Define table caption ' + '</a></li>';\n            }\n        }\n\n        // add menu\n        $(\".smarttaglist\").html(list);\n        window.setTimeout(function () {\n            // one rendered\n            // avoid flickering of sub menus (at bottom of screen)\n            $.each($(\".smarttaglist .stsm\"), function (idx, stsm) {\n                $(stsm).css(\"max-height\", ($(stsm).parent().parent().height() - $(stsm).parent().position().top) + \"px\");\n            });\n        }, 200);\n\n\n        // implement filter\n        $(\".filterList\").click(function (event: JQueryEventObject) {\n            event.preventDefault();\n            event.stopPropagation();\n            return false;\n        });\n        $(\".filterList\").keyup(function (event: JQueryEventObject) {\n            let filterInput = $(event.delegateTarget);\n            let filterText = $(event.delegateTarget).val().toLowerCase();\n\n            $.each($(\"a\", filterInput.closest(\"ul\")), function (idx, st) {\n                if (!filterText) {\n                    $(st).show();\n                } else {\n                    let key: string = $(st).data(\"value\") + \"\";\n                    let reps = config.replacements.filter(function (rep) { return rep.what == key; });\n                    let rwith = $(\"<div>\").html(reps[0].with).text().toLowerCase();\n                    if (reps.length == 1 && key.toLowerCase().indexOf(filterText) == -1 && rwith.indexOf(filterText) == -1) {\n                        $(st).hide();\n                    } else {\n                        $(st).show();\n                    }\n                }\n            });\n\n            return false;\n        });\n\n\n        // add tooltips\n        $.each(config.replacements, function (optIdx, opt) {\n            var replace = opt.with;\n            if (opt.tagType === 3 || opt.tagType === 4) {\n                replace += \"<hr style='margin:0px'><div class='smarttext-menu-tt'>\" + opt.description + \"</div>\";\n            }\n            $(\"a[name=\" + opt.what + \"]\", $(\".smarttaglist\")).tooltip({\n                html: true,\n                title: replace,\n                placement: \"right\",\n                container: 'body',\n                template: '<div class=\"tooltip smarttext-tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow smarttext-tooltip-arrow\"></div><div class=\"tooltip-inner smarttext-tooltip-inner\"></div></div>'\n            });\n        });\n    }\n\n    // summernote create menu to get rid of a macro\n    deleteTag(what: string): void {\n        let that = this;\n        function deleteIt() {\n            var config = globalMatrix.ItemConfig.getSmartText();\n            if (!config || !config.replacements) {\n                config = { \"replacements\": [] };\n            }\n            var replacements: ISmartTextConfigReplacement[] = [];\n            $.each(config.replacements, function (optIdx, opt) {\n                if (opt.what + \"\" !== what + \"\") {\n                    replacements.push(opt);\n                }\n            });\n            $('[data-value=\"' + what + '\"]').parent().remove();\n            config.replacements = replacements;\n            app.setSettingJSON(\"rtf\", config);\n        }\n        app.searchAsync(\"_\" + what + \"_\").done(function (results: {}[]) {\n            if (results.length > 0) {\n\n                ml.UI.showConfirm(5, { title: \"The smart text tag <b>\" + what + \"</b> is currently used \" + results.length + \" or more times. Delete anyway?\", ok: \"Delete\" }, function () {\n                    deleteIt();\n                }, function () {\n\n                });\n            } else {\n                deleteIt();\n            }\n        });\n    };\n\n    // summernote insert a figure reference\n    insertFigReference(reference: string, editor: any, editable: any) {\n\n        let ref = $(`#itemDetails .${this.figureDef.captionDetails}[data-mid='${reference}']`); /// Figure X: Explain\n        this.insertReference(ref, this.figureDef, editor, editable)\n    }\n\n    // summernote insert a table of reference\n    insertTabReference(reference: string, editor: any, editable: any) {\n\n        let ref = $(`#itemDetails .${this.tableDef.captionDetails}[data-mid='${reference}']`); /// Table X: Explain\n        this.insertReference(ref, this.tableDef, editor, editable)\n    }\n    //  summernote menu to paste from internal buffer\n    pasteBuffer(editor: any, editable: any) {\n        let html = $(globalMatrix.serverStorage.getItem(\"copyBuffer\"));\n        editor.insertNode(editable, $(html)[0], true);\n    }\n    private insertReference(source: JQuery, def: ICaptionFormat, editor: Summernote.editor, editable: any) {\n\n        let id = source.data(\"mid\");\n        let text = $(\".captionText\", source).html();\n        let reference =\n            `<span class=\"referenceDetails\" data-mid=\"${id}\">\n                <span class=\"referenceFix\" contenteditable=\"false\">\n                    <span class=\"referencePre\">${def.preNo}</span>\n                    <span  class=\"${def.referenceClassNo}\" data-mid=\"${id}\"></span>\n                    <span class=\"referencePost\">${def.postNo}</span>\n                </span>\n                <span class=\"referenceText\">${text}</span>\n            </span> `;\n\n\n        editor.insertNode(editable, $(reference)[0], true);\n        editor.insertNode(editable, $(\"<span>&nbsp;</span>\")[0], true);\n        // put in current number\n        this.updateCaptionsAndReferences();\n    }\n    // insert a caption for table or image\n    createCaption(isTable: boolean, editor: Summernote.editor, editable: any) {\n        let nowms = new Date().getTime();\n\n        let def = isTable ? this.tableDef : this.figureDef;\n        let caption = `<p class=\"caption\">\n            <span class=\"${def.captionDetails}\" data-mid=\"${nowms}\">\n                <span class=\"captionFix\" contenteditable=\"false\">\n                    <span class=\"captionPre\">${def.preNo}</span>\n                    <span  class=\"${def.captionClass}\" data-mid=\"${nowms}\"></span>\n                    <span class=\"captionPost\">${def.postNo}</span>\n                </span>\n                <span class=\"captionText\">${isTable ? \"Table Caption\" : \"Figure Caption\"}</span>\n            </span></p>`;\n\n        editor.insertNode(editable, $(caption)[0], true);\n        this.updateCaptionsAndReferences();\n    }\n\n    //  summernote update numbers for tables and figure references\n    updateCaptionsAndReferences() {\n        $.each($(\"#itemDetails .captionFig\"), function (idx, obj) {\n            $(obj).html(\"\");\n            let mid = $(obj).data(\"mid\");\n            if (mid) {\n                $(obj).html(idx + 1);\n                $(`#itemDetails .referenceFig[data-mid='${mid}']`).html(idx + 1);\n            }\n\n        });\n        $.each($(\"#itemDetails .captionTab\"), function (idx, obj) {\n            $(obj).html(\"\");\n            let mid = $(obj).data(\"mid\");\n            if (mid) {\n                $(obj).html(idx + 1);\n                $(`#itemDetails .referenceTab[data-mid='${mid}']`).html(idx + 1);\n            }\n        });\n    }\n    //  summernote function to create or modify tags\n    createEditTag(tagType: number, what: string, data?: ISmartTextConfigReplacement, saveFct?: Function, forceTiny?: boolean): void {\n        // tagType:\n        // 0 edit existing tag\n        // 1 new plain text tag\n        // 2 new rich text tag\n        // 3 new term tag\n        // 4 abbreviation tag\n        // what is either the macro id or the item to be edited, the later is the case if a saveFct is passed\n        // saveFct: optional function to save creation / changes, if not saved in project settings\n        let that = this;\n\n        let dlg = $(\"#smartTextDlg\");\n        dlg.hide();\n        dlg.html(\"\");\n        dlg.removeClass(\"dlg-no-scroll\");\n        dlg.addClass(\"dlg-v-scroll\");\n        var body =\n            `<div class=\"form-group row-fluid\">\n                <div class=\"smarttext-tag-name controlContainer\" ></div>\n                <div class=\"smartEditor controlContainer\" ></div>\n                <div class=\"tagDescription controlContainer\" ></div>\n            </div>\n            <div class=\"checkbox\">\n                <label><input type=\"checkbox\">Show me current value before creating signed documents</label>\n            </div>`;\n        dlg.append(body);\n\n        var smartEditor: JQuery = $('.smartEditor', dlg);\n        var tagDescription: JQuery = $('.tagDescription', dlg);\n        var warnCheckbox: JQuery = $('[type=checkbox]', dlg);\n\n        let newTagName = $(\".smarttext-tag-name\", dlg);\n\n        var content = \"\";\n        var description = \"\";\n        var warn = false;\n        var dlgTitle = \"Edit \";\n        let isCreate = false;\n        // define default content: get it from selection of rich text editor\n        if ((tagType === 1 || tagType === 2 || tagType === 4) && window.getSelection().rangeCount) {\n            dlgTitle = \"Create \";\n            isCreate = true;\n            var range = window.getSelection().getRangeAt(0);\n            try {\n                var fragment = range.cloneContents();\n                var div = document.createElement('div');\n                div.appendChild(fragment.cloneNode(true));\n                content = (tagType === 1) ? div.innerText : div.innerHTML;\n            } catch (ex) {\n                // nothing selected\n            }\n        } else if (tagType === 0 && what) {\n            // it is an edit... replace it with the actual tag type which is stored in the database\n            var opt = data ? data : this.getReplacement(what);\n            tagType = opt.tagType ? opt.tagType : (opt.plain ? 1 : 2);\n            description = opt.description ? opt.description : \"\";\n            content = opt.with ? opt.with : \"\";\n            warn = opt.warn ? opt.warn : false;\n            what = opt.what;\n        }\n\n\n        if (tagType === 1) {\n            dlgTitle += \"Plain Text\";\n        } else if (tagType === 4) {\n            dlgTitle += \"Abbreviation\";\n        } else if (tagType === 2) {\n            dlgTitle += \"Smart Text\";\n        } else if (tagType === 3) {\n            dlgTitle += \"Term\";\n        }\n\n        dlg.dialog({\n            autoOpen: true,\n            title: dlgTitle,\n            width: 716,\n            height: 680,\n            resizeStop: function () { },\n            modal: true,\n            open: function () {\n                ml.UI.pushDialog(dlg);\n                // enable or set tag name input field\n                warnCheckbox.prop(\"checked\", warn);\n\n                // set editor to plain text or html\n                smartEditor.html(\"\");\n\n                if (tagType === 1) {\n                    smartEditor.plainText({ fieldValue: content, canEdit: true, help: \"Plain Text\", valueChanged: () => { that.calculateButtonEnable(newTagName, smartEditor, tagDescription) } });\n                } else if (tagType === 2) {\n                    smartEditor.richText({  controlState: ControlState.DialogEdit, fieldValue: content, canEdit: true, help: \"Rich Text\", parameter: { noConvertTiny: !forceTiny, autoEdit:isCreate }, valueChanged: () => { that.calculateButtonEnable(newTagName, smartEditor, tagDescription) } });\n                } else if (tagType === 3) {\n                    smartEditor.plainText({  controlState: ControlState.DialogEdit, fieldValue: content, canEdit: true, help: \"Term\", parameter: { rows: 1, allowResize: false }, valueChanged: () => { that.calculateButtonEnable(newTagName, smartEditor, tagDescription) } });\n                    tagDescription.richText({ fieldValue: description, canEdit: true, help: \"Explanation\", parameter: { height: 200, noConvertTiny: !forceTiny, autoEdit:isCreate }, valueChanged: () => { that.calculateButtonEnable(newTagName, smartEditor, tagDescription) } });\n                } else if (tagType === 4) {\n                    smartEditor.plainText({ fieldValue: content, canEdit: true, help: \"Short Name\", parameter: { rows: 1, allowResize: false }, valueChanged: () => { that.calculateButtonEnable(newTagName, smartEditor, tagDescription) } });\n                    tagDescription.plainText({ fieldValue: description, canEdit: true, help: \"Full Name\", parameter: { rows: 1, allowResize: false, autoEdit:isCreate }, valueChanged: () => { that.calculateButtonEnable(newTagName, smartEditor, tagDescription) } });\n                }\n                that.addEnter(newTagName, smartEditor, tagDescription, what);\n                if (what) {\n                    // edit existing tag\n                    newTagName.getController().setValue(what);\n                }\n\n                ml.UI.setEnabled($(\".btnDoIt\", $(\"#smartTextDlg\").parent()), false);\n            },\n            close: function () { ml.UI.popDialog(dlg); },\n            buttons: [{\n                text: 'Save',\n                class: 'btnDoIt',\n                click: async function () {\n                    var html = await smartEditor.getController().getValueAsync();\n                    var description = (tagType === 3 || tagType === 4) ? await tagDescription.getController().getValueAsync() : \"\";\n                    var tag = await newTagName.getController().getValueAsync();\n                    var warn = warnCheckbox.prop(\"checked\");\n                    var newRTF: ISmartTextConfigReplacement = {\n                        \"what\": tag,\n                        \"with\": html,\n                        \"warn\": warn,\n                        tagType: tagType,\n                        description: description,\n                        when: (new Date()).toISOString()\n                    };\n\n                    if (saveFct) {\n                        if (saveFct(newRTF)) {\n                            dlg.dialog(\"close\");\n                        }\n                    } else {\n                        that.saveTag(newRTF);\n                        dlg.dialog(\"close\");\n                    }\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    dlg.dialog(\"close\");\n                }\n            }]\n        });\n    }\n\n    //****************************************\n    // tiny rich text functions\n    // *************************************** /\n\n    // tiny: dialog to manipulate tags\n    selectEditCreateTag(mode: number, tagType: number, tagSelected: Function): void {\n        // mode:\n        // 0 insert\n        // 1 add\n        // 2 edit\n        // tagType:\n        // 1 new plain text tag\n        // 2 new rich text tag\n        // 3 new term tag\n        // 4 abbreviation tag\n        // saveFct: function returning the selected macro\n        let that = this;\n\n        // get existing options\n        let existing: ISmartTextConfigReplacement[] = [];\n        let allTagIds: string[] = [];\n\n\n        var config = that.getCurrentConfig();\n        $.each(config.replacements, function (optIdx, opt) {\n            allTagIds.push(opt.what);\n            let tt = opt.tagType ? opt.tagType : (opt.plain ? 1 : 2);\n            if (tt == tagType) {\n                existing.push(opt);\n            }\n        });\n\n        let previous: ISmartTextConfigReplacement[] = ml.JSON.clone(existing);\n\n        // prepare dialog\n        let dlg = $(\"#smartTextDlg\");\n        dlg.hide();\n        dlg.html(\"\");\n        dlg.removeClass(\"dlg-no-scroll\");\n        dlg.addClass(\"dlg-v-scroll\");\n        var body =\n            `<div class=\"form-group row-fluid\">\n            <div class=\"smartSelect\" ></div>\n            <div class=\"smartEditor\" ></div>\n            <div class=\"tagDescription\" ></div>\n        </div>\n        <div class=\"checkbox\">\n            <label><input type=\"checkbox\">Show me current value before creating signed documents</label>\n        </div>`;\n        dlg.append(body);\n\n        var smartSelect: JQuery = $('.smartSelect', dlg);\n        var smartEditor: JQuery = $('.smartEditor', dlg);\n        var tagDescription: JQuery = $('.tagDescription', dlg);\n        var warnCheckbox: JQuery = $('[type=checkbox]', dlg);\n\n        var content = \"\";\n        var description = \"\";\n        var warn = false;\n        var dlgTitle = \"\";\n\n        if (tagType === 1) {\n            dlgTitle += \"Plain Text\";\n        } else if (tagType === 4) {\n            dlgTitle += \"Abbreviation\";\n        } else if (tagType === 2) {\n            dlgTitle += \"Smart Text\";\n        } else if (tagType === 3) {\n            dlgTitle += \"Term\";\n        }\n        let dialogOptions: JQueryUI.DialogOptions = {\n            autoOpen: true,\n            title: dlgTitle,\n            width: 716,\n            height: 680,\n            resizeStop: function () { },\n            modal: true,\n            open: function () {\n                ml.UI.pushDialog(dlg);\n                // enable or set tag name input field\n                warnCheckbox.prop(\"checked\", warn);\n\n                // set editor to plain text or html\n                smartEditor.html(\"\");\n                if (tagType === 1) {\n                    smartEditor.plainText({ fieldValue: content, canEdit: (mode > 0), help: \"Plain Text\", valueChanged: () => { that.calculateButtonEnable(smartSelect, smartEditor, tagDescription) } });\n                    tagDescription.hidden({});\n                } else if (tagType === 2) {\n                    smartEditor.richText({ controlState: ControlState.DialogEdit, fieldValue: content, canEdit: (mode > 0), help: \"Rich Text\", parameter: { tableMode: true, tiny: true, autoEdit:mode==1}, valueChanged: () => { that.calculateButtonEnable(smartSelect, smartEditor, tagDescription) } });\n                    tagDescription.hidden({});\n                } else if (tagType === 3) {\n                    smartEditor.plainText({ fieldValue: content, canEdit: (mode > 0), help: \"Term\", parameter: { rows: 1, allowResize: false }, valueChanged: () => { that.calculateButtonEnable(smartSelect, smartEditor, tagDescription) } });\n                    tagDescription.richText({ controlState: ControlState.DialogEdit, fieldValue: description, canEdit: (mode > 0), help: \"Explanation\", parameter: { height: 120, tiny: true, autoEdit:mode==1 }, valueChanged: () => { that.calculateButtonEnable(smartSelect, smartEditor, tagDescription) } });\n                } else if (tagType === 4) {\n                    smartEditor.plainText({ fieldValue: content, canEdit: (mode > 0), help: \"Short Name\", parameter: { rows: 1, allowResize: false }, valueChanged: () => { that.calculateButtonEnable(smartSelect, smartEditor, tagDescription) } });\n                    tagDescription.plainText({ fieldValue: description, canEdit: (mode > 0), help: \"Full Name\", parameter: { rows: 1, allowResize: false }, valueChanged: () => { that.calculateButtonEnable(smartSelect, smartEditor, tagDescription) } });\n                }\n                if (mode == 0 /* insert */ || mode == 2 /* add */) {\n                    that.addSelect(smartSelect, existing, tagType, smartEditor, tagDescription, warnCheckbox);\n                } else {\n                    that.addEnter(smartSelect, smartEditor, tagDescription, \"\");\n                }\n                ml.UI.setEnabled($(\".btnDoIt\", $(\"#smartTextDlg\").parent()), false);\n            },\n            close: function () { ml.UI.popDialog(dlg); },\n            buttons: [{\n                text: 'Close',\n                class: 'btnCancelIt',\n                click: function () {\n                    dlg.dialog(\"close\");\n                }\n            }]\n        };\n\n        if (mode == 0 /* insert */) {\n            (<JQueryUI.DialogButtonOptions[]>dialogOptions.buttons).splice(0, 0, {\n                text: 'Insert',\n                class: 'btnDoIt',\n                click: async function () {\n                    let html = await that.removeOuterParagraph(await smartEditor.getController().getValueAsync());\n                    var description = (tagType === 3 || tagType === 4) ? await tagDescription.getController().getValueAsync() : \"\";\n                    var tag =  await  smartSelect.getController().getValueAsync();\n                    var warn = warnCheckbox.prop(\"checked\");\n\n                    // update the current if there's one\n                    let exists = existing.filter(function (repl) {\n                        return repl.what == tag;\n                    });\n                    if (exists.length) {\n                        exists[0].description = description;\n                        exists[0].with = html;\n                        exists[0].warn = warn;\n                    }\n                    if (exists.length) {\n                        tagSelected(exists[0]);\n                    }\n\n                    that.updateTags(tagType, previous, existing);\n\n                    dlg.dialog(\"close\");\n                }\n            })\n        } else if (mode == 1 /* edit */ || mode == 2 /* add */) {\n            (<JQueryUI.DialogButtonOptions[]>dialogOptions.buttons).splice(0, 0, {\n                text: 'Save',\n                class: 'btnDoIt',\n                click: async function () {\n                    let html = that.removeOuterParagraph(await smartEditor.getController().getValueAsync());\n                    var description = (tagType === 3 || tagType === 4) ? await tagDescription.getController().getValueAsync() : \"\";\n                    var tag = await smartSelect.getController().getValueAsync();\n                    var warn = warnCheckbox.prop(\"checked\");\n                    // update the current if there's one\n                    let existsAsAnyType = allTagIds.indexOf(tag) != -1;\n                    let exists = existing.filter(function (repl) {\n                        return repl.what == tag;\n                    });\n                    if (mode == 1 && existsAsAnyType) { // create\n                        ml.UI.showError(\"Tag id exists already\", \"There is already a tag with id '\" + tag + \"'\");\n                        return false;\n                    } else if (mode == 2 && exists.length == 0 && existsAsAnyType) { // edit dialog, trying to add something which exists as other type\n                        ml.UI.showError(\"Tag id exists already\", \"There is already another tag with id '\" + tag + \"'\");\n                        return false;\n                    } else if (exists.length) { // the tag already exist as same type\n                        exists[0].description = description;\n                        exists[0].with = html;\n                        exists[0].warn = warn;\n                    } else {\n                        // create new\n                        existing.push({\n                            tagType: tagType,\n                            what: tag,\n                            description: description,\n                            with: html,\n                            warn: warn,\n                            when: (new Date()).toISOString()\n                        })\n                    }\n\n                    that.updateTags(tagType, previous, existing);\n\n                    dlg.dialog(\"close\");\n                    return true;\n                }\n            });\n        }\n\n\n        dlg.dialog(dialogOptions);\n    }\n\n    // tiny: figure out if tag can be inserted\n    private calculateButtonEnableInsert(option: string) {\n        let btnEnabled = !!option;\n\n        ml.UI.setEnabled($(\".btnDoIt\", $(\"#smartTextDlg\").parent()), btnEnabled);\n    }\n\n    // tiny: figure out if tag can be created\n    private async calculateButtonEnable(tagName: JQuery, smartEditor: JQuery, tagDescription: JQuery) {\n        let btnEnabled = true;\n        if (await smartEditor.getController().getValueAsync() == \"\") {\n            btnEnabled = false;\n        }\n\n        if ($(\"input\", tagDescription).is(\":visible\") && await tagDescription.getController().getValueAsync() == \"\") {\n            btnEnabled = false;\n        }\n\n        if (tagName.getController && await tagName.getController().getValueAsync() == \"\") {\n            btnEnabled = false;\n        }\n        if (!tagName.getController && tagName.val() == \"\") {\n            btnEnabled = false;\n        }\n\n        ml.UI.setEnabled($(\".btnDoIt\", $(\"#smartTextDlg\").parent()), btnEnabled);\n    }\n\n    // tiny: get rid of <p>tag around rich text (if there are not 2 paragraphs)\n    removeOuterParagraph(edit: string) {\n        if (edit.length < 8) return edit; // no <p>something</p>\n        if (edit.substr(0, 3) != \"<p>\") return edit; // no <p>something</p>\n        if (edit.substr(edit.length - 4, 4) != \"</p>\") return edit; // no <p>something</p>\n        if (edit.indexOf(\"<p\", 1) != -1) return edit; // <p>something</p><p> xxx</p>\n        return edit.substr(3, edit.length - 7);\n    }\n\n    // tiny: create dropdown with existing tags\n    private addSelect(container: JQuery, existing: ISmartTextConfigReplacement[], tagType: number, replace: JQuery, description: JQuery, warn: JQuery) {\n        let that = this;\n\n        let options: IDropdownOption[] = existing.map(function (st, idx) { return { id: st.what, label: (st.projectSetting ? st.what : (st.what + \" (server)\")) } });\n\n        let last = \"\";\n\n        let dd = container.mxDropdown({\n            help: \"Macro Name\",\n            canEdit: true,\n            parameter: {\n                placeholder: \"select macro\",\n                create: true,\n                options: options,\n                maxItems: 1,\n                sort: true\n            }, valueChanged: async function () {\n                let val = await dd.getController().getValueAsync();\n                var before = existing.filter(function (sm) {\n                    return sm.what == last\n                });\n                if (before.length) {\n                    // update the previously selected\n                    before[0].with = await replace.getController().getValueAsync();\n                    before[0].description = that.removeOuterParagraph(await description.getController().getValueAsync());\n                    before[0].warn = warn.prop(\"checked\");\n                }\n\n                var after = existing.filter(function (sm) {\n                    return sm.what == val\n                });\n                if (after.length) {\n                    // load the new one\n                    replace.getController().setValue(after[0].with);\n                    description.getController().setValue(after[0].description);\n                    warn.prop(\"checked\", after[0].warn);\n                }\n\n                last = val;\n                that.calculateButtonEnableInsert(val);\n\n            },\n            fieldValue: \"\"\n        });\n        return dd;\n    }\n\n    // tiny: field to enter tag name\n    private addEnter(container: JQuery, replace: JQuery, description: JQuery, text: string) {\n        let that = this;\n        let last = \"\";\n\n        let dd = container.plainText({\n            id: \"\",\n            help: \"New Macro Name:\",\n            parameter: { rows: 1, allowResize: false},\n            controlState: ControlState.DialogCreate,\n            valueChanged: async () => {\n                let val = await dd.getController().getValueAsync();\n                let clean = val ? val.replace(/[^a-zA-Z0-9]/g, '') : \"\";\n                if (clean && last != clean) {\n                    last = clean;\n                    dd.getController().setValue(clean);\n                }\n                that.calculateButtonEnable(container, replace, description);\n            },\n            canEdit: text ? false : true,\n            validate: false, noAutoActivation: true\n            , fieldValue: text ? text : \"\"\n        });\n        return dd;\n    }\n\n    //****************************************\n    // both editors (sumernote+tiny) functions\n    // *************************************** /\n\n    replaceTextFragments(text: string, showTooltips?: boolean, encoded?: boolean): string {\n        let that = this;\n\n        var textFragments = this.getCurrentConfig();\n        if (textFragments && textFragments.replacements) {\n\n            $.each(textFragments.replacements, function (replacementIdx, replacement) {\n                let resolved = that.resolveRec(replacement.with, textFragments.replacements, 5);\n\n                let rwith = \"<span class='macro' data-macro='_\" + replacement.what + \"_'>\" + resolved + \"<span class='\" +\n                    (showTooltips ? 'smart-replace' : '') +\n                    \"' data-toggle='tooltip'  data-what='\" + replacement.what + \"' data-placement='auto top' >\" +\n                    (showTooltips ? '*' : '') + \"</span></span>\";\n                if (encoded) {\n                    rwith = JSON.stringify(rwith);\n                    rwith = rwith.substr(1, rwith.length - 2);\n                }\n                text = text.replace(new RegExp(\"_\" + replacement.what + \"_\", 'g'), rwith);\n            });\n        }\n        return text;\n    }\n\n    private resolveRec(text: string, replace: ISmartTextConfigReplacement[], levels: number) {\n        if (!levels) {\n            // no more replacements\n            return text;\n        }\n        let org = text;\n        for (let rep of replace) {\n            text = text.replace(new RegExp(\"_\" + rep.what + \"_\", 'g'), rep.with);\n        }\n        // if something was replaced go on\n        return org == text ? org : this.resolveRec(text, replace, levels - 1);\n    }\n    showTooltips(node: JQuery, noContainer?: boolean) {\n        let that = this;\n        $.each($(\".smart-replace\", node), function (tti, tt) {\n            const what = $(tt).data(\"what\");\n            const rwith = that.getReplacement(what);\n            if (rwith) {\n                const tagType = rwith.tagType ? rwith.tagType : (rwith.plain ? 1 : 2);\n\n                let tooltip = \"<div class='smarttext_what'>_\" + what + \"_ (\" + that.getTooltipType(rwith) + \")</div>\";\n\n                if (tagType === 3 || tagType === 4) {\n                    tooltip += \"<div class='smarttext_description'>\" + rwith.description + \"</div>\";\n                }\n                $(tt).tooltip({\n                    html: true,\n                    title: tooltip,\n                    container: noContainer ? false : \"body\",\n                    template: '<div class=\"tooltip smarttext-tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow smarttext-tooltip-arrow\"></div><div class=\"tooltip-inner smarttext-tooltip-inner\"></div></div>'\n                });\n            }\n        });\n    };\n\n    prepareForReadReadRender(itemDetails: JQuery) {\n        const shadowRoots = {}\n\n        // replace all form fields with static html to so that they can be easily copied\n        $(\"select\", itemDetails).each(function (idx, select) { $(select).replaceWith(\"<div>\" + ml.UI.lt.forDB( $(\"option:selected\", $(select)).text(), 0) + \"</div>\"); });\n        $(\"textarea\", itemDetails).each(function (idx, select) { $(select).replaceWith(\"<div>\" + ml.UI.lt.forDB( $(select).val(), 0).replace(/\\n/g, \"<br>\") + \"</div>\"); });\n        // line input fields\n        $(\"input[type!=checkbox]\", itemDetails).each(function (idx, select) { $(select).replaceWith(\"<div>\" + ml.UI.lt.forDB( $(select).val(), 0) + \"</div>\"); });\n        // checkboxes\n        $(\"input[type=checkbox]:not(.showHideAdmin)\", itemDetails).each(function (idx, select) { $(select).replaceWith(\"<span class='\" + ($(select).is(':checked') ? \"\tfal fa-check-square\" : \"fal fa-square\") + \"'> </span>\"); });\n        // Shadow Doms for text boxes\n        itemDetails[0].querySelectorAll(\".shadow-root\").forEach(element => {\n            const shadow = element.shadowRoot;\n            const id = element.id;\n            if (shadow == null) {\n                console.error(\"Shadow node does not contain a shadow root\")\n            }\n            else if (id == null || id == \"\") {\n                console.error(\"Shadow node does not have an ID, history view won't work!\")\n            } else {\n                if (shadowRoots.hasOwnProperty(id)) {\n                    console.error(\"Shadow node without unique ID, this will cause issues!\")\n                } else {\n                    shadowRoots[id] = shadow.innerHTML;\n                }\n            }\n        });\n        // cache html\n        itemDetails.parent().data(\"originalHTML\",  itemDetails.html());\n        // cache shadow roots\n        itemDetails.parent().data(\"shadowRoots\", JSON.stringify(shadowRoots));\n    }\n\n    private getTooltipType(repl: ISmartTextConfigReplacement): string {\n        var tagType = repl.tagType ? repl.tagType : (repl.plain ? 1 : 2);\n        switch (tagType) {\n            case 1:\n                return \"Plain Text Replacement\";\n            case 2:\n                return \"Rich Text Replacement\";\n            case 3:\n                return \"Term Definition\";\n            case 4:\n                return \"Abbreviation\";\n        }\n        return \"\";\n    }\n\n    private getCurrentConfig(): ISmartTextConfig {\n        var config: ISmartTextConfig = { replacements: [] };\n        if (globalMatrix.ItemConfig == undefined)\n             return config\n\n        var sconfig = globalMatrix.ItemConfig.getSmartText();\n        if (sconfig && sconfig.replacements && sconfig.replacements.length > 0) {\n            // mark the project wide settings\n            config = ml.JSON.clone(sconfig);\n            $.each(config.replacements, function (optIdx, opt) {\n                opt.projectSetting = true;\n            });\n        }\n        // check if there are server/customer settings and merge them in (project have precedence)\n        var sc = <ISmartTextConfig>matrixSession.getCustomerSettingJSON(\"rtf\");\n        if (sc && sc.replacements) {\n            $.each(sc.replacements, function (csidx, cs) {\n                var found = false;\n                $.each(config.replacements, function (optIdx, opt) {\n                    if (opt.what + \"\" === cs.what + \"\") { // make sure both are strings\n                        found = true;\n                    }\n                });\n                if (!found) {\n                    config.replacements.push(cs);\n                }\n            });\n        }\n\n        // sort\n        config.replacements = config.replacements.sort(function (a, b) {\n            return (a.what > b.what) ? 1 : ((a.what < b.what) ? -1 : 0);\n        });\n\n        return config;\n    }\n\n    // update and add new tags\n    private updateTags(tagType: number, previous: ISmartTextConfigReplacement[], updated: ISmartTextConfigReplacement[]) {\n\n        restConnection.getProject(\"setting\").done(function (result: XRGetProject_ProjectInfo_ProjectInfo) {\n            globalMatrix.ItemConfig.addSettings(result);\n\n            var config = globalMatrix.ItemConfig.getSmartText();\n            if (!config || !config.replacements || config.replacements.length === 0) {\n                config = { replacements: [] };\n            }\n            let changed = false;\n\n            $.each(updated, function (eIdx, update) {\n                let found = false;\n\n                let previously = previous.filter(function (prev) { return prev.what == update.what });\n                let unChanged = (previously.length && previously[0].with == update.with && previously[0].description == update.description && previously[0].warn == update.warn);\n\n                if (!unChanged) {\n\n                    // either replace the old from the project setting ...\n                    $.each(config.replacements, function (optIdx, current) {\n                        if (current.what == update.what) {\n                            if (current.with != update.with || current.description != update.description || current.warn != update.warn) {\n                                // update the project setting\n                                found = true;\n                                changed = true;\n                                current.with = update.with;\n                                current.description = update.description;\n                                current.warn = update.warn;\n                                current.when = (new Date()).toISOString();\n\n                            }\n                        }\n                    });\n                    // ... or create a new one\n                    if (!found) {\n                        // we need to create a new project setting\n                        changed = true;\n                        config.replacements.push(\n                            { what: update.what, with: update.with, warn: update.warn, tagType: tagType, description: update.description, when: (new Date()).toISOString() }\n                        );\n                    }\n                }\n            });\n\n            if (changed) {\n                app.setSettingJSON(smartTextConfigSetting, config);\n            }\n\n        });\n    }\n    private saveTag(tag: ISmartTextConfigReplacement) {\n        // reload the settings to be sure nobody changed it inbetween\n        restConnection.getProject(\"setting\").done(function (result: XRGetProject_ProjectInfo_ProjectInfo) {\n            globalMatrix.ItemConfig.addSettings(result);\n\n            var config = globalMatrix.ItemConfig.getSmartText();\n            if (!config || !config.replacements || config.replacements.length === 0) {\n                config = { replacements: [tag] };\n\n            } else {\n                // check if it is an update or new\n                var found = false;\n                $.each(config.replacements, function (optIdx, opt) {\n                    if (opt.what + \"\" === tag.what + \"\") {\n                        config.replacements[optIdx] = tag;\n                        found = true;\n                    }\n                });\n                if (!found) {\n                    config.replacements.push(tag);\n                }\n            }\n            app.setSettingJSON(\"rtf\", config);\n        });\n    }\n\n    private getReplacement(what: string): ISmartTextConfigReplacement|undefined {\n        let config = this.getCurrentConfig();\n        let hit: ISmartTextConfigReplacement;\n        $.each(config.replacements, function (optIdx, opt) {\n            if (opt.what + \"\" === what + \"\") { // make sure both are strings\n                hit = opt;\n            }\n        });\n        return hit;\n    }\n\n}\n","/// <reference types=\"matrixrequirements-type-declarations\" />\n\nimport {ItemConfiguration} from \"./../businesslogic/index\";\nimport {IJcxhr, Tasks} from \"../businesslogic/index\";\nimport {ItemControl} from \"../UI/Components/index\";\nimport {IDropdownParams} from \"../UI/Controls/dropdown\";\nimport {IRichTextParams} from \"../UI/Controls/richText\";\nimport {ml} from \"./../matrixlib\";\nimport {IThemeSelector, ThemeSelector} from \"./../UI/Tools/ThemeSelector\";\nimport {IDropdownGroup, IDropdownOption} from \"../../ProjectSettings\";\nimport {\n    XRGetGroup_AllGroups_GetGroupListAck,\n    XRGetProject_CategoryList_GetProjectStructAck,\n    XRGetProject_ProjectSettingAll_GetSettingAck,\n    XRGetUser_AllUsers_GetUserListAck,\n    XRGroupPermissionType,\n    XRGroupType,\n    XRUserPermissionType\n} from \"../../RestResult\";\nimport {IWidgetPluginsContainer, WidgetPluginsContainer} from \"../../WidgetDashboard/WidgetPluginsContainer\";\nimport {\n    IBlockingProgressUI,\n    IBlockingProgressUITask,\n    ICIColor,\n    IDateTimeUI,\n    IDialogOptions,\n    IDropDownButtonOption,\n    ILT,\n    IProgressUI,\n    ISelectUserOrGroupUI,\n    IToolTipCache,\n    IUIToolsEnum,\n    UIToolsConstants\n} from \"./MatrixLibInterfaces\";\nimport {\n    app,\n    ControlState,\n    globalMatrix,\n    IGenericMap,\n    IItem,\n    IStringNumberMap,\n    matrixApplicationUI,\n    matrixSession,\n    restConnection,\n    setIC\n} from \"../../globals\";\nimport {DateTimeUI} from \"./DateTimeUI\";\n\n// TODO(modules): the export of UIToolsEnum is very strange...merging of a module + class?\nexport { BlockingProgressUI, ProgressUI, SelectUserOrGroupUI, LT };\nexport { UIToolsEnum };\n\nclass UIToolsEnum implements IUIToolsEnum {\n\n    fixC3ForCopy(copied: JQuery) {\n        $(\".c3-legend-background\", copied).remove();\n        $(\"svg path\", copied).css(\"cursor\", \"unset\");\n        $(\"svg text\", copied).css(\"opacity\", \"1\");\n        $(\".c3-legend-item \", copied).css(\"cursor\", \"unset\");\n        $(\".c3-axis path.domain\", copied).attr(\"stroke\", \"black\");\n        $(\".c3-axis .tick line\", copied).attr(\"stroke\", \"black\");\n        $(\".c3-axis path.domain\", copied).attr(\"fill\", \"none\");\n    }\n\n    private tooltip_cache:{[key: string]: IToolTipCache} = {};\n    private lastTooltipRequest:number;\n    private lastTooltipHide:number;\n    private hidden_tooltip_itemId:string; // not yet used\n    private removeTimer:IStringNumberMap = {};\n\n    public widgetPluginsContainer: IWidgetPluginsContainer;\n\n    // date time formatting in UI\n    DateTime: IDateTimeUI;\n\n    // full screen (modal) progress\n    BlockingProgress: IBlockingProgressUI;\n\n    SelectUserOrGroup: ISelectUserOrGroupUI;\n\n    lt: ILT;\n\n    // bottom progress bar\n    Progress: IProgressUI;\n\n    ThemeSelector: IThemeSelector;\n\n    constructor() {\n        this.widgetPluginsContainer = new WidgetPluginsContainer();\n        this.DateTime = new DateTimeUI();\n        this.BlockingProgress = new BlockingProgressUI();\n        this.SelectUserOrGroup = new SelectUserOrGroupUI();\n        this.lt = new LT();\n        this.Progress = new ProgressUI();\n        this.ThemeSelector = new ThemeSelector();\n    }\n\n  // helper to show a drop down / drop up button allowing to click on one of several options\n    createDropDownButton(defaultText: string, options: IDropDownButtonOption[], isUp: boolean, buttonId?: string, disableDefaultButtonClick?: boolean):JQuery {\n        var id = buttonId?('id=\"' + buttonId + '\"'):\"\";\n\n        if (options.length === 1) {\n            var bootLook = \"btn btn-default\";\n            // render as simple button\n            var button = $('<span ' + id + ' type=\"button\" class=\"' +  bootLook + '\">');\n            var btnText = $('<span class=\"ui-button-text\">');\n            btnText.append($('<span>').html(defaultText));\n\n            button.append(btnText).click(function (event) {\n                if (!button.prop('disabled')) {\n                    // do the click and disable button for a while\n                    options[0].click();\n                    button.prop('disabled', true);\n                    button.addClass('disabled');\n                    setTimeout(function () {\n                        button.prop('disabled', false);\n                        button.removeClass('disabled');\n\n                    }, 1000);\n                }\n                if (event.preventDefault)\n                    event.preventDefault();\n                return false;\n            });\n            return $('<div class=\"btn-group\">').append(button);\n        }\n\n        var bootLook = \"btn btn-default dropdown-toggle\";\n\n        var button = $('<span type=\"button\" class=\"' +bootLook + '\" data-toggle=\"dropdown\" aria-expanded=\"false\">');\n\n        var btnText = $('<span class=\"ui-button-text\">');\n        button.append(btnText);\n\n        let ddcaret = $('<span class=\"caret ddmenubtndrop\">');\n        btnText.append($('<span ' +id+ ' >').html(defaultText).click(function (event) {\n            if (disableDefaultButtonClick) {\n                ddcaret.trigger(\"click\");\n            } else  if (!button.prop('disabled')) {\n                // do the click and disable button for a while\n                options[0].click();\n                button.prop('disabled', true);\n                button.addClass('disabled');\n                setTimeout(function () {\n                    button.prop('disabled', false);\n                    button.removeClass('disabled');\n\n                }, 1000);\n            }\n            if (event.preventDefault)\n                event.preventDefault();\n            return false;\n        }));\n        btnText.append(ddcaret);\n\n\n        var ddOptions = $('<ul class=\"dropdown-menu\" role=\"menu\">');\n\n        $.each(options, function (idx, opt) {\n            ddOptions.append($('<li>').append($('<a>').attr('href', 'javascript:void(0)').addClass(opt.class).html(opt.name)).click(function (event) {\n                opt.click();\n                button.closest(\".dropdown\").removeClass(\"open\");\n                if (event.preventDefault)\n                    event.preventDefault();\n                return false;\n            }));\n        });\n\n        return $('<div class=\"btn-group ' + (isUp ? 'dropup' : 'dropdown') + '\">').append(button).append(ddOptions);\n    }\n\n    // get optimal size of a dialog window dependent on available screen\n    getNiceDialogSize (minWidth:number, minHeight:number):{width:number, height:number} {\n        return {\n            width: minWidth < 0 ? Math.abs(minWidth) : Math.max(minWidth, app.itemForm.width() / 2),\n            height: minHeight < 0 ? Math.abs(minHeight) : Math.max(minHeight, app.itemForm.height() / 4)\n        };\n    };\n\n    // show success message\n    // hideAfter =0 or undefined: 2000 ms, -1 do not hide\n    showSuccess (messageTitle:string, hideAfter?:number):void {\n        ml.Logger.log(\"success\", messageTitle);\n        $('#message_success').html(\n                \"<span class='msgHeader'>\" + messageTitle + \"</span>\");\n        this.showSlide('#message_success', hideAfter?(hideAfter<0?0:hideAfter):2000);\n    }\n\n    hideSuccess ():void {\n        this.hideSlide($('#message_success'));\n    }\n    hideError ():void {\n        this.hideSlide($('#message_error'));\n    }\n    // show error message\n    showError(messageTitle:string, messageBody:string, showForMS?:number):void {\n        ml.Logger.log(\"error\", messageTitle + \": \" + messageBody);\n        $('#message_error').html(\n                \"<span class='msgHeader'>\" + messageTitle + \"</span>\" +\n                \"<hr/>\" +\n                \"<p class='msgBody'>\" + messageBody + \"</p>\");\n        var duration = 5000;\n        if (showForMS) {\n            duration = showForMS;\n        }\n        this.showSlide('#message_error', duration);\n    };\n\n    // show acknowledge message\n\n    /**\n     * show acknowledge dialog\n     * @param ackId: a (unique) value > 0 can be used as unique id to have acknowledge boxes which are shown only one\n     * @param messageTitle\n     * @param dlgTitle\n     */\n    showAck (ackId:number, messageTitle:string, dlgTitle?:string):void {\n\n        if (globalMatrix.serverStorage.getItem(\"ackMessage_\" + ackId)) {\n            // user clicked on ack -> on this computer\n            // or it was manually set\n            return;\n        }\n\n        ml.Logger.log(\"ack\", messageTitle);\n        $('#message_ack_title').html(dlgTitle?dlgTitle:\"Acknowledge\");\n\n        $('#message_ack_ok').off(\"click\");\n        $('#message_ack_ok').one(\"click\", function () {\n            if (ackId > 0) {\n                // allow to click away\n                globalMatrix.serverStorage.setItem(\"ackMessage_\" + ackId, (new Date()).toString());\n            }\n        });\n\n        $('#message_ack_content').html(messageTitle);\n        $('#message_ack').modal({backdrop: 'static'});\n    }\n\n    // ask for confirmation\n    showConfirm(confId:number, messageInfo:{title:string, ok:string, nok?:string, third?:string}, confFunction:Function, noConfFunction:Function, thirdFunction?:Function):void {\n        let that = this;\n\n        if (globalMatrix.serverStorage.getItem(\"confMessage_\" + confId)) {\n            // user clicked on conf -> on this computer\n            // or it was manually set\n            return;\n        }\n\n        ml.Logger.log(\"conf\", messageInfo.title);\n\n        $('#message_conf_ok').off(\"click\");\n        $('#message_conf_nok').off(\"click\");\n        $('#message_conf_third').off(\"click\").hide();\n        $('#message_conf').off('hidden.bs.modal');\n\n        $('#message_conf_ok').one(\"click\", function () {\n            if (confFunction) {\n                $('#message_conf').one('hidden.bs.modal', () => {\n                    confFunction();\n                });\n            }\n        });\n        $('#message_conf_nok').one(\"click\", function () {\n            if (noConfFunction) {\n                $('#message_conf').one('hidden.bs.modal', () => {\n                    noConfFunction();\n                });\n            }\n        });\n        $('#message_conf_third').one(\"click\", function () {\n            if (thirdFunction) {\n                $('#message_conf').one('hidden.bs.modal', () => {\n                    thirdFunction();\n                });\n            }\n        });\n        $('#message_conf_content').html(messageInfo.title);\n        $('#message_conf_ok').html(messageInfo.ok ? messageInfo.ok : \"OK\");\n        $('#message_conf_nok').html(messageInfo.nok ? messageInfo.nok : \"Cancel\");\n        if (messageInfo.third) {\n            $('#message_conf_third').html(messageInfo.third);\n            $('#message_conf_third').show();\n        }\n        $('#message_conf').modal({backdrop: 'static'});\n        $(\"#message_conf_content\").closest(\".modal\").css(\"z-index\",\"20000\");\n    }\n\n    confirmSpinningWait( message:string ) {\n        $('#message_conf_content').html(\"\").append(this.getSpinningWait(message));\n        this.setEnabled( $('#message_conf_ok'), false);\n        this.setEnabled( $('#message_conf_nok'), false);\n        $('#message_conf').modal({backdrop: 'static'});\n    }\n    closeConfirmSpinningWait() {\n        this.setEnabled( $('#message_conf_ok'), true);\n        this.setEnabled( $('#message_conf_nok'), true);\n        $('#message_conf').modal('hide')\n    }\n    // show item as tool tip\n    showTooltip(itemId:string, target:JQuery, event:Event, crossProject?:string):void {\n        let that = this;\n        clearTimeout(this.lastTooltipHide);\n        clearTimeout(this.lastTooltipRequest);\n        this.lastTooltipHide = null;\n        this.lastTooltipRequest = window.setTimeout(function () {\n            that.showTooltip_Delayed(itemId, target, crossProject);\n        }, globalMatrix.globalShiftDown ? 10 : 500);\n    }\n\n    showTaskAsTooltip(id:string, title:string, url:string, htmlContent:string, target:JQuery):void {\n        let that = this;\n        clearTimeout(this.lastTooltipHide);\n        clearTimeout(this.lastTooltipRequest);\n        this.lastTooltipHide = null;\n        this.lastTooltipRequest = window.setTimeout(function () {\n            that.showTaskAsTooltip_Delayed(id,title,url ,htmlContent, target);\n        }, globalMatrix.globalShiftDown ? 10 : 500);\n    }\n\n\n\n    // hide item tool tip\n    hideTooltip(now?:boolean):void {\n        let that = this;\n        clearTimeout(this.lastTooltipHide);\n        clearTimeout(this.lastTooltipRequest);\n        this.lastTooltipHide = null;\n        this.lastTooltipRequest = null;\n        if (now) {\n            var height = Math.max(300, this.getSlideHeight($(\"#tooltip_panel\"), true));\n            $(\"#tooltip_panel\").css('margin-top', '-' + height + 'px');\n        } else {\n            this.lastTooltipHide = window.setTimeout(function () {\n                that.hideCurrentToolTip();\n            }, 2000);\n        }\n    }\n\n    // refresh tool tip (does not yet work...)\n    updateTooltip():void {\n        if (this.hidden_tooltip_itemId) {\n            this.showTooltip_Delayed(this.hidden_tooltip_itemId, $(\"#tooltip_panel\"));\n        }\n    }\n\n    // show message that user name or password has spaces\n    spaceMessage(userHasSpaces:boolean, passwordHasSpaces:boolean):string {\n        if (userHasSpaces && passwordHasSpaces) {\n            return \"user name and password cannot have spaces\";\n        } else if (userHasSpaces) {\n            return \"user name cannot have spaces\";\n        } else if (passwordHasSpaces) {\n            return \"password cannot have spaces\";\n        } else {\n            return \"\";\n        }\n    };\n\n    // return span with spinning wait icon and text\n    getSpinningWait(message?:string):JQuery {\n        var span = $(\"<span class='spinningWait hideCopy'>\");\n        span.append($('<span class=\"fal fa-sync-alt refresh-animate\"></span>\"'))\n            .append($('<span class=\"waitscreenmessage\">'+(message?message:\"please wait....\") + '</span>\"'));\n        return span;\n    };\n\n    setEnabled(button:JQuery, enabled:boolean) {\n        if (enabled) {\n            button.prop(\"disabled\", false).removeClass(\"ui-state-disabled\");\n        } else {\n            button.prop(\"disabled\", true).addClass(\"ui-state-disabled\");\n        }\n    }\n\n    getDisplayError( jqxhr: IJcxhr, textStatus:string, error:string ) {\n        if ( jqxhr && jqxhr.responseJSON && jqxhr.responseJSON.displayError ) {\n            return jqxhr.responseJSON.displayError;\n        }\n        if ( textStatus == \"parsererror\" ) return \"unknown error\";\n        return \"Status: \" + textStatus + \"<br/>Error was:\" + error;\n\n    }\n\n    showDialog ( dlg:JQuery, title:string, content:JQuery, minMaxWidth:number, minMaxHeight:number,\n        buttons:any[], // DialogButtonOptions\n        scrolling:UIToolsConstants.Scroll,\n        autoResize?:boolean,\n        maximizeButton?:boolean,\n        close?:Function,\n        open?:Function,\n        resize?:Function,\n        noCloseOnEscape?:boolean\n    ) {\n\n        let that = this;\n        let isMax = false;\n\n        // get best size (depending on available screen size, and given max values)\n        let niceSize = this.getNiceDialogSize(minMaxWidth, minMaxHeight);\n        let nicePos = { top:0,left:0};\n\n        // content\n        if (content) {\n            dlg.html(\"\");\n            dlg.append(content);\n        }\n\n        dlg.removeClass(\"dlg-auto-scroll\");\n        dlg.removeClass(\"dlg-no-scroll\");\n        dlg.removeClass(\"dlg-v-scroll\");\n\n        switch (scrolling) {\n            case  UIToolsConstants.Scroll.Vertical:\n                dlg.addClass(\"dlg-v-scroll\");\n                break;\n            case UIToolsConstants.Scroll.None:\n                dlg.addClass(\"dlg-no-scroll\");\n                break;\n            case UIToolsConstants.Scroll.Auto:\n                dlg.addClass(\"dlg-scroll\");\n                break;\n        }\n\n        dlg.dialog({\n            autoOpen: true,\n            title: title,\n            height: niceSize.height,\n            width: niceSize.width,\n            modal: true,\n            closeOnEscape: !noCloseOnEscape,\n            close: function() {\n                // prepare for next opening...\n                $(\".maxbutton\").remove();\n                dlg.removeClass(\"dlg-auto-scroll\");\n                dlg.removeClass(\"dlg-no-scroll\");\n                dlg.removeClass(\"dlg-v-scroll\");\n\n                that.popDialog(dlg);\n                if (close) close();\n            },\n            open: function () {\n                if (maximizeButton) {\n                    let maxButton = $('<button title=\"Maximize\" class=\"maxbutton ui-button ui-corner-all ui-widget ui-button-icon-only ui-dialog-titlebar-max\" type=\"button\"><span class=\"ui-icon ui-icon-arrow-4-diag\">maximize</span>Maximize</button>');\n                    let ui = $(dlg).closest(\".ui-dialog\");\n                    let close = $(\".ui-dialog-titlebar-close\", ui);\n                    let content = $(\".ui-dialog-content\", ui);\n                    close.parent().prepend( maxButton );\n                    maxButton.click( function() {\n                        if (isMax) {\n                            isMax = false;\n\n                            ui.width( niceSize.width );\n                            ui.height( niceSize.height );\n                            ui.css( \"left\",nicePos.left + \"px\" );\n                            ui.css( \"top\", nicePos.top + \"px\" );\n                        } else {\n                            isMax = true;\n\n                            nicePos = ui.position();\n                            niceSize = { width:ui.width(), height:ui.height() };\n\n                            ui.width( $( window ).width() - 20 );\n                            ui.height( $( window ).height() - 20 );\n                            ui.css( \"left\",\"10px\" );\n                            ui.css( \"top\",\"10px\" );\n                        }\n                        $(content).width( ui.width() - 28);\n                        $(content).height( ui.height() - 112);\n\n                        if ( autoResize ) dlg.resizeDlgContent([content]);\n                        if ( resize ) resize();\n\n                    });\n                }\n                if (open) open();\n                that.pushDialog(dlg); },\n            resizeStop: function (event, ui) {\n                if ( autoResize) dlg.resizeDlgContent([content]);\n                if (resize) resize();\n            },\n            buttons: buttons\n        });\n        if (autoResize) {\n            dlg.resizeDlgContent([content], false);\n        }\n    }\n\n    showDialogDes( {\n        // optional parameters with defaults\n        maximizeButton=false,\n        noXButton = false,\n        autoResize = false,\n        onClose = null,\n        onOpen = null,\n        onResize = null,\n        noCloseOnEscape = false,\n        minMaxWidth = $(document).width() * 0.9,\n        minMaxHeight = app.itemForm.height() * 0.9,\n        scrolling=UIToolsConstants.Scroll.None,\n        content = null,\n         // required parameters\n        container,\n        title,\n        buttons\n        }:IDialogOptions\n    ) {\n\n        let that = this;\n        let isMax = false;\n\n        // get best size (depending on available screen size, and given max values)\n        let niceSize = this.getNiceDialogSize(minMaxWidth, minMaxHeight);\n        let nicePos = { top:0,left:0};\n\n        // content\n        if (content) {\n            container.html(\"\");\n            container.append(content);\n        }\n\n        container.removeClass(\"dlg-auto-scroll\");\n        container.removeClass(\"dlg-no-scroll\");\n        container.removeClass(\"dlg-v-scroll\");\n\n        switch (scrolling) {\n            case  UIToolsConstants.Scroll.Vertical:\n                container.addClass(\"dlg-v-scroll\");\n                break;\n            case UIToolsConstants.Scroll.None:\n                container.addClass(\"dlg-no-scroll\");\n                break;\n            case UIToolsConstants.Scroll.Auto:\n                container.addClass(\"dlg-scroll\");\n                break;\n        }\n\n        container.dialog({\n            autoOpen: true,\n            title: title,\n            height: niceSize.height,\n            width: niceSize.width,\n            modal: true,\n            closeOnEscape: !noCloseOnEscape,\n            close: function() {\n                // prepare for next opening...\n                $(\".maxbutton\").remove();\n                container.removeClass(\"dlg-auto-scroll\");\n                container.removeClass(\"dlg-no-scroll\");\n                container.removeClass(\"dlg-v-scroll\");\n\n                that.popDialog(container);\n                if (onClose) onClose();\n            },\n            open: function () {\n                let ui = $(container).closest(\".ui-dialog\");\n                let close = $(\".ui-dialog-titlebar-close\", ui);\n\n                if (maximizeButton) {\n                    let maxCss= noXButton?\"maxNoX\":\"\";\n                    let maxButton = $('<button title=\"Maximize\" class=\"'+ maxCss +' maxbutton ui-button ui-corner-all ui-widget ui-button-icon-only ui-dialog-titlebar-max\" type=\"button\"><span class=\"ui-icon ui-icon-arrow-4-diag\">maximize</span>Maximize</button>');\n\n                    let content = $(\".ui-dialog-content\", ui);\n                    close.parent().prepend( maxButton );\n                    maxButton.click( function() {\n                        if (isMax) {\n                            isMax = false;\n\n                            ui.width( niceSize.width );\n                            ui.height( niceSize.height );\n                            ui.css( \"left\",nicePos.left + \"px\" );\n                            ui.css( \"top\", nicePos.top + \"px\" );\n\n                        } else {\n                            isMax = true;\n\n                            nicePos = ui.position();\n                            niceSize = { width:ui.width(), height:ui.height() };\n\n                            ui.width( $( window ).width() - 20 );\n                            ui.height( $( window ).height() - 20 );\n                            ui.css( \"left\",\"10px\" );\n                            ui.css( \"top\",\"10px\" );\n\n                        }\n                        $(content).width( ui.width() - 28);\n                        $(content).height( ui.height() - 112);\n\n                        if ( autoResize ) container.resizeDlgContent([content]);\n                        if ( onResize ) onResize();\n\n                    });\n                }\n\n                if (noXButton) {\n                    close.remove();\n                }\n\n                if (onOpen) {\n                    onOpen();\n                }\n\n                that.pushDialog(container); },\n            resizeStop: function (event, ui) {\n                if (autoResize) {\n                    container.resizeDlgContent([content]);\n                }\n                if (onResize) {\n                    onResize();\n                }\n            },\n            buttons: buttons\n        });\n        if (autoResize) {\n            container.resizeDlgContent([content], false);\n        }\n    }\n\n\n    pushDialog(thisDialog:JQuery) {\n        let depth = 0;\n        for ( var idx=0;idx<4;idx++) {\n            if ( this.countVisibleDialogs(idx) ) {\n                depth = idx+1;\n            }\n        }\n        if (depth===0) {\n            return;\n        }\n        let dlg = thisDialog.closest(\".ui-dialog\");\n        dlg.removeClass(\"ui-front\");\n        dlg.addClass(\"ui-front\"+depth);\n        $( \".ui-widget-overlay,.ui-widget-overlay1,.ui-widget-overlay2,.ui-widget-overlay3,.ui-widget-overlay4\").each( function (idx, over) {\n            $(over).removeClass( \"ui-widget-overlay\" );\n            for ( var idx=1;idx<depth;idx++) {\n                $(over).removeClass( \"ui-widget-overlay\"+idx );\n            }\n            $(over).addClass( \"ui-widget-overlay\" + depth );\n        });\n    }\n    popDialog(thisDialog:JQuery) {\n        let dlg = thisDialog.closest(\".ui-dialog\");\n        // normalize stack for next time it's displayed\n        dlg.addClass(\"ui-front\");\n        for ( var idx=0;idx<4;idx++) {\n             dlg.removeClass(\"ui-front\"+(idx+1));\n        }\n\n        $( \".ui-widget-overlay1\").each( function (idx, over) {\n            $(over).removeClass( \"ui-widget-overlay1\" );\n            $(over).addClass( \"ui-widget-overlay\" );\n        });\n        $( \".ui-widget-overlay2\").each( function (idx, over) {\n            $(over).removeClass( \"ui-widget-overlay2\" );\n            $(over).addClass( \"ui-widget-overlay1\" );\n        });\n        $( \".ui-widget-overlay3\").each( function (idx, over) {\n            $(over).removeClass( \"ui-widget-overlay3\" );\n            $(over).addClass( \"ui-widget-overlay2\" );\n        });\n        $( \".ui-widget-overlay4\").each( function (idx, over) {\n            $(over).removeClass( \"ui-widget-overlay4\" );\n            $(over).addClass( \"ui-widget-overlay3\" );\n        });\n    }\n\n\n\n    public serverHtmlCleanupBlob(content : JQuery):JQueryDeferred<string>\n    {\n        let htmlContent = content.html();\n        let def = $.Deferred<string>();\n\n        restConnection.postProjectJson(\"htmlCleanupBlob\", { htmlToClean: htmlContent })\n            .done((result:any)=>{\n                def.resolve(result.cleanedHtml);\n            });\n\n        return def;\n    }\n\n\n    /*  anchor: where to add a button\n        tooltip: to inform user about what is copied\n        content: from where to copy\n        catchKey: ??\n        onProcessCopy: for post processing of copied text\n        btnText: // to add some text to copy button\n    */\n\n    copyBuffer( anchor:JQuery, tooltip:string, content:JQuery, catchKey?:JQuery, onProcessCopy?:Function, btnText?:string,beforeCopy?:Function, afterCopy?:Function) {\n        let that = this;\n        $('<i class=\"fal fa-copy hideCopy\" aria-hidden=\"true\" style=\"padding:0 5px 0 12px;cursor:pointer\" data-original-title=\"' + tooltip +'\" ></i><span>'+ (btnText?btnText:\"\") +'</span> ').appendTo(anchor).click( function() {\n\n            if (beforeCopy !=undefined)\n            {\n                beforeCopy();\n            }\n            that.doCopy( content, onProcessCopy);\n            if(afterCopy !=undefined)\n            {\n                afterCopy();\n            }\n\n\n        }).tooltip({container:\"body\",placement:\"auto\"});\n\n        /*\n        if (catchKey) {\n            let ctrlDown = false,\n            ctrlKey = 17,\n            cmdKey = 91,\n            vKey = 86,\n            cKey = 67;\n\n            $(catchKey).keydown(function(e) {\n                if (e.keyCode == ctrlKey || e.keyCode == cmdKey) {\n                    ctrlDown = true;\n                }\n                if (ctrlDown &&  e.keyCode == cKey) {\n                    that.doCopy( content, onProcessCopy );\n                    return false;\n                }\n                return true;\n            }).keyup(function(e) {\n                if (e.keyCode == ctrlKey || e.keyCode == cmdKey) {\n                    ctrlDown = false;\n                }\n            });\n        }*/\n\n    }\n\n    toolIcons = [\"ad\", \"address-book\", \"address-card\", \"adjust\", \"air-freshener\", \"align-center\", \"align-justify\", \"align-left\", \"align-right\", \"allergies\", \"ambulance\", \"american-sign-language-interpreting\", \"anchor\", \"angle-double-down\", \"angle-double-left\", \"angle-double-right\", \"angle-double-up\", \"angle-down\", \"angle-left\", \"angle-right\", \"angle-up\", \"angry\", \"ankh\", \"apple-alt\", \"archive\", \"archway\", \"arrow-alt-circle-down\", \"arrow-alt-circle-left\", \"arrow-alt-circle-right\", \"arrow-alt-circle-up\", \"arrow-circle-down\", \"arrow-circle-left\", \"arrow-circle-right\", \"arrow-circle-up\", \"arrow-down\", \"arrow-left\", \"arrow-right\", \"arrow-up\", \"arrows-alt\", \"arrows-alt-h\", \"arrows-alt-v\", \"assistive-listening-systems\", \"asterisk\", \"at\", \"atlas\", \"atom\", \"audio-description\", \"award\", \"baby\", \"baby-carriage\", \"backspace\", \"backward\", \"bacon\", \"balance-scale\", \"balance-scale-left\", \"balance-scale-right\", \"ban\", \"band-aid\", \"barcode\", \"bars\", \"baseball-ball\", \"basketball-ball\", \"bath\", \"battery-empty\", \"battery-full\", \"battery-half\", \"battery-quarter\", \"battery-three-quarters\", \"bed\", \"beer\", \"bell\", \"bell-slash\", \"bezier-curve\", \"bible\", \"bicycle\", \"biking\", \"binoculars\", \"biohazard\", \"birthday-cake\", \"blender\", \"blender-phone\", \"blind\", \"blog\", \"bold\", \"bolt\", \"bomb\", \"bone\", \"bong\", \"book\", \"book-dead\", \"book-medical\", \"book-open\", \"book-reader\", \"bookmark\", \"border-all\", \"border-none\", \"border-style\", \"bowling-ball\", \"box\", \"box-open\", \"boxes\", \"braille\", \"brain\", \"bread-slice\", \"briefcase\", \"briefcase-medical\", \"broadcast-tower\", \"broom\", \"brush\", \"bug\", \"building\", \"bullhorn\", \"bullseye\", \"burn\", \"bus\", \"bus-alt\", \"business-time\", \"calculator\", \"calendar\", \"calendar-alt\", \"calendar-check\", \"calendar-day\", \"calendar-minus\", \"calendar-plus\", \"calendar-times\", \"calendar-week\", \"camera\", \"camera-retro\", \"campground\", \"candy-cane\", \"cannabis\", \"capsules\", \"car\", \"car-alt\", \"car-battery\", \"car-crash\", \"car-side\", \"caret-down\", \"caret-left\", \"caret-right\", \"caret-square-down\", \"caret-square-left\", \"caret-square-right\", \"caret-square-up\", \"caret-up\", \"carrot\", \"cart-arrow-down\", \"cart-plus\", \"cash-register\", \"cat\", \"certificate\", \"chair\", \"chalkboard\", \"chalkboard-teacher\", \"charging-station\", \"chart-area\", \"chart-bar\", \"chart-line\", \"chart-pie\", \"check\", \"check-circle\", \"check-double\", \"check-square\", \"cheese\", \"chess\", \"chess-bishop\", \"chess-board\", \"chess-king\", \"chess-knight\", \"chess-pawn\", \"chess-queen\", \"chess-rook\", \"chevron-circle-down\", \"chevron-circle-left\", \"chevron-circle-right\", \"chevron-circle-up\", \"chevron-down\", \"chevron-left\", \"chevron-right\", \"chevron-up\", \"child\", \"church\", \"circle\", \"circle-notch\", \"city\", \"clinic-medical\", \"clipboard\", \"clipboard-check\", \"clipboard-list\", \"clock\", \"clone\", \"closed-captioning\", \"cloud\", \"cloud-download-alt\", \"cloud-meatball\", \"cloud-moon\", \"cloud-moon-rain\", \"cloud-rain\", \"cloud-showers-heavy\", \"cloud-sun\", \"cloud-sun-rain\", \"cloud-upload-alt\", \"cocktail\", \"code\", \"code-branch\", \"coffee\", \"cog\", \"cogs\", \"coins\", \"columns\", \"comment\", \"comment-alt\", \"comment-dollar\", \"comment-dots\", \"comment-medical\", \"comment-slash\", \"comments\", \"comments-dollar\", \"compact-disc\", \"compass\", \"compress\", \"compress-arrows-alt\", \"concierge-bell\", \"cookie\", \"cookie-bite\", \"copy\", \"copyright\", \"couch\", \"credit-card\", \"crop\", \"crop-alt\", \"cross\", \"crosshairs\", \"crow\", \"crown\", \"crutch\", \"cube\", \"cubes\", \"cut\", \"database\", \"deaf\", \"democrat\", \"desktop\", \"dharmachakra\", \"diagnoses\", \"dice\", \"dice-d20\", \"dice-d6\", \"dice-five\", \"dice-four\", \"dice-one\", \"dice-six\", \"dice-three\", \"dice-two\", \"digital-tachograph\", \"directions\", \"divide\", \"dizzy\", \"dna\", \"dog\", \"dollar-sign\", \"dolly\", \"dolly-flatbed\", \"donate\", \"door-closed\", \"door-open\", \"dot-circle\", \"dove\", \"download\", \"drafting-compass\", \"dragon\", \"draw-polygon\", \"drum\", \"drum-steelpan\", \"drumstick-bite\", \"dumbbell\", \"dumpster\", \"dumpster-fire\", \"dungeon\", \"edit\", \"egg\", \"eject\", \"ellipsis-h\", \"ellipsis-v\", \"envelope\", \"envelope-open\", \"envelope-open-text\", \"envelope-square\", \"equals\", \"eraser\", \"ethernet\", \"euro-sign\", \"exchange-alt\", \"exclamation\", \"exclamation-circle\", \"exclamation-triangle\", \"expand\", \"expand-arrows-alt\", \"external-link-alt\", \"external-link-square-alt\", \"eye\", \"eye-dropper\", \"eye-slash\", \"fan\", \"fast-backward\", \"fast-forward\", \"fax\", \"feather\", \"feather-alt\", \"female\", \"fighter-jet\", \"file\", \"file-alt\", \"file-archive\", \"file-audio\", \"file-code\", \"file-contract\", \"file-csv\", \"file-download\", \"file-excel\", \"file-\", \"file-image\", \"file-import\", \"file-invoice\", \"file-invoice-dollar\", \"file-medical\", \"file-medical-alt\", \"file-pdf\", \"file-powerpoint\", \"file-prescription\", \"file-signature\", \"file-upload\", \"file-video\", \"file-word\", \"fill\", \"fill-drip\", \"film\", \"filter\", \"fingerprint\", \"fire\", \"fire-alt\", \"fire-extinguisher\", \"first-aid\", \"fish\", \"fist-raised\", \"flag\", \"flag-checkered\", \"flag-usa\", \"flask\", \"flushed\", \"folder\", \"folder-minus\", \"folder-open\", \"folder-plus\", \"font\", \"football-ball\", \"forward\", \"frog\", \"frown\", \"frown-open\", \"funnel-dollar\", \"futbol\", \"gamepad\", \"gas-pump\", \"gavel\", \"gem\", \"genderless\", \"ghost\", \"gift\", \"gifts\", \"glass-cheers\", \"glass-martini\", \"glass-martini-alt\", \"glass-whiskey\", \"glasses\", \"globe\", \"globe-africa\", \"globe-americas\", \"globe-asia\", \"globe-europe\", \"golf-ball\", \"gopuram\", \"graduation-cap\", \"greater-than\", \"greater-than-equal\", \"grimace\", \"grin\", \"grin-alt\", \"grin-beam\", \"grin-beam-sweat\", \"grin-hearts\", \"grin-squint\", \"grin-squint-tears\", \"grin-stars\", \"grin-tears\", \"grin-tongue\", \"grin-tongue-squint\", \"grin-tongue-wink\", \"grin-wink\", \"grip-horizontal\", \"grip-lines\", \"grip-lines-vertical\", \"grip-vertical\", \"guitar\", \"h-square\", \"hamburger\", \"hammer\", \"hamsa\", \"hand-holding\", \"hand-holding-heart\", \"hand-holding-usd\", \"hand-lizard\", \"hand-middle-finger\", \"hand-paper\", \"hand-peace\", \"hand-point-down\", \"hand-point-left\", \"hand-point-right\", \"hand-point-up\", \"hand-pointer\", \"hand-rock\", \"hand-scissors\", \"hand-spock\", \"hands\", \"hands-helping\", \"handshake\", \"hanukiah\", \"hard-hat\", \"hashtag\", \"hat-cowboy\", \"hat-cowboy-side\", \"hat-wizard\", \"haykal\", \"hdd\", \"heading\", \"headphones\", \"headphones-alt\", \"headset\", \"heart\", \"heart-broken\", \"heartbeat\", \"helicopter\", \"highlighter\", \"hiking\", \"hippo\", \"history\", \"hockey-puck\", \"holly-berry\", \"home\", \"horse\", \"horse-head\", \"hospital\", \"hospital-alt\", \"hospital-symbol\", \"hot-tub\", \"hotdog\", \"hotel\", \"hourglass\", \"hourglass-end\", \"hourglass-half\", \"hourglass-start\", \"house-damage\", \"hryvnia\", \"i-cursor\", \"ice-cream\", \"icicles\", \"icons\", \"id-badge\", \"id-card\", \"id-card-alt\", \"igloo\", \"image\", \"images\", \"inbox\", \"indent\", \"industry\", \"infinity\", \"info\", \"info-circle\", \"italic\", \"jedi\", \"joint\", \"journal-whills\", \"kaaba\", \"key\", \"keyboard\", \"khanda\", \"kiss\", \"kiss-beam\", \"kiss-wink-heart\", \"kiwi-bird\", \"landmark\", \"language\", \"laptop\", \"laptop-code\", \"laptop-medical\", \"laugh\", \"laugh-beam\", \"laugh-squint\", \"laugh-wink\", \"layer-group\", \"leaf\", \"lemon\", \"less-than\", \"less-than-equal\", \"level-down-alt\", \"level-up-alt\", \"life-ring\", \"lightbulb\", \"link\", \"lira-sign\", \"list\", \"list-alt\", \"list-ol\", \"list-ul\", \"location-arrow\", \"lock\", \"lock-open\", \"long-arrow-alt-down\", \"long-arrow-alt-left\", \"long-arrow-alt-right\", \"long-arrow-alt-up\", \"low-vision\", \"luggage-cart\", \"magic\", \"magnet\", \"mail-bulk\", \"male\", \"map\", \"map-marked\", \"map-marked-alt\", \"map-marker\", \"map-marker-alt\", \"map-pin\", \"map-signs\", \"marker\", \"mars\", \"mars-double\", \"mars-stroke\", \"mars-stroke-h\", \"mars-stroke-v\", \"mask\", \"medal\", \"medkit\", \"meh\", \"meh-blank\", \"meh-rolling-eyes\", \"memory\", \"menorah\", \"mercury\", \"meteor\", \"microchip\", \"microphone\", \"microphone-alt\", \"microphone-alt-slash\", \"microphone-slash\", \"microscope\", \"minus\", \"minus-circle\", \"minus-square\", \"mitten\", \"mobile\", \"mobile-alt\", \"money-bill\", \"money-bill-alt\", \"money-bill-wave\", \"money-bill-wave-alt\", \"money-check\", \"money-check-alt\", \"monument\", \"moon\", \"mortar-pestle\", \"mosque\", \"motorcycle\", \"mountain\", \"mouse\", \"mouse-pointer\", \"mug-hot\", \"music\", \"network-wired\", \"neuter\", \"newspaper\", \"not-equal\", \"notes-medical\", \"object-group\", \"object-ungroup\", \"oil-can\", \"om\", \"otter\", \"outdent\", \"pager\", \"paint-brush\", \"paint-roller\", \"palette\", \"pallet\", \"paper-plane\", \"paperclip\", \"parachute-box\", \"paragraph\", \"parking\", \"passport\", \"pastafarianism\", \"paste\", \"pause\", \"pause-circle\", \"paw\", \"peace\", \"pen\", \"pen-alt\", \"pen-fancy\", \"pen-nib\", \"pen-square\", \"pencil-alt\", \"pencil-ruler\", \"people-carry\", \"pepper-hot\", \"percent\", \"percentage\", \"person-booth\", \"phone\", \"phone-alt\", \"phone-slash\", \"phone-square\", \"phone-square-alt\", \"phone-volume\", \"photo-video\", \"piggy-bank\", \"pills\", \"pizza-slice\", \"place-of-worship\", \"plane\", \"plane-arrival\", \"plane-departure\", \"play\", \"play-circle\", \"plug\", \"plus\", \"plus-circle\", \"plus-square\", \"podcast\", \"poll\", \"poll-h\", \"poo\", \"poo-storm\", \"poop\", \"portrait\", \"pound-sign\", \"power-off\", \"pray\", \"praying-hands\", \"prescription\", \"prescription-bottle\", \"prescription-bottle-alt\", \"print\", \"procedures\", \"project-diagram\", \"puzzle-piece\", \"qrcode\", \"question\", \"question-circle\", \"quidditch\", \"quote-left\", \"quote-right\", \"quran\", \"radiation\", \"radiation-alt\", \"rainbow\", \"random\", \"receipt\", \"record-vinyl\", \"recycle\", \"redo\", \"redo-alt\", \"registered\", \"remove-format\", \"reply\", \"reply-all\", \"republican\", \"restroom\", \"retweet\", \"ribbon\", \"ring\", \"road\", \"robot\", \"rocket\", \"route\", \"rss\", \"rss-square\", \"ruble-sign\", \"ruler\", \"ruler-combined\", \"ruler-horizontal\", \"ruler-vertical\", \"running\", \"rupee-sign\", \"sad-cry\", \"sad-tear\", \"satellite\", \"satellite-dish\", \"save\", \"school\", \"screwdriver\", \"scroll\", \"sd-card\", \"search\", \"search-dollar\", \"search-location\", \"search-minus\", \"search-plus\", \"seedling\", \"server\", \"shapes\", \"share\", \"share-alt\", \"share-alt-square\", \"share-square\", \"shekel-sign\", \"shield-alt\", \"ship\", \"shipping-fast\", \"shoe-prints\", \"shopping-bag\", \"shopping-basket\", \"shopping-cart\", \"shower\", \"shuttle-van\", \"sign\", \"sign-in-alt\", \"sign-language\", \"sign-out-alt\", \"signal\", \"signature\", \"sim-card\", \"sitemap\", \"skating\", \"skiing\", \"skiing-nordic\", \"skull\", \"skull-crossbones\", \"slash\", \"sleigh\", \"sliders-h\", \"smile\", \"smile-beam\", \"smile-wink\", \"smog\", \"smoking\", \"smoking-ban\", \"sms\", \"snowboarding\", \"snowflake\", \"snowman\", \"snowplow\", \"socks\", \"solar-panel\", \"sort\", \"sort-alpha-down\", \"sort-alpha-down-alt\", \"sort-alpha-up\", \"sort-alpha-up-alt\", \"sort-amount-down\", \"sort-amount-down-alt\", \"sort-amount-up\", \"sort-amount-up-alt\", \"sort-down\", \"sort-numeric-down\", \"sort-numeric-down-alt\", \"sort-numeric-up\", \"sort-numeric-up-alt\", \"sort-up\", \"spa\", \"space-shuttle\", \"spell-check\", \"spider\", \"spinner\", \"splotch\", \"spray-can\", \"square\", \"square-full\", \"square-root-alt\", \"stamp\", \"star\", \"star-and-crescent\", \"star-half\", \"star-half-alt\", \"star-of-david\", \"star-of-life\", \"step-backward\", \"step-forward\", \"stethoscope\", \"sticky-note\", \"stop\", \"stop-circle\", \"stopwatch\", \"store\", \"store-alt\", \"stream\", \"street-view\", \"strikethrough\", \"stroopwafel\", \"subscript\", \"subway\", \"suitcase\", \"suitcase-rolling\", \"sun\", \"superscript\", \"surprise\", \"swatchbook\", \"swimmer\", \"swimming-pool\", \"synagogue\", \"sync\", \"sync-alt\", \"syringe\", \"table\", \"table-tennis\", \"tablet\", \"tablet-alt\", \"tablets\", \"tachometer-alt\", \"tag\", \"tags\", \"tape\", \"tasks\", \"taxi\", \"teeth\", \"teeth-open\", \"temperature-high\", \"temperature-low\", \"tenge\", \"terminal\", \"text-height\", \"text-width\", \"th\", \"th-large\", \"th-list\", \"theater-masks\", \"thermometer\", \"thermometer-empty\", \"thermometer-full\", \"thermometer-half\", \"thermometer-quarter\", \"thermometer-three-quarters\", \"thumbs-down\", \"thumbs-up\", \"thumbtack\", \"ticket-alt\", \"times\", \"times-circle\", \"tint\", \"tint-slash\", \"tired\", \"toggle-off\", \"toggle-on\", \"toilet\", \"toilet-paper\", \"toolbox\", \"tools\", \"tooth\", \"torah\", \"torii-gate\", \"tractor\", \"trademark\", \"traffic-light\", \"train\", \"tram\", \"transgender\", \"transgender-alt\", \"trash\", \"trash-alt\", \"trash-restore\", \"trash-restore-alt\", \"tree\", \"trophy\", \"truck\", \"truck-loading\", \"truck-monster\", \"truck-moving\", \"truck-pickup\", \"tshirt\", \"tty\", \"tv\", \"umbrella\", \"umbrella-beach\", \"underline\", \"undo\", \"undo-alt\", \"universal-access\", \"university\", \"unlink\", \"unlock\", \"unlock-alt\", \"upload\", \"user\", \"user-alt\", \"user-alt-slash\", \"user-astronaut\", \"user-check\", \"user-circle\", \"user-clock\", \"user-cog\", \"user-edit\", \"user-friends\", \"user-graduate\", \"user-injured\", \"user-lock\", \"user-md\", \"user-minus\", \"user-ninja\", \"user-nurse\", \"user-plus\", \"user-secret\", \"user-shield\", \"user-slash\", \"user-tag\", \"user-tie\", \"user-times\", \"users\", \"users-cog\", \"utensil-spoon\", \"utensils\", \"vector-square\", \"venus\", \"venus-double\", \"venus-mars\", \"vial\", \"vials\", \"video\", \"video-slash\", \"vihara\", \"voicemail\", \"volleyball-ball\", \"volume-down\", \"volume-mute\", \"volume-off\", \"volume-up\", \"vote-yea\", \"vr-cardboard\", \"walking\", \"wallet\", \"warehouse\", \"water\", \"wave-square\", \"weight\", \"weight-hanging\", \"wheelchair\", \"wifi\", \"wind\", \"window-close\", \"window-maximize\", \"window-minimize\", \"window-restore\", \"wine-bottle\", \"wine-glass\", \"wine-glass-alt\", \"won-sign\", \"wrench\", \"x-ray\", \"yen-sign\", \"yin-yang\"];\n    getIconOptions() {\n        return this.toolIcons.map( function( ti ) { return {id:\"fal fa-\"+ti,label:\"fal fa-\"+ti} });\n    }\n\n    //private colorScheme:string[] =  [\"#1abc9c\", \"#2ecc71\", \"#3498db\", \"#9b59b6\", \"#34495e\", \"#16a085\", \"#27ae60\", \"#2980b9\", \"#8e44ad\", \"#2c3e50\", \"#f1c40f\", \"#e67e22\", \"#e74c3c\", \"#95a5a6\", \"#f39c12\", \"#d35400\", \"#c0392b\", \"#bdc3c7\", \"#7f8c8d\"];\n    private colorScheme:ICIColor[] = [\n        UIToolsConstants.CIColors.Black,\n        UIToolsConstants.CIColors.BlueDoger,\n        UIToolsConstants.CIColors.BlueEastBay,\n        UIToolsConstants.CIColors.BlueLagoon,\n        UIToolsConstants.CIColors.BlueZiggurat,\n        UIToolsConstants.CIColors.BrownCoffeeRoyal,\n        UIToolsConstants.CIColors.BrownDiSerria,\n        UIToolsConstants.CIColors.BrownTiaMaria,\n        UIToolsConstants.CIColors.GreenSushi,\n        UIToolsConstants.CIColors.GreenYellow,\n        UIToolsConstants.CIColors.GreyDark,\n        UIToolsConstants.CIColors.OrangeYellow,\n        UIToolsConstants.CIColors.PinkHot,\n        UIToolsConstants.CIColors.RedPersimmon,\n        UIToolsConstants.CIColors.VioletElectric,\n        UIToolsConstants.CIColors.VioletMauve,\n        UIToolsConstants.CIColors.YellowBrightSun];\n\n    public calculateColorFrom(input:string):ICIColor\n    {\n        let colorIndex = 0;\n        for(var i = 0 ; i< input.length ; i++)\n        {\n            colorIndex+= input.charCodeAt(i);\n        }\n        return this.colorScheme[colorIndex%this.colorScheme.length];\n    }\n\n    public getAvatar (info:string, size:number ):JQuery\n    {\n        let avatarDiv = $(\"<div class='avatar noselect' title='\"+info+\"'/>\")\n\n            var settings = {\n                border: {\n                    color: UIToolsConstants.CIColors.GreyLightAlto.color, // '#ddd',\n                    width: 3\n                },\n                colors: this.colorScheme.filter(function (color) { return color.color != UIToolsConstants.CIColors.GreyLightAlto.color; }), //[\"#1abc9c\", \"#2ecc71\", \"#3498db\", \"#9b59b6\", \"#34495e\", \"#16a085\", \"#27ae60\", \"#2980b9\", \"#8e44ad\", \"#2c3e50\", \"#f1c40f\", \"#e67e22\", \"#e74c3c\", \"#95a5a6\", \"#f39c12\", \"#d35400\", \"#c0392b\", \"#bdc3c7\", \"#7f8c8d\"],\n\n                text: UIToolsConstants.CIColors.Black.color, // '#fff',\n                size: size,\n                middlename: true,\n                uppercase: true\n            }\n\n                var elementText = info;\n                var initialLetters = info.length <2? [info[0]] : [info[0], info[1]];\n                var initials = initialLetters.join('');\n\n                let color = this.calculateColorFrom(info);\n\n                avatarDiv.text(initials);\n                avatarDiv.css({\n                    'color': color.alternateColor,\n                    'background-color':color.color,\n                    'display': 'inline-block',\n                    'font-family': 'Arial, \\'Helvetica Neue\\', Helvetica, sans-serif',\n                    'font-size': settings.size * 0.4,\n                    'border-radius': settings.size + 'px',\n                    'width': settings.size + 'px',\n                    'height': settings.size + 'px',\n                    'line-height': (settings.size) + 'px',\n                    'text-align': 'center',\n                    'text-transform' : settings.uppercase ? 'uppercase' : ''\n                });\n                return avatarDiv;\n}\n\n    public doCopy( content:JQuery, onProcessCopy:Function ) {\n        let that = this;\n        let copyBufferHTML = $(\"<div class='copyBuffer'>\").appendTo(\"body\");\n        copyBufferHTML.append( content.clone(true) );\n        $(\".hideCopy\",copyBufferHTML).remove();\n        $(\".hideCopyAlways\",copyBufferHTML).remove();\n        $(\".tooltip\",copyBufferHTML).remove();\n        $(\".tooltip-inner\",copyBufferHTML).remove();\n\n\n        $(\".hideScreen\",copyBufferHTML).removeClass(\"hideScreen\");\n        // copy content of data into html\n        $.each( $(\".replaceCopy\",copyBufferHTML), function(ridx, replace) {\n            $(replace).html( $(replace).data(\"with\"));\n        });\n\n\n\n\n\n\n\n\n        if (onProcessCopy) onProcessCopy(copyBufferHTML);\n\n        this.serverHtmlCleanupBlob(copyBufferHTML).done((cleanHtml)=>{\n            globalMatrix.serverStorage.setItem( \"copyBuffer\", cleanHtml);\n            copyBufferHTML.remove();\n            ml.UI.showAck(-3,\n                `To paste the copied information, use the <b>\"Paste Dashboard\" menu entry </b> in the Matrix menu (for the TinyMCE editor) or the <b>\"Paste\" menu entry</b> in the paste menu button <br/> (for the legacy editor).<br> <br> Please refer to <a href='https://urlshort.matrixreq.com/d23/faq/pastedashboard' target='_blank'> the FAQ </a>for more details`,\n                \"Copy completed\");\n\n        })\n\n\n\n    }\n\n    private countVisibleDialogs( idx:number ) {\n        let count = 0;\n        let cls = idx?(\".ui-dialog.ui-front\"+idx):\".ui-dialog.ui-front\";\n        $( cls ).each( function( dlgidx, dlg) {\n            if ($(dlg).css(\"display\") !==\"none\") {\n                count++;\n            }\n        });\n        // return count BUT substract 1 from level 0 (the dialog itself which is pushed )\n        return idx?count:count-1;\n    }\n\n    addChevronSection( container:JQuery, text:string, help:string, open?:boolean ) {\n        let isOpen = open?true:false;\n        let details = $(`<div class='chevronInner' style='display:${isOpen?\"block\":\"none\"};'>`);\n        let helpLine = $(`<div class='chevronHelp'>${help}</div>`);\n        let toggle = $(`<div class='chevronHeading'><span class=\"fa ${isOpen?\"fa-chevron-down\":\"fa-chevron-right\"}\"></span> <span class='chevronText'>${text}</span></div>`)\n            .appendTo(container)\n            .click( function( ) {\n                if (isOpen) {\n                    isOpen = false;\n                    details.hide();\n                    $(\".fa\", toggle).removeClass(\"fa-chevron-down\").addClass( \"fa-chevron-right\");\n                } else {\n                    isOpen = true;\n                    details.show();\n                    $(\".fa\", toggle).removeClass( \"fa-chevron-right\").addClass( \"fa-chevron-down\");\n                }\n            });\n\n        if (help) {\n            helpLine.appendTo(container);\n        }\n\n        details.appendTo(container);\n        return details;\n    }\n\n    private getSlideHeight(slide:JQuery, padded:boolean):number {\n        var height = 0;\n        slide.children().each(function (idx:number, child:Node) {\n\n            height += $(child).height();\n        });\n        var padding = slide.outerHeight() - slide.height(); // padding of outer div + border\n\n        if (height + padding < 50) {\n            height = 50 - padding;\n        }\n        if (height > 300) {\n            height = 300;\n        }\n\n        let screenHeight = $(\"#itemDetails\").height()? $(\"#itemDetails\").height():400;\n\n        if (!padded) {\n            return Math.min(screenHeight, Math.max(height, slide.height()));\n        }\n        return  Math.min(screenHeight, Math.max(height + padding, slide.outerHeight()));\n    }\n\n\n    private showSlide(slideId:string, outAgain?:number):void {\n        let slide = $(slideId);\n        // calc height of box\n        slide.height('auto');\n        var height = this.getSlideHeight(slide, false);\n        var heightPadded = this.getSlideHeight(slide, true);\n        // set height of box\n        slide.height(height + \"px\");\n\n        if (slide.css(\"margin-top\") !== \"0px\") {\n            // slide is not visible\n            // move box out of top of screen, so that bottom is just above top of screen\n            slide.css(\"margin-top\", '-' + heightPadded + 'px');\n        }\n        // scroll it in\n        slide.clearQueue().animate({'margin-top': '0px'});\n        // after s sec out again\n\n        if (outAgain) {\n            window.clearTimeout( this.removeTimer[slideId] );\n            this.removeTimer[slideId] = window.setTimeout(function () {\n                slide.clearQueue().animate({'margin-top': '-' + (heightPadded + 14) + 'px'});\n            }, outAgain);\n        }\n    }\n\n    private hideSlide(slide:JQuery):void {\n        // calc height of box\n        let that = this;\n        slide.promise().done(function(){\n            var heightPadded = that.getSlideHeight(slide, true);\n\n            slide.css(\"margin-top\", '-' + (heightPadded + 4) + 'px');\n        });\n    }\n\n    private getItemHtmlFromCacheOrServerAsync(itemId:string, crossProject?:string):JQueryDeferred<{}> {\n        let that = this;\n        let res = $.Deferred();\n        let now = new Date();\n        this.hidden_tooltip_itemId = null;\n        var last_cached = crossProject?null:this.tooltip_cache[itemId];\n        if (crossProject) {\n\n            app.getItemProjectAsync(crossProject, itemId, true).done(function (item: IItem) {\n                that.renderCrossItem(item, crossProject).always( () => {\n                    res.resolve();\n                });\n            }).fail(function (error) {\n                res.reject(error);\n            });\n\n        } else if (last_cached && (now.getTime() - last_cached.date.getTime()) < 10000) {\n            that.renderItem(last_cached.item).then( () => {res.resolve()});\n        } else  {\n            app.getItemAsync(itemId, undefined, true).done(async function (item: IItem) {\n\n                await that.renderItem(item);\n                last_cached = {date: new Date(), item: item};\n                that.tooltip_cache[itemId] = last_cached;\n                res.resolve();\n            }).fail(function (error) {\n                if (!error || !error.responseJSON || error.responseJSON.code != \"AuthenticationFailed\") {\n                    matrixApplicationUI.renderErrorControl($(\"#tooltip_panel\"), \"The item \" + itemId + \" does not exist.\", \"And it never did ....\", true);\n                }\n\n                res.resolve();\n            });\n        }\n        return res;\n    }\n\n    private async renderItem(item: IItem) {\n        let that = this;\n        $(\"#tooltip_panel\").html(\"\");\n        $(\"<div class='tooltip_panel_close'>x</div>\").appendTo($(\"#tooltip_panel\")).click(function () {\n            that.hideCurrentToolTip();\n        });\n        if (item.title === undefined) {\n            matrixApplicationUI.renderErrorControl($(\"#tooltip_panel\"), \"The item \" + item.id + \" was deleted\", \"Ýou can find it in the deleted item log.\", true);\n        } else if (app.canViewItem(item)) {\n            var ctrl = new ItemControl({\n                control: $(\"#tooltip_panel\"),\n                controlState: ControlState.Tooltip,\n                item: item,\n                isItem: (typeof item.children === 'undefined')\n            });\n            await ctrl.load();\n            let bcs = app.getBreadcrumbs(item.id).filter(function (bc) {\n                return bc != item.id;\n            });\n            let breadcrumb = bcs.reverse().map(function (bid: string) {\n                return bid + \" \" + app.getItemTitle(bid);\n            }).join(\" > \");\n\n            let title = $(\"#tooltip_panel .itemTitle\").addClass(\"tooltipItem\").removeClass(\"pull-left\").removeClass(\"itemTitle\");\n            title.closest(\".itemTitleBarNoToolsNoEdit\").removeClass(\"itemTitleBarNoToolsNoEdit\");\n            $(\"<hr style='border-top-color: #aaa;margin-top: 10px;width: 100%;margin-bottom: 10px;'/>\").insertAfter(title);\n            $('<div style=\"font-size: smaller;\">').append($(\"<span class='inlineHelp'>\").html(breadcrumb)).insertAfter(title);\n        } else {\n            matrixApplicationUI.renderErrorControl($(\"#tooltip_panel\"), \"You have no rights to view \" + item.id + \"\", \"Talk to the project administrator.\", true);\n        }\n    }\n\n    private renderCrossItem(item:IItem, project:string) {\n        let that = this;\n        var res = $.Deferred();\n\n        $(\"#tooltip_panel\").html(\"\");\n        $(\"<div class='tooltip_panel_close'>x</div>\").appendTo($(\"#tooltip_panel\")).click( function() {\n            that.hideCurrentToolTip();\n        });\n\n        if (item.isDeleted) {\n            $(\"#tooltip_panel\").html( item.id + \" in project \" + project + \" was deleted\");\n            res.resolve();\n            return res;\n        }\n        let originalIC = ml.JSON.clone(globalMatrix.ItemConfig);\n        let newIC = new ItemConfiguration(ml.Logger, ml.JSON);\n\n        restConnection.getServer(project + \"/cat\").done(function (catDetails: XRGetProject_CategoryList_GetProjectStructAck) {\n            newIC.addCategories(catDetails);\n\n            restConnection.getServer(project + \"/setting\").done(async function (settings: XRGetProject_ProjectSettingAll_GetSettingAck) {\n                newIC.addSettings(settings);\n\n                setIC(newIC);\n\n                let itemForm = new ItemControl({\n                    control: $(\"#tooltip_panel\"),\n                    controlState: ControlState.Tooltip,\n                    item: item,\n                    isItem: (typeof item.children === 'undefined')\n                });\n                await itemForm.load();\n                let projectInfo = \"Project: \" + project;\n\n                let title = $(\"#tooltip_panel .itemTitle\").addClass(\"tooltipItem\").removeClass(\"pull-left\").removeClass(\"itemTitle\");\n                title.closest(\".itemTitleBarNoToolsNoEdit\").removeClass(\"itemTitleBarNoToolsNoEdit\");\n                $(\"<hr style='border-top-color: #aaa;margin-top: 10px;width: 100%;margin-bottom: 10px;'/>\").insertAfter(title);\n                $('<div style=\"font-size: smaller;\">').append($(\"<span class='inlineHelp'>\").html(projectInfo)).insertAfter(title);\n\n                setIC(originalIC);\n                res.resolve();\n            }).fail( function () {\n                setIC(originalIC);\n                res.resolve();\n            });\n        }).fail( function () {\n            setIC(originalIC);\n            res.resolve();\n        });\n        return res;\n    }\n\n    private hideCurrentToolTip():void {\n        this.hidden_tooltip_itemId = null;\n        clearTimeout(this.lastTooltipHide);\n        this.lastTooltipHide = null;\n        var height = Math.max(300, this.getSlideHeight($(\"#tooltip_panel\"), true));\n        $(\"#tooltip_panel\").css('margin-top', '-' + (height + 30) + 'px');\n    }\n\n    private  showTaskAsTooltip_Delayed(id:string, title:string, url:string, htmlContent:string, target:JQuery)\n    {\n        let that = this;\n\n        $(\"#tooltip_panel\").html(\"\");\n        $(\"<div class='tooltip_panel_close'>x</div>\").appendTo($(\"#tooltip_panel\")).click( function() {\n            that.hideCurrentToolTip();\n        });\n        if ( title === undefined ) {\n            matrixApplicationUI.renderErrorControl($(\"#tooltip_panel\"), \"The item \" + \" was deleted\", \"\", true);\n        } else {\n            $(\"#tooltip_panel\").append(`<div class=\"tooltipItem\"><a href=\"${url}\" target=\"_blank\"><span class=\"\">${id}</span></a><span class=\"refTitle\">${title}</span></div>`);\n            $(\"#tooltip_panel\").append(`<hr style=\"border-top-color: #aaa;margin-top: 10px;width: 100%;margin-bottom: 10px;\">`);\n            $(\"#tooltip_panel\").append(`<div class=\"dialog-body\">${htmlContent} </div>`);\n        }\n\n        that.showSlide(\"#tooltip_panel\");\n        $(\"#tooltip_panel\").on('mouseover', function () {\n            clearTimeout(that.lastTooltipHide);\n            that.lastTooltipHide = null;\n        });\n        $(\"#tooltip_panel\").on('mouseleave', function () {\n            if (!globalMatrix.globalShiftDown) {\n                that.hideCurrentToolTip();\n            }\n        });\n\n    }\n    private showTooltip_Delayed(itemId:string, target:JQuery, crossProject?:string):void {\n        let that = this;\n\n        if (itemId.indexOf(\"-\") === 0 || app.getType(itemId)[0] === \"_\" || app.isFolder(itemId) || app.getCurrentItemId() === itemId) {\n            this.hideCurrentToolTip();\n            return;\n        }\n\n        if ( Tasks.isTaskId(itemId)) {\n            this.hideCurrentToolTip();\n            return;\n        }\n\n        this.getItemHtmlFromCacheOrServerAsync(itemId, crossProject).done(function () {\n\n            if (!globalMatrix.globalShiftDown || app.getCurrentItemId() === itemId) {\n                that.hideCurrentToolTip();\n                return;\n            }\n\n            that.showSlide(\"#tooltip_panel\");\n            $(\"#tooltip_panel\").on('mouseover', function () {\n                clearTimeout(that.lastTooltipHide);\n                that.lastTooltipHide = null;\n            });\n            $(\"#tooltip_panel\").on('mouseleave', function () {\n                if (!globalMatrix.globalShiftDown) {\n                    that.hideCurrentToolTip();\n                }\n            });\n        })\n    }\n\n\n    // config client helper\n\n\n\n    enableIf( cb:JQuery, state:boolean, ctrls:JQuery[]) {\n        let that = this;\n        $(\"input\", cb).change( function() {\n            $.each(ctrls, function(idx, ctrl) {\n                ml.UI.setEnabled(ctrl, $(\"input\", cb).is(':checked') == state);\n            });\n        });\n        $.each(ctrls, function(idx, ctrl) {\n            ml.UI.setEnabled(ctrl, $(\"input\", cb).is(':checked') == state);\n        });\n    }\n\n    addCheckboxD( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function, defaultValue:string ) {\n        let that = this;\n        let dataCY = propertyName ?? text.replace( /\\s/g,\"-\");\n\n        let cb = $(`<div data-cy=\"${dataCY}\">`).appendTo(ui).checkBox({\n            canEdit: true,\n            help: text,\n            valueChanged: async function () {\n                let newValue = await cb.getController().getValueAsync();\n                if( newValue !== fieldParams[propertyName]){\n                    fieldParams[propertyName] = newValue;\n                    if (onChange) onChange();\n                }\n\n            },\n            parameter: {},\n            fieldValue: defaultValue\n        });\n\n         cb.getController().getValueAsync().then((value)=>{ fieldParams[propertyName] = value });\n        return cb;\n    }\n    addCheckbox( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function ) {\n        return this.addCheckboxD(ui,text,fieldParams,propertyName,onChange, fieldParams[propertyName] ? \"1\" : \"0\");\n    }\n    /** checkbox will only be checked if explicitly be set to true*/\n    addCheckboxIsTrue( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function ) {\n        return this.addCheckboxD(ui, text, fieldParams, propertyName, onChange, ml.JSON.isTrue(fieldParams[propertyName]) ? \"1\" : \"0\");\n    }\n    /** checkbox will only checked if NOT explicitly be set to false (so unchanged=default=checked) */\n    addCheckboxIsFalse( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function ) {\n        return this.addCheckboxD(ui, text, fieldParams, propertyName, onChange, ml.JSON.isFalse(fieldParams[propertyName]) ? \"0\" : \"1\");\n    }\n    addPassInput( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function, onUnFocus?:Function ) {\n        return this.addTextInput( ui, text, fieldParams, propertyName, onChange, onUnFocus, true);\n    }\n    addTextInput(ui: JQuery, text: string, fieldParams: IGenericMap, propertyName: string, onChange: Function, onFocusOut?: Function, isPass?: boolean, help?: string, readonly?: boolean,\n        rows = 1, allowResize = false) {\n        let that = this;\n        let dataCY = propertyName ?? text.replace( /\\s/g,\"-\");\n        let pt = $(`<div data-cy=\"${dataCY}\" class=\"controlContainer\">`).appendTo(ui).plainText({\n            canEdit: true,\n            help: text,\n            valueChanged: async function () {\n                let newValue = await pt.getController().getValueAsync();\n                if (fieldParams[propertyName] || newValue) {\n                    // avoid creating a empty \"\" field instead of non existing which would trigger a save\n\n                    if (isPass) {\n                        // unescaping the password using TextArea.\n                        newValue = $(\"<textarea/>\").html(newValue).text();\n                    }\n\n                    fieldParams[propertyName] = newValue;\n                }\n                if (onChange) onChange();\n            },\n            parameter: { rows: rows, allowResize: allowResize, password: isPass ? true : false, inlineHelp: help, readonly: readonly },\n            fieldValue: fieldParams[propertyName]\n        });\n        if (isPass) {\n            $(\"input\", pt).attr(\"readonly\",\"readonly\").on(\"focus\", () => {\n                $(\"input\", pt).removeAttr(\"readonly\");\n            });\n        }\n        if (onFocusOut) {\n            pt.focusout( function() {onFocusOut(); });\n        }\n        return pt;\n    }\n\n    addRichTextInput( ui:JQuery, params:IRichTextParams, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function, onFocusOut?:Function ) {\n        let that = this;\n        let dataCY = propertyName ?? text.replace( /\\s/g,\"-\");\n        let pt = $(`<div data-cy=\"${dataCY}\"  class=\"controlContainer\">`).appendTo(ui).richText({\n            canEdit: true,\n            help: text,\n            valueChanged: async function () {\n                let newValue = await pt.getController().getValueAsync();\n                if (fieldParams[propertyName] || newValue) {\n                    // avoid creating a empty \"\" field instead of non existing which would trigger a save\n                    fieldParams[propertyName] = newValue;\n                }\n                if (onChange) onChange();\n            },\n            parameter: params,\n            fieldValue: fieldParams[propertyName]\n        });\n        if (onFocusOut) {\n            pt.focusout( function() {onFocusOut(); });\n        }\n        return pt;\n    }\n\n    addDateSelect( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function, help?:string, readonly?:boolean ) {\n        let dataCY = propertyName ?? text.replace( /\\s/g,\"-\");\n        let pt = $(`<div data-cy=\"${dataCY}\"  class=\"controlContainer\">`).appendTo(ui).dateselect({\n            controlState: ControlState.FormEdit,\n            canEdit: true,\n            help:text,\n            fieldValue:fieldParams[propertyName]?fieldParams[propertyName]:\"\",\n            valueChanged: async function () {\n                fieldParams[propertyName] = await pt.getController().getValueAsync();\n                onChange();\n            },\n            parameter: {\n                allowClear: true,\n                inlineHelp:help,\n                readonly:readonly\n\n            }\n        });\n        return pt;\n    }\n\n\n    addIconInput( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, onChange:Function, onFocusOut?:Function, isPass?:boolean ) {\n        return this.addDropdownToValue( ui, text, fieldParams, propertyName, this.getIconOptions(), true, true, onChange, \"\");\n    }\n\n    addDropdownToArray( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, options:IDropdownOption[], grouping:IDropdownGroup[], maxItems:number, create:boolean, sort:boolean, onChange:Function, placeholder?:string) {\n        let that = this;\n        let dataCY = propertyName ?? text.replace( /\\s/g,\"-\");\n        let dd = $(`<div data-cy=\"${dataCY}\"  class=\"controlContainer\">`).appendTo(ui).mxDropdown({\n            help:text,\n            canEdit:true,\n            parameter:{\n                placeholder: placeholder?placeholder:\"please select\",\n                create: create,\n                options: options,\n                maxItems: maxItems,\n                groups:grouping,\n                sort: sort\n            },valueChanged: async function () {\n                if (dd) {\n                    let changed = await dd.getController().getValueAsync();\n                    fieldParams[propertyName] = changed ? changed.split(\",\") : [];\n                    if (onChange) onChange();\n                }\n            },\n            fieldValue: fieldParams[propertyName]? fieldParams[propertyName].join(\",\"):\"\"\n        });\n        return dd;\n    }\n\n    addDropdownNumber( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, first:number, last:number,\n        onChange:Function, placeholder?:string, paramsBase?:IDropdownParams) {\n\n        const current = { val:fieldParams[propertyName]?(\"\"+fieldParams[propertyName]):\"0\"};\n        const options = Array.from({length: 1+last-first}, (_, n) => { return  n+first}).map( (n) => { return  {id:\"\"+n, label:\"\"+n}});\n        this.addDropdownToValue(ui, text, current, \"val\", options, false, false, () => {\n            fieldParams[propertyName] = Number(current.val);\n            if (onChange) onChange();\n        }, placeholder, paramsBase);\n    }\n    addDropdownToValue( ui:JQuery, text:string, fieldParams:IGenericMap, propertyName:string, options:IDropdownOption[],\n                        create:boolean, sort:boolean, onChange:Function,\n                        placeholder?:string, paramsBase?:IDropdownParams) {\n\n        let defaultParams = paramsBase?paramsBase:{};\n        let params = ml.JSON.clone({\n            ...defaultParams,\n            ...{\n                placeholder: placeholder?placeholder:\"please select\",\n                create: create,\n                options: options,\n                maxItems: 1,\n                sort: sort}});\n        let dataCY = propertyName ?? text.replace(/\\s/g,\"-\");\n        let dd = $(`<div data-cy=\"${dataCY}\" class=\"controlContainer\">`).appendTo(ui).mxDropdown({\n            help:text,\n            canEdit:true,\n            parameter: params,\n            valueChanged: async function () {\n                if (dd) {\n                    let changed = await dd.getController().getValueAsync();\n                    fieldParams[propertyName] = changed;\n                    if (onChange) onChange();\n                }\n            },\n            fieldValue: fieldParams[propertyName]? fieldParams[propertyName]:\"\"\n        });\n        return dd;\n    }\n\n\n    getPageTitle(title: string, getPanel?:()=>JQuery, resize?:()=>void ): JQuery {\n        let that = this;\n        let div =  $(`<div class=\"panel-heading itemTitleBar addedTitle\">\n            <div class=\"itemTitle pull-left\">\n                <span data-cy='title' class=\"refTitle\">${title}</span>\n            </div>\n\n         </div>`);\n         let toolBar = $(\"<div class=' hidden-print toolsBarButtonsContainer'><div class='btn-group toolbarButtons'></div></div>\") ;\n         div.append(toolBar);\n         if(getPanel != undefined) {\n\n            let bResize = $(\"<div  class='btn-group btn-dashboard-fullscreen' ><button title data-original-title='Fullscreen' tabindex='-1' class='btn btn-item btn-fullscreen'> <span class='fal fa-expand-arrows-alt'></span></button></div>\").click(function () {\n                let panel = getPanel();\n\n                let panelParent = panel.parent();\n                let toolbarParent = toolBar.parent();\n\n                let dlg = $(\"<div>\").appendTo($(\"body\"));\n                ml.UI.showDialog(dlg, title, panel, window.innerWidth, window.innerHeight,\n                    [{\n                        text: 'Ok',\n                        class: 'btnDoIt',\n                        click: function () {\n                            dlg.dialog(\"close\");\n                            panelParent.append(panel);\n                            toolBar.appendTo(toolbarParent);\n                            dlg.remove()\n                            resize();\n                        }\n                    }]\n                    , UIToolsConstants.Scroll.None, false, false,\n                    () => {\n                        dlg.dialog(\"close\");\n                        panelParent.append(panel);\n                        toolBar.appendTo(toolbarParent);\n                        dlg.remove()\n                        resize();\n                     },\n                    () => {\n\n                        $(\".ui-dialog-titlebar\").append(toolBar);\n                        resize();\n                    },\n                    () => { });\n\n            });\n            $(\".toolbarButtons\", toolBar).append(bResize);\n        }\n        return div\n\n    }\n\n    /* ***************************************************\n       list of items with up / down / edit delete buttons\n       *************************************************** */\n\n    // add a line which can be moved up or down\n    createConfigLine( lineId:string, linePrefix:string, lineName:string, lineArray:any[], idProp:string\n        , onChangedOrder: () => void\n        , onEdit: ( lineId:string) => void\n        , needsEdit:boolean\n        , onDelete: ( lineId:string ) => void\n        ) {\n\n        let that = this;\n        let li = $(\"<li>\");\n        $(\"<span>\").html(`<b>${linePrefix}</b>`).appendTo(li);\n        $(\"<span>\").html(`<b>${lineName}</b>`).appendTo(li);\n\n        $(\"<span class='moveUp btn-link' data-original-title='Move up' >\").data(\"lineId\", lineId).append('<i style=\"cursor:pointer\" class=\"taglist fal fa-arrow-up\" >').click( function( event) {\n\n            let liToMove =  $(event.delegateTarget).data(\"lineId\");\n            let liBefore = that.moveUp( $(event.delegateTarget) );\n\n            let labelToMoveIdx = that.getIndex(lineArray, idProp, liToMove);\n            let labelBeforeIdx = that.getIndex(lineArray, idProp, liBefore);\n\n            let toMove = lineArray.splice(labelToMoveIdx, 1);\n            lineArray.splice(labelBeforeIdx,0, toMove[0]);\n\n            onChangedOrder();\n        }).appendTo(li);\n\n        $(\"<span class='moveDown btn-link'>  data-original-title='Move down'\").data(\"lineId\",lineId).append('<i style=\"cursor:pointer\" class=\"taglist fal fa-arrow-down\" >').click( function( event) {\n            let liToMove =  $(event.delegateTarget).data(\"lineId\");\n            let liAfter = that.moveDown( $(event.delegateTarget) );\n            let labelToMoveIdx = that.getIndex(lineArray, idProp, liToMove);\n            let labelAfterIdx = that.getIndex(lineArray, idProp, liAfter);\n            let toMove = lineArray.splice(labelToMoveIdx, 1);\n            lineArray.splice(labelAfterIdx+1,0, toMove[0]);\n\n            onChangedOrder();\n        }).appendTo(li);\n\n\n        // edit button\n        if (onEdit) {\n            $(`<span style='${needsEdit?\"color:red\":\"\"}' class=' btn-link  data-original-title='Edit'>)`).html(\"<i class='fal fa-pencil'/>\")\n            .data(\"lineId\", lineId)\n            .click( function( event) {\n                onEdit( $(event.delegateTarget).data(\"lineId\") );\n            }).appendTo(li);\n        }\n\n\n        // delete button\n        $(\"<span class=' btn-link'  data-original-title='Delete' >\").html(\"<i class='fal fa-trash-alt'/>\").data(\"lineId\", lineId).click( function( event) {\n\n            ml.UI.showConfirm(-1, { title: \"Delete \" + lineId, ok: \"Delete\", nok: \"Cancel\" }, () => {\n\n                let dl =  $(event.delegateTarget).data(\"lineId\");\n\n                onDelete( dl );\n            }, () => {});\n        }).appendTo(li);\n\n        return li;\n    }\n\n    // remove first up / last down icon button\n    fixArrows(ul:JQuery) {\n        let count = ul.data(\"count\");\n        $.each( $(\"li\", ul), function(idx, li) {\n            (idx==0||count<2)?$(\".moveUp\", li).hide():$(\".moveUp\", li).show();\n            (idx+1==count||count<2)?$(\".moveDown\", li).hide():$(\".moveDown\", li).show();\n        });\n    }\n\n    // line to add a new element\n    createConfigAddLine( action:string, onAdd:() => void ) {\n        let li = $(\"<li>\");\n\n        $(\"<span class='editLinkButtonLeft'>\").html(action).click( function( event) {\n            onAdd();\n        }).appendTo(li);\n\n        return li;\n    }\n    standardizeColor(fieldValue: string,alpha = 20 ): string {\n        var ctx = document.createElement('canvas').getContext(\"2d\");\n        ctx.fillStyle =  fieldValue ;\n        return ctx.fillStyle + (alpha > 0 ? alpha.toString(): \"\");\n\n    }\n    // MATRIX-6169: disallow filter selection when item is not saved\n    /**\n     * Enable or disable the global filter selection\n     * @param isEnabled\n     */\n    changeGlobalFilterSelectionEnabled(isEnabled:boolean){\n        if(isEnabled){\n            $(\"#sidebar .searchBoxFilter\").removeAttr('disabled');\n            $(\"#sidebar .searchBoxFilter\").removeAttr('title');\n            $(\"#sidebar #clearSelectedFilter\").removeAttr('disabled');\n            $(\"#sidebar .chip a\").show();\n\n        }\n        else{\n            $(\"#sidebar .searchBoxFilter\").attr('disabled', \"disabled\");\n            $(\"#sidebar .searchBoxFilter\").attr(\"title\",\"Filter selection is disabled until item is saved\");\n            $(\"#sidebar #clearSelectedFilter\").attr('disabled', \"disabled\");\n            $(\"#sidebar .chip a\").hide();\n        }\n    }\n    toggleFilters(filterOn: boolean){\n        if(filterOn) {\n            $(\"#globalProjectFilter >> button\").removeAttr(\"disabled\");\n            $(\"#sidebar .searchBoxFilter\").show();\n            $(\".itemFilterTool\").show();\n            if( $(\".itemFilterTool .chip:visible\").length == 0){\n                $(\".itemFilterTool\").hide();\n\n            }\n\n\n        }\n        else {\n            $(\"#globalProjectFilter >> button\").attr(\"disabled\", \"disabled\");\n            $(\"#sidebar .searchBoxFilter\").hide();\n            $(\".itemFilterTool\").hide();\n\n        }\n    }\n\n\n    /* ***************************************************\n      handle < in html to prevent dangerous stuff\n      *************************************************** */\n\n    protected getIndex( lineArray:any[], idProp:string, lineId:string) {\n        for(var idx=0; idx<lineArray.length; idx++) {\n            if (lineArray[idx][idProp] == lineId) {\n                return idx;\n            }\n        }\n        return -1;\n    }\n    protected moveUp( moveBtn:JQuery ) {\n        let li1 = moveBtn.closest(\"li\");\n        let li2 = li1.prev(\"li\");\n\n        li2.before(li1);\n\n        this.fixArrows(moveBtn.closest(\"ul\"));\n        return $(\".moveDown\",li2).data(\"lineId\");\n    }\n\n    protected moveDown(moveBtn:JQuery) {\n        let li1 = moveBtn.closest(\"li\");\n        let li2 = li1.next(\"li\");\n\n        li2.after(li1);\n\n        this.fixArrows(moveBtn.closest(\"ul\"));\n        return $(\".moveUp\",li2).data(\"lineId\");\n    }\n}\n\n\nclass BlockingProgressUI implements IBlockingProgressUI {\n    private progressLauncher:number;\n    private animation:number;\n    private taskList:IBlockingProgressUITask[];\n\n    private closeIfDone():void {\n        var allDone = true;\n        $.each(this.taskList, function (idx, task) {\n            if (task.progress < 100) {\n                allDone = false;\n            }\n        });\n        if (allDone) {\n            clearTimeout(this.progressLauncher);\n            $(\"#message_progress\").hide();\n        }\n    }\n\n    Init(tasks:IBlockingProgressUITask[], animate?:boolean):void {\n        let that = this;\n\n        this.taskList = ml.JSON.clone(tasks);\n        clearTimeout(this.progressLauncher);\n        clearTimeout(this.animation);\n\n        var table = $(\"<table style='width:100%'>\");\n        var tbody = $(\"<tbody>\");\n        table.append(tbody);\n        $(\"#message_progress_text\")\n                .addClass(\"alert-success\")\n                .removeClass(\"alert-danger\")\n                .css(\"width\", \"600px\")\n                .html(\"\").append(table);\n        $.each(this.taskList, function (idx, task) {\n            task.progress = 0;\n\n            var tr = $(\"<tr>\");\n            var tdp = $('<div class=\"progress-bar progress-bar-success progress-bar-striped active progressCtrl2 pci' + idx +\n                    '\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:0%\"></div>');\n            tdp.data(\"valuenow\", 1).width(1 + \"%\");\n\n            var name = task.name;\n            if (name && name.length > 40) {\n                name = name.substring(0, 37) + \"...\";\n            }\n\n            tbody.append(tr.append($(\"<td id='progressN\"+idx+\"' style='text-align:left'>\").html(name)).append($(\"<td style='width:66%;  padding-right: 10px;'>\").append(tdp)));\n        });\n\n        this.progressLauncher = window.setTimeout(function () {\n            $(\"#message_progress\").show();\n            if (animate) {\n                $(\".pci0\" , $(\"#message_progress_text\")).width(\"30px\");\n                that.taskList[0].progress = 0;\n                that.animation = window.setInterval( function() { that.tick();}, 50 );\n            }\n        }, 10);\n\n    }\n\n    SetProgress(taskIdx:number, percent:number, newText?:string):void  {\n        clearTimeout(this.animation);\n        $(\".pci0\", $(\"#message_progress_text\")).css(\"margin-left\", \"\");\n        percent = (percent <= 100) ? percent : 100;\n        this.taskList[taskIdx].progress = percent;\n        $(\".pci\" + taskIdx, $(\"#message_progress_text\")).data(\"valuenow\", percent).width(percent + \"%\");\n        if (newText) {\n            $(\"#progressN\"+taskIdx).html( newText );\n        }\n        this.closeIfDone();\n    }\n\n    SetProgressError(taskIdx:number, problem:string):void {\n        clearTimeout(this.animation);\n        this.taskList[taskIdx].progress = 100;\n        $(\".pci0\", $(\"#message_progress_text\")).css(\"margin-left\", \"\");\n        $(\".pci\" + taskIdx, $(\"#message_progress_text\")).html(problem).css(\"background-color\", \"red\").width(\"100%\");\n        $(\"#message_progress_text\")\n                .removeClass(\"alert-success\")\n                .addClass(\"alert-danger\");\n        this.closeIfDone();\n    }\n    private tick():void  {\n\n        let percent = this.taskList[0].progress + 1;\n        this.taskList[0].progress = percent<90?percent:0;\n        let bar = $(\".pci0\", $(\"#message_progress_text\"));\n        bar.prop(\"style\", \"width:30px; margin-left:\"+percent+\"% !important\");\n    }\n}\n\nclass ProgressUI implements IProgressUI {\n    private ProgressCtrlTimer:number;\n\n    Init(message:string, warning?:boolean):void {\n        $(\"#progressCtrlContainer\").removeClass(\"hide\");\n        $(\"#progressCtrlText\").text(message);\n        $(\"#progressCtrl\").data(\"valuenow\", 1).width(1 + \"%\").removeClass(\"progressWarning\");\n        if (warning) $(\"#progressCtrl\").addClass(\"progressWarning\");\n    }\n    Update(progress:number):void {\n        $(\"#progressCtrl\").data(\"valuenow\", progress).width(progress + \"%\");\n    }\n    SuccessHide(message:string, ms:number):void  {\n        ml.Logger.log('success', message);\n\n        $(\"#progressCtrlText\").text(message);\n        $(\"#progressCtrl\").data(\"valuenow\", 100).width(100 + \"%\");\n        clearTimeout(this.ProgressCtrlTimer);\n        this.ProgressCtrlTimer = window.setTimeout(function () {\n            $(\"#progressCtrlContainer\").addClass(\"hide\");\n            $(\"#progressCtrlText\").text(\"\");\n            $(\"#progressCtrl\").data(\"valuenow\", 0).width(0 + \"%\");\n        }, ms);\n    }\n    ErrorHide(message:string, ms:number):void  {\n        ml.Logger.log('error', message);\n        $(\"#progressCtrlContainer\").css(\"background-color\", \"red\");\n        $(\"#progressCtrlText\").text(message);\n        $(\"#progressCtrl\").data(\"valuenow\", 0).width(0 + \"%\");\n        clearTimeout(this.ProgressCtrlTimer);\n        this.ProgressCtrlTimer = window.setTimeout(function () {\n            $(\"#progressCtrlContainer\").addClass(\"hide\");\n            $(\"#progressCtrlContainer\").css(\"background-color\", \"white\");\n            $(\"#progressCtrlText\").text(\"\");\n            $(\"#progressCtrl\").data(\"valuenow\", 0).width(0 + \"%\");\n        }, ms);\n    }\n }\n\nclass SelectUserOrGroupUI implements ISelectUserOrGroupUI {\n    dlg:JQuery;\n\n    showMultiUserSelect( container:JQuery,help:string, selected:string[], title:string, selectFrom:string, selectTo:string, showUsers:boolean, showGroups:boolean, onSelect:(selection:string[]) => void, preSelectedUsers?:XRUserPermissionType[] ) {\n        let that = this;\n        $('<span class=\"baseControlHelp\">' + help +'</span>').appendTo(container);\n        let ctrl = $(\"<div class='baseControl'>\").appendTo(container);\n        let input = $(\"<div class='form-control userSelect'>\").appendTo(ctrl);\n        input.html(selected?selected.map( function(userOrGroup) { return that.getGroupDisplayNameFromId(userOrGroup);}).join(\", \"):\"\");\n        ctrl.click( function(event:JQueryMouseEventObject) {\n            that.showSelectDialog( selected, title, selectFrom, selectTo, showUsers, showGroups, (selection:string[]) => {\n\n                let selectedUI = selection.map( function(userOrGroup) { return that.getGroupDisplayNameFromId(userOrGroup);});\n                input.html(selectedUI.join(\", \"));\n                onSelect(selection);\n                selected = selection;\n            }, preSelectedUsers);\n\n            return false;\n        })\n    }\n\n    getUsersInSelection( selection:string [] ) {\n        let that = this;\n\n        let users:string[] = selection.filter( function(userOrRole) { return !that.isGroup(userOrRole);});\n\n        // add users from groups\n        let groups = globalMatrix.ItemConfig.getUserGroups();\n        if (groups) {\n            $.each( groups, function(aclIdx, group) {\n                if (selection.indexOf( that.getGroupId( group ))!=-1 ) {\n                    $.each( group.membership, function( mIdx,member) {\n                        if (users.indexOf(member.login)==-1) {\n                            users.push(member.login);\n                        }\n                    });\n                }\n            });\n        }\n\n        return users;\n    }\n\n    getGroupId(group: XRGroupPermissionType | XRGroupType) {\n        return globalMatrix.ItemConfig.groupIdToName(group.groupId);\n    }\n\n    // convert a group id used in mail to italic group name\n    getGroupDisplayNameFromId( groupOrUserId:string ) {\n        if (!groupOrUserId) {\n            groupOrUserId = \"\";\n        }\n\n        if (groupOrUserId.indexOf(\"g_\") != 0 || groupOrUserId.indexOf(\"_g\") != (groupOrUserId.length - 2)) {\n            return groupOrUserId; // Not a group let's return the current value.\n        }\n\n        let groups = globalMatrix.ItemConfig.getUserGroups().sort( function( a,b) { if (a.groupName<b.groupName) return -1; else return 1;});\n        for(var idx=0;idx<groups.length;idx++) {\n            if (this.getGroupId(groups[idx])==groupOrUserId) {\n                return \"<span class='groupFlag'>group&nbsp;</span>\" + groups[idx].groupName;\n            }\n        }\n        if (!globalMatrix.ItemConfig.hasGroupInfo(groupOrUserId)) {\n            return `<span class='groupFlag'>group&nbsp;</span><s>${groupOrUserId}</s>`;\n        }\n        return groupOrUserId;\n    }\n    // return if the id is a group\n    isGroup( groupOrUserId:string ) {\n        let groups = globalMatrix.ItemConfig.getUserGroups();\n        for(var idx=0;idx<groups.length;idx++) {\n            if (this.getGroupId(groups[idx])==groupOrUserId) {\n                return true;\n            }\n        }\n        return false;\n    }\n    exists( groupOrUserId:string ) {\n        if (this.isGroup(groupOrUserId)) return true;\n        if (globalMatrix.ItemConfig.getUserIds().indexOf(groupOrUserId) != -1) return true;\n        return false;\n    }\n    showSelectDialog( selected:string[], title:string, selectFrom:string, selectTo:string, showUsers:boolean, showGroups:boolean, onSelect:(selection:string[]) => void, preSelectedUsers?:XRUserPermissionType[] ) {\n        let that = this;\n\n        that.dlg = $(`<div data-cy='${title.replace(/\\s/g,\"-\")}'>`).appendTo(\"body\");\n        let select = $(\"<select multiple>\").appendTo(that.dlg);\n\n        selected=selected?selected:[];\n\n        select.append(\"<option style='display:none' value='' data-search=''>\")\n        let users = preSelectedUsers ? preSelectedUsers : globalMatrix.ItemConfig.getUserNames();\n        let groups = globalMatrix.ItemConfig.getUserGroups().sort(function (a, b) { if (a.groupName < b.groupName) return -1; else return 1; });\n\n        let userSelect = select;\n        let groupSelect = select;\n        if (showGroups && showUsers) {\n            userSelect = $(\"<optgroup label='Users'>\").appendTo(select);\n            groupSelect = $(\"<optgroup label='User Groups'>\").appendTo(select);\n        }\n        if (showUsers) {\n\n            // sort users alphabetically\n            users = users.sort( function( a,b) { if (a.login<b.login) return -1; else return 1;});\n\n            // add to user select\n            $.each(users, function( userIdx,user) {\n                let name = globalMatrix.ItemConfig.getCombinedName(user);\n                let email = (user.email?user.email:\"\");\n                let searchVal = email + \" \" + name;\n                let sel = (selected.indexOf(user.login) != -1)?\" selected\":\"\";\n\n                userSelect.append( $(`\n                    <option data-search='${searchVal.toLowerCase()}' data-cy='${user.login}' data-user='${user.login}'\n                        title='${email}' value='${user.login}' ${sel}>\n                        ${name}\n                    </option>`));\n            });\n        }\n        if (showGroups) {\n\n            $.each(groups, function( groupIdx,group) {\n                let groupName = group.groupName;\n                let groupId = that.getGroupId( group );\n                let sel = (selected.indexOf(groupId) != -1)?\" selected\":\"\";\n                let tooltip = \"Press shift to select individual users instead of groups: \"+\n                group.membership.map( function(member) {return member.login}).join(\", \");\n                if (group.membership.length==0) {\n                    tooltip = \"group has no members\";\n                }\n                groupSelect.append( $(`<option title='${tooltip}'  data-group='group' data-search='group ${groupName.toLowerCase()}' value='${groupId }' ${sel} >${groupName}</option>`));\n            });\n        }\n\n\n        that.dlg.dialog({\n            autoOpen: true,\n            title: title?title:\"Select\",\n            width: 716,\n            height: 580,\n            resizeStop: function () {that.resize();},\n            modal: true,\n            open: function () {\n                ml.UI.pushDialog(that.dlg);\n                select.multiSelect({\n                    selectableHeader: \"<div class='custom-header'>\" + selectFrom +\"</div><input type='text' class='form-control ms-search' autocomplete='off' placeholder='filter'>\",\n                    selectionHeader: \"<div class='custom-header'>\" + selectTo +\"</div><input type='text' class='form-control ms-search' autocomplete='off' placeholder='filter'>\",\n                    afterInit: function(){\n\n                        let that = this,\n                            $selectableSearch = that.$selectableUl.prev(),\n                            $selectionSearch = that.$selectionUl.prev(),\n                            selectableSearchString = '#'+that.$container.attr('id')+' .ms-elem-selectable:not(.ms-selected)',\n                            selectionSearchString = '#'+that.$container.attr('id')+' .ms-elem-selection.ms-selected';\n\n                            $(\"li\", that.dlg).each(function(idx,opt){\n                                if ($(opt).data(\"group\")) $(opt).prepend(\"<span class='groupFlag'>group</span>\");\n                                if ($(opt).data(\"user\")) $(opt).prepend(ml.UI.getAvatar($(opt).data(\"user\"), 25));\n                            });\n\n                        $selectableSearch.on('keyup', function (e: JQueryKeyEventObject) {\n                            if (e.which === 40) {\n                                that.$selectableUl.focus();\n                                return false;\n                            } else {\n                                let searchExpr = $selectableSearch.val().toLowerCase();\n                                $.each($(selectableSearchString), function (lidx, li) {\n                                    (!searchExpr || $(li).data(\"search\").indexOf(searchExpr) != -1) ? $(li).show() : $(li).hide();\n                                });\n                                return true;\n                            }\n                        }).focus();\n\n                        $selectionSearch.on('keyup', function (e: JQueryKeyEventObject) {\n                            if (e.which == 40) {\n                                that.$selectionUl.focus();\n                                return false;\n                            } else {\n                                let searchExpr = $selectionSearch.val().toLowerCase();\n                                $.each($(selectionSearchString), function (lidx, li) {\n                                    (!searchExpr || $(li).data(\"search\").indexOf(searchExpr) != -1) ? $(li).show() : $(li).hide();\n                                });\n                                return true;\n                            }\n                        });\n                    },\n                    afterSelect: function (sel: string[]) {\n                        let groupAddedAsUsers = false;\n                        if (globalMatrix.globalShiftDown && showGroups) {\n                            $.each(groups, function (groupIdx, group) {\n                                let groupId = that.getGroupId(group);\n                                if (groupId == sel[0]) {\n                                    groupAddedAsUsers = true;\n                                    let newMembers = group.membership.map(function (member) { return member.login; }).filter(function (login) { return selected.indexOf(login) == -1; });\n                                    // update UI\n                                    $.each(newMembers, function (nmIdx, newMember) {\n                                        select.multiSelect('select', [newMember]);\n                                    });\n                                    // update internal selection\n                                    // selected = selected.concat( newMembers );\n                                }\n                            });\n                        }\n                        if (!groupAddedAsUsers) {\n                            selected.push(sel[0]);\n                        }\n                    },\n                    afterDeselect: function (sel: string[]) {\n                        selected = selected.filter(function (s) { return s != sel[0]; });\n                    }\n                });\n                that.resize();\n            },\n            close: function () { ml.UI.popDialog(that.dlg); that.dlg.remove(); },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt',\n                click: function () {\n                    onSelect(selected);\n                    that.dlg.dialog(\"close\");\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    that.dlg.dialog(\"close\");\n                }\n            }]\n        });\n    }\n\n    getUserDropDownOptions(showUsers: boolean, showGroups: boolean,\n        preSelectedUsers?: XRUserPermissionType[], possiblyDeletedUserGroupNames?: string): IDropdownOption[] {\n        return globalMatrix.ItemConfig.getValidUserOptions(showUsers, showGroups,\n            preSelectedUsers, possiblyDeletedUserGroupNames);\n    }\n\n    showSingleSelect(control: JQuery, showUsers: boolean, showGroups: boolean, onSelect: (selection: string) => void, preSelectedUsers?: XRUserPermissionType[], possiblyDeletedUsername?: string) {\n        let that = this;\n\n        let options: IDropdownOption[] = this.getUserDropDownOptions(showUsers, showGroups, preSelectedUsers, possiblyDeletedUsername);\n\n        control.selectize({\n            persist: false,\n            maxItems: 1,\n            valueField: 'id',\n            labelField: 'label',\n            searchField: ['label'],\n            options: options,\n            onChange : function(args) {\n                onSelect(args);\n            },\n            render: {\n                option: function (item, escape) {\n                    // This is to avoid escaped strings showing in the UI\n                    let labelText = item.label;\n                    if (item.strikethrough) {\n                        labelText = `<s>${labelText}</s>`;\n                    }\n                    return `<div class='option'>${labelText}</div>`;\n                },\n                item: function (item, escape) {\n                    let labelText = item.label;\n                    if (item.strikethrough) {\n                        labelText = `<s>${labelText}</s>`;\n                    }\n                    return `<div class='item'>${labelText}</div>`;\n                }\n            }\n        });\n    }\n\n  // store all the current groups and users in page\n    getAllUsersAndGroups( ):JQueryDeferred<IDropdownOption[]> {\n        let that = this;\n        let res:JQueryDeferred<IDropdownOption[]> = $.Deferred();\n\n        let dropdownOptions:IDropdownOption[] = [];\n\n        restConnection.getServer(\"user\").done(function (allUsersResult: XRGetUser_AllUsers_GetUserListAck) {\n\n            let users = allUsersResult.user.filter( function(user) {\n                return user.userStatus != \"deleted\" && user.userStatus != \"blocked\" && !user.superAdmin;\n            }).sort( function( a,b) { if (a.login<b.login) return -1; else return 1;});\n\n            // add to user select\n            $.each(users, function( userIdx,user) {\n                let name = (user.firstName?user.firstName:\"\") + \" \"+ (user.lastName?user.lastName:\"\");\n                name =  user.login + (name==\" \"?\"\":(\" - \")+name);\n\n                let opt:IDropdownOption =  {id:user.login, label:name, class:\"users\"};\n\n                dropdownOptions.push( opt );\n            });\n\n            restConnection.getServer(\"group\").done(function (allGroupsResult: XRGetGroup_AllGroups_GetGroupListAck) {\n\n                let groups = allGroupsResult.groups.sort( function( a,b) { if (a.groupName<b.groupName) return -1; else return 1;});\n\n                // add groups\n                $.each(groups, function( groupIdx,group) {\n                    let groupName = group.groupName;\n                    let groupId = that.getGroupId( group );\n                    let opt:IDropdownOption =  {id:groupId, label:groupName , class:\"groups\"};\n                    dropdownOptions.push( opt );\n                });\n\n                res.resolve( dropdownOptions );\n            });\n        });\n\n        return res;\n    }\n\n    showSingleSelectDialog( selected:string, title:string, help:string, showUsers:boolean, showGroups:boolean, onSelect:(selection:string) => void, preSelectedUsers?:XRUserPermissionType[] ) {\n        let that = this;\n\n        that.dlg = $(\"<div>\").appendTo(\"body\");\n\n        $('<span class=\"baseControlHelp\">' + help +'</span>').appendTo(that.dlg);\n        let ctrl = $(\"<div class='baseControl'>\").appendTo(that.dlg);\n        let input = $(\"<div class='form-control'>\").appendTo(ctrl);\n        this.showSingleSelect( input, showUsers, showGroups, (newSelection:string) => {\n            selected = newSelection;\n        }, preSelectedUsers, selected);\n\n        that.dlg.dialog({\n            autoOpen: true,\n            title: title?title:\"Select\",\n            width: 716,\n            height: 380,\n            resizeStop: function () {that.resize();},\n            modal: true,\n            open: function () {\n                ml.UI.pushDialog(that.dlg);\n\n            },\n            close: function () { ml.UI.popDialog(that.dlg); that.dlg.remove(); },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt',\n                click: function () {\n                    onSelect(selected);\n                    that.dlg.dialog(\"close\");\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    that.dlg.dialog(\"close\");\n                }\n            }]\n        });\n    }\n\n    private resize() {\n        let height = this.dlg.height();\n        let top = $(\".ms-list\", this.dlg).position().top;\n\n        $(\".ms-list\", this.dlg).height(height-top);\n    }\n\n}\n\n// TODO(modules): I don't think LT needs to be implemented in this file, it's a lower-level library.\n\n/** helper to escape < into non-dangerous &lt; */\nclass LT implements LT {\n    /** prepares the text for storage in db and readonly display\n     * @param code is the text\n     * @param fieldId (or 0/null) is the field which can have this turned off\n    */\n    forDB( code:string, fieldId:number ) {\n        let config = globalMatrix.ItemConfig ? globalMatrix.ItemConfig.getFieldConfig(fieldId) : null;\n        if (config && config.unsafeHtml) return code;\n        return (code && !matrixSession.isConfigClient()) ? code.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\") : code;\n    }\n    /** prepares the text for editing in UI\n     * @param code is the text\n     * @param fieldId (or 0/null) is the field which can have this turned off\n    */\n   forUI( code:string, fieldId:number ) {\n       let config = (fieldId && globalMatrix.ItemConfig) ? globalMatrix.ItemConfig.getFieldConfig(fieldId) : null;\n\n        if (config && config.unsafeHtml) {\n            return code;\n        }\n\n       if (code && !matrixSession.isConfigClient()) {\n            return code.replace( /&lt;/g, \"<\").replace( /&amp;/g, \"&\").replace( /&gt;/g, \">\");\n        } else {\n            return code;\n        }\n    }\n}\n","\nexport type { IThemes, IThemeSelector };\nexport { ThemeSelector };\n\ninterface IThemes {\n    [key: string]: string;\n}\n\ninterface IThemeSelector {\n    // properties\n    themeSelectorAdded:boolean;\n\n    // methods\n    loadTheme(themeName: string);\n    init();\n    renderThemeSelectorControl(help: string, table: JQuery);\n}\n\nclass ThemeSelector implements IThemeSelector {\n    public themeSelectorAdded: boolean;\n\n    constructor() {\n        let that = this;\n        this.currentCSS = \"\";\n        if( localStorage.getItem(\"currentCSS\") == undefined)\n        {\n            localStorage.setItem(\"currentCSS\", \"light\");\n        }\n\n\n        let inter = setInterval(() => {\n            if (! that.themeSelectorAdded ) {\n                that.themeSelectorAdded = true;\n                this.currentCSS =  localStorage.getItem(\"currentCSS\");\n                that.loadTheme(this.currentCSS);\n            }\n            else\n            {\n                if( this.themeSelectorAdded)\n                {\n                    clearInterval(inter);\n                }\n            }\n        }, 200);\n       \n    }\n\n    private currentCSS = \"\";\n\n    private injectCSS (cssFile:string)\n    {\n        var t = $(\"#themeCSS\")\n        let that = this;\n        if( cssFile != \"\")\n        {\n            console.log(\"Injecting the CSS \");\n            //Load external file\n           that.loadTheme(cssFile)\n\n        }\n        else\n        {\n            t.remove();\n        }\n\n        that.currentCSS = cssFile;\n        localStorage.setItem(\"currentCSS\",cssFile);   \n\n\n    }\n    private reloadCurrentCSS()\n    {\n        this.injectCSS(this.currentCSS);\n    }\n    \n\n\n    loadTheme(themeName:string)\n    {\n        $(\"#extraTheme\").remove();\n        let theme = $(\"<style id='extraTheme'>\");\n        theme.html(this.themes[themeName]);\n\n        $('body').append(theme);\n    }\n    init()\n    {\n\n    }\n    renderThemeSelectorControl(help:string,table:JQuery)\n    {\n        //This is saved in localstorage.\n\n        let tableBody  = $(\"tbody\",table);\n        tableBody.append($('<tr class=\"theme showInAdmin\" ><td colspan=\"2\" class=\"baseControlHelp\">Colors</td></tr'));\n\n        var tr = $(\"<tr  class='theme showInAdmin' >\");\n        tableBody.append(tr);\n\n        tr.append($(\"<td class='admin_utdl'>\").append($(\"<label class='control-label'>\").html(\"Theme\")));\n       \n\n        let that = this;\n        /*$(document).keydown(function(key){ if (key.ctrlKey && key.altKey && key.key == 'q' )\n        {\n            that.reloadCurrentCSS();\n        }})*/\n        tr.append($(\"<td>\").append(`<select  style=\"width: 100%;height: 34px;\" class=\"form-control\" id=\"themeSelectorCombo\">   \n                <option value=\"light\">Light</option>\n                <option value=\"dark\">Dark</option> \n           </select>`));\n        $(\"#themeSelectorCombo\").change((o)=>{ \n            var value = $( \"#themeSelectorCombo option:selected\" ).val();\n            this.injectCSS(value);\n        });\n        $(\"#themeSelectorCombo\").val(this.currentCSS );\n\n        tr.append($(\"<td>\").append(\"\"));\n    }\n    \n    private themes: IThemes = {\n\n        dark: `\n            .navbar-inverse{\n                background:black !important;\n            }\n            #idProject\n            {\n                color:white!important;\n            }\n            #projectNameTitleContainer:hover\n            {\n                color:lightgrey!important;\n            }\n           \n            .navbar-inverse .btn-success:hover\n            {\n                box-shadow: 2px 2px 2px 1px #ffffff80;\n\n            }\n                      `,\n        light: ``,\n    };\n\n}","/// <reference types=\"bootstrap\" />\nimport { GridStack } from \"./../../../js/vendor/gridstack_3.2.0/dist/gridstack\";\nimport { ml } from \"../common/matrixlib\";\nimport {LineEditorExt, ILineEditorLine, LineType} from \"../common/UI/ILineEditor\";\nimport { globalMatrix, matrixSession } from \"../globals\";\nimport { IDropdownOption } from \"../ProjectSettings\";\nimport { widgetPluginManager, IWidgetScope, IDisplayedWidget, renderMode } from \"./WidgetPluginManager\";\nimport { WidgetSettingsManager } from \"./WidgetSettingsManager\";\n\nexport type { IDashboard, IDashboardConfig, IWidgetPluginsContainer };\nexport { WidgetPluginsContainer };\nexport { WidgetPluginsConstants };\n\ninterface IDashboard {\n    displayString:string;\n    icon?:string,\n}\ninterface IDashboardConfig {\n    dashboards:{[key:string]:IDashboard}\n}\n\nclass WidgetPluginsConstants {\n    static defaultDashboardId: string =\"default\"  ; \n    static defaultDashboard: IDashboard = {displayString:\"home\"};\n}\n\ninterface IWidgetPluginsContainer {\n    visible: boolean;\n    previousUrl: string;\n    toggle();\n    addNewWidget();\n    render(dashboardId: string);\n    loadServerSettingWidgets(loadAllUser: boolean);\n    exit(destination: string);\n    hideWidget(id: string);\n    unhide(id: string);\n    deleteWidget(displayedWidget: IDisplayedWidget);\n    showUpdateShowHiddenButton();\n}\n\nclass WidgetPluginsContainer implements IWidgetPluginsContainer {\n    public visible: boolean;\n    private currentDashboard = WidgetPluginsConstants.defaultDashboardId;\n    public previousUrl: string;\n\n    toggle() {\n        if( !this.visible)\n        {\n            this.render(this.currentDashboard);\n        }\n        else\n        {\n            this.exit(this.previousUrl);\n        }\n    }\n    private _root: JQuery;\n    constructor()\n    {\n        \n\n    }\n    addNewWidget()\n    {\n        let that = this;\n            let editor = new LineEditorExt();\n\n            let lst:IDropdownOption[]  =[];\n            for(let key in  widgetPluginManager.pluginList)\n            {\n                let widget = widgetPluginManager.pluginList[key];\n                if (widget.defaultParameters().canBeAddedOrDeletedBy == IWidgetScope.superAdmin && !matrixSession.isSuperAdmin())\n                {\n                    continue;\n                }\n                if (widget.defaultParameters().canBeAddedOrDeletedBy == IWidgetScope.admin && !matrixSession.isAdmin())\n                {\n                    continue;\n                }\n\n                let display= (widget.help?? \"\" )+ \"   [\" + key + \"]\";\n                lst.push( {id:key,label:display });    \n            }\n\n            let defaultVal = lst.length> 0 ? lst[0].id : \"\";\n\n            let lines: ILineEditorLine[]= [\n                {help:'Type',type: LineType.select,required:true, value:defaultVal, options:lst },\n            ]\n            let editorTitle = \"Add a widget\"\n        if (matrixSession.isAdmin() && globalMatrix.globalShiftDown)\n            {\n                editorTitle = \"Add a widget for specific users\";\n                lines.push({help:'Add for other user?',type: LineType.boolean ,required:false, value:\"false\" });\n            }\n\n            let selectedPlugin: any;\n            let newWidget:IDisplayedWidget;\n            editor.showDialog(editorTitle ,400, lines,(updated)=>{\n               \n                selectedPlugin =  Object.create(window[updated[0].value].prototype);\n                selectedPlugin.constructor.apply();\n\n                let params = selectedPlugin.defaultParameters() ;\n                let selectedPluginIndex = updated[0].options.findIndex((i)=>{ return i.id == updated[0].value});;\n                params.options.title  = updated[0].options[selectedPluginIndex].label;\n                params.position.w =  2\n                params.position.h = 2\n                params.position.dashboard = this.currentDashboard;\n                \n                newWidget = { id: `widget_${updated[0].value}_${new Date().getTime().toString()}`, pluginName: updated[0].value, parameters: params, createdBy: matrixSession.getUser() };\n                \n                if(updated.length == 2 && updated[1].value != undefined && updated[1].value != \"\")\n                {\n                    newWidget.parameters.users = [\"*\"]\n                    newWidget.parameters.options.canBeHidden =  updated[1].value.toString() == \"true\" ;\n\n                }\n                WidgetSettingsManager.setSettings(newWidget);\n\n                let widget = that.grid.addWidget({w: Math.max(params.position.w,1) , h:Math.max(params.position.h,1),});\n\n                selectedPlugin.render(   $(\".grid-stack-item-content\",widget), newWidget, renderMode.placeholder);\n\n                widgetPluginManager.addLoadedWidget( newWidget.id, selectedPlugin);\n\n                return true;\n\n        }).done(()=>{\n            selectedPlugin.showWidgetSettingEditor(newWidget);\n        });\n\n    }\n    private grid: any;\n    render(dashboardId = WidgetPluginsConstants.defaultDashboardId)\n    {\n        let conf = matrixSession.getDashboardConfig();\n        if(conf.dashboards[dashboardId] ==null)\n        {\n            ml.UI.showError(\"Dashboard not found\",\"\");\n        }\n        let dashboard = conf.dashboards[dashboardId];\n\n\n        widgetPluginManager.unLoadAllWidgets();\n        $(\"#widgetDashboard\").remove();\n        $(\"#addWidget\").remove();\n        $(\".dashboardTitle\").remove();\n        $(\"#showHiddenWidgetButton\").remove();\n        this.previousUrl =  window.location.href ;\n\n        history.pushState(null, null, globalMatrix.matrixBaseUrl + \"/?dashboard=\" + dashboardId);\n\n        this.currentDashboard = dashboardId;\n        this.visible = true ;\n        let that = this;\n        $('#highlightContext').hide();\n        $(\"#contextframe\").hide();\n        $(\"#contextframesizer\").hide();\n\n        $(\"body\").append(`<div id='addWidget'><span class=\"fa-stack \">\n                            <i class=\"fal fa-sticky-note fa-stack-2x\"></i>\n                            <i class=\"fa fa-plus fa-stack\" style=\"\"></i>\n                        </span> </div> `);\n\n        this._root = $(\"<div id='widgetDashboard'> <div class='grid-stack'> </div></div>\");\n        this._root.insertAfter(\"header\");\n        $(\"#widgetDashboard\").prepend(ml.UI.getPageTitle(dashboard.displayString));\n        \n        var bClose = $(\"<div  class='btn-group btn-dashboard-close' ><button title data-original-title='Close' style='margin-right: -12px;' class='btn btn-item btn-fullscreen'> <span class='fal fa-times-circle'></span></button></div>\").click(function () {\n            that.exit(that.previousUrl);\n        });\n        $(\"#widgetDashboard .toolbarButtons\").append(bClose);\n\n        widgetPluginManager.unLoadAllWidgets();\n        \n        this.grid = GridStack.init();\n\n        let layout = 'none';\n    \n      let width = document.body.clientWidth;\n    \n      if (width < 800) {\n        that.grid.column(1, layout);\n      } else {\n        that.grid.column(12, layout);\n      }\n    \n        let i = 0 ;\n       \n       \n        matrixSession.serverConfig.currentUserSettings.forEach((userSetting) => {\n            if( userSetting.key.indexOf(\"widget_\")== 0 )\n            {\n                let w:IDisplayedWidget =  JSON.parse(userSetting.value);\n                \n                let plugin = widgetPluginManager.pluginList[w.pluginName];\n                \n                if(plugin &&  w.parameters.position.dashboard == this.currentDashboard)\n                {\n                    let  clonedPlugin  =  Object.create(window[w.pluginName].prototype);\n                    clonedPlugin.constructor.apply();\n                    w.parameters = plugin.mergeOptions(w.parameters);                    \n\n                        widgetPluginManager.addLoadedWidget( userSetting.key, clonedPlugin);\n                        let gridWidget = this.grid.addWidget({w:w.parameters.position.w , h:w.parameters.position.h, x: w.parameters.position.x, y:w.parameters.position.y});\n                        clonedPlugin.render($(\".grid-stack-item-content\",gridWidget), w ,renderMode.placeholder) ;\n                }\n                else\n                {\n                    console.log(\"Unknown plugin\");\n                }\n                   \n            }\n        }) ;\n\n    that.loadServerSettingWidgets();\n       \n       let hiddenWidget = WidgetSettingsManager.getHiddenWidgets()\n        hiddenWidget.forEach((w)=>{ \n            let p = widgetPluginManager.loadedWidgets[w] ;\n            if( p!= undefined)\n            {\n                p.hide(false);   \n            }\n        })\n\n        $(\"#addWidget\").click(()=>{\n            that.addNewWidget();\n        });\n        $(\"#addWidget\").hover(()=>{\n            \n            $(\"#addWidget\").tooltip(<TooltipOptions>{\n                title: matrixSession.isAdmin() ? \"Add a widget (use shift to add it for somebody else)\" : \"Add a widget\",\n                placement: \"auto\",\n                container: \"body\"\n            });\n            \n        });\n\n        this.showUpdateShowHiddenButton() ;\n\n        this.grid.on('change', function(event: Event, items: any[]) {\n            setTimeout(()=>{\n                if( window.innerWidth > 700)\n                {\n                    items.forEach(function(item) {\n                        let id = $(\".mWidget\",item.el).prop(\"id\")\n    \n                        let widget = widgetPluginManager.loadedWidgets[id]\n                        if(widget != undefined)\n                        {\n                            widget.updatePosition(item.w, item.h, item.x, item.y );\n                        }\n    \n                    });\n                }\n            }, 100); \n        });\n\n          this._root.prop(\"style\",\"\")\n\n    }\n    loadServerSettingWidgets(loadAllUser=false) {\n        matrixSession.serverConfig.customerSettings.forEach((setting) => {\n            if( setting.key.indexOf(\"widget_\")== 0 && widgetPluginManager.loadedWidgets[setting.key] ==undefined)\n            {\n                let w:IDisplayedWidget =  JSON.parse(setting.value);\n                let plugin = widgetPluginManager.pluginList[w.pluginName];\n                \n                \n                if(plugin && w.parameters.users != undefined && \n                    ((w.parameters.users.indexOf(\"*\") != -1 || w.parameters.users.indexOf(matrixSession.getUser()) != -1)\n                        || (loadAllUser && matrixSession.isAdmin())))\n                {\n\n                    // Check for position override\n                    let pos = localStorage.getItem(w.id);\n                    if(pos !=undefined && pos != \"\"){\n                        let position = JSON.parse(pos);\n                        w.parameters.position = position;\n                    }\n                    let  clonedPlugin  =  Object.create(window[w.pluginName].prototype);\n                    clonedPlugin.constructor.apply();\n                    w.parameters = plugin.mergeOptions(w.parameters);                    \n                    if(  w.parameters.position.dashboard == this.currentDashboard){\n                        widgetPluginManager.addLoadedWidget( setting.key, clonedPlugin);\n                        let gridWidget = this.grid.addWidget({ w: w.parameters.position.w, h: w.parameters.position.h, x: w.parameters.position.x, y: w.parameters.position.y, noMove: !matrixSession.isAdmin(), noResize: !matrixSession.isAdmin() });\n                        clonedPlugin.render($(\".grid-stack-item-content\",gridWidget), w ,renderMode.placeholder) ;\n                        \n                        if (matrixSession.isAdmin() && w.parameters.users && (w.parameters.users.indexOf(\"*\") == -1 && w.parameters.users.indexOf(matrixSession.getUser()) == -1))\n                        {\n                            $(\".grid-stack-item-content\",gridWidget).css(\"opacity\",0.4)\n                        }\n                        $(\".grid-stack-item-content\",gridWidget).addClass(\"widgetAddedByAdmin\");\n                     }\n\n                }\n                else\n                {\n                    console.log(\"Unknown plugin\");\n                }\n                   \n            }\n        })   \n\n    }\n    exit(destination:string)\n    {\n        this.visible = false; \n        if (destination == null || destination.indexOf(globalMatrix.matrixBaseUrl + \"/?dashboard=\") == 0)\n        {\n            if(localStorage.getItem(\"SessionLastProject\") != null)\n                window.location.href = globalMatrix.matrixBaseUrl + localStorage.getItem(\"SessionLastProject\");\n            else\n                window.location.href = globalMatrix.matrixBaseUrl \n        }\n        else\n        {\n            history.pushState(null,null, destination);\n\n            $('#highlightContext').show()\n            $(\"#contextframe\").show();\n            $(\"#contextframesizer\").show();\n            widgetPluginManager.unLoadAllWidgets();\n            $(\"#widgetDashboard\").remove();\n            $(\"#addWidget\").remove();\n            $(\"#showHiddenWidgetButton\").remove();\n            $(\".dashboardTitle\").remove();\n\n\n\n        }\n       \n    }\n    hideWidget(id: string) {\n        $(\".grid-stack-item:has(#\" + id + \")\").hide();\n        this.showUpdateShowHiddenButton();\n    }\n\n    unhide(id: string) {\n        $(\".grid-stack-item:has(#\" + id + \")\").show();\n        this.showUpdateShowHiddenButton();\n    }\n    deleteWidget(displayedWidget: IDisplayedWidget) {\n        WidgetSettingsManager.unhide(displayedWidget);\n        $(\".grid-stack-item:has(#\" + displayedWidget.id + \")\").remove();\n        this.showUpdateShowHiddenButton();\n    }\n    showUpdateShowHiddenButton() {\n        let that = this;\n        if(WidgetSettingsManager.getHiddenWidgets().length > 0)\n        {\n            if($('#showHiddenWidgetButton').length == 0 )\n            {\n                $(\"body\").append(`<div id='showHiddenWidgetButton'><span class=\"fa-stack \">\n                <i class=\"fal fa-eye-slash fa-stack-2x\"></i>\n                <i class=\"fal fa-toggle-on\" style=\"\"></i>\n                    </span> </div> `);\n                $(\"#showHiddenWidgetButton\").hover(()=>{\n            \n                    $(\"#showHiddenWidgetButton\").tooltip(<TooltipOptions>{\n                        title: \"Toggle hidden widget\",\n                        placement: \"top\",\n                        container: \"body\"\n                    });\n                });\n                $(\"#showHiddenWidgetButton\").click(()=>{\n                    if (globalMatrix.globalShiftDown)\n                    {\n                        that.loadServerSettingWidgets(true);\n                    }\n                    WidgetSettingsManager.getHiddenWidgets().forEach((widget)=>\n                    {\n                        $(\".grid-stack-item:has(#\"+ widget + \")\").toggle();\n                    })\n                });\n            }\n        }\n        else\n        {\n            $('#showHiddenWidgetButton').remove();\n        }\n      \n    }\n\n   \n    \n}\n\n","\"use strict\";\r\n// gridstack.ts 3.2.0 @preserve\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\nconst gridstack_engine_1 = require(\"./gridstack-engine\");\r\nconst utils_1 = require(\"./utils\");\r\nconst gridstack_ddi_1 = require(\"./gridstack-ddi\");\r\n__export(require(\"./utils\"));\r\n__export(require(\"./gridstack-engine\"));\r\n__export(require(\"./gridstack-ddi\"));\r\n// default values for grid options - used during init and when saving out\r\nconst GridDefaults = {\r\n    column: 12,\r\n    minRow: 0,\r\n    maxRow: 0,\r\n    itemClass: 'grid-stack-item',\r\n    placeholderClass: 'grid-stack-placeholder',\r\n    placeholderText: '',\r\n    handle: '.grid-stack-item-content',\r\n    handleClass: null,\r\n    styleInHead: false,\r\n    cellHeight: 'auto',\r\n    margin: 10,\r\n    auto: true,\r\n    minWidth: 768,\r\n    float: false,\r\n    staticGrid: false,\r\n    animate: true,\r\n    alwaysShowResizeHandle: false,\r\n    resizable: {\r\n        autoHide: true,\r\n        handles: 'se'\r\n    },\r\n    draggable: {\r\n        handle: '.grid-stack-item-content',\r\n        scroll: false,\r\n        appendTo: 'body'\r\n    },\r\n    dragIn: undefined,\r\n    dragInOptions: {\r\n        revert: 'invalid',\r\n        handle: '.grid-stack-item-content',\r\n        scroll: false,\r\n        appendTo: 'body'\r\n    },\r\n    disableDrag: false,\r\n    disableResize: false,\r\n    rtl: 'auto',\r\n    removable: false,\r\n    removableOptions: {\r\n        accept: '.grid-stack-item'\r\n    },\r\n    removeTimeout: 2000,\r\n    marginUnit: 'px',\r\n    cellHeightUnit: 'px',\r\n    disableOneColumnMode: false,\r\n    oneColumnModeDomSort: false\r\n};\r\n/**\r\n * Main gridstack class - you will need to call `GridStack.init()` first to initialize your grid.\r\n * Note: your grid elements MUST have the following classes for the CSS layout to work:\r\n * @example\r\n * <div class=\"grid-stack\">\r\n *   <div class=\"grid-stack-item\">\r\n *     <div class=\"grid-stack-item-content\">Item 1</div>\r\n *   </div>\r\n * </div>\r\n */\r\nclass GridStack {\r\n    /**\r\n     * Construct a grid item from the given element and options\r\n     * @param el\r\n     * @param opts\r\n     */\r\n    constructor(el, opts = {}) {\r\n        /** @internal */\r\n        this._gsEventHandler = {};\r\n        this.el = el; // exposed HTML element to the user\r\n        opts = opts || {}; // handles null/undefined/0\r\n        utils_1.obsoleteOpts(opts, 'verticalMargin', 'margin', 'v2.0');\r\n        utils_1.obsoleteAttr(this.el, 'data-gs-current-height', 'gs-current-row', 'v1.0.0');\r\n        // if row property exists, replace minRow and maxRow instead\r\n        if (opts.row) {\r\n            opts.minRow = opts.maxRow = opts.row;\r\n            delete opts.row;\r\n        }\r\n        let rowAttr = utils_1.Utils.toNumber(el.getAttribute('gs-row'));\r\n        // elements attributes override any passed options (like CSS style) - merge the two together\r\n        let defaults = Object.assign(Object.assign({}, GridDefaults), { column: utils_1.Utils.toNumber(el.getAttribute('gs-column')) || 12, minRow: rowAttr ? rowAttr : utils_1.Utils.toNumber(el.getAttribute('gs-min-row')) || 0, maxRow: rowAttr ? rowAttr : utils_1.Utils.toNumber(el.getAttribute('gs-max-row')) || 0, staticGrid: utils_1.Utils.toBool(el.getAttribute('gs-static')) || false, _styleSheetClass: 'grid-stack-instance-' + (Math.random() * 10000).toFixed(0), alwaysShowResizeHandle: opts.alwaysShowResizeHandle || false, resizable: {\r\n                autoHide: !(opts.alwaysShowResizeHandle || false),\r\n                handles: 'se'\r\n            }, draggable: {\r\n                handle: (opts.handleClass ? '.' + opts.handleClass : (opts.handle ? opts.handle : '')) || '.grid-stack-item-content',\r\n                scroll: false,\r\n                appendTo: 'body'\r\n            }, removableOptions: {\r\n                accept: '.' + (opts.itemClass || 'grid-stack-item')\r\n            } });\r\n        if (el.getAttribute('gs-animate')) { // default to true, but if set to false use that instead\r\n            defaults.animate = utils_1.Utils.toBool(el.getAttribute('gs-animate'));\r\n        }\r\n        this.opts = utils_1.Utils.defaults(opts, defaults);\r\n        opts = null; // make sure we use this.opts instead\r\n        this.initMargin();\r\n        if (this.opts.rtl === 'auto') {\r\n            this.opts.rtl = el.style.direction === 'rtl';\r\n        }\r\n        if (this.opts.rtl) {\r\n            this.el.classList.add('grid-stack-rtl');\r\n        }\r\n        // check if we're been nested, and if so update our style and keep pointer around (used during save)\r\n        let parentGridItemEl = utils_1.Utils.closestByClass(this.el, GridDefaults.itemClass);\r\n        if (parentGridItemEl && parentGridItemEl.gridstackNode) {\r\n            this.opts._isNested = parentGridItemEl.gridstackNode;\r\n            this.opts._isNested.subGrid = this;\r\n            this.el.classList.add('grid-stack-nested');\r\n        }\r\n        this._isAutoCellHeight = (this.opts.cellHeight === 'auto');\r\n        if (this._isAutoCellHeight) {\r\n            // make the cell content square initially (will use resize event to keep it square)\r\n            let marginDiff = -this.opts.marginRight - this.opts.marginLeft\r\n                + this.opts.marginTop + this.opts.marginBottom;\r\n            this.cellHeight(this.cellWidth() + marginDiff, false);\r\n        }\r\n        else {\r\n            this.cellHeight(this.opts.cellHeight, false);\r\n        }\r\n        this.el.classList.add(this.opts._styleSheetClass);\r\n        this._setStaticClass();\r\n        this.engine = new gridstack_engine_1.GridStackEngine({\r\n            column: this.opts.column,\r\n            float: this.opts.float,\r\n            maxRow: this.opts.maxRow,\r\n            onChange: (cbNodes, removeDOM = true) => {\r\n                let maxH = 0;\r\n                this.engine.nodes.forEach(n => { maxH = Math.max(maxH, n.y + n.h); });\r\n                cbNodes.forEach(n => {\r\n                    let el = n.el;\r\n                    if (removeDOM && n._id === null) {\r\n                        if (el && el.parentNode) {\r\n                            el.parentNode.removeChild(el);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this._writePosAttr(el, n.x, n.y, n.w, n.h);\r\n                    }\r\n                });\r\n                this._updateStyles(false, maxH); // false = don't recreate, just append if need be\r\n            }\r\n        });\r\n        if (this.opts.auto) {\r\n            this.batchUpdate(); // prevent in between re-layout #1535 TODO: this only set float=true, need to prevent collision check...\r\n            let elements = [];\r\n            this.getGridItems().forEach(el => {\r\n                let x = parseInt(el.getAttribute('gs-x'));\r\n                let y = parseInt(el.getAttribute('gs-y'));\r\n                elements.push({\r\n                    el,\r\n                    // if x,y are missing (autoPosition) add them to end of list - but keep their respective DOM order\r\n                    i: (Number.isNaN(x) ? 1000 : x) + (Number.isNaN(y) ? 1000 : y) * this.opts.column\r\n                });\r\n            });\r\n            elements.sort(e => e.i).forEach(e => this._prepareElement(e.el));\r\n            this.commit();\r\n        }\r\n        this.engine.saveInitial(); // initial start of items\r\n        this.setAnimation(this.opts.animate);\r\n        this._updateStyles();\r\n        if (this.opts.column != 12) {\r\n            this.el.classList.add('grid-stack-' + this.opts.column);\r\n        }\r\n        this._setupDragIn();\r\n        this._setupRemoveDrop();\r\n        this._setupAcceptWidget();\r\n        this._updateWindowResizeEvent(); // finally this may size us down to 1 column\r\n    }\r\n    /**\r\n     * initializing the HTML element, or selector string, into a grid will return the grid. Calling it again will\r\n     * simply return the existing instance (ignore any passed options). There is also an initAll() version that support\r\n     * multiple grids initialization at once. Or you can use addGrid() to create the entire grid from JSON.\r\n     * @param options grid options (optional)\r\n     * @param elOrString element or CSS selector (first one used) to convert to a grid (default to '.grid-stack' class selector)\r\n     *\r\n     * @example\r\n     * let grid = GridStack.init();\r\n     *\r\n     * Note: the HTMLElement (of type GridHTMLElement) will store a `gridstack: GridStack` value that can be retrieve later\r\n     * let grid = document.querySelector('.grid-stack').gridstack;\r\n     */\r\n    static init(options = {}, elOrString = '.grid-stack') {\r\n        let el = GridStack.getGridElement(elOrString);\r\n        if (!el) {\r\n            if (typeof elOrString === 'string') {\r\n                console.error('GridStack.initAll() no grid was found with selector \"' + elOrString + '\" - element missing or wrong selector ?' +\r\n                    '\\nNote: \".grid-stack\" is required for proper CSS styling and drag/drop, and is the default selector.');\r\n            }\r\n            else {\r\n                console.error('GridStack.init() no grid element was passed.');\r\n            }\r\n            return null;\r\n        }\r\n        if (!el.gridstack) {\r\n            el.gridstack = new GridStack(el, Object.assign({}, options));\r\n        }\r\n        return el.gridstack;\r\n    }\r\n    /**\r\n     * Will initialize a list of elements (given a selector) and return an array of grids.\r\n     * @param options grid options (optional)\r\n     * @param selector elements selector to convert to grids (default to '.grid-stack' class selector)\r\n     *\r\n     * @example\r\n     * let grids = GridStack.initAll();\r\n     * grids.forEach(...)\r\n     */\r\n    static initAll(options = {}, selector = '.grid-stack') {\r\n        let grids = [];\r\n        GridStack.getGridElements(selector).forEach(el => {\r\n            if (!el.gridstack) {\r\n                el.gridstack = new GridStack(el, Object.assign({}, options));\r\n            }\r\n            grids.push(el.gridstack);\r\n        });\r\n        if (grids.length === 0) {\r\n            console.error('GridStack.initAll() no grid was found with selector \"' + selector + '\" - element missing or wrong selector ?' +\r\n                '\\nNote: \".grid-stack\" is required for proper CSS styling and drag/drop, and is the default selector.');\r\n        }\r\n        return grids;\r\n    }\r\n    /**\r\n     * call to create a grid with the given options, including loading any children from JSON structure. This will call GridStack.init(), then\r\n     * grid.load() on any passed children (recursively). Great alternative to calling init() if you want entire grid to come from\r\n     * JSON serialized data, including options.\r\n     * @param parent HTML element parent to the grid\r\n     * @param opt grids options used to initialize the grid, and list of children\r\n     */\r\n    static addGrid(parent, opt = {}) {\r\n        if (!parent)\r\n            return null;\r\n        // create the grid element\r\n        let doc = document.implementation.createHTMLDocument();\r\n        doc.body.innerHTML = `<div class=\"grid-stack ${opt.class || ''}\"></div>`;\r\n        let el = doc.body.children[0];\r\n        parent.append(el);\r\n        // create grid class and load any children\r\n        let grid = GridStack.init(opt, el);\r\n        if (opt.children) {\r\n            grid.load(opt.children);\r\n        }\r\n        return grid;\r\n    }\r\n    /** @internal create placeholder DIV as needed */\r\n    get placeholder() {\r\n        if (!this._placeholder) {\r\n            let placeholderChild = document.createElement('div'); // child so padding match item-content\r\n            placeholderChild.className = 'placeholder-content';\r\n            if (this.opts.placeholderText) {\r\n                placeholderChild.innerHTML = this.opts.placeholderText;\r\n            }\r\n            this._placeholder = document.createElement('div');\r\n            this._placeholder.classList.add(this.opts.placeholderClass, GridDefaults.itemClass, this.opts.itemClass);\r\n            this.placeholder.appendChild(placeholderChild);\r\n        }\r\n        return this._placeholder;\r\n    }\r\n    /**\r\n     * add a new widget and returns it.\r\n     *\r\n     * Widget will be always placed even if result height is more than actual grid height.\r\n     * You need to use `willItFit()` before calling addWidget for additional check.\r\n     * See also `makeWidget()`.\r\n     *\r\n     * @example\r\n     * let grid = GridStack.init();\r\n     * grid.addWidget({w: 3, content: 'hello'});\r\n     * grid.addWidget('<div class=\"grid-stack-item\"><div class=\"grid-stack-item-content\">hello</div></div>', {w: 3});\r\n     *\r\n     * @param el  GridStackWidget (which can have content string as well), html element, or string definition to add\r\n     * @param options widget position/size options (optional, and ignore if first param is already option) - see GridStackWidget\r\n     */\r\n    addWidget(els, options) {\r\n        // support legacy call for now ?\r\n        if (arguments.length > 2) {\r\n            console.warn('gridstack.ts: `addWidget(el, x, y, width...)` is deprecated. Use `addWidget({x, y, w, content, ...})`. It will be removed soon');\r\n            // eslint-disable-next-line prefer-rest-params\r\n            let a = arguments, i = 1, opt = { x: a[i++], y: a[i++], w: a[i++], h: a[i++], autoPosition: a[i++],\r\n                minW: a[i++], maxW: a[i++], minH: a[i++], maxH: a[i++], id: a[i++] };\r\n            return this.addWidget(els, opt);\r\n        }\r\n        function isGridStackWidget(w) {\r\n            return w.x !== undefined || w.y !== undefined || w.w !== undefined || w.h !== undefined || w.content !== undefined ? true : false;\r\n        }\r\n        let el;\r\n        if (typeof els === 'string') {\r\n            let doc = document.implementation.createHTMLDocument();\r\n            doc.body.innerHTML = els;\r\n            el = doc.body.children[0];\r\n        }\r\n        else if (arguments.length === 0 || arguments.length === 1 && isGridStackWidget(els)) {\r\n            let content = els ? els.content || '' : '';\r\n            options = els;\r\n            let doc = document.implementation.createHTMLDocument();\r\n            doc.body.innerHTML = `<div class=\"grid-stack-item ${this.opts.itemClass || ''}\"><div class=\"grid-stack-item-content\">${content}</div></div>`;\r\n            el = doc.body.children[0];\r\n        }\r\n        else {\r\n            el = els;\r\n        }\r\n        // Tempting to initialize the passed in opt with default and valid values, but this break knockout demos\r\n        // as the actual value are filled in when _prepareElement() calls el.getAttribute('gs-xyz) before adding the node.\r\n        // So make sure we load any DOM attributes that are not specified in passed in options (which override)\r\n        let domAttr = this._readAttr(el);\r\n        options = Object.assign({}, (options || {})); // make a copy before we modify in case caller re-uses it\r\n        utils_1.Utils.defaults(options, domAttr);\r\n        this.engine.prepareNode(options);\r\n        this._writeAttr(el, options);\r\n        if (this._insertNotAppend) {\r\n            this.el.prepend(el);\r\n        }\r\n        else {\r\n            this.el.appendChild(el);\r\n        }\r\n        // similar to makeWidget() that doesn't read attr again and worse re-create a new node and loose any _id\r\n        this._prepareElement(el, true, options);\r\n        this._updateContainerHeight();\r\n        this._triggerAddEvent();\r\n        this._triggerChangeEvent();\r\n        return el;\r\n    }\r\n    /**\r\n     * saves the current layout returning a list of widgets for serialization (with default to save content), which might include any nested grids.\r\n     * Optionally you can also save the grid with options itself, so you can call the new GridStack.addGrid()\r\n     * to recreate everything from scratch. GridStackOptions.children would then contain the widget list.\r\n     */\r\n    save(saveContent = true, saveGridOpt = false) {\r\n        // return copied nodes we can modify at will...\r\n        let list = this.engine.save(saveContent);\r\n        // check for HTML content as well\r\n        if (saveContent) {\r\n            list.forEach(n => {\r\n                if (n.el && !n.subGrid) { // sub-grid are saved differently, not plain content\r\n                    let sub = n.el.querySelector('.grid-stack-item-content');\r\n                    n.content = sub ? sub.innerHTML : undefined;\r\n                    if (!n.content)\r\n                        delete n.content;\r\n                    delete n.el;\r\n                }\r\n            });\r\n        }\r\n        // check if save entire grid options (needed for recursive) + children...\r\n        if (saveGridOpt) {\r\n            // check for nested grid\r\n            list.forEach(n => {\r\n                if (n.subGrid) {\r\n                    n.subGrid = n.subGrid.save(saveContent, saveGridOpt);\r\n                }\r\n            });\r\n            let o = Object.assign({}, this.opts);\r\n            // delete default values that will be recreated on launch\r\n            if (o.marginBottom === o.marginTop && o.marginRight === o.marginLeft && o.marginTop === o.marginRight) {\r\n                o.margin = o.marginTop;\r\n                delete o.marginTop;\r\n                delete o.marginRight;\r\n                delete o.marginBottom;\r\n                delete o.marginLeft;\r\n            }\r\n            if (o.rtl === (this.el.style.direction === 'rtl')) {\r\n                o.rtl = 'auto';\r\n            }\r\n            if (this._isAutoCellHeight) {\r\n                o.cellHeight = 'auto';\r\n            }\r\n            utils_1.Utils.removeInternalAndSame(o, GridDefaults);\r\n            o.children = list;\r\n            return o;\r\n        }\r\n        return list;\r\n    }\r\n    /**\r\n     * load the widgets from a list. This will call update() on each (matching by id) or add/remove widgets that are not there.\r\n     *\r\n     * @param layout list of widgets definition to update/create\r\n     * @param addAndRemove boolean (default true) or callback method can be passed to control if and how missing widgets can be added/removed, giving\r\n     * the user control of insertion.\r\n     *\r\n     * @example\r\n     * see http://gridstackjs.com/demo/serialization.html\r\n     **/\r\n    load(layout, addAndRemove = true) {\r\n        let items = GridStack.Utils.sort(layout, -1, this._prevColumn || this.opts.column);\r\n        this._insertNotAppend = true; // since create in reverse order...\r\n        // if we're loading a layout into 1 column (_prevColumn is set only when going to 1) and items don't fit, make sure to save\r\n        // the original wanted layout so we can scale back up correctly #1471\r\n        if (this._prevColumn && this._prevColumn !== this.opts.column && items.some(n => (n.x + n.w) > this.opts.column)) {\r\n            this._ignoreLayoutsNodeChange = true; // skip layout update\r\n            this.engine.cacheLayout(items, this._prevColumn, true);\r\n        }\r\n        let removed = [];\r\n        this.batchUpdate();\r\n        // see if any items are missing from new layout and need to be removed first\r\n        if (addAndRemove) {\r\n            let copyNodes = [...this.engine.nodes]; // don't loop through array you modify\r\n            copyNodes.forEach(n => {\r\n                let item = items.find(w => n.id === w.id);\r\n                if (!item) {\r\n                    if (typeof (addAndRemove) === 'function') {\r\n                        addAndRemove(this, n, false);\r\n                    }\r\n                    else {\r\n                        removed.push(n); // batch keep track\r\n                        this.removeWidget(n.el, true, false);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        // now add/update the widgets\r\n        items.forEach(w => {\r\n            let item = (w.id || w.id === 0) ? this.engine.nodes.find(n => n.id === w.id) : undefined;\r\n            if (item) {\r\n                this.update(item.el, w);\r\n                if (w.subGrid && w.subGrid.children) { // update any sub grid as well\r\n                    let sub = item.el.querySelector('.grid-stack');\r\n                    if (sub && sub.gridstack) {\r\n                        sub.gridstack.load(w.subGrid.children); // TODO: support updating grid options ?\r\n                        this._insertNotAppend = true; // got reset by above call\r\n                    }\r\n                }\r\n            }\r\n            else if (addAndRemove) {\r\n                if (typeof (addAndRemove) === 'function') {\r\n                    w = addAndRemove(this, w, true).gridstackNode;\r\n                }\r\n                else {\r\n                    w = this.addWidget(w).gridstackNode;\r\n                }\r\n                if (w.subGrid) { // see if there is a sub-grid to create too\r\n                    let content = w.el.querySelector('.grid-stack-item-content');\r\n                    w.subGrid = GridStack.addGrid(content, w.subGrid);\r\n                }\r\n            }\r\n        });\r\n        this.engine.removedNodes = removed;\r\n        this.commit();\r\n        // after commit, clear that flag\r\n        delete this._ignoreLayoutsNodeChange;\r\n        delete this._insertNotAppend;\r\n        return this;\r\n    }\r\n    /**\r\n     * Initializes batch updates. You will see no changes until `commit()` method is called.\r\n     */\r\n    batchUpdate() {\r\n        this.engine.batchUpdate();\r\n        return this;\r\n    }\r\n    /**\r\n     * Gets current cell height.\r\n     */\r\n    getCellHeight(forcePixel = false) {\r\n        if (this.opts.cellHeight && this.opts.cellHeight !== 'auto' &&\r\n            (!forcePixel || !this.opts.cellHeightUnit || this.opts.cellHeightUnit === 'px')) {\r\n            return this.opts.cellHeight;\r\n        }\r\n        // else get first cell height\r\n        // or do entire grid and # of rows ? (this.el.getBoundingClientRect().height) / parseInt(this.el.getAttribute('gs-current-row'))\r\n        let el = this.el.querySelector('.' + this.opts.itemClass);\r\n        let height = utils_1.Utils.toNumber(el.getAttribute('gs-h'));\r\n        return Math.round(el.offsetHeight / height);\r\n    }\r\n    /**\r\n     * Update current cell height - see `GridStackOptions.cellHeight` for format.\r\n     * This method rebuilds an internal CSS style sheet.\r\n     * Note: You can expect performance issues if call this method too often.\r\n     *\r\n     * @param val the cell height\r\n     * @param update (Optional) if false, styles will not be updated\r\n     *\r\n     * @example\r\n     * grid.cellHeight(grid.cellWidth() * 1.2);\r\n     */\r\n    cellHeight(val, update = true) {\r\n        let data = utils_1.Utils.parseHeight(val);\r\n        if (this.opts.cellHeightUnit === data.unit && this.opts.cellHeight === data.h) {\r\n            return this;\r\n        }\r\n        this.opts.cellHeightUnit = data.unit;\r\n        this.opts.cellHeight = data.h;\r\n        if (update) {\r\n            this._updateStyles(true, this.getRow()); // true = force re-create, for that # of rows\r\n        }\r\n        this._resizeNestedGrids(this.el);\r\n        return this;\r\n    }\r\n    /**\r\n     * Gets current cell width.\r\n     */\r\n    cellWidth() {\r\n        // use parent width if we're 0 (no size yet)\r\n        return (this.el.offsetWidth || this.el.parentElement.offsetWidth || window.innerWidth) / this.opts.column;\r\n    }\r\n    /**\r\n     * Finishes batch updates. Updates DOM nodes. You must call it after batchUpdate.\r\n     */\r\n    commit() {\r\n        this.engine.commit();\r\n        this._triggerRemoveEvent();\r\n        this._triggerAddEvent();\r\n        this._triggerChangeEvent();\r\n        return this;\r\n    }\r\n    /** re-layout grid items to reclaim any empty space */\r\n    compact() {\r\n        this.engine.compact();\r\n        this._triggerChangeEvent();\r\n        return this;\r\n    }\r\n    /**\r\n     * set the number of columns in the grid. Will update existing widgets to conform to new number of columns,\r\n     * as well as cache the original layout so you can revert back to previous positions without loss.\r\n     * Requires `gridstack-extra.css` or `gridstack-extra.min.css` for [2-11],\r\n     * else you will need to generate correct CSS (see https://github.com/gridstack/gridstack.js#change-grid-columns)\r\n     * @param column - Integer > 0 (default 12).\r\n     * @param layout specify the type of re-layout that will happen (position, size, etc...).\r\n     * Note: items will never be outside of the current column boundaries. default (moveScale). Ignored for 1 column\r\n     */\r\n    column(column, layout = 'moveScale') {\r\n        if (this.opts.column === column)\r\n            return this;\r\n        let oldColumn = this.opts.column;\r\n        // if we go into 1 column mode (which happens if we're sized less than minW unless disableOneColumnMode is on)\r\n        // then remember the original columns so we can restore.\r\n        if (column === 1) {\r\n            this._prevColumn = oldColumn;\r\n        }\r\n        else {\r\n            delete this._prevColumn;\r\n        }\r\n        this.el.classList.remove('grid-stack-' + oldColumn);\r\n        this.el.classList.add('grid-stack-' + column);\r\n        this.opts.column = this.engine.column = column;\r\n        // update the items now - see if the dom order nodes should be passed instead (else default to current list)\r\n        let domNodes;\r\n        if (column === 1 && this.opts.oneColumnModeDomSort) {\r\n            domNodes = [];\r\n            this.getGridItems().forEach(el => {\r\n                if (el.gridstackNode) {\r\n                    domNodes.push(el.gridstackNode);\r\n                }\r\n            });\r\n            if (!domNodes.length) {\r\n                domNodes = undefined;\r\n            }\r\n        }\r\n        this.engine.updateNodeWidths(oldColumn, column, domNodes, layout);\r\n        // and trigger our event last...\r\n        this._ignoreLayoutsNodeChange = true; // skip layout update\r\n        this._triggerChangeEvent();\r\n        delete this._ignoreLayoutsNodeChange;\r\n        return this;\r\n    }\r\n    /**\r\n     * get the number of columns in the grid (default 12)\r\n     */\r\n    getColumn() {\r\n        return this.opts.column;\r\n    }\r\n    /** returns an array of grid HTML elements (no placeholder) - used to iterate through our children */\r\n    getGridItems() {\r\n        return Array.from(this.el.children)\r\n            .filter((el) => el.matches('.' + this.opts.itemClass) && !el.matches('.' + this.opts.placeholderClass));\r\n    }\r\n    /**\r\n     * Destroys a grid instance. DO NOT CALL any methods or access any vars after this as it will free up members.\r\n     * @param removeDOM if `false` grid and items HTML elements will not be removed from the DOM (Optional. Default `true`).\r\n     */\r\n    destroy(removeDOM = true) {\r\n        if (!this.el)\r\n            return; // prevent multiple calls\r\n        this._updateWindowResizeEvent(true);\r\n        this.setStatic(true); // permanently removes DD\r\n        if (!removeDOM) {\r\n            this.removeAll(removeDOM);\r\n            this.el.classList.remove(this.opts._styleSheetClass);\r\n        }\r\n        else {\r\n            this.el.parentNode.removeChild(this.el);\r\n        }\r\n        this._removeStylesheet();\r\n        delete this.opts._isNested;\r\n        delete this.opts;\r\n        delete this._placeholder;\r\n        delete this.engine;\r\n        delete this.el.gridstack; // remove circular dependency that would prevent a freeing\r\n        delete this.el;\r\n        return this;\r\n    }\r\n    /**\r\n     * enable/disable floating widgets (default: `false`) See [example](http://gridstackjs.com/demo/float.html)\r\n     */\r\n    float(val) {\r\n        this.engine.float = val;\r\n        this._triggerChangeEvent();\r\n        return this;\r\n    }\r\n    /**\r\n     * get the current float mode\r\n     */\r\n    getFloat() {\r\n        return this.engine.float;\r\n    }\r\n    /**\r\n     * Get the position of the cell under a pixel on screen.\r\n     * @param position the position of the pixel to resolve in\r\n     * absolute coordinates, as an object with top and left properties\r\n     * @param useDocRelative if true, value will be based on document position vs parent position (Optional. Default false).\r\n     * Useful when grid is within `position: relative` element\r\n     *\r\n     * Returns an object with properties `x` and `y` i.e. the column and row in the grid.\r\n     */\r\n    getCellFromPixel(position, useDocRelative = false) {\r\n        let box = this.el.getBoundingClientRect();\r\n        // console.log(`getBoundingClientRect left: ${box.left} top: ${box.top} w: ${box.w} h: ${box.h}`)\r\n        let containerPos;\r\n        if (useDocRelative) {\r\n            containerPos = { top: box.top + document.documentElement.scrollTop, left: box.left };\r\n            // console.log(`getCellFromPixel scrollTop: ${document.documentElement.scrollTop}`)\r\n        }\r\n        else {\r\n            containerPos = { top: this.el.offsetTop, left: this.el.offsetLeft };\r\n            // console.log(`getCellFromPixel offsetTop: ${containerPos.left} offsetLeft: ${containerPos.top}`)\r\n        }\r\n        let relativeLeft = position.left - containerPos.left;\r\n        let relativeTop = position.top - containerPos.top;\r\n        let columnWidth = (box.width / this.opts.column);\r\n        let rowHeight = (box.height / parseInt(this.el.getAttribute('gs-current-row')));\r\n        return { x: Math.floor(relativeLeft / columnWidth), y: Math.floor(relativeTop / rowHeight) };\r\n    }\r\n    /** returns the current number of rows, which will be at least `minRow` if set */\r\n    getRow() {\r\n        return Math.max(this.engine.getRow(), this.opts.minRow);\r\n    }\r\n    /**\r\n     * Checks if specified area is empty.\r\n     * @param x the position x.\r\n     * @param y the position y.\r\n     * @param w the width of to check\r\n     * @param h the height of to check\r\n     */\r\n    isAreaEmpty(x, y, w, h) {\r\n        return this.engine.isAreaEmpty(x, y, w, h);\r\n    }\r\n    /**\r\n     * If you add elements to your grid by hand, you have to tell gridstack afterwards to make them widgets.\r\n     * If you want gridstack to add the elements for you, use `addWidget()` instead.\r\n     * Makes the given element a widget and returns it.\r\n     * @param els widget or single selector to convert.\r\n     *\r\n     * @example\r\n     * let grid = GridStack.init();\r\n     * grid.el.appendChild('<div id=\"gsi-1\" gs-w=\"3\"></div>');\r\n     * grid.makeWidget('#gsi-1');\r\n     */\r\n    makeWidget(els) {\r\n        let el = GridStack.getElement(els);\r\n        this._prepareElement(el, true);\r\n        this._updateContainerHeight();\r\n        this._triggerAddEvent();\r\n        this._triggerChangeEvent();\r\n        return el;\r\n    }\r\n    /**\r\n     * Event handler that extracts our CustomEvent data out automatically for receiving custom\r\n     * notifications (see doc for supported events)\r\n     * @param name of the event (see possible values) or list of names space separated\r\n     * @param callback function called with event and optional second/third param\r\n     * (see README documentation for each signature).\r\n     *\r\n     * @example\r\n     * grid.on('added', function(e, items) { log('added ', items)} );\r\n     * or\r\n     * grid.on('added removed change', function(e, items) { log(e.type, items)} );\r\n     *\r\n     * Note: in some cases it is the same as calling native handler and parsing the event.\r\n     * grid.el.addEventListener('added', function(event) { log('added ', event.detail)} );\r\n     *\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    on(name, callback) {\r\n        // check for array of names being passed instead\r\n        if (name.indexOf(' ') !== -1) {\r\n            let names = name.split(' ');\r\n            names.forEach(name => this.on(name, callback));\r\n            return this;\r\n        }\r\n        if (name === 'change' || name === 'added' || name === 'removed' || name === 'enable' || name === 'disable') {\r\n            // native CustomEvent handlers - cash the generic handlers so we can easily remove\r\n            let noData = (name === 'enable' || name === 'disable');\r\n            if (noData) {\r\n                this._gsEventHandler[name] = (event) => callback(event);\r\n            }\r\n            else {\r\n                this._gsEventHandler[name] = (event) => callback(event, event.detail);\r\n            }\r\n            this.el.addEventListener(name, this._gsEventHandler[name]);\r\n        }\r\n        else if (name === 'dragstart' || name === 'dragstop' || name === 'resizestart' || name === 'resizestop' || name === 'dropped') {\r\n            // drag&drop stop events NEED to be call them AFTER we update node attributes so handle them ourself.\r\n            // do same for start event to make it easier...\r\n            this._gsEventHandler[name] = callback;\r\n        }\r\n        else {\r\n            console.log('GridStack.on(' + name + ') event not supported, but you can still use $(\".grid-stack\").on(...) while jquery-ui is still used internally.');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * unsubscribe from the 'on' event below\r\n     * @param name of the event (see possible values)\r\n     */\r\n    off(name) {\r\n        // check for array of names being passed instead\r\n        if (name.indexOf(' ') !== -1) {\r\n            let names = name.split(' ');\r\n            names.forEach(name => this.off(name));\r\n            return this;\r\n        }\r\n        if (name === 'change' || name === 'added' || name === 'removed' || name === 'enable' || name === 'disable') {\r\n            // remove native CustomEvent handlers\r\n            if (this._gsEventHandler[name]) {\r\n                this.el.removeEventListener(name, this._gsEventHandler[name]);\r\n            }\r\n        }\r\n        delete this._gsEventHandler[name];\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes widget from the grid.\r\n     * @param el  widget or selector to modify\r\n     * @param removeDOM if `false` DOM element won't be removed from the tree (Default? true).\r\n     * @param triggerEvent if `false` (quiet mode) element will not be added to removed list and no 'removed' callbacks will be called (Default? true).\r\n     */\r\n    removeWidget(els, removeDOM = true, triggerEvent = true) {\r\n        GridStack.getElements(els).forEach(el => {\r\n            if (el.parentElement !== this.el)\r\n                return; // not our child!\r\n            let node = el.gridstackNode;\r\n            // For Meteor support: https://github.com/gridstack/gridstack.js/pull/272\r\n            if (!node) {\r\n                node = this.engine.nodes.find(n => el === n.el);\r\n            }\r\n            if (!node)\r\n                return;\r\n            // remove our DOM data (circular link) and drag&drop permanently\r\n            delete el.gridstackNode;\r\n            gridstack_ddi_1.GridStackDDI.get().remove(el);\r\n            this.engine.removeNode(node, removeDOM, triggerEvent);\r\n            if (removeDOM && el.parentElement) {\r\n                el.remove(); // in batch mode engine.removeNode doesn't call back to remove DOM\r\n            }\r\n        });\r\n        if (triggerEvent) {\r\n            this._triggerRemoveEvent();\r\n            this._triggerChangeEvent();\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes all widgets from the grid.\r\n     * @param removeDOM if `false` DOM elements won't be removed from the tree (Default? `true`).\r\n     */\r\n    removeAll(removeDOM = true) {\r\n        // always remove our DOM data (circular link) before list gets emptied and drag&drop permanently\r\n        this.engine.nodes.forEach(n => {\r\n            delete n.el.gridstackNode;\r\n            gridstack_ddi_1.GridStackDDI.get().remove(n.el);\r\n        });\r\n        this.engine.removeAll(removeDOM);\r\n        this._triggerRemoveEvent();\r\n        return this;\r\n    }\r\n    /**\r\n     * Toggle the grid animation state.  Toggles the `grid-stack-animate` class.\r\n     * @param doAnimate if true the grid will animate.\r\n     */\r\n    setAnimation(doAnimate) {\r\n        if (doAnimate) {\r\n            this.el.classList.add('grid-stack-animate');\r\n        }\r\n        else {\r\n            this.el.classList.remove('grid-stack-animate');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Toggle the grid static state, which permanently removes/add Drag&Drop support, unlike disable()/enable() that just turns it off/on.\r\n     * Also toggle the grid-stack-static class.\r\n     * @param val if true the grid become static.\r\n     */\r\n    setStatic(val) {\r\n        if (this.opts.staticGrid === val)\r\n            return this;\r\n        this.opts.staticGrid = val;\r\n        this.engine.nodes.forEach(n => this._prepareDragDropByNode(n)); // either delete Drag&drop or initialize it\r\n        this._setStaticClass();\r\n        return this;\r\n    }\r\n    /**\r\n     * Updates widget position/size and other info. Note: if you need to call this on all nodes, use load() instead which will update what changed.\r\n     * @param els  widget or selector of objects to modify (note: setting the same x,y for multiple items will be indeterministic and likely unwanted)\r\n     * @param opt new widget options (x,y,w,h, etc..). Only those set will be updated.\r\n     */\r\n    update(els, opt) {\r\n        // support legacy call for now ?\r\n        if (arguments.length > 2) {\r\n            console.warn('gridstack.ts: `update(el, x, y, w, h)` is deprecated. Use `update({x, w, content, ...})`. It will be removed soon');\r\n            // eslint-disable-next-line prefer-rest-params\r\n            let a = arguments, i = 1;\r\n            opt = { x: a[i++], y: a[i++], w: a[i++], h: a[i++] };\r\n            return this.update(els, opt);\r\n        }\r\n        GridStack.getElements(els).forEach(el => {\r\n            if (!el || !el.gridstackNode)\r\n                return;\r\n            let n = el.gridstackNode;\r\n            let w = Object.assign({}, opt); // make a copy we can modify in case they re-use it or multiple items\r\n            delete w.autoPosition;\r\n            // move/resize widget if anything changed\r\n            let keys = ['x', 'y', 'w', 'h'];\r\n            let m;\r\n            if (keys.some(k => w[k] !== undefined && w[k] !== n[k])) {\r\n                m = {};\r\n                keys.forEach(k => {\r\n                    m[k] = (w[k] !== undefined) ? w[k] : n[k];\r\n                    delete w[k];\r\n                });\r\n            }\r\n            // for a move as well IFF there is any min/max fields set\r\n            if (!m && (w.minW || w.minH || w.maxW || w.maxH)) {\r\n                m = {}; // will use node position but validate values\r\n            }\r\n            // check for content changing\r\n            if (w.content) {\r\n                let sub = el.querySelector('.grid-stack-item-content');\r\n                if (sub && sub.innerHTML !== w.content) {\r\n                    sub.innerHTML = w.content;\r\n                }\r\n                delete w.content;\r\n            }\r\n            // any remaining fields are assigned, but check for dragging changes, resize constrain\r\n            let changed = false;\r\n            let ddChanged = false;\r\n            for (const key in w) {\r\n                if (key[0] !== '_' && n[key] !== w[key]) {\r\n                    n[key] = w[key];\r\n                    changed = true;\r\n                    ddChanged = ddChanged || (!this.opts.staticGrid && (key === 'noResize' || key === 'noMove' || key === 'locked'));\r\n                }\r\n            }\r\n            // finally move the widget\r\n            if (m) {\r\n                this.engine.cleanNodes();\r\n                this.engine.beginUpdate(n);\r\n                this.engine.moveNode(n, m.x, m.y, m.w, m.h);\r\n                this._updateContainerHeight();\r\n                this._triggerChangeEvent();\r\n                this.engine.endUpdate();\r\n            }\r\n            if (changed) { // move will only update x,y,w,h so update the rest too\r\n                this._writeAttr(el, n);\r\n            }\r\n            if (ddChanged) {\r\n                this._prepareDragDropByNode(n);\r\n            }\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * Updates the margins which will set all 4 sides at once - see `GridStackOptions.margin` for format options (CSS string format of 1,2,4 values or single number).\r\n     * @param value margin value\r\n     */\r\n    margin(value) {\r\n        let isMultiValue = (typeof value === 'string' && value.split(' ').length > 1);\r\n        // check if we can skip re-creating our CSS file... won't check if multi values (too much hassle)\r\n        if (!isMultiValue) {\r\n            let data = utils_1.Utils.parseHeight(value);\r\n            if (this.opts.marginUnit === data.unit && this.opts.margin === data.h)\r\n                return;\r\n        }\r\n        // re-use existing margin handling\r\n        this.opts.margin = value;\r\n        this.opts.marginTop = this.opts.marginBottom = this.opts.marginLeft = this.opts.marginRight = undefined;\r\n        this.initMargin();\r\n        this._updateStyles(true); // true = force re-create\r\n        return this;\r\n    }\r\n    /** returns current margin number value (undefined if 4 sides don't match) */\r\n    getMargin() { return this.opts.margin; }\r\n    /**\r\n     * Returns true if the height of the grid will be less than the vertical\r\n     * constraint. Always returns true if grid doesn't have height constraint.\r\n     * @param node contains x,y,w,h,auto-position options\r\n     *\r\n     * @example\r\n     * if (grid.willItFit(newWidget)) {\r\n     *   grid.addWidget(newWidget);\r\n     * } else {\r\n     *   alert('Not enough free space to place the widget');\r\n     * }\r\n     */\r\n    willItFit(node) {\r\n        // support legacy call for now\r\n        if (arguments.length > 1) {\r\n            console.warn('gridstack.ts: `willItFit(x,y,w,h,autoPosition)` is deprecated. Use `willItFit({x, y,...})`. It will be removed soon');\r\n            // eslint-disable-next-line prefer-rest-params\r\n            let a = arguments, i = 0, w = { x: a[i++], y: a[i++], w: a[i++], h: a[i++], autoPosition: a[i++] };\r\n            return this.willItFit(w);\r\n        }\r\n        return this.engine.willItFit(node);\r\n    }\r\n    /** @internal */\r\n    _triggerChangeEvent() {\r\n        if (this.engine.batchMode)\r\n            return this;\r\n        let elements = this.engine.getDirtyNodes(true); // verify they really changed\r\n        if (elements && elements.length) {\r\n            if (!this._ignoreLayoutsNodeChange) {\r\n                this.engine.layoutsNodesChange(elements);\r\n            }\r\n            this._triggerEvent('change', elements);\r\n        }\r\n        this.engine.saveInitial(); // we called, now reset initial values & dirty flags\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _triggerAddEvent() {\r\n        if (this.engine.batchMode)\r\n            return this;\r\n        if (this.engine.addedNodes && this.engine.addedNodes.length > 0) {\r\n            if (!this._ignoreLayoutsNodeChange) {\r\n                this.engine.layoutsNodesChange(this.engine.addedNodes);\r\n            }\r\n            // prevent added nodes from also triggering 'change' event (which is called next)\r\n            this.engine.addedNodes.forEach(n => { delete n._dirty; });\r\n            this._triggerEvent('added', this.engine.addedNodes);\r\n            this.engine.addedNodes = [];\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _triggerRemoveEvent() {\r\n        if (this.engine.batchMode)\r\n            return this;\r\n        if (this.engine.removedNodes && this.engine.removedNodes.length > 0) {\r\n            this._triggerEvent('removed', this.engine.removedNodes);\r\n            this.engine.removedNodes = [];\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _triggerEvent(name, data) {\r\n        let event = data ? new CustomEvent(name, { bubbles: false, detail: data }) : new Event(name);\r\n        this.el.dispatchEvent(event);\r\n        return this;\r\n    }\r\n    /** @internal called to delete the current dynamic style sheet used for our layout */\r\n    _removeStylesheet() {\r\n        if (this._styles) {\r\n            utils_1.Utils.removeStylesheet(this._styles._id);\r\n            delete this._styles;\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal updated/create the CSS styles for row based layout and initial margin setting */\r\n    _updateStyles(forceUpdate = false, maxH) {\r\n        // call to delete existing one if we change cellHeight / margin\r\n        if (forceUpdate) {\r\n            this._removeStylesheet();\r\n        }\r\n        this._updateContainerHeight();\r\n        // if user is telling us they will handle the CSS themselves by setting heights to 0. Do we need this opts really ??\r\n        if (this.opts.cellHeight === 0) {\r\n            return this;\r\n        }\r\n        let cellHeight = this.opts.cellHeight;\r\n        let cellHeightUnit = this.opts.cellHeightUnit;\r\n        let prefix = `.${this.opts._styleSheetClass} > .${this.opts.itemClass}`;\r\n        // create one as needed\r\n        if (!this._styles) {\r\n            let id = 'gridstack-style-' + (Math.random() * 100000).toFixed();\r\n            // insert style to parent (instead of 'head' by default) to support WebComponent\r\n            let styleLocation = this.opts.styleInHead ? undefined : this.el.parentNode;\r\n            this._styles = utils_1.Utils.createStylesheet(id, styleLocation);\r\n            if (!this._styles)\r\n                return this;\r\n            this._styles._id = id;\r\n            this._styles._max = 0;\r\n            // these are done once only\r\n            utils_1.Utils.addCSSRule(this._styles, prefix, `min-height: ${cellHeight}${cellHeightUnit}`);\r\n            // content margins\r\n            let top = this.opts.marginTop + this.opts.marginUnit;\r\n            let bottom = this.opts.marginBottom + this.opts.marginUnit;\r\n            let right = this.opts.marginRight + this.opts.marginUnit;\r\n            let left = this.opts.marginLeft + this.opts.marginUnit;\r\n            let content = `${prefix} > .grid-stack-item-content`;\r\n            let placeholder = `.${this.opts._styleSheetClass} > .grid-stack-placeholder > .placeholder-content`;\r\n            utils_1.Utils.addCSSRule(this._styles, content, `top: ${top}; right: ${right}; bottom: ${bottom}; left: ${left};`);\r\n            utils_1.Utils.addCSSRule(this._styles, placeholder, `top: ${top}; right: ${right}; bottom: ${bottom}; left: ${left};`);\r\n            // resize handles offset (to match margin)\r\n            utils_1.Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-ne`, `right: ${right}`);\r\n            utils_1.Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-e`, `right: ${right}`);\r\n            utils_1.Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-se`, `right: ${right}; bottom: ${bottom}`);\r\n            utils_1.Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-nw`, `left: ${left}`);\r\n            utils_1.Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-w`, `left: ${left}`);\r\n            utils_1.Utils.addCSSRule(this._styles, `${prefix} > .ui-resizable-sw`, `left: ${left}; bottom: ${bottom}`);\r\n        }\r\n        // now update the height specific fields\r\n        maxH = maxH || this._styles._max;\r\n        if (maxH > this._styles._max) {\r\n            let getHeight = (rows) => (cellHeight * rows) + cellHeightUnit;\r\n            for (let i = this._styles._max + 1; i <= maxH; i++) { // start at 1\r\n                let h = getHeight(i);\r\n                utils_1.Utils.addCSSRule(this._styles, `${prefix}[gs-y=\"${i - 1}\"]`, `top: ${getHeight(i - 1)}`); // start at 0\r\n                utils_1.Utils.addCSSRule(this._styles, `${prefix}[gs-h=\"${i}\"]`, `height: ${h}`);\r\n                utils_1.Utils.addCSSRule(this._styles, `${prefix}[gs-min-h=\"${i}\"]`, `min-height: ${h}`);\r\n                utils_1.Utils.addCSSRule(this._styles, `${prefix}[gs-max-h=\"${i}\"]`, `max-height: ${h}`);\r\n            }\r\n            this._styles._max = maxH;\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _updateContainerHeight() {\r\n        if (!this.engine || this.engine.batchMode)\r\n            return this;\r\n        let row = this.getRow(); // checks for minRow already\r\n        // check for css min height\r\n        let cssMinHeight = parseInt(getComputedStyle(this.el)['min-height']);\r\n        if (cssMinHeight > 0) {\r\n            let minRow = Math.round(cssMinHeight / this.getCellHeight(true));\r\n            if (row < minRow) {\r\n                row = minRow;\r\n            }\r\n        }\r\n        this.el.setAttribute('gs-current-row', String(row));\r\n        if (row === 0) {\r\n            this.el.style.removeProperty('height');\r\n            return this;\r\n        }\r\n        let cellHeight = this.opts.cellHeight;\r\n        let unit = this.opts.cellHeightUnit;\r\n        if (!cellHeight)\r\n            return this;\r\n        this.el.style.height = row * cellHeight + unit;\r\n        return this;\r\n    }\r\n    /** called to resize children nested grids when we/item resizes */\r\n    _resizeNestedGrids(target) {\r\n        target.querySelectorAll('.grid-stack').forEach((el) => {\r\n            if (el.gridstack) {\r\n                el.gridstack.onParentResize();\r\n            }\r\n        });\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _prepareElement(el, triggerAddEvent = false, node) {\r\n        if (!node) {\r\n            el.classList.add(this.opts.itemClass);\r\n            node = this._readAttr(el);\r\n        }\r\n        el.gridstackNode = node;\r\n        node.el = el;\r\n        node.grid = this;\r\n        let copy = Object.assign({}, node);\r\n        node = this.engine.addNode(node, triggerAddEvent);\r\n        // write node attr back in case there was collision or we have to fix bad values during addNode()\r\n        if (!utils_1.Utils.same(node, copy)) {\r\n            this._writeAttr(el, node);\r\n        }\r\n        this._prepareDragDropByNode(node);\r\n        return this;\r\n    }\r\n    /** @internal call to write x,y,w,h attributes back to element */\r\n    _writePosAttr(el, x, y, w, h) {\r\n        if (x !== undefined && x !== null) {\r\n            el.setAttribute('gs-x', String(x));\r\n        }\r\n        if (y !== undefined && y !== null) {\r\n            el.setAttribute('gs-y', String(y));\r\n        }\r\n        if (w) {\r\n            el.setAttribute('gs-w', String(w));\r\n        }\r\n        if (h) {\r\n            el.setAttribute('gs-h', String(h));\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal call to write any default attributes back to element */\r\n    _writeAttr(el, node) {\r\n        if (!node)\r\n            return this;\r\n        this._writePosAttr(el, node.x, node.y, node.w, node.h);\r\n        let attrs /*: GridStackWidget but strings */ = {\r\n            autoPosition: 'gs-auto-position',\r\n            minW: 'gs-min-w',\r\n            minH: 'gs-min-h',\r\n            maxW: 'gs-max-w',\r\n            maxH: 'gs-max-h',\r\n            noResize: 'gs-no-resize',\r\n            noMove: 'gs-no-move',\r\n            locked: 'gs-locked',\r\n            id: 'gs-id',\r\n            resizeHandles: 'gs-resize-handles'\r\n        };\r\n        for (const key in attrs) {\r\n            if (node[key]) { // 0 is valid for x,y only but done above already and not in list anyway\r\n                el.setAttribute(attrs[key], String(node[key]));\r\n            }\r\n            else {\r\n                el.removeAttribute(attrs[key]);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal call to read any default attributes from element */\r\n    _readAttr(el) {\r\n        let node = {};\r\n        node.x = utils_1.Utils.toNumber(el.getAttribute('gs-x'));\r\n        node.y = utils_1.Utils.toNumber(el.getAttribute('gs-y'));\r\n        node.w = utils_1.Utils.toNumber(el.getAttribute('gs-w'));\r\n        node.h = utils_1.Utils.toNumber(el.getAttribute('gs-h'));\r\n        node.maxW = utils_1.Utils.toNumber(el.getAttribute('gs-max-w'));\r\n        node.minW = utils_1.Utils.toNumber(el.getAttribute('gs-min-w'));\r\n        node.maxH = utils_1.Utils.toNumber(el.getAttribute('gs-max-h'));\r\n        node.minH = utils_1.Utils.toNumber(el.getAttribute('gs-min-h'));\r\n        node.autoPosition = utils_1.Utils.toBool(el.getAttribute('gs-auto-position'));\r\n        node.noResize = utils_1.Utils.toBool(el.getAttribute('gs-no-resize'));\r\n        node.noMove = utils_1.Utils.toBool(el.getAttribute('gs-no-move'));\r\n        node.locked = utils_1.Utils.toBool(el.getAttribute('gs-locked'));\r\n        node.resizeHandles = el.getAttribute('gs-resize-handles');\r\n        node.id = el.getAttribute('gs-id');\r\n        // remove any key not found (null or false which is default)\r\n        for (const key in node) {\r\n            if (!node.hasOwnProperty(key))\r\n                return;\r\n            if (!node[key] && node[key] !== 0) { // 0 can be valid value (x,y only really)\r\n                delete node[key];\r\n            }\r\n        }\r\n        return node;\r\n    }\r\n    /** @internal */\r\n    _setStaticClass() {\r\n        let classes = ['grid-stack-static'];\r\n        if (this.opts.staticGrid) {\r\n            this.el.classList.add(...classes);\r\n            this.el.setAttribute('gs-static', 'true');\r\n        }\r\n        else {\r\n            this.el.classList.remove(...classes);\r\n            this.el.removeAttribute('gs-static');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * called when we are being resized by the window - check if the one Column Mode needs to be turned on/off\r\n     * and remember the prev columns we used, as well as check for auto cell height (square)\r\n     */\r\n    onParentResize() {\r\n        if (!this.el || !this.el.clientWidth)\r\n            return; // return if we're gone or no size yet (will get called again)\r\n        // make the cells content (minus margin) square again\r\n        if (this._isAutoCellHeight) {\r\n            utils_1.Utils.throttle(() => {\r\n                let marginDiff = -this.opts.marginRight - this.opts.marginLeft\r\n                    + this.opts.marginTop + this.opts.marginBottom;\r\n                this.cellHeight(this.cellWidth() + marginDiff);\r\n            }, 100);\r\n        }\r\n        if (!this.opts.disableOneColumnMode && this.el.clientWidth <= this.opts.minWidth) {\r\n            if (this._oneColumnMode)\r\n                return this;\r\n            this._oneColumnMode = true;\r\n            this.column(1);\r\n            this._resizeNestedGrids(this.el);\r\n        }\r\n        else {\r\n            if (!this._oneColumnMode)\r\n                return this;\r\n            delete this._oneColumnMode;\r\n            this.column(this._prevColumn);\r\n            this._resizeNestedGrids(this.el);\r\n        }\r\n        return this;\r\n    }\r\n    /** add or remove the window size event handler */\r\n    _updateWindowResizeEvent(forceRemove = false) {\r\n        const workTodo = (this._isAutoCellHeight || !this.opts.disableOneColumnMode);\r\n        // only add event if we're not nested (parent will call us) and we're auto sizing cells or supporting oneColumn (i.e. doing work)\r\n        if (workTodo && !forceRemove && !this.opts._isNested && !this._windowResizeBind) {\r\n            this._windowResizeBind = this.onParentResize.bind(this); // so we can properly remove later\r\n            window.addEventListener('resize', this._windowResizeBind);\r\n            this.onParentResize(); // initially call it once...\r\n        }\r\n        else if ((forceRemove || !workTodo) && this._windowResizeBind) {\r\n            window.removeEventListener('resize', this._windowResizeBind);\r\n            delete this._windowResizeBind; // remove link to us so we can free\r\n        }\r\n        return this;\r\n    }\r\n    /** @internal convert a potential selector into actual element */\r\n    static getElement(els = '.grid-stack-item') { return utils_1.Utils.getElement(els); }\r\n    /** @internal */\r\n    static getElements(els = '.grid-stack-item') { return utils_1.Utils.getElements(els); }\r\n    /** @internal */\r\n    static getGridElement(els) { return GridStack.getElement(els); }\r\n    /** @internal */\r\n    static getGridElements(els) { return utils_1.Utils.getElements(els); }\r\n    /** @internal initialize margin top/bottom/left/right and units */\r\n    initMargin() {\r\n        let data;\r\n        let margin = 0;\r\n        // support passing multiple values like CSS (ex: '5px 10px 0 20px')\r\n        let margins = [];\r\n        if (typeof this.opts.margin === 'string') {\r\n            margins = this.opts.margin.split(' ');\r\n        }\r\n        if (margins.length === 2) { // top/bot, left/right like CSS\r\n            this.opts.marginTop = this.opts.marginBottom = margins[0];\r\n            this.opts.marginLeft = this.opts.marginRight = margins[1];\r\n        }\r\n        else if (margins.length === 4) { // Clockwise like CSS\r\n            this.opts.marginTop = margins[0];\r\n            this.opts.marginRight = margins[1];\r\n            this.opts.marginBottom = margins[2];\r\n            this.opts.marginLeft = margins[3];\r\n        }\r\n        else {\r\n            data = utils_1.Utils.parseHeight(this.opts.margin);\r\n            this.opts.marginUnit = data.unit;\r\n            margin = this.opts.margin = data.h;\r\n        }\r\n        // see if top/bottom/left/right need to be set as well\r\n        if (this.opts.marginTop === undefined) {\r\n            this.opts.marginTop = margin;\r\n        }\r\n        else {\r\n            data = utils_1.Utils.parseHeight(this.opts.marginTop);\r\n            this.opts.marginTop = data.h;\r\n            delete this.opts.margin;\r\n        }\r\n        if (this.opts.marginBottom === undefined) {\r\n            this.opts.marginBottom = margin;\r\n        }\r\n        else {\r\n            data = utils_1.Utils.parseHeight(this.opts.marginBottom);\r\n            this.opts.marginBottom = data.h;\r\n            delete this.opts.margin;\r\n        }\r\n        if (this.opts.marginRight === undefined) {\r\n            this.opts.marginRight = margin;\r\n        }\r\n        else {\r\n            data = utils_1.Utils.parseHeight(this.opts.marginRight);\r\n            this.opts.marginRight = data.h;\r\n            delete this.opts.margin;\r\n        }\r\n        if (this.opts.marginLeft === undefined) {\r\n            this.opts.marginLeft = margin;\r\n        }\r\n        else {\r\n            data = utils_1.Utils.parseHeight(this.opts.marginLeft);\r\n            this.opts.marginLeft = data.h;\r\n            delete this.opts.margin;\r\n        }\r\n        this.opts.marginUnit = data.unit; // in case side were spelled out, use those units instead...\r\n        if (this.opts.marginTop === this.opts.marginBottom && this.opts.marginLeft === this.opts.marginRight && this.opts.marginTop === this.opts.marginRight) {\r\n            this.opts.margin = this.opts.marginTop; // makes it easier to check for no-ops in setMargin()\r\n        }\r\n        return this;\r\n    }\r\n    /*\r\n     * drag&drop empty stubs that will be implemented in gridstack-dd.ts for non static grid\r\n     * so we don't incur the load unless needed.\r\n     * NOTE: had to make those methods public in order to define them else as\r\n     *   GridStack.prototype._setupAcceptWidget = function()\r\n     * maybe there is a better way ????\r\n     */\r\n    /* eslint-disable @typescript-eslint/no-unused-vars */\r\n    /**\r\n     * Enables/Disables moving. No-op for static grids.\r\n     * @param els widget or selector to modify.\r\n     * @param val if true widget will be draggable.\r\n     */\r\n    movable(els, val) { return this; }\r\n    /**\r\n     * Enables/Disables resizing. No-op for static grids.\r\n     * @param els  widget or selector to modify\r\n     * @param val  if true widget will be resizable.\r\n     */\r\n    resizable(els, val) { return this; }\r\n    /**\r\n     * Temporarily disables widgets moving/resizing.\r\n     * If you want a more permanent way (which freezes up resources) use `setStatic(true)` instead.\r\n     * Note: no-op for static grid\r\n     * This is a shortcut for:\r\n     * @example\r\n     *  grid.enableMove(false);\r\n     *  grid.enableResize(false);\r\n     */\r\n    disable() { return this; }\r\n    /**\r\n     * Re-enables widgets moving/resizing - see disable().\r\n     * Note: no-op for static grid.\r\n     * This is a shortcut for:\r\n     * @example\r\n     *  grid.enableMove(true);\r\n     *  grid.enableResize(true);\r\n     */\r\n    enable() { return this; }\r\n    /**\r\n     * Enables/disables widget moving. No-op for static grids.\r\n     *\r\n     * @param doEnable\r\n     * @param includeNewWidgets will force new widgets to be draggable as per\r\n     * doEnable`s value by changing the disableDrag grid option (default: true).\r\n     */\r\n    enableMove(doEnable, includeNewWidgets = true) { return this; }\r\n    /**\r\n     * Enables/disables widget resizing. No-op for static grids.\r\n     * @param doEnable\r\n     * @param includeNewWidgets will force new widgets to be draggable as per\r\n     * doEnable`s value by changing the disableResize grid option (default: true).\r\n     */\r\n    enableResize(doEnable, includeNewWidgets = true) { return this; }\r\n    /** @internal called to add drag over support to support widgets */\r\n    _setupAcceptWidget() { return this; }\r\n    /** @internal called to setup a trash drop zone if the user specifies it */\r\n    _setupRemoveDrop() { return this; }\r\n    /** @internal */\r\n    _setupRemovingTimeout(el) { return this; }\r\n    /** @internal */\r\n    _clearRemovingTimeout(el) { return this; }\r\n    /** @internal call to setup dragging in from the outside (say toolbar), with options */\r\n    _setupDragIn() { return this; }\r\n    /** @internal prepares the element for drag&drop **/\r\n    _prepareDragDropByNode(node) { return this; }\r\n    // 2.x API that just calls the new and better update() - keep those around for backward compat only...\r\n    /** @internal */\r\n    locked(els, locked) { return this.update(els, { locked }); }\r\n    /** @internal */\r\n    maxWidth(els, maxW) { return this.update(els, { maxW }); }\r\n    /** @internal */\r\n    minWidth(els, minW) { return this.update(els, { minW }); }\r\n    /** @internal */\r\n    maxHeight(els, maxH) { return this.update(els, { maxH }); }\r\n    /** @internal */\r\n    minHeight(els, minH) { return this.update(els, { minH }); }\r\n    /** @internal */\r\n    move(els, x, y) { return this.update(els, { x, y }); }\r\n    /** @internal */\r\n    resize(els, w, h) { return this.update(els, { w, h }); }\r\n}\r\nexports.GridStack = GridStack;\r\n/** scoping so users can call GridStack.Utils.sort() for example */\r\nGridStack.Utils = utils_1.Utils;\r\n/** scoping so users can call new GridStack.Engine(12) for example */\r\nGridStack.Engine = gridstack_engine_1.GridStackEngine;\r\n//# sourceMappingURL=gridstack.js.map","\"use strict\";\r\n// gridstack-engine.ts 3.2.0 @preserve\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * https://gridstackjs.com/\r\n * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov\r\n * gridstack.js may be freely distributed under the MIT license.\r\n*/\r\nconst utils_1 = require(\"./utils\");\r\n/**\r\n * Defines the GridStack engine that does most no DOM grid manipulation.\r\n * See GridStack methods and vars for descriptions.\r\n *\r\n * NOTE: values should not be modified directly - call the main GridStack API instead\r\n */\r\nclass GridStackEngine {\r\n    constructor(opts = {}) {\r\n        this.addedNodes = [];\r\n        this.removedNodes = [];\r\n        /** @internal legacy method renames */\r\n        this.getGridHeight = utils_1.obsolete(this, GridStackEngine.prototype.getRow, 'getGridHeight', 'getRow', 'v1.0.0');\r\n        this.column = opts.column || 12;\r\n        this.onChange = opts.onChange;\r\n        this._float = opts.float;\r\n        this.maxRow = opts.maxRow;\r\n        this.nodes = opts.nodes || [];\r\n    }\r\n    batchUpdate() {\r\n        if (this.batchMode)\r\n            return this;\r\n        this.batchMode = true;\r\n        this._prevFloat = this._float;\r\n        this._float = true; // let things go anywhere for now... commit() will restore and possibly reposition\r\n        return this;\r\n    }\r\n    commit() {\r\n        if (!this.batchMode)\r\n            return this;\r\n        this.batchMode = false;\r\n        this._float = this._prevFloat;\r\n        delete this._prevFloat;\r\n        this._packNodes();\r\n        this._notify();\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _fixCollisions(node) {\r\n        this._sortNodes(-1);\r\n        let nn = node;\r\n        let hasLocked = Boolean(this.nodes.find(n => n.locked));\r\n        if (!this.float && !hasLocked) {\r\n            nn = { x: 0, y: node.y, w: this.column, h: node.h };\r\n        }\r\n        while (true) {\r\n            let collisionNode = this.collide(node, nn);\r\n            if (!collisionNode)\r\n                return this;\r\n            let moved;\r\n            if (collisionNode.locked) {\r\n                // if colliding with a locked item, move ourself instead\r\n                moved = this.moveNode(node, node.x, collisionNode.y + collisionNode.h, node.w, node.h, true);\r\n            }\r\n            else {\r\n                moved = this.moveNode(collisionNode, collisionNode.x, node.y + node.h, collisionNode.w, collisionNode.h, true);\r\n            }\r\n            if (!moved)\r\n                return this; // break inf loop if we couldn't move after all (ex: maxRow, fixed)\r\n        }\r\n    }\r\n    /** return any intercepted node with the given area, skipping the passed in node (usually self) */\r\n    collide(node, area = node) {\r\n        return this.nodes.find(n => n !== node && utils_1.Utils.isIntercepted(n, area));\r\n    }\r\n    isAreaEmpty(x, y, w, h) {\r\n        let nn = { x: x || 0, y: y || 0, w: w || 1, h: h || 1 };\r\n        return !this.collide(nn);\r\n    }\r\n    /** re-layout grid items to reclaim any empty space */\r\n    compact() {\r\n        if (this.nodes.length === 0)\r\n            return this;\r\n        this.batchUpdate();\r\n        this._sortNodes();\r\n        let copyNodes = this.nodes;\r\n        this.nodes = []; // pretend we have no nodes to conflict layout to start with...\r\n        copyNodes.forEach(node => {\r\n            if (!node.noMove && !node.locked) {\r\n                node.autoPosition = true;\r\n            }\r\n            this.addNode(node, false); // 'false' for add event trigger\r\n            node._dirty = true; // force attr update\r\n        });\r\n        this.commit();\r\n        return this;\r\n    }\r\n    /** enable/disable floating widgets (default: `false`) See [example](http://gridstackjs.com/demo/float.html) */\r\n    set float(val) {\r\n        if (this._float === val)\r\n            return;\r\n        this._float = val || false;\r\n        if (!val) {\r\n            this._packNodes();\r\n            this._notify();\r\n        }\r\n    }\r\n    /** float getter method */\r\n    get float() { return this._float || false; }\r\n    /** @internal */\r\n    _sortNodes(dir) {\r\n        this.nodes = utils_1.Utils.sort(this.nodes, dir, this.column);\r\n        return this;\r\n    }\r\n    /** @internal */\r\n    _packNodes() {\r\n        this._sortNodes();\r\n        if (this.float) {\r\n            this.nodes.forEach((n, i) => {\r\n                if (n._updating || n._packY === undefined || n.y === n._packY) {\r\n                    return this;\r\n                }\r\n                let newY = n.y;\r\n                while (newY >= n._packY) {\r\n                    let box = { x: n.x, y: newY, w: n.w, h: n.h };\r\n                    let collisionNode = this.nodes.slice(0, i).find(bn => utils_1.Utils.isIntercepted(box, bn));\r\n                    if (!collisionNode) {\r\n                        n._dirty = true;\r\n                        n.y = newY;\r\n                    }\r\n                    --newY;\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.nodes.forEach((n, i) => {\r\n                if (n.locked)\r\n                    return this;\r\n                while (n.y > 0) {\r\n                    let newY = n.y - 1;\r\n                    let canBeMoved = i === 0;\r\n                    let box = { x: n.x, y: newY, w: n.w, h: n.h };\r\n                    if (i > 0) {\r\n                        let collisionNode = this.nodes.slice(0, i).find(bn => utils_1.Utils.isIntercepted(box, bn));\r\n                        canBeMoved = !collisionNode;\r\n                    }\r\n                    if (!canBeMoved) {\r\n                        break;\r\n                    }\r\n                    // Note: must be dirty (from last position) for GridStack::OnChange CB to update positions\r\n                    // and move items back. The user 'change' CB should detect changes from the original\r\n                    // starting position instead.\r\n                    n._dirty = (n.y !== newY);\r\n                    n.y = newY;\r\n                }\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * given a random node, makes sure it's coordinates/values are valid in the current grid\r\n     * @param node to adjust\r\n     * @param resizing if out of bound, resize down or move into the grid to fit ?\r\n     */\r\n    prepareNode(node, resizing) {\r\n        node = node || {};\r\n        node._id = node._id || GridStackEngine._idSeq++;\r\n        // if we're missing position, have the grid position us automatically (before we set them to 0,0)\r\n        if (node.x === undefined || node.y === undefined || node.x === null || node.y === null) {\r\n            node.autoPosition = true;\r\n        }\r\n        // assign defaults for missing required fields\r\n        let defaults = { x: 0, y: 0, w: 1, h: 1 };\r\n        utils_1.Utils.defaults(node, defaults);\r\n        if (!node.autoPosition) {\r\n            delete node.autoPosition;\r\n        }\r\n        if (!node.noResize) {\r\n            delete node.noResize;\r\n        }\r\n        if (!node.noMove) {\r\n            delete node.noMove;\r\n        }\r\n        // check for NaN (in case messed up strings were passed. can't do parseInt() || defaults.x above as 0 is valid #)\r\n        if (typeof node.x == 'string') {\r\n            node.x = Number(node.x);\r\n        }\r\n        if (typeof node.y == 'string') {\r\n            node.y = Number(node.y);\r\n        }\r\n        if (typeof node.w == 'string') {\r\n            node.w = Number(node.w);\r\n        }\r\n        if (typeof node.h == 'string') {\r\n            node.h = Number(node.h);\r\n        }\r\n        if (isNaN(node.x)) {\r\n            node.x = defaults.x;\r\n            node.autoPosition = true;\r\n        }\r\n        if (isNaN(node.y)) {\r\n            node.y = defaults.y;\r\n            node.autoPosition = true;\r\n        }\r\n        if (isNaN(node.w)) {\r\n            node.w = defaults.w;\r\n        }\r\n        if (isNaN(node.h)) {\r\n            node.h = defaults.h;\r\n        }\r\n        if (node.maxW) {\r\n            node.w = Math.min(node.w, node.maxW);\r\n        }\r\n        if (node.maxH) {\r\n            node.h = Math.min(node.h, node.maxH);\r\n        }\r\n        if (node.minW) {\r\n            node.w = Math.max(node.w, node.minW);\r\n        }\r\n        if (node.minH) {\r\n            node.h = Math.max(node.h, node.minH);\r\n        }\r\n        if (node.w > this.column) {\r\n            node.w = this.column;\r\n        }\r\n        else if (node.w < 1) {\r\n            node.w = 1;\r\n        }\r\n        if (this.maxRow && node.h > this.maxRow) {\r\n            node.h = this.maxRow;\r\n        }\r\n        else if (node.h < 1) {\r\n            node.h = 1;\r\n        }\r\n        if (node.x < 0) {\r\n            node.x = 0;\r\n        }\r\n        if (node.y < 0) {\r\n            node.y = 0;\r\n        }\r\n        if (node.x + node.w > this.column) {\r\n            if (resizing) {\r\n                node.w = this.column - node.x;\r\n            }\r\n            else {\r\n                node.x = this.column - node.w;\r\n            }\r\n        }\r\n        if (this.maxRow && node.y + node.h > this.maxRow) {\r\n            if (resizing) {\r\n                node.h = this.maxRow - node.y;\r\n            }\r\n            else {\r\n                node.y = this.maxRow - node.h;\r\n            }\r\n        }\r\n        return node;\r\n    }\r\n    getDirtyNodes(verify) {\r\n        // compare original X,Y,W,H (or entire node?) instead as _dirty can be a temporary state\r\n        if (verify) {\r\n            let dirtNodes = [];\r\n            this.nodes.forEach(n => {\r\n                if (n._dirty) {\r\n                    if (n.y === n._origY && n.x === n._origX && n.w === n._origW && n.h === n._origH) {\r\n                        delete n._dirty;\r\n                    }\r\n                    else {\r\n                        dirtNodes.push(n);\r\n                    }\r\n                }\r\n            });\r\n            return dirtNodes;\r\n        }\r\n        return this.nodes.filter(n => n._dirty);\r\n    }\r\n    /** @internal */\r\n    _notify(nodes, removeDOM = true) {\r\n        if (this.batchMode)\r\n            return this;\r\n        nodes = (nodes === undefined ? [] : (Array.isArray(nodes) ? nodes : [nodes]));\r\n        let dirtyNodes = nodes.concat(this.getDirtyNodes());\r\n        if (this.onChange) {\r\n            this.onChange(dirtyNodes, removeDOM);\r\n        }\r\n        return this;\r\n    }\r\n    cleanNodes() {\r\n        if (this.batchMode)\r\n            return this;\r\n        this.nodes.forEach(n => { delete n._dirty; });\r\n        return this;\r\n    }\r\n    addNode(node, triggerAddEvent = false) {\r\n        node = this.prepareNode(node);\r\n        if (node.autoPosition) {\r\n            this._sortNodes();\r\n            for (let i = 0;; ++i) {\r\n                let x = i % this.column;\r\n                let y = Math.floor(i / this.column);\r\n                if (x + node.w > this.column) {\r\n                    continue;\r\n                }\r\n                let box = { x, y, w: node.w, h: node.h };\r\n                if (!this.nodes.find(n => utils_1.Utils.isIntercepted(box, n))) {\r\n                    node.x = x;\r\n                    node.y = y;\r\n                    delete node.autoPosition; // found our slot\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        this.nodes.push(node);\r\n        if (triggerAddEvent) {\r\n            this.addedNodes.push(node);\r\n        }\r\n        this._fixCollisions(node);\r\n        this._packNodes();\r\n        this._notify();\r\n        return node;\r\n    }\r\n    removeNode(node, removeDOM = true, triggerEvent = false) {\r\n        if (triggerEvent) { // we wait until final drop to manually track removed items (rather than during drag)\r\n            this.removedNodes.push(node);\r\n        }\r\n        node._id = null; // hint that node is being removed\r\n        // don't use 'faster' .splice(findIndex(),1) in case node isn't in our list, or in multiple times.\r\n        this.nodes = this.nodes.filter(n => n !== node);\r\n        if (!this.float) {\r\n            this._packNodes();\r\n        }\r\n        this._notify(node, removeDOM);\r\n        return this;\r\n    }\r\n    removeAll(removeDOM = true) {\r\n        delete this._layouts;\r\n        if (this.nodes.length === 0)\r\n            return this;\r\n        if (removeDOM) {\r\n            this.nodes.forEach(n => { n._id = null; }); // hint that node is being removed\r\n        }\r\n        this.removedNodes = this.nodes;\r\n        this.nodes = [];\r\n        this._notify(this.removedNodes, removeDOM);\r\n        return this;\r\n    }\r\n    canMoveNode(node, x, y, w, h) {\r\n        if (!this.isNodeChangedPosition(node, x, y, w, h)) {\r\n            return false;\r\n        }\r\n        let hasLocked = this.nodes.some(n => n.locked);\r\n        if (!this.maxRow && !hasLocked) {\r\n            return true;\r\n        }\r\n        let clonedNode;\r\n        let clone = new GridStackEngine({\r\n            column: this.column,\r\n            float: this.float,\r\n            nodes: this.nodes.map(n => {\r\n                if (n === node) {\r\n                    clonedNode = Object.assign({}, n);\r\n                    return clonedNode;\r\n                }\r\n                return Object.assign({}, n);\r\n            })\r\n        });\r\n        if (!clonedNode)\r\n            return true;\r\n        clone.moveNode(clonedNode, x, y, w, h);\r\n        let canMove = true;\r\n        if (hasLocked) {\r\n            canMove = !clone.nodes.some(n => n.locked && n._dirty && n !== clonedNode);\r\n        }\r\n        if (this.maxRow && canMove) {\r\n            canMove = (clone.getRow() <= this.maxRow);\r\n        }\r\n        return canMove;\r\n    }\r\n    /** return true if can fit in grid height constrain only (always true if no maxRow) */\r\n    willItFit(node) {\r\n        if (!this.maxRow)\r\n            return true;\r\n        let clone = new GridStackEngine({\r\n            column: this.column,\r\n            float: this.float,\r\n            nodes: this.nodes.map(n => { return Object.assign({}, n); })\r\n        });\r\n        clone.addNode(node);\r\n        return clone.getRow() <= this.maxRow;\r\n    }\r\n    /** return true if the passed in node (x,y) is being dragged outside of the grid, and not added to bottom */\r\n    isOutside(x, y, node) {\r\n        // simple outside boundaries\r\n        if (x < 0 || x >= this.column || y < 0)\r\n            return true;\r\n        if (this.maxRow)\r\n            return (y >= this.maxRow);\r\n        else if (this.float)\r\n            return false; // infinite grow with no maxRow\r\n        // see if dragging PAST bottom (row+1)\r\n        let row = this.getRow();\r\n        if (y < row || y === 0)\r\n            return false;\r\n        if (y > row)\r\n            return true;\r\n        // else check to see if we can add that item to the bottom... (y == row)\r\n        if (!node._temporaryRemoved) {\r\n            let clone = new GridStackEngine({\r\n                column: this.column,\r\n                float: this.float,\r\n                nodes: this.nodes.filter(n => n !== node).map(n => { return Object.assign({}, n); })\r\n            });\r\n            let nn = Object.assign(Object.assign({}, node), { x, y });\r\n            clone.addNode(nn);\r\n            return nn.y === node.y && nn.x === node.x; // didn't actually move, so last row was a drag out and not a new place...\r\n        }\r\n        return node._temporaryRemoved; // if still outside so we don't flicker back & forth\r\n    }\r\n    isNodeChangedPosition(node, x, y, w, h) {\r\n        if (typeof x !== 'number') {\r\n            x = node.x;\r\n        }\r\n        if (typeof y !== 'number') {\r\n            y = node.y;\r\n        }\r\n        if (typeof w !== 'number') {\r\n            w = node.w;\r\n        }\r\n        if (typeof h !== 'number') {\r\n            h = node.h;\r\n        }\r\n        if (node.maxW) {\r\n            w = Math.min(w, node.maxW);\r\n        }\r\n        if (node.maxH) {\r\n            h = Math.min(h, node.maxH);\r\n        }\r\n        if (node.minW) {\r\n            w = Math.max(w, node.minW);\r\n        }\r\n        if (node.minH) {\r\n            h = Math.max(h, node.minH);\r\n        }\r\n        if (node.x === x && node.y === y && node.w === w && node.h === h) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    moveNode(node, x, y, w, h, noPack) {\r\n        if (node.locked)\r\n            return null;\r\n        if (typeof x !== 'number') {\r\n            x = node.x;\r\n        }\r\n        if (typeof y !== 'number') {\r\n            y = node.y;\r\n        }\r\n        if (typeof w !== 'number') {\r\n            w = node.w;\r\n        }\r\n        if (typeof h !== 'number') {\r\n            h = node.h;\r\n        }\r\n        // constrain the passed in values and check if we're still changing our node\r\n        let resizing = (node.w !== w || node.h !== h);\r\n        let nn = { x, y, w, h, maxW: node.maxW, maxH: node.maxH, minW: node.minW, minH: node.minH };\r\n        nn = this.prepareNode(nn, resizing);\r\n        if (node.x === nn.x && node.y === nn.y && node.w === nn.w && node.h === nn.h) {\r\n            return null;\r\n        }\r\n        node._dirty = true;\r\n        node.x = node._lastTriedX = nn.x;\r\n        node.y = node._lastTriedY = nn.y;\r\n        node.w = node._lastTriedW = nn.w;\r\n        node.h = node._lastTriedH = nn.h;\r\n        this._fixCollisions(node);\r\n        if (!noPack) {\r\n            this._packNodes();\r\n            this._notify();\r\n        }\r\n        return node;\r\n    }\r\n    getRow() {\r\n        return this.nodes.reduce((memo, n) => Math.max(memo, n.y + n.h), 0);\r\n    }\r\n    beginUpdate(node) {\r\n        if (node._updating)\r\n            return this;\r\n        node._updating = true;\r\n        this.nodes.forEach(n => { n._packY = n.y; });\r\n        return this;\r\n    }\r\n    endUpdate() {\r\n        let n = this.nodes.find(n => n._updating);\r\n        if (n) {\r\n            delete n._updating;\r\n            this.nodes.forEach(n => { delete n._packY; });\r\n        }\r\n        return this;\r\n    }\r\n    /** saves the current layout returning a list of widgets for serialization */\r\n    save(saveElement = true) {\r\n        let widgets = [];\r\n        utils_1.Utils.sort(this.nodes);\r\n        this.nodes.forEach(n => {\r\n            let w = {};\r\n            for (let key in n) {\r\n                if (key[0] !== '_' && n[key] !== null && n[key] !== undefined)\r\n                    w[key] = n[key];\r\n            }\r\n            // delete other internals\r\n            if (!saveElement)\r\n                delete w.el;\r\n            delete w.grid;\r\n            // delete default values (will be re-created on read)\r\n            if (!w.autoPosition)\r\n                delete w.autoPosition;\r\n            if (!w.noResize)\r\n                delete w.noResize;\r\n            if (!w.noMove)\r\n                delete w.noMove;\r\n            if (!w.locked)\r\n                delete w.locked;\r\n            widgets.push(w);\r\n        });\r\n        return widgets;\r\n    }\r\n    /** @internal called whenever a node is added or moved - updates the cached layouts */\r\n    layoutsNodesChange(nodes) {\r\n        if (!this._layouts || this._ignoreLayoutsNodeChange)\r\n            return this;\r\n        // remove smaller layouts - we will re-generate those on the fly... larger ones need to update\r\n        this._layouts.forEach((layout, column) => {\r\n            if (!layout || column === this.column)\r\n                return this;\r\n            if (column < this.column) {\r\n                this._layouts[column] = undefined;\r\n            }\r\n            else {\r\n                // we save the original x,y,w (h isn't cached) to see what actually changed to propagate better.\r\n                // Note: we don't need to check against out of bound scaling/moving as that will be done when using those cache values.\r\n                nodes.forEach(node => {\r\n                    let n = layout.find(l => l._id === node._id);\r\n                    if (!n)\r\n                        return this; // no cache for new nodes. Will use those values.\r\n                    let ratio = column / this.column;\r\n                    // Y changed, push down same amount\r\n                    // TODO: detect doing item 'swaps' will help instead of move (especially in 1 column mode)\r\n                    if (node.y !== node._origY) {\r\n                        n.y += (node.y - node._origY);\r\n                    }\r\n                    // X changed, scale from new position\r\n                    if (node.x !== node._origX) {\r\n                        n.x = Math.round(node.x * ratio);\r\n                    }\r\n                    // width changed, scale from new width\r\n                    if (node.w !== node._origW) {\r\n                        n.w = Math.round(node.w * ratio);\r\n                    }\r\n                    // ...height always carries over from cache\r\n                });\r\n            }\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * @internal Called to scale the widget width & position up/down based on the column change.\r\n     * Note we store previous layouts (especially original ones) to make it possible to go\r\n     * from say 12 -> 1 -> 12 and get back to where we were.\r\n     *\r\n     * @param oldColumn previous number of columns\r\n     * @param column  new column number\r\n     * @param nodes different sorted list (ex: DOM order) instead of current list\r\n     * @param layout specify the type of re-layout that will happen (position, size, etc...).\r\n     * Note: items will never be outside of the current column boundaries. default (moveScale). Ignored for 1 column\r\n     */\r\n    updateNodeWidths(oldColumn, column, nodes, layout = 'moveScale') {\r\n        if (!this.nodes.length || oldColumn === column)\r\n            return this;\r\n        // cache the current layout in case they want to go back (like 12 -> 1 -> 12) as it requires original data\r\n        this.cacheLayout(this.nodes, oldColumn);\r\n        // if we're going to 1 column and using DOM order rather than default sorting, then generate that layout\r\n        if (column === 1 && nodes && nodes.length) {\r\n            let top = 0;\r\n            nodes.forEach(n => {\r\n                n.x = 0;\r\n                n.w = 1;\r\n                n.y = Math.max(n.y, top);\r\n                top = n.y + n.h;\r\n            });\r\n        }\r\n        else {\r\n            nodes = utils_1.Utils.sort(this.nodes, -1, oldColumn); // current column reverse sorting so we can insert last to front (limit collision)\r\n        }\r\n        // see if we have cached previous layout.\r\n        let cacheNodes = this._layouts[column] || [];\r\n        // if not AND we are going up in size start with the largest layout as down-scaling is more accurate\r\n        let lastIndex = this._layouts.length - 1;\r\n        if (cacheNodes.length === 0 && column > oldColumn && column < lastIndex) {\r\n            cacheNodes = this._layouts[lastIndex] || [];\r\n            if (cacheNodes.length) {\r\n                // pretend we came from that larger column by assigning those values as starting point\r\n                oldColumn = lastIndex;\r\n                cacheNodes.forEach(cacheNode => {\r\n                    let j = nodes.findIndex(n => n._id === cacheNode._id);\r\n                    if (j !== -1) {\r\n                        // still current, use cache info positions\r\n                        nodes[j].x = cacheNode.x;\r\n                        nodes[j].y = cacheNode.y;\r\n                        nodes[j].w = cacheNode.w;\r\n                    }\r\n                });\r\n                cacheNodes = []; // we still don't have new column cached data... will generate from larger one.\r\n            }\r\n        }\r\n        // if we found cache re-use those nodes that are still current\r\n        let newNodes = [];\r\n        cacheNodes.forEach(cacheNode => {\r\n            let j = nodes.findIndex(n => n._id === cacheNode._id);\r\n            if (j !== -1) {\r\n                // still current, use cache info positions\r\n                nodes[j].x = cacheNode.x;\r\n                nodes[j].y = cacheNode.y;\r\n                nodes[j].w = cacheNode.w;\r\n                newNodes.push(nodes[j]);\r\n                nodes.splice(j, 1);\r\n            }\r\n        });\r\n        // ...and add any extra non-cached ones\r\n        if (nodes.length) {\r\n            if (typeof layout === 'function') {\r\n                layout(column, oldColumn, newNodes, nodes);\r\n            }\r\n            else {\r\n                let ratio = column / oldColumn;\r\n                let move = (layout === 'move' || layout === 'moveScale');\r\n                let scale = (layout === 'scale' || layout === 'moveScale');\r\n                nodes.forEach(node => {\r\n                    node.x = (column === 1 ? 0 : (move ? Math.round(node.x * ratio) : Math.min(node.x, column - 1)));\r\n                    node.w = ((column === 1 || oldColumn === 1) ? 1 :\r\n                        scale ? (Math.round(node.w * ratio) || 1) : (Math.min(node.w, column)));\r\n                    newNodes.push(node);\r\n                });\r\n                nodes = [];\r\n            }\r\n        }\r\n        // finally re-layout them in reverse order (to get correct placement)\r\n        newNodes = utils_1.Utils.sort(newNodes, -1, column);\r\n        this._ignoreLayoutsNodeChange = true;\r\n        this.batchUpdate();\r\n        this.nodes = []; // pretend we have no nodes to start with (we use same structures) to simplify layout\r\n        newNodes.forEach(node => {\r\n            this.addNode(node, false); // 'false' for add event trigger\r\n            node._dirty = true; // force attr update\r\n        }, this);\r\n        this.commit();\r\n        delete this._ignoreLayoutsNodeChange;\r\n        return this;\r\n    }\r\n    /** @internal called to save initial position/size */\r\n    saveInitial() {\r\n        this.nodes.forEach(n => {\r\n            n._origX = n.x;\r\n            n._origY = n.y;\r\n            n._origW = n.w;\r\n            n._origH = n.h;\r\n            delete n._dirty;\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * call to cache the given layout internally to the given location so we can restore back when column changes size\r\n     * @param nodes list of nodes\r\n     * @param column corresponding column index to save it under\r\n     * @param clear if true, will force other caches to be removed (default false)\r\n     */\r\n    cacheLayout(nodes, column, clear = false) {\r\n        let copy = [];\r\n        nodes.forEach((n, i) => {\r\n            n._id = n._id || GridStackEngine._idSeq++; // make sure we have an id in case this is new layout, else re-use id already set\r\n            copy[i] = { x: n.x, y: n.y, w: n.w, _id: n._id }; // only thing we change is x,y,w and id to find it back\r\n        });\r\n        this._layouts = clear ? [] : this._layouts || []; // use array to find larger quick\r\n        this._layouts[column] = copy;\r\n        return this;\r\n    }\r\n    /** called to remove all internal values */\r\n    cleanupNode(node) {\r\n        for (let prop in node) {\r\n            if (prop[0] === '_')\r\n                delete node[prop];\r\n        }\r\n        return this;\r\n    }\r\n}\r\nexports.GridStackEngine = GridStackEngine;\r\n/** @internal */\r\nGridStackEngine._idSeq = 1;\r\n//# sourceMappingURL=gridstack-engine.js.map","\"use strict\";\r\n// utils.ts 3.2.0 @preserve\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/** checks for obsolete method names */\r\n// eslint-disable-next-line\r\nfunction obsolete(self, f, oldName, newName, rev) {\r\n    let wrapper = (...args) => {\r\n        console.warn('gridstack.js: Function `' + oldName + '` is deprecated in ' + rev + ' and has been replaced ' +\r\n            'with `' + newName + '`. It will be **completely** removed in v1.0');\r\n        return f.apply(self, args);\r\n    };\r\n    wrapper.prototype = f.prototype;\r\n    return wrapper;\r\n}\r\nexports.obsolete = obsolete;\r\n/** checks for obsolete grid options (can be used for any fields, but msg is about options) */\r\nfunction obsoleteOpts(opts, oldName, newName, rev) {\r\n    if (opts[oldName] !== undefined) {\r\n        opts[newName] = opts[oldName];\r\n        console.warn('gridstack.js: Option `' + oldName + '` is deprecated in ' + rev + ' and has been replaced with `' +\r\n            newName + '`. It will be **completely** removed in v1.0');\r\n    }\r\n}\r\nexports.obsoleteOpts = obsoleteOpts;\r\n/** checks for obsolete grid options which are gone */\r\nfunction obsoleteOptsDel(opts, oldName, rev, info) {\r\n    if (opts[oldName] !== undefined) {\r\n        console.warn('gridstack.js: Option `' + oldName + '` is deprecated in ' + rev + info);\r\n    }\r\n}\r\nexports.obsoleteOptsDel = obsoleteOptsDel;\r\n/** checks for obsolete Jquery element attributes */\r\nfunction obsoleteAttr(el, oldName, newName, rev) {\r\n    let oldAttr = el.getAttribute(oldName);\r\n    if (oldAttr !== null) {\r\n        el.setAttribute(newName, oldAttr);\r\n        console.warn('gridstack.js: attribute `' + oldName + '`=' + oldAttr + ' is deprecated on this object in ' + rev + ' and has been replaced with `' +\r\n            newName + '`. It will be **completely** removed in v1.0');\r\n    }\r\n}\r\nexports.obsoleteAttr = obsoleteAttr;\r\n/**\r\n * Utility methods\r\n */\r\nclass Utils {\r\n    /** convert a potential selector into actual list of html elements */\r\n    static getElements(els) {\r\n        if (typeof els === 'string') {\r\n            let list = document.querySelectorAll(els);\r\n            if (!list.length && els[0] !== '.' && els[0] !== '#') {\r\n                list = document.querySelectorAll('.' + els);\r\n                if (!list.length) {\r\n                    list = document.querySelectorAll('#' + els);\r\n                }\r\n            }\r\n            return Array.from(list);\r\n        }\r\n        return [els];\r\n    }\r\n    /** convert a potential selector into actual single element */\r\n    static getElement(els) {\r\n        if (typeof els === 'string') {\r\n            if (!els.length)\r\n                return null;\r\n            if (els[0] === '#') {\r\n                return document.getElementById(els.substring(1));\r\n            }\r\n            if (els[0] === '.' || els[0] === '[') {\r\n                return document.querySelector(els);\r\n            }\r\n            // if we start with a digit, assume it's an id (error calling querySelector('#1')) as class are not valid CSS\r\n            if (!isNaN(+els[0])) { // start with digit\r\n                return document.getElementById(els);\r\n            }\r\n            // finally try string, then id then class\r\n            let el = document.querySelector(els);\r\n            if (!el) {\r\n                el = document.getElementById(els);\r\n            }\r\n            if (!el) {\r\n                el = document.querySelector('.' + els);\r\n            }\r\n            return el;\r\n        }\r\n        return els;\r\n    }\r\n    /** returns true if a and b overlap */\r\n    static isIntercepted(a, b) {\r\n        return !(a.x + a.w <= b.x || b.x + b.w <= a.x || a.y + a.h <= b.y || b.y + b.h <= a.y);\r\n    }\r\n    /**\r\n     * Sorts array of nodes\r\n     * @param nodes array to sort\r\n     * @param dir 1 for asc, -1 for desc (optional)\r\n     * @param width width of the grid. If undefined the width will be calculated automatically (optional).\r\n     **/\r\n    static sort(nodes, dir, column) {\r\n        if (!column) {\r\n            let widths = nodes.map(n => n.x + n.w);\r\n            column = Math.max(...widths);\r\n        }\r\n        if (dir === -1)\r\n            return nodes.sort((a, b) => (b.x + b.y * column) - (a.x + a.y * column));\r\n        else\r\n            return nodes.sort((b, a) => (b.x + b.y * column) - (a.x + a.y * column));\r\n    }\r\n    /**\r\n     * creates a style sheet with style id under given parent\r\n     * @param id will set the 'gs-style-id' attribute to that id\r\n     * @param parent to insert the stylesheet as first child,\r\n     * if none supplied it will be appended to the document head instead.\r\n     */\r\n    static createStylesheet(id, parent) {\r\n        let style = document.createElement('style');\r\n        style.setAttribute('type', 'text/css');\r\n        style.setAttribute('gs-style-id', id);\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        if (style.styleSheet) { // TODO: only CSSImportRule have that and different beast ??\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            style.styleSheet.cssText = '';\r\n        }\r\n        else {\r\n            style.appendChild(document.createTextNode('')); // WebKit hack\r\n        }\r\n        if (!parent) {\r\n            // default to head\r\n            parent = document.getElementsByTagName('head')[0];\r\n            parent.appendChild(style);\r\n        }\r\n        else {\r\n            parent.insertBefore(style, parent.firstChild);\r\n        }\r\n        return style.sheet;\r\n    }\r\n    /** removed the given stylesheet id */\r\n    static removeStylesheet(id) {\r\n        let el = document.querySelector('STYLE[gs-style-id=' + id + ']');\r\n        if (el && el.parentNode)\r\n            el.remove();\r\n    }\r\n    /** inserts a CSS rule */\r\n    static addCSSRule(sheet, selector, rules) {\r\n        if (typeof sheet.addRule === 'function') {\r\n            sheet.addRule(selector, rules);\r\n        }\r\n        else if (typeof sheet.insertRule === 'function') {\r\n            sheet.insertRule(`${selector}{${rules}}`);\r\n        }\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    static toBool(v) {\r\n        if (typeof v === 'boolean') {\r\n            return v;\r\n        }\r\n        if (typeof v === 'string') {\r\n            v = v.toLowerCase();\r\n            return !(v === '' || v === 'no' || v === 'false' || v === '0');\r\n        }\r\n        return Boolean(v);\r\n    }\r\n    static toNumber(value) {\r\n        return (value === null || value.length === 0) ? undefined : Number(value);\r\n    }\r\n    static parseHeight(val) {\r\n        let h;\r\n        let unit = 'px';\r\n        if (typeof val === 'string') {\r\n            let match = val.match(/^(-[0-9]+\\.[0-9]+|[0-9]*\\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%)?$/);\r\n            if (!match) {\r\n                throw new Error('Invalid height');\r\n            }\r\n            unit = match[2] || 'px';\r\n            h = parseFloat(match[1]);\r\n        }\r\n        else {\r\n            h = val;\r\n        }\r\n        return { h, unit };\r\n    }\r\n    /** copies unset fields in target to use the given default sources values */\r\n    // eslint-disable-next-line\r\n    static defaults(target, ...sources) {\r\n        sources.forEach(source => {\r\n            for (const key in source) {\r\n                if (!source.hasOwnProperty(key))\r\n                    return;\r\n                if (target[key] === null || target[key] === undefined) {\r\n                    target[key] = source[key];\r\n                }\r\n                else if (typeof source[key] === 'object' && typeof target[key] === 'object') {\r\n                    // property is an object, recursively add it's field over... #1373\r\n                    this.defaults(target[key], source[key]);\r\n                }\r\n            }\r\n        });\r\n        return target;\r\n    }\r\n    /** given 2 objects return true if they have the same values. Checks for Object {} having same fields and values (just 1 level down) */\r\n    static same(a, b) {\r\n        if (typeof a !== 'object')\r\n            return a == b;\r\n        if (typeof a !== typeof b)\r\n            return false;\r\n        // else we have object, check just 1 level deep for being same things...\r\n        if (Object.keys(a).length !== Object.keys(b).length)\r\n            return false;\r\n        for (const key in a) {\r\n            if (a[key] !== b[key])\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n    /** removes field from the first object if same as the second objects (like diffing) and internal '_' for saving */\r\n    static removeInternalAndSame(a, b) {\r\n        if (typeof a !== 'object' || typeof b !== 'object')\r\n            return;\r\n        for (let key in a) {\r\n            let val = a[key];\r\n            if (val && typeof val === 'object') {\r\n                for (let i in val) {\r\n                    if (val[i] === b[key][i] || i[0] === '_') {\r\n                        delete val[i];\r\n                    }\r\n                }\r\n                if (!Object.keys(val).length) {\r\n                    delete a[key];\r\n                }\r\n            }\r\n            else if (val === b[key] || key[0] === '_') {\r\n                delete a[key];\r\n            }\r\n        }\r\n    }\r\n    /** return the closest parent matching the given class */\r\n    static closestByClass(el, name) {\r\n        while (el = el.parentElement) {\r\n            if (el.classList.contains(name))\r\n                return el;\r\n        }\r\n        return null;\r\n    }\r\n    /** delay calling the given function by certain amount of time */\r\n    static throttle(callback, delay) {\r\n        let isWaiting = false;\r\n        return (...args) => {\r\n            if (!isWaiting) {\r\n                callback.apply(this, args);\r\n                isWaiting = true;\r\n                setTimeout(() => isWaiting = false, delay);\r\n            }\r\n        };\r\n    }\r\n    static removePositioningStyles(el) {\r\n        let style = el.style;\r\n        if (style.position) {\r\n            style.removeProperty('position');\r\n        }\r\n        if (style.left) {\r\n            style.removeProperty('left');\r\n        }\r\n        if (style.top) {\r\n            style.removeProperty('top');\r\n        }\r\n        if (style.width) {\r\n            style.removeProperty('width');\r\n        }\r\n        if (style.height) {\r\n            style.removeProperty('height');\r\n        }\r\n    }\r\n    /** @internal */\r\n    static getScrollParent(el) {\r\n        if (el === null)\r\n            return document.documentElement;\r\n        const style = getComputedStyle(el);\r\n        const overflowRegex = /(auto|scroll)/;\r\n        if (overflowRegex.test(style.overflow + style.overflowY)) {\r\n            return el;\r\n        }\r\n        else {\r\n            return this.getScrollParent(el.parentElement);\r\n        }\r\n    }\r\n    /** @internal */\r\n    static updateScrollPosition(el, position, distance) {\r\n        // is widget in view?\r\n        let rect = el.getBoundingClientRect();\r\n        let innerHeightOrClientHeight = (window.innerHeight || document.documentElement.clientHeight);\r\n        if (rect.top < 0 ||\r\n            rect.bottom > innerHeightOrClientHeight) {\r\n            // set scrollTop of first parent that scrolls\r\n            // if parent is larger than el, set as low as possible\r\n            // to get entire widget on screen\r\n            let offsetDiffDown = rect.bottom - innerHeightOrClientHeight;\r\n            let offsetDiffUp = rect.top;\r\n            let scrollEl = this.getScrollParent(el);\r\n            if (scrollEl !== null) {\r\n                let prevScroll = scrollEl.scrollTop;\r\n                if (rect.top < 0 && distance < 0) {\r\n                    // moving up\r\n                    if (el.offsetHeight > innerHeightOrClientHeight) {\r\n                        scrollEl.scrollTop += distance;\r\n                    }\r\n                    else {\r\n                        scrollEl.scrollTop += Math.abs(offsetDiffUp) > Math.abs(distance) ? distance : offsetDiffUp;\r\n                    }\r\n                }\r\n                else if (distance > 0) {\r\n                    // moving down\r\n                    if (el.offsetHeight > innerHeightOrClientHeight) {\r\n                        scrollEl.scrollTop += distance;\r\n                    }\r\n                    else {\r\n                        scrollEl.scrollTop += offsetDiffDown > distance ? distance : offsetDiffDown;\r\n                    }\r\n                }\r\n                // move widget y by amount scrolled\r\n                position.top += scrollEl.scrollTop - prevScroll;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @internal Function used to scroll the page.\r\n     *\r\n     * @param event `MouseEvent` that triggers the resize\r\n     * @param el `HTMLElement` that's being resized\r\n     * @param distance Distance from the V edges to start scrolling\r\n     */\r\n    static updateScrollResize(event, el, distance) {\r\n        const scrollEl = this.getScrollParent(el);\r\n        const height = scrollEl.clientHeight;\r\n        const top = event.clientY < distance;\r\n        const bottom = event.clientY > height - distance;\r\n        if (top) {\r\n            // This also can be done with a timeout to keep scrolling while the mouse is\r\n            // in the scrolling zone. (will have smoother behavior)\r\n            scrollEl.scrollBy({ behavior: 'smooth', top: event.clientY - distance });\r\n        }\r\n        else if (bottom) {\r\n            scrollEl.scrollBy({ behavior: 'smooth', top: distance - (height - event.clientY) });\r\n        }\r\n    }\r\n}\r\nexports.Utils = Utils;\r\n//# sourceMappingURL=utils.js.map","\"use strict\";\r\n// gridstack-ddi.ts 3.2.0 @preserve\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Abstract Partial Interface API for drag'n'drop plugin - look at GridStackDD and HTML5 / Jquery implementation versions\r\n */\r\nclass GridStackDDI {\r\n    /** call this method to register your plugin instead of the default no-op one */\r\n    static registerPlugin(pluginClass) {\r\n        GridStackDDI.ddi = new pluginClass();\r\n        return GridStackDDI.ddi;\r\n    }\r\n    /** get the current registered plugin to use */\r\n    static get() {\r\n        return GridStackDDI.ddi || GridStackDDI.registerPlugin(GridStackDDI);\r\n    }\r\n    /** removes any drag&drop present (called during destroy) */\r\n    remove(el) {\r\n        return this; // no-op for static grids\r\n    }\r\n}\r\nexports.GridStackDDI = GridStackDDI;\r\n//# sourceMappingURL=gridstack-ddi.js.map","import { IAnyMap, ControlState, globalMatrix, app } from \"../../globals\";\nimport { IDropdownOption, IDropdownGroup } from \"../../ProjectSettings\";\nimport { ITableControlOptionsColumn } from \"../businesslogic\";\nimport { ml } from \"../matrixlib\";\n\nexport type { ILineEditorLine };\nexport { LineEditorExt };\n\n\nexport enum LineType {\n    textline = \"textline\",\n    id = \"id\",\n    uppercase = \"uppercase\",\n    number = \"number\",\n    select = \"select\",\n    table = \"table\",\n    json = \"json\",\n    color = \"color\",\n    id_ = \"id_\",\n    richtext = \"richtext\",\n    readonly = \"readonly\",\n    boolean = \"boolean\",\n    multiselect = \"multiselect\",\n    folderselect =\"folderselect\",\n    userAndGroupSelect = \"userAndGroupSelect\",\n}\n\ninterface ILineEditorLine {\n    id?:string;\n    key?:number, // this is just returned to ident if a line in the values\n    help:string,\n    explanation?:string, // and additional explanation under the help\n    value:string,\n    type: LineType;\n    // for type select\n    options?:IDropdownOption[],\n    multiple?:boolean,\n    groups?:IDropdownGroup[],\n    // for tables\n    columns?:ITableControlOptionsColumn[]\n    // for tables and select\n    noEdit?:boolean\n    // for all?\n    readonly?:boolean\n    hide?:boolean,\n    required?:boolean,\n    extraOptions?:IAnyMap;\n\n}\n\n//This class will allow to use the lineEditor outside the config app.\nclass LineEditorExt {\n    constructor() {\n       // super();\n    }\n     showDialog(title: string, height: number, input: ILineEditorLine[], onOk: (update: ILineEditorLine[]) => boolean, width?: number, showUserAndGroupsSelectWithDialog?: (container: JQuery, showUsers: boolean, showGroups: boolean, help: string, empty: string, selected: string[], dialogTitle: string, onSelect: (selection: string[]) => void) => void): JQueryDeferred<any> {\n        let that = this;\n        let ok: JQuery;\n        let d = $.Deferred();\n        app.dlgForm.html(\"\");\n\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n\n        let ctrls: JQuery[] = [];\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: title,\n            height: height,\n            width: width ? width : 720,\n            modal: true,\n            close: function() {\n            },\n            open: function() {\n                for (let inp of input) {\n                    let canEdit = !inp.readonly;\n                    let inlineHelp = inp.explanation ? inp.explanation : \"\";\n                    let dataCy = inp.id ?? inp.help.replace(/\\s/g, \"_\");\n                    let ctrl = $(`<div class=\"controlContainer\" data-cy=\"${dataCy}\">`).appendTo(app.dlgForm);\n                    switch (inp.type) {\n                        case LineType.textline:\n                        case LineType.id:\n                        case LineType.id_:\n                        case LineType.uppercase:\n                        case LineType.number:\n                            ctrl.plainText({\n                                canEdit: canEdit,\n                                help: inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n                                parameter: { rows: inp.multiple ? 5 : 1, allowResize: false, inlineHelp: inlineHelp },\n                                fieldValue: inp.value,\n                            });\n                            break;\n                        case LineType.json:\n                            ctrl.plainText({\n                                canEdit: canEdit,\n                                help: inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n                                parameter: {\n                                    code: 'json',\n                                    height: 200,\n                                    autoFormat: true,\n                                    showJSONFormat: true,\n                                    hideFullscreen: true,\n                                    rows: inp.multiple ? 5 : 1, allowResize: false, inlineHelp: inlineHelp\n                                },\n                                fieldValue: inp.value,\n                            });\n                            break;\n                        case LineType.color:\n                            ctrl.colorPicker({\n                                canEdit: canEdit,\n                                help: inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n                                parameter: { allowResize: false, inlineHelp: inlineHelp },\n                                fieldValue: inp.value,\n                            });\n                            break;\n                        case LineType.richtext:\n                            ctrl.richText({\n                                canEdit: canEdit,\n                                help: inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n                                parameter: { height: 200, requiresContent: inp.required, tiny: true },\n                                fieldValue: inp.value,\n                            });\n                            break;\n\n                        case LineType.readonly:\n                            ctrl.plainText({\n                                canEdit: false,\n                                help: inp.help,\n                                valueChanged: function() { // this is not used\n                                },\n                                parameter: { rows: 1, allowResize: false, inlineHelp: inlineHelp },\n                                fieldValue: inp.value\n                            });\n                            break;\n                        case LineType.boolean:\n                            ctrl.checkBox({\n                                canEdit: canEdit,\n                                help: inp.help,\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n                                fieldValue: inp.value,\n                                parameter: { inlineHelp: inlineHelp }\n                            });\n                            ctrl.removeClass(\"controlContainer\");\n                            break;\n\n                        case LineType.table:\n                            ctrl.tableCtrl({\n                                canEdit: canEdit,\n                                help: inp.help,\n                                valueChanged: function() {\n                                },\n                                fieldValue: inp.value,\n                                parameter: {\n                                    canBeModified: inp.noEdit ? false : true,\n                                    create: inp.noEdit ? false : true,\n                                    showLineNumbers: false,\n                                    readonly_allowfocus: false,\n                                    columns: inp.columns,\n                                    inlineHelp: inlineHelp\n                                }\n                            });\n                            break;\n                        case LineType.select:\n                            ctrl.mxDropdown({\n                                controlState: ControlState.FormEdit,\n                                canEdit: canEdit,\n                                help: inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                fieldValue: inp.value,\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n\n                                parameter: {\n                                    placeholder: 'select',\n                                    maxItems: inp.multiple ? 100 : 1,\n                                    options: inp.options,\n                                    groups: inp.groups ? inp.groups : [],\n                                    create: inp.noEdit ? false : true,\n                                    sort: false,\n                                    inlineHelp: inlineHelp\n                                },\n\n                            });\n                            break;\n                        case LineType.folderselect:\n                            let showOnly = [], showNot = [];\n                            if (inp.extraOptions) {\n                                if (inp.extraOptions.showOnly && inp.extraOptions.showOnly.length > 0) {\n                                    showOnly = inp.extraOptions.showOnly;\n                                }\n\n                                if (inp.extraOptions.showNot && inp.extraOptions.showNot.length > 0) {\n                                    showNot = inp.extraOptions.showNot;\n                                }\n                            }\n                            // This a hack to make sure that we will parse the ref to create link.\n                            addHighlightLink(\"\", globalMatrix.matrixBaseUrl + \"/\");\n\n                            ctrl.itemSelection({\n                                controlState: ControlState.FormEdit,\n                                canEdit: canEdit,\n                                help: inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                fieldValue: inp.value,\n                                valueChanged: function() {\n                                    that.setEnabled(ok, ctrls, input);\n                                },\n                                parameter: {\n                                    crossProject: true,\n                                    crossProjectAsList: false,\n                                    prefix: \"Selected folder : \",\n                                    buttonName: \"Select folder\",\n                                    singleFolderOnly: true,\n                                    showOnly: showOnly,\n                                    showNot: showNot,\n\n                                },\n\n                            });\n                            break;\n                        case  LineType.multiselect:\n                            ctrl.multiSelect({\n                                afterSelect: function(values) {\n\n                                    let selection = ctrl.data(\"selected\") ?? [];\n\n                                    (<string[]>values).forEach((value) => {\n                                        if (!selection.includes(value))\n                                            selection.push(value);\n                                    });\n\n                                    ctrl.data(\"selected\", selection);\n                                    that.setEnabled(ok, ctrls, input);\n\n                                },\n                                afterDeselect: function(values) {\n\n                                    let selection = ctrl.data(\"selected\") ?? [];\n                                    (<string[]>values).forEach((value) => {\n                                        let i = selection.indexOf(value);\n                                        selection = selection.splice(i, 1);\n                                    });\n                                    ctrl.data(\"selected\", selection);\n\n                                }\n                            });\n\n                            if (inp.options) {\n                                inp.options.forEach((opt) => {\n                                    ctrl.multiSelect('addOption', { value: opt.id, text: opt.label });\n                                })\n                                let selection = inp.value ? inp.value.split(\",\") : [];\n                                ctrl.multiSelect(\"select\", selection);\n                            }\n                            $(\"<div class='baseControlHelp' style='margin-top:10px'>\" + inp.help + (inp.required ? \"<sup>*</sup>\" : \"\") + \"</div>\").insertBefore(ctrl);\n                            break;\n                        case  LineType.userAndGroupSelect:\n                            ctrl.data(\"selected\", inp.value ? inp.value.split(\",\") : []);\n                            if (showUserAndGroupsSelectWithDialog) {\n                                showUserAndGroupsSelectWithDialog(ctrl, true, true,\n                                    inp.help + (inp.required ? \"<sup>*</sup>\" : \"\"),\n                                    \"select users or groups\",\n                                    inp.value ? inp.value.split(\",\") : [],\n                                    inp.help,\n                                    (selected: string[]) => {\n                                        ctrl.data(\"selected\", selected);\n                                        that.setEnabled(ok, ctrls, input);\n                                    });\n                            }\n                            break;\n                        default:\n                            ml.Logger.error(\"Unknown input type \" + inp.type);\n                    }\n                    ctrls.push(ctrl);\n                    if (inp.hide) {\n                        ctrl.hide();\n                    }\n                }\n\n            },\n            resizeStop: function(event, ui) {\n            },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt',\n                click: async function() {\n                    let updates: ILineEditorLine[] = await that.getValue(ctrls, input);\n                    let issues: string[] = [];\n                    $.each(updates, function(idx, update) {\n                        if (update.type == LineType.id_ && !update.value.match(/^[a-z0-9]+$/i)) {\n                            issues.push(input[idx].help + \" is an identifier. It cannot contain anything but letters and digits\");\n                        }\n                        if (update.type == LineType.id_ && !update.value.match(/^[a-z0-9_\\-]+$/i)) {\n                            issues.push(input[idx].help + \" is an identifier. It cannot contain anything but letters, digits, dash and underscore\");\n                        }\n                        if (update.type == LineType.id_ && !update.value.substr(0, 1).match(/^[a-z]+$/i)) {\n                            issues.push(input[idx].help + \" is an identifier. It must start with a letter\");\n                        }\n                        if (update.type == LineType.number && !update.value.match(/^[0-9]+$/)) {\n                            issues.push(input[idx].help + \" is a number. It cannot contain anything but digits\");\n                        }\n                        if (update.type == LineType.uppercase && !update.value.match(/^[A-Z]+$/)) {\n                            issues.push(input[idx].help + \" is a short id. It cannot contain nothing but uppercase letters\");\n                        }\n\n                    });\n                    if (issues.length) {\n                        alert(issues.join(\"\\n\"));\n                    } else if (onOk(updates)) {\n                        app.dlgForm.dialog(\"close\");\n                        d.resolve();\n\n                    }\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function() {\n                    d.reject();\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        });\n\n        // get Ok button\n        ok = $(\".btnDoIt\", app.dlgForm.parent());\n\n        // check if at least one shown input is required\n        let showsRequired = false;\n        $.each(input, function(idx, inp) {\n            if (inp.required && !inp.hide) {\n                showsRequired = true;\n            }\n        });\n        if (showsRequired) {\n            ok.parent().prepend(\"* required \");\n        }\n\n        this.setEnabled(ok, ctrls, input);\n        return d;\n    }\n\n    static mapToKeys(results:ILineEditorLine[]):ILineEditorLine[] {\n        let update:ILineEditorLine[] = [];\n        $.each(results, function(idx, uwk) {\n            update[uwk.key] = uwk;\n        });\n        return update;\n    }\n    private async setEnabled(btn: JQuery, ctrls: JQuery[], input: ILineEditorLine[]) {\n        if (btn) {\n            ml.UI.setEnabled(btn, this.isEnabled(await this.getValue(ctrls, input)));\n        }\n    }\n\n    private async getValue(ctrls: JQuery[], input: ILineEditorLine[]) {\n        let updates = ml.JSON.clone(input);\n        let idx = 0;\n        for (let ctrl of ctrls) {\n            if (ctrl.getController) {\n                updates[idx].value = await ctrl.getController().getValueAsync();\n            } else {\n                updates[idx].value = ctrl.data(\"selected\") ? ctrl.data(\"selected\").join(\",\") : \"\";\n            }\n            idx++;\n        }\n        return updates;\n    }\n    private isEnabled(status:ILineEditorLine[]) {\n        let hasRequired = false;\n        let hasAllRequired = true;\n        $.each(status, function(idx, input) {\n            if (input.required && !input.hide) {\n                hasRequired = true;\n                if (!input.value) {\n                    hasAllRequired = false;\n                }\n            }\n        });\n        return !hasRequired || hasAllRequired;\n    }\n}\n","export type {\n    IWidgetDashboardSettings, IDisplayedWidget,\n    IWidgetPosition, IWidgetParameters,\n    IWidgetPlugin, IGridStackWidget\n};\nexport {\n    IWidgetScope, widgetRenderEvent,\n    renderMode, WidgetPluginManager, widgetPluginManager\n};\n\n\ninterface IWidgetDashboardSettings {\n    enabled:boolean;\n    displayedWidgets:IDisplayedWidget[]\n\n};\n\n\ninterface IDisplayedWidget {\n    id:string;\n    pluginName:string;\n    parameters:IWidgetParameters;\n    createdBy?:string;\n}\n\nenum widgetRenderEvent {\n    load, scroll, click\n}\nenum renderMode {\n    placeholder,minimized,maximized\n}\n\nenum IWidgetScope {\n    admin,user,superAdmin\n}\ninterface IWidgetPosition {\n    dashboard:string;\n    w:number;\n    h:number;\n    x?:number;\n    y?:number;\n}\ninterface IWidgetParameters {\n    canBeAddedOrDeletedBy: IWidgetScope;\n    position:IWidgetPosition;\n    users?:string[]\n    options:{title:string, canBeHidden:boolean, [key:string]:any };\n\n}\ninterface IWidgetPlugin {\n    id:string;\n    help:string;\n    _root: JQuery;\n    displayedWidget:IDisplayedWidget;\n    pluginName():string;\n    defaultParameters(): IWidgetParameters;\n    mergeOptions(parameters:IWidgetParameters):IWidgetParameters;\n    render(root:JQuery,displayedWidget:IDisplayedWidget):void;\n    updatePosition(w:number,h:number,x:number,y:number);\n    hide(showConfirm:boolean );\n    \n    unload?():void;\n\n    scrollIntoView?():void;\n    clicked?():void;\n    refresh?():void;\n    \n}\nclass WidgetPluginManager {\n    \n\n    pluginList:{[key:string]:IWidgetPlugin};\n    \n    loadedWidgets:{[key:string]:IWidgetPlugin};\n    constructor()\n    {\n        this.pluginList = {};\n        this.loadedWidgets= {};\n    }\n    registerPlugin(plugin:IWidgetPlugin)\n    {\n        this.pluginList[plugin.pluginName()] = (plugin);\n    }\n\n    addLoadedWidget(key:string, widget:IWidgetPlugin)\n    {\n        let id = key;\n        this.loadedWidgets[id] = widget;\n\n    }\n    unLoadAllWidgets()\n    {\n        for(let key in this.loadedWidgets)\n        {\n            if(this.loadedWidgets[key].unload)\n                this.loadedWidgets[key].unload();\n        }\n        this.loadedWidgets= {};\n    }\n    removeLoadedWidget(displayedWidget: IDisplayedWidget) {\n        let foundWidget = this.loadedWidgets[displayedWidget.id];\n        if( foundWidget )\n        { \n            if(foundWidget.unload)\n            {\n                foundWidget.unload();\n            }\n                delete this.loadedWidgets[displayedWidget.id];\n        }\n\n    }\n\n}\n\n\n\ninterface IGridStackWidget {\n    /** widget position x (default?: 0) */\n    x?: number;\n    /** widget position y (default?: 0) */\n    y?: number;\n    /** widget dimension width (default?: 1) */\n    w?: number;\n    /** widget dimension height (default?: 1) */\n    h?: number;\n    /** if true then x, y parameters will be ignored and widget will be places on the first available position (default?: false) */\n    autoPosition?: boolean;\n    /** minimum width allowed during resize/creation (default?: undefined = un-constrained) */\n    minW?: number;\n    /** maximum width allowed during resize/creation (default?: undefined = un-constrained) */\n    maxW?: number;\n    /** minimum height allowed during resize/creation (default?: undefined = un-constrained) */\n    minH?: number;\n    /** maximum height allowed during resize/creation (default?: undefined = un-constrained) */\n    maxH?: number;\n    /** prevent resizing (default?: undefined = un-constrained) */\n    noResize?: boolean;\n    /** prevents moving (default?: undefined = un-constrained) */\n    noMove?: boolean;\n    /** prevents moving and resizing (default?: undefined = un-constrained) */\n    locked?: boolean;\n    /** widgets can have their own resize handles. For example 'e,w' will make the particular widget only resize east and west. */\n    resizeHandles?: string;\n    /** value for `gs-id` stored on the widget (default?: undefined) */\n    id?: number | string;\n    /** html to append inside as content */\n    content?: string;\n    /** optional nested grid options and list of children, which then turns into actual instance at runtime */\n}\n\n\n\nvar widgetPluginManager: WidgetPluginManager = new WidgetPluginManager(); // plugin manager \n\n","import { ILineEditorLine } from \"../common/UI/ILineEditor\";\nimport { app, matrixSession, restConnection } from \"../globals\";\nimport { IDisplayedWidget, IWidgetScope } from \"./WidgetPluginManager\";\n\nexport { WidgetSettingsManager };\n\nclass WidgetSettingsManager {\n  \n    static getHiddenWidgets():string[]\n    {\n        let list: string[] = [];\n        let index = matrixSession.serverConfig.currentUserSettings.findIndex(o => { return o.key == \"hiddenWidget\" });\n        if(index >=0)\n        {\n            try {\n                let templist = JSON.parse(matrixSession.serverConfig.currentUserSettings[index].value);\n              list = templist.filter(function(item, pos) {\n                return templist.indexOf(item) == pos;\n             });\n\n            } catch (error) {\n                \n            }\n        }\n        return list;\n\n    }\n    static hide(widget: IDisplayedWidget) : JQueryDeferred<any> {\n        let d: JQueryDeferred<any> = $.Deferred();\n        \n        let list: string[] = [];\n        let index = matrixSession.serverConfig.currentUserSettings.findIndex(o => { return o.key == \"hiddenWidget\" });\n        if(index >=0)\n        {\n            \n            let templist = JSON.parse(matrixSession.serverConfig.currentUserSettings[index].value);\n            templist.push(widget.id);\n            //Remove duplicates\n            list = templist.filter(function(item, pos) {\n                return templist.indexOf(item) == pos;\n            });\n        \n            matrixSession.serverConfig.currentUserSettings[index].value = JSON.stringify(list);\n        } \n        else\n        {\n            list.push(widget.id);\n            matrixSession.serverConfig.currentUserSettings.push({\n                key:\"hiddenWidget\",\n                value: JSON.stringify(list),secret:false\n            })\n        }\n       \n        let data = {\n            key: \"hiddenWidget\",\n            value: JSON.stringify(list),\n            reason: \"adding widget Setting\"\n        };\n        return restConnection.postServer(\"user/\" + matrixSession.getUser() + \"/setting\", data);\n\n    }\n\n    static unhide(displayedWidget: IDisplayedWidget) : JQueryDeferred<any>  {\n        \n        let index = matrixSession.serverConfig.currentUserSettings.findIndex(o => { return o.key == \"hiddenWidget\" });\n        let list = WidgetSettingsManager.getHiddenWidgets().filter((w=>{return w != displayedWidget.id}));\n        \n        if(index >= 0)\n            matrixSession.serverConfig.currentUserSettings[index].value = JSON.stringify(list);\n\n\n        let data = {\n            key: \"hiddenWidget\",\n            value: JSON.stringify(list),\n            reason: \"adding widget Setting\"\n        };\n        return restConnection.postServer(\"user/\" + matrixSession.getUser() + \"/setting\", data);\n\n    }\n\n    static updatePosition(widget: IDisplayedWidget): JQueryDeferred<any> \n    {\n        let d: JQueryDeferred<any> = $.Deferred();\n\n        if (widget.parameters.users != undefined && widget.parameters.users.length > 0 && widget.createdBy != matrixSession.getUser()) {\n            // Save new position to localstorage\n            localStorage.setItem(widget.id, JSON.stringify(widget.parameters.position));\n            d.resolve();\n            return d;\n\n        }\n        else\n        {\n            return WidgetSettingsManager.setSettings(widget);\n        }\n    }\n\n    static setSettings(widget: IDisplayedWidget): JQueryDeferred<any> {\n        let d: JQueryDeferred<any> = $.Deferred();\n\n     \n        if (widget.parameters.users != undefined && widget.parameters.users.length > 0) {\n            if (matrixSession.isAdmin()) {\n                \n                let index = matrixSession.serverConfig.customerSettings.findIndex(o => { return o.key == widget.id });\n                if(index >=0)\n                    matrixSession.serverConfig.customerSettings[index].value = JSON.stringify(widget)\n                else\n                    matrixSession.serverConfig.customerSettings.push({ key: widget.id, value: JSON.stringify(widget), secret: false });\n\n                return app.setSettingCustomerJSON(widget.id, widget);\n            }\n        }\n        else {\n            \n            let index = matrixSession.serverConfig.currentUserSettings.findIndex(o => { return o.key == widget.id });\n            if(index >=0)\n                matrixSession.serverConfig.currentUserSettings[index].value = JSON.stringify(widget)\n            else\n                matrixSession.serverConfig.currentUserSettings.push({ key: widget.id, value: JSON.stringify(widget), secret: false });\n\n            if (widget.parameters.canBeAddedOrDeletedBy == IWidgetScope.user) {\n                let data = {\n                    key: widget.id,\n                    value: JSON.stringify(widget),\n                    reason: \"adding widget Setting\"\n                };\n                return restConnection.postServer(\"user/\" + matrixSession.getUser() + \"/setting\", data);\n            }\n        }\n        d.fail();\n        return d;\n    }\n    static deleteDeleteWidgetSettings(widget: IDisplayedWidget): JQueryDeferred<any> {\n        let d: JQueryDeferred<any> = $.Deferred();\n\n        if (widget.parameters.users != undefined && widget.parameters.users.length > 0) {\n            if (matrixSession.isAdmin()) {\n               \n                matrixSession.serverConfig.customerSettings = matrixSession.serverConfig.customerSettings.filter((value, index, arr) => { return value.key != widget.id });\n\n                return app.setSettingCustomerJSON(widget.id, \"\");\n\n            }\n        }\n        else {\n            if (widget.parameters.canBeAddedOrDeletedBy == undefined || widget.parameters.canBeAddedOrDeletedBy == IWidgetScope.user) {\n                matrixSession.serverConfig.currentUserSettings = matrixSession.serverConfig.currentUserSettings.filter((value, index, arr) => { return value.key != widget.id });\n                let data = {\n                    key: widget.id,\n                    value: \"\",\n                    reason: \"removing widget Setting\"\n                };\n                return restConnection.postServer(\"user/\" + matrixSession.getUser() + \"/setting\", data);\n            }\n        }\n        d.fail();\n        return d;\n    }\n    static canBeEdited(displayedWidget: IDisplayedWidget, configurator: ILineEditorLine[]): boolean {\n        if (displayedWidget.parameters.users != undefined && displayedWidget.parameters.users.length > 0) {\n            if (matrixSession.isAdmin()) \n                return true;\n            else\n                return false;\n        }\n\n        return (displayedWidget.parameters.canBeAddedOrDeletedBy == IWidgetScope.user\n            || (displayedWidget.parameters.canBeAddedOrDeletedBy == IWidgetScope.admin && matrixSession.isAdmin())\n            || (displayedWidget.parameters.canBeAddedOrDeletedBy == IWidgetScope.superAdmin && matrixSession.isSuperAdmin()))\n            && (configurator != undefined && configurator.length > 0);\n    }\n    static canBeDeleted(displayedWidget: IDisplayedWidget): boolean {\n     \n        if (displayedWidget.parameters.users != undefined && displayedWidget.parameters.users.length > 0) {\n            if (matrixSession.isAdmin()) \n                return true;\n            else\n                return false;\n        }\n\n        return (displayedWidget.parameters.canBeAddedOrDeletedBy == undefined || displayedWidget.parameters.canBeAddedOrDeletedBy == IWidgetScope.user\n            || (displayedWidget.parameters.canBeAddedOrDeletedBy == IWidgetScope.admin && matrixSession.isAdmin())\n            || (displayedWidget.parameters.canBeAddedOrDeletedBy == IWidgetScope.superAdmin && matrixSession.isSuperAdmin()));\n\n    }\n}\n","import {IDateTimeUI, ITimeZoneSetting} from \"./MatrixLibInterfaces\";\nimport {app, matrixSession, restConnection} from \"../../globals\";\nimport {ml} from \"../matrixlib\";\nimport {XRGetUser_User_UserType} from \"../../RestResult\";\nimport {XCPostAddProjectSetting} from \"../../RestCalls\";\nimport {IGetProjectResultDateInfo} from \"../businesslogic\";\nimport {DateTimeBL} from \"../businesslogic/DateTimeBL\";\n\nclass DateTimeUI  implements IDateTimeUI {\n    initDateTimeSettings(update?: boolean): Promise<void> {\n       return DateTimeBL.getInstance().initDateTimeSettings(update);\n    }\n    renderHumanDate(date: Date, dateOnly?: boolean): string {\n        return DateTimeBL.getInstance().renderHumanDate(date, dateOnly);\n    }\n    renderCustomerHumanDate(date: Date, dateOnly?: boolean): string {\n        return DateTimeBL.getInstance().renderCustomerHumanDate(date, dateOnly);\n    }\n    renderHumanMonth(dateObj: Date): string {\n        return  DateTimeBL.getInstance().renderHumanMonth(dateObj);\n    }\n    renderDashFormat(dateObj: Date): string {\n        return DateTimeBL.getInstance().renderDashFormat(dateObj);}\n\n    getSimpleDateFormat(): string {\n        return DateTimeBL.getInstance().getSimpleDateFormat();\n    }\n    getSimpleDateFormatMoment() {\n        return DateTimeBL.getInstance().getSimpleDateFormatMoment();\n    }\n    getSimpleDateTimeFormatMoment() {\n        return DateTimeBL.getInstance().getSimpleDateTimeFormatMoment();\n    }\n\n    // *******************************************************\n    // helper for ui to manage time and date settings\n    // *******************************************************\n\n    // gets the current server or user setting from the server and renders\n    // the controls to see and modify the settings\n    private async showControlsAsync(controlOptions: { table: JQuery, user: string, help: string }): Promise<void> {\n        let that = this;\n        let table = controlOptions.table;\n        // shows the time setting controls for the server or a user\n      let currentSettings  =  await  this.initAsync(controlOptions.user)\n       try\n       {\n            let tbody = $(\"tbody\", table);\n            tbody.append($('<tr><td colspan=\"2\" class=\"baseControlHelp\">' + controlOptions.help + '</td></tr>'));\n\n           let isUserOwnSetting = controlOptions.user && controlOptions.user.toLowerCase() === matrixSession.getUser().toLowerCase();\n           let isUserSetting = controlOptions.user;\n\n            that.renderDateTimeFormat(tbody, isUserSetting, isUserOwnSetting, currentSettings, \"timeformat\", \"Date Time Formatting\");\n            that.renderDateTimeFormat(tbody, isUserSetting, isUserOwnSetting, currentSettings, \"dateformat\", \"Date Only Formatting\");\n            that.renderTimeZone(tbody, isUserSetting, isUserOwnSetting, currentSettings, \"timezone\", controlOptions.user ? \"User Timezone\" : \"Server Timezone\");\n        }\n        catch (e) {\n            ml.UI.showError(\"Could not retrieve date time settings from server\", \"\");\n        }\n    }\n\n    // gets the server or user time/date settings from the server (if specified)\n\n    private renderDateTimeFormat(tableBody: JQuery, isUserSetting: string, isUserOwnSetting: boolean, currentSettings: ITimeZoneSetting, settingName: string, explanation: string): void {\n        let that = this;\n        let help = $('<a href=\"https://urlshort.matrixreq.com/d23/manual/datetime\" target=\"_blank\"><span style=\"top:-4px; margin: 0px 3px;font-size: 12px\" class=\"fal fa-info-circle\"></span></a>');\n        let timeUpdate: number;\n        let si = $('<input autocomplete=\"off\" type=\"text\" class=\"form-control admin_utime\">').on(\"keyup\", function () {\n            clearTimeout(timeUpdate);\n            timeUpdate = window.setTimeout(function () {\n                that.showTime(example, si.val());\n                if (example.html() === si.data(\"last_val\") || example.html() === \"\") {\n                    setb.prop('disabled', true);\n                    setb.removeClass(\"btn-success\");\n                    setb.addClass(\"btn-default\");\n                } else {\n                    setb.prop('disabled', false);\n                    setb.addClass(\"btn-success\");\n                    setb.removeClass(\"btn-default\");\n                }\n            }, 300);\n        });\n        let resetb = $(\"<button class='btn btn-default' style='margin-right:10px' >Reset</button>\").click(function () {\n\n            that.setSetting(isUserOwnSetting, currentSettings.settingsSource, settingName, \"\");\n                si.val(settingName === \"timeformat\" ? DateTimeBL.getInstance().serverDateTimeFormat : DateTimeBL.getInstance().serverDateOnlyFormat);\n                that.showTime(example, si.val());\n                si.data(\"last_val\", example.html());\n                setb.removeClass(\"btn-success\");\n                setb.addClass(\"btn-default\");\n                setb.prop('disabled', true);\n        });\n        let setb = $(\"<button class='btn btn-default' style='margin-right:10px' disabled>Use</button>\").click(async function () {\n                await that.setSetting(isUserOwnSetting, currentSettings.settingsSource, settingName, si.val())\n                si.data(\"last_val\", example.html());\n                setb.removeClass(\"btn-success\");\n                setb.addClass(\"btn-default\");\n                setb.prop('disabled', true);\n        });\n        let example = $('<span>');\n        let tr = $(\"<tr>\");\n        tableBody.append(tr);\n        tr.append($(\"<td class='admin_utdl'>\").append($(\"<label class='control-label'>\").html(explanation)).append(help));\n        tr.append($(\"<td>\").append(si));\n        tr.append($(\"<td>\").append(setb));\n        tr.append($(\"<td>\").append(resetb));\n        let tre = $(\"<tr style='vertical-align:top;height:36px'>\");\n        tableBody.append(tre);\n        tre.append($(\"<td>\"));\n        tre.append($(\"<td colspan='3' style='font-size:75%'>\").append(\"<span style='color:darkgrey'>Example: </span>\").append(example));\n        let cs: string = currentSettings[settingName] as string;\n        si.val(cs ? cs : (settingName === \"timeformat\" ? DateTimeBL.getInstance().serverDateTimeFormat : DateTimeBL.getInstance().serverDateOnlyFormat));\n        this.showTime(example, si.val());\n        si.data(\"last_val\", example.html());\n    }\n\n    private showTime(uic: JQuery, format: string): void {\n        let date = new Date(2014, 1, 15, 6, 23, 55);\n        let df = new SimpleDateFormat(format);\n        uic.html(df.format(date));\n    }\n\n    private async setSetting(isUserOwnSetting: boolean, serverOrUserPrefix: string, key: string, val: string): Promise<void> {\n\n        let that = this;\n        let postSetSetting: XCPostAddProjectSetting = {\n            value: val,\n            key: key,\n            reason: \"settings change\"\n        }\n       try{\n           await restConnection.postServer(serverOrUserPrefix, postSetSetting);\n           await that.initDateTimeSettings(true)\n       }\n        catch (e){\n            ml.UI.showError(\"Failed to change setting!\", \"\");\n            throw e;\n        }\n    }\n\n    private  renderTimeZone(tableBody: JQuery, isUserSetting: string, isUserOwnSetting: boolean, currentSettings: ITimeZoneSetting, settingName: string, explanation: string): void{\n\n        let that = this;\n\n        let dd = $('<select class=\"form-control admin_utime\">');\n        dd.change(function () {\n            example.html(\"\");\n            if (dd.val() === example.data(\"last_val\")) {\n                setb.removeClass(\"btn-success\");\n                setb.addClass(\"btn-default\");\n            } else {\n                setb.addClass(\"btn-success\");\n                setb.removeClass(\"btn-default\");\n            }\n        });\n        for (let idx = 0; idx < currentSettings.timeZoneOptions.length; idx++) {\n            dd.append($(\"<option value='\" + currentSettings.timeZoneOptions[idx].val + \"'>\" + currentSettings.timeZoneOptions[idx].text + \"</option>\"));\n        }\n\n        let resetb = $(\"<button class='btn btn-default' style='margin-right:10px'>Reset</button>\").click(   async () => {\n                await  that.setSetting(isUserOwnSetting, currentSettings.settingsSource, settingName, \"\");\n                dd.val(DateTimeBL.getInstance().serverTimezone);\n                example.html(that.renderTimeZoneWarning(isUserOwnSetting));\n                setb.removeClass(\"btn-success\");\n                setb.addClass(\"btn-default\");\n        });\n        let setb = $(\"<button class='btn btn-default' style='margin-right:10px'>Use</button>\").click(async  () => {\n            await that.setSetting(isUserOwnSetting, currentSettings.settingsSource, settingName, dd.val())\n            example.html(that.renderTimeZoneWarning(isUserOwnSetting));\n            setb.removeClass(\"btn-success\");\n            setb.addClass(\"btn-default\");\n        });\n        let example = $('<span style=\"color:red\">');\n        let tr = $(\"<tr>\");\n        tableBody.append(tr);\n        tr.append($(\"<td class='admin_utdl'>\").append($(\"<label class='control-label'>\").html(explanation)));\n        tr.append($(\"<td>\").append(dd));\n        tr.append($(\"<td>\").append(setb));\n        tr.append($(\"<td>\").append(resetb));\n        let tre = $(\"<tr>\");\n        tableBody.append(tre);\n        tre.append($(\"<td>\"));\n        tre.append($(\"<td colspan='3'>\").append(example));\n        let cs: string = currentSettings[settingName] as string;\n        dd.val(cs ? cs : DateTimeBL.getInstance().serverTimezone);\n        example.html(this.renderTimeZoneWarning(isUserOwnSetting)).data(\"last_val\", dd.val());\n    }\n\n    private renderTimeZoneWarning(isUserOwnSetting: boolean): string {\n        return (isUserOwnSetting && ml.UI.DateTime.requiresTimeZoneWarning()) ? \"the timezone of your PC seems different!\" : \"\";\n    }\n\n\n    // render user controls to see / change the settings\n    async renderSettingControlsAsync(options: { table: JQuery, user: string, help: string }) {\n         await this.showControlsAsync(options);\n    }\n\n    // shows a pop dialog with control to modify date time settings\n    renderSettingDialog(user: string): void {\n        app.dlgForm.hide();\n        app.dlgForm.html(\"\");\n        app.dlgForm.removeClass(\"dlg-no-scroll\");\n        app.dlgForm.addClass(\"dlg-v-scroll\");\n        let table = $(\"<table style='width:100%'><tbody/></table>\");\n\n        app.dlgForm.append(table);\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"User Date Time Settings: \" + user,\n            width: 700,\n            height: 430,\n            modal: true,\n            resizeStop: function () {\n                //We don't do anything here.\n            },\n            open:  async () => {\n                await ml.UI.DateTime.renderSettingControlsAsync({\n                    user: user,\n                    help: \"Settings\",\n                    table: table\n                });\n            },\n            buttons: [{\n                text: 'Ok',\n                class: 'btnDoIt',\n                click: function () {\n                    app.dlgForm.dialog(\"close\");\n                }\n            }\n            ]\n        });\n    }\n\n    // returns an empty string or a warning if the time zone on the PC is different to the server settings\n    requiresTimeZoneWarning(): boolean {\n        let d = new Date(DateTimeBL.getInstance().dateIso8601FromServer);\n        let ds = DateTimeBL.getInstance().simpleDateTimeFormat.format(d);\n        if (ds !== DateTimeBL.getInstance().dateUserFromServer) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    // return a clickable link button if there are timezone issues\n    getTimeZoneCTA(): JQuery {\n        if (!ml.UI.DateTime.requiresTimeZoneWarning()) {\n            return $(\"\");\n        }\n\n        let button = $(\"<button class='buttonCTA'></button>\").text(\"verify your time zone\").click(function () {\n            try {\n                if (app.dlgForm.dialog(\"isOpen\")) {\n                    app.dlgForm.dialog(\"close\");\n                }\n            } catch (exception) {\n                // nothing bad - it just means no dialog was ever opened before\n            }\n            matrixSession.changePassword();\n        });\n        return button;\n    }\n\n\n    protected async initAsync(user: string): Promise<ITimeZoneSetting> {\n        // returns the following settings from the server... currently 3 rest calls are needed\n        // if no user is passed the global server settings are retrieved\n        let result: ITimeZoneSetting = {\n            timeZoneOptions: [],\n            settingsSource: user ? (\"user/\" + user + \"/setting\") : \"all/setting\"\n        };\n        let allTimeZones  = <string[]> await restConnection.getServer(\"all/timezone\")\n\n        for (let idx = 0; idx < allTimeZones.length; idx++) {\n            result.timeZoneOptions.push({\n                val: allTimeZones[idx],\n                text: allTimeZones[idx]\n            });\n        }\n        // check for user overwrites\n        if (user) {\n            let userInfo = <XRGetUser_User_UserType> await restConnection.getServer(\"user/\" + user);\n            let settings = userInfo.userSettingsList;\n            for (let idx = 0; idx < settings.length; idx++) {\n                if (settings[idx].key === \"timeformat\") {\n                    result.timeformat = settings[idx].value;\n                }\n                if (settings[idx].key === \"dateformat\") {\n                    result.dateformat = settings[idx].value;\n                }\n                if (settings[idx].key === \"timezone\") {\n                    result.timezone = settings[idx].value;\n                }\n            }\n        }\n        return result;\n    }\n}\n\nexport {DateTimeUI};\n","import { globalMatrix, IStringMap } from \"./../../globals\";\nimport { ml } from \"./../matrixlib\";\nimport { IURLTools, IMatrixUrlParts } from \"./MatrixLibInterfaces\";\n\nexport { URLTools };\n\nclass URLTools implements IURLTools {\n\n    getParameterByName(url:string, name:string):string|null {\n        var match = RegExp('[?&]' + name + '=([^&]*)').exec(url);\n        return match && decodeURIComponent(match[1].replace(/\\+/g, ' '));\n    }\n    parseUrl( url:String ):IMatrixUrlParts {\n        let result:IMatrixUrlParts = {\n            project:\"\",\n            item:\"\",\n            params:{}\n        }\n\n        // remove https://server.matrixreq.com/\n        let noserver = url.replace(globalMatrix.matrixBaseUrl + \"/\", \"\").replace(globalMatrix.matrixBaseUrl, \"\").split(\"?\");\n        if ( noserver[0] ) {\n            let pi = noserver[0].split(\"/\");\n            result.project = pi[0];\n            result.item = pi.length>1?pi[1]:\"\";\n        }\n        if (noserver.length>1) {\n            let params = noserver[1].split(\"&\");\n            $.each(params, function(pidx,param) {\n                let firstE = param.indexOf(\"=\");\n                if (firstE == -1 ) {\n                    ml.Logger.log(\"warning\", \"invalid url parameter '\" + param + \"'\");\n                    return;\n                }\n                result.params[param.substr(0,firstE)] = decodeURIComponent(param.substr(firstE+1).replace(/\\+/g, ' '));\n            });\n        }\n\n        return result;\n    }\n};\n","import { IXPathTools, IXPathToolsComp } from \"./MatrixLibInterfaces\";\n\nexport { XPathTools };\n\nclass XPathTools implements IXPathTools {\n\n    constructor() {\n    }\n\n    get( node:JQuery ) {\n        var comp:IXPathToolsComp, comps:IXPathToolsComp[] = [];\n        \n        var xpath = '';\n        var getPos = function(element:Node) {\n            var position = 1, curNode:Node;\n            if (element.nodeType == Node.ATTRIBUTE_NODE) { return null;}\n            for (curNode = element.previousSibling; curNode; curNode = curNode.previousSibling){\n                if (curNode.nodeName == element.nodeName) { ++position;}\n            }\n            return position;\n        };\n        var element:Node = node[0];\n        if (element instanceof Document) {return '/';}\n        for (; element && !(element instanceof Document); element = element.nodeType == Node.ATTRIBUTE_NODE ? (<Attr>element).ownerElement : element.parentNode) {\n            comp = comps[comps.length] = <IXPathToolsComp>{};\n            switch (element.nodeType) {\n                case Node.TEXT_NODE:\n                    comp.name = 'text()';\n                    break;\n                case Node.ATTRIBUTE_NODE:\n                    comp.name = '@' + element.nodeName;\n                    break;\n                case Node.PROCESSING_INSTRUCTION_NODE:\n                    comp.name = 'processing-instruction()';\n                    break;\n                case Node.COMMENT_NODE:\n                    comp.name = 'comment()';\n                    break;\n                case Node.ELEMENT_NODE:\n                    comp.name = element.nodeName;\n                    break;\n            }\n            comp.position = getPos(element);\n        }\n        for (var i = comps.length - 1; i >= 0; i--) {\n            comp = comps[i];\n            xpath += '/' + comp.name.toLowerCase();\n            if (comp.position !== null) {xpath += '[' + comp.position + ']';}\n        }\n\n        return xpath;\n    };\n    \n    hardCopy(element:JQuery) {\n        // note this is used only by selenium top copy the attributes of a doc\n        $.each( element.find( \"select\"), function(idx, select) {\n              var selected = $(select).val();\n              $(select).find('option').prop('selected', false);\n              $(select).find('option').removeAttr('selected');\n              $(select).find(\"option[value='\" + selected + \"']\").prop('selected', true);\n              $(select).find(\"option[value='\" + selected + \"']\").attr('selected', 'selected');\n\n         });\n\n        $.each( element.find( \"input[type='checkbox']\"), function(idx, cb) {\n              $(cb).is(\":checked\")?$(cb).attr(\"checked\",\"checked\"):$(cb).removeAttr(\"checked\");\n        });\n         return element.html();\n    }                \n};","/// <reference types=\"matrixrequirements-type-declarations\" />\nimport { ControlState, IItemGet, IGenericMap, IItem, globalMatrix, app, matrixSession } from \"../../../globals\"\nimport { ItemControl } from \"../Components/ItemForm\"\nimport { IBaseControlOptions } from \"./BaseControl\"\nimport { DocBaseImpl, ISignaturesInfo } from \"./docBase.\"\nimport { ml } from \"./../../matrixlib\";\nimport { XRPostProject_LaunchReport_CreateReportJobAck } from \"../../../RestResult\";\nimport {FieldHandlerFactory, mDHF} from \"../../businesslogic/index\";\nimport {FieldDescriptions} from \"../../businesslogic/FieldDescriptions\";\nimport {EmptyFieldHandler} from \"../../businesslogic/FieldHandlers/EmptyFieldHandler\";\nimport {GenericFieldHandler} from \"../../businesslogic/FieldHandlers/GenericFieldHandler\";\n\nexport type {\n    IDocReviewOptions, IReviewData, IInlineComment, IInlineCommentRange, IAnnotationChange,\n    ISignature, ISignatureChange\n};\nexport { DocReviewImpl, HTMLAnnotator };\n\ninterface IDocReviewOptions extends IBaseControlOptions {\n    controlState?: ControlState,\n    canEdit?: boolean,\n    help?: string,\n    fieldValue?:string,\n    valueChanged?: Function,\n    parameter?: {\n        hideReview?:boolean, // hide option to leave 'inline' review comments\n        allowModifyOthers?:boolean // set to true to allow normal users to modify other people's comments\n\n    }\n}\n\ninterface IReviewData {\n    inlineComments:IInlineComment[]\n}\n\ninterface IInlineComment {\n    ranges:IInlineCommentRange[] , // positions\n    quote: string,//highlighted text\n    text:string, // comment\n    id:string // unique id\n    changedBy:string,\n    createdBy:string,\n    changedAt:string,\n    createdAt:string,\n    highlights?:JQuery[]\n}\ninterface IInlineCommentRange {\n    start:string,\n    startOffset:number,\n    end:string,\n    endOffset:number\n}\n\ninterface IAnnotationChange {\n    action:string,\n    value:IInlineComment;\n}\n\n$.fn.docReview = function(this:JQuery, options:IDocReviewOptions) {\n\n    if (!options.fieldHandler) {\n        //No need for a field handler here, so let's create a dummy one.\n        options.fieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, FieldDescriptions.Field_dummy, options);\n        options.fieldHandler.initData(options.fieldValue);\n    }\n    let baseControl = new DocReviewImpl(this, options.fieldHandler as GenericFieldHandler);\n    this.getController = () => { return baseControl;}\n    baseControl.init(options);\n\n    return this;\n}\n\ninterface ISignature {\n    orgid: string,\n    userid: string, signDate: string, signDateCustomer?: string, signaturefileid: string\n}\n\ninterface ISignatureChange {\n    action:string,\n    value:string\n}\n\n\nclass DocReviewImpl extends DocBaseImpl {\n\n    private settings: IDocReviewOptions;\n    private data:IReviewData;\n    private annotationRecording: IAnnotationChange[];\n    private commentSortedBy:number;\n    private uiCtrl:JQuery;\n    private reportBuffer:string;\n\n    constructor(control: JQuery, fieldHandler: GenericFieldHandler) {\n        super(control,fieldHandler);\n    }\n\n    init( options:IDocReviewOptions ) {\n        let that = this;\n        this.annotationRecording = [];\n\n        if (options.controlState == ControlState.Print || options.controlState == ControlState.Tooltip || options.controlState == ControlState.HistoryView ) {\n            return;\n        }\n\n        this._root.append(super.createHelp(options));\n        this.uiCtrl = $(\"<div style='margin-top:6px' class='baseControl'>\").appendTo(this._root);\n\n        let defaultOptions = {\n            controlState: ControlState.FormView, // read only rendering\n            canEdit: false, // whether data can be edited\n            valueChanged: function () {\n            }, // callback to call if value changes\n            parameter: {\n                // item the item containing the rest of the information\n            }\n        };\n        this.settings = <IDocReviewOptions> ml.JSON.mergeOptions(defaultOptions, options);\n\n        // changes shall not overwrite other people's changes\n        this.needsLatest=true;\n\n        this.data = this.parseValue( this.settings.fieldValue);\n\n        let signatureStatus = DocBaseImpl.readSignatureInfo(this.settings.item);\n\n\n        // show the comment dialog button\n        if (!this.settings.parameter.hideReview) {\n            this.reviewButton(signatureStatus);\n        }\n    }\n\n    // initialize options\n    // public interface\n    async hasChangedAsync () {\n        return this.annotationRecording && this.annotationRecording.length>0;\n    }\n\n    async getValueAsync(currentItem?:IItemGet) {\n        if (currentItem) {\n            var currentValue = this.parseValue( (<{[key:number]:string}>currentItem)[this.settings.fieldId]);\n\n            currentValue = this.applyRecordings(currentValue);\n\n            return JSON.stringify(currentValue);\n        } else {\n            return JSON.stringify(this.data);\n        }\n    }\n\n    destroy() {\n        this.reportBuffer = \"\";\n    }\n\n    resizeItem () {\n    }\n\n    private applyRecordings( currentValue:IReviewData ):IReviewData {\n        $.each(this.annotationRecording, function(aidx, record) {\n            // if there is already an comment with this id: delete it\n            currentValue.inlineComments = currentValue.inlineComments.filter( function(r) {\n                return record.value.id != r.id;\n            });\n            switch (record.action){\n                // re(add) it\n                case \"add\":\n                case \"update\":\n                    currentValue.inlineComments.push(record.value);\n                    break;\n            }\n        });\n        return currentValue;\n    }\n\n    private parseValue( fieldVal:string ) {\n        if (fieldVal) {\n            return <IReviewData>JSON.parse(fieldVal);\n        } else {\n            return <IReviewData> {\n                inlineComments: []\n            }\n        }\n    }\n\n    /********************************************\n\n     ******************************************** */\n    // show button to allow user to comment on document\n    protected reviewButton(signatureStatus: ISignaturesInfo) {\n        let that = this;\n\n        if (this.settings.parameter.hideReview ) {\n            return;\n        }\n\n        let canEdit = matrixSession.isEditor();\n        var button = $(`<button class='btn btn-default docActionButton'>${canEdit?\"Review and add comments\":\"Review comments\"}</button>`).click(function () {\n\n            app.getItemAsync(that.settings.id).done(function (item: IItemGet) {\n                let mostRecentCommentField = (<IGenericMap>item)[that.settings.fieldId];\n                let mostRecentComments: IInlineComment[] = [];\n                if ( mostRecentCommentField) {\n                    let rd = <IReviewData>JSON.parse(mostRecentCommentField);\n                    if (rd && rd.inlineComments) {\n                        rd = that.applyRecordings( rd );\n                        mostRecentComments = rd.inlineComments;\n                    }\n                }\n                that.showReviewComments(canEdit,mostRecentComments);\n            });\n        });\n        if ((this.data.inlineComments && this.data.inlineComments.length > 0) || canEdit) {\n            this.uiCtrl.append(button);\n            this.uiCtrl.append(\"<span class='searchResult'>there are <span id='currentComments'>\" + (this.data.inlineComments?this.data.inlineComments.length:0) + \"</span> comments</span>\");\n        }\n    }\n\n    recordAnnotation( action:string, annotation: IInlineComment) {\n        this.annotationRecording.push({ action: action, value: annotation} );\n\n        let rd = this.applyRecordings( ml.JSON.clone(this.data) );\n        this.showComments(rd.inlineComments);\n    }\n\n    // show dialog to allow user to comment on document\n    protected showReviewComments(canEdit: boolean, comments: IInlineComment[]) {\n\n        let that = this;\n        let reportProc:number;\n\n        // make dialog UI: table left comments, right preview area\n        let preview = $(\"<div id='previewDiv' class='reviewDlgBox '>\");\n        let commentBar = $(\"<div  class='reviewDlgBox commentBarBox'>\");\n\n        let sort = $(\"<div class='commentOrder'>\").appendTo(commentBar).html(\"Sort by: \");\n        $(\"<div id='commentBarDiv'>\").appendTo(commentBar)\n        let ds = $(\"<button class='sortButton nav-link btn-xs'>Creation Date<div class='commentSort' /></button>\").appendTo(sort).click(function () {\n            that.sortCommentsBy(1);\n        });\n        $(\"<button class='sortButton  nav-link btn-xs'>Creator<div class='commentSort' /></button>\").appendTo(sort).click(function () {\n            that.sortCommentsBy(2);\n        });\n        $(\"<button class='sortButton  nav-link btn-xs'>Location<div class='commentSort' /></button>\").appendTo(sort).click(function () {\n            that.sortCommentsBy(3);\n        });\n        let table = $(\"<table style='width:100%'>\");\n        table.append( $(\"<tr>\").append($(\"<td class='commentBar'>\").append(commentBar)).append($(\"<td class='commentDoc'>\").append(preview)));\n        preview.append(ml.UI.getSpinningWait(\"retrieving document...\"));\n\n        // show dialog\n        app.dlgForm.html(\"\").append(table);\n\n        app.dlgForm.removeClass(\"dlg-v-scroll\");\n        app.dlgForm.addClass(\"dlg-no-scroll\");\n\n        app.dlgForm.dialog({\n            autoOpen: true,\n            title: \"Add comments below\",\n            height: app.itemForm.height() * 0.9,\n            width: $(document).width() * 0.9,\n            modal: true,\n            close: function () {\n                // dlg is gone\n            },\n            open: function () {\n                that.commentSortedBy = 1;\n                that.showComments(comments);\n                // start recording\n                let height = app.dlgForm.height();\n                preview.height( height-1 );\n                commentBar.height( height-1 );\n            },\n            resizeStop: function (event, ui) {\n                app.dlgForm.resizeDlgContent([]);\n                let height = app.dlgForm.height();\n                preview.height( height-1 );\n                commentBar.height( height-1 );\n            },\n            buttons: [{\n                text:'OK',\n                class:'btnDoIt',\n                click:function () {\n                    that.settings.valueChanged();\n                    let commentCount =  (that.data.inlineComments?that.data.inlineComments.length:0);\n                    $.each(that.annotationRecording, function(idx, ar) {\n                        switch (ar.action) {\n                            case \"add\":\n                                commentCount++;\n                                break;\n                            case \"delete\":\n                                commentCount--;\n                                break;\n                        }\n                    });\n                    $(\"#currentComments\").html( \"\"+ commentCount );\n                    app.dlgForm.dialog(\"close\");\n                }\n            }]\n        }).resizeDlgContent([], false);\n        if ( this.reportBuffer) {\n            // used cached html\n             that.showReportWithComments(preview, comments, canEdit);\n        } else {\n            app.startCreateDocumentAsync(this.settings.item.id, { format: \"html\" }).done(function (result: XRPostProject_LaunchReport_CreateReportJobAck) {\n                mDHF.loadDocument(result.jobId, function(htmlDOM:any) {\n                    that.reportBuffer = htmlDOM;\n                    that.showReportWithComments(preview, comments, canEdit);\n                })\n            });\n        }\n    }\n\n    private showReportWithComments( preview:JQuery, comments:IInlineComment[], canEdit:boolean) {\n        preview.html(\"\");\n        preview.append(this.reportBuffer).annotator( {\n            readOnly:!canEdit});\n        preview.data('annotator');\n\n        preview.annotator(\"loadAnnotations\", comments);\n        preview.annotator('addPlugin', 'IO', true);\n        preview.data(\"instance\", this);\n    }\n\n    private showComments(comments: IInlineComment[]) {\n        if (!comments || comments.length === 0) {\n            $(\"#commentBarDiv\").html(\"<span class='searchResult'>no comments</span>\");\n            return;\n        }\n        let preview = $(\"#previewDiv\")\n        $(\"#commentBarDiv\").html(\"\");\n        $.each(comments, function (idx,comment) {\n            let cui = $(\"<div class='commentUI'>\").appendTo($(\"#commentBarDiv\"));\n            let tr = $(\"<div class='commenttr'>\").appendTo(cui);\n            if (comment.changedBy === matrixSession.getUser()) {\n                tr.addClass(\"myComment\");\n            }\n            $(\"<div class='commentUser'>\").appendTo(tr).html(comment.changedBy);\n            $(\"<div class='commentDate'>\").appendTo(tr).html(ml.UI.DateTime.renderHumanDate(new Date(comment.changedAt),false) );\n            $(\"<div class='commentText'>\").appendTo(cui).html(comment.text);\n            cui.data(\"date\", comment.changedAt);\n            cui.data(\"id\", comment.id);\n            cui.data(\"user\", comment.changedBy);\n            cui.click(function(event: JQueryMouseEventObject) {\n                $(\".selectedAnnotation\").removeClass(\"selectedAnnotation\");\n                $(\".selectedComment\").removeClass(\"selectedComment\");\n                let box = $(event.delegateTarget).addClass(\"selectedComment\");\n                let anno = $(\"[data-annotation-id='\"+box.data(\"id\")+\"']\");\n                anno.addClass(\"selectedAnnotation\");\n                // pos absolut in box\n                let offset = anno.offset().top - preview.offset().top;\n                let visibleTop = preview.scrollTop();\n\n                if ( offset < 0 ) {\n                    preview.scrollTop(  visibleTop +  offset );\n                } else if (offset > preview.height()-20) {\n                    preview.scrollTop(visibleTop + (offset - preview.height() + 20) );\n                }\n            });\n        });\n        this.sortCommentsBy(3);\n    }\n\n    public sortCommentsBy( sortBy:number ) {\n        let that = this;\n        if ( sortBy ) {\n            this.commentSortedBy = ( this.commentSortedBy === sortBy)?-sortBy:sortBy;\n        }\n        $(\".commentSortDown\").removeClass(\"commentSortDown\");\n        $(\".commentSortUp\").removeClass(\"commentSortUp\");\n\n        $(\".commentSort\", $(\".sortButton\")[Math.abs(this.commentSortedBy)-1]).addClass(this.commentSortedBy>0?\"commentSortDown\":\"commentSortUp\");\n        $('.commentUI').toArray().sort(function (a, b) {\n            let fv: string|number = \"\";\n            let sv: string|number = \"\";\n            let swap = false;\n\n            switch (that.commentSortedBy ) {\n                case 1:\n                    fv = $(a).data(\"date\");\n                    sv = $(b).data(\"date\");\n                    swap = fv > sv;\n                    break;\n                case -1:\n                    fv = $(a).data(\"date\");\n                    sv = $(b).data(\"date\");\n                    swap = fv < sv;\n                    break;\n                case 2:\n                    fv = $(a).data(\"user\");\n                    sv = $(b).data(\"user\");\n                    swap = fv > sv;\n                    break;\n                case -2:\n                    fv = $(a).data(\"user\");\n                    sv = $(b).data(\"user\");\n                    swap = fv < sv;\n                    break;\n                case 3:\n                    var f = $(\"[data-annotation-id='\" + $(a).data(\"id\") + \"']\").offset();\n                    var s = $(\"[data-annotation-id='\" + $(b).data(\"id\") + \"']\").offset();\n                    swap = f.top > s.top || (f.top === s.top && f.left > s.left );\n                    break;\n                case -3:\n                    var f = $(\"[data-annotation-id='\" + $(a).data(\"id\") + \"']\").offset();\n                    var s = $(\"[data-annotation-id='\" + $(b).data(\"id\") + \"']\").offset();\n                    swap = f.top < s.top || (f.top === s.top && f.left < s.left );\n            }\n            // swap in UI\n            if ( swap ) {\n                // create marker element and insert it where obj1 is\n                var temp = document.createElement(\"div\");\n                a.parentNode.insertBefore(temp, a);\n\n                // move obj1 to right before obj2\n                b.parentNode.insertBefore(a, b);\n\n                // move obj2 to right before where obj1 used to be\n                temp.parentNode.insertBefore(b, temp);\n\n                // remove temporary marker node\n                temp.parentNode.removeChild(temp);\n            }\n            // sort array\n            return swap ? 1 : -1;\n        });\n    }\n\n};\n\n\n// allows user to add annotations / linked to some html\nclass HTMLAnnotator {\n\n    private annotationsBefore:IReviewData; // date before editing starts\n    private annotationsAfter:IReviewData; // date before editing starts\n    private commentSortedBy:number;\n\n    constructor( ) {\n\n    }\n\n    // initialize options\n    // public interface\n    hasChanged () {\n        return this.annotationsAfter && JSON.stringify( this.annotationsAfter ) != JSON.stringify( this.annotationsBefore );\n    }\n\n   async getValueAsync() {\n        return JSON.stringify(this.annotationsAfter);\n    }\n\n    destroy() {\n    }\n\n    resizeItem () {\n    }\n\n    /**\n     * this function merges annotations done locally with the changes happened in parallel on the server.\n     *\n     * @param serverVersion these are the annotations last saved (by another user)\n     * @param localBefore these are the ones which existed locally, before starting to edit\n     * @param localAfter  these are the ones which existed locally when user saves\n     * @returns\n     */\n    static mergeAnnotation(serverVersion:string, localBefore:string, localAfter:string):string {\n        if (!serverVersion) return localAfter; // currently no annotations on the server, so all local ones are to be taken\n        if (!localAfter) return serverVersion; // locally were were no changes and there are no changes (so nothing got added or deleted) -> the server is still good\n        if (localAfter == localBefore) return serverVersion; // nothing changed locally so the server is still good\n\n        let server:IInlineComment[] = (<IReviewData>JSON.parse(serverVersion)).inlineComments;\n        let after:IInlineComment[] = (<IReviewData>JSON.parse(localAfter)).inlineComments;\n\n        if ( localBefore ) {\n            // we need to update the annotations coming from the server:\n\n            let before:IInlineComment[] = (<IReviewData>JSON.parse(localBefore)).inlineComments;\n            let beforeId:string[] = before.map( function(comment) { return comment.id;});\n            let afterId:string[] = after.map( function(comment) { return comment.id;});\n\n            // update everything which CHANGED locally\n            for ( let comment of server) {\n                if (beforeId.includes(comment.id) && afterId.includes(comment.id)) {\n                    // possible it changed\n                    let b = before.filter( c => c.id == comment.id)[0];\n                    let a = after.filter( c => c.id == comment.id)[0];\n                    if ( JSON.stringify(a)!=JSON.stringify(b)) {\n                        // it did change\n                        comment.changedAt = a.changedAt;\n                        comment.changedBy = a.changedBy;\n                        comment.highlights = a.highlights;\n                        comment.quote = a.quote;\n                        comment.ranges = a.ranges;\n                        comment.text = a.text;\n                    }\n\n                }\n            }\n\n            // now  remove all annotations from the server if they were removed locally\n            server = server.filter( function(comment) {\n                // keep it IF it did not exist before or if it still exists\n                return !beforeId.includes(comment.id) || afterId.includes(comment.id)\n            });\n\n            // now add all annotations which were added locally\n            let added = after.filter( comment => !beforeId.includes(comment.id));\n            if (added.length) {\n                server = server.concat(added);\n            }\n\n\n        } else {\n\n            // add all comments were created locally so they can just be added\n            server = server.concat( after );\n        }\n        return JSON.stringify({inlineComments:server});\n    }\n\n    static hasAnnotations( reviewComments:string ) {\n        if (!reviewComments) return false;\n        return (<IReviewData>JSON.parse(reviewComments)).inlineComments.length>0;\n    }\n\n\n    // show dialog to allow user to comment on document\n    showReviewDialog(canEdit: boolean, itemId:string, version:number, data:IItem, reviewComments:string, isSuperUser:boolean, onUpdate:Function ) {\n\n        let that = this;\n\n        let reviewItem = $(\"<div class=''>\");\n\n        this.annotationsBefore = reviewComments?(<IReviewData>JSON.parse(reviewComments)):{inlineComments:[]};\n        this.annotationsAfter = reviewComments?(<IReviewData>JSON.parse(reviewComments)):{inlineComments:[]};\n\n        // make dialog UI: table left comments, right preview area\n        let preview = $(\"<div id='previewDiv' class='reviewDlgBox'>\").append( reviewItem );\n\n        let commentBar = $(\"<div  class='reviewDlgBox commentBarBox'>\");\n        let sort = $(\"<div  class='commentOrder'>\").appendTo(commentBar).html(\"Sort by: \");\n        $(\"<div id='commentBarDiv'>\").appendTo(commentBar)\n        $(\"<button class='sortButton btn btn-default btn-xs'>Creation Date<div class='commentSort' /></button>\").appendTo(sort).click(function () {\n            that.sortCommentsBy(1);\n        });\n        $(\"<button class='sortButton btn btn-default btn-xs'>Creator<div class='commentSort' /></button>\").appendTo(sort).click(function () {\n            that.sortCommentsBy(2);\n        });\n        $(\"<button class='sortButton btn btn-default btn-xs'>Location<div class='commentSort' /></button>\").appendTo(sort).click(function () {\n            that.sortCommentsBy(3);\n        });\n        let table = $(\"<table style='width:100%'>\");\n        table.append( $(\"<tr>\").append($(\"<td class='commentDoc'>\").append(preview)).append($(\"<td class='commentBar'>\").append(commentBar)));\n\n        // show dialog\n\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n\n        ml.UI.showDialogDes({\n            container:dlg,\n            content:table,\n            title:\"Add/Edit Comments\",\n            noXButton:true,\n            noCloseOnEscape:true,\n            autoResize:true,\n            maximizeButton:true,\n            buttons:[{\n                text:'OK',\n                class:'btnDoIt',\n                click:function () {\n                    onUpdate( );\n                    dlg.dialog(\"close\");\n                }\n            }],\n            onOpen: async () => {\n                // start drawing item\n                let itemForm = new ItemControl(<any>{\n                    control: reviewItem,\n                    controlState: ControlState.Review,\n                    isHistory: version,\n                    type: ml.Item.parseRef(itemId).type,\n                    item: data,\n                    isItem: true,\n                    parameter: {\n                        reviewMode: true\n                    },\n                    changed: function () {\n                    }\n                });\n                await itemForm.load();\n\n                that.commentSortedBy = 1;\n                that.showCommentList(that.annotationsBefore.inlineComments);\n                $(\".panel-body-v-scroll\", reviewItem).css(\"text-align\", \"initial\");\n                $(\".panel-body-v-scroll\", reviewItem).css(\"overflow-x\", \"auto\");\n                // start recording\n                let height = dlg.height();\n                preview.height(height - 1);\n                commentBar.height(height - 1 - (commentBar.outerHeight() - commentBar.height())); // take padding into account\n                // show annotations\n                window.setTimeout(function () {\n                    // give it some time to redraw / resize tables (itemForm resize, 299)\n                    that.showHTMLWithComments(reviewItem, that.annotationsBefore.inlineComments, canEdit, isSuperUser);\n                    // fix layout\n                    $(\".itemTitleBarNoToolsNoEdit\", reviewItem).css(\"height\", \"\");\n                    $(\".itemTitle\", reviewItem).removeClass(\"pull-left\").css(\"max-width\", \"100%\");\n                }, 301);\n\n            },\n            onResize: () => {\n                dlg.resizeDlgContent([]);\n                let height = dlg.height();\n                preview.height( height-1 );\n                commentBar.height( height-1 - (commentBar.outerHeight()-commentBar.height())); // take padding into account\n            },\n            onClose:() => { dlg.remove();}\n        })\n    }\n\n    protected recordAnnotation( action:string, annotation: IInlineComment) {\n\n        // in remove the previous value for the annotation with this id\n        this.annotationsAfter.inlineComments = this.annotationsAfter.inlineComments.filter( function(r) {\n            return annotation.id != r.id;\n        });\n        // unless the action is a delete re-add it\n        switch (action){\n            // re(add) it\n            case \"add\":\n            case \"update\":\n                this.annotationsAfter.inlineComments.push(annotation);\n                break;\n        }\n        // update ui\n        this.showCommentList(this.annotationsAfter.inlineComments);\n    }\n\n    private showHTMLWithComments( preview:JQuery,  comments:IInlineComment[], canEdit:boolean, isSuperUser:boolean) {\n        let that = this;\n\n        preview.annotator( {\n            readOnly:!canEdit\n        });\n        preview.data('annotator');\n\n        preview.annotator(\"loadAnnotations\", comments);\n        preview.annotator('addPlugin', 'IO', isSuperUser);\n        preview.data(\"instance\", this);\n\n        // sort comment by place in UI (wait a bit so that UI is ready)\n        window.setTimeout( function() {\n            that.sortCommentsBy(-3);\n        }, 1000);\n    }\n\n    private showCommentList(comments: IInlineComment[]) {\n        if (!comments || comments.length === 0) {\n            $(\"#commentBarDiv\").html(\"<span class='searchResult'>no comments</span>\");\n            return;\n        }\n        let preview = $(\"#previewDiv\")\n        $(\"#commentBarDiv\").html(\"\");\n        $.each(comments, function (idx,comment) {\n            let cui = $(\"<div class='commentUI'>\").appendTo($(\"#commentBarDiv\"));\n            let tr = $(\"<div class='commenttr'>\").appendTo(cui);\n            if (comment.changedBy === matrixSession.getUser()) {\n                tr.addClass(\"myComment\");\n            }\n            $(\"<div class='commentUser'>\").appendTo(tr).html(comment.changedBy);\n            $(\"<div class='commentDate'>\").appendTo(tr).html(ml.UI.DateTime.renderHumanDate(new Date(comment.changedAt),false) );\n            $(\"<div class='commentText'>\").appendTo(cui).html(comment.text);\n            cui.data(\"date\", comment.changedAt);\n            cui.data(\"id\", comment.id);\n            cui.data(\"user\", comment.changedBy);\n            cui.click(function(event: JQueryMouseEventObject) {\n                $(\".selectedAnnotation\").removeClass(\"selectedAnnotation\");\n                $(\".selectedComment\").removeClass(\"selectedComment\");\n                let box = $(event.delegateTarget).addClass(\"selectedComment\");\n                let anno = $(\"[data-annotation-id='\"+box.data(\"id\")+\"']\");\n                anno.addClass(\"selectedAnnotation\");\n                // pos absolut in box\n                let offset = anno.offset().top - preview.offset().top;\n                let visibleTop = preview.scrollTop();\n\n                if ( offset < 0 ) {\n                    preview.scrollTop(  visibleTop +  offset );\n                } else if (offset > preview.height()-20) {\n                    preview.scrollTop(visibleTop + (offset - preview.height() + 20) );\n                }\n            });\n        });\n\n    }\n\n    private sortCommentsBy( sortBy:number ) {\n        let that = this;\n        if ( sortBy ) {\n            this.commentSortedBy = ( this.commentSortedBy === sortBy)?-sortBy:sortBy;\n        }\n        $(\".commentSortDown\").removeClass(\"commentSortDown\");\n        $(\".commentSortUp\").removeClass(\"commentSortUp\");\n\n        $(\".commentSort\", $(\".sortButton\")[Math.abs(this.commentSortedBy)-1]).addClass(this.commentSortedBy>0?\"commentSortDown\":\"commentSortUp\");\n        let comments = $('.commentUI').toArray();\n        comments.sort(function (a, b) {\n            let fv: string|number = \"\";\n            let sv: string|number = \"\";\n            let swap = false;\n            switch (that.commentSortedBy ) {\n                case 1:\n                    fv = $(a).data(\"date\");\n                    sv = $(b).data(\"date\");\n                    swap = fv > sv;\n\n                    break;\n                case -1:\n                    fv = $(a).data(\"date\");\n                    sv = $(b).data(\"date\");\n                    swap = fv < sv;\n\n                    break;\n                case 2:\n                    fv = $(a).data(\"user\");\n                    sv = $(b).data(\"user\");\n                    swap = fv > sv;\n\n                    break;\n                case -2:\n                    fv = $(a).data(\"user\");\n                    sv = $(b).data(\"user\");\n                    swap = fv < sv;\n\n                    break;\n                case 3:\n                    var f = $(\"[data-annotation-id='\" + $(a).data(\"id\") + \"']\").offset();\n                    var s = $(\"[data-annotation-id='\" + $(b).data(\"id\") + \"']\").offset();\n\n                    swap = f.top > s.top || (f.top === s.top && f.left > s.left );\n\n                    break;\n                case -3:\n                    var f = $(\"[data-annotation-id='\" + $(a).data(\"id\") + \"']\").offset();\n                    var s = $(\"[data-annotation-id='\" + $(b).data(\"id\") + \"']\").offset();\n                    swap = f.top < s.top || (f.top === s.top && f.left < s.left );\n\n            }\n\n            // sort array\n            return swap ? -1 : 1;\n        });\n        // now repaint the UI, sorted\n        //$(\"#commentBarDiv\").html(\"\");\n        $.each(comments, function(idx, commentBox) {\n            $(\"#commentBarDiv\").append(commentBox);\n        });\n    }\n};\n\nAnnotator.Plugin.IO = function (this: any, element: any, options: any) {\n    Annotator.Plugin.superUser = <boolean>options;\n    Annotator.Plugin.apply(this, arguments);\n};\n\n\nfunction getAnnotation(obj: IInlineComment): IInlineComment {\n    var cp = <IInlineComment>ml.JSON.clone(obj);\n    cp.highlights = [];\n    return <IInlineComment>cp;\n}\n\n$.extend(Annotator.Plugin.IO.prototype, new Annotator.Plugin(), {\n    events: {\n    },\n    options: {\n\n    },\n    pluginInit: function (this: { annotator: Annotator.AnnotatorObj }) {\n        let that = this;\n\n        this.annotator\n        .subscribe( \"annotationEditorShown\", function( this:Node, editor:any) {\n            let leftBox = $(this).offset().left;\n            let widthBox = $(this).width();\n\n            let editorBox = $(\"#\"+editor.fields[0].id);\n            let leftEditor = editorBox.offset().left;\n            let widthEditor = editorBox.width();\n\n            let anchorX = leftEditor + 20;\n\n            let anchorRight = editorBox.closest(\".annotator-editor\").hasClass(\"annotator-invert-x\");\n            if (anchorRight) {\n                anchorX = leftEditor + widthEditor - 20;\n            }\n            // check if box needs to be flipped\n            if (anchorX - leftBox < widthBox / 2) {\n                // box is in left half and should open to right\n                editorBox.closest(\".annotator-editor\").removeClass(\"annotator-invert-x\");\n                editorBox.css(\"max-width\", (widthBox + leftBox - anchorX)+\"px\");\n            } else {\n                // right half: open to left\n                editorBox.closest(\".annotator-editor\").addClass(\"annotator-invert-x\");\n                editorBox.css(\"max-width\", (anchorX-leftBox)+\"px\");\n            }\n        })\n        .subscribe( \"annotationViewerShown\", function( this:Node, annotation:any) {\n\n            let widthPanel = $(this).width();\n\n            let viewerPos = $(annotation.element).position().left;\n            let viewerWidth = $(\".annotator-widget\", $(annotation.element)).width();\n            if (viewerPos - viewerWidth < 10 ) {\n                // make sure the viewer opens to the right\n                $(annotation.element).removeClass(\"annotator-invert-x\");\n            }\n            if (widthPanel - viewerWidth - 10 < viewerPos  ) {\n                // make sure the viewer opens to the left\n                $(annotation.element).addClass(\"annotator-invert-x\");\n            }\n\n        })\n        .subscribe(\"annotationCreated\", function (this:Node, annotation:IInlineComment) {\n\n            annotation.id = new Date().getTime().toString();\n            annotation.createdBy = annotation.changedBy = matrixSession.getUser();\n            annotation.createdAt = annotation.changedAt = new Date().toISOString();\n            $(annotation.highlights[0]).attr(\"data-annotation-id\", annotation.id);\n            (<DocReviewImpl>$(this).data(\"instance\")).recordAnnotation( \"add\", getAnnotation( annotation ) );\n        })\n        .subscribe(\"annotationUpdated\", function (this:Node, annotation:IInlineComment) {\n            annotation.changedBy = matrixSession.getUser();\n            annotation.changedAt = new Date().toISOString();\n            (<DocReviewImpl>$(this).data(\"instance\")).recordAnnotation( \"update\", getAnnotation( annotation ) );\n        })\n        .subscribe(\"annotationDeleted\", function (this:Node, annotation:IInlineComment) {\n             (<DocReviewImpl>$(this).data(\"instance\")).recordAnnotation( \"delete\",  getAnnotation( annotation ) );\n        })// wait until all annotations are shown and sort the bar on the right\n        .viewer.addField({\n            load: function(field:Node, annotation: IInlineComment, controls: {hideEdit: () => any, hideDelete: () => any}) {\n                $(field).html(annotation.createdBy).addClass(\"annotator-user\")\n                if (controls) {\n                    if (!Annotator.Plugin.superUser && annotation.createdBy !== matrixSession.getUser()) {\n                        controls.hideEdit()\n                        return controls.hideDelete()\n                    }\n                }\n            }\n        });\n    }\n});\n","import {\n    ColumnEditor, FieldHandlerFactory,\n    IDHFPasteBuffer,\n    IExternalItem,\n    IPlugin,\n    IPluginPanelOptions,\n    IProjectPageParam, ISearchResult,\n    mDHF,\n    plugins,\n    Tasks\n} from \"../../common/businesslogic/index\";\nimport {ml} from \"../../common/matrixlib\"\nimport { ILabelTools, UIToolsConstants } from \"../../common/matrixlib/MatrixLibInterfaces\"\nimport {ItemControl, SelectMode} from \"../../common/UI/Components/index\"\nimport {BaseControl, IBaseControlOptions} from \"../../common/UI/Controls/BaseControl\"\nimport {HTMLAnnotator, IReviewData} from \"../../common/UI/Controls/docReview\"\nimport {IDropdownParams} from \"../../common/UI/Controls/dropdown\"\nimport { ITableControlOptions } from \"../../common/UI/Controls/tableCtrl\"\nimport {HistoryTools} from \"../../common/UI/Tools/ItemHistoryView\"\nimport {ItemSelectionTools} from \"../../common/UI/Tools/ItemSelectionView\"\n\nimport {IDropdownOption, IFieldDescription, ILabelLockConfig} from \"../../ProjectSettings\"\nimport { XRGetProject_Needle_TrimNeedle, XRLabelHistory, XRTrimNeedle, XRTrimNeedleItem } from \"../../RestResult\";\nimport {ReviewContextFrame} from \"./ReviewContextFrame\"\nimport {\n    app,\n    ControlState,\n    globalMatrix,\n    IGenericMap,\n    IItem,\n    IItemGet,\n    IItemGetMap,\n    IItemPut,\n    IReference,\n    IStringMap,\n    IStringNumberMap,\n    IStringStringArrayMap,\n    matrixApplicationUI,\n    matrixSession,\n    restConnection\n} from \"../../globals\"\nimport {FieldDescriptions} from \"../../common/businesslogic/FieldDescriptions\";\nimport {EmptyFieldHandler} from \"../../common/businesslogic/FieldHandlers/EmptyFieldHandler\";\nimport {GenericFieldHandler} from \"../../common/businesslogic/FieldHandlers/GenericFieldHandler\";\n\nexport type {\n    IReviewConfig, ICreateDoc, IReviewAction, IMailAction, ILockAction, IReviewStatusUpdate,\n    IReviewActionCategoryLabel, IReviewConfigTask, ITableReviewData, INeedleMap, IItemReviews,\n    IItemReview, IReviewControlOptions\n};\nexport { ReviewControlColumns };\nexport {ReviewControlImpl};\nexport {ScheduleReview};\nexport {initialize};\n\ninterface IReviewConfig {\n    // this configures tool available to manage review\n    tasks?: IReviewConfigTask, // to be configured if (jira) tasks should be created\n    lockLabel?: ILockAction, // action to lock items\n    doneLabel?: IReviewStatusUpdate, // action to parse review table to set labels depending on status\n    mailTo?: IMailAction, // button to mail to users\n    allowSelectUserGroups?: boolean, // if not set to false the reviewer popup will have the possibility to select groups\n    showVersions?: boolean, // if true show reviewed version in table for each item\n    showAnnotations?: boolean, // if true show annotation button\n    annotationMasters?: string[], // names of users who can edit other peoples comments\n    showComments?: boolean, // if true show review comment in table for each item\n    showInline?: boolean, // if true show inline triangle/text\n    showHistory?: boolean, // if true show history button for each item\n    /** like showHistoryOutOfDate but it only shows items as out of date if review is not yet completed */\n    showHistoryOutOfDateBeforeDone?: boolean,\n    /** shows items as out of date if current revision is newer than the one in the review */\n    showHistoryOutOfDate?: boolean,\n    readonly?: boolean,\n    appendComments?: boolean // if true put new comments at bottom of comment fields\n    statusDropdown?: string // can be set to overwrite the default status label \"dd_reviewOptions\"\n    canBeModified?: boolean // can be set to true if review can be modified (add/remove users/items)\n    canBeModifiedBy?: string[]  // users who can modify review, empty for all\n    cellAskEdit?: string // if set the table shows this to indicate that user can do something\n    autoshowContext?: boolean // show context frame if not visible once an item cell has been selected\n    createDoc?: ICreateDoc // if set, a button is added to create a signable doc with all review details\n    hide_UI?: boolean // to temporarily hide the control in UI\n}\n\ninterface ICreateDoc {\n    template: string // the DOC id to be used as template\n    section: string // the title of the section to be filled\n    pasteTo: string // parent DOC folder defaults to F-DOC-1\n    hide?: string[] // remove given field types\n}\n\ninterface IReviewAction {\n    // defines button\n    buttonName: string, // name of button to do action\n    users: string[] // users who can operate button - empty/null for all\n}\n\ninterface IMailAction extends IReviewAction {\n    mailSubject: string // subject of email (_id_ for item item id)\n}\n\ninterface ILockAction extends IReviewAction {\n    label: string, // label to set\n}\n\ninterface IReviewStatusUpdate extends IReviewAction {\n    // if all reviews of an item have a drop down value which is in the dropdown group passed -> a passed label can be set\n    passedLabel?: string, // label to set\n    // if 1+  item is failed  (empty or dropdown group todo) the failed label will be set\n    failedLabel?: string, // label to set (optional)\n    // if 1+  item is not yet reviewed (empty or dropdown group todo) the todo label will be set\n    todoLabel?: string, // label to set (optional)\n}\n\ninterface IReviewActionCategoryLabel {\n    label: string, // which label\n    category: string // for which category\n}\n\ninterface IReviewConfigTask {\n    buttonName: string, // name of button to create tickets\n    users: string[] // users who can operate button - empty/null for all\n    taskPluginId: number, // e.g. jira id\n    taskIssueType: string,\n    taskProject: string,\n    taskDescription?: string\n}\n\ninterface ITableReviewData {\n    reviewtable: IStringMap[]\n}\n\ninterface INeedleMap {\n    [key: string]: XRTrimNeedleItem\n}\n\ninterface IItemReviews {\n    [key: string]: IItemReview\n};\n\ninterface IItemReview {\n    passed: string[];\n    failed: string[];\n    todo: string[];\n    all: XRTrimNeedleItem[];\n};\n\n\nclass ScheduleReview implements IPlugin {\n\n    static fieldType = FieldDescriptions.Field_reviewControl;\n\n    public isDefault = true;\n\n    initItem(item: IItem, jui: JQuery) {\n\n    }\n\n    initServerSettings() {\n    }\n\n    initProject() {\n\n    }\n\n    async getProjectPagesAsync():Promise<IProjectPageParam[]> {\n        return new Promise((resolve, reject) => {\n            let that = this;\n            let pages: IProjectPageParam[] = [];\n\n            if (!globalMatrix.ItemConfig.getTimeWarp()) {\n                pages.push({\n                    id: \"REVIEWS\",\n                    title: \"Review Overview\",\n                    folder: \"DASHBOARDS\",\n                    order: 4000,\n                    icon: \"fal fa-stamp\",\n                    usesFilters: false,\n                    render: (options: IPluginPanelOptions) => that.renderReviewProjectPage(options)\n                });\n            }\n\n            resolve( pages);\n        })\n    }\n\n    supportsControl(fieldType: string): boolean {\n        return (fieldType === ScheduleReview.fieldType);\n    }\n\n    createControl(ctrl: JQuery, options: IBaseControlOptions) {\n        ctrl.reviewControl(<IReviewControlOptions>options);\n    }\n\n    getFieldConfigOptions(): IFieldDescription[] {\n        return [{\n            id: ScheduleReview.fieldType,\n            label: \"Design Review Table [\" + ScheduleReview.fieldType + \"]\",\n            capabilities: {\n                canImportedFromExcel:true,\n                onlyOne: true,\n                canBeXtcPreset: false,\n                canBePublished: false,\n                canBeReadonly: true,\n                canHideInDoc: false,\n                needsConfiguration: true,\n                canBeUnsafe: true,\n            }, class: \"all\", help: \"table control to simplify design reviews\"\n        }];\n    }\n\n    addFieldSettings(configApp: any, project: string, pageId: string, fieldType: string, fieldParams: IReviewConfig, ui: JQuery, paramChanged: () => void) {\n        let that = this;\n\n        if (fieldType != ScheduleReview.fieldType) {\n            return;\n        }\n\n        if (!matrixSession.isReview()) {\n            ui.html('<p style=\"color:red\">Review module not licensed</p>');\n            return;\n        }\n\n        // check if there's a review dropdown, if not create it\n        let dd: IDropdownParams = globalMatrix.ItemConfig.getSettingJSON(ReviewControlImpl.reviewOptionsSetting);\n        if (!dd || !dd.options) {\n            // create the setting with default values!\n            ml.Logger.log(\"warn\", \"No configuration of dropdown with review results exists, creating it now....\");\n            dd = {\n                options: [{\n                    id: \"inprogress\", label: \"in progress\", class: \"inprogress\"\n                }, {\n                    id: \"fail\", label: \"Failed\", class: \"failed\"\n                }, {\n                    id: \"pass\", label: \"Passed\", class: \"passed\"\n                }],\n                groups: [{\n                    value: \"passed\", label: \"passed\"\n                }, {\n                    value: \"failed\", label: \"failed\"\n                }, {\n                    value: \"inprogress\", label: \"in progress\"\n                }]\n            };\n            configApp.setJSONProjectSettingAsync(project, {\n                id: ReviewControlImpl.reviewOptionsSetting,\n                value: dd\n            }, pageId);\n            globalMatrix.ItemConfig.setSettingJSON(ReviewControlImpl.reviewOptionsSetting, dd);\n        }\n\n        if (typeof fieldParams.showAnnotations == \"undefined\") fieldParams.showAnnotations = true;\n        if (typeof fieldParams.showHistory == \"undefined\") fieldParams.showHistory = true;\n        if (typeof fieldParams.showInline == \"undefined\") fieldParams.showInline = false;\n        if (typeof fieldParams.showVersions == \"undefined\") fieldParams.showVersions = true;\n        if (typeof fieldParams.showComments == \"undefined\") fieldParams.showComments = true;\n\n\n        ml.UI.SelectUserOrGroup.getAllUsersAndGroups().done( (userDropdown: IDropdownOption[]) => {\n\n            let grouping = [{value: \"groups\", label: \"groups\"}, {value: \"users\", label: \"users\"}];\n\n            // label options\n            let lls = <ILabelLockConfig>globalMatrix.ItemConfig.getSettingJSON(\"lockingLabels\");\n            let lockingLabels = (lls && lls.locks) ? lls.locks.map(function (lock) {\n                return {id: lock.label, label: lock.label};\n            }) : [];\n            let lt = ml.CreateNewLabelTools();\n            let allLabels = lt.getLabelDefinitions(null).map(function (ld) {\n                return {id: ld.label, label: ld.label}\n            });\n            // drop down options\n            let dds = globalMatrix.ItemConfig.getDropDowns();\n            let allDropdowns = dds.map(function (dd) {\n                return {id: dd.id, label: dd.label};\n            });\n\n\n\n            if (!fieldParams.doneLabel) fieldParams.doneLabel = <any>{buttonName: \"set progress labels\"};\n            if (!fieldParams.lockLabel) fieldParams.lockLabel = <any>{buttonName: \"set lock labels\"};\n            if (!fieldParams.mailTo) fieldParams.mailTo = <any>{buttonName: \"send mail\"};\n            if (!fieldParams.tasks) fieldParams.tasks = <any>{buttonName: \"create tasks\"};\n            if (!fieldParams.statusDropdown) fieldParams.statusDropdown = ReviewControlImpl.reviewOptionsSetting;\n\n            ml.UI.addCheckbox(ui, \"allow selecting user groups as reviewer\", fieldParams, \"allowSelectUserGroups\", paramChanged);\n            ml.UI.addCheckbox(ui, \"show version number of reviewed items\", fieldParams, \"showVersions\", paramChanged);\n            ml.UI.addCheckbox(ui, \"allow text annotations\", fieldParams, \"showAnnotations\", paramChanged);\n\n            let dummy = {method: \"0\"};\n            if (fieldParams.showHistory) {\n                dummy.method = \"1\";\n                if (fieldParams.showHistoryOutOfDate) dummy.method = \"2\";\n                if (fieldParams.showHistoryOutOfDateBeforeDone) dummy.method = \"3\";\n            }\n            ml.UI.addDropdownToValue(ui, \"show history button\", dummy, \"method\", [\n                {id: \"0\", label: \"don't show button\"},\n                {id: \"1\", label: \"show button\"},\n                {id: \"2\", label: \"show button - indicate if items have changed\"},\n                {\n                    id: \"3\",\n                    label: \"show button - indicate if items have changed, unless review is done\"\n                }], false, false, () => {\n                switch (dummy.method) {\n                    case \"0\":\n                        fieldParams.showHistory = false;\n                        fieldParams.showHistoryOutOfDate = false;\n                        fieldParams.showHistoryOutOfDateBeforeDone = false;\n                        break;\n                    case \"1\":\n                        fieldParams.showHistory = true;\n                        fieldParams.showHistoryOutOfDate = false;\n                        fieldParams.showHistoryOutOfDateBeforeDone = false;\n                        break;\n                    case \"2\":\n                        fieldParams.showHistory = true;\n                        fieldParams.showHistoryOutOfDate = true;\n                        fieldParams.showHistoryOutOfDateBeforeDone = false;\n                        break;\n                    case \"3\":\n                        fieldParams.showHistory = true;\n                        fieldParams.showHistoryOutOfDate = false;\n                        fieldParams.showHistoryOutOfDateBeforeDone = true;\n                        break;\n                }\n                paramChanged();\n            });\n            ml.UI.addCheckbox(ui, \"allow showing items in review table\", fieldParams, \"showInline\", paramChanged);\n            ml.UI.addCheckbox(ui, \"auto enable context view if item cell is selected\", fieldParams, \"autoshowContext\", paramChanged);\n            let showC = ml.UI.addCheckbox(ui, \"show comment column\", fieldParams, \"showComments\", paramChanged);\n            let confC = ml.UI.addCheckbox(ui, \"append new comments at end of comment list\", fieldParams, \"appendComments\", paramChanged);\n            ml.UI.enableIf(showC, true, [confC]);\n\n            ml.UI.addDropdownToValue(ui, \"review result dropdown\", fieldParams, \"statusDropdown\", allDropdowns, false, true, paramChanged, \"select dropdown definition\");\n\n            let cb = ml.UI.addCheckbox(ui, \"allow to modify review content\", fieldParams, \"canBeModified\", paramChanged);\n            let mb = ml.UI.addDropdownToArray(ui, \"who can modify (empty for all)\", fieldParams, \"canBeModifiedBy\", userDropdown, grouping, 1000, false, true, paramChanged, \"select user\");\n            ml.UI.enableIf(cb, true, [mb]);\n            mb.css(\"margin\", \"-12px 0 0 24px\"); // indent dropdown under checkbox\n            $(\"<h1>Connection to task management tool</h1>\").appendTo(ui);\n            ml.UI.addTextInput(ui, \"button name\", fieldParams.tasks, \"buttonName\", paramChanged);\n\n            ml.UI.addDropdownToArray(ui, \"users (empty for all)\", fieldParams.tasks, \"users\", userDropdown, grouping, 1000, false, true, paramChanged, \"select user\");\n            ml.UI.addTextInput(ui, \"task plugin id\", fieldParams.tasks, \"taskPluginId\", paramChanged);\n            ml.UI.addTextInput(ui, \"project id\", fieldParams.tasks, \"taskProject\", paramChanged);\n            ml.UI.addTextInput(ui, \"ticket type\", fieldParams.tasks, \"taskIssueType\", paramChanged);\n            ml.UI.addTextInput(ui, \"task description\", fieldParams.tasks, \"taskDescription\", paramChanged);\n            $(\"<h1>Actions to lock</h1>\").appendTo(ui);\n            ml.UI.addTextInput(ui, \"button name\", fieldParams.lockLabel, \"buttonName\", paramChanged);\n            ml.UI.addDropdownToValue(ui, \"lock label\", fieldParams.lockLabel, \"label\", lockingLabels, false, true, paramChanged, lockingLabels.length ? \"select lock - or keep empty to disable\" : \"no locks defined!\");\n            ml.UI.addDropdownToArray(ui, \"users (empty for all)\", fieldParams.lockLabel, \"users\", userDropdown, grouping, 1000, false, true, paramChanged, \"select user\");\n            $(\"<h1>Action to set progress labels</h1>\").appendTo(ui);\n            ml.UI.addTextInput(ui, \"button name\", fieldParams.doneLabel, \"buttonName\", paramChanged);\n            ml.UI.addDropdownToArray(ui, \"users (empty for all)\", fieldParams.doneLabel, \"users\", userDropdown, grouping, 1000, false, true, paramChanged, \"select user\");\n            ml.UI.addDropdownToValue(ui, \"passed items\", fieldParams.doneLabel, \"passedLabel\", allLabels, false, true, paramChanged, \"select labels - or keep empty to disable\");\n            ml.UI.addDropdownToValue(ui, \"failed items\", fieldParams.doneLabel, \"failedLabel\", allLabels, false, true, paramChanged, \"select labels - or keep empty to disable\");\n            ml.UI.addDropdownToValue(ui, \"to do items\", fieldParams.doneLabel, \"todoLabel\", allLabels, false, true, paramChanged, \"select labels - or keep empty to disable\");\n            $(\"<h1>Send Mail</h1>\").appendTo(ui);\n            ml.UI.addTextInput(ui, \"button name\", fieldParams.mailTo, \"buttonName\", paramChanged);\n            ml.UI.addTextInput(ui, \"subject\", fieldParams.mailTo, \"mailSubject\", paramChanged);\n            ml.UI.addDropdownToArray(ui, \"users (empty for all)\", fieldParams.mailTo, \"users\", userDropdown, grouping, 1000, false, true, paramChanged, \"select user\");\n\n            // enable the save button (at least first time the control is configured)\n            paramChanged();\n        });\n\n    }\n\n    updateMenu(ul: JQuery) {\n        return;\n    }\n\n    private renderReviewProjectPage(options: IPluginPanelOptions) {\n\n        let that = this;\n\n        if (options.controlState === ControlState.Print) {\n            return;\n        }\n\n        document.title = \"Reviews - \" + matrixSession.getProject();\n\n        options.control.html(\"\");\n\n\n        app.waitForMainTree(renderTabs);\n\n        function renderTabs() {\n            options.control.html(\"\");\n            // paint the tabs\n            let container = $(\"<div class='panel-body-v-scroll' >\").appendTo(options.control);\n\n            if (!matrixSession.isReview()) {\n                container.append($('<p style=\"color:red;margin:10px\">Review module not licensed</p>'));\n                return;\n            }\n\n            var tabpanel = $('<div role=\"tabpanel\" class=\"tabpanel-container \" style=\"padding:0px;\">');\n            container.append(tabpanel);\n\n            let tabpanelul = $('<ul class=\"nav nav-tabs contextFrameTabs\" role=\"tablist\">');\n            tabpanel.append(tabpanelul);\n            let tabpanels = $('<div class=\"tab-content\" style=\"height:' + ($(\"#itemDetails\").height() - tabpanelul.height() - 70) + 'px\">');\n            tabpanel.append(tabpanels);\n\n            let progress = $(\"<div>\").appendTo(tabpanels).append(ml.UI.getSpinningWait(\"retrieving review info...\"));\n\n            tabpanelul.append('<li role=\"presentation\" class=\"active\"><a href=\"#MYREVIEWS\"  role=\"tab\" data-toggle=\"tab\">My Reviews</a></li>');\n            let myReviewPanel = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane active\" id=\"MYREVIEWS\" >');\n            tabpanels.append(myReviewPanel);\n\n            tabpanelul.append('<li role=\"presentation\"><a href=\"#ALLREVIEWS\"  role=\"tab\" data-toggle=\"tab\">All Reviews</a></li>');\n            let allReviewPanel = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane\" id=\"ALLREVIEWS\" >');\n            tabpanels.append(allReviewPanel);\n\n            tabpanelul.append('<li role=\"presentation\"><a href=\"#ALLITEMS\"  role=\"tab\" data-toggle=\"tab\">Reviews Per Item</a></li>');\n            let itemReviewPanel = $('<div role=\"tabpanel\"  style=\"height:100%\" class=\"tabpaneltab tab-pane\" id=\"ALLITEMS\" >');\n            tabpanels.append(itemReviewPanel);\n\n            // all categories with a review control\n            let catsWithReview = globalMatrix.ItemConfig.getFieldsOfType(\"reviewControl\").map(function (rcs) {\n                return \"category=\" + rcs.category;\n            });\n            if (!catsWithReview.length) {\n                progress.remove();\n                myReviewPanel.html(\"There are no categories with review fields in this project.\");\n                allReviewPanel.html(\"There are no categories with review fields in this project.\");\n                return;\n            }\n\n            app.getNeedlesAsync( catsWithReview.join(\" OR \"), false, false,\"*\", false, true).done( (reviews: IItem[]) => {\n                that.renderReviews(myReviewPanel, reviews, true);\n                that.renderReviews(allReviewPanel, reviews, false);\n                that.renderItems(itemReviewPanel, catsWithReview, reviews);\n\n                progress.remove();\n            });\n        }\n    }\n\n    // project pages show in the top in Projects, Reports and Documents\n    private renderReviews(control: JQuery, needles: IItem[], onlyMine: boolean) {\n        let that = this;\n        let container = $(\"<div class='panel-body-v-scroll' style='padding: 0 12px;'>\").appendTo(control);\n\n        if (onlyMine) {\n            $(\"<h2>My Reviews</h2>\").appendTo(container);\n            // only show reviews for me and the stats for me\n        } else {\n            $(\"<h2>Overview Reviews</h2>\").appendTo(container);\n        }\n        let filters = $(\"<div>\").appendTo(container);\n        $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input type=\"checkbox\" data-hide=\"review_open\" checked >show open</label></div></div>').appendTo(filters);\n        $('<div class=\"alignHorizontal\" ><div class=\"checkbox\" ><label><input type=\"checkbox\" data-hide=\"review_done\" checked >show done</label></div></div>').appendTo(filters);\n        $(\"input\", container).change(function () {\n            $.each($(\"input\", container), function (idx, input) {\n                if ($(input).data(\"hide\")) {\n                    let sh = $(\".\" + $(input).data(\"hide\"), container);\n                    if ($(input).prop(\"checked\")) {\n                        sh.show();\n                        sh.removeClass(\"hideCopy\");\n                    } else {\n                        sh.hide();\n                        sh.addClass(\"hideCopy\");\n                    }\n                }\n            });\n        });\n\n        let details = $(\"<ul>\").appendTo(container);\n        ml.UI.copyBuffer(filters, \"copy to clipboard\", details, control);\n\n        let shown = 0;\n        $.each(needles, function (idx, needle) {\n            let fieldId = globalMatrix.ItemConfig.getFieldsOfType(\"reviewControl\", ml.Item.parseRef(needle.id).type)[0].field.id;\n\n            let tableData = that.getReviewTable(needle);\n\n            if (tableData.length == 0) return;\n\n            let reviewUsers = ReviewControlImpl.getReviewers(tableData);\n            if (onlyMine && reviewUsers.indexOf(matrixSession.getUser()) == -1) return; // review does not concern me\n\n            let itemCount = tableData.length;\n            let columns = Object.keys(tableData[0]);\n            const handler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig,\n                FieldDescriptions.Field_reviewControl, ReviewControlImpl.defaultOptions) as GenericFieldHandler;\n            let ctrl = new ReviewControlImpl($(\"<div>\"), handler);\n            let todos = ctrl.getItemsToDoByUser(fieldId, tableData);\n\n            // figure out how many reviews have to be done.\n            let userCount = onlyMine ? 1 : reviewUsers.length; // if it's only about mine, don't care about other users\n            let total = itemCount * userCount;\n            let stillTodo = 0;\n\n\n            if (onlyMine) {\n                stillTodo = todos[matrixSession.getUser()] ? todos[matrixSession.getUser()].length : 0;\n            } else {\n                // add up all the todo's for all users\n                $.each(columns, function (cidx, col) {\n                    if (todos[col]) {\n                        stillTodo += todos[col].length;\n                    }\n                });\n            }\n\n            shown++;\n            if (stillTodo) {\n                details.append(\"<li class='review_open'><b>\" + that.getNeedleRef(needle) + \"</b> \" + Math.floor((total - stillTodo) * 100 / total) + \"% done</li>\");\n            } else {\n                details.append(\"<li class='review_done'><b style='text-decoration: line-through'>\" + that.getNeedleRef(needle) + \"</b>  done</li>\");\n            }\n        });\n\n        if (!shown) {\n            details.append(\"<li class=''><b>no reviews yet</b></li>\");\n        }\n\n        details.highlightReferences();\n    }\n\n    private getNeedleRef(needle: IItem) {\n        return this.getItemRef(ml.Item.parseRef(needle.id).id);\n    }\n\n    private getItemRef(id: string) {\n\n        return \"<span class='hideCopy'>\" + id + \"!</span><span class='replaceCopy' data-with='\" + id + \"!'></span>\";\n    }\n\n    private renderItems(control: JQuery, catsWithReview: string[], needles: IItem[]) {\n        let that = this;\n        let cp = $(\"<div class='panel-body-v-scroll' style='padding-top:10px'>\").appendTo(control);\n        let h1 = $(\"<h1 class='hideCopy'>\").html(\"Status by item\").appendTo(cp);\n        ml.UI.copyBuffer(h1, \"copy to clipboard\", cp, cp);\n\n        let allCats = globalMatrix.ItemConfig.getCategories(true).filter(function (cat) {\n            return cat != \"REPORT\" && catsWithReview.indexOf(cat) == -1;\n        });\n        let cat = localStorage.getItem(matrixSession.getProject() + \"_lastReviewDashbordCat\");\n        cat = cat ? cat : allCats[0];\n\n        let dropdown = $(`<span class=\"hideCopy dropdown\" style=\"float:right; margin-right:12px\">\n        <button class=\"btn btn-xs dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\">\n            <span id=\"selectedCat\" >${cat}</span>&nbsp;\n            <span class=\"caret\"></span>\n        </button>\n        <ul class=\"dropdown-menu dropdown-menu-right\">\n        ${allCats.map(c => `<li class=\"catselect\" data-cat=\"${c}\"><a href=\"javascript:void(0)\">${c}</a></li>`).join(\"\\n\")}\n        </ul>\n        </span>`).appendTo(h1);\n\n        // build a list with all items, for each item know in which reviews it was passed, failed, todo\n        let reviewAnalysis: IItemReviews = {};\n        $.each(needles, function (idx, needle) {\n            that.analyzeReview(needle, reviewAnalysis);\n        });\n\n        let container = $(\"<div>\").appendTo(cp);\n        this.renderItemsCat(container, cat, reviewAnalysis);\n\n        $(\".catselect\", dropdown).click((event: JQueryEventObject) => {\n            let selectedCat = $(event.delegateTarget).data(\"cat\");\n            localStorage.setItem(matrixSession.getProject() + \"_lastReviewDashbordCat\", selectedCat);\n            $(\"#selectedCat\", dropdown).html(selectedCat);\n            that.renderItemsCat(container, selectedCat, reviewAnalysis);\n        });\n\n    };\n\n    renderItemsCat(container: JQuery, cat: string, reviewAnalysis: IItemReviews) {\n        let that = this;\n\n        container.html(\"\");\n        // prepare table\n        let table = $(\"<table class='table table-bordered'>\").appendTo(container);\n        let head = $(\"<thead>\").appendTo(table);\n        let trh = $(\"<tr>\").appendTo(head);\n        $(\"<th>\").html(\"Item\").appendTo(trh);\n        let rc = $(\"<th>\").html(\"Reviews\").appendTo(trh);\n        $('<div class=\"checkbox hideCopy\" ><label><input type=\"checkbox\" data-hide=\"notReviewed\" checked >Show not reviewed items</label></div>').appendTo(rc);\n\n        let rsc = $(\"<th>\").html(\"Review Status\").appendTo(trh);\n        $('<div class=\"checkbox hideCopy\" ><label><input type=\"checkbox\" data-hide=\"todo\" checked >todo</label></div>').appendTo(rsc);\n        $('<div class=\"checkbox hideCopy\" ><label><input type=\"checkbox\" data-hide=\"failed\" checked >failed</label></div>').appendTo(rsc);\n        $('<div class=\"checkbox hideCopy\" ><label><input type=\"checkbox\" data-hide=\"passed\" checked >passed</label></div>').appendTo(rsc);\n        let rwd = $(\"<th>\").html(\"Review Date\").appendTo(trh);\n        $('<div class=\"checkbox hideCopy\" ><label><input type=\"checkbox\" data-hide=\"allReviews\" checked >Show all but last reviews</label></div>').appendTo(rwd);\n        $('<div class=\"checkbox hideCopy\" ><label><input type=\"checkbox\" data-hide=\"lastReviews\" checked >Show last reviews</label></div>').appendTo(rwd);\n        let tbody = $(\"<tbody>\").appendTo(table);\n\n        let hasContent = false;\n        let itemsInCat = app.getChildrenIdsRec(\"F-\" + cat + \"-1\").sort(function (a, b) {\n            return ml.Item.parseRef(a).number - ml.Item.parseRef(b).number\n        });\n\n        $.each(itemsInCat, function (itemIdx, item) {\n            // add a row for item\n            let tdItem: JQuery;\n\n            if (reviewAnalysis[item]) {\n                // item was in some reviews\n                let reviewCount = reviewAnalysis[item].all.length;\n                // check if all have the same status (in that case the filter needs to remove all)\n                let overallStatus = (reviewAnalysis[item].passed.length == reviewCount) ? \"passed\" : (reviewAnalysis[item].failed.length == reviewCount) ? \"failed\" : (reviewAnalysis[item].todo.length == reviewCount) ? \"todo\" : \"\";\n\n                for (let idx = 0; idx < reviewCount; idx++) {\n                    // a new row for this review\n                    hasContent = true;\n                    let tr = $(`<tr class='item_${cat} wasReviewed'>`).appendTo(tbody);\n\n                    if (overallStatus) {\n                        tr.addClass(overallStatus);\n                    }\n\n                    if (idx == 0) {\n                        // add a first column with item id\n                        tdItem = $(`<td rowspan=${reviewAnalysis[item].all.length}>${that.getItemRef(item)}</td>`).appendTo(tr);\n                    }\n                    // now add review results\n                    let needle = reviewAnalysis[item].all[idx];\n\n                    let passed = reviewAnalysis[item].passed.indexOf(needle.itemOrFolderRef) != -1;\n                    let failed = reviewAnalysis[item].failed.indexOf(needle.itemOrFolderRef) != -1;\n\n                    // set the text to passed, failed, to do\n                    let text = passed ? \"passed\" : failed ? \"failed\" : \"to do\";\n                    let statusClass = passed ? \"passed\" : failed ? \"failed\" : \"todo\";\n\n                    let td1 = $(\"<td class='\" + statusClass + \"'>\" + that.getNeedleRef(needle) + \"</td>\").appendTo(tr);\n                    let td2 = $(\"<td class='\" + statusClass + \"'>\" + text + \"</td>\").appendTo(tr);\n                    let td3 = $(\"<td class='\" + statusClass + \"'>\" + needle.lastModDate + \"</td>\").appendTo(tr);\n\n                    if (idx != reviewCount - 1) {\n                        // not the last review so we mark it\n                        td1.addClass(\"allReviews\");\n                        td2.addClass(\"allReviews\");\n                        td3.addClass(\"allReviews\");\n                    }\n                }\n            } else {\n                let tr = $(\"<tr class='item_\" + cat + \" notReviewed'>\").appendTo(tbody);\n                $(\"<td>\" + that.getItemRef(item) + \"</td>\").appendTo(tr);\n                $(\"<td colspan='3'>not reviewed</td>\").appendTo(tr);\n            }\n\n        });\n\n        if (hasContent) {\n            table.highlightReferences();\n            $(\"input\", container).change(function () {\n                $(\"body\").css(\"cursor\", \"progress\");\n\n                window.setTimeout(() => {\n                    that.showHide(container);\n                    $(\"body\").css(\"cursor\", \"default\");\n                }, 1);\n            });\n        } else {\n            container.html(`<p>There are no reviewed items in the category ${cat}</p>`);\n        }\n    }\n\n    private showHide(container: JQuery) {\n        $(\".hideCopy\", container).show().removeClass(\"hideCopy\");\n        $.each($(\"input\", container), function (idx, input) {\n            if ($(input).data(\"hide\") && !$(input).prop(\"checked\")) {\n                $(\".\" + $(input).data(\"hide\"), container).hide().addClass(\"hideCopy\");\n            }\n        });\n    }\n\n    // go through a review and figure which items were passed or failed...\n    private analyzeReview(needle: IItem, reviewAnalysis: IItem) {\n        let that = this;\n\n        let tableData = that.getReviewTable(needle);\n\n        if (tableData.length == 0) return;\n\n        let fieldId = globalMatrix.ItemConfig.getFieldsOfType(\"reviewControl\", ml.Item.parseRef(needle.id).type)[0].field.id;\n        let reviewId = needle.id;\n\n        let passedItems: string[] = [];\n        let failedItems: string[] = [];\n        let todoItems: string[] = [];\n        ReviewControlImpl.analyzeReview(fieldId, tableData, passedItems, failedItems, todoItems);\n\n        for (let item of passedItems) {\n            if (!reviewAnalysis[item]) {\n                reviewAnalysis[item] = {passed: [], failed: [], todo: [], all: []};\n            }\n            reviewAnalysis[item].passed.push(reviewId);\n            reviewAnalysis[item].all.push(needle);\n        }\n        for (let item of failedItems) {\n            if (!reviewAnalysis[item]) {\n                reviewAnalysis[item] = {passed: [], failed: [], todo: [], all: []};\n            }\n            reviewAnalysis[item].failed.push(reviewId);\n            reviewAnalysis[item].all.push(needle);\n        }\n        for (let item of todoItems) {\n            if (!reviewAnalysis[item]) {\n                reviewAnalysis[item] = {passed: [], failed: [], todo: [], all: []};\n            }\n            reviewAnalysis[item].todo.push(reviewId);\n            reviewAnalysis[item].all.push(needle);\n        }\n    }\n\n    private getReviewTable(needle: IItem): IStringMap[] {\n        let tableData: IStringMap[] = [];\n\n        let fieldId = globalMatrix.ItemConfig.getFieldsOfType(\"reviewControl\", ml.Item.parseRef(needle.id).type)[0].field.id;\n\n            if (needle[fieldId] ) {\n                let rawValue = needle[fieldId]\n                let val = <ITableReviewData> (rawValue ? JSON.parse(rawValue) : {reviewTable: []} );\n                if (!val.reviewtable) { // review items which have never been scheduled\n                    val.reviewtable = [];\n                }\n                tableData = val.reviewtable;\n            }\n\n\n        return tableData;\n    }\n\n}\n\nfunction initialize() {\n    plugins.register(new ScheduleReview());\n}\n\ninterface IReviewControlOptions extends IBaseControlOptions {\n    controlState?: ControlState,\n    canEdit?: boolean,\n    help?: string,\n    fieldValue?: any,\n    valueChanged?: Function,\n    parameter: IReviewConfig,\n    readOnly?: boolean\n}\n\n/*\ninterface JQuery {\n    reviewControl?: ( options:IReviewControlOptions )=> JQuery;\n}\n*/\n\n$.fn.reviewControl = function (this: JQuery, options: IReviewControlOptions) {\n\n\n    if (!options.fieldHandler) {\n        //No need for a field handler here, so let's create a dummy one.\n        options.fieldHandler = FieldHandlerFactory.CreateHandler(globalMatrix.ItemConfig, FieldDescriptions.Field_reviewControl, options);\n        options.fieldHandler.initData(options.fieldValue);\n    }\n    let baseControl = new ReviewControlImpl(this,options.fieldHandler as GenericFieldHandler);\n    this.getController = () => {\n        return baseControl;\n    }\n    baseControl.init(options);\n    return this;\n}\n\nclass ReviewControlColumns {\n    static COL_COMMENT_LOG = \"commentlog\";\n    static COL_ITEM = \"reviewitem\";\n    static COL_VERSION = \"_version\";\n    static COL_ANNOTATIONS = \"_annotation\";\n}\n\nclass ReviewControlImpl extends BaseControl<GenericFieldHandler> {\n\n    static reviewOptionsSetting = \"dd_reviewOptions\";\n\n    private settings: IReviewControlOptions;\n    private reviewItems: string[];\n    private reviewUsers: string[];\n    private forceNewTable: boolean;\n    private currentVersions: ISearchResult[];\n    private outOfDateInfo: IStringNumberMap;\n    private reviewTable: JQuery;\n    private expanded: boolean[] = [];\n    private expandDetails: string[] = [];\n    private expandSaveTimeout: number;\n    private readonly: boolean = false;\n    private texts: IItemGetMap = {};\n    private isCommenting: boolean;\n\n    constructor(control: JQuery, fieldHandler:GenericFieldHandler) {\n        super(control,fieldHandler);\n    }\n\n\n    static defaultOptions: IReviewControlOptions = {\n        controlState: ControlState.FormView, // read only rendering\n        canEdit: false, // whether data can be edited\n        fieldValue: \"\", //\n        parameter: {\n            readonly: false, // can be set to overwrite the default readonly status\n        }\n    }\n\n    init(options: IReviewControlOptions) {\n\n        this.texts = {};\n\n        this.settings = <IReviewControlOptions>ml.JSON.mergeOptions(ReviewControlImpl.defaultOptions, options);\n\n        if (this.settings.parameter.hide_UI) {\n            this._root.hide();\n        }\n        if (typeof this.settings.parameter.showComments == \"undefined\") {\n            this.settings.parameter.showComments = true;\n        }\n        this.init2();\n        this.needsLatest = true;\n    }\n\n    updateControl() {\n        this.destroy();\n        this._root.html(\"\");\n        this.init2();\n    }\n\n    highlightReferences() {\n        // Only in cell, not in header\n        $(this._root).find(\".grid-canvas\").highlightReferences();\n    }\n\n\n    init2() {\n        let that = this;\n\n        if (!matrixSession.isReview()) {\n            this._root.html('<p style=\"color:red\">Review module not licensed</p>');\n            return;\n        }\n        let dd = ReviewControlImpl.getDropdownParams(this.settings.fieldId);\n        if (!dd || !dd.options) {\n            $('<span class=\"baseControlHelp\">').appendTo(this._root).html(this.settings.help);\n            $('<div><span class=\"warnNoEdit\" style=\"\">no valid configuration</span></div>').appendTo(this._root);\n            return;\n        }\n\n        this.readonly = this.forceNewTable || (this.settings.parameter && this.settings.parameter.readonly) || !this.settings.canEdit ||\n            this.settings.controlState === ControlState.Print ||\n            this.settings.controlState === ControlState.DialogEdit ||\n            this.settings.controlState === ControlState.Tooltip ||\n            this.settings.controlState === ControlState.HistoryView ||\n            this.settings.controlState === ControlState.DialogCreate;\n\n        this._root.addClass(\"reviewControl\");\n\n        let actions = $(\"<div class='controlContainer'>\").appendTo(this._root);\n\n        if (!this.settings.fieldValue || this.settings.fieldValue == \"{}\") {\n            if (!this.readonly) {\n                that.renderReviewInput(this._root, false);\n            }\n        } else {\n\n            let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n\n            if (!this.readonly) {\n                let hasTools = false;\n                $('<div class=\"baseControlHelp\">' + this.settings.help + ' - Review Tools</div>').appendTo(actions);\n                let buttons = $(\"<div class='baseControl rowFlex'>\").appendTo(actions);\n\n                // create button to set a locking label\n                if (this.settings.parameter.canBeModified) {\n                    hasTools = true;\n                    let enabled = (!this.settings.parameter.canBeModifiedBy || this.settings.parameter.canBeModifiedBy.length == 0 ||\n                        matrixSession.amIAllowedUser(this.settings.parameter.canBeModifiedBy));\n                    let changeReviewContainer = $(\"<span>\").appendTo(buttons);\n                    $('<button id=\"changeReview\" class=\"buttonCreateSelect btn btn-success\" ' + (enabled ? \"\" : \"disabled\") + '>Edit users / items</button>').click(function () {\n                        that.editReview();\n                    }).appendTo(changeReviewContainer);\n                }\n\n                // create button to set a locking label\n                if (this.settings.parameter.lockLabel && this.settings.parameter.lockLabel.label) {\n                    hasTools = true;\n                    let enabled = !this.settings.parameter.lockLabel.users || this.settings.parameter.lockLabel.users.length == 0 ||\n                        matrixSession.amIAllowedUser(this.settings.parameter.lockLabel.users);\n\n                    $('<button class=\"buttonCreateSelect btn btn-success\" ' + (enabled ? \"\" : \"disabled\") + '>' + that.settings.parameter.lockLabel.buttonName + '</button>').click(function () {\n                        that.lockItems(that.getItems());\n                    }).appendTo(buttons);\n                }\n                // create button to set a review done label\n                if (this.settings.parameter.doneLabel && (\n                    this.settings.parameter.doneLabel.failedLabel || this.settings.parameter.doneLabel.todoLabel || this.settings.parameter.doneLabel.passedLabel)) {\n                    hasTools = true;\n                    let enabled = !this.settings.parameter.doneLabel.users || this.settings.parameter.doneLabel.users.length == 0 ||\n                        matrixSession.amIAllowedUser(this.settings.parameter.doneLabel.users);\n\n                    $('<button class=\"buttonCreateSelect btn btn-default\" ' + (enabled ? \"\" : \"disabled\") + '>' + that.settings.parameter.doneLabel.buttonName + '</button>').click(function () {\n\n                        that.setItemReviewStatusLabel(that.getItems());\n                    }).appendTo(buttons);\n                }\n\n                // create button to make new task using ticketing plugin\n                if (this.settings.parameter.tasks && this.settings.parameter.tasks.taskPluginId) {\n                    hasTools = true;\n                    let enabled = !this.settings.parameter.tasks.users || this.settings.parameter.tasks.users.length == 0 ||\n                        matrixSession.amIAllowedUser(this.settings.parameter.tasks.users);\n\n                    $('<button class=\"buttonCreateSelect btn btn-default\" ' + (enabled ? \"\" : \"disabled\") + '>' + that.settings.parameter.tasks.buttonName + '</button>').click(function () {\n                        $.each($(\"li\", matrixApplicationUI.lastMainItemForm.getControls(\"tasksControl\")[0]), function (lidx, li) {\n                            if ($(li).text() == \"no tasks linked\") $(li).remove()\n                        })\n\n                        that.createTasks(ReviewControlImpl.getReviewers(tableData), [that.settings.item.id]).done(function () {\n                            var ctrls = matrixApplicationUI.lastMainItemForm.getControls(\"tasksControl\");\n                            $.each(ctrls, function (idx, ctrl) {\n                                Tasks.showTasks(app.getCurrentItemId(), ctrl, !that.readonly);\n                            });\n                        });\n                    }).appendTo(buttons);\n                }\n\n                // create button to send reminder email\n                if (this.settings.parameter.mailTo) {\n                    hasTools = true;\n                    let enabled = !this.settings.parameter.mailTo.users || this.settings.parameter.mailTo.users.length == 0 ||\n                        matrixSession.amIAllowedUser(this.settings.parameter.mailTo.users);\n                    $('<button class=\"buttonCreateSelect btn btn-default\" ' + (enabled ? \"\" : \"disabled\") + '>' + that.settings.parameter.mailTo.buttonName + '</button>').click(function () {\n                        that.sendReminder();\n                    }).appendTo(buttons);\n                }\n\n                if (!hasTools) {\n                    actions.hide();\n                }\n            }\n\n            let container = $(\"<div>\").appendTo(this._root);\n            this.showTable(container);\n\n            if (this.settings.parameter.createDoc && this.settings.parameter.createDoc.template) {\n                $('<button class=\"buttonCreateSelect btn btn-default\" style=\"margin-bottom:12px;\">Create Document</button>').click(function () {\n                    that.copyDetails();\n                }).appendTo(this._root);\n            }\n        }\n    }\n\n    private copyDetails() {\n        let that = this;\n\n        let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n        let details = $(\"<div style='position:absolute;top:0;left:-10000px;width:1000px;height:100%'>\").appendTo($(\"body\"));\n        let render = $(\"<div>\").appendTo(details);\n\n        ml.UI.BlockingProgress.Init([{name: \"Generating document\"}]);\n\n        this.copyDetail(render, tableData, 0).done(function () {\n            // in case there's something sections to hide / hide them (including  possible comments)\n            if (that.settings.parameter.createDoc.hide) {\n                for (let sec of that.settings.parameter.createDoc.hide) {\n                    $(\".ft_\" + sec, details).remove();\n                }\n            }\n            // remove bad headings\n            $(\"div.itemTitle\", details).each((idx, itemTitle) => {\n                let id = $(\".refIdHyper\", $(itemTitle)).text();\n                let newId = $(\"<h2>\" + id + \"!</h2>\");\n                that.copyAnnotations($(itemTitle), newId);\n                $(itemTitle).replaceWith(newId);\n            });\n            // remove other bad links\n            $(\".refIdHyper\", details).each((idx, itemId) => {\n                let id = $(itemId).text();\n                let newId = $(\"<span>\" + id + \"!</span>\");\n                let parent = $(itemId).closest(\"a\").parent();\n                that.copyAnnotations(parent, newId);\n                parent.replaceWith(newId);\n            });\n            $(\".baseControlHelp\").each((i, bch) => {\n                $(bch).removeClass(\"baseControlHelp\").attr(\"style\", \"font-size: 12px; font-weight: 700;color: #a9b3b8;text-transform: uppercase;letter-spacing: 1px;left: 0!important;margin:24px 0;\")\n            });\n            // make annotater headings printable\n            $(\".annotator-hl\", details).css(\"background-color\", \"aliceblue\");\n            // remove annotater tools\n            $(\".annotator-outer\", details).remove();\n            $(\".annotator-adder\", details).remove();\n            $(\".slickTable\", details).each((idx, table) => that.replaceSlickTables($(table)));\n            that.fixInputs(details);\n            // final cleanup (get rid of lot's of markup)\n            let panels = $(\".panel-body-v-scroll\", details);\n            panels.each((i, old) => {\n                let item = $(\"<div>\");\n                $(\".itemTitleBarNoToolsNoEdit > h2\", $(old)).appendTo(item);\n                $(\".dialog-body\", $(old)).children().each((j, field) => {\n                    $(field).removeAttr(\"class\"); // remove classes (not useful)\n                    $(field).removeAttr(\"style\"); // remove margin-right: 15px; margin-bottom: 15px;\n                    // maybe we add a class to render nicer\n                    $(\".baseControl\", $(field)).removeAttr(\"class\"); // not needed\n                    $(field).appendTo(item);\n                });\n                $(old).parent().parent().replaceWith(item);\n            });\n\n            mDHF.preparePasteBuffer(null);\n            mDHF.copyTemplate([that.settings.parameter.createDoc.template], 0, true).done(() => {\n\n                that.createNewDoc(that.settings.parameter.createDoc.pasteTo ? that.settings.parameter.createDoc.pasteTo : \"F-DOC-1\", details.html()).done(() => {\n                    ml.UI.BlockingProgress.SetProgress(0, 1);\n                    details.remove();\n                    ml.UI.showSuccess(\"Created Review Document\");\n                });\n            });\n        });\n    }\n\n    // convert input fields into spans (otherwise they'll be rendered empty)\n    private fixInputs(details: JQuery) {\n        $(\"input[type='text']\", details).each((i, inp) => {\n            $(inp).replaceWith(\"<span>\" + $(inp).val() + \"</span>\");\n        });\n        $(\"select\", details).each((i, inp) => {\n            $(inp).replaceWith(\"<span> \" + $('option:selected', $(inp)).text() + \"</span>\");\n        });\n        $(\"input[type='checkbox']:checked\", details).each((i, inp) => {\n            $(inp).replaceWith(\"<span>X </span>\");\n        });\n        $(\"input[type='checkbox']\", details).each((i, inp) => {\n            $(inp).replaceWith(\"<span>_ </span>\");\n        });\n        $(\"textarea\", details).each((i, inp) => {\n            $(inp).replaceWith($(\"<span style='white-space: pre;'>\").html($(inp).val()));\n        });\n    }\n\n    // replace div based table with a real table\n    private replaceSlickTables(old: JQuery) {\n        let that = this;\n\n        let table = $(\"<table class='table table-bordered'>\");\n        let tr = $(\"<tr>\").appendTo($(\"<thead>\").appendTo(table));\n        // copy the headers\n        $(\".slick-header .slick-header-column\", old).each((i, header) => {\n            $(\"<td>\").appendTo(tr).html($(\"span\", $(header)).html());\n        });\n        let body = $(\"<tbody>\").appendTo(table);\n        $(\".slick-row\", old).each((i, row) => {\n            let r = $(\"<tr>\").appendTo(body);\n            $(\".slick-cell\", $(row)).each((j, cell) => {\n                $(\"<td>\").appendTo(r).html($(cell).html());\n            });\n        });\n\n        old.replaceWith(table);\n    }\n\n    private copyAnnotations(fromNode: JQuery, toNode: JQuery) {\n        // find annotations inside and move the to smart link\n        $(\".annPO\", fromNode).each((ai, an) => {\n            toNode.append(an);\n        });\n    }\n\n    private createNewDoc(folderId: string, reviewText: string) {\n        let res = $.Deferred();\n\n        let that = this;\n\n        let currentBufferString = localStorage.getItem(mDHF.COPY_PASTE_BUFFER);\n        let pasteBuffer = (<IDHFPasteBuffer>JSON.parse(currentBufferString)).items[0];\n\n        let targetCategory = ml.Item.parseRef(folderId).type;\n\n        let sourceref = 0;\n        let srfs = globalMatrix.ItemConfig.getFieldsOfType(\"sourceref\", targetCategory);\n        if (srfs.length) {\n            sourceref = srfs.length ? srfs[0].field.id : 0;\n        }\n        // prepare the item to be created\n        let itemJson: IItemPut = {};\n\n\n        itemJson.title = pasteBuffer.title + \" \" + app.getCurrentItemId();\n        if (sourceref) {\n            (<IGenericMap>itemJson)[sourceref] = pasteBuffer.sourceProject + \"/\" + pasteBuffer.sourceItem;\n        }\n        let fields = globalMatrix.ItemConfig.getItemConfiguration(targetCategory).fieldList;\n\n        $.each(fields, function (fidx, f) {\n            for (var idx = 0; idx < pasteBuffer.item.length; idx++) {\n                if (pasteBuffer.item[idx].def.label === f.label && sourceref != f.id) {\n                    (<IGenericMap>itemJson)[f.id] = pasteBuffer.item[idx].val;\n                }\n            }\n        });\n\n        let textField = pasteBuffer.item.filter(f => f.def.fieldType == FieldDescriptions.Field_dhf && f.val && JSON.parse(f.val) && JSON.parse(f.val).name.toLowerCase() == that.settings.parameter.createDoc.section.toLowerCase());\n        if (textField.length == 1) {\n            let val = JSON.parse(textField[0].val);\n            val.fieldValue = reviewText;\n            itemJson[textField[0].def.id] = JSON.stringify(val);\n        }\n\n        app.createItemOfTypeAsync(targetCategory, itemJson, \"review document creation\", folderId).done(function (result) {\n            res.resolve();\n            app.treeSelectionChangeAsync(result.item.id);\n        }).fail(function (error) {\n\n        });\n        return res;\n    };\n\n    private copyDetail(details: JQuery, tableData: IStringMap[], rowIdx: number) {\n        let res = $.Deferred();\n        let that = this;\n\n\n        if (rowIdx >= tableData.length) {\n            res.resolve();\n            return res;\n        }\n        ml.UI.BlockingProgress.SetProgress(0, 100 * (rowIdx + 1) / tableData.length);\n        if (rowIdx) {\n            $(\"<hr style='margin:30px 0'>\").appendTo(details);\n        }\n        let reviewItem = $(\"<div>\").appendTo(details);\n        let reviewComments = $(\"<div style='margin-top:15px;'>\").appendTo(details);\n        let currentAnnotations = (<any>that.reviewTable.getController()).getHiddenCell(rowIdx, ReviewControlColumns.COL_ANNOTATIONS);\n        let annotations = currentAnnotations ? (<IReviewData>JSON.parse(currentAnnotations)).inlineComments : [];\n\n        reviewComments.append(`<span class=\"baseControlHelp\">Inline Comments for ${tableData[rowIdx].reviewitem}</span>`);\n        let body = $(\"<tbody>\");\n        if (annotations.length) {\n            $(\"<table class='annTa' style='width:100%'>\").appendTo(reviewComments)\n                .append(\"<thead style='font-weight: 700;'><tr><th>Pos</th><th>User</th><th>Comment</th></tr></thead>\")\n                .append(body);\n        } else {\n            $(\"<p class='annNC'>no inline annotations for this item</p>\").appendTo(reviewComments);\n        }\n        let row = tableData[rowIdx];\n        let itemId = ReviewControlImpl.getItem(row);\n        let version = row[ReviewControlColumns.COL_VERSION] ? Number(row[ReviewControlColumns.COL_VERSION]) : undefined;\n\n        app.getItemAsync(itemId, version).done(async function (data) {\n            let itemC = new ItemControl(<any>{\n                control: reviewItem,\n                controlState: ControlState.Tooltip,\n                isHistory: version,\n                type: ml.Item.parseRef(itemId).type,\n                item: data,\n                isItem: true,\n                parameter: {\n                    reviewMode: true\n                },\n                changed: function () {\n                }\n            });\n            await itemC.load();\n\n            window.setTimeout(function () {\n                reviewItem.annotator({readOnly: true});\n                reviewItem.data('annotator');\n                reviewItem.annotator(\"loadAnnotations\", ml.JSON.clone(annotations));\n                $(\".annotator-wrapper\", reviewItem).removeClass(\"annotator-wrapper\");\n                for (let anIdx = 0; anIdx < annotations.length; anIdx++) {\n                    let an = annotations[anIdx];\n                    let hyper = reviewItem.find(`[data-annotation-id='${an.id}']`)\n                    if (hyper.length) {\n                        $(`<span class=\"annPO\" style=\"position: relative;padding: 0 20px 0 0;\"><span style=\"color: red;border: 1px solid red;border-radius: 8px;position: absolute;top: -12px;left: -4px;width: 18px;text-align: center;\">${Number(anIdx) + 1}</span></span>`).insertAfter($(hyper[hyper.length - 1]));\n                        body.append(`<tr><td style='color:red'>${Number(anIdx) + 1}</td><td class=\"annUs\">${an.createdBy}</td><td class=\"annTe\">${an.text}</td></tr>`);\n                    }\n                }\n                that.copyDetail(details, tableData, rowIdx + 1).done(() => res.resolve());\n            }, 300);\n        });\n\n        return res;\n    }\n\n\n    private renderReviewInput(ctrl: JQuery, isDialog: boolean) {\n        let that = this;\n\n        $('<span class=\"baseControlHelp\">' + this.settings.help + ' - Review Items</span>').appendTo(ctrl);\n        let items = $(\"<span>\");\n        var selStr = $(\"<span class='itemSelectionList'></span>\");\n        ctrl.append($('<p>').append(selStr).append(items));\n        let selectTools = new ItemSelectionTools();\n        selectTools.renderButtons({\n            selectMode: SelectMode.auto,\n            control: items,\n            linkTypes: globalMatrix.ItemConfig.getCategories(true).map(function (cat) {\n                return {type: cat}\n            }),\n            smallbutton: true,\n            selectionChange:  (newSelection: IReference[]) => {\n                that.reviewItems = newSelection.map(function (sel) {\n                    return sel.to;\n                });\n                selStr.html(ml.Item.refListToDisplayString(newSelection, \"items:\"));\n\n                let ok: JQuery;\n                if (isDialog) {\n                    ok = $(\".btnDoIt\", ctrl.closest(\".ui-dialog\"));\n                    ml.UI.setEnabled(ok, false); // disable ok/save button, because we first need to get the latest versions\n                } else {\n                    $(\"#btnSave\").hide();\n                }\n\n                let folders = that.reviewItems.filter(id => ml.Item.parseRef(id).isFolder).map(id => \"folderm=\" + id);\n                let items = that.reviewItems.filter(id => !ml.Item.parseRef(id).isFolder).map(id => \"id=\" + id);\n\n                let itemsAndFolders = items.concat(folders);\n                let search = itemsAndFolders.join(\" OR \");\n\n                const allowSave = () => {\n                    if (isDialog) {\n                        ml.UI.setEnabled(ok, true);\n                    } else {\n                        $(\"#btnSave\").show();\n                    }\n                };\n\n                //Don't make the rest call if the selection is empty\n                if (itemsAndFolders.length > 0) {\n                    app.searchAsync(\"mrql:\"+search,undefined,true).done((results)=>{\n                        allowSave();\n                        that.currentVersions = results;\n                        that.settings.valueChanged.apply(null);\n                    });\n                } else {\n                    allowSave();\n                    that.currentVersions = [];\n                    that.settings.valueChanged.apply(null);\n                }\n            },\n            getSelectedItems:async function () {\n                if (that.reviewItems) {\n                    return that.reviewItems.map(function (sel) {\n                        return {to: sel, title: \"\"};\n                    });\n                } else {\n                    return [];\n                }\n            },\n            buttonName: \"Select Review Items\"\n        });\n\n        if(that.reviewItems && that.reviewItems.length > 0) {\n            selStr.html(ml.Item.refListToDisplayString(that.reviewItems.map((item) => {\n                return {to: item, title: \"\"}\n            }), \"items:\"));\n        }\n\n        ml.UI.SelectUserOrGroup.showMultiUserSelect(ctrl, this.settings.help + \" - Reviewers\", that.reviewUsers, \"Select Reviewers\", \"\", \"\", true, this.settings.parameter.allowSelectUserGroups\n            , function (selection: string[]) {\n\n                that.reviewUsers = selection;\n                that.settings.valueChanged.apply(null);\n\n            })\n        $(\"button\", items).css(\"margin-top\", \"4px\");\n\n    }\n\n    private isReviewDone() {\n        let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n        let passedItems: string[] = [];\n        let failedItems: string[] = [];\n        let todoItems: string[] = [];\n        ReviewControlImpl.analyzeReview(this.settings.fieldId, tableData, passedItems, failedItems, todoItems);\n        return todoItems.length == 0;\n    }\n\n    private editReview() {\n        let that = this;\n        this.reviewItems = [];\n        this.reviewUsers = [];\n\n        let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n        if (tableData && tableData.length) {\n            this.reviewUsers = ReviewControlImpl.getReviewers(tableData);\n            this.reviewItems = this.getItems();\n        }\n\n        let dlg = $(\"<div>\").appendTo($(\"body\"));\n        let ui = $(\"<div style='height:100%;width:100%'>\");\n        this.renderReviewInput(ui, true);\n        ml.UI.showDialog(dlg, \"Change items or reviewers\", ui, $(document).width() * 0.9, app.itemForm.height() * 0.9,\n            [{\n                text: 'OK',\n                class: 'btnDoIt',\n                click: function () {\n                    dlg.dialog(\"close\");\n                    dlg.remove();\n                    that.updateReview();\n                    app.saveAsync(true).done(function () {\n\n                    }).fail(function () {\n                        // or user refused\n                        // these are set by controls: reset\n                        that.reviewItems = null;\n                        that.reviewUsers = null;\n                        // update save buttons\n                    });\n                }\n            }, {\n                text: 'Cancel',\n                class: 'btnCancelIt',\n                click: function () {\n                    dlg.dialog(\"close\");\n                    dlg.remove();\n                    // these are set by controls: reset\n                    that.reviewItems = null;\n                    that.reviewUsers = null;\n                    // update save buttons\n                    that.settings.valueChanged.apply(null);\n                }\n            }], UIToolsConstants.Scroll.Vertical, true, true, () => {\n            }, () => {\n            }, () => {\n            }\n        );\n    }\n\n    private async updateReview() {\n        let that = this;\n\n        let savedData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n        let tableData = <IStringMap[]>JSON.parse(await this.reviewTable.getController().getValueAsync());\n\n\n        let oldReviewUsers = ReviewControlImpl.getReviewers(tableData);\n        let oldReviewItems = this.getItems();\n\n        // for users other than myself, keep original data\n        $.each(oldReviewUsers, function (uIdx, otherUser) {\n            if (otherUser != matrixSession.getUser()) {\n                $.each(tableData, function (idx, tableRow) {\n                    let originalRow = savedData.filter(function (row) {\n                        return row.reviewitem == tableRow.reviewitem;\n                    })\n                    if (originalRow.length == 1) {\n                        tableRow[otherUser] = originalRow[0][otherUser];\n                    }\n                });\n            }\n        });\n\n        // add new items\n        let items: string[] = [];\n        $.each(this.reviewItems, function (sidx, select) {\n            items = items.concat(app.getChildrenIdsRec(select));\n        });\n\n        $.each(items, function (idx, item) {\n            if (oldReviewItems.indexOf(item) == -1) {\n                let row: IStringMap = {};\n                row[ReviewControlColumns.COL_ITEM] = that.getItemRef(item);\n                row[ReviewControlColumns.COL_VERSION] = that.getItemVersion(item);\n\n                $.each(that.reviewUsers, function (uidx, user) {\n                    row[user] = \"\";\n                });\n                row[ReviewControlColumns.COL_COMMENT_LOG] = \"\";\n                tableData.push(row);\n            }\n        });\n        // remove not needed rows\n        tableData = tableData.filter(function (tableRow) {\n            let oldItem = tableRow.reviewitem.split(\" \")[0].replace(\"!\", \"\");\n            return items.indexOf(oldItem) != -1;\n        });\n        // add and remove users\n        let removeTheseUsers = oldReviewUsers.filter(function (oldUser) {\n            return that.reviewUsers.indexOf(oldUser) == -1;\n        });\n        let addTheseUsers = that.reviewUsers.filter(function (oldUser) {\n            return oldReviewUsers.indexOf(oldUser) == -1;\n        });\n        $.each(tableData, function (idx, tableRow) {\n            $.each(removeTheseUsers, function (ridx, removeUser) {\n                delete tableRow[removeUser];\n            });\n            $.each(addTheseUsers, function (ridx, addUser) {\n                tableRow[addUser] = \"\";\n            });\n        });\n\n        // acknowledge selected users\n        this.reviewItems = null;\n        this.reviewUsers = null;\n\n        // save and repaint\n        let newTable = JSON.stringify({reviewtable: tableData});\n        if (newTable != this.settings.fieldValue) {\n            this.settings.fieldValue = newTable;\n            // make sure new layout overwrites other changes\n            this.forceNewTable = true;\n            this.updateControl();\n        }\n        // update save buttons\n        this.settings.valueChanged.apply(null);\n    }\n\n    // implement interface\n    async hasChangedAsync() {\n\n        if (this.isCommenting) {\n            // user has the annotate dialog open\n            return true;\n        }\n\n        if (this.forceNewTable) {\n            return true;\n        }\n\n        if (this.reviewUsers && this.reviewUsers.length > 0 && !!this.reviewItems) return true;\n\n        if (!this.reviewTable) return false;\n\n        let newTable = JSON.parse(await this.reviewTable.getController().getValueAsync());\n        let oldTable = JSON.parse(this.settings.fieldValue).reviewtable;\n\n        let changeReview = $(\"#changeReview\");\n\n        for (let idx = 0; idx < newTable.length; idx++) {\n            let changed = false;\n            if (newTable[idx][ReviewControlColumns.COL_ANNOTATIONS] != oldTable[idx][ReviewControlColumns.COL_ANNOTATIONS] ||\n                newTable[idx][ReviewControlColumns.COL_COMMENT_LOG] != oldTable[idx][ReviewControlColumns.COL_COMMENT_LOG]) {\n                changed = true;\n            } else {\n                let myReviewColumns = this.getMyReviewColumns();\n                $.each(myReviewColumns, function (mrcIdx, mrc) {\n                    if (newTable[idx][mrc] != oldTable[idx][mrc]) changed = true;\n                });\n            }\n            if (changed) {\n                ml.UI.setEnabled(changeReview, false);\n                changeReview.parent().attr(\"title\", \"save to modify the table structure\");\n                return true;\n            }\n        }\n\n        if (this.settings.parameter.canBeModified) {\n            let enabled = (!this.settings.parameter.canBeModifiedBy || this.settings.parameter.canBeModifiedBy.length == 0 ||\n                matrixSession.amIAllowedUser(this.settings.parameter.canBeModifiedBy));\n\n            ml.UI.setEnabled(changeReview, enabled);\n        }\n\n        changeReview.parent().attr(\"title\", \"\");\n        return false;\n    }\n\n    async getValueAsync(currentItem?: IItemGet) {\n        let that = this;\n        if (this.reviewTable) {\n\n            if (this.forceNewTable) {\n                return this.settings.fieldValue;\n            }\n\n            if (!currentItem) {\n                return undefined;\n            }\n            let myReviewColumns = this.getMyReviewColumns();\n            // get the old review status for user\n            let oldTable: IStringMap[] = this.settings.fieldValue ? JSON.parse(this.settings.fieldValue).reviewtable : [];\n            let beforeEdit: any = {}; // lookup table item id -> row\n            $.each(oldTable, function (oidx, row) {\n                beforeEdit[ReviewControlImpl.getItem(row)] = row;\n            });\n\n            // get the updated review status for user\n            let thisTable = JSON.parse(await this.reviewTable.getController().getValueAsync());\n            let afterEdit: any = {}; // lookup table item id -> row\n            $.each(thisTable, function (oidx, row) {\n                afterEdit[ReviewControlImpl.getItem(row)] = row;\n            });\n\n            // update last saved table\n            let lastSavedValue: ITableReviewData = <ITableReviewData>JSON.parse((<IStringMap>currentItem)[this.settings.fieldId]);\n            $.each(lastSavedValue.reviewtable, function (oidx, dbRow) {\n                let item = ReviewControlImpl.getItem(dbRow);\n                $.each(myReviewColumns, function (mrcIdx, mrc) {\n                    dbRow[mrc] = afterEdit[item][mrc];\n                    if (mrc != matrixSession.getUser() && afterEdit[item][mrc] != beforeEdit[item][mrc]) {\n                        // ACL - remember that the logged on user did the change\n                        dbRow[\"_\" + mrc] = matrixSession.getUser();\n                    }\n                });\n\n                // row: the values saved in the database (might have changed since user started edit)\n                // oldValues: values before user started edit\n                // newValues: values after used did edit\n                // -> changes from old to new need to merged into row...\n                that.mergeComments(dbRow, beforeEdit[item], afterEdit[item]);\n                that.mergeAnnotations(dbRow, beforeEdit[item], afterEdit[item]);\n            });\n\n            return JSON.stringify(lastSavedValue);\n        } else if (this.reviewItems && this.reviewUsers && this.reviewUsers.length > 0) {\n            // create the initial table\n            let items: string[] = [];\n            $.each(this.reviewItems, function (sidx, select) {\n                items = items.concat(app.getChildrenIdsRec(select));\n            });\n\n            let newReview: ITableReviewData = {reviewtable: []};\n            $.each(items, function (idx, item) {\n                let row: IStringMap = {};\n                row[ReviewControlColumns.COL_ITEM] = that.getItemRef(item);\n                row[ReviewControlColumns.COL_VERSION] = that.getItemVersion(item);\n                $.each(that.reviewUsers, function (uidx, user) {\n                    row[user] = \"\";\n                });\n                row[ReviewControlColumns.COL_COMMENT_LOG] = \"\";\n                newReview.reviewtable.push(row);\n            });\n            return JSON.stringify(newReview);\n        } else {\n            return JSON.stringify({});\n        }\n    }\n\n    private mergeComments(db: IStringMap, beforeEdit: IStringMap, afterEdit: IStringMap) {\n        let that = this;\n\n        let domHelper = $(\"<div style='display:none'>\").appendTo($(\"body\"));\n        // get the users' current comments in this cell\n        let ncs: string[] = [];\n        domHelper.html(afterEdit[ReviewControlColumns.COL_COMMENT_LOG]);\n        $(\".commentLine\", domHelper).each(function (cidx, nc) {\n            if ($(\".commentUser\", $(nc)).text() == matrixSession.getUser()) {\n                ncs.push(nc.outerHTML);\n            }\n        });\n        // get the users previous comments in the this cell\n        let ocs: string[] = [];\n        domHelper.html(beforeEdit[ReviewControlColumns.COL_COMMENT_LOG]);\n        $(\".commentLine\", domHelper).each(function (cidx, oc) {\n            if ($(\".commentUser\", $(oc)).text() == matrixSession.getUser()) {\n                ocs.push(oc.outerHTML);\n            }\n        });\n        // build list of comments to add/remove\n        let removeComments: string[] = ocs.filter(function (oc) {\n            return ncs.indexOf(oc) == -1;\n        });\n        let addComments: string[] = ncs.filter(function (nc) {\n            return ocs.indexOf(nc) == -1;\n        });\n        // now update the comments in the current Item\n        domHelper.html(db[ReviewControlColumns.COL_COMMENT_LOG]);\n        // go through existing comments and remove them if they have been deleted\n        $(\".commentLine\", domHelper).each(function (cidx, cc) {\n            if (removeComments.indexOf(cc.outerHTML) == -1) {\n                addComments.push(cc.outerHTML);\n            }\n        });\n        // that's an old comment from validation test phase... add a fake comment to keep order\n        $(\".commentDate\", domHelper).each(function (cidx, cc) {\n            if (!$(cc).data(\"cd\")) {\n                $(cc).data(\"cd\", new Date(2017, 1, 1, 1, 1, that.settings.parameter.appendComments ? cidx : 59 - cidx));\n            }\n        });\n\n        // sort comments\n        let mult = that.settings.parameter.appendComments ? 1 : -1;\n        let sortedComments = addComments.sort(function (a, b) {\n            let aDate = $(\".commentDate\", $(a)).data(\"cd\");\n            let bDate = $(\".commentDate\", $(b)).data(\"cd\");\n            return mult * (new Date(aDate).getTime() - new Date(bDate).getTime());\n        });\n\n        // add new stuff\n        domHelper.html(\"\");\n        $.each(sortedComments, function (clidx, cl) {\n            domHelper.append(cl);\n        });\n        let mergedValue = domHelper.html();\n        domHelper.remove();\n\n        db[ReviewControlColumns.COL_COMMENT_LOG] = mergedValue;\n    }\n\n    private mergeAnnotations(db: IStringMap, beforeEdit: IStringMap, afterEdit: IStringMap) {\n\n        db[ReviewControlColumns.COL_ANNOTATIONS] = HTMLAnnotator.mergeAnnotation(\n            db[ReviewControlColumns.COL_ANNOTATIONS],\n            beforeEdit[ReviewControlColumns.COL_ANNOTATIONS],\n            afterEdit[ReviewControlColumns.COL_ANNOTATIONS]);\n    }\n\n    private getItemRef(item: string) {\n        let that = this;\n        let ref = item + \"!\";\n        if (that.settings.parameter.showVersions) {\n            let version = that.getItemVersion(item);\n            ref += \" (version \" + version + \")\";\n        }\n        return ref;\n    }\n\n    private getItemVersion(item: string) {\n        let that = this;\n        let version = \"\";\n        $.each(that.currentVersions, function (cidx, current) {\n            if (current.itemId == item) {\n                version = \"\" + current.version;\n                return;\n            }\n        });\n        return version;\n    }\n\n    destroy() {\n    }\n\n    async resizeItem(newWidth?: number, force?: boolean) {\n        let that = this;\n\n        if (force && this.reviewTable && this.reviewTable.resizeItem) {\n            this.reviewTable.resizeItem(newWidth, force);\n            // the redraw, removes the tools (history and such, so they need to be added)\n            let currentValue = await this.reviewTable.getController().getValueAsync();\n            if (this.settings.controlState == ControlState.FormEdit && currentValue) {\n                // add the tools to expand inline / show history\n\n                this.reviewTable.getController().redraw();\n\n                let tableData = ml.JSON.clone(JSON.parse(currentValue));\n\n                $.each($(\".r1>span\", this.reviewTable), function (rowIdx, row) {\n                    that.makeExpandable(tableData, that.reviewTable, rowIdx);\n                });\n            }\n\n            this.reviewTable.getController().refresh();\n        }\n    }\n\n    // create JIRA tasks\n    private createTasks(reviewers: string[], items: string[]): JQueryDeferred<string[]> {\n\n        let res: JQueryDeferred<string[]> = $.Deferred();\n\n        if (!this.settings.parameter.tasks) {\n            res.resolve([]);\n            return res;\n        }\n        let jiraConfig = Tasks.getConfig(this.settings.parameter.tasks.taskPluginId);\n\n        if (!jiraConfig) {\n            console.log(\"plugin \" + this.settings.parameter.tasks.taskPluginId + \" not configured\");\n            res.resolve([]);\n            return res;\n        }\n\n        this.createTask(reviewers, items, 0, []).done(function (tasks) {\n            res.resolve(tasks.map(function (ei) {\n                return ei.externalItemId;\n            }));\n        }).fail(function () {\n            ml.UI.showError(\"Failed to create tasks\", \"see console log\");\n            res.resolve([]);\n        });\n\n        return res;\n    }\n\n    private createTask(reviewers: string[], items: string[], jobId: number, taskList: IExternalItem[]): JQueryDeferred<IExternalItem[]> {\n        let that = this;\n\n        let res: JQueryDeferred<IExternalItem[]> = $.Deferred();\n\n        if (jobId == reviewers.length * items.length) {\n            res.resolve([]);\n            return res;\n        }\n\n        let itemIdx = jobId % items.length;\n        let reviewerIdx = Math.floor(jobId / items.length);\n        let next = jobId + 1;\n\n        if (itemIdx == 0) {\n            ml.UI.showSuccess(\"Create new review task for \" + reviewers[reviewerIdx]);\n            let title = (reviewers[reviewerIdx] + \": \" + app.getCurrentTitle());\n            Tasks.postCreateIssue(that.settings.parameter.tasks.taskPluginId, items[itemIdx],\n                title, reviewers[reviewerIdx] + \",\\n\" + (that.settings.parameter.tasks.taskDescription ? that.settings.parameter.tasks.taskDescription : \"a review has been scheduled for you. See linked review item for details.\"),\n                that.settings.parameter.tasks.taskProject, that.settings.parameter.tasks.taskIssueType).done(function (created: IExternalItem[]) {\n                taskList.push(created[0]);\n                that.createTask(reviewers, items, next, taskList).done(function (tasks) {\n\n                    res.resolve(taskList);\n                }).fail(function () {\n                    res.reject();\n                });\n            }).fail(function () {\n                console.log(\"could not create task in external ticketing\");\n                res.reject();\n            });\n        } else {\n            ml.UI.showSuccess(\"Added item \" + items[itemIdx] + \" to task of \" + reviewers[reviewerIdx]);\n\n            Tasks.postCreateLinks(items[itemIdx], [taskList[taskList.length - 1]]).done(function () {\n                that.createTask(reviewers, items, next, taskList).done(function (tasks) {\n                    res.resolve(taskList);\n                }).fail(function () {\n                    res.reject();\n                });\n            }).fail(function () {\n                console.log(\"could not link item to external ticket\");\n                res.reject();\n            });\n        }\n\n        return res;\n    }\n\n    // invite users to do reviews, by email and jira task\n    private async sendReminder() {\n        let that = this;\n\n        let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n\n        let todos = this.getItemsToDoByUser(this.settings.fieldId, tableData);\n        let actualReviewers: string[] = [];\n\n\n        let link = ml.Item.parseRef(app.getCurrentItemId()).link;\n\n        let richtexts = matrixApplicationUI.lastMainItemForm.getControls(\"richtext\");\n\n        let body = richtexts.length ? await richtexts[0].getController().getValueAsync() : \"\";\n        body = body ? (\"See \" + link + \"<br><br>\" + body + \"<br><br>\") : (\"Review: \" + link + \"<br><br>\");\n\n        $.each(ReviewControlImpl.getReviewers(tableData), function (idx, user) {\n            if (todos[user].length) {\n                // add info to mail body\n                body += \"<b>\" + user + \"</b> - \";\n                // remember that person needs to do some work\n                actualReviewers.push(user);\n\n                // add links to review items\n                let links = todos[user].map(function (id) {\n                    return \"<li>\" + ml.Item.renderLink(id).html();\n                });\n                body += \"still to do:<br><ul> \" + links.join(\",\") + \"</ul>\";\n            }\n        });\n\n        let cannedMessage = ml.Mail.getCannedMessage(\"review_reminder\", actualReviewers.join(\",\"), app.getCurrentItemId(), undefined, body);\n\n        let subject = that.settings.parameter.mailTo.mailSubject ? that.settings.parameter.mailTo.mailSubject : \"Review _id_\";\n        subject = subject.replace(\"_id_\", app.getCurrentItemId());\n        ml.Mail.sendMailDlg(actualReviewers.join(\",\"), null, subject, cannedMessage, matrixSession.getUser());\n    }\n\n    // set the label for a list of items\n    private lockItems(items: string[]) {\n        let labelConfig = this.settings.parameter.lockLabel;\n\n        let lt = ml.CreateNewLabelTools();\n        let res = $.Deferred();\n        this.setLabels(lt, items, labelConfig.label).done(function () {\n            ml.UI.showSuccess(\"All lock labels set!\");\n            res.resolve();\n        }).fail(function () {\n            ml.UI.showError(\"Failed to set labels\", \"see console log\");\n            res.resolve();\n        });\n        return res;\n    }\n\n    // mark items as done (passed/failed/todo)\n    private async setItemReviewStatusLabel(items: string[]) {\n        let that = this;\n        // get current table\n        let tableData = ml.JSON.clone(JSON.parse(await this.reviewTable.getController().getValueAsync()));\n        // merge with original data to change UI values to internal values for other reviewers\n        let oldData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n        let otherReviewers = ReviewControlImpl.getReviewers(tableData).filter(function (reviewer) {\n            return reviewer != matrixSession.getUser();\n        });\n        $.each(tableData, function (ridx, row) {\n            $.each(otherReviewers, function (oridx, other) {\n                tableData[ridx][other] = oldData[ridx][other];\n            });\n        });\n        // prepare the triaged list of items\n        let passedItems: string[] = [];\n        let failedItems: string[] = [];\n        let todoItems: string[] = [];\n        ReviewControlImpl.analyzeReview(this.settings.fieldId, tableData, passedItems, failedItems, todoItems);\n\n        // now set the labels for each group (if configured)\n        let res = $.Deferred();\n        let lt = ml.CreateNewLabelTools();\n\n        let marks = this.settings.parameter.doneLabel;\n        this.setLabels(lt, failedItems, marks.failedLabel).done(function () {\n            that.setLabels(lt, passedItems, marks.passedLabel).done(function () {\n                that.setLabels(lt, todoItems, marks.todoLabel).done(function () {\n                    ml.UI.showSuccess(\"All review status labels set!\");\n                    res.resolve();\n                }).fail(function () {\n                    ml.UI.showError(\"Failed to set labels\", \"see console log\");\n                    res.resolve();\n                });\n            }).fail(function () {\n                ml.UI.showError(\"Failed to set labels\", \"see console log\");\n                res.resolve();\n            });\n        }).fail(function () {\n            ml.UI.showError(\"Failed to set labels\", \"see console log\");\n            res.resolve();\n        });\n\n        return res;\n    }\n\n    // set a label recursively on all items which need it\n    private setLabels(lt: ILabelTools, items: string[], label: string) {\n        let that = this;\n        let res = $.Deferred();\n        if (!label) {\n            // nothing to do\n            res.resolve();\n            return res;\n        }\n        if (items.length == 0) {\n            // nothing to do\n            res.resolve();\n            return res;\n        }\n\n        // filter the items to only those which have the label\n        let labelDefs = lt.getLabelDefinitions([]).filter(function (ld) { return ld.label == label; });\n        if (labelDefs.length == 0) {\n            // nothing to do\n            res.resolve();\n            return res;\n        }\n        // get a list with all relevant categories for that labels\n        let categories = [];\n        for(let labelDef of labelDefs) {\n            for(let cat of labelDef.categories) {\n                if(categories.indexOf(cat) == -1)\n                    categories.push(cat);\n            }\n        }\n        if (categories.length == 0) {\n            // nothing to do\n            res.resolve();\n            return res;\n        }\n\n        let catSearch = categories.map(c => \"category=\" + c).join(\" OR \");\n        let idSearch = items.map(id => \"id=\" + id).join(\" OR \");\n        let labelSearch = 'label!=\"' + label + '\"';\n\n        app.searchAsync(`mrql:(${catSearch}) and (${idSearch}) and (${labelSearch})`).done(function (results: ISearchResult[]) {\n            var itemWithoutLabels = results.map(function (needle) { return needle.itemId });\n            that.setLabel(lt, itemWithoutLabels, label, 0).done(function () {\n                res.resolve();\n            }).fail(function () {\n                res.reject();\n            });\n        });\n        return res;\n    }\n    // set a label recursively on all items which need it\n    private setLabel(lt: ILabelTools, items: string[], label: string, nextIdx: number) {\n        let that = this;\n\n        let res = $.Deferred();\n        if (!label || nextIdx >= items.length) {\n            res.resolve();\n            return res;\n        }\n\n        // verify if the label is defined for the item / if not skip\n        if (!label || lt.getLabelDefinitions([ml.Item.parseRef(items[nextIdx]).type]).map(function (ld) {\n            return ld.label;\n        }).indexOf(label) == -1) {\n            // for this category no labels are defined, so we can skip this item\n            let cont = nextIdx + 1;\n            that.setLabel(lt, items, label, cont).done(function () {\n                res.resolve();\n            }).fail(function () {\n                res.reject();\n            });\n            return res;\n        }\n\n        // set the label and proceed\n        app.getItemAsync(items[nextIdx]).done(function (original: IItemGet) {\n            // check if label needs to be set\n            let originalLabels = original.labels;\n            let labels = lt.setLabel(original.labels, label);\n            let same = labels && originalLabels && labels.length == originalLabels.length && labels.every(function (x) {\n                return originalLabels.indexOf(x) != -1;\n            });\n\n            if (same) {\n                // no label is already set\n                ml.UI.showSuccess(\"Set label '\" + label + \"' \" + (nextIdx + 1) + \" / \" + items.length + \" : \" + items[nextIdx]);\n                let cont = nextIdx + 1;\n                that.setLabel(lt, items, label, cont).done(function () {\n                    res.resolve();\n                }).fail(function () {\n                    res.reject();\n                });\n            } else {\n                // do set label\n                let changes: IItemPut = {id: items[nextIdx], onlyThoseFields: 1, labels: labels.join(\",\")};\n\n                app.updateItemInDBAsync(changes, \"Schedule Review\").done(function () {\n                    ml.UI.showSuccess(\"Set label '\" + label + \"' \" + (nextIdx + 1) + \" / \" + items.length + \" : \" + items[nextIdx]);\n                    let cont = nextIdx + 1;\n                    that.setLabel(lt, items, label, cont).done(function () {\n                        res.resolve();\n                    }).fail(function () {\n                        res.reject();\n                    });\n                }).fail(function () {\n                    console.log(\"failed to set label\");\n                    res.reject();\n                });\n\n            }\n        }).fail(function () {\n            console.log(\"failed to get item\");\n            res.reject();\n        });\n        return res;\n    }\n\n    // get all items from table\n    private getItems(): string[] {\n        let that = this;\n\n        let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n\n        let items: string[] = [];\n        $.each(tableData, function (idx, row) {\n            let item = ReviewControlImpl.getItem(row);\n            items.push(item);\n        });\n\n        return items;\n    }\n\n    getItemsToDoByUser(fieldId: number, tableData: IStringMap[]): IStringStringArrayMap {\n        let that = this;\n\n        let todos: IStringStringArrayMap = {};\n\n        // get dropdown setting options which are considered to be still todo\n        let todoStates = ReviewControlImpl.getReviewOptions(fieldId, false, false, true);\n\n        let columns = ReviewControlImpl.getReviewers(tableData);\n\n        $.each(columns, function (idx, column) {\n            if (!todos[column]) {\n                // might be first task of user\n                todos[column] = [];\n            }\n            // get items which still need to be reviewed\n            $.each(tableData, function (rowIdx, row) {\n                if (!row[column] || todoStates.indexOf(row[column]) != -1) {\n                    // in table we keep the ID with a ! to render title\n                    let item = ReviewControlImpl.getItem(row);\n                    todos[column].push(item);\n                }\n            });\n        });\n\n        return todos;\n    }\n\n    static analyzeReview(fieldId: number, tableData: IStringMap[], passedItems: string[], failedItems: string[], todoItems: string[]) {\n        let reviewers = ReviewControlImpl.getReviewers(tableData);\n\n        // get the cell values which represent the different states\n        let passed = ReviewControlImpl.getReviewOptions(fieldId, true, false, false);\n        let failed = ReviewControlImpl.getReviewOptions(fieldId, false, true, false);\n        let todo = ReviewControlImpl.getReviewOptions(fieldId, false, false, true);\n\n        // for each row - check items in which bucket they need to go\n        $.each(tableData, function (rowIdx, row) {\n\n            let stillTodo = false;\n            let alreadyFailed = false;\n            $.each(reviewers, function (cidx, column) {\n                if (!row[column] || todo.indexOf(row[column]) != -1) {\n                    stillTodo = true;\n                } else if (failed.indexOf(row[column]) != -1) {\n                    alreadyFailed = true;\n                } else if (passed.indexOf(row[column]) != -1) {\n                } else {\n                    // default unknown state\n                    stillTodo = true;\n                }\n            });\n            if (alreadyFailed) {\n                failedItems.push(ReviewControlImpl.getItem(row));\n            } else if (stillTodo) {\n                todoItems.push(ReviewControlImpl.getItem(row));\n            } else {\n                passedItems.push(ReviewControlImpl.getItem(row));\n            }\n        });\n    }\n\n    // get all columns which are user or ACL columns\n    static getReviewers(tableData: IStringMap[]): string[] {\n        if (tableData.length == 0) return [];\n\n        let reviewColumns = Object.keys(tableData[0]).filter(function (c) {\n            return c[0] != \"_\" && c != ReviewControlColumns.COL_ITEM && c != ReviewControlColumns.COL_COMMENT_LOG;\n        });\n        return reviewColumns.sort();\n    }\n\n    static getItem(row: IStringMap): string {\n        return ReviewControlImpl.getItemFromCell(row['reviewitem']);\n    }\n\n    static getItemFromCell(value: string): string {\n        return value.split(\" \")[0].replace(\"!\", \"\");\n    }\n\n    // returns all drop down options for the wanted principal states\n    static getReviewOptions(fieldId: number, passed: boolean, failed: boolean, todo: boolean): string[] {\n        let dd: IDropdownParams = ReviewControlImpl.getDropdownParams(fieldId);\n\n        if (!dd || !dd.options) {\n            ml.Logger.log(\"warn\", \"no setting for dropdowns in review table\");\n            return [];\n        }\n        return dd.options.filter(function (ddo) {\n            return (todo && (!ddo.class || ddo.class == \"todo\")) || (passed && ddo.class == \"passed\") || (failed && ddo.class == \"failed\");\n        }).map(function (ddo) {\n            return ddo.id;\n        });\n    }\n\n    private static getDropdownParams(fieldId: number): IDropdownParams {\n        let field = globalMatrix.ItemConfig.getFieldsOfType(\"reviewControl\").filter(function (rcs) {\n            return rcs.field.id == fieldId;\n        });\n        if (field.length && field[0].field.parameterJson && field[0].field.parameterJson.statusDropdown) {\n            return <IDropdownParams>globalMatrix.ItemConfig.getSettingJSON(field[0].field.parameterJson.statusDropdown);\n        }\n        return <IDropdownParams>globalMatrix.ItemConfig.getSettingJSON(ReviewControlImpl.reviewOptionsSetting);\n    }\n\n    // either a column specifically for the user or a acl group containing the user\n    private getMyReviewColumns(): string[] {\n        let mine: string[] = [matrixSession.getUser()];\n\n        let groups = globalMatrix.ItemConfig.getUserGroups();\n\n        if (groups) {\n            $.each(groups, function (aclIdx, group) {\n                if (group.membership.map(function (member) {\n                    return member.login;\n                }).indexOf(matrixSession.getUser()) != -1) {\n                    mine.push(ml.UI.SelectUserOrGroup.getGroupId(group));\n                }\n            });\n        }\n\n        return mine;\n    }\n\n    private showTable(container: JQuery) {\n        let that = this;\n\n        that.outOfDateInfo = null;\n        if ((this.settings.controlState == ControlState.FormEdit ||  this.settings.controlState == ControlState.FormView) && // the out of date icons don't make sense in the history view as they would be wrong / the are not shown in the tooltip either\n            (this.settings.parameter.showHistoryOutOfDate ||\n            (this.settings.parameter.showHistoryOutOfDateBeforeDone && !this.isReviewDone())))  {\n            let items = this.getItems().map(id => \"id=\" + id);\n\n            app.searchAsync(\"mrql:\" + items.join(\" or \"), null, true, \"\", null, null, null, null).done((currentItems) => {\n                that.outOfDateInfo = {};\n                for (let item of currentItems) {\n                    that.outOfDateInfo [item.itemId] = item.version;\n                }\n                that.showTableDetails(container);\n            });\n        } else {\n            that.showTableDetails(container);\n        }\n    }\n\n    private showTableDetails(container: JQuery) {\n        let that = this;\n\n        let dd: IDropdownParams = ReviewControlImpl.getDropdownParams(this.settings.fieldId);\n        let ddName = this.settings.parameter.statusDropdown ? this.settings.parameter.statusDropdown : ReviewControlImpl.reviewOptionsSetting;\n\n        // render actual review table\n        (<ITableControlOptions>this.settings).parameter.canBeModified = false;\n        (<ITableControlOptions>this.settings).parameter.showLineNumbers = false;\n        (<ITableControlOptions>this.settings).parameter.columns = [];\n        (<ITableControlOptions>this.settings).parameter.doNotRememberWidth = true;\n        (<ITableControlOptions>this.settings).parameter.disableColumnReorder = true;\n        (<ITableControlOptions>this.settings).parameter.onColumnsResized = () => {\n            that.repaintAfterColumnChange();\n        };\n\n        let tableData = (<ITableReviewData>JSON.parse(this.settings.fieldValue)).reviewtable;\n\n        (<ITableControlOptions>this.settings).parameter.readOnlyFields = [\"items\"];\n        if (tableData && tableData.length) {\n            let columns = Object.keys(tableData[0]);\n            (<ITableControlOptions>this.settings).parameter.columns.push({\n                name: \"Item\", field: ReviewControlColumns.COL_ITEM, editor: ColumnEditor.none, relativeWidth: 300\n            });\n            let reviewers = ReviewControlImpl.getReviewers(tableData);\n            let myReviewColumns = this.getMyReviewColumns();\n\n            $.each(reviewers, function (cidx, reviewer) {\n                let itsMe = myReviewColumns.indexOf(reviewer) != -1;\n                (<ITableControlOptions>that.settings).parameter.columns.push({\n                    name: ml.UI.SelectUserOrGroup.getGroupDisplayNameFromId(reviewer),\n                    field: reviewer,\n                    editor: itsMe ? ColumnEditor.select : ColumnEditor.none,\n                    options: {setting: ddName},\n                    relativeWidth: itsMe ? 100 : 50,\n                    cssClass: itsMe ? \"reviewMe\" : \"reviewOther\",\n                    headerCssClass: itsMe ? \"reviewMeHeader\" : \"reviewOtherHeader\"\n                });\n                if (!itsMe) {\n                    (<ITableControlOptions>that.settings).parameter.readOnlyFields.push(reviewer);\n                }\n                ;\n            });\n            if (typeof (<IReviewConfig>that.settings.parameter).showComments == \"undefined\" || (<IReviewConfig>that.settings.parameter).showComments) {\n                (<ITableControlOptions>this.settings).parameter.columns.push({\n                    name: \"Comments\",\n                    field: ReviewControlColumns.COL_COMMENT_LOG,\n                    editor: ColumnEditor.commentlog,\n                    options: this.settings.parameter.appendComments ? {append: \"true\"} : {},\n                    relativeWidth: 300\n                });\n            }\n\n            $.each(tableData, function (ridx, row) {\n                $.each(columns, function (cidx, column) {\n                    // replace the drop down ids of other users with actual values\n                    if (reviewers.indexOf(column) != -1 && myReviewColumns.indexOf(column) == -1) {\n                        let opts = dd.options.filter(function (ddo) {\n                            return ddo.id == row[column];\n                        })\n                        row[column] = opts.length ? opts[0].label : row[column];\n                    }\n                });\n            });\n        }\n        let tableInfo = ml.JSON.clone(this.settings);\n        tableInfo.fieldHandler = null;\n        tableInfo.parameter.onCellChanged = function (row: any) {\n            that.makeExpandable(tableData, container, row.row);\n        }\n\n        tableInfo.fieldValue = JSON.stringify(tableData);\n        tableInfo.onSelectCell = (rowIdx: number, colIdx: number, data: any) => {\n            if (colIdx == 1) {\n                let reviewItem = data.reviewitem.replace(\"!\", \"\").replace(\"(version \", \"\").replace(\")\", \"\");\n                let itemId = reviewItem.split(\" \")[0];\n                let line = tableData[rowIdx];\n\n                let version = line[ReviewControlColumns.COL_VERSION] ? Number(line[ReviewControlColumns.COL_VERSION]) : 0;\n                ReviewContextFrame.renderItem(itemId, version, that.settings.parameter.autoshowContext);\n            }\n        };\n        container.html(\"\");\n\n        this.reviewTable = $(\"<div>\").appendTo(container);\n        this.reviewTable.tableCtrl(tableInfo);\n        if (this.settings.controlState != ControlState.HistoryView) {\n            this.reviewTable.highlightReferences();\n        }\n\n\n        this.reviewTable.getController().redraw();\n\n        if (this.settings.controlState == ControlState.FormEdit) {\n            // add the tools to expand inline / show history\n            $.each($(\".r1>span\", container), function (rowIdx, row) {\n                that.makeExpandable(tableData, container, rowIdx);\n            });\n        }\n\n        this.reviewTable.getController().refresh();\n    }\n\n    private makeExpandable(tableData: IStringMap[], container: JQuery, rowIdx: number) {\n        let that = this;\n\n        let row = $($(\".r1>span\", container)[rowIdx]);\n\n        let toggler = $('<span class=\"cbimg reviewToggle fal fa-chevron-right\">');\n        let history = $('<span title=\"view changes\" class=\"fal fa-history reviewHistory\">');\n        let allowShowHistory = true;\n        if (this.outOfDateInfo) {\n            let line = tableData[rowIdx];\n            let itemId = ReviewControlImpl.getItem(line);\n            let version = line[ReviewControlColumns.COL_VERSION] ? Number(line[ReviewControlColumns.COL_VERSION]) : 0;\n            if (version) {\n                if (!this.outOfDateInfo[itemId]) {\n                    history.css(\"color\", \"red\");\n                    history.attr(\"title\", \"item was deleted\");\n                    allowShowHistory = false;\n                } else if (this.outOfDateInfo[itemId] > version) {\n                    history.css(\"color\", \"orange\");\n                    history.attr(\"title\", \"item was changed after it was added to review\");\n                }\n            }\n        }\n        let annotations = $('<span title=\"annotate\" class=\"fal fa-pencil reviewAnnotations\">');\n        let details = $('<div class=\"reviewDetails\">');\n\n        if (that.settings.parameter.showInline) $(row).prepend(toggler);\n        if (that.settings.parameter.showHistory) {\n            $(row).append(history);\n        } else {\n            allowShowHistory = false;\n        }\n        if (that.settings.parameter.showAnnotations) $(row).append(annotations);\n        if (that.settings.parameter.showInline) {\n            row.append(details);\n\n            if (that.expanded[rowIdx]) {\n                details.html(that.expandDetails[rowIdx]);\n            } else {\n                that.expanded[rowIdx] = false;\n            }\n        }\n\n        if (allowShowHistory) {\n            history.click(function (event: JQueryMouseEventObject) {\n                let line = tableData[rowIdx];\n\n                let version = line[ReviewControlColumns.COL_VERSION] ? Number(line[ReviewControlColumns.COL_VERSION]) : 0;\n                let itemId = ReviewControlImpl.getItem(line);\n\n                // showHistoryAgainstLastReviewed is an async function, but we do not wait for it to finish here.\n                // We are only kicking off the process.\n                that.showHistoryAgainstLastReviewed(itemId, version);\n\n                if (event.preventDefault)\n                    event.preventDefault();\n                if (event.stopPropagation)\n                    event.stopPropagation();\n\n                return false;\n            });\n        }\n\n        annotations.click(function (event: JQueryMouseEventObject) {\n\n            let icon = $(event.delegateTarget);\n\n            let line = tableData[rowIdx];\n            let version = line[ReviewControlColumns.COL_VERSION] ? Number(line[ReviewControlColumns.COL_VERSION]) : 0;\n            let itemId = ReviewControlImpl.getItem(line);\n\n            that.showAnnotations(itemId, version, rowIdx, icon);\n\n            if (event.preventDefault)\n                event.preventDefault();\n            if (event.stopPropagation)\n                event.stopPropagation();\n\n            return false;\n        });\n        that.colorIcon(annotations, tableData[rowIdx][ReviewControlColumns.COL_ANNOTATIONS]);\n\n        row.click(function (event: JQueryMouseEventObject) {\n            that.toggleItem(rowIdx, tableData, event, details);\n        });\n\n    }\n\n    private tablesReadyTimeout: number;\n\n    private showAnnotations(itemId: string, version: number, rowIdx: number, icon: JQuery) {\n        let that = this;\n\n        let currentAnnotations = (<any>that.reviewTable.getController()).getHiddenCell(rowIdx, ReviewControlColumns.COL_ANNOTATIONS);\n        that.retrieveItem(itemId, version).done(function (data) {\n\n            // show dialog\n            let hTMLAnnotator = new HTMLAnnotator();\n            let isSuperUser = that.settings.parameter.annotationMasters && that.settings.parameter.annotationMasters.indexOf(matrixSession.getUser()) != -1;\n            that.isCommenting = true;\n            that.settings.valueChanged.apply(null);\n            hTMLAnnotator.showReviewDialog(!that.readonly, itemId, version, data, currentAnnotations, isSuperUser, async function () {\n                that.isCommenting = false;\n                let changed = await hTMLAnnotator.getValueAsync();\n                (<any>that.reviewTable.getController()).setHiddenCell(rowIdx, ReviewControlColumns.COL_ANNOTATIONS, changed);\n                that.colorIcon(icon, changed);\n            });\n\n        });\n    }\n\n    private colorIcon(icon: JQuery, annotations: string) {\n        icon.css(\"color\", HTMLAnnotator.hasAnnotations(annotations) ? \"red\" : \"\");\n    }\n\n    private repaintAfterColumnChange() {\n        $.each($(\".reviewDetails\"), function (rowIdx, rwd) {\n            if ($(rwd).html() != \"\" && $(rwd).css(\"display\") != \"none\") {\n                let toogle = $(rwd).parent().find(\".reviewToggle\");\n                // hide it\n                toogle.click();\n                // reset it\n                $(rwd).html(\"\");\n                $(rwd).show();\n            }\n        });\n    }\n\n    private toggleItem(rowIdx: number, tableData: IStringMap[], event: JQueryMouseEventObject, details: JQuery) {\n        let that = this;\n\n        that.expanded[rowIdx] = !that.expanded[rowIdx];\n\n\n\n        let line = tableData[rowIdx];\n        let reviewDetails = $(\".reviewDetails\", $(event.delegateTarget).parent());\n\n        if( that.expanded[rowIdx] ) {\n           $(\".cbimg\", $(event.delegateTarget).parent()).removeClass(\"fa-chevron-right\").addClass(\"fa-chevron-down\");\n        }\n        else{\n            $(\".cbimg\", $(event.delegateTarget).parent()).removeClass(\"fa-chevron-down\").addClass(\"fa-chevron-right\");\n        }\n\n        if (reviewDetails.html()) {\n            reviewDetails.toggle();\n            let top = that.reviewTable.closest(\".panel-body-v-scroll\");\n            let topPos = top.scrollTop();\n            that.reviewTable.getController().refresh();\n            top.scrollTop(topPos);\n        } else {\n            let version = line[ReviewControlColumns.COL_VERSION] ? Number(line[ReviewControlColumns.COL_VERSION]) : undefined;\n            let itemId = ReviewControlImpl.getItem(line);\n            that.retrieveItem(itemId, version).done(async function (data) {\n                let ctrl = new ItemControl(<any>{\n                    control: reviewDetails,\n                    controlState: ControlState.Tooltip,\n                    isHistory: version,\n                    type: ml.Item.parseRef(itemId).type,\n                    item: data,\n                    isItem: true,\n                    parameter: {\n                        updateParent: function () {\n                            window.clearTimeout(that.expandSaveTimeout);\n                            // in case there's a table this function is called after the table has finished rendering\n                            that.expandDetails[rowIdx] = details.html();\n                            let top = that.reviewTable.closest(\".panel-body-v-scroll\");\n                            let topPos = top.scrollTop();\n                            that.reviewTable.getController().refresh();\n                            top.scrollTop(topPos);\n                        }\n                    },\n                    changed: function () {\n                    }\n                });\n                await ctrl.load();\n                window.clearTimeout(that.expandSaveTimeout);\n                that.expandSaveTimeout = window.setTimeout(function () {\n                    // in case there's no table: html is already ok: save it\n                    $(\".itemTitle\", details).remove(); // it's just above\n                    that.expandDetails[rowIdx] = details.html();\n                    let top = that.reviewTable.closest(\".panel-body-v-scroll\");\n                    let topPos = top.scrollTop();\n                    that.reviewTable.getController().refresh();\n                    top.scrollTop(topPos);\n                }, 500); // wait a little, e.g. to render images\n            });\n        }\n    }\n\n    private retrieveItem(itemId: string, version: number) {\n        let res = $.Deferred();\n        let that = this;\n\n        if (this.texts[itemId]) {\n            res.resolve(this.texts[itemId]);\n            return res;\n        }\n\n        app.getItemAsync(itemId, version).done(function (data) {\n            that.texts[itemId] = data;\n            res.resolve(data);\n        });\n\n        return res;\n    }\n\n    private async showHistoryAgainstLastReviewed(itemId: string, version: number) {\n        let that = this;\n        var ht = new HistoryTools();\n\n        if (!version) {\n            ht.compareLatest(itemId);\n            return;\n        }\n\n        if (version == 1 || !that.settings.parameter.doneLabel.passedLabel) {\n            ht.compareVersions(itemId, version, 0);\n            return;\n        }\n\n        const lastRevision: number = await ml.LabelTools.getLastTimeLabelWasSet(itemId, that.settings.parameter.doneLabel.passedLabel, version);\n        if (!lastRevision) {\n            ht.compareVersions(itemId, version, 0);\n        } else {\n            app.getItemAsync(itemId, lastRevision).done(function (data: IItemGet) {\n                ht.compareVersions(itemId, lastRevision, version);\n            });\n        }\n    }\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { TodoTypes } from \"./common/enums\";\nimport { BaseWidget } from \"./common/BaseWidget\";\n\nimport { IProcessResult } from \"./../core/printinterface/PrintProcessorInterfaces\";\nimport { PrintProcessor } from \"../print/src/PrintProcessor\";\nimport { Category } from \"./objects/Category\";\nimport { DocItem } from \"./objects/DocItem\";\nimport { Field } from \"./objects/Field\";\nimport { Item } from \"./objects/Item\";\nimport { Project, IProjectContext } from \"./objects/Project\";\nimport { TreeFolder } from \"./objects/TreeFolder\";\n\nimport { IPluginFieldHandler, ControlCore, ControlCoreBase, IControlOptions } from \"./plugins/ControlCore\";\nimport { PluginCore } from \"./plugins/PluginCore\";\n\nimport { IReviewConfig, ITableReviewData, ReviewControlColumns } from \"./../core/client/plugins/ScheduleReview\";\nimport { AddFileAck, FolderAnswer, CopyItemAck, ExecuteParam } from \"./rest-api\";\nimport { ISimpleSessionControl, StandaloneMatrixSDK } from \"./serverSdk\";\nimport { ITitleAndId, IProjectNeeds } from \"./standalone-interfaces\";\nimport { MatrixSDK } from \"./client\";\n\nimport {\n    IPlugin,\n    IProjectPageParam,\n    IPluginPanelOptions,\n    ISearchResult,\n    ISetField,\n    TestManager,\n    IExternalItem,\n    IItemChangeEvent,\n    IWltItemWithLinks,\n    Tasks,\n    IPluginHooks,\n    MatrixSession,\n    MR1Impl,\n    PluginManager,\n    IDB,\n    NotificationsBL,\n    ICategoryConfig,\n    BaseTableFieldHandler,\n    BaseValidatedTableFieldHandler,\n    CheckboxFieldHandler,\n    CrosslinksFieldHandler,\n    DateFieldHandler,\n    DHFFieldHandler,\n    DropdownFieldHandler,\n    EmptyFieldHandler,\n    GateFieldHandler,\n    GenericFieldHandler,\n    HyperlinkFieldHandler,\n    ItemSelectionFieldHandler,\n    ItemSelectionFieldHandlerFromTo,\n    RichtextFieldHandler,\n    SteplistFieldHandler,\n    TestResultFieldHandler,\n    TestStepsFieldHandler,\n    TestStepsResultFieldHandler,\n    TextlineFieldHandler,\n    UserFieldHandler,\n} from \"../core/common/businesslogic\";\nimport { ItemConfiguration } from \"../core/common/businesslogic/ItemConfiguration\";\nimport { FieldDescriptions } from \"../core/common/businesslogic/FieldDescriptions\";\nimport { SectionDescriptions } from \"../core/common/businesslogic/FieldHandlers/Document/SectionDescriptions\";\n\nimport { IApp, IMatrix, IContextInformation, UIToolsConstants } from \"../core/common/matrixlib/MatrixLibInterfaces\";\nimport { SimpleItemTools } from \"../core/common/matrixlib/SimpleItemTools\";\n\nimport { Application } from \"../core/common/UI/Application\";\nimport { IBaseControlOptions, IBaseControl } from \"../core/common/UI/Controls/BaseControl\";\nimport { refLinkStyle, refLinkTooltip } from \"../core/common/UI/Parts/RefLinkDefines\";\nimport { IItemSelectionParams } from \"../core/common/UI/Controls/itemSelection\";\nimport { ILineEditorLine } from \"../core/common/UI/ILineEditor\";\n\nimport {\n    IStringMap,\n    IItem,\n    IRestResult,\n    IStringNumberMap,\n    IStringStringArrayMap,\n    IReference,\n    IAnyMap,\n    ControlState,\n    IDataStorage,\n    GlobalMatrix,\n} from \"../core/globals\";\n\nimport {\n    XRGetProject_CategoryList_GetProjectStructAck,\n    XRGetProject_Needle_TrimNeedle,\n    XRGetProject_ProjectSettingAll_GetSettingAck,\n    XRGetProject_StartupInfo_ListProjectAndSettings,\n    XRGetProject_Todos_GetTodosAck,\n    XRGetTodosAck,\n    XRProjectInfo,\n    XRTodo,\n    XRTodoCount,\n    XRTrimNeedle,\n    XRTrimNeedleItem,\n} from \"../core/RestResult\";\n\nimport { ProjectStorage } from \"../core/client/ProjectStorage\";\nimport { Notifications } from \"../core/client/plugins/Notifications\";\n\nimport {\n    IWidgetPlugin,\n    IDisplayedWidget,\n    IWidgetParameters,\n    IWidgetScope,\n} from \"../core/WidgetDashboard/WidgetPluginManager\";\nimport { WidgetPluginsConstants } from \"../core/WidgetDashboard/WidgetPluginsContainer\";\n\nimport {\n    IDropdownOption,\n    ILabel,\n    INotificationConfig,\n    IFieldParameter,\n    IContextPageConfigTab,\n} from \"../core/ProjectSettings\";\n\nimport { IConfigApp } from \"../core/admin/lib/IConfigApp\";\nimport { ConfigPage } from \"../core/admin/lib/ConfigPage\";\nimport { LineEditor } from \"../core/admin/lib/LinEditor\";\n\nimport { SDK_SETTINGS_KEY, SDK_VERSION, validateSdkVersion } from \"./utils/versions\";\nimport { SelectMode } from \"../core/common/UI/Components/ProjectViewDefines\";\n\n// types and interfaces\nexport type {\n    IDashboardParametersBase,\n    IServerSettingsBase,\n    IProjectSettingsBase,\n    IPluginFeatureDashboard,\n    IDashboardPage,\n    IPluginFeatureBase,\n    IPluginFieldValueBase,\n    ITinyMenu,\n    IPluginMenuAction,\n    IPluginSearch,\n    IPluginFieldParameterBase,\n    IPluginFieldOptionsBase,\n    IPluginPrintParamsBase,\n    IPluginConfig,\n    IPluginFeature,\n    IPluginFeatureField,\n    IPluginSettingPage,\n    ITool,\n    IExternalPlugin,\n    IDashboardParameters,\n} from \"./plugins/interfaces\";\n\nexport type {\n    IProcessResult,\n    AddFileAck,\n    FolderAnswer,\n    CopyItemAck,\n    ExecuteParam,\n    ISetField,\n    IPluginFieldHandler,\n    ICategoryConfig,\n    IBaseControl,\n    TestManager,\n    IDataStorage,\n    IDB,\n    ILineEditorLine,\n    IDropdownOption,\n    IPlugin,\n    IStringMap,\n    IProjectPageParam,\n    IPluginPanelOptions,\n    IWltItemWithLinks,\n    IBaseControlOptions,\n    IItem,\n    IRestResult,\n    IStringNumberMap,\n    IStringStringArrayMap,\n    ISearchResult,\n    XRGetProject_Needle_TrimNeedle,\n    XRGetTodosAck,\n    XRGetProject_StartupInfo_ListProjectAndSettings,\n    XRTrimNeedleItem,\n    XRTodo,\n    XRTrimNeedle,\n    XRGetProject_CategoryList_GetProjectStructAck,\n    XRGetProject_ProjectSettingAll_GetSettingAck,\n    IWidgetPlugin,\n    IDisplayedWidget,\n    IWidgetParameters,\n    XRProjectInfo,\n    IReference,\n    ILabel,\n    IItemSelectionParams,\n    IAnyMap,\n    INotificationConfig,\n    IContextInformation,\n    IContextPageConfigTab,\n    XRTodoCount,\n    XRGetProject_Todos_GetTodosAck,\n    IItemChangeEvent,\n    IExternalItem,\n    IFieldParameter,\n    IConfigApp,\n    IProjectContext,\n    IControlOptions,\n    ISimpleSessionControl,\n    ITitleAndId,\n    IProjectNeeds,\n    ITableReviewData,\n    IReviewConfig,\n};\n\n// classes\nexport type {\n    PrintProcessor,\n    UIToolsConstants,\n    FieldDescriptions,\n    SectionDescriptions,\n    IWidgetScope,\n    ProjectStorage,\n    WidgetPluginsConstants,\n    refLinkStyle,\n    refLinkTooltip,\n    ControlState,\n    ItemConfiguration,\n    Notifications,\n    Tasks,\n    ControlCore,\n    ControlCoreBase,\n    PluginCore,\n    LineEditor,\n    ConfigPage,\n    NotificationsBL,\n    TodoTypes,\n    Item,\n    Field,\n    Project,\n    BaseWidget,\n    Category,\n    DocItem,\n    TreeFolder,\n    StandaloneMatrixSDK,\n    SimpleItemTools,\n};\n\n// handlers\nexport type {\n    BaseTableFieldHandler,\n    BaseValidatedTableFieldHandler,\n    CheckboxFieldHandler,\n    CrosslinksFieldHandler,\n    DateFieldHandler,\n    DHFFieldHandler,\n    DropdownFieldHandler,\n    EmptyFieldHandler,\n    GateFieldHandler,\n    GenericFieldHandler,\n    HyperlinkFieldHandler,\n    ItemSelectionFieldHandler,\n    ItemSelectionFieldHandlerFromTo,\n    RichtextFieldHandler,\n    SteplistFieldHandler,\n    TestResultFieldHandler,\n    TestStepsFieldHandler,\n    TestStepsResultFieldHandler,\n    TextlineFieldHandler,\n    UserFieldHandler,\n};\n\nexport { SelectMode, ReviewControlColumns };\n\nexport interface ClientMatrixSdk {\n    plugins: PluginManager;\n    globalMatrix: GlobalMatrix;\n    matrixSession: MatrixSession;\n    app: IApp;\n    ml: IMatrix;\n    notificationSetting: string;\n    defaultNotificationConfig: INotificationConfig;\n    pluginHooks: IPluginHooks;\n    MR1: MR1Impl;\n    matrixApplicationUI: Application;\n    matrixsdk: MatrixSDK;\n    ConfigPage: typeof ConfigPage; // typeof because we're referencing an instance\n    PluginCore: typeof PluginCore; // typeof because we're referencing an instance\n    PrintProcessor: typeof PrintProcessor; // typeof because we're referencing an instance\n    ControlCore: typeof ControlCore; // typeof because we're referencing an instance\n}\n\ndeclare module window {\n    const matrixSdk: ClientMatrixSdk;\n}\n\nfunction isOutsideMatrixApp(): boolean {\n    return !(window && window.matrixSdk);\n}\n\nexport function getSdkInstance(): ClientMatrixSdk {\n    if (isOutsideMatrixApp()) {\n        throw new Error(\"Client SDK can only be used within Matrix Requirements application\");\n    }\n\n    return window.matrixSdk;\n}\n\nexport function registerPlugin(plugin: PluginCore): void {\n    getSdkInstance().plugins.register(plugin);\n}\n"],"names":[],"sourceRoot":""}